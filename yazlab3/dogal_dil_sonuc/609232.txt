depend type program termin verif program termin verif challeng research subject signific practic import alreadi rich bodi literatur subject still undeni difficult task design termin checker realist program languag support gener recurs paper present approach program termin verif make use form depend type develop depend ml dml demonstr novel applic depend type establish live properti design type system enabl programm suppli metric verifi program termin prove everi welltyp program type system termin also provid realist exampl verifi prototyp implement support effect approach program termin verif well unobtrus program main contribut paper lie design approach program termin verif smoothli combin type metric yield type system capabl guarante program termin support gener form recurs includ mutual recurs higherord function algebra datatyp polymorph b introduct program notori errorpron cons quenc great number approach develop facilit program error detect practic programm often know certain program properti must hold correct implement therefor indic program error actual implement violat properti instanc variou type system design detect program error caus violat support type disciplin common practic programm often know reason particular program termin implement correctli immedi impli termin checker great valu detect program error caus nontermin program ex partial support nsf grant ccr0092703 ecut howev termin check realist program languag support gener recurs often prohibit expens given program termin languag gener undecid b termin check often requir interact theorem prove involv programm c minor chang program readili demand renew effort termin check larg number chang like made program develop cycl order design termin checker practic use issu must properli address alreadi rich literatur termin verifica tion approach autom termin proof either program term rewrit system trss use variou heurist highli involv synthes wellfound order eg variou path order 3 polynomi interpret 1 etc approach mainli develop firstord languag work higherord set also found eg 7 program termin implement correctli proven termin often difficult programm determin whether caus program error limit heurist involv therefor autom approach like offer littl help detect program error caus nontermin program execut addit autom approach often difficulti handl realist necessarili larg program programm also prove program termin variou interact theorem prove system nuprl 2 coq 4 isabel 8 pv 9 viabl practic variou success report howev main problem practic programm may often need spend much time prove termin program compar time spent simpli implement program addit renew effort may requir time chang like program develop cycl made program therefor programm often feel hesit adopt interact theorem prove detect program error gener program primarili interest find middl ground particular interest form mechan program languag allow programm provid inform need establish program termin els withtyp inatjnat ij inti intj knat intk figur 1 implement ackerman function automat verifi provid inform inde suffic analog would like allow user provid induct hypothes induct theorem prove prove theorem provid induct hypothes clearli challeng question inform establish program termin formal express main contribut paper lie attempt address question present design allow programm provid depend type key inform rel simpl clean way common practic prove termin recurs function metric roughli speak attach metric wellfound order recurs function verifi metric alway decreas recurs function call made paper present approach use depend type develop dml 18 14 carri metric prove program termin form type system metric encod type prove everi welltyp program termin emphas advoc design program languag termin program written instead interest design mechan program languag programm choos use facilit program termin verif manifest type system form smoothli embed type system dml illustr basic idea concret exampl go detail figur 1 implement ackerman function given withtyp claus type annot state natur number j function take argument type inti anoth argument type return natur number result note refin usual integ type int infinit mani singleton type inta inta precis type integ express valu equal write finatjnatg univers quantifi index variabl j nat sort index express valu natur number also write knat intk repres sum type novelti pair hi ji type annot indic metric use termin check inform explain termin check perform case assum j two natur number n type inti intj respect attach metric hi ji ack n note three recurs function call ack bodi ack attach metric hi 1 1i first ack sinc 1 1 type inti 1 int1 respect similarli attach metric hi 1 ki second ack k assum natur number metric hi j 1i third ack obviou hi hi j 1i hi ji hold usual lexicograph order pair natur number thu claim function ack termin theorem proven paper note although simpl exampl termin proven lexicograph structur order semant mean addit subtract need 1 realist exampl present section 5 involv depend datatyp 15 mutual recurs higherord function polymorph reader may read exampl studi section technic develop get feel actual handl approach combin metric depend type dml pose number theoret pragmat question briefli outlin result design choic first question aris decid metric support clearli varieti metric establish program termin endless practic pa per consid metric tupl index express sort nat use usual lexicograph order compar metric main reason decis metric commonli use practic establish termin proof larg varieti program b constraint gener compar metric readili handl constraint solver alreadi built typecheck dml program note usual structur order firstord term obtain attach term number constructor term readili accomplish use depend datatyp mechan dml howev current unabl captur structur order higherord term second question establish sound approach prove everi welltyp program type system design termin though idea mention exampl ackerman function seem intu itiv task far trivial presenc higherord function reader may take look higherord exampl section 5 understand seek method readili adapt handl variou common program featur ad 1 implement ackerman function involv primit recurs thu easili proven termin point drive particular implement proven termin approach includ mutual recurs datatyp polymorph etc natur lead us reduc method 12 form notion reduc depend type extend metric novelti lie treatment gener recurs format novel knowledg constitut main technic contribut paper third question integr termin check mechan dml practic common encount case termin function f depend termin anoth function g unfor tunat proven variou reason eg beyond reach adopt mechan termin check programm simpli unwil spend effort prove approach design way allow programm provid metric case verifi termin f condit termin g still use detect program error present work build upon previou work use depend type practic program 18 14 work root dml larg unclear priori depend type dml use establish program termin thu believ signific effort actual design type system combin type metric prove type system guarante program termin effort strengthen prototyp implement varieti verifi exampl rest paper organ follow form languag ml 0 section 2 essenti extend simpli type callbyvalu calculu form depend type develop dml recurs extend ml ml section 3 combin metric type prove everi program ml 0 termi nate section 4 enrich ml signific program featur datatyp mutual recurs polymorph present exampl section 5 illustr approach program termin verif appli practic mention relat work conclud full paper avail onlin 16 reader find detail omit start languag ml 0 essenti extend simpli type callbyvalu calculu form depend type gener recurs syntax ml given figur 2 21 syntax fix integ domain restrict type index expr sion name express use index type domain sort domain subset sort form instanc use nat subset sort 0g use base type index sequenc index express may empti instanc bool0 bool1 type boolean valu fals true respect integ inti singleton type integ express valu equal use satisfact relat mean p hold formula p defin satisfi domain integ instanc satisfact relat hold sinc follow formula true integ domain note decid satisfact relat depend constraint domain integ constraint domain use satisfact relat decid accept nonlinear integ constraint use usual depend function sum type respect type form essenti equival use n 2 also introduc variabl variabl ml use x f respect lambdaabstract form variabl recurs via fix point op erat must form variabl variabl valu variabl use abstract index variabl lam abstract variabl fun form recurs func tion note bodi either fun must valu use hi j ei pack index express e form express depend sum type open unpack express depend sum type 22 static semant write mean legal form type omit standard rule judgment index substitut j 7 substitut j x 7 e j f 7 e substitut finit map repres empti map use substitut map index variabl index express dom domain similar notat use substitut variabl write result appli type express etc standard practic also type form omit simplifi present index constant c index express j c j index proposit p index sort index variabl context index constraint type context constant c true express e c j x valu figur 2 syntax ml figur 3 type rule ml definit omit follow rule judgment form 0 roughli mean type write dom domain set variabl declar given substitut say write congruent extens index express type determin follow rule applic rule gener constraint typecheck present type rule ml figur 3 rule obviou side condit omit ted instanc rule typeilam free occurr follow lemma play pivot role prove subject reduct theorem ml whose standard proof avail 14 lemma 21 assum deriv hold deriv 23 dynam semant present dynam semant ml use evalu context defin certainli possibl purpos explor 3 evalu context e write ee express result replac hole e e note replac never result captur free variabl definit 22 redex defin redex fals reduc e 1 e 2 respect lam x ev redex reduc ex 7 v let e fun f e redex reduc vf 7 e v redex reduc va 7 open hi j vi ha j xi e redex reduc ea 7 ix 7 v use r redex write r e r reduc e e write e 1 e 2 say reduc e 2 one step let reflex transit closur say reduc e 2 mani step e 1 e 2 omit standard proof follow subject reduct theorem use lemma 21 theorem 23 subject reduct assum deriv ml deriv ml 24 erasur simpli transform ml languag ml 0 eras syntax relat type index express ml 0 basic extend simpli type calculu recurs let jej erasur express e e 1 reduc e 2 ml reduc je 2 j ml 0 therefor e termin ml jej termin ml 0 crucial point sinc evalu program ml 0 like done evalu erasur ml 0 pleas find detail issu 18 14 3 instanc suggest one present dynam semant style natur semant later form notion reduc evalu rule combin metric depend type ml form languag ml prove everi welltyp program ml termin main technic contribut paper 31 use usual lexicograph order tupl natur number strict part given two tupl natur number hi hold evi dentli wellfound stress theori difficulti support variou wellfound order natur number usual multiset order fix order sole eas present definit 31 metric let tupl index express index variabl context say metric deriv mean metric decor type ml 0 form follow rule form type syntax ml ml except context ml map everi variabl f domain decor type recurs function ml form fun f v process translat sourc program express ml call elabor thoroughli explain 18 14 approach program termin verif appli elabor program 32 dynam static semant dynam semant ml form precis manner ml 0 thu omit detail differ ml ml lie static semant two kind type judgment ml form 0 call latter metric type judgment give explan suppos roughli speak free occurr f e f follow sequenc index express 7 call label occurr f less 0 suppos welltyp close recurs function 0 sort f f 7 hold rule typefun know label f v less 7 label f f sinc label decreas forev yield basic intuit recurs function ml termin howev intuit argument difficult formal directli presenc highord function type rule ml judgment form essenti ml except follow one present rule deriv metric type judgment figur 4 given mean 1 k satisfi 1 j k also satisfi lemma 32 follow 1 assum hold deriv 2 assum deriv dom deriv proof 1 2 proven simultan structur induct deriv theorem 33 subject reduct assum deriv ml 0 e e 0 e deriv ml obvious follow proposit 34 assum deriv f 0 deriv height 4 33 reduc defin notion reduc welltyp close express definit 35 reduc suppos e close express type e v hold valu v reduc e defin induct complex 4 minor technic reason count neither rule typevar var calcul height deriv 1 base type e reduc 2 reduc reduc valu v 1 type 3 reduc e reduc 4 v 1 v 1 reduc valu type note reduc defin close express reduc valu proposit 36 assum e close express type e e 0 hold e reduc e 0 reduc proof induct complex follow key notion handl recurs though natur requir technic insight definit 37 reduc let e welltyp close recurs function fun f close metric e 0 reduc e reduc satisfi 7 0 definit 38 let substitut map variabl express everi x 2 dom xreduc x reduc everi f 2 dom f f reduc f f reduc sens follow lemma verifi whether notion reduc form correctli difficulti probabl lie formul rather proof lemma 39 main lemma assum e deriv also assum xreduc everi x 2 dom everi f 2 deriv f f reduc e reduc proof let deriv e proceed induct height present interest case case found 16 assum follow rule typefun last appli suppos e reduc definit exist 1 e 0 reduc e reduc satisfi word e f1 reduc deriv figur 4 metric type rule ml proposit 34 deriv 1 height 1 less induct hypothesi v note e 0 v thu e 0 reduc contradict definit 0 therefor e reduc follow main result paper corollari 310 e deriv ml ml reduc thu reduc valu proof corollari follow lemma 39 extens extend ml signific program featur mutual recurs datatyp poli morphism defin notion reduc extens thu make clear lemma 39 still hold extens present section treatment mutual recurs curri leav detail 16 41 mutual recurs treatment mutual recurs slightli differ standard one syntax type rule handl mutual recurs given figur 5 use type express repres n mutual recurs function type respect confus product type also n en must posit constant integ let v follow express fun everi 1 k n vk redex reduc form metric type judgment e f 0 verifi label f e less 0 rule deriv judgment essenti figur 4 except lab given f f rule fun handl mutual recurs straightforward thu omit definit 41 reduc let e close express reduc v e reduc ek reduc 42 curri decor type must far form restrict rather unpleas consequ type j express e j en j fun f 1 valu v j fun f 1 f f typefun figur 5 syntax type rule mutual recurs instanc may want assign follow type implement ackerman function figur 1 finatg inti fjnatg intj int formal written decor metric involv index variabl 1 make imposs verifi implement termin gener form decor type follow address problem also introduc follow form express e repres recurs function requir e 0 valu follow deal case 1 n 1 treatment similar e e 0 follow type rule follow metric type rule definit 42 reduc let e close recurs function close metric e 0 reduc e 1 v reduc reduc valu 1 5 practic implement typecheck ml prototyp implement dml experi variou exampl present also address practic issu end section 51 exampl demonstr variou program featur handl practic approach program termin verif primit recurs follow implement primit recurs oper r godel clearli typabl ml note z assign type nat0 respect datatyp nat z0 nnat sn1 natn u r n u r n u v withtyp nnat nat nnat natn type corollari 310 clear everi term termin weakli normal exampl paper proven termin structur order point make though seem evid use r caus nontermin trivial prove everi term termin notic proof obtain peano arithmet notion reduc precis invent overcom difficulti 12 actual everi term strongli normal obvious untru 0 nest recurs function call program figur 6 involv nest recurs function call implement mc carthi 91 function withtyp claus indic everi integ x f91x return integ 91 x 100 inform explain metric type annot suffic establish termin f91 inner call f91 need prove obviou outer call f91 need verifi 1 max0 101 assum clearli exampl handl structur order mutual recurs program figur 7 implement quicksort list function qs par defin mutual recurs inform explain program typabl ml 0 thu qs termin function corollari 310 call par bodi qs label 0 1 length xs 0 need verifi satisfi obviou two call qs bodi par need verifi hold sinc also indic need r r metric par two call par bodi par need verifi hold sinc exampl handl structur order higherord function program figur 8 implement function accept take pattern p string check whether match p mean pattern given comment auxiliari function acc implement continu pass style take pattern p list charact cs continu k match prefix cs p call k rest charact note k given type allow k appli charact list longer cs metric use prove termin acc hn ii n size p number constructor p exclud empti length cs notic call acc p cs 0 k last pattern match claus label attach call length cs 0 0 sinc continu type must fals call hap pen therefor straightforward see label attach call acc less hn ii corollari 310 acc termi nate impli accept termin assum explod termin everi aspect nontrivi exampl even interact theorem prove system notic test lengthc 0 bodi acc timeconsum resolv use continu accept argument charact list length 5 eleg implement accept process pattern match elimin test runtim check also realist case termin depend program invari difficult captur type system dml instanc follow exampl adopt implement bit revers part implement fast fourier transform fft fun loop j kj loop jk k2 els jk withtyp anatbnat inta intb int obvious loop1 0 termin howev may know reason second argument loop never 0 execut lead follow im plement need check k 1 hold call loopj k k2 guarante k2 posit integ fun loop j els rais imposs withtyp anatbpo max0 ab inta intb int readili verifi loop termin func tion exampl indic insert runtim check verifi program termin sometim approxim live properti safeti properti 52 practic two separ issu concern practic approach program termin verif practic termin verif process b applic approach realist program 5 note lengthc 0 lengthc type inti 0 inti respect thu lengthc type depend whether 0 equal thu infer type system withtyp figur 6 implement mccarthi 91 function case xs x xs par cmp x xs withtyp bool nnat n0 listn listn anda par cmp x l r case xs x xs cmpx x par cmp x x l r xs els par cmp x l x r xs withtyp bool pnatqnatrnat pqrr1 listp listq listr listpqr1 figur 7 implement quicksort list easi observ complex typecheck ml basic ml sinc ad work verifi metric provid pro decreas requir solv extra constraint number extra constraint gener typecheck function proport number recurs call bodi function therefor like small base experi dml thu feel typecheck ml suitabl practic use applic approach realist pro gram use type system program languag c exampl illustr design decis obvious type system c unsound unsaf type cast often need c type program would otherwis possibl spite practic type system c still great help captur program error clearli similar design allow programm assert termin function dml verifi may call termin cast combin termin verif runtim check termin cast feel approach promis put practic 6 relat work amount research work relat program termin simpli vast section mainli mention relat work work share similar either design techniqu approach autom termin proof either program term rewrit system trss use variou heurist synthes wellfound order ap proach howev often difficulti report comprehens inform program proven ter minat follow 13 also larg amount work prove termin logic program 11 report mercuri compil perform autom termin check realist logic program howev address differ question interest check whether given metric suffic establish termin program synthes metric design essenti one adopt 10 check whether given structur order possibl highord term decreas induct proof logic program clearli approach base check complement base synthesi approach also relat semant label approach 19 design prove termin term rewrit system trss essenti idea differenti function call label show label alway decreas function call unfold semant label approach requir construct model tr verifi whether label done correctli approach typecheck notion size type introduc 6 prove correct reactiv system type system capabl guarante termin welltyp program languag present 6 design embed function program contain signific restrict support minor variant primit recurs caus inconveni program instanc seem difficult implement quicksort use primit recurs experi gener recurs realli major program featur greatli complic program termin verif also notion existenti depend type deem indispens practic program exist 6 compar variou interact theorem prove datatyp pattern string match empti char1 char c match char c inatjnat plusij1 patterni patternj cs match plusp1 p2 cs match either p1 p2 inatjnat timesij1 patterni patternj cs match timesp1 p2 prefix cs match p1 rest match p2 inat stari1 patterni cs match starp cs match possibl 0 copi p length comput length list length len withtyp len xs withtyp inat listi inti empti tupl use sinc length recurs case p empti k cs charc case cs c cs plusp1 p2 case k use backtrack acc p1 cs k true els acc p2 cs k timesp1 p2 acc p1 cs fn cs acc p2 cs k cs true els acc p0 cs fn cs els acc p cs withtyp nnat patternn inat n char listi inat char listi bool bool explod turn string list charact withtyp pattern string bool figur 8 implement pattern match string system nuprl 2 coq 4 isabel 8 pv 9 approach program termin weaker sens mani fewer program verifi termin automat less obtrus program essenti design mechan program termin verif languag interfac use program develop cycl consid main contribut paper appli design mechan intend facilit program error detect lead construct robust program 7 conclus futur work present approach base depend type dml allow programm suppli metric verifi program termin proven correct also appli approach variou exampl involv signific program featur gener form recurs includ mutual recurs higherord function algebra datatyp polymorph support use practic program properti often classifi either safeti properti live properti program never perform outofbound array subscript runtim safeti properti demonstr 17 depend type dml guarante everi welltyp program dml possess safeti properti effect facilit runtim array bound check elimin howev unclear priori whether depend type dml also use establish live properti paper formal address question demonstr depend type dml combin metric establish program termin one signific live properti termin check also use compil opti mizat instanc one decid chang execut order two program may requir prove first program alway termin also seem feasibl use metric estim time complex program lazi function program inform may allow compil decid whether thunk form futur expect explor along line research although present mani interest exampl proven termin structur order emphas structur order often effect practic establish program termin therefor seem fruit studi combin approach structur order handl simpl case either automat synthes manual provid structur order verifi difficult case metric suppli programm r termin rewrit system polynomi interpret implement implement mathemat nuprl proof develop system order term rewrit system prove correct reactiv system use size type higherord recurs path order gener theorem prover pv combin specif termin reduct check logic framework termin analysi mercuri intension interpret function finit type effici test topdown termin logic rule depend type practic program depend type data structur depend type program termin verifica tion elimin array bound check depend type depend type practic program ming termin term rewrit semant la bell tr ctr kevin donnelli hongwei xi formal strong normal simplytyp lambdacalculu system f electron note theoret comput scienc entc v174 n5 p109125 june 2007 chiyan chen hongwei xi combin program theorem prove acm sigplan notic v40 n9 septemb 2005 kevin donnelli hongwei xi combin higherord abstract syntax firstord abstract syntax at proceed 3rd acm sigplan workshop mechan reason languag variabl bind p5863 septemb 3030 2005 tallinn estonia amir benamram chin soon lee program termin analysi polynomi time acm transact program languag system topla v29 n1 p5e januari 2007 arn john glenstrup neil jone termin analysi specializationpoint insert offlin partial evalu acm transact program languag system topla v27 n6 p11471215 novemb 2005