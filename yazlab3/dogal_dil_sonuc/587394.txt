algebra multilevel multigraph algorithm describ algebra multilevel multigraph algorithm mani multilevel compon gener algorithm origin appli gener spars gaussian elimin inde gener spars gaussian elimin minimum degre order limit case algorithm goal develop procedur robust simplic use spars direct method yet offer opportun obtain optim nearoptim complex typic classic multigrid method b introduct work develop multilevel multigraph algorithm algebra multigrid method current topic intens research interest 17 18 20 46 12 48 38 11 44 3 4 1 2 5 16 7 29 28 27 42 41 21 excel recent survey given wagner 49 mani real world calcul direct method still wide use 6 robust direct elimin method simplic use often outweigh appar benet fast iter solver goal tri develop iter solver compet spars gaussian elimin term simplic use robust provid potenti solv wide rang linear system ecient yet satis method achiev goal believ reason rst step particular method gener spars gaussian elimin minimum degre order point paramet space method impli worst case method default wellknown wide use method among comput ecient gener spars direct method 26 best case howev method exhibit near optim order complex classic multigrid method plan take well studi robust wide use procedur data structur develop spars gaussian elimin gener necessari use basic compon multilevel solver overal iter follow classic multigrid vcycl form contrast algebra hierarch basi multigraph algorithm develop 11 work focu class matric structur symmetr pattern nonzero matrix symmetr although numer valu matrix element may render nonsymmetr structur symmetr matric aris discret partial dierenti equat say nite element method certain problem matric symmetr posit denit other linear system highli nonsymmetr andor indenit thu practic repres broad class behavior main interest scalar ellipt equat nite element code pltmg 8 algorithm formal appli structur symmetr nonsingular spars matrix spars direct method typic two phase rst initi phase depart mathemat univers california san diego la jolla ca 92093 work author support nation scienc foundat contract dms9706090 bell laboratori lucent technolog murray hill nj 07974 equat order symbol numer factor comput second solut phase solut linear system comput use factor procedur well algebra multilevel method also break natur two phase initi consist order incomplet symbol numer factor comput transfer matric level solut phase precondition comput initi phase use comput solut use precondit composit step conjug gradient cscg composit step biconjug gradient csbcg method 9 iter solver often tune paramet switch requir certain level priori knowledg empir experiment set particular instanc solver immun although tri keep number paramet minimum particular initi phase three paramet drop toler use incomplet factor call dtol code maxf il integ control overal llin storag allow given incomplet factor maxlvl integ specifi maximum number level case correspond spars gaussian elimina tion solut phase two addit paramet tol toler use converg test maxcg integ specifi maximum number iter within code matric gener treat within singl uni frame work eg symmetr posit denit nonsymmetr indenit problem gener special option besid control paramet mention inform matrix gener sparsiti pattern valu nonzero provid spars matrix data structur variant data structur introduc yale spars matrix packag 23 10 certain block matric user may option provid small array contain inform block structur input limit complex code well elimin paramet might need classifi given matrix hand seem clear special solver direct specic problem class problem make use addit knowledg like outperform algorithm particular class problem although think method provabl best particular problem believ gener robust coupl reason comput ecienc make valuabl addit collect spars solver rest paper organ follow section 2 provid gener descript multilevel approach section 3 dene spars matrix data structur use code incomplet factor algorithm standard drop toler approach modic present applic describ section 4 order procedur minimum degre algorithm implement basic standard sever modic input graph relev applic describ section 5 section 6 describ construct transfer matric use construct coars grid correct inform block structur matrix provid use coarsen procedur describ section 7 final section 8 give numer illustr method varieti partial dierenti equat matric 2 matrix formul let larg spars nonsingular n n matrix assum sparsiti pattern symmetr although numer valu need begin describ basic twolevel method solv let b n n nonsingular matrix call smoother give rise basic iter method use multilevel precondition case b approxim factor ie l strict lower triangular u strict upper triangular sparsiti pattern l diagon p permut matrix given initi guess x step smooth procedur produc iter second compon twolevel precondition coars grid correct assum matrix partit ff fc cf cc subscript f c denot ne coars respect similar smoother partit ne coars block involv permut matrix p coars grid matrix given ff fc cf cc cc matric v cf w n matric ident sparsiti pattern thu symmetr sparsiti pattern let cc standard multigrid terminolog matric w call restrict prolong respect given approxim solut xm 21 coars grid correct produc iter xm1 follow b axm typic multilevel method dene twolevel precondition implicitli term smoother coars grid correct singl cycl take initi guess x 0 nal guess x 2m1 follow twolevel precondition dene use 23 ii xm1 dene use 27 dene use 23 gener twolevel multilevel consist appli recurs solut equat r 27 let denot number level recurs denot precondition 27 gener b axm gener level precondition dene follow level precondition directli start initi guess x 0 comput x 2m1 use iiiv dene use 23 iv xm1 dene 28 use iter 1 level scheme r dene initi guess dene use 23 case correspond symmetr vcycl case correspond symmetr wcycl note variant vcycl wcycl well type multilevel cycl strategi 30 howev work code restrict attent symmetr vcycl presmooth postsmooth iter coars mesh solut procedur somewhat nontradit instead direct solut 21 comput approxim solut use one smooth iter illustr practic consequ decis section 8 symmetr level precondition could use precondition symmetr krylov space method also posit denit standard conjug gradient method could use otherwis cscg method 9 symlq 43 similar method could use nonsymmetr case level precondition could use conjunct csbcg method 9 gmre 22 similar method complet denit method must provid algorithm comput permut matrix p 22 comput incomplet factor matrix b 22 comput necoars partit comput sparsiti pattern numer valu prolong restrict matric 26 3 data structur let n n matrix element ij symmetr sparsiti structur ij ji treat nonzero element ie store process ja diagon entri ii treat nonzero regardless numer valu data structur modi gener version data structur introduc symmetr yale spars matrix packag 23 rowwis version data structur describ 10 scheme nonzero entri store linear array access integ array ja let number nonzero strict upper triangular part row set array ja length n1 array length n1 6 array length 2 entri jai 1 n pointer dene follow locat jai jai contain column indic correspond row strictli upper triangular matrix similar manner array dene follow 6 word diagon store rst follow strict upper triangl store row wise 6 follow strict lower triangl store columnwis sinc structur symmetr column index upper triangl ident row index lower triangl henc need duplic storag exampl let 11 12 13 0 0 21 22 0 24 0 43 44 0 a11 a22 a33 a44 a55 a12 a13 a24 a34 a35 a21 a31 a42 a43 a53 diagon upper triangl lower triangl although ysmp data structur origin devis spars direct method base gaussian elimin also quit natur iter method base incomplet triangular decomposit assum symmetr sparsiti structur mani matrix calcul singl indirect address comput ja use process lower upper triangular element exampl follow procedur comput procedur multn ja x end k jai jai end end symmetr matric set lmtx 0 umtx 0 also may readili comput set lmtx 0 umtx jan data structur store quit analog consist two array ju u correspond ja respect rst entri ju pointer ja entri jui jui contain column indic nonzero row u u array diagon entri store rst n entri entri arbitrari next nonzero entri u store correspond column indic ju nonzero entri l follow store columnwis data structur use n w similar consist integ array jv real array v nonzero entri store rowwis includ row block cc usual rst entri jv pointer entri jvi jvi contain column indic row w v array nonzero entri store rowwis correspond jv shift n sinc diagon part w follow nonzero store columnwis 4 ilu factor incomplet ldd 1 du factor similar row elimin scheme develop symmetr ysmp code 23 26 simplic begin discuss complet factor describ modic necessari incomplet factor without loss gener assum permut matrix k step elimin block factor 11 12 21 22 11 k k 22 n k n k assum stage block righthand side 41 comput except schur complement given goal step k 1 comput rst row column given l dd 1 u symmetr sparsiti pattern data structur take advantag symmetri clear algorithm comput practic dier assign shift u array analog lmtx umtx procedur mult thu focu comput point also assum array ju comput socal symbol factor step major substep follow 1 copi rst column 22 store data structur ja expand work vector z size n 2 find multipli given nonzero 1 3 multipli use column k l 21 ie 4 copi nonzero z data structur ju u step 1 need know nonzero rst column 22 precis inform easili access ja data structur step 3 need know nonzero column l 21 precis inform easili avail data structur step 4 copi column inform lower triangular portion ju u data structur inde dicult aspect algorithm step 2 need know sparsiti structur rst column u 12 inform readili avail data structur handl standard fashion use dynam link list structur discuss detail gener incomplet factor case rst observ ju array comput concurr numer factor simpli creat list entri expand array z updat step 3 next note one may choos nonzero entri z includ factor choos entri copi ju u data structur step 4 standard approach use drop toler particular neglect pair odiagon element j note ii yet comput well known llin gener applic criterion 44 highli nonlinear matrix depend function especi problemat present context sinc control llin necessari order control work per iter multilevel iter sever author explor possibl control maximum number llin element allow row incomplet decomposit 35 47 31 howev mani case interest particular matric aris discret partial dierenti equat order minimum degre algorithm llin complet factor occur later stage even row initi number nonzero thu seem advis tri control total llin one adapt decid alloc llin among row matrix algorithm addit drop toler user provid paramet maxf il speci total number nonzero u larger maxf il n overal strategi comput incomplet decomposit use given drop toler fail meet given storag bound increas drop toler begin new incomplet factor continu fashion complet factor within given storag bound cours repeat factor comput expens develop heurist allow us predict drop toler satisfi storag bound factor comput make histogram approxim size element exceed drop toler accept factor let denot number bin histogram code pair accept odiagon element nd largest k 2 1 1 code histogram realiz integ array h size h number accept element exceed drop toler factor 1 1 1 hm contain number accept element exceed drop toler 1 factor reach storag bound continu factor allow llin howev continu comput histogram base 45 prole element would accept space avail use histogram predict new valu total number element accept u larger maxf il n predict cours guarante sinc size number llin element depend complic fashion specic histori incomplet factor process inde histogram even complet prole remaind factor exist drop toler sinc element would accept could introduc addit llin later stage calcul well uenc size element comput later stage factor implement factor vari depend sever storag bound exceed purpos introduc conserv bia predict goal actual llin accept exceed maxf il n final note comprehens theori regard stabil incomplet triangular decomposit certain class matric eg mmatric hmatric exist certain incomplet factor prove 39 25 24 40 51 howev gener case potenti indenit andor highli nonsymmetr matric one must contend practic way possibl failur near failur factor common approach add diagon matrix often multipl ident comput incomplet factor shift matrix one might also tri incorpor form diagon pivot partial complet pivot could potenti destroy symmetr sparsiti pattern matrix howev sort pivot greatli increas complex implement sinc simpl essenti static data structur ja ju u appropri environ philosophi simpli accept occasion failur continu factor order procedur contain heurist direct toward avoid least minim possibl failur occur failur often corrupt low dimension subspac krylov space method conjug gradient compens corrupt extra iter implement failur reveal diagon entri becom close zero odiagon element l ji u ij multipli 1 ii solut l multipl 1 ii purpos calcul factor solut valu 1 ii modi near zero follow 1d ii jd ii j small constant implement machin epsilon although mani failur could render precondition wellden essenti useless practic note 1 ii rare modi larg class nite element matric main target procedur 5 order comput permut matrix p 22 use wellknown minimum degre algorithm 45 26 intuit one comput incomplet factor order tend minim llin complet factor tend minim error particular class matric special order scheme develop 34 15 37 36 exampl matric aris convect domin prob lem order along ow direct use great success howev gener set prefer use one strategi matric reduc complex implement avoid problem develop heurist decid among variou order possibl remark convect domin problem minimum degre order perform compar well special one provid modest llin allow incomplet factor us seem reason compromis minimum degre order standard implement use quotient graph model 26 standard enhanc descript graph matrix main requir input without go detail essenti small variant basic ja data structur use store matrix denot modi data structur jc instead store column indic strict upper triangl ja entri jci jci jc data structur contain column indic odiagon entri row matrix implement two small enhanc minimum degre order practic matter involv chang input graph data structur jc provid minimum degre code first implement drop toler similar use factor particular edg graph correspond odiagon entri ij ji includ jc data structur ja jj ii j 51 exclud mani entri like drop subsequ incomplet factor hope result order tend minim llin creat edg kept second modic involv modest priori diagon pivot design minim number failur near zero diagon element subsequ factor rst remark pivot procedur base valu matrix element view weight graph edg node would destroy mani enhanc allow minimum degre algorithm run almost linear time modic best explain context simpl 2 2 exampl let b b c 6 0 clearli nonsingular complet triangular factor exist howev b 0 c bca b suppos ii 0 jj four element form submatrix form describ seem incomplet factor less like fail p chosen vertex j order vertex done follow ii 0 determin correspond j jj one choic choos one ja ij ji jj j maxim ensur vertex order vertex j replac sparsiti pattern odiagon entri row column union row column j denot set column indic row jc array adji although set adji adjj modi variou stage well known 53 maintain throughout minimum degre order process 26 everi step order process degj degi degi degre vertex long degj degi vertex j order vertex minimum degre algorithm hand stage order process remain thereaft 53 becom word j becom socal equival vertic elimin time minimum degre algorithm see 26 detail sinc minimum degre algorithm see vertic equival order arbitrari fashion elimin graph thu simpl postprocess step must scan order provid minimum degre algorithm exchang order row j order rst exchang result new minimum degre order complet equival term llin origin mani type nite element matric eg indenit matric aris helmholtz equat priori scheme useless none diagon entri close zero howev type problem like produc isol small diagon entri factor process produc hand class nite element matric notabl aris mix method stoke equat saddlepointlik formul mani diagon entri small zero case priori diagon pivot strategi make substanti dierenc greatli reduc number failur incomplet triangular decomposit 6 comput transfer matric three major task comput prolong restrict matric w 26 first one must determin sparsiti structur matric involv choos unknown coars ne reduc determin permut p 24 second one must determin coars ne unknown relat socal parentchild relat 49 involv comput sparsiti pattern matric v cf w fc third one must comput numer valu matric socal interpol coecient 50 mani exist algorithm coarsen graph matric aris discret partial dierenti equat often sparsiti matrix relat way underli grid problem coarsen graph matrix formul term coarsen grid exampl given 14 13 17 18 46 12 49 case one geometri grid serv aid develop analyz coarsen procedur also gener graph coarsen algorithm 32 33 19 often use partit problem parallel comput coarsen scheme base upon anoth wellknown spars matrix order techniqu revers cuthillmcke algorithm order tend yield reorder matric minim bandwidth wide use gener band elimin algorithm 26 assum graph order fashion jc data structur repres graph order avail coarsen procedur simpl postprocess step basic order routin n vertic graph mark coars f ine procedur coarsenn jc type end j jci jci end end postprocess step coupl revers cuthillmcke algorithm quit similar greedi algorithm comput maxim independ set use breadthrst search procedur coars vertic surround ne vertic impli matrix cc 24 diagon matrix sparsiti pattern matric aris discret scalar partial dierenti equat two space dimens number coars unknown n typic order n4 n5 matric nonzero per row tend smaller valu n dene parent coars vertex take connect vertex ne vertic sparsiti structur v cf 25 block cf present code pick v cf w fc accord formula ff fc ff ff diagon matrix diagon entri equal ff sens nonzero entri v cf w fc chosen multipli gaussian elimi nation nonneg diagon matric r ff r ff chosen nonzero row w fc column v cf respect unit norm 1 final coarsen matrix 25 sparsi use drop toler criterion like 51 remov small odiagon element empir appli drop toler end coarsen procedur prove ecient eectiv tri independ sparsifi constitu matric number odiagon element upper triangl exce maxf il n drop toler modi fashion similar incomplet factor odiagon element prole procedur similar incomplet fac toriz case result histogram exact base histogram new drop toler comput 51 appli produc coarsen matrix satisfi storag bound 7 block matric algorithm provid simpl limit function handl block matric suppos n n matrix k k block structur b subscript ij block indic diagon block jj squar matric suppos jj order matrix store usual ja data structur describ section 3 refer block structur small addit integ array ib size k 1 use dene block boundari follow word integ rang ibj ibj inclus compris index set associ block jj note ibk block inform play role coarsen algorithm first revers cuthillmcke algorithm describ section 6 appli block diagon matrix b 11 akkc 72 rather practic matter involv discard graph edg connect vertic dierent block construct graph array jc use input edg straightforward determin inform provid ib array coarsen algorithm appli graph produc output equival applic procedur independ diagon block consequ restrict prolong matric automat inherit block structur particular vkkc w jj rectangular matric structur 26 would result applic algorithm independ jj howev like matrix store standard jv v data structur describ section 3 without refer block structur complet matrix use construct coarsen matrix 25 howev 71 73 1k also automat inherit k k block structur necessari procedur form knowledg block structur block structur comput priori graph coarsen procedur like store standard ja data structur without refer block structur sinc block arbitrari order essenti coarsen independ like eventu certain block may ceas exist coars level sinc block inform use discard certain edg construct graph array jc 00 diagon block present diculti 8 numer experi section present numer illu tration rst sequenc experi consid sever matric loos base classic case 5point center nite dierenc approxim u uniform squar mesh dirichlet boundari condit impos lead n n block tridiagon system n n tridiagon matrix simpl test problem easili solv standard multigrid method contrast exampl also consid block tridiagon system eigenvector eigenvalu although associ eigenvector eigenvalu revers case socal smooth eigenvector associ larg eigenvalu rough eigenvector associ smaller eigenvalu although aris natur context numer discret partial dierenti equat interest dee much convent wisdom multigrid method third consid block 3 3 system form discret laplacian symmetr posit denit stabil matrix sparsiti pattern similar howev nonzero size compar size o1 nonzero element c x c also sparsiti pattern similar matric nonsymmetr nonzero entri size oh matric aris stabil discret stoke equat one third eigenvalu neg quit indenit addit ja array matrix also provid ib array describ section 7 dene 33 block structur emphas block inform use comput graph input coarsen procedur involv aspect incomplet factor smooth procedur mani small diagon element class matric provid good test priori pivot strategi use conjunct minimum degre order tabl 81 level refer number level use calcul implement paramet maxlvl limit number level allow set sucient larg eect comput drop toler set matric llin control paramet maxf il set sucient larg eect comput initi guess problem x tabl 81 paramet digit refer experi ask six digit accuraci column label cycl indic number multigrid cycl acceler cscg use achiev indic number digit final last two column label init solv record cpu time measur second initi solut phase algorithm respect initi includ order incomplet factor comput transfer matric use multigraph precondition solut includ time solv 21 least six digit given precondition experi run sgi octan r10000 250mhz use doubl precis arithmet f90 compil analyz result clear procedur reason well three class matric although appear rate converg independ n seem appar work grow faster logarithm cpu time larger vale n aect cach perform well slightli larger number cycl highli indenit stoke matric import also note ro bust procedur solv problem nonzero per row averag incomplet factor expens comput case ect rel larger initi solv time next experi illustr eect paramet maxlvl matrix solv problem 1 maxlvl 7 termin iter solut six digit perform comparison digit cycl init solv discret laplacian stoke matrix measur 81 also provid total storag ja ju array matric measur thousand entri sinc matric symmetr also total oat point storag matric approxim ldu factor see method behav predict way particular decreas drop toler increas number level improv converg behavior method hand time alway follow trend exampl case increas number level decreas number cycl increas time method default standard conjug gradient iter incomplet factor precondition maxlvl 1 one presmooth one postsmooth step use largest matrix addit cost recurs overal cost precondition doubl cost case also note unlik classic multigrid method coarsest matrix solv exactli code chosen approxim solv coarsest system use one smooth iter use incomplet factor maximum number level use tabl 81 smallest system typic 1 1 2 2 irrelev remark howev case tabl 82 fact smallest system solv exactli signicantli uenc overal rate converg unlik method coarsest system solv exactli increas number level tend improv rate converg case coarsest matrix exact ldu factor case matrix nearli diagon set maxlvl 5 increas number level case depend converg maxlvl discret laplacian maxlvl digit cycl init solv 3 61 96 132 1169 1077 1119 6 7 61 56 121 649 878 2106 61 22 166 317 878 3649 use maximum 10 9 level respect result chang signicantli case 7 also includ tabl 82 case inat fact code use jjajj drop toler user speci avoid divid zero see gaussian elimin reason competit problem howev gener expect initi cost grow like 32 expect solut time grow like p p 1 best multilevel choic expect initi solut time behav like log n nal seri test studi converg method suit test problem gener nite element code pltmg 8 exampl problem present earlier work 11 complet descript problem well numer result hierarch basi multigraph method classic amg algorithm ruge stuben 46 found group problem featur highli nonuniform adapt gener mesh rel complic geometri varieti dierenti oper test case spars matrix righthand side save le serv input iter solver short descript test problem given problem superior problem simpl poisson equat homogen dirichlet boundari condit domain shape lake superior classic problem fairli complic domain solut gener smooth boundari singular problem hole problem featur discontinu anisotrop coecient overal domain region two concentr circl domain divid three subregion inner region problem middl region equat outer region equat homogen dirichlet boundari condit impos inner hole bound ari homogen neumann condit outer boundari natur continu condit intern interfac solut also rel smooth singular exist intern interfac problem texa indenit helmholtz equat pose region shape like state texa homogen dirichlet boundari condit impos length scale domain roughli 16 16 problem fairli indenit problem ucsd simpl constant coecient convectiondius equat r ru pose domain shape ucsd logo homogen dirichlet boundari condit impos boundari layer form bottom region top variou obstacl problem jcn 0 jcn 180 next two problem solut current continu equat taken semiconductor devic model equat convectiondius equat form r ru rectangular domain howev curv band interior domain jj 10 4 direct radial dirichlet boundari condit impos along bottom boundari along short segment upper left boundari respect homogen neumann boundari condit speci elsewher solut vari exponenti across domain typic semiconductor problem rst problem jcn 0 convect term chosen devic forward bias case sharp intern layer develop along top interfac boundari second problem jcn 180 sign convect term revers result two sharp intern layer along interfac boundari summar result tabl 83 perhap import point method solv problem converg rate independ h growth appear worst logarithm make addit remark tabl perform comparison n level digit cycl init solv 20k 9 73 5 14e 0 94e1 hole jcn 0 jcn problem decreas drop toler tend increas effect precondition although gener also make precondition costli appli thu one might optim select drop toler minim decreas number cycl increas cost per cycl experi tri systemat optim adjust drop toler crude way dicult problem perform fashion similar easi one problem texa far dicult test suit set problem order 80k one came close achiev storag limit well limit mani averag less 10 nonzero per row l u factor nonsymmetr problem csbcg method use acceler sinc csbcg requir solut conjug system two matrix multipli two precondit step requir itera tion note section 3 data structur appli transpos matrix precondition cost appli origin matrix precondition sinc domin cost csbcg method cost per cycl approxim doubl equival symmetr system r eigenvalu estim block incomplet factor method algebra multilevel iter method theori applic stabil algebra multilevel iter method algebra multilevel precondit method class hybrid algebra multilevel precondit method pltmg softwar packag solv ellipt partial di analysi composit step biconjug gradient method gener spars elimin requir perman integ storag incomplet factor multigraph algorithm hierarch basi multigrid method incomplet lu decomposi tion order incomplet factor precondit nonsymmetr problem toward algebra multigrid ellipt problem second order boundari treatment multilevel method unstructur mesh black box multigrid variat iter method nonsymmetr system linear equat algorithm data structur spars symmetr gaussian elimin stabil analysi incomplet lu factor algebra analysi hierarch basi precondition comput solut larg spars posit de incomplet block factor precondit linear system aris numer solut helmholtz equat algebra hierarch basi precondition incomplet decomposit theori analysi multilevel graph partit order techniqu convect domin problem unstructur three dimension grid order strategi modi energi optim algebra multigrid base analysi robust incomplet factor stabil incomplet lufactor character hmatric use approxim invers algebra multilevel method solut spars ind multigrid method base incomplet gaussian elimin graph theoret studi numer solut spars posit de ilut dual threshold incomplet lu factor converg algebra multigrid base smooth aggreg introduct algebra multigrid energyminim interpol robust multigrid method robust ilu smooth tr ctr randolph e bank compat coarsen multigraph algorithm advanc engin softwar v38 n5 p287294 may 2007 gh juncu e mosekild c popa numer experi mg continu algorithm appli numer mathemat v56 n6 p844861 june 2006 j oval hierarch matrix techniqu domain decomposit algorithm comput v80 n4 p287297 septemb 2007 michel benzi precondit techniqu larg linear system survey journal comput physic v182 n2 p418477 novemb 2002