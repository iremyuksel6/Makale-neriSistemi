accur solut weight least squar iter method consid weight leastsquar wl problem illcondit weight matrix wl problem aris mani applic includ linear program electr network boundari valu problem structur roundoff error standard iter method solv wl problem illcondit weight may give correct answer inde differ true comput solut forward error may larg propos iter algorithm call minresl solv wl problem minresl method applic minr krylovspac method due paig saunder siam j numer anal 12 1975 pp 617629 certain layer linear system use simplifi model effect roundoff error prove minresl ultim yield answer small forward error present comput experi applic b introduct consid weight leastsquar wl problem formula remaind articl k delta k indic 2norm make follow assumpt diagon posit definit matrix rank n assumpt impli 1 nonsingular linear system uniqu solut normal equat 1 form weight leastsquar problem aris sever applic domain includ linear program electr power network ellipt boundari valu problem structur analysi observ strang 21 articl focus case matrix sever illcondit happen certain class electr power network case nodearc adjac matrix matrix load conduct b vector voltag sourc x vector voltag node illcondit occur resistor scale instanc model leakag current insul illcondit also occur linear program interiorpoint method use comput newton step interiorpoint method need solv weight leastsquar equat form 2 sinc slack variabl becom zero solut matrix alway becom illcondit iter approach boundari feasibl region section 9 cover applic detail illcondit also occur finit element method certain class boundari valu problem exampl heat equilibrium equat r delta thermal conduct field c vari wide scale import properti problem 1 2 norm bound solut obtain independ stewart 20 todd 22 sever author see 6 complet bibliographi state result paper stewart theorem 1 let denot set posit definit theta real diagon matric let theta n real matrix rank n exist constant 2 note matrix appear 3 solut oper normal equat 2 word 2 rewritten sinc bound 3 4 exist hope exist algorithm 2 possess properti name forward error bound depend call algorithm stabl stabil defin vavasi 23 mean forward error comput solut x satisfi ffl machin precis fa function depend note underli rational kind bound condit problem 1 stem illcondit rather illcondit stabil properti possess standard direct method qr factor choleski factor symmetr indefinit factoriza tion rangespac nullspac method standard iter method conjug gradient appli 2 two algorithm literatur prove properti nsh algorithm vavasi 23 complet orthogon decomposit cod algorithm hough vavasi 12 direct see bjorck 1 inform algorithm leastsquar problem would like stabl iter method problem iter method much effici direct method larg spars problem common set applic articl present iter algorithm wl problem call minresl minresl consist appli minr algorithm paig saunder 14 certain layer linear system prove minr satisfi 5 proof forward error bound minresl base simplifi model roundoff error affect krylov space method analysi confirm comput experi section 8 simplifi model describ section 5 analysi roundoff minresl start first principl present effect roundoff minr iter still fulli understood minresl impos addit assumpt wl problem instanc layer assumpt made without loss gener ie everi weight leastsquar problem rewritten layer form minresl algorithm ineffici problem mani layer articl organ follow section 2 state layer assumpt also layer leastsquar ll problem section 3 consid previou work section 4 describ minresl method twolay wl problem section 5 analyz converg twolay case use simplifi assumpt roundoff error section 6 section 7 extend algorithm analysi case p layer section 8 present comput experi support claim section 9 consid applic minresl interiorpoint method linear program 2 layer assumpt recal alreadi assum weight matrix appear 1 diagon posit definit illcondit rest articl impos addit layer assumpt assum suitabl permut row b correspond symmetr permut structur k wellcondit scale smallest diagon entri 1 denot maximum diagon entri among layer assumpt much larger 1 note assumpt made without loss gener could assum sinc could place diagon entri layer unfortun complex algorithm grow quadrat p furthermor upper bound forward error degrad p increas see 39 thu tacit assumpt number layer p larg write partit form pc c correspond partit partit similarli assumpt say 1 layer wl problem context electr network assumpt mean sever distinct class wire circuit resist wire class l order 1ffi l instanc one class wire might transmiss line wherea class might consist broken wire open line resist much higher context heat equilibrium equat layer assumpt mean object consider compos small number differ materi within materi conduct ffi l constant differ materi differ conduct linear program take mean slack variabl current interiorpoint iter small other larg limit case layer wl occur gap ffi l tend infin ffi 1 infinit larger ffi 2 weight gap tend infin solut 1 tend solut follow problem refer layer least squar ll construct sequenc nest affin subspac l 0 oe l 1 oe delta delta delta oe l p r n space defin recurs l fminim kd 12 l final x solut ll problem uniqu element l p layer leastsquar problem first introduc vavasi ye 25 techniqu acceler converg interiorpoint method also establish result mention paragraph solut wl problem limit ffi l1 ffi l 0 l converg solut ll problem combin result theorem 1 yield follow corollari also prove vavasi ye corollari 1 let x solut ll problem pose matrix righthand side vector b kxk akbk kaxk akbk choic diagon posit definit weight matric 3 previou work standard iter method leastsquar problem includ wl problem conjug gradient see golub van loan 7 saad 18 appli normal equat 2 algorithm commonli refer cgnr denot sever variant cgnr literatur see eg bjorck elfv strako 2 note variant one form tripl product da appli cg 2 instead one form matrixvector product involv matric trick result substanti save run time sinc da could much denser alon trick applic minresl method use comput experi difficulti cgnr inaccur solut return da illcondit illcondit understand difficulti consid twolay wl problem obtain subtitut 6 case observ sequenc db construct cgnr close word inform 2 2 b 2 lost form krylov sequenc differ framework interpret difficulti describ section 5 anoth iter method leastsquar problem lsqr due paig saunder 15 method share difficulti cgnr work krylov space standard techniqu handl illcondit conjug gradient reorthogon see exampl paig 16 parlett scott 17 reorthogon howev solv difficulti illcondit 2 even act form first krylov vector db caus loss inform anoth techniqu address illcondit linear system iter method call regular typic regular techniqu modifi illcondit system addit term see hank 10 regular appear good approach solv 1 1 alreadi welldefin solut particular theorem 1 impli solut highli sensit perturb data vector b regular techniqu would comput complet differ solut previou work 3 propos iter method 2 base correct standard cgnr search direct sinc drop approach found case seemingli could handl detect algorithm 4 minresl two layer section next consid twolay case 6 consid twolay case separ player case twolay case contain main idea gener case easier write analyz algorithm reduc minr appli 2 henc novel furthermor case expect occur commonli practic mention also twolay wl ll problem consid x22 lawson hanson 13 note preced section twolay wl problem written form 7 diagon entri 1 2 order 1 us introduc new variabl v note equat alway solut v righthand side rang 1 multipli 8 ffi 2 ad 7 yield put 8 9 togeth get x algorithm call minresl minr layer applic minr iter due paig saunder 14 10 note 10 symmetr linear system gener linear system rank defici x v solut solut thu 10 rank defici whenev rank 1 less n mean must address exist uniqu solut exist follow origin wl problem 7 guarante solut uniqu x establish follow add time first row 10 ffi 1 time second row recov origin wl problem 7 sinc 7 uniqu solut 10 must uniqu determin x sinc x uniqu determin 1 v question aris whether minr exact arithmet find solut 10 minr find solut lie krylov space rank defici necessarili full dimension question answer affirm theorem 24 brown walker 4 analysi concern gmre result appli minr exact arithmet furthermor result state assum initi guess 0 comput solut x v minimum norm possibl solut sinc x uniqu determin result impli minimum norm recal section 3 problem appli conjug gradient directli 7 linear system may illcondit henc conjug gradient may return inaccur answer thu may seem paradox remedi problem caus illcondit iter method base truli rankdefici system one explan paradox concern limit behavior 1 case 7 tend linear system system gener uniqu solut 1 assum rank n cgnr comput solut may noth thu cgnr solut expect forward accuraci demand hand see 10 tend x system easili seen lagrang multipli condit twolay ll problem recal section 2 twolay ll problem minim kd 12 subject correct limit behavior wl solut tend ll solut explan minresl converg behavior follow converg analysi two layer section consid converg minresl presenc roundoff error case 2 mention introduct make simplifi assumpt concern effect roundoff error krylov space method assumpt concern either cg minr appli symmetr linear system use algorithm precondition initi guess x use minr c lie rangespac ie system consist use cg posit definit restrict mind assumpt effect roundoff suffici number iter either method comput iter x satisfi c modest constant ffl machin epsilon x true solut multipl solut exist take x minimumnorm solut far know bound rigor prove relat bound prove greenbaum 9 case conjug gradient particular greenbaum result impli 11 would hold cg guarante recurs updat residu drop well machin precis alway happen test case minr less known bound like 11 known hold gmre implement household transform 5 gmre equival minr augment full reorthogon process content assert 11 minr evid come comput experi bound shed light minresl attain much better accuraci cgnr cgnr error bound 11 impli ka da xk get small x comput solut latter quantiti xk recal seek bound forward error xk case factor greatli skew norm close zero bound kx gamma xk independ ffi 1 ffi 2 5 expect satisfi cgnr confirm comput experi contrast analysi minresl start 11 yield accuraci bound 5 need follow preliminari lemma theta n matrix rank n r theta n submatrix suppos linear system consist c given vector given diagon posit definit matrix solut x delta kck 12 furthermor exist solut x satisfi proof first note follow preliminari result let hk two symmetr n theta n matric h posit semidefinit k posit definit let b nvector rang space h h converg solut prove reduc diagon case use simultan diagon hk let extens theta diagon matrix obtain fill zero sinc limit solut x note preced paragraph let theta diagon matrix 1s diagon posit correspond zero elsewher ck ck 15 ffl0 delta kck last line obtain transpos 4 prove 12 note hold x satisfi c sinc latter equat uniqu determin ax similarli demonstr 13 start 15 ck ffl0 ck second part proof observ first part thu ffl0 axk combin 12 prove 14 resum analysi minresl defin x v solut comput minresl 11 appli yield bound formula h 2 shorthand coeffici matrix 10 extract anoth equat 16 17 particular multipli 16 multipli 17 ffi 1 add elimin term involv v let x exact solut wl problem last two term equat replac term involv x use 7 interchang left righthand side yield goal deriv accuraci bound like 5 18 19 start bound quantiti righthand side 18 note bound largest entri 1 2 bound bound kxk akbk use theorem 1 next turn bound kvk 18 recal mention preced section v uniqu determin minr find minimumnorm v satisfi 10 recal v determin constraint one way pick v make minim ka 2 vk subject constraint case v layer leastsquar solut righthand side data b yield bound choic v factor improv use analysi gonzaga lara 8 combin x v contribut mean bound righthand side 18 let us rewrit 18 new bound next write new equat r observ r 1 lie rang tand find h 1 satisfi similarli 17 exist h 2 satisfi appli 13 r 1 r 2 separ c lemma taken first r 1 r 2 conclud 21 22 substitut 21 22 19 yield notic analog 7 preced equat exactli weight leastsquar comput unknown righthand side data thu theorem 1 build chain inequ righthand side preced inequ bound 23 24 righthand side 23 24 bound 20 combin yield obtain preced inequ use fact assumpt kdiagd gamma1 assumpt sinc smallest entri taken 1 thu error bound form 5 desir particular depend error bound ffi 2 ffi 1 note bound depend recal defin maximum entri assum small inde note section 2 alway assum will divid problem mani layer 6 minresl p layer section present minresl algorithm player wl problem algorithm applic minr symmetr linear system h p squar matrix size 1 12n theta 1 pp gamma 12n c p vector order w vector unknown matrix h p partit 1 block size n theta n vector c p w similarli partit wl solut vector first subvector w detail vector w compos x concaten ppgamma12 nvector denot v ij lie lie recal player wl problem may written let x solut equat see equat lie span therefor exist solut v equat equat first blockrow h word first block row h p contain one copi matric first block c p gener p 1th blockrow h equat complet descript blockrow establish properti blockrow postpon descript blockrow lemma suppos w solut linear equat 28 denot concaten x v ij x solut wl problem 26 proof multipli 28 ffi sum p equat obtain manner observ v ij term cancel end exactli 26 also need convers true lemma 3 suppos x solut 26 exist vector v ij 28 satisfi proof proof induct decreas assum alreadi determin v ij 28 satisfi must determin v kj particular valu k base case induct select v satisfi 28 case lie rang 26 induct case k p rewrit 28 case multipli recal goal choos v kj make equat valid multipli 28 add 29 rearrang summat cancel common term lefthand side end divid ffi k separ v kj term second summat yield 26 know lie rang rightmost summat 31 also lie rang therefor exist v kj choic make 29 valid algebra step use deriv 31 29 revers prove lemma note preced proof actual demonstr strengthen version lemma strengthen version state given x satisfi 26 k vector v ij k satisfi 28 extend given data solut 28 strengthen version need explain remain pp gamma 12 blockrow h p row exist sole purpos make h p symmetr first order variabl equat correctli variabl list order x v first equat list order 28 1 mean first p row h p format p p theta p gamma 1p gamma 22 matrix furthermor easili check p symmetr first blockrow first blockcolumn consist list order 1st entri main diagon gammaffi p ffi block zero defin h p defin c p pp gamma 12 block zero exampl follow linear system h 3 x must consid whether solut particular must demonstr new group equat first p row w 0 denot first p block w studi structur p see index correspond column p correspond variabl v ij rang row index j exactli two nonzero block entri yield equat task therefor show simultan satisfi 28 approach select v pj order v particular assum v alreadi select defin v pj solut follow lemma show linear system consist lemma 4 v pj chosen revers order satisfi 33 step linear system consist 32 satisfi proof proof revers induct j base case case 33 solut note lie span case vacuous true specifi rang consid case rang start version 33 satisfi v pi hold induct hypothesi move term first summat righthand side second line obtain first appli 32 induct j 32 taken k third line obtain merg two summat right notic preced equat mean v pi satisfi linear system v pj 33 except righthand side scale prove 33 consist j case sinc construct solut although linear system necessarili uniqu solut linear system form uniqu determin ax thu also prove result actual strengthen 32 j equat need specif case reader may notic preced proof appar complic could establish result simpli solv v ppgamma1 33 set v 2 simpler approach yield bound kv pj k need next section proof show method select v consist satisfi 32 also see 27 satisfi follow immedi take 33 complet proof solut h p need verifi 28 case recal proof lemma 3 remain v ij determin sequenti use construct proof thu argument section establish follow theorem theorem 2 exist least one solut w h p solut first n entri vector x solv 26 7 converg analysi p layer converg analysi p layer follow basic outlin converg analysi two layer particular use 11 start point error analysi observ 11 norm true solut righthand side thu appli bound must get norm bound v ij start bound v pj appli lemma 1 33 case lemma take note lie rang 33 consist righthand side 33 case form c note kd p b 1kbk thu 12 deriv third line second use fact kd gamma1 use line reason get bound v ppgamma2 base 33 case 2 case righthand side 33 thu kck bound ffi pgamma2 continu argument induct time bound grow factor 2 take account fact v pi appear righthand side equat determin v pigamma1 end conclud next must bound v ij 1 vector determin 28 find solut 28 first solv z alreadi known consist furthermor preced equat set v use 12 conclud claim p prove induct decreas use recurr 36 righthand side 36 bound 35 remain term bound induct hypothesi omit detail righthand side 11 need bound kv ij k note uniqu determin v ij recal case lemma 1 use bound ka k v ij k forc uniqu determin choos v ij proof lemma 1 yield 14 note minr necessarili select v ij minim properti theorem 24 brown walker 4 describ section 4 select v ij whose norm larger preced bound appli 11 factor righthand side name easili seen bound p w solut comput minresl let substitut 37 righthand side 11 yield let r first p blockentri r note r j must lie span order equat h solut seen 28 p 1st blockrow us find h solv r 13 know ka let x first n entri comput wl solut multipli p gamma i1st block row h add p row obtain third line obtain second interchang order summat thu see third line solv wl problem ith entri data vector rang conclud data vector bound norm k theorem 1 impli substitut 38 yield delta 4 bound form 5 desir comput experi section present comput experi minresl cgnr compar accuraci effici first test involv small nodearc adjac matrix remain test matric aris linear program boundari valu problem test conduct matlab 42 run intel pentium microsoft window nt 40 matlab softwar packag program languag numer comput written mathwork inc comput ieee doubl precis machin epsilon approxim 22 matlab spars matrix oper use test implement cgnr base cgls1 32 bjorck elfv strako 2 author conclud cgls1 good way organ cgnr two matrixvector product per cgls1 erat one matrix 12 one 12 implemen tation cgnr iter termin scale comput residu ks k kka dbk drop 10 gamma13 implement minr base 14 except given rotat use instead 2 theta 2 household matric inconsequenti sign differ minresl iter termin scale comput residu first matrix use follow test reduc nodearc adjac matrix graph depict figur 1 nodearc adjac matrix contain one column node graph one row edg row contain exactli two nonzero entri 1 gamma1 column correspond endpoint edg choic endpoint assign 1 assign gamma1 induc orient edg often orient irrelev applic reduc nodearc incid rnai matrix obtain nodearc incid matrix delet one column rnai matric aris analysi electr network batteri resistor see 23 also aris network flow problem case figur 1 column correspond figur 1 base graph use first group test column correspond top node delet edg mark heavi line weight 1 edg mark light line weight vari test test top node delet thu 9 matrix well known rnai matrix connect graph alway full rank rnai matric known small valu 23 test weight matrix two layer took vari experi experi row correspond 2 drawn thinner line figur 1 final righthand side b chosen first prime number result display tabl 1 case plot figur 2 scale error tabul plot case defin k x gamma xkkbk choos particular scale error goal investig stabil bound 5 true solut x comput use cod method 12 note accuraci cgnr decay ffi 2 get smaller wherea minresl accuraci stay constant minresl requir mani flop cgnr system matrix larger run time cgnr first four row tabl illcondit increas last two row run time cgnr drop matrix da masquerad lowrank matrix small valu ffi 2 caus earli termin lanczo process besid return inaccur solut cgnr addit difficulti residu quantiti normal measur practic use algorithm reflect forward error simpl way tabl 1 behavior twolay minresl algorithm compar cgnr decreas valu ffi 2 error report scale error defin text note cg accuraci degrad minr accuraci stay minresl minresl minresl cgnr cgnr cgnr iter error flop iter error determin whether cgnr comput good answer contrast error residu minresl close correl correl predict theori next comput test involv larger matrix taken netlib linear program test set name matrix problem afiro 51 theta 27 use matrix 1s first 27 diagon posit remain 24 posit ie righthand side vector b chosen contain first prime minresl requir 137 iter 250 kflop yield solut x scale error 30 respect true solut comput cod method matrix known cgnr problem requir 69 iter 61 kflop return answer scale error 22 converg plot depict figur 3 excess number iter requir minr appar caus loss orthogon lanczo process verifi hypothesi ran gmre layer matrix gmre 19 symmetr matrix equival minr full reorthogon exact arithmet two algorithm ident call algorithm gmresl termin test use result depict figur 4 case gmresl ran 50 iter fewer 1 return accur answer one forward error howev number flop higher 350 k scale error scale residu scale error scale residu figur 2 converg behavior cgnr minresl rnai test case plot plot follow xaxi iter number algorithm comput ie recurs updat residu plot rather true residu experi report indic usual indistinguish theta yaxi indic cutoff cgnr scale residu must drop order 11 true ffi yaxi analog minresl figur 3 converg behavior cgnr minresl afiro curv label figur 2 gramschmidt process gmre main loop next comput test involv larger matrix aris finiteel analysi applic solut boundari valu problem r delta polygon domain depict figur 5 dirichlet boundari condit conduct field c 1 outer part domain 10 12 darker triangl discuss 24 type problem give rise weight leastsquar problem encod inform geometri encod illcondit conduct field valu matrix known although bound known variant paramet particular matrix 652 theta 136 righthand side vector b chosen accord dirichlet boundari condit describ 24 minresl method problem gave scale error 13 iter 65 mflop comput true solut use nshi method 24 case surprisingli cgnr gave almost accur answer termin test never activ cut cgnr 10n iter residu cgnr quit oscillatori depict figur 6 finiteel literatur cgnr would refer conjug gradient assembl stiff matrix da caus odd behavior cgnr follow note region high conduct incid boundari domain figur 4 converg behavior gmresl delta delta figur 5 domain finit element mesh use finit element exper iment conduct dark triangl 10 12 light triangl figur converg cgnr minresl finit element test problem curv label figur 2 thu start righthand side alreadi almost zero furthermor righthand side nearli orthogon span domin stiff matrix da thu cgnr troubl make progress surprisingli accur answer cgnr exampl use practic appar way detect converg underway final test threelay problem base matrix adlittl netlib test set 138 theta 56 matrix matrix first 28 diagon entri 1 next 28 diagon entri 10 gamma8 last 82 entri righthand side vector first 138 prime number converg depict figur 7 expect scale error minresl decreas scale error cgnr 03 note excess number iter requir minresl appar due loss orthogon number iter 118 gmresl achiev scale error 94 fact test gmresl effici minresl term flop count case see minresl algorithm perform essenti expect except two case loss orthogon caus mani iter expect everi case minresl run time higher cgnr cgnr produc bad solut measur forward error figur 7 converg cgnr minresl adlittl curv label figur 2 note excess number iter minresl caus loss orthogon 9 issu interiorpoint method section describ issu aris use minresl algorithm interiorpoint method linear program full consider matter postpon futur work well known system equat newton step interiorpoint method express weight leastsquar problem precis consid linear program problem subject whose dual subject ay standard form except transpos consist leastsquar notat primaldu method start feasibl interior point problem comput updat deltay satisfi algorithmdepend paramet usual 0 1 dualiti gap e vector 1s see wright 26 sinc 40 form wl problem obtain deltay use minresl algorithm one way comput delta via delta gammaadeltay method stabl delta small entri posit small en small entri must comput accur respect correspond entri contrast error compon delta aris product adeltay order ffl delta ksk ffl machin epsilon direct method accur comput compon delta propos hough 11 obtain bound form delta consid method extend minresl accur comput delta futur work note hough deltax easili comput delta similar accuraci bound assum delta satisfi 41 conclus present iter algorithm minresl solv weight least squar theori comput experi indic method accur cgnr weight matrix highli ill condit work rais number question 1 iter method requir layer assumpt 2 layer inde requir get parsimoni layer linear system p 3 particular 3n theta 3n system equat desir properti 3layer case instead 4n theta 4n system present 3 best way handl loss orthogon minr observ section 8 4 work extend stabl comput deltax delta interiorpoint method question rais section 9 5 precondit comput test ran minr cg n iter aim comput solut vector accur possibl prac tice one hope converg much fewer n iter techniqu precondit wl problem note analysi minresl accuraci section 5 section 7 presuppos precondition use acknowledg help discuss work ann greenbaum mike overton nyu roland freund david gay margaret wright bell lab patti hough sandia rich lehoucq steve wright argonn homer walker utah state zdenek strako czech academi scienc thank patti hough gail pieper care read earlier draft paper addit receiv netlib linear program test case matlab format patti hough r numer method least squar problem stabil conjug gradient lanczo method linear least squar problem iter method weight least squar gmre nearli singular system numer stabil gmre linear leastsquar problem diagon domin weight matric matrix comput note properti condit number estim attain accuraci recurs comput residu method conjug gradient type method illpos problem stabl comput search direct neardegener linear program problem complet orthogon decomposit weight least squar solv least squar problem solut spars indefinit system linear equat lsqr algorithm spars linear equat spars least squar practic use symmetr lanczo process orthogon lanczo algorithm select reorthog onal iter method spars linear system gmre gener minimum residu algorithm solv nonsymmetr linear system scale project pseudoinvers framework equilibrium equat dantzigwolfelik variant karmarkar interiorpoint linear program algorithm stabl numer algorithm equilibrium system stabl finit element problem wild coeffici primaldu interior point method whose run time depend constraint matrix tr