random walk truncat cube sampl 01 knapsack solut solv open problem concern mix time symmetr random walk ndimension cube truncat hyperplan show polynomi n consequ obtain fulli polynomi random approxim scheme count feasibl solut 01 knapsack problem result extend case fix number hyperplan key ingredi analysi combinatori construct call balanc almost uniform permut independ interest b introduct posit real vector real number b let denot set 01 vector x geometr view set vertic ndimension cube f0 1g n lie one side hyperplan combinatori set feasibl solut 01 knapsack problem dene b think weight set n item b capac weight limit knapsack 11 correspond vector xand subset item x whose aggreg weight exceed knapsack capac given 1g shall write ax weight x ie i2x paper concern problem comput ie count number feasibl solut knapsack problem problem pcomplet exact form aim good approxim algorithm specic fullypolynomi random approxim scheme fpra wellknown relationship base selfreduc 12 11 equival construct polynomi time algorithm sampl element almost uniformli random recent year steadi stream result kind pcomplet count problem see exampl 13 11 8 survey howev 01 knapsack problem still stand preliminari version paper appear proceed 40th ieee symposium foundat comput scienc octob 1999 pp 230240 depart statist evan hall univers california berkeley ca 94720 email morrisstatberkeleyedu support nsf graduat postdoctor fellowship nsf grant ec 9873086 z comput scienc divis soda hall univers california berkeley ca 947201776 email sinclaircsberkeleyedu support part nsf grant ccr9505448 ccr9820951 one small hand canon problem far resist attack inde quot open problem sever place 4 11 13 15 interest stem part combinatori signic appeal geometr structur part challeng pose exist method paper resolv issu construct fpra 01 knapsack problem along way introduc new machineri believ use tackl problem similar avor possibl beyond almost known approxim count algorithm proceed simul suitabl random walk set interest walk construct converg uniform distribut simul walk sucient mani step therefor allow one sampl almost uniformli thu approxim j applic method key step establish random walk rapidli mix ie get close uniform distribut polynomi number step case 01 knapsack solut particularli simpl natur random walk propos current state x 1 pick item ng uniformli random uar 2 2 x move x fig move x fig otherwis noth process may equival view nearest neighbor random walk portion cube f0 1g n truncat hyperplan probabl move neighbor 1 call graph g avoid technic issu involv period add everi state hold probabl 1 ie probabl 1do noth els make move describ easi check random walk converg uniform distribut howev despit much recent activ analysi mix time random walk decept simpl exampl still known rapidli mix strong geometr intuit random walk entir cube f0 1g n rapidli mix truncat hyperplan presum creat bottleneck would sever slow converg nonetheless best known bound mix time remain expo p nlog n 52 4 beat trivial bound expon still exponenti paper prove random walk inde rapidli mix mix time 92 step 0 immedi impli exist fpra count knapsack solut also present nontrivi extens result case multipl hyperplan precis multipl constraint form j x b j nonneg vector j 1 also abl prove mix time c c constant xed number hyperplan expon c depend number hyperplan inevit hard prove lower bound n mix time moreov possibl encod nphard problem number hyperplan permit depend n would expect polynomi time sampl algorithm case prove rapid mix use techniqu base multicommod ow see 16 rout unit ow pair vertic xy g simultan way edg carri much ow random walk rapidli mix techniqu well known previou applic eg 9 10 made use degener ow mention pass result extend 01 case gener cube form extens pure technic requir substanti new idea omit detail ow rout along singl canon path though see 1 16 except analysi seem reli essenti spread ow along multipl path key ingredi analysi specic path achiev via auxiliari combinatori construct believ independ interest nd applic elsewher note shortest path pair vertic xy g view permut symmetr dierenc x set item must ad remov knapsack pass x natur approach dene good ow use random permut ow spread evenli among shortest path edg overload howev fundament problem approach random permut tend violat knapsack constraint mani item ad intermedi point slightli less obvious symmetr problem aris random permut tend remov mani item intermedi point caus congest among edg hypercub near origin avoid problem want permut remain balanc sens item ad remov approxim correct rate throughout path also want sucient random ensur well spread ow specic turn requir distribut initi segment view unord set almost uniform call permut properti balanc almost uniform permut main contribut paper show exist permut remaind paper structur follow begin necessari background ow rapid mix section 2 establish rapid mix knapsack random walk technic simpler case item weight lie rang 1 b constant b analysi two part section 3 show construct balanc almost uniform permut section 4 use dene good ow extend everyth gener case section 6 extens multipl constraint handl section 6 involv extend construct balanc almost uniform permut scalar weight vector arbitrari dimens may independ interest 2 mix time multicommod ow indic earlier view element either 01 vector commonli subset x equival 1g recal i2x weight x bg without loss gener assum b consid symmetr random walk portion g hypercub f0 1g n dene introduct walk connect state commun via zero vector aperiod hold probabl sinc transit probabl symmetr distribut time converg uniform distribut regardless initi state goal bound rate converg measur mix time dene min initi state p distribut walk time u uniform distribut k k denot variat distanc 2 thu mix number step requir start initi state get variat distanc uniform distribut 1 4 2 probabl distribut variat distanc dene standard fact geometr converg mix log 1 step suce reduc variat distanc desir fairli standard techniqu see 16 allow us estim mix set suitabl multi commod ow underli graph g task rout one unit ow x order pair vertic xysimultan ow f orient edg e g let fe denot total ow along e ie fe sum order pair xy ow carri e dene e fe maximum ow along edg normal j lf length longest owcarri path follow theorem 3 special case result 16 see also 3 2 theorem 21 16 ow f mix time bound mix 4nn bound mix construct ow small valu c l bring main conceptu idea focu initi term bound ratio case weight lie rang 1 b constant b deriv bound form case introduc addit technic complic go get uniform bound gener case 0 remark note bound mix time slightli larger upper bound 3 one obtain appli theorem 21 hypercub without hyperplan see eg 17 turn somewhat true mix time log n hand fairli easi obtain lower bound log n mix time truncat cube consid exampl instanc log n item weight 1 n log n item weight n knapsack capac explain introduct ow base idea balanc almost uniform permut devot next section topic return knapsack random walk section 4 balanc almost uniform permut begin dene notion balanc almost uniform permut write sm denot set permut denit 31 let fw set real necessarili posit weight permut 2 sm balanc everi k 1 k thu balanc permut one whose partial sum uctuat wide particular denit 32 let random permut sm let 2 r call uniform permut everi k 1 k everi u cardin k initi segment 3 note theorem appli symmetr random walk connect subgraph hypercub f0 1g n transit made neighbor probabl 1 note uniform random permut probabl 2 would exactli everi u uniform permut probabl permit vari u amount speci paramet applic xed polynomi function case call almost uniform permut perhap surpris result section ratio weight bound possibl construct almost uniform permut guarante balanc section 51 show dispens restrict weight theorem 33 let fw set weight jw constant b 1 exist balanc almost uniform permut fw g assum rst show discharg assumpt later let dene mean consid arbitrari permut 2 sm induc permut call 1 good everi k 1 1 1 analog denit 2 call good 1 2 good thu good permut partial sum posit neg weight close expect valu suppos chosen uar sm routin applic hoed bound partial sum see lemma a11 appendix yield pr good 2m exp 2 2 set ln probabl 2 consid modi sampl space select uar among permut shall write pr unif probabl origin uniform space distinguish modi space calcul event e sm posit construct balanc almost uniform permut let chosen uar mgood permut let 1 2 induc permut get balanc permut interleav 1 2 follow take rst element 1 ie set thereaft k 1 turn set k next element 2 next element 1 otherwis sinc process wellden yield permut 2 sm moreov sinc jw j clear satis balanc condit 1 need verifi uniform condit 2 arbitrari ju j k1 4 formal view 1 biject i1 similarli 2 throughout shall adopt convent appropri without comment second inequ follow 5 routin calcul involv stirl formula see lemma a12 appendix allow us relat 1 1 2 specic becom exp c 0 univers constant quantiti l measur deviat number k posit neg element u expect valu respect sinc balanc good element size vari much jlj fact larg formal intuit note rst sinc good condit 3 1 2 kg sinc balanc also know j togeth 8 assumpt b impli follow bound jlj plug valu jlj expon 7 bound sucient larg km sinc km 2 1 2 1 thu 7 becom veri uniform condit 2 conclud proof theorem special case extend argument gener valu w use simpl trick assum w 0 case w 0 entir symmetr begin pad sequenc weight wmd except possibl last argument case construct balanc almost uniform permut 0 pad sequenc though see remark immedi follow proof let induc permut weight fw g n claim also balanc almost uniform see balanc note k 0 k use balanc properti 0 see almost uniform let us call indic true remaind fake let u arbitrari subset true indic cardin k need show sinc induc 0 probabl bound event 0 sum form u u 0 element u 0 fake almost uniform 0 sum pr unif e 12 pr unif denot probabl uniform distribut permut smd sum 12 expect uniform distribut random variabl indic rv e thu x count number event e occur claim complet veric condit 11 replac sum 12 ex give requir form sinc see claim 13 let e event condit e let r posit 0 last element u u 0 r 2 u also let posit next true element ie 0 true 0 fake r element exist let hold precis set number set number fake element fall true element posit r next true element posit plu one expect quantiti uniform distribut plainli 1 m1 plug 14 get valu claim 13 conclud proof almost uniform remark point pad sequenc introduc second part proof might contain one weight whose absolut valu less one thu strict sens special case earlier case assum weight absolut valu rang 1 b howev care treatment analysi lead equat 10 show equat still hold even singl small weight even constant number small weight furthermor make constant c 0 appear 10 independ b follow algebra second part proof start equat 10 note hard check result permut uniform constant cb increas b moreov also easi verifi permut actual satis slightli stronger uniform properti name u ju 1 get valu c 0 must rst choos u l second choic introduc make use fact section 5 discuss permut gener weight 4 good ow bound ratio case return random walk knapsack problem esh sketch ow present introduct make heavi use balanc almost uniform permut section 3 continu consid bound ratio case ie assum weight lie rang 1 b avoid trivial also assum b b let xy two arbitrari vertic g view subset ng need specifi rout one unit ow x first write disjoint alway done sinc 2 1 b write similarli ow leav x pass x 1 ow arriv pass 1 x 1 1 rout ow use almost uniform permut note obviou correspond unit ow x 1 1 probabl distribut path let arbitrari enumer weight item weight 1 appear posit sign weight x 1 neg sign thu describ ow x three stage stage 1 send entir unit ow along singl path x x 1 remov element x 0 index order stage 2 distribut unit ow along geodes path x 1 1 accord balanc almost uniform permut weight fw g item stage 3 send entir unit ow along singl path 1 ad element 0 index order role stage 1 3 simpli ensur endpoint random path stage 2 least small distanc bound hyperplan accommod small uctuat still present balanc permut let us rst observ ow valid need check owcarri path remain within set obviou stage 1 3 stage 2 follow balanc properti z kth point along owcarri path x 1 1 b last line use fact ax 1 b b henc z next must bound quantiti cf lf ow f dene section 2 lf length longest owcarri path plainli n 2b estim cf must bound ow along edg g conveni fact bound ow fz vertex z clearli also upper bound ow along edg let z arbitrari vertex g dene p z set pair x ow pass z note p pair whose path pass z stage shall bound contribut fz pi z separ simpl sinc stage1 path length b number vertic x x crude bn b contribut fz path bn b j bound hold symmetr p3 z main portion path p2 z present challeng shall actual work e p2 z set pair x lie stage2 path endpoint observ previou paragraph ow contribut p2 z b 2 n 2b time e p2 z recal realli interest ratio fz rather fz accordingli follow earlier analys gener type see eg 9 10 measur set e p2 z associ element encod z 0 belong dene complement z multiset precis see z 0 need check az 0 b follow b second line use balanc properti 16 bound az time mani pair x could map given z 0 first note z 0 uniqu determin via relat thu particular pair share symmetr dierenc cardin say determin x 1 1 uniqu suce specifi subset u element alreadi process ie ad delet stage2 path time reach z know fact stage2 path geodes x 1 agre z u z 0 u vice versa 1 formal upshot forego discuss dene map e p2 z pair form z 0and u subset z z 0 moreov crucial map inject therefor eectiv enumer set e p2 z final need take account actual quantiti ow travel along path consid p2 z correspond pair z recal ow distribut x 1 1 determin balanc almost uniform permut weight proport ow pass z precis almost uniform properti put togeth bound total contribut fz e p2 z follow z 0x z 0x polyn z 0x summat j total contribut stage2 path thu polynj j combin earlier bound stage 1 3 obtain fz polynj dierent polynomi henc cf polyn sinc lf cf bound polynomi n obtain immedi theorem 21 mix time mix polynomi n keep track polynomi factor see expon domin polyn term aris almost uniform condit 2 form n ob 2 see remark end section 3 summar analysi follow theorem theorem 41 let set solut knapsack problem whose weight lie rang 1 b constant b mix time random walk g mention introduct immedi yield fpra comput j case via standard reduct random sampl whose detail spell 11 5 gener case gener result previou two section case arbitrari weight essenti idea sever nontrivi technic complic need address 51 balanc almost uniform permut handl arbitrari weight rst need extend construct balanc almost uniform permut chief obstacl longer true bound ratio case item posit weight balanc bound number item neg weight overcom diculti need group item interv interv approxim posit neg weight reduc bound ratio case first need slightli liber balanc condit denit 51 let fw set real weight let 1 nonneg number permut 2 sm balanc k earlier denit denit 31 thu correspond 1 relax earlier terminolog slightli shall call 2 sm balanc almost uniform permut balanc xed constant balanc xed polynomi function follow theorem gener theorem 33 say construct balanc almost uniform permut arbitrari set weight moreov bound uniform paramet polynomi whose degre arbitrarili close 12 cost modest increas balanc paramet almost best one hope easi check m2 weight 1 m2 1 constant c p 12 balanc cm p uniform permut sucient larg technic reason shall actual prove slightli stronger uniform properti call strongli uniform everi k 1 k everi u cardin k everi l 2 u note express righthand side 18 time probabl given event chosen uniformli random plainli 18 strengthen equat 2 denit 32 recal equat 15 permut previou section also stronger properti theorem 52 fix 0 1 let 90 set weight fw exist balanc strongli cm 12 uniform permut c univers constant uniform random permut sm let 1 smallest partial sum w absolut valu greater b exist similarli let 2 smallest 1 j way let 1 sequenc fig 2 sequenc continu way divid interv let aggreg weight interv ratio weight two interv b thu result section 3 exist 1balanc uniform permut f g q 1 remark end section fact assum permut strongli uniform sinc b bound constant name 1 p 110 constant c depend call permut claim permut 1 2 q 1 q obtain rearrang rst q 1 interv accord balanc cm 12 uniform permut origin weight prove balanc properti rst let w 1balanc 1 j q henc j sinc partial sum within interv lie rang b final note jw follow j henc balanc verifi strong uniform properti consid rst altern experi permut chosen uar q 1 without regard balanc properti note condit valu q distribut rearrang interv accord uniform measurepreserv transform uniform distribut thu need show u index l u likelihood ratio pr unif write pr unif probabl uniform pr probabl cm 12 uniform fact suce show bound likelihood ratio hold condit x permut order numer nonzero interv contain l contain element u u c complement u addit interv contain l element l must u l must u c let 1 collect interv fi g q 1 contain element u 2 collect interv contain element u c ja must valu either q 1 q 2 write e 1 event event fq likelihood ratio pr unif e 1 case ja 1 jja cq 12 uniform properti ja 1 jja strong cq 12 uniform properti thu strongli cm 12 uniform proof complet 52 ow balanc almost uniform permut gener weight follow similar strategi section 4 construct good ow gener case goal obtain ow f cost assum arbitrari xed let xy arbitrari vertic g recal scheme construct ow x bound ratio case section 4 essenti follow balanc almost uniform permut x except remov constant number item x consider process begin end path ensur path remain within g idea gener case basic except remov xed number item x adddelet repeatedli along path maintain ne balanc moreov appli random permut rst need preprocess pair x neither x close hyperplan contrast bound ratio case guarante remov xed number item possibl larg variat weight howev overcom obstacl randomli switch item x roughli balanc weight result owcarri path gener geodes though length prepar describ ow rst describ preprocess oper assum constant appear theorem 52 applic reduc case delet xed number item x call pair vertic goal shift item randomli x therebi reach pair x full consid follow random walk fx bg current state x choos index probabl 1 noth els move x 0 0 0 x 0 possibl call preprocess random walk prw claim follow lemma run prw number step chosen randomli 1 reason probabl arriv pair x full proof use martingal argument defer appendix lemma 53 let x full pair vertic g uar f1 constant depend let x result run prw step start x prx posit constant c 2 depend readi construct analyz ow gener case lemma 54 arbitrari weight 0 possibl construct multicommod ow f g proof let xy arbitrari vertic g view x subset element xy largest weight let tie broken accord index order dene let fw arbitrari enumer weight item weight item x appear neg posit sign respect let say set indic z good z hand z x h set indic z index dene z fig z fig good z otherwis note l sequenc path x unit hypercub length l path need gener lie within g howev close g sens everi point z path z h full set choos uar constant lemma 53 next let result run prw step start x lemma 53 condit event pair x 00 00 full thu increas probabl path factor c 2 let balanc strongli cm 12 uniform permut weight fw g whose exist guarante theorem 52 claim sequenc dene path x hypercub true condit x 00 full togeth fact balanc guarante transit indic actual take place let l 2t l sequenc 19 ow x essenti follow sequenc j k except along way element h use keep knapsack full possibl remov necessari make room new item j k ad thu intermedi state z form h xj 1 j k h h k l suppos process rst k l element sequenc 19 transit rule follow 1 k l j move z j k1 possibl ie result element otherwis delet element h 2 k l j k1 2 z add element h possibl otherwis move z j k1 3 l add element h possibl otherwis delet element h x fact set good ensur sucient element h alway remov make room add next element j k1 necessari henc rule dene feasibl random path x similarli good also impli everi intermedi state z sinc rule keep weight larg possibl impli intermedi edg z w along path exist one element u 2 h z index exactli analysi section 4 dene encod z 0 thu given edg z w number encod z 0 j note path x natur divid three stage correspond three part sequenc j k write ow given edg g contribut stage path bound f bound three contribut f separ consid stage 1 rst focu particular edg z w pair x send ow z w stage 1 write rst k element process along path thu pair x complet speci k h via easili veri relat amount ow correspond given sequenc bound probabl rst chosen preprocess random walk c 2 k1 factor c 2 aris earlier condit event full thu bound stage1 ow f 1 z w section 4 factor c 1 2 h aris sum k h respect ow f 3 z w stage3 path handl symmetr consid stage2 path given edg z w everi pair x send ow z w stage 2 complet speci z number element sequenc 19 process along path x z amount ow correspond given u bound rst factor come preprocess random walk second factor probabl choos particular third factor upper bound probabl come strong almost uniform thu bound ow f 2 z w section 4 u factor second line written order sum aris ad contribut f 1 f 2 f 3 see ow satis plainli arbitrari complet proof given ow need invok theorem 21 deriv main result theorem 55 let set solut arbitrari instanc 01 knapsack problem mix time random walk g immedi impli exist fpra comput j gener case remark mix time bound 92 theorem 55 reason tight type analysi appli theorem 21 analyz random walk entir cube f0 1g n get bound 3 even optim ow thu truncat introduc extra factor 32 bound instruct see extra factor come 12 due balanc almost uniform permut construct theorem 52 tight come fact encod z 0 may lie outsid 6 multipl hyperplan 61 introduct section extend earlier result handl multipl hyperplan nonneg real n matrix posit real vector let denot set 01 vector ax b vertic constitut set feasibl solut multidimension knapsack problem simultan constraint j x j j ji equat 21 superscript j index jth linear constraint follow convent throughout geometr obtain truncat unit cube hyperplan correspond knapsack constraint essenti geometr properti knapsack hyperplan normal vector lie quadrant result section easili extend collect hyperplan properti 5 5 howev allow hyperplan arbitrari arbitrari truncat allow would possibl use two hyperplan caus exponenti bottleneck even disconnect graph g follow earlier notat identifi 01 vector set indic ddimension weight x denot g subgraph hypercub f0 1g n induc vertic studi symmetr random walk g ie transit given state x ng made follow 1 pick item ng uar 2 2 x move x fig move x fig otherwis noth avoid issu involv period add everi state hold probabl 1 section prove random walk g mix time polynomi bound n xed dimens onedimension case immedi give polynomi time algorithm sampl almost uniformli random fpra comput j note degre polynomi upper bound mix time depend dimens unavoid follow simpl exampl show consid ddimension knapsack problem n 2d item weight vector n remain n item weight vector knapsack capac n let set feasibl solut contain item 2d connect origin follow easili mix time n fact arbitrari uniform polynomi upper bound run time sampl algorithm unless immedi reduct problem sampl independ set graph theorem 117 17 algorithm almost uniformli sampl independ set graph unless e arbitrari undirect graph 11 correspond independ set g feasibl solut knapsack problem jv j variabl jej constraint prove rapid mix random walk g xed use multicommod ow techniqu recal theorem 21 bound mix time term cost ow f hold symmetr random walk connect subset hypercub suce come ow small cost idea spread ow evenli use balanc almost uniform permut howev sinc weight function vectorvalu rst need extend denit balanc higher dimens denit 61 fix integ 0 let fw set weight r satisfi posit real number permut 2 sm balanc thu balanc respect vector weight fw g satis onedimension balanc condit given 22 note gener earlier denit 51 onedimension case except simplic assum construct balanc almost uniform permut signicantli dicult higher dimens sinc one control uctuat dimens simultan fact 2 nontrivi prove arbitrari set vector weight even singl balanc permut exist cours trivial exist permut follow lemma due grinberg sevastyanov 6 prove entir dierent context lemma 62 6 let x vector r exist permut conv denot convex hull cours need someth much stronger name almost uniform permut similar balanc properti perhap surprisingli show balanc almost uniform permut exist arbitrari dimens illustr main idea involv extend one higher dimens give sketch proof special case weight satisfi 1 jw j set let everi project w onto v let 1 almost uniform permut 1 balanc onedimension sens respect fy g i2i 1 similar denit 2 final interleav 1 2 give permut balanc respect fw 2 project w onto second coordin axi sinc 1 2 almost uniform argument similar proof theorem 33 furthermor sinc 1 2 balanc respect project onto v note project satisfi thu everi k project onto second coordin axi onto v bound sinc w j 1 2 angl coordin axi v bound away zero thu partial sum stay insid parallelogram bound diamet henc balanc respect weight fw conclud sketch proof special case 2 note straightforward reduct onedimension result unfortun gener reduct 1 dimens quit straightforward deal extra technic diculti next subsect 62 balanc almost uniform permut arbitrari dimens follow theorem say one alway construct balanc almost uniform permut dimens xed theorem 63 let posit integ constant c polynomi function set weight fw r exist c balanc proof proof induct base case follow theorem 52 arbitrari suppos result hold dimens 1 let fw set weight r suppos rst weight 1jd thu weight least half larg maximum posit neg weight coordin 1jd wlog suppos sum lh maxim w w j dene mean note 1 2d 1 j let 4 p 1 muniform permut c 1 balanc respect fy g i2i call 1 good everi k 1 1 k 1 1 2 g similar fashion proof lemma a11 hoed bound 7 impli particular valu k 1 pr unif 1 satisfi 25 2 exp 2 2 sinc event depend initi segment 1 satisfi 25 p 1 pr unif 1 satisfi 25 henc pr 1 good mp 1 2 exp 2 2 suppos constant c r polynomi p 1 satis p k ck r k rh 26 2cm r1 2r1 1 sucient larg thu assum 1 good probabl 1 increas c constant factor similar argument appli 2 final note alway possibl interleav 1 2 give permut 1balanc respect fw let permut j ik ik ik ik ik ik j k henc c 0 balanc c 0 assumpt 23 verifi almost uniform follow proof theorem 33 let u arbitrari ju j k1 m2 bound quantiti 1 mimick minor modic calcul equat 7 equat 10 proof theorem 33 current set 2d jw 0 2 chang denit good valu also make substitut b respect thu bound expon given equat henc p muniform p shown make balanc almost uniform permut weight satisfi 23 24 gener arbitrari weight fw use interv trick introduc section 51 let uniform random permut sm let similarli use divid interv aggreg ddimension weight rst q 1 interv note divid j result weight satisfi 23 24 henc weight admit c 0 balanc p quniform permut though see remark immedi follow proof rearrang interv fi g q 1 accord permut give permut p muniform c balanc c remark point weight f g q 1 rst q 1 interv gener sum zero howev easili get around introduc dummi weight q equal weight interv q presenc singl small weight aect equat 27 sucient larg henc c 0 balanc p uniform permut pad sequenc f g q induc permut f g q 1 c 0 1balanc cp quniform constant c thu incorpor extra 1 constant c 0 extra factor c p argument proof still valid specifi ow need one denit denit 64 let fw sequenc r w l posit integ permut strongli lbalanc k j exist set l opposit sign either 0 thu strongli balanc permut whenev initi segment fig k averag respect particular coordin j made averag ip xed number l item vice versa name suggest strong balanc condit stricter usual balanc condit nonetheless follow lemma say strongli balanc permut alway exist lemma 65 sequenc fw r exist strongli 16d 2 balanc permut note lemma claim singl strongli balanc permut exist unlik theorem 63 make claim regard almost uniform proof lemma reli heavili result grinberg sevastyanov quot earlier lemma 62 proof straightforward rather technic defer appendix 63 good ow multidimension balanc almost uniform permut strongli balanc permut readi contruct good ow lemma 66 fix number knapsack constraint arbitrari item weight possibl construct multicommod ow f g cf bound polynomi n proof recal identifi vertex xwith index set constant construct balanc almost uniform permut theorem 63 main goal construct ow b f simultan everi xy 2 b send one unit ow x ow satisfi c b f polyn l b note vertex x 2 obtain vertex b remov 3dc item thu use approach similar section 4 extend b f multicommod ow f whole f satisfi cf n 6dc polyn poli 0 n lf l b remain dene ow b f show properti claim fix xy 2 b usual path x follow permut symmetr dierenc x howev onedimension case simpl balanc almost uniform permut permut would necessarili dene path stay problem occur j max i2x j compar max i2i j exampl max i2x j path could much variat jdirect approach howev deal problem consid larg small item xy separ g let larg small item respect let fw g i2xi enumer weight item x weight appear posit sign weight x appear neg sign let let i2 w let 1 permut l strongli 16d 2 balanc respect weight fw g i2l let 2 p jsjuniform permut c balanc respect weight fw 2 g i2 exist 1 2 guarante lemma 65 theorem 63 respect obtain interleav strongli balanc permut 1 balanc permut 2 rule interleav follow suppos alreadi assign g k2 dene let claim satis follow condit fix j k exist set indic v 1 v 2 jv prove case 1 j proof similar let k g method interleav ensur therefor sinc 1 j clearli strong balanc condit 1 impli exist 0 ja similarli 0 also balanc condit 2 g exactli analog relat hold b replac b combin equat 3035 give 28 29 determin path fz g jxi j i0 x z 1 jx j path might stay alter slightli equat 28 29 impli everi k j exist set indic w j k k k jw k j 34d 3 z k 2 ow x pass z k turn get z k z k1 perform follow step 1 remov item z k z k z k1 index order 2 add item z k1 z k z k1 index order analog section 4 5 intermedi point z along path dene encod z 0 let kg similar fashion earlier analysi one see given z complet speci 4tupl z second inequ follow 37 henc z 0 2 therefor bound ow fz z z 0x wxwyu final given x let g note everi j l j equal either l j thu dene k k 2 2 jsj possibl valu u inner sum equat 38 therefor z 0x mwxwi k 2 z 0x mwxwi k 2 z 0x mwxwi k 2 z 0n polynj second line appeal almost uniform permut 2 complet proof given ow appeal theorem 21 deriv main result section theorem 67 fix dimens 0 let set solut arbitrari instanc ddimension 01 knapsack problem mix time random walk g poli n one dimens immedi impli exist fpra comput j gener set acknowledg thank persi diaconi bring refer 6 attent r polytop perman graph larg factor comparison techniqu revers markov chain geometr bound eigenvalu markov chain mildli exponenti time algorithm approxim number solut multidimension knapsack problem valu steinitz constant probabl inequ sum bound random variabl mathemat foundat markov chain mont carlo method approxim perman markov chain mont carlo method approach approxim count integr random gener combinatori structur uniform distribut markov chain polynomi time algorithm random walk convex set lectur improv bound mix rate markov chain multicommod ow randomis algorithm count gener combinatori structur tr