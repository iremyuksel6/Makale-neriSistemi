maximum likelihood estim mixtur densiti bin truncat multivari data bin truncat data common data analysi machin learn paper address problem fit mixtur densiti multivari bin truncat data em approach propos mclachlan jone biometr 44 2 571578 1988 univari case gener multivari measur multivari solut requir evalu multidimension integr bin iter em procedur naiv implement procedur lead comput ineffici result reduc comput cost number straightforward numer techniqu propos result simul data indic propos method achiev signific comput gain loss accuraci final paramet estim furthermor experiment result suggest suffici number bin data point possibl estim true underli densiti almost well data bin paper conclud brief descript applic approach diagnosi iron defici anemia context bin truncat bivari measur volum hemoglobin concentr individu red blood cell b introduct paper address problem fit mixtur densiti multivari bin truncat data problem motiv applic medic diagnosi blood sampl taken subject typic sampl contain 40000 differ red blood cell volum hemoglobin concentr red blood cell measur cytometr blood cell counter produc output bivari histogram 100 theta 100 grid volum hemoglobin concentr space eg figur 1 bin contain count number red blood cell whose volum hemoglobin concentr fall bin known data truncat ie rang machin measur less actual possibl rang volum hemoglobin concentr valu present gener solut problem fit multivari mixtur densiti model bin truncat data bin truncat data aris frequent varieti applic set bin occur systemat measur instrument finit resolut eg digit camera finit precis pixel intens bin also may occur intent realvalu variabl quantiz simplifi data collect eg bin person age rang 0 10 1020 forth truncat also easili occur practic data collect context whether due fundament limit rang measur process intent reason bin truncat one think origin raw measur mask bin truncat process ie know exact locat data point within bin mani data point fall outsid measur rang natur think problem one involv miss data expectationmaxim em algorithm obviou candid model fit probabilist context theori fit finit mixtur model univari bin truncat data maximum likelihood via em algorithm develop mclachlan jone 1988 problem somewhat simpler form address earlier demp ster laird rubin 1977 em algorithm origin introduc univari theori mclachlan jone 1988 extend straightforward manner cover multivari data howev implement subject exponenti time complex numer instabl requir care consider focu present paper section 2 extend mclachlan jone result univari mixtur estim multivari case section 3 present detail discuss comput numer consider necessari make algorithm work practic section 4 discuss experiment result simul data aforement red blood cell data basic theori em bin truncat begin brief review em algorithm gener form em algorithm gener procedur find maximum likelihood model paramet part data miss finit mixtur model underli assumpt gener model data point come one g compon distribut howev inform hidden ident compon gener point unknown knew inform estim paramet maximum likelihood would direct least singl normal popul estim mean covari paramet compon separ use data point identifi compon rel count data point popul would maximum likelihood estim weight compon mixtur model regardless compon distribut think two type data observ data miss data ac cordingli observ likelihood one want maxim full likelihood one includ miss data typic easier maxim em algorithm provid theoret framework enabl us iter maxim observ likelihood maxim expect valu full like hood fit gaussian mixtur em iter quit straightforward wellknown see mclachlan basford 1988 bishop 1995 tutori treatment em gaussian mixtur see littl rubin 1987 mclachlan krishnan 1997 discuss em gener context bin truncat two addit sourc hidden inform addit hidden compon ident data point mclachlan jone 1988 show use em algorithm type problem underli finit mixtur model written weight individu compon f compon densiti function mixtur model parametr phi set mixtur model paramet g overal sampl space h divid v disjoint subspac h bin count first r bin observ count last bin miss observ likelihood associ model irrelev constant term given jone mclachlan r n total observ count r p repres integr probabl densiti function pdf bin z z r form likelihood function correspond multinomi distribut assumpt bin occup invok em machineri first defin sever quantiti pth iter phi p p repres current estim model paramet e p denot condit expect given random variabl belong jth bin use current valu unknown paramet vector eg expect valu respect normal current pdf fx phi p p j phi p specif function gx z also defin c p p quantiti lefthand side superscript p depend current paramet estim phi p andor p term intuit interpreta tion exampl j repres gener bin count unobserv data either equal actual count observ bin ie j r repres condit expect count unobserv bin ie j r condit expect count formal notion say 1 pdf mass unobserv bin assign 1 total data point x posterior probabl membership ith compon mixtur model given x observ individu repres rel weight mixtur compon point x intuit probabl data point x belong compon c measur overal rel weight compon note order calcul c local rel weight x averag bin weight count bin sum bin way data point within bin contribut c averag local weight bin ie compar nonbin data data point contribut c actual local weight evalu data point valu data point next use quantiti defin last equat defin estep express close form solut mstep iter p x p c p oe p1 c p equat specifi compon weight ie compon mean ie compon standard deviat ie oe updat em step note main differ standard version em nonbin data come fact take expect valu bin ie e p data point within bin contribut correspond valu averag bin wherea nonbin case point contribut valu evalu data point gener multivari case theori need gener equat 68 vectorcovari case c p x p c p c p multivari theori straightforward extens univari case practic implement theori consider complex due fact approxim multidimension integr consider complex univari case note approach guarante maxim likelihood defin equat 1 irrespect form select condit probabl model miss data given observ data differ choic condit probabl model lead differ path paramet space overal maximum likelihood paramet make approach quit gener addit assumpt distribut data requir 3 comput numer issu section discuss approach two separ problem aris multivari case 1 perform singl iter em algorithm 2 setup full algorithm exact time effici main difficulti handl bin data oppos standard nonbin data evalu differ expect valu ie e p em iter defin equat 2 expect valu equat 911 requir integr function v bin integr evalu analyt mixtur model even gaussian mixtur model thu evalu numer em iter consider complic implement em procedur especi multivari data summar present difficulti ffl bin univari space om bin ddimension space consid dimens om bin repres exponenti growth number bin ffl univari space numer integr requir oi function eval uation multivari space requir least oi function evalu compar accuraci integr combin exponenti growth number bin lead exponenti growth number function evalu underli exponenti complex avoid overal execut time greatli benefit care optim integr scheme ffl geometri multivari space complex geometri univari space univari histogram natur endpoint truncat occur unobserv region simpl shape multivari histogram typic repres hypercub unobserv region still rectangular simpl shape exampl 2 dimension histogram four side unobserv region extend infin also four wedg region ffl fix sampl size multivari histogram much sparser univari counterpart term count per bin ie margin spars leverag purpos effici numer integr 31 numer integr em iter e step em algorithm consist find expect valu completedata log likelihood respect distribut miss data step consist maxim expect valu respect model paramet phi equat step singl iter em algorithm expect valu equat ie e p term would repres close form solut paramet updat bin truncat data almost close form solut addit integr still quir one could use varieti mont carlo integr techniqu integr problem howev slow converg mont carlo undesir problem sinc function integr typic quit smooth across bin rel straightforward numer integr techniqu expect give solut high degre accuraci multidimension numer integr consist repeat 1dimension int gration result paper use romberg integr see thist 1988 press et al 1992 detail import aspect romberg integr select order integr lowerord scheme use rel function evalu initi phase may converg slowli higherord scheme may take longer initi phase converg faster thu order select substanti affect comput time numer integr return point later note order affect path converg integr final solut order given prespecifi degre accuraci 32 handl truncat region next problem aris practic concern truncat region ie region outsid measur grid want use mixtur model natur defin whole space must defin bin cover region extend grid boundari 1 1dimension case suffic defin 2 addit bin one extend last bin 1 extend gamma1 first bin multivari case natur defin singl bin r cover everyth data grid explicitli describ outofgrid region reason calcul expect valu whole space h without actual integr mind readili write integr truncat region z r z r z z r z note extra work requir obtain integr righthand side equat basic em equat 911 requir calcul expect valu similar defin equat 2 bin note howev differ expect valu integr righthand side equat 1214 normal constant 1p j phi normal constant affect integr suffic separ record normal unnorm valu integr bin normal valu later use equat 911 unnorm valu use equat 1214 comput effici take advantag spars bin count assum want integr function ie pdf whole grid assum requir prespecifi accuraci integr ffi mean rel chang valu integr two consecut iter fall ffi consid integr converg ffi small number typic order 10 gamma5 less assum perform integr integr bin grid ad result intuit contribut bin larg ie bin signific pdf mass contribut other neglig ie bin contain near zero pdf mass data spars mani bin neglig contribut goal optim time spent integr numer empti bin significantli contribut integr accuraci integr see influenc overal accuraci consid follow simplifi analysi let size bin proport h let mean height pdf approxim f let order pn bin relev pdf mass total number bin rough estim integr bin given fhpn sinc accuraci integr order ffi toler absolut error integr order ffii hand assum irrelev bin valu pdf height order fflf ffl small number estim contribut irrelev bin valu integr 0 fflf h1 gamma pn approxim 0 fflpi spars data ie p small compar 1 estim contribut irrelev bin absolut error integr integr within irrelev bin sinc integr accur least accur part optim scheme contribut error integr irrelev relev bin compar word suboptim also confirm experiment result section choos ffi 0 smaller requir ffi 0 fflp ffi mean integr within bin low probabl mass ie fflf need carri accur note ffl 0 integr less less accur within bin without hurt overal integr full grid note also ffl 0 treshold e figur 2 execut time singl em step function threshold ffl sever differ valu k romberg integr order 2 valu scale eg etc result base fit twocompon mixtur 40000 red blood cell measur two dimens 100 theta 100 bin time second loglikelihood within multipl kmean final loglikelihood k 3 figur 3 qualiti solut measur loglikelihood function time differ variat algorithm becom o1 start use singl iter simplest possibl integr scheme still stay within allow limit ffi 0 summar given valu ffl algorithm estim averag height f pdf bin pdf valu less fflf use singl iter simpl fast integr origin behavior recov set bin integr quickli gener idea provid larg comput gain virtual loss accuraci note ffi control overal accuraci ffl add small correct ffi exampl found variabl paramet estim use differ small valu ffl much smaller bin size andor variabl paramet estim differ random initi condit figur 2 show time requir complet singl em step differ valu k romberg integr order ffl time minim differ valu ffl use 4 greatest choos either low high integr order quit comput ineffici 33 full em algorithm fine tune singl em iter step abl significantli cut execut time howev sinc step still comput intens desir em converg quickli possibl ie iter possibl mind use follow addit heurist take random sampl bin point random coordin point around correspond bin center use uniform distribut within bin em algorithm nonbin nontrunc data rel fast close form solut exist em step without integr em algorithm converg solut paramet space initi data set use paramet initi start point em algorithm full set bin truncat data second applic em use methodolog describ earlier paper refin initi guess final solut typic take iter note initi scheme affect accuraci result loglikelihood full set bin truncat data use final criterion converg figur 3 illustr variou comput gain axi loglikelihood within multipl constant data x axi comput time fit twocompon mixtur twodimension grid 100 theta 100 bin red blood cell count k order romberg integr ffl threshold declar bin small enough fast integr describ earlier paramet choic k ffl result qualiti final solut ie asymmptot loglikelihood eventu use approxim two order magnitud slower use nonzero ffl valu increas ffl 0001 01 result loss likelihood result faster converg compar curv kmean use initi bin algorithm versu random initi method describ earlier show factor two gain converg time random initi summar overal algorithm fit mixtur model multivari bin truncat data consist follow step 1 treat multivari histogram pdf draw small number data point add count bin prevent 0 probabl empti bin 2 fit standard mixtur model sampl use usual em algorithm nonbin nontrunc data 3 use paramet estim step 2 refin use em algorithm full set bin truncat data consist iter appli equat 911 bin within grid appli equat singl bin outsid grid converg measur equat 1 4 experiment result 41 em methodolog experi use follow method paramet implement em ffl standard em algorithm initi run kmean 10 differ initi start point choos em solut highest likelihood avoid poor local maxima ffl k point randomli drawn bin histogram k chosen 10 number total data point 100 point whichev greater point drawn use uniform sampl distribut ffl bin em algorithm initi run standard em algorithm 5 random restart k randomli drawn data point ffl avoid poor local maxima bin em algorithm choos solut highest likelihood solut 10 differ random initi ffl converg standard binnedtrunc em judg chang less 001 loglikelihood maximum 20 em iter whichev come first ffl order romberg integr set 3 ffl set 10 gamma4 ffl default accuraci integr set 42 simul experi simul data twodimension mixtur two gaussian center 150 150 unit covari matric vari number data point per dimens step 10 1000 drew 10 random sampl size n bivari mixtur addit vari number bin per dimens step 5 origin unbin sampl quantiz b 2 bin rang grid extend 55 55 truncat rel rare origin unbin sampl ran standard em algorithm bin data ran bin version em use version em paramet set describ earlier purpos simul observ effect bin sampl size qualiti solut note standard algorithm typic given much inform data ie exact locat data point thu averag expect perform better algorithm bin data learn measur solut qualiti calcul kullbackleibl kl cross entropi distanc estim densiti true known densiti figur 4 averag kl distanc estim densiti estim use procedur describ paper true densiti function number bin number data point bin per dimens differ random sampl kl distanc bin 100 data point per compon standard 100 data point per compon bin 300 data point per compon standard 300 data point per compon bin 1000 data point per compon standard 1000 data point per compon figur 5 averag kl distanc logscal estim densiti true densiti function number bin differ sampl size compar standard em unbin data kl distanc nonneg zero two densiti ident calcul averag kl distanc 10 sampl valu n b bin standard em algorithm total standard bin algorithm run 20000 differ time gener report result figur 4 show plot averag kldistanc bin em algorithm function number bin number data point one clearli see plateau effect kldistanc solut gener true densiti measur qualiti solut rel close zero number bin 20 number data point 500 function n number data point one see typic exponenti decreas learn curv ie solut qualiti increas roughli proport n gammaff constant ff function bin size b appear threshold effect 20 bin solut qualiti rel flat function number bin solut rapid decreas qualiti eg signific degrad figur 5 plot kl distanc logscal function bin size specif valu n compar standard bin version em 3 valu n curv qualit shape rapid improv qualiti move rel flat perform ie sensit b 20 3 valu n bin em track perform standard em quit close number data point kl distanc 5 bin per dimens bin per dimens 100 bin per dimens standard algorithm figur averag kl distanc logscal estim densiti true densiti function sampl size differ number bin compar standard em unbin data differ two becom less n increas variabl curv due variabl 10 randomli sampl data set particular valu b n note b 20 differ bin standard version em smaller natur variabl due random sampl effect figur 6 plot averag kl distanc logscal function n number data point per dimens specif number bin b compar bin algorithm variou b valu standard unbin algorithm overal see characterist exponenti decay linear loglog plot learn curv function sampl size b 20 bin em track standard em quit close result suggest particular problem least em algorithm bin data sensit number bin number data point term compar perform em unbin data certain threshold number bin 20 bin version em appear abl recov true shape densiti almost well version em see origin unbin data volum hemoglobin concentr control 1 hemoglobin concentr volum control 2 hemoglobin concentr volum control 3 hemoglobin concentr volum iron defici 1 hemoglobin concentr volum iron defici 2 hemoglobin concentr volum iron defici 3 figur 7 contour plot estim densiti estim three typic control patient three typic iron defici anemia patient lowest 10 probabl contour plot emphas systemat differ two group 43 applic red blood cell data mention begin paper work motiv realworld applic medic diagnosi base twodimension histogram character red blood cell volum hemoglobin measur see figur 1 mclaren 1996 summar prior work problem onedimension mixturefit algorithm mclachlan jone 1988 use fit mixtur model onedimension red blood cell volum histogram mixtur model particularli use context gener model sinc plausibl differ compon model correspond blood cell differ state cadez et al 1999 gener earlier work mclaren et al 1991 mclaren 1996 onedimension volum data analysi twodimension volum hemoglobin histogram mixtur densiti fit histogram 97 control subject 83 subject iron defici anemia use binnedtrunc em procedur describ present paper figur 3 demonstr improv comput time achiev data figur 3 2compon mixtur model fit control subject 2dimension histogram 40000 red blood cell figur 7 show contour probabl plot fit mixtur densiti 3 control 3 iron defici subject plot lower 10 probabl densiti function sinc differ two popul obviou tail one clearli see systemat variabl within control iron defici group well two group sinc number bin rel larg dimens number data point 40000 simul result previou section would tend suggest densiti estim like rel accur compar run em unbin data cadez et al 1999 use paramet estim mixtur densiti basi supervis classif subject two group result error rate 15 crossvalid experi compar crossvalid error rate 4 subject use algorithm cart c50 directli featur histogram univari mean standard deviat ie use mixtur model thu abil fit mixtur densiti bin truncat data play signific role improv classif perform particular problem conclus problem fit mixtur densiti multivari bin truncat data address use gener mclachlan jone 1988 em procedur onedimension problem multivari em algorithm requir multivari numer integr em iter describ varieti comput numer implement issu need care consider context simul result indic high qualiti solut obtain compar run em raw unbin data unless number bin rel small acknowledg contribut ic ps paper support part nation scienc foundat grant iri9703120 contribut cmcl support part grant nation institut health r43 hl46037 r15hl48349 wellcom research travel grant award burrough wellcom fund thank thoma h cavanagh provid laboratori facil grate dr albert greenbaum technic assist r neural network pattern recognit hierarch model screen iron defici anemia submit icml99 maximum likelihood incomplet data via em algorithm j statist analysi miss data fit mixtur model group truncat data via em algorithm biometr em algorithm extens mixtur model haematolog seri case studi statist method medic research numer recip c art scientif comput element statist comput tr statist analysi miss data element statist comput color index numer recip c 2nd ed intellig multimedia inform retriev histogrambas estim techniqu databas system waveletbas histogram select estim multidimension select estim use compress histogram inform neural network pattern recognit queri imag video content hierarch model screen iron defici anemia ctr nizar bouguila djemel ziou unsupervis learn finit discret mixtur applic textur model imag databas summar journal visual commun imag represent v18 n4 p295309 august 2007