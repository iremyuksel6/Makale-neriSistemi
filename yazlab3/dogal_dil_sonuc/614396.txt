new line integr convolut algorithm visual timevari flow field abstractnew challeng vector field visual emerg timedepend numer simul becom ubiquit field comput fluid dynam cfd visual data gener simul tradit techniqu display particl trace reveal flow phenomena preselect local region thu unabl track evolut global flow featur time paper present new algorithm call uflic unsteadi flow lic visual vector data unsteadi flow field algorithm extend textur synthesi techniqu call line integr convolut lic devis new convolut algorithm use timeaccur valu scatter scheme model textur advect addit algorithm maintain coher flow anim success updat convolut result time furthermor propos parallel uflic algorithm achiev high loadbalanc multiprocessor comput share memori architectur demonstr effect new algorithm present imag snapshot sever cfd case studi b introduct vector field data aris comput simul varieti disciplin comput fluid dynam cfd global climat model electromagnet visual vector data effect challeng problem due difficulti find suitabl graphic icon repres display vector twodimension comput display present new challeng emerg timedepend simul becom ubiquit simul produc largescal solut multipl time step carri complex dynam inform underli simul model visual timevari data two type method gener use one refer instantan method visual creat base instanc data field time visual result streamlin vector plot sequenc discret time step anim togeth instantan method often suffer problem lack coher anim frame incoher anim interfer understand flow field unsteadi phenomena addit streamlin shown given instanc time correspond path particl travel flow chang direct constantli amend problem research develop differ method call timedepend method better character hanwei shen mrj technolog solut nasa ame research center david kao nasa ame research center evolut flow field continu track visual object particl time exampl numer streaklin pathlin 1 2 paper present timedepend method visual vector data unsteadi flow field use line integr convolut lic 3 underli approach propos new convolut algorithm call uflic unsteadi flow lic accur model unsteadi flow advect line integr convolut method origin propos cabral leedom 3 visual techniqu produc continu flow textur resembl surfac oil pattern produc windtunnel experi synthes textur effect illustr global flow direct dens flow field howev lic convolut comput follow trace streamlin steadi flow field readili use visual unsteadi flow data simpl extens comput lic everi time step flow field anim result togeth unfortun approach suffer problem instantan method mention forssel cohen 4 propos extens chang convolut path streamlin pathlin visual timevari vector field method produc better visual unsteadi flow field result anim lack coher consecut frame underli flow fairli unsteadi algorithm extend lic method devis new convolut algorithm simul advect flow trace global unsteadi flow field regular lic algorithm take white nois imag input textur input textur advect time creat direct pattern flow everi time step advect perform use new convolut method call timeaccur valu scatter scheme timeaccur valu scatter scheme imag valu everi pixel scatter follow flow pathlin trace comput use numer integr method everi integr step pathlin imag valu sourc pixel coupl timestamp correspond physic time deposit pixel path everi pixel complet scatter convolut valu everi pixel comput collect deposit timestamp match time correspond current anim frame track flow pattern time maintain coher anim frame devis process call success feedforward drive convolut time process repeat timeaccur valu scatter everi time step instead use white nois imag textur input everi time take result textur previou convolut step perform highpass filter use textur input comput new convolut base preliminari work 5 paper provid precis descript uflic algorithm import implement detail addit improv algorithm inter activ present parallel implement algorithm multiprocessor machin sharedmemori architectur parallel algorithm distribut convolut workload among avail processor subdivid textur space subregion care choos shape subregion achiev high load balanc follow first give overview lic method next describ analyz exist algorithm unsteadi flow present uflic algorithm detail follow parallel algorithm conclud paper present perform result case studi appli method sever unsteadi flow data set cfd simul ii background relat work section briefli review lic method propos cabral leedom 3 describ analyz method propos forssel cohen 4 unsteadi flow field data line integr convolut line integr convolut method textur synthesi techniqu use visual vector field data take vector field white nois imag input algorithm use low pass filter perform onedimension convolut nois imag convolut kernel follow path streamlin origin pixel posit neg direct result intens valu lic pixel along streamlin strongli correl direct pattern flow field easili visual perform convolut differ period filter kernel use exampl han filter 3 box filter 6 7 fig 1 illustr process lic convolut recent sever extens origin lic algorithm propos forssel cohen 4 adapt lic method curvilinear grid data stall hege 6 propos effici convolut method speed lic comput shen johnson 7 combin dye advect fig 1 process lic convolut threedimension lic visual global local flow featur time okada kao 8 use postfilt techniqu sharpen lic output highlight flow featur flow separ reattach kiu bank 9 propos use multifrequ nois input lic enhanc contrast among region differ veloc magnitud recent jobard lefer 10 devis motion map data structur encod motion inform flow field produc visual effect similar lic imag textur output line integr convolut method provid excel visual represent flow field effect gener come two type coher first spatial coher use highlight flow line field output imag lic method establish coher correl pixel valu along streamlin result line integr convolut second type coher tempor coher coher requir anim flow motion lic method achiev tempor coher shift filter phase use convolut convolv nois textur period move along streamlin time b line integr convolut unsteadi flow lic techniqu propos origin primarili intend visual data steadi flow field visual unsteadi flow data extens propos forssel cohen4 contrast convolv streamlin steadi flow field extens convolv forward fig 2 convolut valu pixel b uncorrel pixel b differ convolut path repres p1 p2 respect backward pathlin origin pixel everi time step pathlin path particl travel unsteadi flow field time mathemat definit pathlin given next section anim flow motion algorithm shift filter phase everi time step gener anim sequenc purpos convolv along pathlin show trace particl move unsteadi flow thu reveal dynam featur underli field howev sever problem associ pathlin convolut flow rather unsteadi first coher convolut valu along pathlin difficult establish illustr problem fig 2 pathlin p 1 start pixel time 1 pass pixel b time 2 convolut path pixel similarli pathlin p 2 start b time 1 convolut path pixel b sinc pathlin p 1 p 2 pass b differ time 2 1 respect differ trace result convolut valu b uncorrel two differ set pixel valu use henc imag valu coher along neither pathlin p 1 p 2 establish forssel cohen 4 report flow line output imag becom ambigu convolut window set wide problem mention explain phenomenon drawback use pathlin convolut come difficulti establish tempor coher use phaseshift method propos regular lic method reason lie variat time pathlin origin seed point flow unsteadi result algorithm filter shift phase appli differ convolut path howev effect use phaseshift method creat fig 3 convolut imag gener use pathlin convolut algorithm artifici motion effect mainli reli fact convolut path fix time result tempor coher consecut frame repres flow motion use phaseshift method becom rather obscur unsteadi flow data addit problem discuss issu pathlin convolut 5 problem practic limit effect use pathlin convolut visual flow field rather unsteadi fig 3 show sampl imag produc pathlin convolut method obscur coher flow textur clearli notic follow section propos new algorithm uflic visual unsteadi flow field instead reli shift convolut kernel phase gather pixel valu flow path everi pixel creat anim textur devis new convolut algorithm simul advect textur base underli flow field new algorithm consist timeaccur valu scatter scheme success feedforward method algorithm provid timeaccur highli coher solut highlight dynam global featur unsteadi flow field iii new algorithm imag convolut thought gather valu mani input sampl output sampl valu gather scatter one input sampl mani output sampl valu scat tere lic method propos origin cabral leedom 3 use valu gather scheme algorithm pixel field travel posit neg streamlin direct gather pixel valu comput convolut convolut implement differ way first let everi pixel scatter imag intens valu along streamlin path convolut result pixel result imag comput averag contribut previous made pixel refer method valu scatter scheme convolut path streamlin steadi state vector field valu gather valu scatter equival howev timevari vector field valu gather valu scatter produc differ result pathlin use convolut path illustr fig 2 pathlin pixel pixel b enabl b receiv contribut scatter scheme use howev use gather scheme b gather valu pathlin p2 start b pass accur reflect physic phenomena unsteadi flow field method valu scatter convolut appropri valu gather method reason lie natur valu scatter correspond flow advect everi pixel imag plane thought particl particl move along flow trace leav footprint creat convolut imag section present new algorithm uflic use valu scatter scheme perform line integr convolut visual unsteadi flow field start white nois imag input textur uflic algorithm success advect textur creat sequenc flow imag achiev propos new convolut method call timeaccur valu scatter scheme incorpor time convolut timeaccur valu scatter convolut scheme driven success feedforward process iter take convolut output previou step highpass filter textur input next convolut produc new flow textur uflic algorithm effect produc anim spatial tempor coher track dynam flow featur time follow first present timeaccur valu scatter scheme describ success feedforward process timeaccur valu scatter timevari simul two differ notion time frequent use one physic time comput time physic time use describ continu measur quantiti physic world second day let physic two consecut time step unsteadi flow denot dt physic time th time step comput time nonphys quantiti comput space th time step let correspond comput time comput step size one follow type time involv care distinguish propos timeaccur valu scatter scheme comput line integr convolut valu scatter scheme comput convolut imag step timevari flow data advect input textur time input textur either white nois imag convolut result output preced step delay discuss choic input next section follow discuss assum current comput time step correspond physic time explain valuescatt convolut method given input textur everi pixel field serv seed particl pixel posit start physic time seed particl advect forward field space time follow pathlin defin z tdeltat pt posit particl physic time pt deltat new posit time deltat vpt veloc particl pt physic time evalu express gener particl trace numer method rungekutta second fourthord integr scheme use everi integr step input imag valu p pixel particl origin normal scatter pixel along pathlin normal determin two factor ffl length current integr step ffl age particl assum box kernel function use line integr convolut comput multipli imag valu distanc two consecut integr step explain first normal factor assum particl n th integr step distanc particl posit current preced integr defin express second normal factor simul effect fade time seed particl intens defin particl age n th integr step deltat deltat th time increment pathlin integr base particl age defin normal variabl valu decreas age particl increas assum expect life span particl n overal normal weight w normal scatter valu n th integr step becom normal p theta w data scatter scheme normal pixel valu everi integr step associ timestamp given pathlin start seed pixel physic time correspond physic time n th integr step deltat comput convolut frame everi integ comput time step correspond origin data therefor use roundedup comput time correspond physic time timestamp associ normal imag valu comput receiv scatter imag valu pixel keep buffer call convolut buffer c buffer within cbuffer sever bucket correspond differ comput time bucket field accumul imag valu accum field accumul weight w accum scatter n th integr step done ad normal imag valu normal weight w bucket pixel n th integr step correspond comput time normal seed particl distanc travel defin convolut length determin convolut length indirectli specifi particl life span defin life span comput time convert physic time use everi particl convolut advantag use global life span control convolut length length differ pathlin automat scale proport particl veloc magnitud desir effect describ 3 4 addit life span give number time step data must load main memori particl may complet advect base life span specifi seed particl advect number bucket c buffer structur requir actual predetermin assum life span pathlin n comput time ie particl start end n bucket buffer need particl travel longer n comput time step born implement cbuffer onedimension ring buffer structur integ phi index point bucket correspond current comput time everi pixel start advect valu phi comput henc assum particl comput time 0 current integr step correspond bucket ring buffer destin pixel deposit index fig 4 depict structur ring buffer mod fig 4 exampl life span seed particl n 5 comput time step current comput time pixel start advect 6 valu phi point bucket convolut buffer cbuffer 1 timeaccur valu scatter scheme everi pixel advect field scatter imag valu base scatter method describ everi pixel complet scatter process start comput convolut get result textur proceed includ convolut scatter pixel valu timestamp equal current comput time therefor go pixel cbuffer obtain accumul pixel valu accum accumul weight w accum correspond bucket bucket index phi final convolut valu c comput w accum accumul imag valu bucket futur timestamp use time come increment valu phi one current bucket cbuffer reus addit current comput time also increment one valu scatter convolut proceed next time step data worth mention method pixel scatter valu along forward pathlin direct backward direct reason lie natur backward scatter correspond observ physic phenomenon flow advect backward addit symmetri issu mention 3 appear problem unsteadi flow anim b success feedforward valu scatter scheme provid timeaccur model simul flow advect creat spatial coher output textur section describ process success transport convolut result time maintain tempor coher visual unsteadi flow mention previous defin timedepend method one progress track visual result time section present timedepend process call success feedforward drive timeaccur valu scatter scheme creat tempor coher algorithm work follow initi input valu scatter convolut algorithm regular white nois textur valu scatter scheme advect convolv nois textur obtain convolut result first time step subsequ convolut instead use nois textur use output previou convolut input textur input textur show pattern form previou step flow field advect result output frame consecut time step highli coher flow textur continu convolv advect throughout space time import issu success feedforward method must address line integr convolut method gener valu scatter scheme particular realli lowpass filter process consequ contrast among flow line gradual reduc time lowpass filter process repeatedli appli input textur would caus problem one tri visual long sequenc unsteadi flow data correct problem first appli highpass filter hpf input textur result previou convolut use valu scatter scheme next step highpass filter help enhanc flow line maintain contrast input textur highpass filter use method laplacian oper twodimension laplacian written 3 theta 3 mask fi fi fi fi fi fi fi result comput mask exclus posit valu order display result common techniqu use digit imag process applic subtract laplacian fig 5 convolut imag gener input textur without noisejitt highpass filter origin imag filter mask overal oper laplacian subtract deriv prevent highpass filter introduc unnecessari high frequenc might caus alias final imag jitter result output highpass filter origin input nois textur done mask least signific seven bit output origin input nois highpass filter nois jitter produc convolut imag restor contrast clearer flow trace fig 5 show snapshot anim sequenc without use noisejitt highpass filter fig 6 result nois jitter highpass filter differ quit dramat note fig 6 use compar fig 3 imag produc time step data fig 7 give overview entir algorithm note noisejitt highpass filter process appli input textur next iter convolut anim imag iv parallel implement section present simpl parallel implement uflic algorithm multiprocessor machin sharedmemori architectur follow first discuss subdivid convolut workload among processor describ synchron step among processor noteworthi parallel algorithm regular lic method massiv parallel distribut memori comput propos zockler stall hege11 algorithm steadi lic method unsteadi lic subdivid textur imag fig 6 convolut imag gener input textur noisehitt highpass filter scatter convolut nhpf noisejitt highpass filter current comput time display fig 7 algorithm flowchart space distribut workload workload subdivis natur success feedforward process requir uflic algorithm must execut sequenti time convolut one time step complet next convolut start implement parallel timeaccur valu scatter scheme execut everi comput time step distribut workload subdivid imag space subregion distribut convolut task subregion among avail processor choos shape subregion two consider ffl subregion assign processor well distribut imag space ffl processor local data access maintain comput convolut convolut workload incur valu scatter pixel gener determin length pathlin farther pathlin extend work need fig 8 uflic parallel subdivid textur space tile randomli assign tile avail process element pe pixel encount along way oper valu accumul involv occur seed particl travel region higher veloc flow field variat veloc differ region flow field quit dramat distribut veloc usual quit uneven order give processor balanc workload processor assign subregion evenli distribut entir field issu consid subdivid work space mainten local data access avoid penalti caus local cach miss memori page fault access flow data happen two consecut seed particl processor schedul advect locat long distanc case vector data brought cach main memori one particl advect flush new page data advect second particl start base two consider parallel algorithm divid imag space rectangular tile fig 8 given p processor first specifi number tile processor receiv divid entir textur space theta p tile randomli assign tile processor associ tile random number sort tile random number sort processor take turn grab tile sort tile list b process synchron work distribut complet processor start comput convolut valu pixel tile parallel convolut process divid three phase synchron point among processor three phase scatter pixel valu along pathlin ffl comput convolut result cbuffer perform noisejitt high pass filter first phase valu scatter involv write cbuffer belong pixel along pathlin sinc processor perform scatter simultan possibl one processor need write bucket cbuffer time implement instead lock cbuffer processor write inevit incur perform overhead alloc separ set bucket processor recal sequenti algorithm number bucket cbuffer equal pathlin life span n given p avail processor alloc n bucket processor total number bucket cbuffer p theta n way although memori need lock mechan requir cbuffer current avail multiprocessor sharedmemori machin found overhead overwhelm second phase parallel fairli straightforward processor independ travers cbuffer pixel tile comput convolut result note within cbuffer p bucket correspond comput time step convolut comput accumul normal scatter imag valu bucket third phase processor simpli appli noisejitt highpass filter process independ convolut result pixel belong tile v result discuss section empir result evalu uflic algorithm provid first present perform analysi sequenti parallel implement show case studi sever cfd applic perform analysi data two unsteadi cfd simul use experi shown tabl appli uflic algorithm twodimension curvilinear surfac delta wing model 287 theta 529 textur resolut twodimension curvilinear surfac airfoil model 196 theta 389 textur resolut machin use gener result sgi onyx2 textur resolut surfac two unsteadi flow data set data set textur resolut wing 287 theta 529 airfoil 196 theta 389 ii uflic comput time second one processor data set scatter convolut filter total wing 7113 023 019 7155 airfoil 12385 011 009 12405 195 mhz r10000 processor tabl ii show breakdown averag comput time use one processor gener textur imag anim seri use three comput time step seed particl life span tabl show time spent uflic three phase scatter pixel valu comput convolut highpass filter found process valu scatter requir 99 total execut time major calcul provid pathlin seed particl noteworthi comput time data scatter necessarili proport textur resolut reason seed particl differ flow field given life span may travel differ distanc due differ flow veloc result variat workload data scatter process mention previous section parallel algorithm tabl ii see comput time valu scatter airfoil data set longer delta wing data set even though textur resolut airfoil smaller explain tabl iii compar averag pathlin length seed particl airfoil delta wing data set iii averag pathlin length pixel data set pathlin length airfoil perform parallel uflic delta wing cpu time speedup effici 6 1317 543 090 perform parallel uflic airfoil cpu time speedup effici 6 2279 544 090 7 2022 613 088 parallel implement given p processor assign processor p theta 16 tile divid twodimension textur space 4p theta 4p tile tabl iv tabl v show total execut time second speedup factor parallel effici parallel algorithm seven processor parallel effici defin divid speedup factor number processor result observ achiev 90 parallel effici good load balanc fig 9 fig 10 show parallel speedup graph b case studi section show result appli new algorithm sever cfd applic anim ideal method show result paper show sever snapshot anim mani cfd simul perform studi flow phenomena oscil wing gener simul done use two dimension airfoil first exampl base simul unsteadi twodimension turbul flow oscil airfoil pitch number processors26 parallel uflic fig 9 parallel speedup uflic algorithm delta wing number processors26 parallel uflic fig 10 parallel speedup uflic algorithm airfoil eleven degre oscil motion airfoil creat vortex shed vortex format fig 11a 11b show format primari vortex rotat clockwis airfoil flow textur shown color veloc magnitud blue indic low veloc magenta high veloc initi veloc high near lead edg airfoil airfoil pitch veloc decreas lead edg increas near trail edg counterclockwis secondari vortex form beyond trail edg airfoil see fig 11c 11d furthermor primari vortex gain strength primari vortex separ airfoil compar unsteadi flow shown fig 11 result steadi lic comparison use steadi lic comput surfac flow time step independ anim steadi lic time differ anim uflic appar new algorithm anim reveal dynam behavior vortic vortex format vortex shed much realist steadi lic fig 12 depict snapshot time sequenc flow pattern sever spiral vortic unsteadi flow simul four vortic vortic orbit vortic flow compar steadi lic spiral motion vortic shown instead lic reveal translat vortic next exampl unsteadi flow simul fa18 fighter aircraft air combat twintail fa18 jet highangl attack simul involv studi tail buffet occur vertic tail immers unsteadi flow burst vortic along lead edg tail frequent phenomenon caus heavi load one vertic tail jet major safeti concern fig 13a b show first wave vortex burst along lead edg one vertic tail figur show outboard tail eg side tail face away vertic tail note movement vortex occur near blue shade region lead edg tail upper tip tail anoth wave vortex burst shown fig 13c 13d anim vortex burst phenomenon reveal dramat last exampl taken unsteadi flow simul 65degre sweep delta wing degre angl attack simul sever interest flow separ reattach occur along lead edg delta wing zero degre static roll angl furthermor vortex breakdown present unsteadi flow fig 14 show snapshot surfac flow given time step veloc magnitud color contour give indic chang veloc time along lead edg wing flow veloc rel high compar veloc near wing bodi base exampl present section observ made regard surfac flow gener new algorithm first flow unsteadi blurri like occur region flow chang rapidli unlik surfac flow pattern gener regular lic flow line gener use unsteadi lic may differ line width could attribut chang veloc magnitud flow direct vi conclus futur work present uflic unsteadi flow line integr convolut algorithm visual vector data unsteadi flow field use timeaccur valu scatter scheme success feedforward process new convolut algorithm accur model flow advect creat highli coher flow anim result sever case studi use algorithm shown new techniqu effect captur dynam featur unsteadi flow field futur work includ appli method threedimension unsteadi flow data set addi tion would like compar unsteadi lic method spot nois techniqu introduc van wijk 12 spot nois effect method creat flow textur pattern final textur imag qualiti base distribut shape spot de leeuw van wijk 13 enhanc spot nois techniqu bend spot base local stream surfac object produc accur flow textur pattern near flow region high curvatur extend spot nois techniqu unsteadi flow key issu resolv instanc spot advect time distribut spot chang rapidli challeng maintain coher spot time anoth consider spot bend assum flow steadi local stream surfac howev unsteadi flow assumpt may true plan look issu acknowledg work support part nasa contract nas214303 would like thank neal chaderjian ken gee shigeru obayashi ravi samtaney provid data set special thank randi kaemmer meticul proofread manuscript michael cox david ellsworth interest discuss valuabl suggest parallel impl mentat also thank tim sandstrom gail felchl chri henz member data analysi group nasa ame research center help comment suggest technic support r visual timedepend flow field visual timevari phenomena numer simul unsteadi flow imag vector field use line integr convolut use line integr convolut flow visual curvilinear grid uflic line integr convolut algorithm visual unsteadi flow fast resolut independ line integr convolut visual vector field use line integr convolut dye advect enhanc line integr convolut flow featur detect motion map effici comput steadi flow anim parallel line integr convolut spot nois textur synthesi data visual enhanc spot nois vector field visual tr ctr nan li zhiong huang featurebas pencil draw method proceed 1st intern confer comput graphic interact techniqu australasia south east asia februari 1114 2003 melbourn australia walter h jimenez wagner correa claudio silva baptista baptista visual spatial tempor variabl coastal observatori proceed 14th ieee visual 2003 vis03 p75 octob 2224 jark j van wijk imag base flow visual acm transact graphic tog v21 n3 juli 2002 bruno jobard gordon erlebach yousuff hussaini lagrangianeulerian advect unsteadi flow visual proceed confer visual 01 octob 2126 2001 san diego california pak chung wong harlan foot david l kao rubi leung jim thoma multivari visual data fusion inform visual v1 n34 p182193 decemb 2002 daniel weiskopf gordon erlebach thoma ertl texturebas framework spacetimecoher visual timedepend vector field proceed 14th ieee visual 2003 vis03 p15 octob 2224 bruno jobard gordon erlebach yousuff hussaini hardwareacceler textur advect unsteadi flow visual proceed confer visual 00 p155162 octob 2000 salt lake citi utah unit state bruno jobard gordon erlebach yousuff hussaini lagrangianeulerian advect nois dye textur unsteadi flow visual ieee transact visual comput graphic v8 n3 p211222 juli 2002 ander helgeland oyvind andreassen visual vector field use seed lic volum render ieee transact visual comput graphic v10 n6 p673682 novemb 2004 vivek verma david kao alex pang plic bridg gap streamlin lic proceed confer visual 99 celebr ten year p341348 octob 1999 san francisco california unit state zhanp liu robert jame moorhead ii auflic acceler algorithm unsteadi flow line integr convolut proceed symposium data visualis 2002 may 2729 2002 barcelona spain guoshi li udeepta bordoloi hanwei shen chameleon interact texturebas render framework visual threedimension vector field proceed 14th ieee visual 2003 vis03 p32 octob 2224 tobia schafhitzel eduardo tejada daniel weiskopf thoma ertl pointbas stream surfac path surfac proceed graphic interfac 2007 may 2830 2007 montreal canada jark j van wijk imag base flow visual curv surfac proceed 14th ieee visual 2003 vis03 p17 octob 2224 robert larame jark j van wijk bruno jobard helwig hauser isa ibfv imag spacebas visual flow surfac ieee transact visual comput graphic v10 n6 p637648 novemb 2004 hongfeng yu kwanliu joel well parallel visual pipelin terascal earthquak simul proceed 2004 acmiee confer supercomput p49 novemb 0612 2004 zhanp liu robert j moorhead acceler unsteadi flow line integr convolut ieee transact visual comput graphic v11 n2 p113125 march 2005