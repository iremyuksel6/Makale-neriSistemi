adapt mesh refin use wavepropag algorithm hyperbol system adapt mesh refin algorithm develop euler equat ga dynam extend employ highresolut wavepropag algorithm gener framework allow use varieti new problem includ hyperbol equat conserv form problem sourc term capac function logic rectangular curvilinear grid framework requir modifi approach maintain consist conserv grid interfac describ detail algorithm implement amrclaw packag freeli avail b introduct multidimension wavepropag algorithm describ 14 highresolut method second order accur smooth solut maintain sharp discontinu use slopelimit base idea develop hyperbol system conserv law context shock captur method appli gener framework allow applic hyperbol system conserv form variablecoeffici hyperbol system form aris exampl studi acoust elast heterogen materi vari materi properti see section 6 practic problem desir use mesh refin cluster grid point region need exampl around shock region solut courant institut new york univers 251 mercer st new york ny 10012 bergercimsnyuedu 2 depart appli mathemat depart mathemat univers washington box 352420 seattl januari 1997 appear special issu siam j numer anal dedic ami harten revis juli 1997 steep gradient complic structur done adapt manner base behavior solut timedepend problem region refin must move adapt interest structur effect adapt mesh refin amr strategi develop 16 use cartesian grid refin space time rectangular patch refin arbitrari even integ ratio typic 4 recurs refin done within patch arbitrari depth algorithm origin develop euler equat ga dynam use fluxdifferenc method easili extend system conserv law crucial ingredi manner flux gridrefin interfac coordin insur method global conserv describ detail 5 review section 21 paper show wavepropag algorithm use conjunct amr strategi algorithm written gener form use flux differenc per se though special case conserv law method reexpress flux differenc form fulli conserv section 4 show gridrefin interfac possibl appli correct procedur maintain global conserv appli conserv law reduc fluxbas approach retain gener wavepropag framework allow applic gener hyperbol system also discuss extens present 14 incorpor amr includ sourc term capacityform differenc applic map curvilinear grid topic discuss section 5 6 domain assum rectangular least comput space metric term includ actual solv problem nonrectangular physic domain curvilinear grid obtain smooth map cartesian comput grid grid jacobian function properli incorpor use capac function describ section 52 wavepropag algorithm implement gener softwar packag call clawpack conserv law packag holdov earlier version appli conserv law packag avail netlib11 softwar recent combin berger implement amr incorpor extens describ paper freeli avail amrclaw package6 numer result present paper obtain amrclaw sever exampl includ packag detail use packag found onlin document 2 amr algorithm adapt mesh refin algorithm conserv law fulli describ 5 brief summari given amr approach adapt mesh refin use collect logic rectangular mesh make coars grid refin cover subset domain use smaller rectangular grid patch fine patch recurs nest given level accuraci attain typic patch level l refin x even integ rl time step also refin factor rl time step must taken refin grid level l step grid level l mesh ratio deltatdeltax deltatdeltay grid ensur stabil explicit differ scheme everi k time step particular grid level finer level grid regener order follow move featur flow error estim procedur base richardson extrapol determin region resolut solut insuffici procedur compar solut obtain take 2 step exist grid one comput take 1 time step grid twice coars direct cell error greater toler flag refin criteria might use addit instead error estim eg identifi steep gradient variabl buffer zone around flag cell also flag insur featur interest escap refin region next k time step buffer width k adjust paramet must coordin flag cell organ rectangular grid patch typic contain sever hundr sever thousand grid point per patch note cell tag refin also includ new fine grid patch typic grid gener algorithm produc grid 70 cell within new grid patch tag need refin remain 30 untag still lie within new patch boundari take small patch one could avoid refin mani cell must balanc compet desir creat rel separ patch minim comput overhead boundari fine grid see 1 detail refin cluster algorithm see figur 6 exampl refin logic rectangular patch altern would use quadtre data structur eg 7 15 flag cell refin storag overhead data structur typic 30 50 word per cell usual exce storag overhead associ block structur approach even 30 addit refin grid finit volum method use advanc solut result grid hierarchi cell averag variabl store grid cell solv conserv law cell averag updat fluxdifferenc algorithm base flux cell edg section 3 review wavepropag method extens nonconserv hyperbol system integr proce grid level grid level 1 first integr time step grid level 2 integr r 1 time step catch approach appli recurs level boundari condit grid impos use ghost cell comput domain extend g ghost cell direct valu assign ghost cell start time step g2 method describ physic boundari user must set ghost cell valu time step base problem specif eg extrapol outflow boundari reflect solid wall howev boundari fine grid may interior domain case neighbor fine grid suppli valu ghost cell interpol coarser parent grid spacetim interpol must gener use sinc time step taken fine grid coars grid intermedi time coars grid valu avail howev sinc coars grid alway advanc first data avail earlier later time coars grid interpol techniqu develop paper adapt refin easili describ one space dimens refin grid patch becom interv concentr case develop techniqu carri directli multipl space dimens implement two dimens amrclaw softwar twodimension result present section 6 21 conserv grid interfac interfac coars fine grid must also insur formula use updat solut grid consist one anoth particular conserv law solv must preserv global conserv illustr conserv flux correct requir grid interfac manner must modif wavepropag algorithm consid onedimension case two level grid factor two refin denot coars grid space h time step k grid space fine grid figur 1a show coars grid singl time step xt space figur 1b show also finer grid overlaid denot valu fine grid q assum cell grid end cell j coars grid coars grid comput flux f 0 indic figur 1a updat coars grid valu fluxdifferenc algorithm note f repres flux left edg cell interfac grid cell instead commonlyus clutter notat f igamma12 fine grid use flux indic figur 1c two time step grid use fluxdifferenc form 2 comput flux near right edg grid need use valu ghost cell also indic figur 1c valu determin use spacetim interpol coars grid valu q 0 describ psfrag replac psfrag replac c psfrag replac figur 1 coars grid onedimension exampl shown spacetim valu q flux f indic b also show fine grid overlaid grid interfac valu q fine grid indic c flux valu f need fine grid ghost cell q m1 q m2 also indic valu need comput fine grid flux grid interfac need coordin valu obtain two differ grid final time first coars grid cell overlap fine grid cell replac valu q 1 averag finegrid valu sensibl sinc finegrid valu presum accur coarsegrid valu also crucial maintain global conserv regrid fine grid elimin import maintain stabil sinc inform must allow pass fine coars grid well direct fulli conserv howev also must modifi coarsegrid valu q 1 j initi comput q 1 j use coarsegrid flux f 0 j left edg cell conserv must instead use leftedg flux agre flux use determin finegrid valu left cell instead use f 0 use 1 j correct differ two global conserv total mass multipl coars grid time step sens total mass im conserv boundari effect farfield 3 wavepropag algorithm one space dimens wavepropag algorithm describ 14 base solv riemann problem interfac grid cell use result wave structur updat solut grid cell side cours basi host method conserv law date back godunov method8 riemann problem consist origin conserv law togeth piecewis constant initi data defin two neighbor cell valu wide class conserv law riemann problem solv either exactli approxim solut similar solut consist set wave propag constant speed system conserv law solut use defin flux cell interfac yield godunov method second order accuraci achiev variou way eg introduc slope inform slopelimit flux limit use give good resolut discontinu without spuriou oscil see eg 12 gener discuss method wavepropag algorithm base use wave directli updat cell valu includ second order correct wave limit conserv law method rewritten conserv form defin flux function term wave implement way allow applic hyperbol problem conserv form still welldefin wave structur flux function illustr consid advect equat variabl veloc equat sometim call color equat conserv form valu q constant along characterist integr q conserv assum ux 0 everywher interfac x igamma12 cell defin riemann problem function ux initi data q given u cellcent valu ux cell solut riemann problem wave w simpli propag speed u right sinc u 0 time step k wave move distanc ku cell modifi cell averag first order upwind method wavepropag form thu gener ux arbitrari sign first order wavepropag algorithm altern riemann problem might defin use edg valu u igamma12 interfac cell updat formula 7 would becom advantag twodimension incompress flow see 13 illustr use formul 7 base cellcent velocit 6 rather edg valu highresolut secondord correct easili introduc fact done fluxdifferenc form even nonconserv equat color equat simplifi procedur insur conserv appli conserv law cell interfac x igamma12 defin w limit version wave w limitera b repres standard limit minmod superbe includ correct method 7 becom note u constant advect equat 5 conserv law case reduc assum u 0 exampl numer flux standard fluxlimit method advect equat see 19 exampl particular limit use reduc laxwendroff method gener form 9 fluxdifferenc form work effect color equat standard fluxdifferenc constantcoeffici advect equat form 9 easili extend gener hyperbol system consid variablecoeffici linear system q 2 lr ax 2 lr mthetam diagonaliz real eigenvalu riemann problem x igamma12 decompos q way leftgo wave eigenvector matrix igamma1 defin cell travel speed p eigenvalu igamma1 rightgo wave eigenvector travel speed p summat term give firstord upwind method secondord correct defin w i1 limit version wave w p obtain compar w p w p detail includ work exampl acoust heterogen medium found 14 document 11 wavepropag algorithm extend nonlinear system conserv law use roe approxim riemann solver16 linear problem cell interfac way wavepropag approach guarante conserv gener wavepropag algorithm written symbol repres rightgo fluctuat ith riemann problem left edg cell gamma deltaq i1 leftgo fluctuat riemann problem right edg cell fluctuat sum wave move appropri direct wave speed multipli wave strength notat motiv fact constantcoeffici linear system q eigendecomposit matrix right eigenvector wave w p case given w vector wave strength note linear case gener conserv law method 11 conserv provid ie fluctuat defin fluxdiffer split easi see sinc defin use 11 show method rewritten conserv form flux f 4 wavepropag grid interfac interfac fine coars grid wavepropag form still use updat valu grid independ use ghost cell valu need near grid inter face still replac new coars grid valu averag fine grid valu cell cover fine grid tricki part extend amr algorithm wavepropag algorithm conserv correct coars cell adjac finer grid eg valu figur 1b recal fluxdifferenc algorithm valu must modifi correct 4 insur conserv sinc flux coars cell agre total flux adjac fine cell wavepropag algorithm must appli similar fixup insur wave match appropri manner yield conserv conserv expect turn slightli difficult numer flux avail fluxdifferenc form discuss section 2 note second order correct term written fluxdifferenc form even nonconserv system term correct use 4 firstord upwind term written term fluctuat gamma deltaq deltaq must handl differ concentr firstord alogrithm difficulti solut easili seen examin constant coeffici advect onedimension grid figur 1 case u 0 wave move coars grid fine grid suppos solv cauchi problem data compact support fine coars grid extend gamma1 respect hope conserv sens im im coars grid sum coars grid cell get telescop qdiffer everywher except first cell similarli 2 step fine grid find im im sum two result see method global conserv add correct global sum magnitud accomplish modifi valu q 1 note exactli modif 4 obtain fluxdifferenc form use sinc advect equat instead reli flux function interpret correct anoth way use wave propag figur 2a show wave affect relev cell valu end time increment appli wavepropag algorithm grid separ someth wrong pictur view initi data defin piecewis constant function need solv riemann problem discontinu add total fluctuat riemann problem deltaq grid valu order maintain conserv gener gamma deltaq ad cell left deltaq cell right figur 2a show fail solv riemann problem state ghostcel valu fine grid q 0 j initi time restor conserv must solv riemann problem state add result total fluctuat weight sinc time step k cell size h cell valu j term maintain conserv sort correct could equal well ad cell valu instead q 1 j choic clearli reason figur agre modif appli fluxdifferenc framework similarli second step fine grid must also solv riemann problem m1 q 0 j add fluctuat q 1 advect exampl consid two correct sum exactli requir correct 14 sinc rewritten correct easili extend arbitrari hyperbol system sinc presum riemann solver produc gamma deltaq deltaq two state m1 q 0 modifi q 1 psfrag replac psfrag replac figur 2 wave aris solv riemann problem fine coars grid sepa rate b wave aris solv riemann problem ghost cell valu q 0 coars grid valu q 0 must also includ order maintain conserv similar modif must made r time step refin grid within singl coars grid step r refin ratio fixup algorithm thu take solv riemann problem data m1 q 0 j comput gamma deltaq deltaq updat q 1 deltaq case conserv law restor conserv fact agre flux function modif 4 numer flux defin 13 note view 12 conserv law case coars grid valu q 1 j simpli updat entir flux differ need actual solv riemann problem howev implement present give uniform gener formul idea extend directli two space dimens also three dimens multidimension wavepropag algorithm consist solv onedimension riemann problem normal cell interfac defin wave fluctuat exactli one dimens use onedimension algorithm also use defin transvers correc tion essenti solv riemann problem transvers direct use fluctuat data correct need give second order accuraci multidimens well increas stabil limit allow courant number close 1 correct fulli describ 14 present purpos need note correct modifi correct flux f correspond yflux g fluxdifferenc form automat correct grid interfac step 4 correct made due flux numer experi demonstr full second order accuraci conserv law nonconserv equat approach use along secondord correct term discuss section 3 5 extens amrclaw softwar contain extens wavepropag algorithm discuss 14 implement clawpack briefli describ emphasi new issu aris connect mesh refin 51 sourc term consid hyperbol equat sourc term handl use standard fraction step method also call split method approach altern solv homogen hyperbol equat ignor sourc term solv ode q context amr need appli sequenc within time step grid must implement care order avoid gener excess nois interfac contamin solut whenev solv riemann problem must ensur data side contain total contribut sourc term order avoid gener spuriou wave must care observ comput ghost cell valu fine grid intermedi time also solv addit riemann problem need conserv fix describ section 4 recal riemann problem ghost cell valu intermedi time coars grid valu origin time sourc term includ coars grid valu must modifi incorpor correct sourc contribut interfac detail present first discuss basic fraction step method use grid time step first solv homogen hyperbol equat time deltat use result solut initi data sourceterm equat time deltat socal firstord split godunov split oppos strang split one advanc first half time step one equat full time step equat end half time step first equat again17 18 formal strang split give second order accuraci situat first order accuraci achiev choic practic problem method natur use differ resolut actual seen gener neglig appli strang split n time step equival start half time step one oper altern deltat step nth step finish half step first oper chang made minor modif shift one half time step begin end comput formal odeltat henc reduc global accuraci first order clearli degrad overal resolut solut degre solut may simpli shift odeltat rel correct locat exampl differ sort error introduc genuin first order method eg use first order upwind method place highresolut fluxlimit method see 14 discuss point use simpler split number advantag context coupl sourc term hyperbol solver particularli amr one thing less expens sinc sourc term advanc per time step instead twice cours one could combin half time step togeth strang split allud impract variabl time step use particularli adapt refin specif boundari condit also simplifi usersuppli routin extend valu comput grid ghost cell call begin time step produc valu ghost cell guarante physic boundari condit satisfi exampl normal momentum must negat solid wall boundari euler equat sinc hyperbol equat advanc first condit use immedi sourc term advanc typic local ode solv grid cell requir use ghost cell valu need worri solv ode ghost cell sinc valu replac immedi start next time step appli hyperbol solver first also simplifi modif need grid interfac minim nois gener algorithm fairli simpl extens present alreadi let hk repres solut oper hyperbol equat sk solut oper sourc term fraction step method one time step singl grid take form consid refin grid refin ratio r let q repres solut fine grid time step k let q coars grid solut time step k algorithm coars grid updat initi coars grid valu need conserv fixup advanc fine grid spacetim interpol ghost cell valu m2 use q 0 q 1 conserv fixup solv riemann problem data m1 q 0n j comput gamma deltaq deltaq appli sourc term coars grid valu basic direct extens algorithm describ previous except final step ensur riemann problem solv correct phase consist data fine time step numer test shown approach perform quit well attempt style split eg strang split godunov split order h revers much less success gain better appreci mismatch interfac gener nois reader encourag explor variou strategi simpl scalar equat constant advect speed u data q initi constant space numer ode method use solv q use trivial exact solut oper approach lead gener nois interfac simpli ode solv accur fine grid coars grid lead jump q interfac henc wave propag speed u approach outlin gener ok 2 nois long ode solver least first order accur wherea approach consid would gener ok nois 52 capacityform differenc wavepropag algorithm 14 also describ gener form appli quasilinear equat form one dimens obviou gener dimens function x call capac function sinc repres way capac medium hold quantiti q work form particularli use equat conserv form xqx conserv quantiti rather q alon flux defin term q onedimension exampl consid flow variablearea duct x crosssect area q repres concentr per unit volum case h volum ith grid cell flow porou media anoth exampl repres poros one dimens form also aris use map curvilinear grid case jacobian grid transform detail present 14 idea capacityform differenc replac updat formula 11 case conserv law assum 12 hold guarante conserv h definit must also incorpor second order correct replac 10 h use capacityform differenc amr direct provid insur conserv maintain transfer inform grid return figur 1b suppos capac defin coars grid defin fine grid region two grid overlap assum valu consist exampl figur 1b capac coars grid cell agre total capac two fine cell h updat coars grid valu q 1 averag fine grid valu q 2 must weight capac function replac 3 final gridinterfac correct 15 replac h denomin j h 6 numer result present amr comput exampl 14 illustr sourc term nonconserv hyperbol system capac form differenc curvilinear grid success handl exampl found amrclaw webpage6 includ anim exampl 61 repeat exampl 383 14 consist linear equat acoust hyperbol system 3 equat discontinu sound speed across line obliqu grid plane wave strike interfac angl lead transmit reflect wave timeevolut best seen figur 4 acoust equat pressur perturb p veloc u v written coeffici densiti aex bulk modulu elast kx exampl ae discontinu across interfac k constant riemann solver system wavepropag form given 14 figur 4a show contour plot initi pressur cosin hump 14 move toward upper right dash line show locat discontinu sound speed heterogen materi describ densiti bulk modulu elast bulk replac figur 3 pressur contour plane wave hit discontinu sound speed acoust equat time 06 finer grid shade darker shade indic finer level three level use 76 theta 50 grid coarsest level refin factor 2 level modulu taken constant densiti discontinu lead discontinu sound speed grid cell densiti defin cell averag true densiti cell 14 shown wavepropag algorithm handl problem well even discontinu densiti align grid figur 3 show amrclaw calcul coarsest grid 76 theta 50 two level refin use finest grid compar resolut seen lower plot figur 8 14 toler use chosen way weaker reflect wave refin level 2 smaller toler would caus level 3 refin wave well use ratio 2 refin level demonstr purpos exampl 62 previou exampl fulli test new interfac condit fine coars grid nonconserv case acoust equat fail conserv form along interfac densiti discontinu wave stay embed level 3 grid move along interfac sever test repeat comput simpl chang error estim procedur point flag refin x 06 x 06 coarsest grid wave move initi fine grid onto coars grid time advanc figur 4 show sequenc time end time shown figur 3b smear wave seen coarser grid inevit difficulti observ along discontinu densiti exampl 63 repeat exampl 3101 14 advect equat tracer qx densitystratifi flow hump take ux vx fix 12 140103050709pressur c 12 140103050709pressur 12 140103050709pressur figur 4 pressur contour plane wave hit discontinu sound speed acoust equat four differ time test refin allow x 06 wave move refin region veloc field chosen aeq conserv quantiti test problem consid flow hump bottom topographi given domain 1 veloc field chosen use stream function defin condit 21 satisfi divid ae give veloc field note u v diverg free stream function veloc though true contour constant give streamlin flow use densiti profil 14 veloc increas exponenti test use 25 figur 5 show initi data exact solut time data consist circular blob tracer problem solv curvilinear grid irregular region xy plane map smoothli rectangl equat 20 transform advect equat rectangl solv uniform cartesian grid comput gamma j space use grid 2 14 map capacityform differenc use jacobian grid map explain 14 figur 6 show comput result 3 level refin refin ratio 2 case finest grid resolut calcul shown figur 10 figur 5 densitystratifi flow hump left initi data 1 insid circular region elsewher region solut 1 time comput result 200 theta 100 cartesian grid 14 conclus adapt mesh refin algorithm develop euler equat ga dynam extend employ highresolut wavepropag algorithm gener framework particular discuss modif need allow applic method hyperbol problem conserv form follow approach 14 done way still maintain conserv appli conserv law spite fact wavepropag approach use updat cell averag rather standard fluxdifferenc gener also present fraction step method hyperbol equat sourc term also discuss extens capacityform differenc formul use appli method curvilinear grid refin done logic rectangular patch illustr section 6 one exampl advect equat futur intend explor use curvilinear grid fulli nonlinear conserv law euler equat sinc bodyfit curvilinear grid crucial applic adapt mesh refin even crucial solv threedimension problem two space dimens recent clawpack extend three dimens 9 10 work underway extend amrclaw version underli amr code euler equat previous success extend three dimens eg 1 20 idea present paper carri easili well titl b 05 04 03 02 01 0 01050709psfrag replac figur comput densiti time stratifi flow hump contour level 005 095 compar figur 10 14 b blowup grid near top hump acknowledg indebt smadar karni point difficulti maintain conserv grid interfac wavepropag framework led develop idea present work support part nsf grant dms9505021 dms96226645 doe grant defg0396er25292 defg0288er25053 defg0292er25139 afosr grant f49620940132 r three dimension adapt mesh refin hyperbol conserv law adapt mesh refin hyperbol partial differenti equat automat adapt grid refin euler equat adapt mesh refin hyperbol partial differenti equat local adapt mesh refin shock hydrodynam test version avail httpwww adaptivelyrefin cartesian mesh solver euler equa tion avail netlib numer method conserv law wave propag algorithm multidimension hyperbol system solut euler magnetohydrodynam equat solutionadapt cartesian grid construct comparison high resolut scheme use flux limit hyperbol conserv law aspect comput dynam collid flow astrophys nebula tr ctr lar ferm per ltstedt spacetim adapt solut first order pde journal scientif comput v26 n1 p83110 januari 2006 k w liang p lin r c e tan numer solut quench problem use meshdepend variabl tempor step appli numer mathemat v57 n57 p791800 may 2007 zhijun tan zhengru zhang yunq huang tao tang move mesh method local vari time step journal comput physic v200 n1 p347367 10 octob 2004 ding c shu stencil adapt algorithm finit differ solut incompress viscou flow journal comput physic v214 n1 p397420 1 may 2006 jame rossmanith wave propag method hyperbol system sphere journal comput physic v213 r blikberg srevik load balanc openmp implement nest parallel parallel comput v31 n1012 p984998 octob decemb 2005 ragnhild blikberg tor srevik nest parallel alloc thread task openmp implement scientif program v9 n23 p185194 august 2001 yuan tao tang resolv shockinduc combust adapt mesh redistribut method journal comput physic v224 n2 p587600 june 2007 siegfri mller youssef stiriba fulli adapt multiscal scheme conserv law employ local vari time step journal scientif comput v30 n3 p493531 march 2007 nail k yamaleev mark h carpent accuraci adapt grid method captur shock journal comput physic v181 n1 p280316 septemb 1 2002 alexei poludnenko alexei khokhlov comput fluid flow noninerti contract expand rotat refer frame journal comput physic v220 n2 p678711 januari 2007