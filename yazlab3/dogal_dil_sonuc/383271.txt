signalprocess framework invers render realism computergener imag requir accur input model light textur brdf one best way obtain highqual data measur scene attribut real photograph invers render howev invers render method larg limit set highli control light one reason lack coher mathemat framework invers render gener illumin condit main contribut introduct signalprocess framework describ reflect light field convolut light brdf express mathemat product spheric harmon coeffici brdf light invers render view deconvolut appli theori varieti problem invers render explain number previou empir result show certain problem illpos numer illcondit problem amen solut theori develop also lead new practic represent algorithm instanc present method factor light brdf small number view ie estim simultan neither known b introduct creat realist computergener imag need accur physicallybas render algorithm detail model scene includ light sourc object specifi geometri materi propertiestextur reflect brdf substanti progress develop render algorithm nowaday realism often limit qualiti input model result imagebas render becom widespread simplest form imagebas render use view interpol construct new imag acquir imag without construct convent scene model qualiti view interpol may significantli improv coupl invers render invers render measur render attributeslight textur brdffrom photograph whether tradit imagebas render algorithm use render imag use measur real ob ject therefor appear similar real scene measur scene attribut also introduc structur raw imageri make easier manipul scene exampl artist chang independ materi properti light invers render method debevec et al 6 marschner et al 21 sato et al 32 produc high real photograph render imag figur 1 left real photograph right render imag brdf use render imag estim complex unknown illumin 3 photograph cat sculptur known geometri algorithm also recov light distribut consist two direct sourc area sourc imag show new view use brdf recoveri light also new compos singl direct sourc known direct use brdf estim imag show recov brdf accur predict appear even novel view light condit qualiti measur howev previou work conduct highli control light condit usual care activ posit singl point sourc even method work outdoor condit yu malik 39 sato ikeuchi 31 love 17 design specif natur illumin assum simpl parametr model skylight previou method also usual tri recov one unknownstextur brdf light use invers render would greatli enhanc could appli gener uncontrol light could simultan estim one unknown instanc could recov light brdf could determin brdf unknown illumin one reason rel littl work area lack common theoret framework determin condit invers problem solv make principl approxim main contribut theoret framework analyz reflect light field curv convex homogen surfac distant illumin believ framework provid solid mathemat foundat mani area graphic respect invers render obtain follow result reflect convolut observ qualit miller hoffman 23 cabral et al 3 basto et al 2 other reflect oper behav like convolut angular domain formal notion mathemat reflect light field therefor thought precis quantit way obtain convolv light brdf ie filter illumin use brdf believ use way analyz mani comput graphic problem par ticular invers render view deconvolut wellposed condit invers problem invers problem illposedther may solut sever solut also often numer illcondit ie extrem sensit noisi input data theori abl analyz wellposed condit number invers problem explain mani previou empir observa tion analysi serv guidelin futur research new practic represent algorithm insight theori lead deriv simpl practic represent use estim brdf complex light theori also lead novel frequenc space hybrid angular frequenc space method invers problem includ two new algorithm estim light algorithm simultan determin light brdf therefor recov brdf gener unknown light condit previou work describ previou work introduc taxonomi base mani three quantitieslight brdf textur unknown motiv taxonomi first write simplifi version reflect equat omit visibl z b reflect light field express function surfac posit x outgo direct normal vector n simplic assum singl textur modul brdf practic would use separ textur diffus specular compon brdf integrand product termsth textur x light lx invers render assum known geometri involv invert integr recov one l two quantiti unknown invers render involv factor reflect light field one unknown 1 unknown textur previou method recov diffus textur surfac use singl point light sourc divid irradi order estim albedo point detail given marschner 34 levoy et al 16 2 unknown brdf brdf 24 fundament intrins surfac properti activ measur method known gonior flectometri involv singl point sourc singl observ time develop improv suggest ward 37 karner et al 12 recent imagebas brdf measur method propos lu et al 18 marschner et al 21 entir brdf measur may repres tabul valu altern represent lowparamet model ward 37 torranc sparrow 36 parametr brdf gener accur full measur brdf howev parametr model often prefer practic sinc compact simpler estim love 17 estim parametr brdf natur assum lowparamet model skylight sunlight dror et al 7 classifi surfac reflect one small number predetermin brdf make use assum statist characterist natur light howev invers brdf problem solv gener illumin 3 unknown light common solut use mirror ball done miller hoffman 23 marschner greenberg 20 find light lambertian surfac dzmura 8 propos demonstr estim spheric harmon coeffici lambertian object 29 shown recov first 9 spheric harmon previou work estim light curv surfac gener brdf two unknown 4 factorizationunknown light brdf brdf estim method propos ikeuchi sato 10 tominaga tanaka 35 special case light consist singl sourc unknown direct howev method simultan recov complex light distribut object brdf one main practic contribut paper solut problem curv sur allow us estim brdf gener unknown illu minat also determin light closest previou work sato et al 30 use shadow estim illumin distribut surfac reflect properti extend work requir shadow inform present improv method estim illumin 5 factorizationunknown textur brdf correspond recov textur spatiallyvari brdf sato et al 32 rotat object turntabl use singl point sourc recov brdf paramet textur yu et al 38 recov textur diffus brdf compon account interreflect use larg number imag obtain move point sourc around sphere surround subject debevec et al 6 acquir reflect field human face recov paramet microfacet brdf model surfac locat sato ikeuchi 31 yu malik 39 recov brdf diffus textur natur illumin assum simpl parametr model skylight use sequenc imag acquir differ illumin condit method recov diffus textur constant valu rel lowresolut textur use specular param eter notabl except work dana et al 5 gener brdf 6d bidirect textur function btf 6 factorizationunknown light textur shown 29 distant illumin field caus low frequenc variat radios convex lambertian sur impli diffus object highfrequ textur recov independ light observ agreement percept literatur land retinex theori 15 wherein highfrequ variat usual attribut textur lowfrequ variat associ tion howev note fundament ambigu lowfrequ textur light effect therefor light textur factor without use activ method make assumpt regard expect characterist gener case three unknown 7 factorizationunknown light textur brdf ultim wish recov textur brdf unknown light solv problem without assump tion must first resolv lightingtextur ambigu approach differ previou work deriv mathemat theori invers render similar invers method use area radi transfer transport theori hydrolog optic 26 neutron scatter see mccormick 22 review previou theoret work dzmura 8 analyz reflect linear oper term spheric harmon discuss result perceptu ambigu reflect illumin comput graphic cabral et al 3 first demonstr use spheric harmon repres brdf extend method explicitli deriv frequencyspac reflect equat ie convolut formula provid quantit result variou special case earlier report theoret result planar flatland light field 27 determin light lambertian surfac 29 lambertian case similar result deriv independ basri jacob 1 simultan work face recognit paper extend previou result gener 3d case arbitrari isotrop brdf appli theori develop new practic inverserend algorithm assumpt input algorithm consist object geometri photograph number differ locat known extrins intrins camera paramet assum static scene ie object remain stationari light remain view method passivevis approach activ disturb environ assumpt reflect radianc coeffici basisfunct expans b incom radianc lm coeffici sphericalharmon expans l surfac brdf brdf multipli cosin incid angl lpq coeffici sphericalharmon expans incid elev angl local global coordin incid azimuth angl local global coordin outgo elev angl local global coordin outgo azimuth angl local global coordin hemispher integr localglob coordin x surfac posit surfac normal parameterizationelev angl surfac normal parameterizationazimuth angl r rotat oper surfac normal l matrix relat rotat group so3 lm spheric harmon basi function lm complex conjug spheric harmon l normal constant 1 figur 2 notat known geometri use laser rang scanner volumetr merg algorithm 4 obtain object geometri assum known geometri focu light materi properti curv object theoret analysi requir curv sur face assum knowledg entir 4d reflect light field correspond hemispher outgo direct surfac orient howev practic algorithm requir small number photograph distant illumin illumin field assum homogen ie gener distant sourc allow us use light function regardless surfac locat treat light gener function incid angl isotrop brdf consid surfac isotrop brdf brdf therefor function 3 variabl instead 4 ie 3d instead 4d interreflect ignor also shadow consid theoret anal ysi limit convex surfac howev account shadow practic algorithm necessari 4 theori reflect convolut section present signalprocess framework wherein reflect view convolut invers render de convolut first introduc preliminari defin notat deriv version reflect equat expand light brdf reflect light field spheric harmon deriv simpl equat term spheric harmon coeffici next section explor implic result incom light l outgo light b figur 3 schemat reflect top show situat respect local surfac brdf map incom light distribut l outgo light distribut b bottom figur show rotat affect situat differ orient surfac correspond rotat upper hemispher brdf global direct correspond local direct 41 preliminari purpos theoret analysi assum curv convex isotrop surfac also assum homogen object ie untextur surfac brdf everywher parameter surfac spheric coordin normal vector use standard convent correspond north pole z axi notat use section list figur 2 diagram figur 3 use two type coordin unprim global coordin denot angl respect global refer frame hand prime local coordin denot angl respect local refer frame defin local surfac normal two coordin system relat simpli rotat defin shortli reflect equat modifi equat 1 base sumption drop textur term use surfac normal instead posit x parameter b sinc assum independ x write final written simpli co cosin incid angl local coordin z mix local prime global unprim coordin light global function natur express global coordin frame function global angl hand brdf natur express function local incid reflect angl express local coordin frame brdf everywher homogen similarli express global coordin frame light everywher assumpt distant illumin reflect radianc b express conveni either local global coordin use local coordin match brdf similarli integr conveni done either local global coordin upper hemispher easier express local coordin defin transfer 1 function order absorb cosin term modif equat 2 becom z rotationsconvert local global coordin local global coordin relat rotat correspond surfac normal north pole local coor dinat 0 surfac normal correspond global coordin clearli defin r rotat oper 2 column vector rotat given rz rotat z axi ry rotat axi write depend incid angl equat 3 entir global coordin entir local coordin r r 1 want transfer function reciproc ie symmetr respect incid outgo angl may multipli transfer function reflect light field co 2 anisotrop surfac need initi rotat z set local tangent frame would rotat z zthe familiar euler angl parameter sinc deal isotrop surfac ignor initi z rotat physic signific difficult deriv theori gener anisotrop case interpret convolut spatial domain convolut result gener filter translat input signal howev gener notion convolut transform ta ta function write z ta translat obtain standard express spatial convolut ta rotat angl formula defin convolut angular domain therefor equat 4 5 repres rotat convolut equat 4 global coordin state reflect light field given surfac orient correspond rotat brdf orient integr upper hemispher brdf thought filter light input signal symmetr equat 5 local coordin state reflect light field given surfac orient may comput rotat light local coordin system brdf hemispher integr 42 spheric harmon represent translat case wellknown frequencyspac convolut formula given term fourier transform gener oper analog formula obtain term group represent associ basi function translat basi function sine cosinesth familiar fourier basi rotat correspond basi function spheric harmon proceed deriv frequencyspac rotat convolut formula term spheric harmon inui et al 11 good refer background spheric harmon relationship rotat use spheric harmon repres light similar respect previou method 25 use steerabl linear basi function spheric harmon well close relat zernik polyno mial use repres brdf 3 14 33 spheric harmon analog sphere fourier basi line circl spheric harmon ylm given l l l co e im nlm normal factor equat azimuth depend expand term fourier basi func tion depend expand term associ legendr function p l indic obey l 0 l l rotat formula spheric harmon l l mm e im import thing note indic mixeda spheric harmon rotat must express combin spheric harmon differ indic ever l indic mix rotat spheric harmon order l compos entir spheric harmon order l given order l l matrix tell us spheric harmon transform rotat yaxi ie rewrit rotat spheric harmon linear combin spheric harmon order begin expand light global coordin l ml coeffici llm comput standard way integr complex conjug lm z 2 repres transfer function spheric harmon note nonzero upper hemispher ie co interest isotrop brdf depend impli brdf invari respect ad constant angl incid outgo azimuth angl shown form spheric harmon condit forc term vanish unless use complex conjug lm expans make write furthermor invari brdf respect negat incid outgo azimuth angl requir final use three indic brdf repres reflect light field defin new set orthonorm basi function normal form function deriv appendix particular matrix come rotat formula spheric harmon equat 6 conveni first defin normal constant r r new basi function written expans reflect light field translat convolut theorem express convolut frequencyspac product fourier coeffici rotat case analog result deriv appendix use spheric harmon instead complex exponenti frequencyspac reflect equat rotat convolut mula similar product basisfunct coeffici implic section explor implic result problem invers render work special case detail theori indic invers problem tractabl oppos illpos illcondit final use insight gain develop new practic represent 51 gener observ invers manipul yield llm may use index invers brdf comput therefor brdf recoveri wellpos unless denomin vanish ie term order l spheric harmon expans light vanish signal process term input signal light amplitud along certain mode filter brdf mode estim brdf recoveri well condit light contain high frequenc like direct sourc illcondit soft light invers light equat 10 also manipul yield similarli brdf recoveri p q use invers light problem wellpos unless denomin vanish p q l signal process term brdf filter truncat certain frequenc input light signal instanc lowpass filter determin frequenc output signal invers light wellcondit brdf highfrequ compon like sharp specular illcondit diffus surfac light field factorizationlight brdf consid problem factor light field ie simultan recov light brdf unknown reflect light field defin fourdimension domain light function two dimens isotrop brdf defin threedimension domain seem indic known term coeffici reflect light field unknown light brdf coeffici fix order l use known light coeffici llm find unknown brdf coeffici lpq viceversa fact need one known nonzero light brdf coeffici bootstrap process would appear equat 10 howev unrecover scale factor order l correspond known coeffici requir also use reciproc brdf make transfer function symmetr multipli well reflect light field b co new transfer function symmetr respect incid outgo direct correspond indic plq global scale factor recov sinc b affect multipli light divid brdf amount therefor scale light dc term 1 4 use equat 11 12 13 llm last line use valu give explicit formula light brdf term coeffici output light field therefor global scale reflect light field factor light brdf provid appropri coeffici reflect light field vanish 52 special case mirror brdf mirror brdf correspond gaze sphere invers light problem easili solv angular space case show wellpos easili solv frequenc space brdf involv delta function note brdf nonzero 2 coeffici brdf reflect light field light 04 clamp l coeffici figur 4 left success approxim clamp cosin function ad spheric harmon term get good approxim right solid line plot spheric harmon coeffici l l l l 1 odd term vanish even term decay rapidli factor 1 q azimuth angl chang upon reflect see light coeffici correspond direct way coeffici reflect light field signal process terminolog invers light problem well condit frequenc spectrum delta function remain constant increas order l decay singl direct sourc conveni posit coordin axe sourc locat z ie 0 0 direct sourc describ delta function spheric harmon expans coeffici given simpli lm 0 vanish 0 thu angular space singl observ correspond singl brdf measur properti use imagebas brdf measur 18 21 see frequenc space similar straightforward relat brdf coeffici reflect light field coeffici brdf recoveri wellcondit sinc estim brdf filter impuls respons lambertian brdf lambertian object transfer function scale clamp cosin function sinc proport cosin incid angl upper hemispher equal 0 lower hemispher plot sphericalharmon fit clamp cosin function magnitud coeffici shown figur 4 depend outgo angl drop indic p q reflect light field effect surfac radios function expand 3 spheric harmon l ml blmylm 29 shown definit theta one deriv blm l defin l analyt formula l may deriv 29 shown l vanish odd valu l 1 3 basi function clmpq equat 9 becom m0 e im ignor output depend set brdf azimuth symmetr shown simpli ylm equat 15 follow natur equat 10 upon drop indic p q previou deriv 29 special lambertian case ignor output depend onset even term fall rapidli l 52 99 energi brdf filter captur l 2 numer thu lambertian brdf act like lowpass filter truncat sever attenu frequenc l 2 therefor observ lambertian surfac estim illumin formal illpos wellcondit light coeffici l 2 correspond 9 parameters1 5 order 2 l explain illcondit observ marschner greenberg 20 tri solv invers light problem lambertian surfac furthermor practic applic includ forward render 28 reflect light field lambertian surfac character use first 9 spheric harmon coef ficient light effect produc highfrequ variat intens respect surfac curvatur phong brdf normal phong transfer function r reflect outgo view direct surfac normal l direct light sourc shini phong expon normal ensur phong lobe unit energi technic must also zero brdf light upper hemispher howev phong brdf physic base other often ignor boundari effect reparameter reflect vector r transform integr upper hemispher center surfac normal integr center r reflect vector take place normal analysi refer r phong brdf reparameter mathemat analog lambertian brdf discuss fact properti convolut use show phong brdf blur light use mirror brdf equival use real light real brdf formal transform often made render environ map 23 specif equat 15 written l llm l lm blur illumin l mirror brdf 4 brdf coeffici depend given z 2theta co integr may solv analyt formula ap pendix numer plot figur 5 0202061l coeffici figur 5 numer plot phong coeffici l l defin equat 18 solid line approxim equat 19 4 formula l ident equat 14 sinc reparameter reflect vector account slightli differ normal larg l good approxim l 2 2s coeffici fall gaussian width order phong brdf behav frequenc domain like gaussian fil ter filter width control shini therefor invers light calcul wellcondit order approach infin l frequenc spectrum becom constant correspond perfect mirror microfacet brdf consid simplifi 4paramet torrancesparrow 36 model paramet kd ks microfacet model wide use comput graphic fs f exp subscript h stand halfway vector f fresnel term refract index normal 1 normal exit actual f depend angl respect halfway vector practic angl usual close simplic analysi omit geometr attenu factor g practic omiss signific except observ made graze angl usual assign low confid anyway practic applic focu specular compon reparameter reflect vector phong brdf also simplifi matter fix exit direct focu frequencyspac represent incidentangl depend precis analyt difficult deriv make good approxi mation shown appendix normal exit theta normal exit specular part brdf gaussian equat 20 simpli state even sphericalharmon basi frequenc spectrum gaussian also gaussian frequenc width relat reciproc angular width nonnorm exit microfacet brdf symmetr reflect vector unlik phong brdf prefer direct determin exit angl howev brdf filter essenti symmetr reflect direct small view angl well low frequenc l henc shown taylorseri expans verifi numer correct equat 20 small condit final approxim effect fresnel factor nonnorm exit multipli express f respect condit invers problem equat 20 indic invers light microfacet brdf wellcondit frequenc order l 1 equat also indic brdf estim illcondit lowfrequ light lowfrequ light may appli properti convolut phong brdf filter light use equat 17 20 use mirror brdf note frequenc l 1 effect filter insignific brdf pass virtual lowfrequ energi therefor light contain low frequenc reflect light field microfacet brdf essenti independ brdf filter width 1 make estim surfac rough illcondit 53 practic represent thu far present theoret foundat implic frequencyspac view reflect signal process approach use area comput graphic notabl theori alias frequencyspac analysi alias give mani insight difficult obtain mean last two section lead new way analyz invers render problem howev fourierspac theori alias gener use directli antialias ideal fourierspac bandpass filter spatial domain sinc function usual modifi practic purpos infinit extent lead ring similarli repres brdf pure linear combin spheric harmon lead ring ing moreov difficult comput fourier spectra spars irregularli sampl data similarli difficult comput reflect light field coeffici blmpq photograph would requir larg number input imag dens sampl entir sphere possibl direct reason frequencyspac idea must put practic care first discuss two use practic techniquesdu angular frequencyspac represent separ light slow fastvari com ponent final use idea insight gain previou subsect deriv simpl practic model reflect light field microfacet brdf represent use extens practic algorithm section 6 dual angular frequencyspac represent quantiti local angular space broad frequenc spectra viceversa develop frequencyspac view reflect ensur use either angularspac frequencyspac represent even combin two diffus brdf compon slowli vari angularspac local frequencyspac specular brdf compon local angular domain repres light frequencyspac view appropri diffus brdf compon angularspac view appropri specular compon separ slow fastvari light angularspac descript light use comput reflect light field specular brdf compon separ light slow vari compon correspond low frequenc area sourcesfor filter light use mirror brdfand fast vari compon correspond high frequenc direct sourc frequencyspac light descript use diffus brdf compon distinct need made sinc formula lambertian brdf slow fast vari compon model reflect light field model reflect light field microfacet brdf includ three compon sfast bd diffus compon brdf b sslow repres specular slowlyvari light b sfast specular highlight fast vari light compon write bd correspond lambertian brdf compo nent use 9 paramet frequencyspac represent light explicitli note l 2 e irradi e x l ml llmylm numer valu l l given equat 16 b sslow filter light use equat 17 20 treat brdf mirror r denot reflect direct lslow filter version light obtain fast vari portion lightingcorrespond sourc angular width treat total energi sourc given integr small solid angl subtend locat center light sfast given standard equat specular highlight direct sourc extra factor 4 co denomin compar equat 22 come relat differenti microfacet global solid angl jfast subscript j denot particular direct sourc could sever note l jfast total energi sourc brdf estim conveni expand equa tion make depend brdf paramet explicit 6 algorithm result section show theori particular model deriv section 53 appli broad rang practic invers render problem present two type method algorithm recov coeffici pure frequencyspac descript light brdf repres quantiti sum spheric harmon term algorithm estim paramet correspond model section 53 section 61 brdf estim demonstr direct recoveri spheric harmon brdf coeffici well estim parametr microfacet brdf use equat 24 similarli section 62 demonstr direct recoveri spheric harmon light coeffici well estim dual angular frequencyspac light descript per model section 53 section 63 show combin brdf light estim techniqu simultan recov light brdf paramet unknown case show direct recoveri spheric harmon coeffici thu far found imprac tical final section 64 demonstr algorithm geometr complex object show straightforward extend model handl textur shadow test method first use homogen sphere 5 differ materi sphere natur parameter spheric coordin therefor correspond directli theori later also use complex objectsa white cat sculptur textur wooden dollto show gener algorithm data acquisit use mechan gantri posit inwardlook toshiba iktu40a ccdx3 camera arc radiu 60cm calibr intrins done method zhang 40 sinc camera posit computercontrol extrins known map pixel radianc valu also calibr acquir 60 imag target sphere taken 3 degre interv map imag pixel angular coordin use imag silhouett find geometr locat center sphere radiu gantri also posit 150w white point sourc along arc sinc arc radiu 90 cm much larger sphere 125 2cm treat point sourc direct light larg area sourc 99 energi lowfrequ mode order l 6 obtain project white light project screen light distribut determin use gaze sphere inform use directli experi assum known illumin refer solut experi assum unknown illumin also use experiment setup point sourc measur brdf white teflon sphere use imagebas method marschner et al 21 independ measur use verifi accuraci brdf estim algorithm complex illumin 5 order mcmastercarr catalog httpwwwmcmastercom 61 invers brdf known light estim spheric harmon brdf coeffici spheric harmon zernik polynomi fit 14 measur brdf data previou work tri estim coeffici directli sinc brdf linear coeffici lpq simpli solv linear system determin lpq figur 6 compar parametr brdf estim complex light brdf measur use singl point sourc method marschner et al 21 expect 14 recov brdf exhibit ring one way reduc ring attenu highfrequ coeffici accord theori equival use low frequenc light therefor seen figur 6 imag render lowfrequ light exhibit ring close match real photograph sinc lowfrequ compon brdf import howev imag render use direct sourc show signific ring real marschner order 12 order 6 imag f slice real render lowfrequ light render direct sourc figur top slice brdf transfer function teflon sphere fix exit angl 63 vari linearli 0 90 top bottom linearli 0 360 left right central bright featur specular highlight left brdf slice independ measur use approach marschner et al 21 middl recov valu use maximum order 6 right recov version order 12 ring appar recov brdf right version sharper exhibit pronounc ring bottom left actual photograph light lowfrequ larg area sourc middl render use recov brdf order 6 light sinc light lowfrequ lowfrequ compon brdf import render appear similar photograph even though recov brdf includ frequenc higher order 6 right render direct sourc viewpoint exhibit ring practic applic usual conveni recov lowparamet brdf model sinc compact estim fewer observ exhibit ring rest section deriv improv invers render algorithm assum parametr brdf model estim parametr brdf model estim brdf paramet gener known light distribut use equat 24 input imag sampl reflect light field b perform estim use nest procedur outer procedur simplex algorithm adjust nonlinear paramet minim error respect imag pixel inner procedur linear problem solv kd ks numer work use simplex method e04ccc linear solver f01qcc f01qdc nag 9 c librari main differ previou work equat 24 provid principl way account compon light brdf allow use gener illumin condit test algorithm sphere sinc light includ high lowfrequ compon direct sourc area sourc theori predict paramet estim wellcondit valid algorithm compar paramet recov complex light one sam ple white teflon sphere obtain fit full brdf separ measur us use method marschner et al 21 unlik previou work brdf estim consid fresnel term note accur estim refract index requir correct noisefre measur graze angl sinc measur tend errorpron small error estim valu materi nevertheless find fresnel term import reproduc accur specular highlight obliqu angl paramet method fit data reflect 086 087 kdkd ks 089 091 kskd ks 011 009 rm 93 85 figur 7 comparison brdf paramet recov algorithm complex light fit measur made method marschner et al 21 result figur 7 show estim brdf paramet method quit accur small increas erroroffit use paramet recov algorithm fit measur brdf also determin percentag rm error imag render use recov brdf real photograph 5 10 visual comparison shown first third row figur 12 result indic expect theoret accur estim brdf even complex light 62 invers light known brdf previou method estim light develop special case mirror brdf gaze sphere lambertian brdf marschner greenberg 20 shadow present sato et al 30 previou method 20 30 also requir regular use penalti term userspecifi weight limit comput complex formul coars discret sphere present two new algorithm curv surfac gener brdf first method directli recov spheric harmon light coeffici llm second algorithm estim paramet dual angular frequencyspac light model section 53 method requir explicit regular yield highresolut result sharper first algorithm difficult extend concav surfac theori tell us invers light illcondit highfrequ therefor recov lowfrequ continu light distribut explicitli account direct sourc ie assum b sfast 0 reflect light field essenti independ surfac rough condit algorithm explicitli use theori predict recov illumin filter version real light direct sourc appear continu distribut angular width approxim estim spheric harmon light coeffici repres light coeffici llm l l solv linear leastsquar system llm first term parenthes correspond bd second b sslow cutoff l use regular order l 1 l l ml estim parametr dual light model anoth approach estim dual angular frequencyspac light model section 53 algorithm base subtract diffus compon bd reflect light field treat object mirror sphere recov highresolut angularspac version illumin specular compon alon determin bd need 9 lowest frequencyspac coeffici llm l 2 algorithm use follow method convert angular frequencyspac phase 2 phase 1 input f sslow db d1 lm lm figur 8 estim dual light represent phase 1 use frequencyspac paramet lm comput diffus compon b 1 subtract input imag leav specular compon angularspac light found phase 2 comput coeffici l 2 lm use determin consist condit b 1 l 1 lm subsequ figur light visual unwrap sphere rang equal increment 0 top bottom rang equal increment 0 2 left right imag wrap around horizont direct 1 9 paramet highresolut light input phase 1 coeffici l 1 lm suffic find b 1 equat 21 sinc assum b sfast 0 lslow assum brdf paramet known b input algorithm righthand side evalu 2 highresolut light 9 paramet use angular space valu l found first phase easili find 9 frequencyspac paramet light l 2 lm assum run phase 1 input l 1 lm phase 2 output l 2 sequenti consist condit lm convert frequenc angular frequenc space must chang result equival comput diffus compon must match ie b 1 lm illustr figur 8 sinc everyth linear term light coeffici consist condit reduc system 9 simultan equat solv llm run phase 1 determin highresolut light angular space figur 9 compar method refer solut gaze sphere algorithm give reason accur result predict theori highfrequ compon filter rough first method involv direct recoveri llm still residu energi l l sinc regular consid higher frequenciesw could increas l make result noisierth recov light somewhat blur compar dual angular frequencyspac algorithm second method real gaze sphere algorithm 1 f figur 9 comparison invers light method left right real light gaze sphere recov illumin direct estim spheric harmon coeffici l estim dual angular frequencyspac light model make artifact appar set 0 gray result dual algorithm sharper still somewhat blur filter small amount ring occur direct coeffici coveri seen l use l make solut noisi 63 factorizationunknown light brdf combin inversebrdf inverselight method factor reflect light field simultan recov light brdf unknown therefor abl recov brdf curv surfac unknown complex illumin someth previous demon strate unrecover global scale factor set find absolut reflect also theori predict lowfrequ light estim surfac rough illconditionedblur light sharpen brdf significantli chang reflect light field howev highfrequ light ambigu remov use singl manual specifi direct sourc recov light distribut estim algorithm algorithm consist nest procedur outer loop effect solv inversebrdf problema nonlinear simplex algorithm adjust brdf paramet minim error respect imag pixel sinc kd solv till light brdf paramet recov ks inner procedur linear problem solv estim light given set brdf paramet use method previou subsect pseudocod given global binput input imag global kd ks brdf paramet global l light procedur factor minimizek objfun simplex method figur 10 equat 26 function objfunk light field return rmsbinput bpred rm error find use direct sourc direct sourc presentand manual specifi us recov lightingw estim equat specular compon predict equat 22 23 center ie brightest point light sourc normal exit illustr figur 10 total f tot figur 10 manual specifi red box region correspond direct sourc visual light algorithm determin lcen intens center brightest point l tot total energi integr region specifi red box comput use equat 26 method depend size red boxprovid enclos entir filter sourc precis shape sourc filter recov light result use method subsectionwith dual angular frequencyspac algorithm invers lightingto factor light field sphere simultan estim brdf light setup light use sphere could compar recov illumin see figur 11 brdf estim unknown light accur absolut error small compar paramet recov known light signific anomali slightli low valu refract index caus know highfrequ light com ponent necessari accur estim fresnel term also abl estim filter version light shown figur 12 recov light distribut sampl larg consist predict theori direct sourc spread differ extent depend rough surfac ie valu final figur 12 show render imag use estim light brdf almost indistinguish real photograph materi k ks known unknown known unknown known unknown known unknown teflon delrin 087 088 013 012 144 135 010 011 neopren rubber 092 093 008 007 149 134 010 010 sandblast steel 020 014 080 086 020 019 bronz paint 627162 677564 029 025 138 115 015 015 figur 11 brdf variou sphere recov known section 61 unknown section 63 light report valu normal k valu report color object see ks much higher specular metal sphere especi high rough sandblast sphere fresnel effect close 1 metal consid fresnel term sphere light known light unknown light imag imag imag bronz sandblast paint delrin f teflon real light filter version real render render recov real light figur 12 sphere render use brdf estim known section 61 unknown section 63 light algorithm section 63 also recov light sinc unknown global scale scale recov light distribut order compar recov illumin larg consist sampl similar filter version real light predict theori differ rough caus direct sourc spread differ extent filter sourc slightli elong asymmetr microfacet brdf complet symmetr reflect vector 64 complex objectstextur shadow demonstr algorithm object complex ge ometri discuss extens handl concav surfac textur object although theori develop homogen surfac algorithm extend textur object simpli let brdf paramet function surfac posit would appear concav region one part surfac may shadow anoth seriou problem sinc theori develop convex object assum selfshadow howev use new practic model section 53 see extens necessari mainli involv check shadow reflect ray direct sourc routin oper raytrac shadowingconcav surfac practic model reflect light field consist 3 partsbd b sslow b sfast sslow depend lslow r slowlyvari compon light evalu reflect vector model allow us approxim effect shadow simpli check reflect ray shadow compon handl standard manner consid shadow comput b sfast correspond specular direct sourc check sourc shadow bd depend irradi e comput convent angular space way integr scene light consid vi ibil instead use 9paramet light approxim equat 21 emphas case correct visibl depend object geometri precomput point object use ray tracer parametr brdf estim modifi compon equat 24 consid visibl discuss first invers light method directli recov coeffici llm modifi similarli equat 25 check reflect ray shadow consid shadow comput irradi due ylm note b still linear combin light coeffici still solv linear system llm howev difficult extend dual angular frequencyspac method invers light handl concav surfac bd longer depend 9 light coeffici llm l 2 light field factor simpli extend inverselight method discuss white cat sculptur use test algorithm complex geometr object includ concav geometri acquir use cyberwar rang scanner align imag manual specifi correspond light slightli complex sphere experi use second direct sourc addit area sourc show recov brdf use small number imag use 3 input photograph recov brdf known light use method section 61 unknown lightingus factor method section 63 invers light compon direct recoveri spheric harmon coeffici use l comparison photograph render figur 1 13 brdf light paramet tabul figur 14 experi indic method brdf recoveri known unknown light consist accur even complex light geometri render imag close origin photograph even view light condit use brdf recoveri promin artifact imprecis geometr align insuffici geometr resolu tion instanc sinc geometr model includ eyelid cat featur miss render imag textur brdf sinc theori show factor light textur ambigu consid recoveri textur brdf known light fairli straightforward allow kd x ks x describ textur depend surfac posit x inner procedur parametr brdf estim algorithm section 61 simpli solv separ linear problem point x estim kd x ksx experiment test use wooden doll compar real input photograph imag render use recov textur brdf also took photograph object singl direct sourc compar render use textur brdf recov complex illumin result figur 15 show render close resembl real photograph main artifact blur textur geometryimag misregistr 7 conclus futur work paper develop signalprocess framework invers render qualit observ reflect light field convolut light brdf formal mathemat shown frequencyspac gaze sphere wellsuit recov lightingth frequenc spectrum mirror brdf delta function constantand input view view render known light real photograph render unknown light figur 13 comparison real photograph middl column imag render use brdf recov known light left column use brdf light estim unknown light right column top row one 3 input view bottom row new view use brdf estim note top row composit left right render background middl photograph order make meaning comparison paramet known light unknown light brdf paramet k 088 090 ks 012 010 light coeffici lm figur 14 brdf light paramet cat sculptur see good agreement brdf paramet valu recov known unknown light show method consist note normal kd may also check accuraci recov light sinc unknown global scale recov valu report normal light coeffici valu first 9 spheric harmon coeffici real form import significantli affect diffus compon brdf direct sourc wellsuit recov brdf estim brdf filter consid impuls spons condit properti wellposed brdf light estim variou condit de rive well explicit formula factor reflect light field light brdf illcondit observ marschner greenberg 20 estim light lambertian surfac explain shown factor light effect lowfrequ textur biguou result indic theori provid use analyt tool studi properti invers problem insight gain theori also lead new practic represent numer repres quantiti angular frequenc space depend lo cal lead new algorithm often express combin angular frequencyspac determin brdf light paramet import handl variou compon appropri brdf estim parametr recoveri algorithm yu malik 39 sato ikeuchi 31 love 17which design specif natur lightingcan seen special case gener render real render 1 view origin input sequenc view novel light real figur 15 recov textur brdf complex light render imag close resembl real photograph even novel light treat sunlight highfrequ skylight low separ provid gener framework arbitrari illumin also determin condit paramet recoveri robust instanc theori predict estim illcondit cloudi day lowfrequ light framework also appli develop new frequencyspac algorithm estim light object gener brdf use frequencyspac natur handl continu light distribut dual angular frequencyspac algorithm effect reduc problem gener brdf gaze sphere requir explicit reg ular allow much higher resolut obtain previou pure angularspac method 20 30 final demonstr method factor light field simultan estim light brdf allow us estim brdf geometr complex object unknown gener light previous demonstr scratch surfac possibl applic futur like mani algorithm deriv use basic approach outlin possibl algorithm improv includ extend consist condit invers light use colorspac method 13 help separ diffus specular compon color object final discuss invers render applic believ convolutionbas approach theoret practic import mani area comput graphic alreadi shown 28 use 9 term irradi approxim effici forward render diffus object environ map believ mani applic acknowledg grate marc levoy mani help initi discuss regard interpret reflect convolut practic issu invers render well read draft paper thank szymon rusinkiewicz mani suggest regard research read earli version paper ever will assist us debug problem gantri steve marschner also deserv thank detail comment mani earli draft jean gleason baltec assist suppli us mirror sphere final thank john parissenti polytec product much use advic obtain uniform sphere get one steel sphere sandblast cat rang scan sculptur seren sue daw work describ paper support part hodgsonre stanford graduat fellowship nsf itr grant 0085864 interact visual world r lambertian reflect linear subspac increas photor interact architectur walkthrough bidirect reflect function surfac bump map volumetr method build complex model rang imag reflect textur realworld surfac acquir reflect field human face estim surfac reflect properti imag unknown illumin comput model visual process numer algorithm group determin reflect properti object use rang bright imag group theori applic physic imag base measur system anisotrop reflect measur highlight color imag phenomenolog descript bidirect surfac reflect light retinex theori surfac reflect model estim natur illumin imag sequenc optic properti bidirect reflect distribut function velvet spheric harmon invers light photographi invers radi transfer problem review simul object simul real environ geometr consider nomenclatur reflect effici rerend natur illumin environ hydrolog optic analysi planar light field homogen convex curv surfac distant illumin effici represent irradi environ map relationship radianc irradi determin illumin imag convex lambertian object illumin distribut bright shadow adapt estim illumin distribut unknown reflect properti shadow region reflect analysi solar illumin object shape reflect model observ global illumin solut gener reflect distribut invers render comput graphic estim reflect paramet singl color imag theori offspecular reflect roughen surfac siggraph 92 invers global illumin recov reflect model real scene photograph recov photometr properti architectur scene photograph flexibl new techniqu camera calibr tr bidirect reflect function surfac bump map global illumin solut gener reflect distribut determin reflect properti object use rang bright imag measur model anisotrop reflect volumetr method build complex model rang imag object shape reflect model observ recov photometr properti architectur scene photograph increas photor interact architectur walkthrough reflect textur realworld surfac invers global illumin digit michelangelo project acquir reflect field human face flexibl new techniqu camera calibr effici represent irradi environ map estim reflect paramet singl color imag reflect analysi solar illumin invers render comput graphic ctr makoto okab yasuyuki matsushita takeo igarashi heungyeung shum illumin interact design imagebas light acm siggraph 2006 research poster juli 30august 03 2006 boston massachusett g h hu k ong p chen c nee technic section reflect model textur object uncontrol illumin high dynam rang map comput graphic v31 n2 p262270 april 2007 martin fuch volker blanz hendrik lensch hanspet seidel reflect imag modelbas approach human face ieee transact visual comput graphic v11 n3 p296305 may 2005 gustavo patow xavier pueyo alvar vinacua technic section userguid invers reflector design comput graphic v31 n3 p501515 june 2007 kuangchih lee jeffrey ho david j kriegman acquir linear subspac face recognit variabl light ieee transact pattern analysi machin intellig v27 n5 p684698 may 2005 ravi ramamoorthi melissa koudelka peter belhumeur fourier theori cast shadow ieee transact pattern analysi machin intellig v27 n2 p288295 februari 2005 enhua wu qimin sun xuehui liu recoveri materi complex illumin condit proceed 2nd intern confer comput graphic interact techniqu australasia south east asia june 1518 2004 singapor ning xu narendra ahuja shape view independ reflect map multipl view intern journal comput vision v73 n2 p123138 june 2007 bei xiao david h brainard color percept 3d object constanc respect variat surfac gloss proceed 3rd symposium appli percept graphic visual juli 2829 2006 boston massachusett ravi ramamoorthi analyt pca construct theoret analysi light variabl imag lambertian object ieee transact pattern analysi machin intellig v24 n10 p13221333 octob 2002 jan kautz peterpik sloan john snyder fast arbitrari brdf shade lowfrequ light use spheric harmon proceed 13th eurograph workshop render june 2628 2002 pisa itali raanan fattal dani lischinski michael werman gradient domain high dynam rang compress acm transact graphic tog v21 n3 juli 2002 sara keren ilan shimshoni ayellet tal place threedimension model uncalibr singl imag architectur scene proceed acm symposium virtual realiti softwar technolog novemb 1113 2002 hong kong china yang wang dimitri samara estim multipl direct light sourc synthesi augment realiti imag graphic model v65 n4 p185205 juli jefferson han ken perlin measur bidirect textur reflect kaleidoscop acm transact graphic tog v22 n3 juli imari sato takahiro okab yoichi sato appear sampl real object variabl illumin intern journal comput vision v75 n1 p2948 octob 2007 paul debevec andrea wenger chri tchou andrew gardner jami waes tim hawkin light reproduct approach liveact composit acm transact graphic tog v21 n3 juli 2002 chang ha lee xuejun hao amitabh varshney light collag light design effect visual proceed confer visual 04 p281288 octob 1015 2004 jan kautz peterpik sloan jaakko lehtinen precomput radianc transfer theori practic acm siggraph 2005 cours juli 31august jaakko lehtinen jan kautz matrix radianc transfer proceed symposium interact 3d graphic april 2730 2003 monterey california kenji hara ko nishino katsushi ikeuchi light sourc posit reflect estim singl view without distant illumin assumpt ieee transact pattern analysi machin intellig v27 n4 p493505 april 2005 ravi ramamoorthi dhruv mahajan peter belhumeur firstord analysi light shade shadow acm transact graphic tog v26 n1 p2e januari 2007 martin fuch volker blanz hendrik pa lensch hanspet seidel adapt sampl reflect field acm transact graphic tog v26 n2 p10e june 07 srinivasa g narasimhan mohit gupta craig donner ravi ramamoorthi shree k nayar henrik wann jensen acquir scatter properti particip media dilut acm transact graphic tog v25 n3 juli 2006 xuejun hao thoma babi amitabh varshney interact subsurfac scatter transluc mesh proceed symposium interact 3d graphic april 2730 2003 monterey california ravi ramamoorthi pat hanrahan frequenc space environ map render acm transact graphic tog v21 n3 juli 2002 sara keren ilan shimshoni ayellet tal place threedimension model uncalibr singl imag architectur scene presenc teleoper virtual environ v13 n6 p692707 decemb 2004 imagebas skin color textur analysissynthesi extract hemoglobin melanin inform skin acm transact graphic tog v22 n3 juli david aker frank losasso jeff klingner maneesh agrawala john rick pat hanrahan convey shape featur imagebas relight proceed 14th ieee visual 2003 vis03 p46 octob 2224 imari sato yoichi sato katsushi ikeuchi illumin shadow ieee transact pattern analysi machin intellig v25 n3 p290300 march g narasimhan shree k nayar practic analyt singl scatter model real time render acm transact graphic tog v24 n3 juli 2005 andrew gardner chri tchou tim hawkin paul debevec linear light sourc reflectometri acm transact graphic tog v22 n3 juli michael grossberg shree k nayar model space camera respons function ieee transact pattern analysi machin intellig v26 n10 p12721282 octob 2004 frdo durand nicola holzschuch cyril soler eric chan franoi x sillion frequenc analysi light transport acm transact graphic tog v24 n3 juli 2005 wojciech matusik hanspet pfister addi ngan paul beardsley remo ziegler leonard mcmillan imagebas 3d photographi use opac hull acm transact graphic tog v21 n3 juli 2002 weichao chen jeanyv bouguet michael h chu radek grzeszczuk light field map effici represent hardwar render surfac light field acm transact graphic tog v21 n3 juli 2002 ronen basri david w jacob lambertian reflect linear subspac ieee transact pattern analysi machin intellig v25 n2 p218233 februari ko nishino shree k nayar eye relight acm transact graphic tog v23 n3 august 2004 xuejun hao amitabh varshney realtim render transluc mesh acm transact graphic tog v23 n2 p120142 april 2004 steven seitz kiriako n kutulako plenopt imag edit intern journal comput vision v48 n2 p115129 juli 2002 shree k nayar peter n belhumeur terri e boult light sensit display acm transact graphic tog v23 n4 p963979 octob 2004 hendrik p lensch jan kautz michael goesel wolfgang heidrich hanspet seidel imagebas reconstruct spatial appear geometr detail acm transact graphic tog v22 n2 p234257 april ravi ramamoorthi pat hanrahan signalprocess framework reflect acm transact graphic tog v23 n4 p10041042 octob 2004 rodrigo l carceroni kiriako n kutulako multiview scene captur surfel sampl video stream nonrigid 3d motion shape reflect intern journal comput vision v49 n23 p175214 septemberoctob 2002 hendrik p lensch michael goesel yungyu chuang tim hawkin steve marschner wojciech matusik gero mueller realist materi comput graphic acm siggraph 2005 cours juli 31august hendrik p lensch michael goesel yungyu chuang tim hawkin steve marschner wojciech matusik gero mueller realist materi comput graphic acm siggraph 2005 cours juli 31august