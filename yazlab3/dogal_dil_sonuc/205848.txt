analysi costat discret paramet estim linear evolut equat wide use approach paramet identif output leastsquar formul numer method solv result minim problem almost invari requir comput gradient output leastsquar function identif problem involv timedepend distribut paramet system approxim thereof numer evalu gradient extrem time consum costat method greatli reduc cost comput gradient howev question rais concern accuraci converg costat approxim even numer method use known converg rapidli forward problem paper shown use timemarch scheme yield highord accuraci forward problem necessarili lead highord accur costat approxim fact case approxim converg howev certain circumst rapidli converg gradient approxim result rapid weakstartyp converg costat approxim issu treat theoret numer b introduct paper analyz tempor discret costat method comput gradient output leastsquar approach paramet esti mation analysi appli initi valu problem form aq bound linear oper hilbert space h inner product h denot hdelta deltai h dot u indic differenti respect refer u state variabl 11 state equat assum q lie set qad admiss paramet contain norm linear paramet space q throughout paper assum map q 7 aq gateaux differenti oper norm applic interest 11 finit dimension ie dimh 1 approxim timedepend pde import exampl diffus equat depart mathemat scienc montana state univers bozeman mt 59717 research support part nsf grant dms9106609 center interfaci microbi process engin montana state univers nsfsponsor engin research center center industri associ center appli mathemat scienc univers southern california lo angel ca 90089 1113 address juli 1 1992 depart mathemat texa univers colleg station 778433368 research support part air forc offic scientif research grant afosr900091 afosr860126 nsf grant dms8818530 dms8704169 situat dimh arbitrarili larg gener assum solut u lie state space hilbert space inner product bank kunish 3 assum exist observ space z hilbert space inner product hh delta delta ii z observ oper given observ z u one wish estim paramet q output leastsquar approach paramet estim q 2 qad select minim function uq solut 11 scalar ff posit regular paramet n 2 q regular function whose purpos stabil minim usual n q norm seminorm q comput method minim ff q typic requir gradient gradient ap proxim exampl assum discret paramet form one often see exampl 3 section v6 approxim compon gradient use finit differ eg small scalar note limit 0 th compon rt ff q direct ie gateaux deriv ff q direct dimh n q larg gradient approxim base directli 15 extrem expens requir evalu function ff henc n q solut evolut equat 11 attract altern costat approach 3 section v5 7 describ continu form section 2 sharp contrast n q 1 state equat solut need finit differ method 15 costat method requir solut two evolut equat state equat costat adjoint equat follow n q hinner product unfortun comput experi adjoint approxim paramet estim certain evolut equat puzzlingli disappoint exampl author 4 conclud approach unsatisfactori extrem difficult obtain accur search direct gradient comput manner also 2 author suggest costat method certain class damp elast system explain may facilit effici use gradientbas method conjug gradient bfg also report use numer experi howev none specif exampl upon report use method subsequ privat commun two author reveal encount unexpect difficulti costat approach later comment 1 bank state experienc much difficulti costat base gradient method abandon similar difficulti encount optim control set 5 dealt comput method control system govern delay differenti equat author observ certain spline approxim solut oper ricatti equat fail converg strongli subsequ work 6 care shown underli difficulti lack strong converg adjoint approxim paper focu tempor discret costat system leastsquar paramet estim sinc costat method comput rt ff q requir solut two evolut equat plu n q inner product two import compon numer scheme approxim gradient scheme approxim solut evolut equat assum timemarch scheme b numer quadratur scheme say th order accur one would reason hope attain th order converg gradient approxim howev observ oper c involv pointwis evalu time certain subtleti aris one may observ unexpectedli poor converg gradient approxi mation perhap strike exampl present involv fourthord rungekutta rk4 timemarch scheme show rk4 use conjunct simpon rule fourthord numer quadratur gradient approxim fail altogeth converg show fact rk4simpson approxim converg secondord accuraci 32 time true gradient posit perhap equal surprisingli prove rk4 togeth secondord accur trapezoid quadratur rule yield fourthord converg underli reason strang phenomena c involv pointwis evalu time costat equat evolut equat diracdelta function forc term reason costat approxim solut converg strongli howev case exhibit highord converg weak topolog dual space c consider similar spirit work report 6 introduct paper author state feel mani distribut paramet control system might lead numer difficulti use optim scheme hope reader motiv think similar problem complex distribut paramet system paper address optim control problem nonetheless relev us extent output leastsquar paramet estim mathemat similar optim control bank 1 suggest nonconverg costat approxim also occur paramet estim lack converg spatial discret exampl system 12 one must discret respect compon x well respect result need costat approxim essenti converg dual semigroup consider suggest direct futur work pursu section 2 discuss costat method continu problem apart tempor approxim section 3 introduc fairli wide class timemarch scheme 11 correspond costat approxim scheme analyz approxim detail make certain assumpt properti timemarch scheme observ oper variou oper discret section contain numer exampl illustr result analysi section 5 sever altern approach avoid difficulti mention present conclus work discuss section 6 2 continu costat approach state introduct typic implement output leastsquar approach paramet estim requir gradient function ff q given 14 effort obtain gradient lie comput gradient least squar function solv state equat sinc gradient q obtain comput direct deriv focu throughout comput direct deriv q direct p given residu defin henc solut 22 given term solut oper sq z te aq term sq thu take adjoint c sq one obtain solut costat equat oper q given e gammaa qs differenti equat satisfi sinc equat final condit instead initi condit use note equival j time revers oper h defin costat approach comput rt q consist follow four step continu costat method solv state equat 22 state variabl ii comput residu iii solv costat equat 29 costat variabl iv comput direct deriv direct p cf equat 15 note approach requir solut two evolut equat state equat 22 costat equat 29 oppos n q 1 evolut equat 15 moreov linear q case approxim 12 exampl implement step iv straightforward final note complet comput rt ff q necessari comput gradient rn 2 q regular function usual trivial 3 analysi discret approxim 31 discret approxim usual solv 22 numer one use sort finitediffer timemarch scheme tm section pose analyz rather natur algorithm comput costat approxim base given tm continu costat method describ given n let denot specifi mesh 0 f defin h k k later use discuss asymptot rate converg defin also let u k approxim state variabl u n k obtain use particular tm mesh denot fft n k g f n may express approxim approxim use minim scheme ff q paramet estim problem correspond continu leastsquar function 21 defin z n z n c n discret z z c discuss detail minim scheme requir direct deriv ie gradient seemingli natur approach 3 section v5 call discret costat approxim base obviou discret continu costat method suggest discret costat approxim comput ii comput residu r iii comput n j n approxim j cf 210 given c n approxim adjoint c iv approxim direct deriv direct p hh delta delta ii h n discret continu inner product 13 converg g depend factor converg time march scheme tm forward problem converg approxim c n observ oper c converg discret inner product hh delta delta ii h n continu inner product hh delta delta ii h hh delta delta ii z respect carri converg analysi first care state discret version problem h f k0 k0 h n inner product fw n k0 given sequenc weight purpos weight facilit definit hh delta delta ii h n way wellapproxim hh delta delta ii h accordingli assum essenti without loss gener exist independ n form basi follow lemma lemma 1 sequenc ff n g 2 h n properti constant 0 0kn kf n kf n kh also denot hh delta delta ii e n inner product loos speak use standard euclidean inner product time compon specif inner product use adjoint comput two inner product relat w n diagon oper h n defin assum time march scheme tm form n q defin recurs bound oper b k q express term compon see section 4 specif exampl make follow assumpt tm a1 tm stabl 10 ie exist term product order left right decreas indic a2 constant a2 f 2 c 0 f h ft ds ojhj a4 state equat 22 forc function f lie c 0 f h follow theorem readili establish theorem 1 a1a4 hold use a2a4 22 312 one obtain one use a1 induct show 0kn theorem follow lemma 1 32 rate converg gradient address converg state direct deriv approxim result obtain subsect later use prove converg discret costat approxim assum exist oper also note c make follow assumpt relationship inner product approxim a5 consid converg direct deriv 25 31 a6 hold rate converg e 1 directli determin rate converg solut forward problem e 3 assur a5 rate converg e 2 determin fast take direct deriv compon form recurs 312 hand ft n take direct deriv give compar 319 320 one show desir converg provid direct deriv oper preserv converg rate smooth precis assum r h ds ojhj obtain follow analogu theorem 1 theorem 2 assumpt a1a4 a2a4 hold proof notat conveni suppress depend q first show k kh bound independ k n appli 319 recurs assumpt a1 j assumpt a2a3 theorem 1 z h je ft integr term inequ bound independ j consequ assumpt a4 subtract 320 319 ft n ds bounded k result theorem 1 assumpt term right side equat ojhj 1 except first term thu equat form 313 argument use proof theorem 1 appli 315 one obtain follow result theorem 3 assumpt a1a6 a2a4 proof refer equat 316 schwartz inequ definit r r n z n first term within parenthes ojhj theorem 1 second a6 kffi p u n kh n bound theorem 2 consequ je similarli equat 317 theorem 2 assumpt a6 final 318 a5 je 3 33 continuoustim versu discretetim observ follow subsect analys converg costat approxim subsect make preliminari consider toward end lead specif two distinct class observ oper c breviti notat set 211 34 one obtain consequ theorem 1 bounded ffi p fact oper ffi p p n commut sequenc fki n kh ng bound schwartz inequ 324 impli ng bound je henc rate converg costat approxim direct deriv depend rate 29 see oper represent z te aq similarli 32 oper obtain replac q format n r n cf 310311 oper c approxim adjoint c z select adjoint oper differ choic might made basi discuss section 5 sinc costat vector given term evolut equat c r sourc term similar statement true approxim find conveni specifi c facilit analysi converg je 2 j commonli happen applic c inherit type tensorproduct structur state space particular assum exist bound spatial observ oper z hilbert space relat z descib distinguish two case practic import observ continu time first case observ oper c con tinuou time defin term space z bound oper act case defin addit defin q n inner product approxim manner analog 35 36 note case valid assumpt a5 determin quadratur weight w n k also determin accuraci hh delta delta ii h n approxim assumpt a6 trivial satisfi case sinc c n p 328 definit adjoint residu r r n appear given observ discret time second case assum observ oper c consist spatial observ taken discret point time accordingli assum discret observ space z form z simplic assum given set tempor observ point f g timemarch grid n alway chosen f g ae n alway inject map ng f 2 c0 f case sinc observ space alreadi discret defin ident z 3 case assumpt a5 alway true sinc z also a6 alway true sinc continuoustim observ case c n p c true sinc assum f g ae n 329 definit adjoint find c z 7 h given ffidelta denot dirac delta function discret analogu 332 ffi k denot kroneck delta function integ pair 34 rate converg costat approxim discuss previou subsect immedi follow 323 suffic consid converg term je 2 j zero address simpl case continu time observ first case th order converg e 2 result observ data z smooth enough theorem 4 a1a6 a2a4 hold data z lie c 0 f z proof 325 325 note j c c preserv smooth respect smooth z smooth u follow a4 jc r 2 c 1 0 f h appli theorem 1 jc r place forc function f place note last term 334 ojhj also a1 a3 ks n k bound independ n 335 336 suffic show follow theorem 1 bounded c c result theorem assumpt quadratur weight chosen correctli cf 36 obtain costat converg corollari 1 hypothes theorem 4 hold g 1 g 2 c 0 f h proof theorem 4 impli sequenc fki n kh ng bound discuss immedi follow 323 suffic show first term ojhj theorem 4 sinc oe suffici smooth second term ojhj 337 next address case discret time observ case c r given linear combin dirac delta function 332 sinc forc term costat equat question fast g rather delic particular smooth c r play crucial role proof theorem 4 present case c r smooth exist distribut thu proof theorem 4 henc corollari 1 valid case hand converg 333 stronger actual need essenti statement strong pointwis converg h 323 see sort weak converg would suffici rewrit e 2 note oe 2 c 1 0 f h need establish th order weak converg n dual space c 1 0 f h seemingli natur situat weak converg appli number subtleti aris explor matter discuss shortli howev one class problem fulli analyz cover varieti secondord method uniform mesh n theorem 5 assum assumpt a1a4 hold b a2a4 c observ point lie interior 0 f partit n uniform sens h e quadratur weight w k equat 36 given w weight correspond trapezoid rule numer quadratur f oper b k term n defin cf 311 k oper b g oper r n may written note 311 last compon r role tm purpos defin way becom clear h oper b r 0 r 1 ration function aq proof corollari 1 suffic show lead us studi 326 see shall take adjoint inner product right side equat main effort proof lie subsequ simplif particular goal show proceed detail first note 39 sinc p n oe 0 condit e obtain refer 342 344 note j n j n equal ident obtain j j r n denot adjoint respect e n inner product defin 39 use fact j n selfadjoint respect hh delta delta ii e n next assert r n 311 339 340 oper n r n follow block toeplitz matrix represent r block oper h oper n r n ident block toeplitz form except b r 0 r 1 replac hadjoint consider block matrix represent action j n e n adjoint one verifi 346 347 hold thu 345 simplifi thu question aris much n r n r n n differ sinc b r 0 r 1 ration function aq commut comput base directli 311 340 reveal arbitrari r r r result may also obtain directli matrix represent 348 349 thu commut equat 351 hold g 2 h n case present interest name 350 role g play p n oe p n oe thu 350 351 observ point less f yet occur mesh point see discuss lead 330 thu c n r n last term equat drop also sinc n r n p n oe obtain condit e combin 342 yield 343 theorem 1 reason similar proof theorem 1 sinc oe smooth also ks consequ right side 343 may replac hh z within secondord use definit e 2 323 fact hh find result follow assumpt a6 result similar theorem 5 obtain certain fourthord method includ ing rungekutta uniform mesh provid forc function f zero provid appropri quadratur weight chosen surprisingli weight correspond second order quadratur rather fourth order theorem 6 assum forc term f satisfi theorem 5 hypothesi b a2a4 c theorem 5 hypothesi c theorem 5 hypothesi theorem 5 hypothesi e f theorem 5 hypothesi f g oper r n may written theorem 5 hypothesi h proof given g 2 h n r n g defin k 0 r n g 0 unspecifi defin f r n note f a3 satisfi r n necessarili f r n c therefor may replac r n f r n 326 sinc block matrix represent f r n toeplitz follow reason similar lead 350 proof theorem 5 obtain r proof theorem 5 consid extent f r n n fail commut goal show r may invok reason similar follow 352 f r 311 354 fact lengthi straightforward comput also definit n r n f r n a3 find 1 k n z oet n ds substitut 356 yield gammah z oet n ds oh 4 integr term equat approxim within fourthord accuraci replac oet secondord taylor polynomi argument use show fourthord converg simpson ruleh z oet n z n ds oh 4 evalu n use assumpt a3 make substitutionh z oet n hypothesi u 0 mean thush z oet n h also oet n oet n replac n n respect within thirdord accuraci 358 yield g fact true a2 thu arriv shown 1 r use 355 reason similar 353 obtain also natur ask happen use fourthord tm fourthord quadratur scheme simpson rule show gradient approxim thu comput fail converg although direct space q converg particular rk4simpson costat approxim converg quadrat 32 time true gradient corollari 2 assum hypothes theorem 6 hold except e assum e quadratur weight aris simpson rule limit n 1 taken repeat doubl n precis integ n 0 n equal n 0 2 l posit integ l argument similar use obtain 355 find r r n 354 defin rap weight matrix correspond trapezoid rule shall show kv gamma vkh impli r show induct kv gamma vkh note first v assum k 1 v note 311 fw n k g simpson weight diagon entri w n simp thu definit w n simp smooth oe fact follow second parenthes term equal h 2hoet n a2 use observ definit w n divid 2 thu find induct hypothesi v may replac v kgamma1 v kgamma1 right side equat result express definit formula thu sinc also true obtain v hold may use reason lead 359 obtain next turn attent c n r n g refer 33 see g depend linearli f1w k g show simpson weight replac trapezoid weight result call 32g inde follow easili hypothesi guarante even simpson weight w k satisfi w 23h simpli 32 time th trapezoid weight thu right side 362 equal within oh 2 32 time right side 355 thu result theorem 6 appli obtain desir result 4 numer exampl illustr result previou section focu splinebas galerkin approxim fix dimension diffus equat 12 one space dimens direct deriv correspond leastsquar function 21 accordingli 1 fix n 1 take basi function fb g n usual piecewis linear hat function uniform mesh nodal point x 1 given 1 n seek approxim u solut diffus equat 12 linear combin basi function ie fix denot coeffici vector fu tg simpli ut ndimension linear system form 22 obtain u standard galerkin method requir ux z 1 z 1 gammaqx x dx dx implement integr left side equat encod exactli one right side approxim use trapezoid rule report result six numer experi 3 thu h subspac l 2 0 1 consist continu function 0 1 equal zero endpoint piecewis linear interior node x one experi exampl continu time observ rest base discret time observ case spatial observ oper c 327 defin pointwis evalu function h point function qx perturb px repres linear spline describ perturb p element h specif zero endpoint vari x 3 thu qdepend linear evolut equat given data z gener carri approxim outlin approxim linear spline interpol sourc term fx chosen solut ux 12 ux direct deriv 23 approxim 34 investig base qx j 1 three experi base nonuniform mesh n explain mesh gener suffici explain vector fh k g gener highlight depend n denot vector h n individu hvalu h n k gener nonuniform h n begin given n creat uniform mesh set h n n given mesh ratio r satisfi 1 mesh refin scheme gener h 2n h n n choic refin mesh uniform clearli true choic r examin converg properti costat approxim use four differ timemarch scheme 32 state equat 22 method cn trapezoid cranknicholson method rk2e explicit secondord rungekutta method rk2i implicit secondord rungekutta method rk4 explicit fourthord rungekutta method order express rk4 method form compat hypothesi g theorem 6 first obtain fourthord accur approxim f k12 evalu n k1 2 cubic polynomi interpol 2 uniform mesh yield carri rather extens numer investig use matlab softwar packag 9 sun sparcstat 2 decstat 5000200 case compar costat approxim g centereddiffer approxim comput evalu express limit sign 23 replac n ffl valu ffl call ep matlab machinedepend constant defin smallest integerpow 2 1 sparcstat 2 number repres sixteen decim place choic ffl finit differ comput reflect desir strike balanc discret error roundoff error heurist 8 page 3132 expect ffi p n fd thu comput agre correct valu roughli half sixteen decim place result theorem 3 true gradient discret function full accuraci ffi p q assumpt a5 a6 cours sinc within eight digit triangl inequ impli rate converg g correctli indic rate converg g long rel differ two quantiti larger six experi tabul rel error 1im four method jhj vari result estim actual rate converg base assumpt e case 1 observ continu time mesh nonuniform refin 13 trapezoid quadratur rule use h n inner product three secondord method simpson rule use rk4 method 667e3 16e6 26e4 20e4 29e6 444e3 52e7 78e5 68e5 21e7 27 27 27 64 case 2 experi motiv theorem 5 take observ discret time uniform mesh quadratur weight 36 aris trapezoid rule result present follow tabl 10e2 88e10 87e5 69e5 39e6 three rungekutta method appear converg secondord rate predict theorem 5 cranknicholson costat approxim agre forwarddiffer approxim within nine decim place roughli expect accuraci ffi p n fd fact uniform mesh g comput cranknicholson method exactli equal neglect roundoff error outlin proof assert recurs formula 312 take form use 319 lead refer 322 42 see last equat recurs reason similar led 343 right side equat rewritten 34 322 326 g numer 41 nonzero extent explain cranknicholson column tabl case 3 exampl case 2 nonuniform mesh gener 13 case theoret basi expect converg inde tabl suggest converg obtain 67e3 16e3 27e2 19e2 98e3 44e3 16e3 24e2 20e2 42e1 case 4 conjectur case even though mesh n may nonuniform highord converg still achiev provid mesh local uniform sens given n h k near given observ point constant precis posit integ oe real h n 330 exampl repeat experi report case 3 took step ensur refin mesh local uniform 67e3 58e5 62e3 22e3 98e3 44e3 25e5 21e3 12e3 42e1 tabl suggest highord converg sometim obtain local uniform mesh howev pursu idea case 5 next present exampl illustr theorem 6 forc term f state equat chang rk4 method use togeth quadratur weight matrix w rap aris trapezoid quadratur rule weight appear theorem 6 hypothesi mesh refin uniform 10e2 65e8 43 case 6 final illustr corollari 2 repeat experi shown case 5 use simpson rule instead trapezoid rule compar g 10e2 31e3 22 5 altern approach throughout preced section discuss use discret costat approxim attempt illustr delicaci procedur pointwis time observ involv least three possibl approach also merit consider pointwis observ involv briefli discuss strategi pursu section 2 3 take discret adjoint system first deriv costat method continu problem discret result equat integr altern would use adjoint discret system approach straightforward appli boundari valu problem certain complic may aris implement evolut equat particularli time march scheme use tempor discret particular definit 31 discret leastsquar function express compon ffi p u n 319 definit 311 n q see fl n q p given thu advantag approach yield exact valu direct deriv n henc numer attempt minimizet n fix n would ideal howev involv use fl n q p given 51 may requir signific amount addit mathemat effort code complex comput execut time disadvantag may negat whole part certain special case express simplifi simplif occur cranknicholson method uniform time mesh describ case 2 section 4 howev pursu approach anoth altern 3 section v 530532 retain strategi discret continu adjoint system transform costat equat 29 increas smooth sourc term done introduct two new variabl given z tjc rs ds idea sinc piecewis constant oppos jc r linear combin dirac delta function easier obtain accur numer solut first approxim given briefli explor idea numer repeat relev numer exampl case 2 case 3 section 4 case four tmss use approxim instead set run observ linear converg direct deriv eg approxim 1 case obvious uniform time mesh case 2 repres loss accuraci nonuniform mesh case 3 definit improv one altern consid modifi step iii discret costat approxim along follow line instead attempt integr whole interv 0 f one shot tm one treat subinterv rate use fact j n c zero interior subinterv jump discontinu correspondingli quadratur 34 must modifi although implement complic analysi along line proof corollari 1 appli consequ suffici smooth statevari forc function f full accuraci tm quadratur yield full accuraci costat approxim 6 summari conclus costat method offer potenti dramat time save comput gradient paramet estim problem timedepend system indic care must taken use approach shown analyt numer use converg timemarch quadratur scheme seemingli reason combin yield surprisingli poor result difficulti lie fact forc term costat equat may nonsmooth assumpt tm quadratur scheme converg violat descript discret costat approxim begin section 3 assum tm use step iii black box without regard smooth lack thereof j n c costat implement analyz involv discret con tinuou costat equat use standard time march scheme due simplic approach desir result gradient approxim order accuraci particular time march scheme present condit guarante condit straightforward instanc sever popular second order time march scheme yield second order gradient approxim provid uniform time mesh use combin second order accur trapazoid quadratur condit less obviou cf theorem 6 also demonstr certain reason implement yield gradient approxim fail converg eg fourth order time march uniform time mesh combin fourth order trapa zoidal quadratur final sever altern though less simpl costat implement present r comput issu paramet estim feedback control problem partial differenti equat method identif materi paramet distribut model flexibl structur estim techniqu distribut paramet system numer scheme estim function paramet distribut model mix mechan lake sea sediment core splinebas techniqu comput riccati oper feedback control regul problem delay equat nonconverg adjoint semigroup control system delay de la nonlinearit dune equat paraboliqu quasi linear numer method unconstrain optim nonlinear equat differ method initi valu problem tr