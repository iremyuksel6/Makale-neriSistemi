optim schedul parallel cbr video server parallel video server necessari largescal videoondemand multimedia system paper address schedul problem parallel video server discuss schedul requir constant bit rate cbr video stream optim algorithm present conflictfre schedul delay minim request reloc admiss control algorithm video stream precis schedul qualiti servic requir perform algorithm also present b introduct increas demand capac video server largescal videoon demand system 9 3 parallel video server becom inevit provid larg capac requir system servic thousand concurr client two major type parallel video server share memori multiprocessor distribut memori cluster architectur figur 1 show diagram sharedmemori architectur architectur set storag node set comput node connect share memori video data sent memori buffer highspe network bu client mass storag system present capac support hundr request 13 howev yet clear multiprocessor video server scalabl cluster architectur easi scale thousand server node system set storag node set deliveri node connect interconnect network data retriev storag node sent deliveri node send data client figur 2 show diagram cluster architectur number work describ cluster system 18 14 15 cluster architectur extend directaccess architectur provid interfac storag system network 4 7 figur 3 show diagram directaccess architectur elimin deliveri node cluster architectur storag node send video data direct high speed wan network interfac video file store singl storag node architectur guarante order data arriv differ storag node problem solv project mar use chain connect atmbas interconnect within server connect storag devic atmbas broadband network 4 storag node storag node storag node storag node memori bank processor high speed wan network interfac figur 1 sharedmemori architectur video server storag node storag node storag node storag node node deliveri node deliveri node deliveri node deliveri high speed wan interconnect network figur 2 cluster architectur video server optim schedul parallel cbr video server 3 storag node storag node storag node storag node high speed wan network interfac interconnect network figur 3 directaccess architectur video server paper evalu schedul strategi cluster architectur shown figur 2 interconnect network connect storag node deliveri node storag node respons store video data storag medium disk storag node deal disk schedul problem separ provid specifi bandwidth deliveri node respons client request receiv request client deliveri node schedul time interv deliv appropri data block within time deadlin client playout video deliveri node output buffer interfac highspe wan wan congest output buffer becom full feedback signal sent correspond storag node stop send video block logic storag deliveri node map differ physic node cluster configur call twotier architectur 18 also node storag node deliveri node call flat architectur paper flat architectur assum schedul polici critic perform video server current mani schedul algorithm parallel video server particular cluster video server without good schedul algorithm video stream may conflict result delay reject larger buffer size may requir toler delay good schedul algorithm guarante qualityofservic effici util resourc reduc buffer size increas system throughput paper organ follow section 2 briefli describ underli model parallel cbr video server conflictfre schedul algorithm delay minim present section 3 4 section 5 request reloc algorithm present admiss control discuss section 6 perform comparison present section 7 section 8 give relat work section 9 discuss futur work 2 system architectur background section model schedul problem video server first assum wide stripe video data stripe across node roundrobin fashion differ video file start differ node balanc load exampl first file start node 0 second file start node 1 etc result obtain extend short stripe distribut video block subset node depend select block size base stream rate r time divid time cycl length cycl sr time access n block one storag node call time period thu time period includ n time cycl gener data transfer rate singl disk disk array much higher base stream rate r therefor time cycl multipl video stream servic storag node individu stream rate still preserv time cycl thu divid time slot length slot equal longer time requir retriev block storag node transmit deliveri node whichev larger valu determin experi similar qualityofservic qo problem two type guarante determinist guarante statist guarante determinist guarante determin use worst case number approach describ 15 approach guarante qo request system may underutil statist guarante determin use averag number period time increas system util data may miss deadlin buffer space necessari smooth delay jitter number slot cycl determin adjust f similar model use tiger system 7 experi result show model work well real system assum video server consist n storag node n deliveri node interconnect highspe network individu request r handl deliveri node node respons deliv data block retriev storag node client via network entir lifetim request r unless request reloc requir block video file consecut distribut n storag node request r time cycl retriev data block storag node retriev data block node sr video block schedul illustr simpl exampl figur 4 show schedul 3 balanc load video stream start differ storag node entri figur show request optim schedul parallel cbr video server 5 slot node 0 node 3 node 2 node 1r 0 r 43 r r 90 time cycl 0 r 01 r r 91 time cycl 1 r r r 92 time cycl 2 r r 42 r 81 r 93 time cycl 3 deliveri node request r k storag node j figur 4 complet video schedul time period number r k deliveri node number storag node number j request retriev block storag node j deliveri node video stream access pattern list horizont row block singl stream separ time slot exampl request r 0 schedul time slot 0 first row request deliveri node 0 retriev block storag node 1 time cycl 0 retriev block storag node 2 3 0 next three cycl schedul tabl wrap around n theta request schedul time slot one request need retriev block storag node compet resourc order avoid conflict request access differ storag node schedul onto time slot thu everi time slot n request schedul retriev block differ storag node first cycl conflictfre schedul follow cycl conflict therefor discuss schedul problem show first time cycl long access pattern video stream chang model extend schedul interact oper fast forward rewind access pattern interact oper irregular set schedul algorithm design retain access order storag node 20 defin conflictfre schedul follow 6 minyou wu wei shu definit 1 conflictfre schedul conflictfre schedul schedul time slot two video stream request block storag node 2 conflictfre schedul impli two constraint first one impos disk retriev bandwidth storag node measur total number request retriev block storag node j time cycl one request access storag node time slot request access storag node time cycl second one limit io bandwidth deliveri node within time slot deliveri node handl one stream differ storag node total number request handl deliveri node bound request may access arbitrari storag node necessarili distinct two constraint summar follow lemma lemma 1 necessari condit conflictfre schedul time cycl question whether necessari condit also suffici condit word given set request satisfi necessari condit exist conflictfre schedul next section prove lemma 1 also suffici condit conflictfre schedul give algorithm find conflictfre schedul 3 conflictfre schedul video stream go gener conflictfre schedul given set request v greedi algorithm propos 15 schedul request arriv order whenev request arriv next avail slot conflict exist one assign request exampl illustr algorithm exampl 1 assum set request arriv order shown figur 5a greedi algorithm schedul request shown figur 5b request r 1 schedul slot 0 schedul slot 1 r 3 request r 4 r 7 must schedul slot 2 request r 8 abl schedul thu nine request schedul 2 greedi algorithm schedul request even lemma 1 satisfi rearrang alloc exist request request accommod let revisit exampl 1 figur 5c request r 8 arriv schedul empti slot slot 1 due conflict r 3 howev exchang r 3 r 7 r 8 schedul slot 1 shown figur 6a r 9 schedul slot 2 shown figur 6b optim schedul parallel cbr video server 7 node 0 node 3 node 2 node 1 r r r 11 slot node 0 node 3 node 2 r 01 r 11 r r 42 r 53 r 62 r 73 r 9 slot r r r3 11 node 0 node 3 node 2 r 01 r 11 r r 42 r 53 r 62 r 7 slot r r r r3 118 100 b c r r deliveri node request r storag node j figur 5 exampl greedi schedul algorithm request r 10 arriv schedul slot 2 sinc conflict r 9 tabl rearrang move r 2 slot 0 slot 2 r 3 slot 2 slot schedul slot 0 shown figur 6c final r 11 schedul slot 2 shown figur 6d exampl show better schedul achiev rearrang request need systemat approach schedul request without conflict present optim algorithm conflictfre schedul problem algorithm convert schedul problem match problem bipartit graph perfect match algorithm appli solv problem algorithm 1 conflictfre schedul construct bipartit graph g bipartit x join j deliveri node handl request retriev block storag node j deliveri node handl request request retriev block storag node j construct graph mregular bipartit graph first time slot whether exist set request access differ storag node differ deliveri node equival find perfect match g accord marriag theorem 12 g kregular bipartit graph k 0 g perfect match determin perfect match time slot 0 elimin match edg origin problem schedul nm request time slot reduc problem schedul n gamma 1 request gamma slot thu appli perfect match algorithm time schedul time slot gener 2 perfect match algorithm call hungarian method found 2 give brief descript algorithm start arbitrari match perfect match yet munsatur node u chosen search maugment path origin u construct larger match procedur repeat perfect match found exampl conflictfre algorithm shown figur 7 use set request figur 5 three iter result schedul shown figur 7d equival figur 6d algorithm also use situat less nm request exist v request insert algorithm easi see lemma 1 also suffici condit conflictfre schedul algorithm call request arriv conflictfre slot multipl request arriv simultan request schedul empti slot one one conflict occur algorithm call schedul request instead singl request optim schedul parallel cbr video server 9 node 0 node 3 node 2 r 01 r 42 r 53 r 62 r 71 r r 8 slot r r r3 11 node 0 node 3 node 2 r 01 r 42 r 53 r 62 r 71 r r r 9 node 0 node 3 node 2 r 00 r 42 r 53 r 62 r 71 r 81 r 21 r 33 r 9 r 11 node 0 node 3 node 2 r 00 r 42 r 53 r 62 r 71 r 81 r 21 r 33 r 9 r33r 11 b slot r r3 11c slot figur 6 improv exampl 1 node 0 node 3 node 2 r 43 r 91 r r 00 r 12 r r 22 r 73 r 6 r33r 11 slot deliveri node storag node deliveri node storag node deliveri node storag node slot 0 b slot 1 c slot 2 optim schedul figur 7 bipartit graph request set exampl 1 optim schedul parallel cbr video server 11 4 request delay minim consid situat total number request less equal nm w exist j v case request fulfil storag node j v must delay node j call peg hand storag node j v leav space node j call hole peg request fulfil delay hole larg system delay signific problem minim delay peg request problem solv simpl pegandhol algorithm present follow algorithm 2 pegandhol let rj hold kth request node v p extra request remov request x node p v h found hole node h algorithm request r repres fsr stand number cycl delay request r initi zero entri twodimens array rj indic kth request storag node j variabl p h indic point peg hole storag node respect basic request fulfil current time cycl delay nearest unpack time slot algorithm guarante minimum delay exampl 2 set request given shown figur 8a v 2 thu storag node 1 2 peg storag node 0 3 hole request r 6 r 11 delay two time cycl request r 8 delay one time cycl given figur 8b result schedul shown figur 8c 2 r 01 r 11 r 22 r r 42 r 5r 63r 71 r r 9 r103r 11 a1 r 8r 62r 21 r r 9 r103r r 52 r 72 r 111 r 4 slot start request b1 r 33 r 52 r r 93 r 70 r 42 r 00 r 73 r 21 r 92 r r 00 r 11 r 43 r r 90 r 21 r 70r 01 r103r r 43 r 92 r 7 node 0 node 3 node 2 node 1 time cycl 0 deliveri node request r storag node j figur 8 exampl request delay optim schedul parallel cbr video server 13 5 request reloc section consid situat load unbalanc definit load balanc differ tradit definit video stream schedul realtim problem system long everi w consid balanc load otherwis request need reloc assum total number request less equal nm case total number request nm nm request fulfil mani exist load reloc algorithm appli problem object move request overload node underload node minim cost rip 17 runtim increment parallel schedul algorithm design balanc independ task largescal parallel machin algorithm modifi parallel video server everi node present handl request send excess load nearest underload node figur 9 present modifi algorithm assumpt node arrang linear chain algorithm topolog develop similarli first step obtain accumul number request use scan sum oper node n gamma 1 node 0 node record partial sum second step node calcul accumul quota algorithm seen anoth pegandhol algorithm peg overload node hole underload node respect quota correspond flow also calcul posit flow mean flow node gamma 1 node neg flow mean flow node node gamma 1 third step proxim calcul distanc nearest hole node assum everi hole unlimit capac minim flow f igamma1i result deliveri everi extra work nearest hole case tie leftnearest hole henc flow across hole node therefor node result minim flow f igamma1i determin node leftnearest hole rightnearest hole bound indic b l b r f igamma1i summat possibl flow lefthand node node b r nearest hole righthand node node b l nearest hole fourth step two flow igamma1i f igamma1i avail construct optim flow x igamma1i close f igamma1i much possibl overload hole node case flow igamma1i optim one otherwis auxiliari variabl g use record mani stream adjust initi g 0 maximum number stream allow adjust g becom zero rest optim flow f must accord valu x workload exchang node request number commun step algorithm 5n step 1 take n step calcul step 3 take 2n step one calcul p one f step 4 take 2n step one calcul x one load exchang algorithm minim number commun commun distanc also maxim local 14 minyou wu wei shu algorithm 3 request reloc let w number video stream node 1 global reduct perform scan sum oper w 2 quota calcul accumul quota correspond flow node comput 3 proxim calcul node proxim leftrightnearest hole defin p l follow l node segment leftnearest hole rightnearest hole bound indic b l b r l assum everi hole unlimit capac minim flow f igamma1i result deliv everi extra work nearest hole case tie leftnearest hole l 4 load exchang receiv x igamma1i task node gamma 1 receiv jx ii1 j task node 1 task node gamma 1 task node 1 figur 9 request reloc algorithm chain optim schedul parallel cbr video server 15 exampl 3 tabl 1 figur 10 show exampl loadbalanc algo rithm calcul step 1 2 step 3 p l calcul compar valu overload node determin intent send extra load valu f exampl node 3 intend send request node 2 f gamma1 similarli node 4 intend send request node 5 f 45 1 p l node intend send extra load left step 4 valu x calcul accord valu g sinc valu x must rang gamma g final flow could differ valu f exampl node 4 intend send request node 5 accord valu f final send request node 3 otherwis node 5 6 7 would overload 2 tabl 1 exampl request reloc 29 26 22 22 17 12 11 3 28 igamma1i l l x igamma1i figur 10 exampl request reloc complex algorithm list conflictfre schedul omn log n request delay omn request reloc 6 admiss control conflictfre schedul algorithm request delay algorithm loadbalanc algorithm readi defin admiss control polici new request new request admit schedul without conflict could schedul time slot immedi upon arriv deliveri node conflictfre time slot avail otherwis new request must delay video stream need reschedul accommod new request admiss reject request request reloc delay conflictfre schedul tnm empti slot new request find figur 11 admiss control algorithm admiss control algorithm shown figur 11 let 0 current total number video stream servic one request arriv condit nm check r number newli arriv request condit hold request admit otherwis r request admit other must reject admit request test whether deliveri node overload request reloc next step check whether storag node overload request delay final check whether nonconflict time slot new request conflictfre schedul algorithm appli rearrang video stream admiss control algorithm deal singl request multipl request separ follow step appli multipl request arriv system simultan ffl deliveri node w request reloc algorithm appli ffl storag node j v request delay algorithm appli optim schedul parallel cbr video server 17 ffl request find empti conflictfre slot conflictfre schedul algorithm appli situat singl request arriv system simpl polici appli describ follow ffl assum new request r k arriv w leftnearest right nearest underload node node search new request transfer nearest underload node request delay nearest hole ffl conflictfre time slot new request schedul time slot otherwis conflictfre schedul algorithm appli polici schedul multipl request togeth reduc schedul overhead sometim lead better schedul 7 simul perform conduct simul studi variou schedul algorithm includ greedi algorithm conflict free schedul cf cf delay cfsd cf delay reloc cfsdr simul configur five paramet total number storagedeliveri node n number slot per time cycl load measur l base avail capac averag file size z specifi term number slot requir retriev entir file durat simul term number time cycl follow simul averag file size 200 time slot simul durat cycl arriv rate r calcul follow equat z step probabl exactli r new request given ae calcul r x simul proce step step time cycl follow step number new request calcul accord probabl ae b new request randomli gener deliveri node start storag node first block file store size file term number slot c admiss control polici appli determin request admit reject admit schedul algorithm use schedul request singl new request gener step algorithm singl request employ one new request gener algorithm multipl request employ end simul statist obtain includ total number request gener number reject request number delay request number reloc request etc differ version cf algorithm first studi test differ arriv rate tabl 2 show perform algorithm cf cfsd cfsdr differ load instanc list tabl 1 percentag delay request 2 averag delay per delay request term time cycl 3 percentag reloc request 4 averag distanc per reloc request term hop 5 reject rate ratio number reject request total number request item 2 4 give detail inform delay request reloc request respect shown system lightli load delay around one time cycl load increas averag delay may increas time cycl number delay request averag delay cfsdr algorithm substanti larger cfsd algorithm cfsdr admit much request reject cfsd request must reloc delay also number reloc request averag distanc cfsdr algorithm increas load heavilyload system 90 cf cfsd exhibit high reject rate wherea cfsdr reduc reject rate significantli penalti paid low reject rate larg number reloc delay enforc incom request due highli satur system next compar perform greedi algorithm differ version cf algorithm figur 12 show perform differ valu number time slot time cycl increas reject rate four algorithm decreas partial reason phenomenon deliveri node handl request differ number request arriv becom smaller figur 13 show perform differ number node n substanti chang reject rate n vari greedi cf cfsd algorithm cfsdr reject rate decreas n increas sinc could chanc reloc newli arriv request final figur 14 show perform differ load obvious reject rate four algorithm becom high load increas cfsdr reject rate remain around 0 load becom 80 load 80 reject rate 064 gener reject rate less 1 consid accept optim schedul parallel cbr video server 19 tabl 2 perform varianc differ load m10 n16 load algorithm delay avg delay reloc avg distanc reject request per delay request per reloc rate request request 30 cfsd 08 100 012 cfsdr 08 100 12 100 000 40 cfsd 70 100 072 cfsdr 70 100 72 100 000 50 cfsd 225 107 212 cfsdr 254 109 232 100 000 cfsdr 649 128 549 104 000 70 cfsd 765 124 843 cfsdr 131 158 118 111 005 80 cfsd 117 136 1332 cfsdr 314 236 317 149 064 90 cfsd 141 144 1597 cfsdr 424 289 421 175 257 100 cfsd 170 155 2127 cfsdr 533 369 526 219 825 0 5 10 15 20 30 40 reject rate greedi cf cfsd cfsdr figur 12 reject rate number time slot vari 0 5 10 15 20 30 reject rate greedi cf cfsd cfsdr figur 13 reject rate number storag node vari optim schedul parallel cbr video server 21 30 40 50 60 70 80 90 100 load 0 5 10 15 20 30 reject rate greedi cf cfsd cfsdr figur 14 reject rate load increas 22 minyou wu wei shu 8 relat work past year sever research project investig techniqu design video server relat issu includ disk layout schedul strategi admiss control strategi realtim support etc 5 10 16 19 6 research work assum singl disk storag system sever research project investig design techniqu parallel video server 15 4 13 18 14 7 11 video data strip scheme studi 15 1 5 10 7 11 howev video stream schedul problem formal address mani system reli statist multiplex truli guarante qualiti servic system resourc fulli util without sophist schedul strategi arrang video stream properli larg buffer space requir particular prefetch techniqu request huge memori space 8 greedi schedul cluster architectur propos reddi 15 approach aim precis schedul video stream maxim system throughput minim usag buffer mitra scalabl media server cluster multidisk workstat connect use atm switch 11 data partit mani block distribut across disk piec block term fragment time period fix media type time period schedul issu read request block disk disk transfer fragment client schedul appli transfer fragment tiger directaccess architectur use wide stripe strategi balanc load similar delay strategi describ paper assum file bit rate 7 howev tiger conflictfre schedul algorithm avoid unnecessari delay instead schedul current time slot newli arriv request delay next avail slot larg system delay signific system load reach 50 80 delay increas drastic algorithm appli directaccess architectur equal well use conflictfre schedul algorithm request exceed disk capac delay experiment result show request delay averag delay less three time cycl reject rate less 3 system load 90 9 conclus futur work paper address schedul problem parallel cbr video server number algorithm includ conflictfre schedul request delay minimiza tion request reloc admiss control present combin algorithm abl achiev optim schedul distribut memori cluster architectur current schedul techniqu base statist multiplex guarante time video signal deliveri system abl reach maximum capac statist multiplex method precis schedul video stream qualiti servic requir method maxim video server capac optim schedul parallel cbr video server 23 minim delay time minim buffer size requir reduc effect unpredict network delay scheme describ paper extend support interact oper fast forward rewind 20 discuss network conflict problem paper network traffic schedul import issu address topolog omega network hypercub network set request schedul without conflict time cycl conflict cycl howev network topolog might necessari schedul individu time cycl paper address schedul problem cbr video appli cation client may request retriev variabl bit rate encod media stream schedul type request much difficult address futur work acknowledg author would like thank xin help discuss karthikeyan samuthiram simul work research partial support nsf grant ccr9505300 ccr9625784 r stagger stripe multimedia inform system graph theori applic hierarch storag manag distribut vod system scalabl video data placement parallel disk array storag subsystem larg multimedia server highspe network environ tiger video fileserv spiffi scalabl videoondemand server multimedia storag server tutori continu retriev multimedia data use paral lelism scalabl continu media server repres subset perform mass storag system videoondemand techniqu schedul io high perform multimediaondemand server schedul data distribut multiprocessor video server runtim increment parallel schedul rip distribut memori comput design perform tradeoff cluster multimedia server admiss control algorithm multimedia ondemand server schedul interact oper parallel video server tr ctr minyou wu sujun wei shu schedul video deliveri scalabl ondemand servic proceed 12th intern workshop network oper system support digit audio video may 1214 2002 miami florida usa harald kosch ahm mostefaoui lszl bszrmnyi lionel bruni heurist optim multiclip queri video databas multimedia tool applic v22 n3 p235262 march 2004 chows lin yichi cheng p2mcmd scalabl approach vod servic peertop network journal parallel distribut comput v67 n8 p903921 august 2007 minyou wu wei shu chows lin odyssey highperform cluster video server softwarepractic experi v33 n7 p673700 june