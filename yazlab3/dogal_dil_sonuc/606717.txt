spars approxim invers smoother geometr algebra multigrid spars approxim invers consid smoother geometr algebra multigrid method base spaialgorithm mj grote huckl siam j sci comput construct spars approxim invers matrix minim frobeniu norm lead new hierarchi inher parallel smoother spai0 spai1 spai geometr multigrid perform spai1 usual compar gaussseidel smooth difficult situat neither gaussseidel simpler spai0 spai1 smoother adequ reduct automat improv spai smoother need combin algebra coarsen strategi jw ruge k stben sf mccormick ed multigrid method siam 1987 pp 73130 result method yield robust parallel algebra multigrid iter easili adjust even nonexpert numer exampl demonstr use spai smoother sequenti parallel environmentessenti advantag spaismooth improv robust inher parallel order independ possibl local adapt b introduct multigrid method reli subtl interplay smooth coars grid correct care combin yield ecient multigrid solver larg linear system result discret partial dierenti equat 7141527 standard smoother multigrid usual consist step basic iter method shall consid smoother base spars approxim invers henc start linear system let denot spars approxim 1 correspond basic iter method sinc approxim invers known explicitli iter step requir one addit v matrixvector multipli therefor easi parallel cheap evalu spars recent variou algorithm propos attempt comput directli spars approxim invers 5917 compar studi variou approxim invers precondition refer benzi tuma 6 approxim invers techniqu also gain import smoother multigrid method first introduc benson frederickson 34 shown eectiv variou dicult ellipt problem unstructur grid tang wan 25 advantag spars approxim invers smoother classic smoother damp jacobi gaussseidel ilu inher parallel possibl local adapt improv robust shall consid spars approxim invers spai smoother base spaialgorithm grote huckl 13 spaialgorithm comput approxim invers explicitli minim frobeniu norm comput applic smoother inher parallel sinc eectiv sparsiti pattern gener unknown priori spaialgorithm attempt determin promis entri dynam strategi prove eectiv gener precondition mani dicult illcondit problem 11324 moreov provid mean adjust smoother local automat necessari nevertheless choos priori sparsiti pattern comput cost greatli reduc possibl choic includ power suggest huckl 16 chow 10 henc shall investig follow hierarchi spars approxim invers smoother spai0 spai1 spai spai0 spai1 sparsiti pattern xed diagon spai0 wherea spai1 sparsiti pattern spai sparsiti pattern determin automat spaialgorithm 13 paramet control accuraci amount llin structur geometr grid dicult use complex geometri applic code design often turn larg unstructur grid yet lack natur grid hierarchi prevent use standard geometr multi grid context algebra multigrid amg often seen promis method solv largescal problem origin amg algo rithm rst introduc 1980 ruge stuben 22 use simpl gaussseidel iter smoother determin coars grid space sophist way improv robust method iter fail converg automat way improv smoother altern investig use smoother base spars approxim invers spai inher parallel perform also easili adjust even nonexpert thu aim gener inher parallel algebra multigrid method section 2 brie review spaialgorithm show spars approxim invers use smoother within multigrid iter heurist green function interpret underpin eectiv smoo ther rigor result smooth properti approxim invers prove 8 summar section 24 next present section 3 detail descript algebra coarsen strategi use 22 togeth key compon algorithm ecient implement final section 4 compar perform spai smooth gaussseidel smooth variou test problem either within geometr algebra multigrid set smooth 21 classic smoother consid sequenc nest grid nest mesh wish solv n n linear system multigrid method detail multigrid see hackbusch 14 15 section 10 wessel 27 multigrid iter result recurs applic twogrid method twogrid method consist 1 presmooth step level coars grid correct level 1 2 postsmooth step level lead iter error e r prolong restrict oper respect 1 denot smoother nest nite element space galerkin discret use galerkin product represent hold otherwis one still use 4 dene coarsegrid problem given r p shall alway use x 0 initi guess multigrid vcycl iter proce rel residu drop prescrib toler kb x kbk tol 5 calcul averag rate converg 1m expect multigrid converg behavior achiev number multigrid iter necessari achiev xed toler essenti independ number grid level typic smoother form w approxim cheap invert cours w 1 never comput explicitli let diagon l lower triangular part u upper triangular part damp jacobi smooth correspond wherea gaussseidel smooth correspond 8 paramet chosen maxim reduct high frequenc compon error optim valu problem depend usual unknown priori although gaussseidel typic lead faster converg dicult implement parallel smooth step 9 requir solut lower triangular system neither jacobi gaussseidel smooth lead satisfactori converg one either resort sophist matrix depend prolong restrict oper 29 robust smoother base incomplet lu ilu factor 28 unfortun ilusmooth inher sequenti therefor dicult implement parallel also dicult improv local say near boundari singular without aect llin everywher lu factor 22 spaismooth altern invert w 7 propos comput explicitli spars approxim invers use smooth drop grid index simplifi notat yield spaismooth comput minim ki mak frobeniu norm given sparsiti pattern contrast w 1 7 matrix 10 comput explicitli therefor applic spai requir matrixvector multipl easi parallel requir solut upper lower triangular system moreov frobeniu norm natur lead inher parallel row comput independ one anoth inde sinc solut 11 separ n independ leastsquar problem e k denot kth unit vector spars leastsquar problem small sinc eectiv sparsiti pattern unknown priori origin spai algorithm 13 begin diagon pattern augment progress sparsiti pattern reduc residu r addit reduct 2norm r k involv two step first algorithm identi set potenti new candid base sparsiti current spars residu r k second algorithm select protabl entri usual less entri comput candid cheap upper bound reduct kr k k 2 new entri select ad k small leastsquar problem 12 solv augment set indic algorithm proce row satis toler set user control llin qualiti precondition larger valu lead sparser less expens approxim invers also less eectiv smoother higher number multigrid cycl lower valu usual reduc number cycl cost comput may becom prohibit moreov denser result higher cost per smooth step optim valu minim total time depend problem discret desir accuraci comput architectur detail origin spaialgorithm found 13 addit spai shall also consid follow two greatli sim pli spaismooth xed sparsiti pattern spai0 di agon spai1 sparsiti pattern solv leastsquar problem 12 thu minim ki mak frobeniu norm sparsiti pattern chosen priori elimin search eectiv sparsiti pattern thu greatli reduc cost comput approxim invers spai1 smoother coincid smoother tang wan 25 diagon calcul directli simpli given kk k kth row note alway wellden nonsingular contrast damp jacobi spai0 parameterfre summar shall consid follow hierarchi spaismooth minim ki mak frobeniu norm certain sparsiti pattern diagon given 14 spai1 sparsiti pattern spai sparsiti pattern determin automat via spai algorithm 13 row satis 13 given approxim invers lead smooth step found mani situat spai0 spai1 yield ampl smooth howev ad exibl provid automat criterion improv smoother via spaialgorithm remain use inde spai0 spai1 use initi guess spai thu local improv upon need reduc matric inher small block structur typic discret system partial dierenti equat blockspaialgorithm 2 greatli reduc cost comput 23 green function interpret approxim invers yield eectiv smoother problem come partial dierenti equat mesh paramet h tend zero solut linear system h u tend solut underli dierenti equat appropri boundari condit matrix h correspond discret version dierenti oper l let h k denot kth row solv linear system e h k kth unit vector h 0 h k tend green function l denot adjoint dierenti oper x x k delta center x k exhibit correspond h k recal l formal dene ident u v appropri function space equat 20 continu counterpart relat 17 19 20 conclud similarli combin 16 18 21 lead discret counterpart 22 comparison 22 23 show h k correspond gx x k kth row h approxim invers h solv 12 equiva lentli min henc h k approxim kth column h k 18 discret 2norm xed sparsiti pattern h k nonzero entri usual lie neighborhood x k correspond mesh point x j close x k therefor appropri scale invers power h see h approxim gx x k local continu l 1268 3 partial dierenti oper gx x k typic singular x k decay smoothli necessarili rapidli increas distanc jx x k j clearli slower decay denser h must approxim well 1 decienc spars approxim invers precondition also point tang 24 time howev suggest spars approxim invers obtain minim ki mak frobeniu norm natur yield smoother multigrid inde eectiv precondition must approxim uniformli entir spectrum l contrast eectiv smoother need captur highfrequ behavior yet highfrequ behavior correspond singular local behavior gx x k precis approxim h k illustr fact consid standard vepoint stencil discret laplacian 15 15 grid figur 1 follow page compar 1 gaussseidel approxim invers l two explicit approxim invers spai1 spai02 recal gaussseidel poor precondition problem remain excel smoother captur highfrequ behavior 1 similarli spai1 spai yield local oper shall see good smooth properti despit resembl gaussseidel spai approxim invers note onesided former contrast symmetri latter gaussseidel spai 02 fig 1 row 112 follow oper 1 top left gaussseidel invers comput spai1 bottom left comput spai02 bottom right 24 theoret properti contrast heurist interpret previou section shall summar rigor result 8 smooth properti simplest smoother spai0 multigrid converg theori rest two fundament condit smooth properti 15 denit 1063 function lim approxim properti 15 section 1063 gener smooth approxim properti togeth impli converg twogrid method multigrid wcycl contract number independ level number moreov symmetr posit denit prob lem condit also impli multigrid vcycl converg independ see hackbusch 15 sect 106 detail approxim properti independ smoother depend discret prolong oper p restrict oper r 15 approxim properti shown hold larg class discret ellipt boundari valu problem symmetr posit denit problem smooth properti usual hold classic smoother damp jacobi symmetr gaussseidel incomplet choleski 8 smooth properti 25 shown hold spai0 smoother reason assumpt matrix precis symmetr posit denit spai0 smoother satis smooth properti either weakli diagon domin seven nonzero odiagon entri per row furthermor two diagon smoother spai0 damp jacobi optim relax paramet lead ident smoother discret laplacian period boundari condit space dimens 8 special situat parameterfre spai0 smoother automat yield scale diaga minim smooth factor sens optim gener situat howev smoother dier boundari condit even constant coecient equispac mesh comparison two diagon smoother via numer experi show spai0 attract altern damp jacobi 8 inde spai0 parameterfre typic lead slightli better converg rate damp jacobi 3 algebra multigrid multigrid mg method sensit subtl interplay smooth coarsegrid correct standard geometr multigrid method appli dicult problem say strong anisotropi interplay disturb error longer smooth equal well direc tion although manual intervent select coars grid sometim overcom diculti remain cumbersom appli practic unstructur grid complex geometri contrast algebra multigrid approach compens decient smooth sophist choic coarser grid interpol oper base matrix mani amg variant exist dier coarsen strategi interpol use introduct variou amg method found 26 follow ruge stuben 22 describ algebra coarsen strategi interpol oper shall combin spai smoother section 22 use numer experi 31 coarsen strategy1020301020300206 x anisotrop stencilh 26 6 6 6 6 4 fig 2 error gaussseidel smooth step problem describ section 42 001 smooth error compon align anisotropi read stencil fundament principl underli coarsen strategi base observ interpol perform along smooth error compon symmetr mmatric error smooth well along larg neg odiagon entri matrix 23 therefor grid point p may identifi among neighbor point q good candid interpol compar magnitud correspond entri pq lead follow relat point p neighbor q connect graph matrix condit notat interpret pq max apr 0 ja pr j p q p strongli depend q pq 6 0 q strongli uenc p pq weakli depend q pq 6 0 q weakli uenc p paramet control threshold discrimin strong weak connect typic 025 denit posit odiagon entri necessarili weak relat p q p q symmetr symmetr next dene set depend point p set uenc point p set weak depend point p everi level coarsen strategi must divid p set point level two disjoint set c coars point also present coarser level f ne point absent coarser level choic c f induc cfsplit coars grid correct heavili depend accur interpol accur interpol guarante everi f point surround sucient mani strongli depend c point typic congur shown figur 3 q3 strong depend depend c point f point strong depend indic solid arrow weak depend repres dash arrow c point repres solid circl wherea f point repres dash circl henc strong depend point c point therefor q 2 q 4 good candid interpol p fig 3 ideal coarsen congur interpol coarsen algorithm attempt determin cfsplit maxim f toc depend f point coarsen goal 1 minim set c coarsen goal 2 import strike good balanc two con ict goal overal comput eort depend converg rate also amount work per multigrid cycl clearli optim cf split minim total execut time howev sinc converg rate gener unpredict coarsen algorithm mere attempt meet coarsen goal 1 2 heurist fashion complex must exceed log n retain overal complex multigrid iter 32 coars grid select greedi heurist split p c f everi step greedi heurist move promis candid p c forc neighbor point f procedur repeat point distribut everi step requir olog n oper complex comput exceed log n desir overal complex log n reach greedi heurist describ 23 base follow two principl correspond coarsen goal 1 2 1 promis candid p becom c point highest number uenc ji p j uenc p ad f choic support coarsen goal 1 f point eventu least one strong c depend 2 keep number c point low coarsen goal 2 algorithm prefer c point near recent chosen f point henc u enc given higher prioriti start point undecid point algorithm proce select u promis c point highest prioriti prioriti point p dene equat ect prefer choos next c point point uenc mani previous select f point key advantag 26 possibl updat prioriti local o1 time result desir overal complex log n summar coars grid select algorithm algorithm 1 coars grid select procedur set priorityp ji p j end u u 1 select p 2 u maxim p riorityp q 2 p depend p end q 2 p uenc p r 2 q depend q end end procedur implement step 1 2 3 ecient o1 time maintain list q point sort prioriti togeth list point indic q moreov list boundari b prioriti occur q enabl immedi updat sort list q figur 4 show possibl segment list q b 5 611 15index q posit q priorityp posit q3141312 index b fig 4 three list q b enabl ecient implement coarsen algorithm setup phase coarsen algorithm b comput sort prioriti step 1 simpli choos last element q step 2 3 implement exchang point whose prioriti must either increment decrement left rightmost neighbor q prioriti prioriti adjust q remain sort b updat accordingli follow suggest k stuben shall skip second pass origin coarsen algorithm 22 enforc even stronger f toc depend high comput cost involv 33 interpol grid function u h dene ner grid interpol grid function uh dene coarser grid c follow henc valu c point simpli transfer coarser level wherea valu f point interpol c neighbor four dierent depend possibl f point neighbor shown figur 5 standard interpol see 23 choic weight w pq interpol p base equat pp e pq e inde ae 0 smooth eect minim error e declar algebra smooth see 23 detail clearli interpol p surround f point wherea weakli depend c point includ either rough natur error direct thu connect q 1 q 2 figur 5 alway ignor interpol correspond interpol weight set zero w pq 1 cancel weak depend neglect entri weakli depend neighbor ad diagon henc equat 28 becom pp e pq e strong c depend q 3 figur 5 caus diculti valu uh avail coars grid locat divis 29 pp yield weight pq pp howev strong f depend q 4 figur 5 avail interpol must rst interpol c point strongli depend replac qq qq everi q 2 q f everi point r 2 q yield weight pq pp qr qq point q direct indirect neighbor p 30 32 appli two weight calcul separ ad q4 strong depend depend c point f point q3 indirect interpol direct interpol ignor ignor fig 5 four dierent depend possibl p neighbor algorithm describ determin coars grid level basi approxim invers fact inform contain use determin coars grid level interpol weight suggest meurant 1920 34 measur comput cost memori requir compar perform variou smoother limit compar number multigrid iter also need estim addit amount work due smoother calcul total densiti ratio nonzero entri grid level 1 smooth appli addit amount work due smoother proport rapidli reduc number point one level next matric must also remain reason spars measur instanc galerkin coars grid approxim enlarg standard point stencil nest grid ninepoint stencil subsequ level result valu geometr multigrid 16 semicoarsen togeth onedimension interpol use increas two result present follow section comput matlab implement shall evalu ecienc variou approach compar respect valu 4 numer result illustr use versatil spai smooth shall consid variou standard test problem case dierenti equat consid discret nest level standard nite dierenc equispac mesh geometr multigrid use regularli rene sequenc equispac grid singl unknown remain center domain algebra multigrid coarser level obtain coars grid select algorithm describ section 32 denit strong depend section 31 algorithm proce number grid point drop twenti coars grid oper obtain via galerkin product formula 4 geometr multigrid p correspond standard linear interpol wherea amg p obtain describ section 33 use multigrid vcycl iter two pre two postsmooth step 2 multigrid iter proce rel residu satis prescrib toler 5 41 rotat ow problem rst consid convectiondius problem 0 10 1 ux boundari u repres scalar quantiti advect rotat ow eld convect domin h linear system ceas symmetr posit denit problem lie outsid classic multigrid theori use center secondord nite dierenc diusion discret convect rstorder upwind ensur numer stabil tabl geometr mg converg rate rotat ow problem 128128 grid dierent valu symbol indic multigrid iter diverg smoother gaussseidel spai0 spai1 spai03 spai02 tabl converg rate q obtain standard mg smoother yield accept converg rate diusion domin case howev multigrid iter diverg gaussseidel spai0 smooth contrast spai1 smoother still yield converg method use spai03 smooth acceler converg even increas 14 reduc diusion even spai02 smoother yield converg iter although result valu quit high construct spai02 remain parallel fulli auto matic remark symmetr gaussseidel smooth 27 lead converg multigrid iter yet approach gener easili unstructur grid parallel result sinc spai1 smoother inher parallel straightforward appli within parallel version geometr mg data distribut among processor via domain decomposit wellknown work ecient number multigrid applic 18 platform shall use ethbeowulf cluster consist 192 dual cpu pentium iii 500 processor node connect via 100 mbit 1 gb switch network commun done mpi appli parallel multigrid implement rotat flow problem 35 128 node total executiontim 156 second 40964096 grid time includ setup construct spai1 smoother requir solut sixteen million small 259 independ leastsquar problem shown tabl 1 use coarsest level consist singl mesh point lead diverg multigrid iter increas resolut coarsest level 3232 mesh point one obtain converg multigrid iter tabl scalabl parallel mg use spai1 problem size number processor increas factor 4 total time increas 30 gridsiz 512512 4 10231023 number processor total time sec 20 26 obtain good speedup parallel mg code import perform coars grid agglomer see 21 loss ecienc coarser grid level although implement agglomer strategi comput scale reason well long problem size match size parallel architectur see tabl 2 rotat ow problem algebra coarsen clearli align ow direct larger dot correspond c point coarser level b local anisotrop diusion semicoarsen appar center domain fig 6 exampl algebra coarsen two model problem consid amg result none approach howev entir satisfactori vanish vi cositi overcom lack robust small appli algebra coarsen strategi describ section 3 figur 6a display coars level select algorithm tabl 3 spai0 spai1 yield converg without particular tune 05 spai tabl amg converg result rotat ow problem vari 128128 grid 28 34 42 smoother q q q gaussseidel 014 038 081 tabl amg converg rate rotat ow problem smoother gaussseidel spai0 spai1 spai05 gridsiz q q q q 128128 42 081 036 01 021 10 027 04 43 096 038 01 024 10 034 04 smoother yield compromis spai0 spai1 smoother storag requir converg rate lie obtain xed sparsiti pattern spai0 spai1 lower valu reduc converg rate even poor converg rate obtain gaussseidel could probabl improv either smooth c point f point 23 use symmetr gaussseidel result tabl 4 demonstr robust spai smooth deed 0 converg rate obtain combin spaiamg approach remain bound 42 local anisotrop diusion section consid local anisotrop problem ux boundari diusion coecient x except insid squar 14 34 14 34 x constant tabl 5 observ geometr multigrid diculti small valu unidirect smooth error align strong anisotropi standard isotrop interpol fail tabl local anisotrop diusion geometr mg converg rate q vari 128 128 grid smoother q q q gaussseidel amg result amg overcom diculti perform automat semicoarsen oper depend interpol direct strong coupl correspond smooth error compon wellknown eg 23 amg solv problem littl diculti result tabl 6 verifi fact accept densiti densiti could lower even drop smallest entri interpol oper 23 consid truncat grid transfer oper tabl amg converg result local anisotrop diusion 128 128 grid note q remain bound 0 284 294 294 smoother q q q gaussseidel 014 018 018 converg rate obtain gaussseidel spai1 compar 02 spai0 result slightli slower converg overal spai1 smoother ecient smoother problem although reduct result even faster converg approxim invers becom dens thu expens result tabl 6 7 demonstr robust multigrid behavior either h 0 tabl amg converg rate q local anisotrop diusion note q remain bound gridsiz 6464 128128 256256 289 294 295 gaussseidel 012 018 022 conclud remark result show spars approxim invers base minim frobeniu norm provid attract altern classic jacobi gaussseidel smooth simpler smoother spai0 spai1 often provid ampl smooth compar damp jacobi gaussseidel nev ertheless situat convect domin rotat ow spai1 lead converg multigrid iter unlik gaussseidel demonstr improv robust implement geometr multigrid combin spai1 smooth enabl fast solut larg convect diusion problem massiv parallel architectur incorpor spai smoother amg 22 obtain exibl parallel algebra multigrid method easili adjust underli problem comput architectur even nonexpert interest incorpor inform avail approxim invers coarsen strategi grid transfer oper suggest 1920 expect benet would includ improv robust local adapt multigrid compon well author current pursu issu report elsewher near futur acknowledg thank klau stuben use comment suggest r mpi implement spai precondition t3e block version spai precondition iter solut larg spars linear system aris certain multidimension approxim problem frequenc domain behavior set parallel multigrid smooth oper spars approxim invers precondition conjug gradient method compar studi spars approxim invers precondition approxim invers precondition via sparsespars iter priori sparsiti pattern parallel spars approxim invers precondition robust scalabl algebra multigrid parallel precondit spars approxim invers iter solut larg spars system equat approxim sparsiti pattern invers matrix precondit factor spars approxim invers precondit numer experi algebra multilevel precondition multilevel ainv precondition parallel adapt multigrid toward e spars approxim invers smoother multi grid introduct algebra multigrid introduct multigrid method robust ilusmooth matrix prolong restrict blackbox multigrid solver tr robust ilu smooth matrixdepend prolong restrict blackbox multigrid solver multigrid method parallel computersmyampersandmdasha survey recent develop factor spars approxim invers precondit spars approxim invers precondition conjug gradient method parallel precondit spars approxim invers approxim invers precondition via sparsespars iter approxim sparsiti pattern invers matrix precondit compar studi spars approxim invers precondition toward effect spars approxim invers precondition priori sparsiti pattern parallel spars approxim invers precondition robust scalabl algebra multigrid spars approxim invers smoother multigrid robust parallel smooth multigrid via spars approxim invers coarsegrid select parallel algebra multigrid ctr michel benzi precondit techniqu larg linear system survey journal comput physic v182 n2 p418477 novemb 2002