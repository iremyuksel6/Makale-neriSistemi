inheritancebas subtyp play dual role mainstream static type objectori languag serv object gener object type languag inherit impli subtyp contrast theoret languag commun view linkag mistak focus subtyp relationship determin structur object type without regard underli implement paper explor inheritancebas subtyp relat use describ two differ approach extend mobi program languag inheritancebas subtyp relat addit present type object calculu support structur inheritancebas subtyp provid formal account extens mobi b introduct great divid studi foundat objectori languag practic mainstream objectori languag like javaag98 c str97 one strike exampl divid role class inherit play defin subtyp relat foundat descript oo languag languag design studi inform inherit defin subtyp relat wherea languag like java c inherit defin subtyp hierarchi interest distinct certain id iom friend function binari method natur express inheritancebas subtyp framework requir substanti complic handl structur subtyp framework paper explor inheritancebas subtyp relat use present formal account small languag support subtyp relat begin examin common objectori idiom friend function explor one might implement idiom mobi fr99a languag structur subtyp exampl illustr defici reli sole structur subtyp languag design describ extens mobi section 3 add class type inheritancebas subtyp mobi show extens support number common idiom friend function binari method object clone present xmoc section 4 object calculu support structur inheritancebas subtyp well privaci xmoc provid model type system extend mobi prove subjectreduct type system valid design extend mobi section 5 describ relat work conclud section 6 2 problem friend c java mechan allow class function greater access privileg classs member other c class grant access declar certain class function friend java member annot public protect privat visibl class packag outsid packag section examin support idiom mobi languag structur subtyp type rep bag objtyp bag meth add int unit val union rep rep unit val mkbag unit rep class bag public field item var listint public meth add selfitem x selfitem public maker mk field item nil objtyp objtyp bag meth add int unit listapp s1add s2item fun mkbag new mk figur 1 bag friend use type abstract flexibl control classmemb visibl fr99a includ brief descript mobi appendix studi demonstr possibl encod friend idiom languag structur type relat result encod appeal 21 friend via partial type abstract standard way program friend use partial abstract type pt93 klm94 exampl figur 1 give mobi code implement bag class union function friend exampl ascrib bagm modul signatur make rep type partial abstract modul client outsid modul object type rep use union function add method sinc rep subtyp bag access item field insid modul rep type allow access member bag class 1 implement union function exploit access unfortun approach work final class want extend bag class must reveal class signatur bagm modul done figur 2 version object creat use mk maker use argument union function rep type limit also appli object creat subclass bag 22 friend via represent method support friend class extens class requir public mechan map object abstract represent type mechan recov represent type requir friend function exampl suppos extend bag class includ method return number item bag call new class cbag count bag want use union function object creat cbag class figur 3 present new implement notic ad public method bagrep interfac bag 1 mobi notat typeofc shorthand object type consist public member class c type rep typeofbag class bag public meth add int unit public maker mk unit val union rep rep unit val mkbag unit rep figur 2 reveal bag class class return self represent type rep appli union function two bag b1 b2 write bagunion b1bagrep b2bagrep express work even b1 andor b2 count bag also note item field public insid bagm modul part bag interfac outsid modul exampl object creat subclass bag subtyp rep although exampl includ friend cbag class includ represent method interfac illustr main weak approach name level class hierarchi must add represent type method method pollut method namespac effect partial encod class hierarchi object type furthermor suffer sourcecod version fragil baseclass problem refactor class hierarchi add new intermedi class add new represent method chang type object creat point hierarchi encod approach appear adequ exampl requir strong connect implement type awkward unpleas 3 extend mobi previou section show use abstract represent type represent method tie object type specif class programm perspect natur approach make class serv role type connect need section present extens mobi fr99a support class type inheritancebas subtyp intuit object class type c object instanti c one descend inheritancebas subtyp form bynam subtyp follow inherit hierarchi illustr extens use sever exampl 31 ad inheritancebas subtyp inheritancebas subtyp requir four addit mobi type system well coupl chang exist rule ffl class c defin c class type use type context modul bagm type rep typeofbag class bag public meth add int unit public meth bagrep unit rep public maker mkbag unit val union rep rep unit class bag public field item var listint public meth add selfitem x selfitem public meth bagrep rep self public maker mkbag field item nil objtyp listapp s1add s2item modul type rep typeofcbag class cbag public meth add int unit public meth bagrep unit bagmrep public meth size unit int public meth cbagrep unit rep public maker mkcbag unit class cbag inherit bagmbag public field nitem var int public meth add selfnitem selfnitems1 public meth size int selfnitem public meth cbagrep rep self public maker mkcbag super mkbag field nitem objtyp figur 3 bag friend use represent method class b public meth m1 int public meth m2 class c public meth m2 public meth m1 bool maker mkc unit figur 4 exampl reus privat method name cs scope note mean class type depend context insid method bodi class type host class allow access member wherea outsid class public member access ffl extend class interfac allow option inherit claus given context class c interfac includ inherit b claus view c subtyp b omit inherit claus cs interfac caus relationship b c hidden ffl say c subtyp relat correspond fisher observ implement type subtyp interfac type fis96 ffl exist type judgement method field select requir argument object type add new judgement case argument class type add new rule instead ad subtyp exist rule avoid technic problem describ section 32 ffl type method class c give self type c likewis b cs superclass super type b ffl type new express assign correspond class type result 32 inheritancebas subtyp vs privaci potenti problem extend mobi type system interact inheritancebas subtyp mobi support privaci mobi allow signatur ascript hide object member eg item field figur 2 c subtyp b even typeofc subtyp typeofb problem aris case class c defin method name one bs privat method consid code fragment figur 4 exampl 2 given definit typecheck express new mkcm1 allow subtyp lefthand side method select two incompat way exampl use class interfac annot class b syntact form avoid need wrap b modul signatur hide m2 meth modul bagm class bag public meth add int unit public maker mkbag unit val union bag bag unit class bag public field item var listint public meth add selfitem x selfitem public maker mkbag field item nil listapp s1add s2item modul class cbag inherit bagmbag public meth size unit int public maker mkcbag unit class cbag inherit bagmbag public field nitem var int public meth add selfnitem selfnitems1 public meth size int selfnitem public maker mkcbag super mkbag field nitem figur 5 bag friend extend mobi typecheck express avoid ambigu differ rule case lefthand side class type vs object type 3 33 friend revisit revisit bag class exampl use inheritancebas subtyp featur extend mobi new implement see figur 5 use class type bag instead rep type allow us simplifi code elimin rep type represent method note interfac cbag class includ inherit claus specifi subclass bag relat allow union function use valu cbag type 3 note mobi type rule includ subsumpt rule class public meth getx unit int public meth clone unit b public maker mkb int maker copyb b public meth getx int selfpvtx public meth clone b new copybself public maker mkb field field maker field class c inherit b public meth clone c new copycself public maker mkc int super mkbi maker super copyborig figur clone privaci extend mobi 34 binari method binari method method take anoth object class argument bcc number differ flavor binari method depend object subclass treat use class type implement binari method requir access privat field argument object exampl union function previou exampl implement binari method follow class bag field item var listint public meth add selfitem x selfitem public meth union listapp selfadd sitem public maker mkbag field item nil object clone anoth case inheritancebas subtyp use type copi constructor use implement userdefin object clone mechan 4 figur 6 give exampl clone extend mobi class b privat field pvtx make object type insuffici type check cs use copyb maker function problem aris object type associ self typecheck c pvtx field field privat b copyb maker function requir one thu need inheritancebas subtyp relationship allow copyc maker pass self type c paramet copyb maker 4 note mobi constructor call maker signatur hasshow type initb class meth show unit string maker mk initb modul class pr inherit mb public meth print unit consoleioprintselfshow maker super mkx class public meth show string hi public meth anothermeth unit maker mk modul class pra inherit ppr public meth anothermeth unit self aanothermeth figur 7 encod mixin extend mobi know c inherit b applic typecheck also exploit subtyp relat overrid clone method 36 encod mixin mobi support form multipl inherit combin parameter modul class type possibl encod mixin bc90 fkf98 encod mixin implement class parameter base class use parameter modul class interfac base class contain compon necessari mixin appli mixin particular base class creat new class inherit mix base class use class type reconstitut method base class hidden result modul applic without class type would possibl make origin classs method visibl exampl figur 7 give encod mixin class add print method class show method appli printmix class defin class pra reconstitut anothermeth method notic need use explicit type constraint convert type self pra sinc subtyp method dispatch encod cumbersom illustr power class type also might serv definit deriv form support mixin directli class c oe e x new ce figur 8 syntax xmoc term 37 effici method dispatch although main motiv worth note method dispatch field select object class type implement easili constant time oper dispatch method final class type compil elimin dispatch altogeth call method directli contrast object object type compil know noth layout object make access expens even exact layout class known abstract eg mixin encod previou section implement dispatch object class type two memori refer indirect jump frr99 develop function object calculu call xmoc model type system extend mobi valid design xmoc support tradit structur subtyp inheritancebas subtyp section discuss intuit behind xmoc state subject reduct result space consider preclud detail present full system given appendic b c 41 syntax term syntax xmoc given figur 8 xmoc program consist sequenc class declar termin express class declar come two form first class c declar inherit parent class b b none say c baseclass class parameter x whenev object construct c x bound suppli initi valu second form class declar class c deriv exist class c 0 classinterfac ascript produc class inherit implement c 0 restrict class interfac oe class interfac give type class paramet name nearest reveal ancestor class none type list avail method type includ type variabl function type recurs object type class type class declar denot base class either special symbol none name base class appli argument method take singl paramet express bodi syntax express e includ variabl function function applic new object creation special variabl self allow insid method bodi method dispatch last express form e c objectview coercion unlik extend mobi xmoc map inherit relat directli subtyp relat instead reli objectview coercion explicitli coerc type express class one superclass approach avoid problem discuss section 32 without requir two type judgement method dispatch possibl automat insert coercion xmoc represent program part typecheck translat similar typedirect represent wrap done polymorph languag ler92 42 dynam semant evalu xmoc program occur two phase first phase defin class link relat written k p ae k take dynam class environ k link leftmost class definit p produc k 0 class link termin residu express class declar link second phase evalu residu express valu assum termin phase defin express evalu relat write defin semant link evalu requir extend term syntax runtim form correctli handl classinterfac ascript provid greatest challeng defin semant xmoc use mechan public method b made privat subclass c subsequ reus name unrel method descend class c recal exampl figur 4 method inherit b must invok origin method send messag self method defin must get new version one solut problem use rieckeston dictionari semant rs98 fr99b dictionari provid ffconvers need avoid captur map method name slot xmoc use relat techniqu call view process class c tag method newli defin c label c use notat c inherit overridden method retain exist label furthermor replac occurr self cs new overridden method object view self c rule 4 appendix b describ annot formal runtim repres object pair raw object denot metavari obj view denot class name raw object contain list annot method implement object view repres visibl context messag send occur method scope class c avail inform check two condit lookup method runtim object hobj ci first list method provid obj second c descend class annot method two condit met return associ method otherwis search portion object inherit base class rule 1 2 appendix formal specifi method lookup 43 static semant xmoc type judgement written respect static environ gamma consist set bound type variabl subtyp assumpt map class environ c variabl environ v definit environ complet set xmoc type judgement given appendix c briefli discuss import rule mention earlier xmoc class name doubl object type associ type object whenev instanti object class accord type rule c gammac new ce c look class c gamma infer type 0 constructor argument e insur type subtyp type class paramet context allow subtyp treat class type object type accord follow subtyp judgement rule correspond properti c subtyp typeofc extend mobi note ff occur free type object type obj subject recurs wind unwind unlik extend mobi treat class type c subtyp superclass type instead use object view constraint type follow treat inherit directli subtyp xmoc need one rule type method dispatch 44 subject reduct proven subject reduct theorem xmoc first state link relat produc dynam class environ consist static environ defin program link chang type program theorem 1 fg fg fg fg p gamma fg p ae k e gamma k gamma k e second theorem state welltyp express evalu express compat type theorem say program p yield valu w k exist express e given definit character complet evalu program theorem 3 fg fg fg fg p gamma p yield w k gamma k w 0 5 relat work class type motiv role class play languag like c java main differ extend mobi class type provid languag way abstract support extend mobi allow partial hide inherit compon use signatur ascript mean typeofc may subtyp typeofb even c known inherit b see section 32 relat mechan c privat inherit allow subclass inherit base class hide inherit member conceal subtyp relationship extend mobi flexibl sinc allow hide permemb basi extend mobi also allow class hierarchi hidden omit inherit claus class interfac c java full class hierarchi manifest class type except class relat use c privat inherit anoth point differ extend mobi support structur subtyp object type java object type call interfac subtyp bynam c independ notion object type fisher phd dissert fis96 earliest formal class type awar work class tag row variabl use form bound existenti row work adopt class primit notion use name class fashion analog fisher row variabl weak earlier work treatment privat name provid way hide method later add unrel method name use class name label method object valu xmoc see appendix b similar use role tag method ghelli palmerini calculu model object role gp99 likewis pair object state class name defin current view object similar represent object valu main differ xmoc calculu surfac languag featur model recent igarashi et al describ featherweight java object calculu design model core featur java type system ipw99 like calculu featherweight java notion subtyp base class inherit calculu richer howev number way calculu model privat member narrow class interfac also notion structur subtyp relat implement structur subtyp notion notion type ident base implement present origin definit standard ml form structur share mth90 benefit structur share fairli limit drop 1997 revis sml mthm97 6 conclus paper present extens mobi support class type illustr util extens number exampl also develop formal model extens proven subject reduct continu work improv formal treatment class type implementationbas inherit 5 one minor issu xmoc requir 5 sinc paper written develop eleg treatment xmoc base rieckeston dictionari proven type sound paper describ revis system avail mobi web page httpwwwcsbelllabscomjhrmobi class name uniqu program restrict avoid introduc mechan stamp distinguish toplevel name eg see leroy approach modul system semant ler96 would also like gener rule relat class type object type rule appendix c allow posit occurr c replac object type bound type variabl believ gener sound yet proven r java program languag hopkin object group type system objectori program languag class mixin design class mechan mobi foundat mobi class calculu compil link class foundat extens object role featherweight java minim core calculu java gj type system prototyp languag unbox object polymorph type syntact theori type gener share definit standard ml definit standard ml revis year1997year static type friendli function via partial abstract type privaci via subsumpt tr mixinbas inherit unbox object polymorph type type system prototyp languag binari method class mixin java program languag 2nd ed design class mechan mobi featherwieght java c program languag third edit definit standard ml definit standard ml type system objectori program languag