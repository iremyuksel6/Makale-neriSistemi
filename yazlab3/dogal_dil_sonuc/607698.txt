grain filter motiv oper simplifi topograph map function studi theoret properti two kind grain filter first categori discov l vincent defin grain connect compon level set remov small area categori compos two filter maxima filter minima filter howev commut second kind filter introduc masnou work shape base connect compon level set filter addit properti act manner upper lower level set commut invers contrast discuss relat masnou filter class connect oper introduc literatur display experi show main properti filter discuss compar b introduct filter use simplifi imag satisfi minim set invari properti scarc actual one maxim set invari properti driven parabol partial dierenti equat 1 26 18 curvux curvatur level line u point x restrict regular point u howev previou lter optim term invari among regular lter lter driven pde properti regular desir theori drawback modifi contour particular destroy junction import clue occlus 5 4 drop requir bunch lter satisfi invari properti avail motiv studi famili lter reconstruct 9 10 21 31 32 serra salembi 30 25 introduc notion httppascalmonassefreefr c 2001 kluwer academ publish print netherland v casel p monass connect oper oper simplifi topograph map imag lter becom popular imag process experiment basi claim simplifi imag preserv contour properti made attract larg number applic nois cancel segment 17 33 recent becom basi morpholog approach imag video compress 23 24 22 6 dierent class connect oper studi meyer 15 16 serra 29 heijman 8 see also refer therein articl studi theoret properti two kind connect oper extrema lter shape lter simpli topograph map imag dierent sens given term topograph map maxima lter remov connect compon upper level set insuci area keep one ident 31 32 ensur region maxima ltere imag minim grain size similarli minima lter remov small connect compon lower level set lter grain correspond connect compon level set small grain consid nois seen prune tree connect compon upper lower level set previou work 3 introduc notion shape design deal symmetr upper lower level set shape also organ tree driven inclus appli imag posit minim grain size show structur tree nite shown imag result applic extrema lter properti new tree also provid denit anoth grain lter grain shape 13 19 20 remov small shape preserv one sucient area essenti improv extrema lter deal manner upper lower level set vocabulari mathemat morpholog 14 27 28 lter selfdual appli continu function present articl organ follow section 2 recal foundat mathemat morpholog underlin link morpholog lter set oper section 3 introduc main properti extrema lter prove section 4 prove analog properti grain lter particular selfdual lter continu function gener result 2 final section 5 illustr lter experi 2 gener result mathemat morpholog throughout section shall consid real function dene subset ir n u real function dene ir n denot u set fx 2 ux g 2 ir similarli dene set u u u 21 level set u real function x impli particular convers x famili set satisfi x level set level function u dene name x weaker hypothesi monoton x 2ir guichard morel show 7 x ae almost everi 2 ir 22 contrast invari contrast chang restrict sens strictli increas continu ir therefor homeomorph ir onto open interv ir direct consequ imag u contrast chang g appli u gu contrast chang g indier consid function dene ir oper act function u direct consequ 1 also written 4 v casel p monass show famili level set g u u level chang morpholog lter map act function u commut contrast chang g g 23 link set oper morpholog filter oper act set necessari requir transform level set function level set function thu lter associ dene equival denot b observ 11 12 inde let right hand side term equal x 2 u denit b x deduc u hand sinc uy get immedi tux convers uy n b n u 1n therefor take intersect n get x 2 say contrast chang g nondecreas upper semicontinu gener contrast chang use convent dene close set satis 2 set f n close dene upper semicontinu function easi check g commut appli upper semicontinu function get contrast invari strong sens sinc g constant stretch need continu 24 spatial invari properti ir n f map morpholog lter whose associ set oper whose structur element given famili b x x denot f morpholog oper dene f dene imag g fb x easi see f say invari respect f instanc b translat invari lter shall discuss satisfi properti respect famili structur element global invari respect area preserv map ie special ane map lter thu special ane invari depend paramet x set structur element lter x also satisfi b x 0 particular impli ane map f f 3 extrema lter 31 definit extrema lter construct manner connect compon level set imag minimum area call extrema lter connect compon level set contain region extremum achiev two step rst connect compon upper level set ltere lower level set dene set oper ensur properti let us rst x notat let set homeomorph close unit ball ir n n 2 6 v casel p monass interior note particular compact connect local connect moreov unicoher ie b close connect set ab connect set x denot ccx connect compon ccx x one contain point x provid x 2 x extens c connect ccx c ccx x x 2 c paramet repres area threshold let x subset dene lter g dene maxima lter minima lter sup show morpholog lter whose associ set oper 0 respect denit voluntarili symmetr act upper semicontinu func tion avoid case suppos j 32 preliminari result lemma 1 c n n2in nonincreas sequenc compact set n n2in nondecreas sequenc open set proof clear ccc x ccc n x n convers intersect continua thu continuum sinc contain x includ c get inclus n cco hand open local connect cco x open set henc 2 cco x continuum k cco x contain x sinc k n compact set extract nite cover k sequenc n non decreas n k n sinc k connect contain x 2 k cco n x conclud proposit 1 follow properti 0 nondecreas subset upper semicontinu compact set nonincreas sequenc compact set lower semicontinu open set n n0 nondecreas sequenc open set 0 n proof properti direct consequ denit monoton f appli lemma 1 observ ccf x particular n sinc 0 monoton let ju j let u lemma 1 prove henc n larg enough ju n j conclud x 2 u n 0 n b two famili set say basi b b b 2 b 2 b 2 b basi fx basi xg proof direct consequ denit corollari 1 appli upper semicontinu function morpholog lter whose associ set oper 8 v casel p monass precis proof let xg consequ proposit 1 uy use fact b basi c shown lemma 2 deduc u x sup uy inf take supremum b get sup u similar proof appli link 0 proposit 2 let u v ir ii u v v proof immedi includ detail corollari 2 let u ir u n u uniformli uniformli proof given 0 let n 0 u u n use proposit 2 ii iii iv obtain n n 0 henc uniformli similarli prove uniformli 33 properti proposit 3 u upper semicontinu function also u u continu also u proof let u upper semicontinu function u close set connect compon close sinc u nite union close thu u upper semicontinu manner u open set connect compon also open imag 0 thu union open set open prove u upper semicontinu final suppos u continu prove close 2 ir use corollari 1 write claim c sinc open contain close set c deduc n c open empti thu posit measur henc joj jcj prove joj thank lemma 1 v casel p monass n prove remain inclus right hand side equal open conclud close prove result write claim last set coincid g n open c close jcj jo n j henc n n appli lemma 1 get yield henc jccu prove thu equal term right hand side term nite union close set also close proposit 4 restrict upper semicontinu function idempot proof let u upper semicontinu function 2 ir clearli appli equal set u use corollari 1 get thank proposit 3 close appli corollari 1 left hand side equal obtain sinc equal hold 2 ir conclud proof appli proposit 5 let u 2 proof case similar sucient prove rst part assert let ux observ v lower semicontinu assum max 0be contain open set henc let choos mwhich contradict conclud proposit prove ii case similar shall prove uniformli 0 let us write given 0 let 0 0 small enough v casel p monass ie collect fact 34 interpret let u upper semicontinu function jcj thu c connect compon c connect compon u even meet set sinc convers u connect compon u sinc c 6 sum remark see connect compon exactli connect compon u measur particular sinc connect compon upper level set structur tree driven inclus tree tree u prune node insuci measur observ made concern connect compon u tree tree connect compon lower level set u prune node insuci measur summar discuss follow result proposit 6 u 6 jxj jccu j resp u j particular result impli connect compon thing said connect compon upper lower level set u 35 composit lemma 3 let u upper semicontinu function 2 ir proof let u consequ fals would c u sinc contradict denit c c c open c c c x belong connect compon u connect includ u jdcj get dc contradict denit c prove claim x 2 c ux argu contradict hypothesi thu may assum c let sinc c close open c thu x mean jccu xj compon must therefor jdj final observ u contradict theorem 1 oper transform upper semicontinu function upper semicontinu function continu function continu function ii idempot upper semicontinu function proof direct consequ equival properti prove proposit 3 consequ proposit 2 function u appli u get 14 v casel p monass appli rst part lemma 3 nd point x 2 c v let know jdj sinc connect prove thu equal member use idempot conclud similar proof use second part lemma 3 prove idempot 4 grain lter 41 definit problem extrema lter present two oper act upper lower level set gener commut moreov none properti deal symmetr upper lower level set actual work two step rst upper lower level set treat opposit order oper selfdual definit 1 morpholog lter associ set oper said selfdual continu function follow equival properti hold continu function u 1 2 8x sup b2b inf y2b describ structur element 3 8 u show equival rst two properti suce write second one u instead u take instead see third properti equival use contrast invari amount write mean exactli tu recal denit essenti properti satur oper definit 2 let p 1 xed point x call hole x connect compon x extern hole x x hole intern hole x satur x satx union x intern hole follow result prove 3 proposit 7 1 2 3 x connect satx connect connect 4 x open resp close satx open resp close 5 close 6 satx connect subset x 7 h intern resp extern hole x 8 nest disjoint 9 let x open close x x 2 sato satc u upper semicontinu function call shape u element tree structur u express properti 3 nest disjoint v casel p monass restrict denit set oper close set sinc later dene lter upper semicontinu imag k compact set dene f intern hole c jc 0 j clearli g compact k thu alway suppos j remark dene grain lter compact set sinc sucient extens lter upper semicontinu function obvious denit sens subset 42 preliminari result lemma 4 g nondecreas compact set proof let k l compact set let famili intern hole c observ c hand h 0 intern hole c 0 includ hole h c thu jhj observ deduc famili intern hole c resp c 0 whose measur conclud g k g l lemma 5 k compact proof let us denot c i2i famili connect compon k let set indic jsatc j monoton inclus immedi denit ident also observ g c union c intern hole thu connect let j subset whose cardin least 2 let prove connect connect open close subset e 0 0 dierent 0 observ e 0 union c j sinc set connect precis let us write prove e open close henc connect clearli 6 e sinc e 0 open 0 open set u 0 u 0 union connect compon u 0 meet c l l 2 l set u 00 union open set open set u union u 00 intern hole c l open also open j 2 j nl eg inde last equal hold would connect compon u 0 meet c l l 2 l denit u 00 c j inde meet hole h c j jhj h contain c l otherwis sinc h n satc l open empti thu posit measur would jhj l j thu connect meet two dierent connect compon compon contain c l henc c j 6 impli u 0 c j 6 contradict ident conclud hold ie u 00 g therefor u 00 n e prove u shown set e open appli argument prove e also close lemma 6 let c n n2in nonincreas sequenc continua n c n h hole c exist n 0 2 nondecreas sequenc hole c n proof x 2 h n 0 x 62 c n n n 0 thu n n 0 x hole h n c n obvious h n h therefor h n h u neighborhood v connect neighborhood v u sinc 2 h n monoton h n may write nnn h n also v casel p monass connected v impli follow v c 6 impli u c 6 true neighborhood u get 2 impli h h n close h sinc also open union open set connected h impli theorem 2 oper g upper semicontinu ie k n nonincreas sequenc compact set proof inclus left hand side term right hand side one due monoton g show inclus lemma 5 n n 1 c n insid impli due lemma 5 show sequenc continua c n nonincreas intersect c continuum thank zoretti theorem sinc c contain compon remain show x 2 g c take h prove h thu jsatcj moreov x belong intern hole h c sinc x 2 g c n associ sequenc h n obtain lemma 6 jh n j thu henc x 43 properti lemma 7 close set c connect compon h intern hole x h g proof right hand side term equal h 0 obvious contain h suppos inclus strict set h connect h 0 open union open set h 0 close h h h 0 6 let 2 h h 0 let u connect neighborhood claim ua 6 otherwis would u u meet n u g 0 connect contradict g conclud 2 g sinc g open set contain neighborhood 2 h 0 particular meet g n x 2 g 00 h thu g g 00 nest g 6 h 0 g 00 g thu x 2 g g h impli g h 0 contradict assumpt sinc 2 g conclud h lemma 8 let b close set proof suppos b disjoint take compon b instead b may assum b connect result obviou g g b empti may also assum none empti sata satb either nest disjoint disjoint sinc g sata g b satb 5a obviou nest without loss gener may assum sata satb sata insid hole h b get jhj jsataj sinc sata close h open open nonempti set thu posit measur yield jhj therefor sata 5a suppos let x 62 g particular impli satc c cca set c n satc connect also n satc compact set lindelof theorem intersect famili continua written intersect sequenc thu nd sequenc c n connect compon v casel p monass let clearli n nonincreas sequenc continua may write thu continuum observ b inde connect compon c sinc yn satc obvious 2 satc c prove connect neighborhood u meet point otherwis cu would connect turn impli u c sinc n b conclud b contradict choic prove b also observ thu jsatdj one follow case happen iii x 2 satc jsatcj suppos hold x 2 sinc jsatdj suppos ii hold let set dene x 2 x 2 g g b x 62 x hole h thank lemma 7 write g thank lindelof theorem union open set written union sequenc g n set n sinc g 0 obtain jg n j jsatcj conclud sup n2in jg n j thu x 2 h g g b final suppos iii hold let c claim connect compon nite number set e intersect result due fact nest innit number set e write intersect intersect sequenc e n thank lindelof theorem take n instead e n may also assum sequenc nonincreas set therefor continuum jt connect neighborhood sinc u 6 n u n e n 6 sinc u connect meet complement u also meet e n obtain show hand observ complement connect union increas sequenc connect set thu written intersect two continua thu connect sinc unicoher thu 0 impli jej 0 e 6 therefor satt 0 e follow satt 0 thu equal observ x must hole h 0 must jhj sinc otherwis x use lemma 7 write g may write union union nondecreas sequenc set g n thu n write g n x hole h 0 contain connect compon k case also x n sinc g 0 n contain connect compon k 0 b get x theorem 3 restrict continu function g selfdual proof shall prove condit 3 denit 1 hold accord 5a may write 2 ir sinc g u n take intersect n get therefor 22 v casel p monass let x n 0 x due 5b x 2 prove thu take complement part get prove actual equal set theorem 4 semicontinu function upper semicontinu function continu function continu function proof show imag compact set k compact set let sequenc point g k converg x shall prove x 2 g k shown lemma 5 x n belong g k n k cck famili fk n n 2 ing nite extract subsequ belong g k n 0 close set sinc complement union hole k n 0 hole open set thu x may assum fk n n 2 ing innit mayb extract subsequ km k 6 n satg k n nite number satur two two disjoint sinc measur least thu extract subsequ necessari may assum intersect form either decreas increas sequenc sequenc satk n n2in decreas intersect set satk 0 cck shown lemma 8 jsatk 0 otherwis would k sucient larg n contain hole k n n thu x n 62 satk 0 n sinc x 2 satk 0 conclud desir result let us assum satk n n2in increas sinc lim inf sequenc k n nonempti contain x lim sup continuum c accord zoretti theorem sinc k compact follow c observ x 2 k 0 shall prove jsatk 0 j precis satk n measur intern hole k 0 result impli k n k 0 6 k sinc connect compon k sinc assum set k n two two disjoint happen twice thu may assum k n k n sequenc satk n increas k n hole k 0 suppos hole extern hole h k 0 sinc h open continuum l join p 1 arbitrari point 0 k 0 sinc k 0 intern hole k 1 manner construct sequenc n n2n n 2 lk n n l compact subsequ n converg point 2 lc follow k 0 l 6 contrari assumpt l hole k 0 prove claim appli preced result u continu u upper semi continu sinc u also upper semicontinu u also upper semicontinu henc u lower semicontinu thu u continu proposit 8 0 therefor g idempot proof conclus g idempot deriv previou statement take result amount show g 0 u distinguish three famili among connect compon v casel p monass observ thank lemma 5 may write intern hole c intern hole c measur reason conclus yield follow properti easi consequ denit lemma 9 oper satis follow properti u v function u 2 ir lemma 10 let u upper semicontinu function let proof let us x sinc sucient prove g v almost 2 ir let denot famili connect compon k hk famili intern hole k observ c2ckjsatcj intern hole c jhj g sinc proposit 6 connect compon k measur c 2 ck satis jsatcj similarli sinc intern hole k contain connect compon v also measur henc famili set h 2 hk jhj empti conclud g proposit 9 let u 2 0 proof use lemma 0 proposit 5 given 0 0 0 impli u therefor u choos 0 obtain u 2 proposit follow 44 relat connect oper want compar grain lter describ notion grain oper dene 8 x idea shall work classic connect thu denot c famili connect set grain criterion map c c f0 1g given two grain criteria f foreground b background associ grain oper fb dene 8 heijman character grain oper selfdual increas inde prove fb selfdual b also prove fb increas f b increas follow condit hold x x shall say grain criterion c c f0 1g upper semicontinu compact set c n k n decreas sequenc continua k n n 2 26 v casel p monass proposit 10 let selfdual increas grain oper ator associ grain criterion c assum c upper semicontinu proof either point x rst case deduc nonempti subset x therefor 6 x sinc also x second case use upper semicontinu c cbx choos observ cccx fxg contradict 6 proposit say nontrivi translat invari increas selfdual grain oper type connect oper call atten level introduc f meyer 1516 studi 29 particular serra prove exist increas selfdual atten level base marker 29 final let us prove grain lter introduc correspond univers criterion dene increas selfdual lter let us recal denit connect oper 25 30 8 given set x denot p x partit constitut ccx ccx c famili subset x denot pdefinit 3 oper p p connect partit p x coarser p x everi set x given connect oper p p shall say increas x x ii act addit connect compon x famili connect compon x iii selfdual ir n n open close set x iv bound p 1 dicult see connect oper increas selfdual induc increas selfdual lter continu function proposit 11 let p p connect oper suppos increas selfdual bound act addit connect compon let ker fx open close connect set satx 62 ker hx denot famili intern hole x proof sinc selfdual without loss gener may assum p 1 62 x sinc connect oper z simpli connect z must one set f g sinc bound must either particular either satx rst case satx 2 ker second case use addit connect compon observ begin proof use selfdual x obvious increas ker ideal set ie x x 2 ker 2 ker 45 interpret similar remark extrema lter made concern shape shape u shape u sucient measur correspond prune tree shape u 5 experi theoret lter g dierent illustr figur 1 second row show ltere imag 3 u dierent stress respect notion grain dierent dierenc appear presenc hole concern natur im age dierenc would appar certain imag 28 v casel p monasse11202 figur 1 topleft origin imag u three constant region suppos area 2 bottom left g3u middl column 3 u 3 u 3 u figur 2 textur imag carpet size 254 173 textur nested shape would import figur 2 show complex textur figur 3 imag ltere accord three lter paramet pixel wherea actual dierent visual equival distinguish requir eort explain fact connect compon level set hole greater area scarc word situat illustr figur 1 frequent figur 3 three grain lter appli imag u figur 2 left column g30u acknowledg acknowledg partial support tmr european project vi cositi solut applic refer fmrxct980234 cnr pic project rst author acknowledg partial support pnpgc project refer bfm20000962c02 v casel p monass r imag iter smooth pde random set integr geometri mathemat morpholog applic signal imag process mathemat morpholog applic signal imag process imag analysi mathemat morpholog tr introduct mathemat morpholog watersh digit space affin invari scalespac morpholog multiscal segment imag code selfdual morpholog oper filter connect oper level level fundamenta morphologica mathematica compact multiscal imag model base level set ctr renato keshet shapetre semilattic journal mathemat imag vision v22 n23 p309331 may 2005 renato keshet adjac lattic shapetre semilattic imag vision comput v25 n4 p436446 april 2007