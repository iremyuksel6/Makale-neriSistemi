use matrix sign function comput invari subspac matrix sign function sever applic system theori matrix comput howev numer behavior matrix sign function associ divideandconqu algorithm comput invari subspac still complet understood paper present new perturb theori matrix sign function condit comput numer stabil divideandconqu algorithm iter refin scheme numer exampl also present extens matrixsignfunctionbas algorithm comput left right deflat subspac regular pair matric also describ b introduct sinc matrix sign function introduc earli 1970 subject numer studi use mani applic exampl see 30 31 11 26 23 refer therein main interest use matrix sign function build parallel algorithm comput invari subspac nonsymmetr matric well associ eigenvalu challeng design parallel algorithm nonsymmetr eigenproblem use coars grain parallel effect scale larger problem larger machin wast time deal part spectrum user interest deal highli nonnorm matric strongli cluster spectra work 2 review exist approach propos design parallel nonsymmetr eigenroutin toolbox includ basic build block lu factor matrix invers matrix sign function standard eigensolv routin qr algorithm new algorithm spectral divideandconqu use sign function discuss tool could use differ combin differ problem architectur extract eigenvalu nonsymmetr matrix andor correspond invari subspac rather use black box eigenroutin provid eispack 32 21 lapack 1 expect toolbox approach allow us flexibl develop effici problemori eigenproblem solver high perform machin especi parallel distribut memori machin howev numer accuraci stabil matrix sign function divideandconqu algorithm base poorli understood paper address issu much work also appear 3 let us first restat basic definit idea establish notat matrix sign function matrix defin follow 30 let jordan canon form matrix 2 c nthetan eigenvalu j lie open right half plane c j gamma lie open left half plane c gamma publish siam j mat anal appl vol19 pp205225 1998 depart mathemat univers kentucki lexington ky 40506 baimsukyedu z comput scienc divis mathemat depart univers california berkeley z bai j demmel matrix sign function assum eigenvalu lie imaginari axi otherwis signa defin easi show spectral project correspond eigenvalu open right left half plane p respect let lead column orthogon matrix q span rang space p exampl q may comput rankrev qr decomposit spectral decomposit 1 eigenvalu c 22 eigenvalu c gamma algorithm proce divideandconqu fashion comput eigenvalu 11 22 rather use jordan canon form comput signa shown signa limit follow newton iter k1 2 2 iter global ultim quadrat converg exist differ scale scheme speedup converg iter make suitabl parallel comput comput matrix sign function mobiu transform spectrum divid along arbitrari line circl rather along imaginari axi see report 2 refer therein detail unfortun finit precis arithmet ill condit matrix k respect invers round error may destroy converg newton iter 2 caus converg wrong answer consequ left bottom corner block matrix q aq 1 may much larger u denot machin precis mean numer stabl approxim eigenvalu eigenvalu 11 22 would like paper first studi perturb theori matrix sign func tion condit numer stabil overal divideandconqu algorithm base matrixsign function realiz difficult give complet clear analysi partial understand expect newtion iter converg accur coars analysi also bound condit number intermedi matric newton iter ation artifici possibl patholog test matric construct verifi theoret analysi besid artifici test also test larg number eigenvalu problem random matric eigenvalu problem appli cation electr power system analysi numer simul chemic reaction areodynam stabil analysi exampl conclud bound numer sensit stabil matrix sign function comput base algorithm reachabl patholog case often pessimist worst case happen rare addit discuss iter refin approxim invari subspac outlin extens matrix sign function base algorithm comput left right deflat subspac regular matrix pencil gamma b matrix sign function comput invari subspac 3 rest paper organ follow section 2 present new perturb bound matrix sign function section 3 discuss numer condit matrix sign function backward error analysi comput invari subspac remark matrix sign function base algorithm versu qr algorithm present section 4 section 5 present numer exampl analysi section 2 3 4 section 6 describ iter refin scheme improv approxim invari subspac section 7 outlin extens matrix sign function base algorithm gener eigenvalu problem conclud remark present section 8 2 perturb bound matrix sign function matrix eigenvalu pure imaginari axi matrix sign function defin word set illpos problem matrix sign function set matric least one pureimaginari eigenvalu comput observ eigenvalu close pure imaginari axi newton iter variat slowli converg may misconverg moreov even iter converg error comput matrix sign function could larg use desir perturb analysi matrix sign function relat distanc nearest illpos problem perturb theori condit number estim matrix sign function discuss 25 23 29 howev none exist error bound explicitli reveal relationship sensit matrix sign function distanc nearest illpos problem section deriv new perturb bound explicitli reveal relationship denot eigenvalu posit real part ie denot smallest singular valu addit recal wellknown inequ matrix 2norm theorem 21 suppos pure imaginari zero eigenvalu perturb ffl j kffiak let 3 furthermor 4 z bai j demmel im r r r fig 1 semicircl gamma proof prove bound 7 bound 5 prove use similar techniqu follow robert 30 kato 24 matrix sign function also defin use cauchi integr represent z gamma simpl close curv posit direct enclos sign spectral projector without loss gener take gamma semicircl radiu figur 1 definit 8 signa seen studi stabil matrix sign function perturb ffi suffici studi sensit project project correspond condit 6 eigenvalu perturb across pure imaginari axi semicircl gamma also enclos therefor z z r gammar z 2 gamma2 first integr denot 1 integr straight line semicircl gamma second integr denot 2 integr curv part semicircl gamma take spectral norm first integr term note definit condit 6 inequ 3 z r gammar matrix sign function comput invari subspac 5 z r gammar z r gammar z r gammar take spectral norm second integr term 2 z 2 gamma2 kre z 2 gamma2 r r third inequ follow 3 fourth choic radiu r semicircl gamma desir bound 7 follow bound ki 1 k ki 2 k ident remark order 1 languag pseudospectra 35 condit 6 mean kffiak pseudospectra cross pure imaginari axi 2 perturb bound 7 see stabil matrix sign function perturb requir kffiakpseudospectra bound away pure imaginari axi also small recal da distanc nearest matrix pureimaginari eigenvalu 3 natur take condit number matrix sign function algorithm comput da relat problem found 14 9 8 12 4 bound 7 similar bound norm frechet deriv matrix sign function x given robert 30 length close contour gamma recent asymptot perturb bound signa given byer mehrmann 13 show first order ffi kffiak 6 z bai j demmel assum form 1 kffiak suffici small separ matric 11 22 33omega kroneck product compar bound 7 9 note first bound 7 global bound asymptot bound second assumpt 6 bound 7 simpl geometr interpret see remark 2 unspecifi interpret assumpt suffici small kffiak bound 9 3 condit matrix sign function comput 2 point may much effici comput half machin precis ie comput absolut error bound u 12 ksk avoid ill condit newton iter achiev half machin precis believ matrix must condit number less u gamma12 ill condit say singular valu less u 12 kak need use preprocess step deflat small singular valu unitari similar transform obtain submatrix condit number less u gamma12 comput matrix sign function submatrix deflat procedur may also need intermedi matric newton iter worst case look close situat near converg newton iter relat error distanc nearest illpos problem 18 illpos problem matric pureimaginari eigenvalu without loss gener let us assum form 11 12 otherwis matrix b schur decomposit form r solut sylvest equat must exist uniqu sinc 11 22 common eigenvalu known spectral projector p correspond eigenvalu 11 r follow lemma relat r norm project p signa condit number lemma 31 let r let ae 1 gamma2r 2 ae therefor proof 1 let r easi verifi r satisfi 12 gamma2r matrix sign function comput invari subspac 7 2 use singular valu decomposit svd r urv one reduc comput svd comput svd gamma2sigma permut equival comput svd 2 2 matric turn simpl calcul note solut r sylvest equat 12 equal attain 33 lemma 31 see condit matrix sign function comput close relat norm project p therefor norm r turn close relat quantiti specif krk larg ka 12 k moder ill condit matrix sign function mean larg krk turn mean small follow stewart 33 mean harder separ invari subspac correspond matric 11 22 follow theorem discuss condit eigenvalu signa distanc signa nearest illpos problem theorem 32 let r lemma 31 1 let ffi properti ffi pure imaginari eigenvalu may chosen smaller languag 35 fflpseudospectrum exclud imaginari axi ffl 1ksk intersect ffl 1ksk 2 condit number eigenvalu kpk word perturb small ffi perturb eigenvalu kpk kffiskokffisk 2 3 close u gamma12 newton iter 2 float point arithmet comput absolut error bound u 12 ksk proof 1 problem minim oe min gamma iii real oe min smallest singular valu gamma iii use unitari similar transform permut part 1 lemma 31 see equival minim oe min oe j real straightforward calcul minimum obtain 8 z bai j demmel 2 condit number semisimpl eigenvalu equal secant acut angl left right eigenvector 24 17 use reduct 2 2 subproblem unitari transform coordin chang angl vector straightforward calcul 3 sinc absolut error ffi comput 1 essenti error comput newton iter converg ffi larg ffi pure imaginari eigenvalu result 1 mean kffisk therefor u iter 2 comput absolut error bound u 12 ksk natur desir analysi know condit intermedi matric k newton iter help us address question detect possibl appear pure imaginari eigenvalu modifi termin iter earli necessari unfortun difficult make clean analysi far converg unabl relat error step iter condit problem coars analysi howev case matrix diagonaliz theorem 33 let eigenvalu j none pure imaginari zero right eigenvector x j left eigenvector j normal let k matrix obtain kth newton iter 2 k oe oe min proof may express eigendecomposit wish bound j jk j k easili done note jk lie insid disk defin disk symmetr real axi point minimum maximum absolut valu real solv extrem point yield matrix sign function comput invari subspac 9 mean oe similarli oe prove bound 15 know error introduc step iter mainli caus comput matrix invers approxim bound norm oe 1 uoe gamma3 oe min error make intermedi k becom singular caus iter fail analysi show uoe gamma3 oe oe u 14 iter fail coars bound gener result 3 theorem 2 note symmetr orthonorm eigendecomposit theorem 3 therefor show symmetr condit number intermedi matric k affect numer stabil newton iter essenti determin squar distanc eigenvalu imaginari axi 1 nonsymmetr diagonaliz theorem 33 also see condit number intermedi matric k relat norm spectral projector correspond eigenvalu j quantiti form simpl algebra manipul refere predict symmetr case condit number k might determin distanc squar distanc abl prove predict z bai j demmel express see eigenvalu j near pure imaginari axi ie ff j small first order taylor expans oe j term ff j therefor first order ff j condit number intermedi matric k impli even eigenvalu wellcondit ie kp j k larg also eigenvalu closer imaginari axi u 12 condit number k could larg newton iter could fail converg 4 backward stabil comput invari subspac discuss previou section possibl ill condit matrix respect invers round error newton iter gener expect abl comput matrix sign function squar root machin precis provid initi matrix condit number smaller u gamma12 mean newtion iter converg comput matrix sign function uksk assumpt b approxim spectral project correspond therefor p first column b rank reveal qr decomposit b span approxim invari subspac b q form 11 12 22 b approxim eigenvalu c b 22 approxim eigenvalu c gamma sinc expect comput matrix sign function half machin precis reason expect comput invari subspac half precis turn mean backward error comput decomposit b q bound problem ill condit section tri justifi expect end first need bound error space span lead column transform matrix q ie need know much right singular subspac exact project matrix perturb p perturb matrix norm j sinc p projector subspac span right singular vector correspond nonzero singular valu p call set singular valu practic cours question rank determin wellknown perturb theori singular valu matrix sign function comput invari subspac 11 decomposit 34 page 260 space span correspond singular vector perturb ojgap gap defin comput gap note alway unitari chang basi projector form sigma diagon straightforward calcul find singular valu projector f number one set singular valu equal maxf2 gamma n 0g sinc f thu error ffi q q bound henc backward error comput spectral decomposit bound second order perturb term kffiqk therefor 2 n follow first order bound backward stabil comput invari subspac uksk uksk use bound 5 matrix sign function 21 da da defin 4 distanc illpos problem hand use bound 13 matrix sign function 21 22 separ matric 11 22 assum form 11 note error bound 23 essenti error bound given byer mehrmann 13 although use differ approach 13 assum 19 f 21 21 block matrix f therefor u term 23 replac ou z bai j demmel bound 22 23 reveal two import featur matrix sign function base algorithm comput invari subspac first indic backward error comput approxim invari subspac appear larger absolut error comput matrix sign function provid spectral decomposit problem ill condit ie da ffi tini second 2 n backward error decreas function oe l oe larg mean oe 1 larg turn mean eigenvalu close imaginari axi ill condit harder divid eigenvalu cours becom ill condit da decreas time must counterbal increas oe certain rang interest ask error bound 22 23 sharper ie one quantiti da 22 larger 13 exampl 2 2 matrix given show quantiti ffi larger quantiti da howev also devis simpl exampl show da larger gener choos 11 larg jordan block tini eigenvalu da close squar root ffi da comput use numer brute forc plot function da wide rang 2 ir search minim valu note modifi gamma oei oe suffici small real number da chang ffi thu da ffi complet compar quantiti believ da natur quantiti use ffi sinc ffi alway depend distanc nearest illpos problem reminisc differ quantiti practic use posteriori bound ke 21 kkak anyway sinc block uppertriangular b q set 2 1 block zero ke 21 kkak precis backward error introduc end section let us comment stabil matrix sign function base algorithm versu qr algorithm qr algorithm numer backward stabl method comput schur decomposit gener nonsymmetr matrix comput schur form b schur vector b q qr algorithm satisfi e order ukak numer softwar qr algorithm avail eispack 32 lapack 1 although nonconverg exampl found quit rare practic 6 16 note eigenvalu blockdiagon b may appear order therefor applic requir invari subspac correspond eigenvalu specif region complex plane second step reorder eigenvalu diagon b necessari guarante stabl implement reorder describ 7 matrix sign function base algorithm regard algorithm combin two step one matrix sign function comput matrix sign function comput invari subspac 13 within order uksk analysi section show matrix sign function base algorithm could stabl qr algorithm plu reorder unfortun matrix ill condit respect matrix invers affect qr algorithm numer unstabl anticip comput matrix sign function therefor gener matrix sign function less stabl qr algorithm plu reorder 5 numer experi section present numer exampl verifi analysi see numer stabil newton iter 2 backward accuraci comput spectral decomposit 1 influenc condit matrix respect invers condit number distanc deltaa eigenvalu pure imaginari axi use easili comput quantiti deltaa surrog quantiti da 4 let us recal analysi section 3 4 essenti claim 1 deltaa u 12 newton iter may fail converg fail comput matrix sign function within absolut error u 12 ksk even matrix sign function wellcondit see 18 2 u gamma12 even distanc deltaa small newton iter may still fail comput matrix sign function absolut error ou 12 ksk see part 3 theorem 32 3 gener backward error comput spectral decomposit smaller absolut error comput matrix sign function see 21 follow numer exampl illustr claim numer experi perform sun workstat 10 machin precis u algorithm implement matlab 40a use simpl newtion iter 2 comput matrix sign function stop criterion maxim number iter set 70 converg comput matrix sign function use qr decomposit column pivot rank reveal scheme 1 b rpi final comput 11 12 22 first r column b q span invari subspac correspond b 11 approxim eigenvalu c ke 21 kkak backward error commit algorithm test matric construct form u orthogon matrix gener qr decomposit random matrix normal distribut mean 00 varianc 10 choos differ submatric 11 22 12 gener matric differ specif featur order observ theoret result practic 14 z bai j demmel tabl numer result exampl 1 exact matrix sign function condit number comput describ lemma 31 condit number comput matlab function cond follow tabl iter number iter newton iter number 10 ff parenthesi next iter number iter indic converg newton iter stationari o10 ff iter th iter forward fail satisfi stop criterion even allow maxim number iter experi numer matric differ patholog ill condit term distanc pure imaginari axi condit number differ valu sepa 11 22 two select exampl present typic behavior observ exampl 1 exampl matric form 24 random 2 2 matrix normal distribut multipli paramet c gener matrix two complex conjug eigenpair sigma gamma sigma 0 distanc size paramet c adjust condit result matrix matrix sign function tabl 1 report comput result differ valu tabl see matric well condit correspond matrix sign function also wellcondit state claim 1 converg rate accuraci newton iter clearli determin distanc deltaa distanc becom smaller steadi increas number newton iter requir converg loss accuraci comput matrix sign function therefor desir invari subspac tabl also see deltaa moder newton iter fail comput matrix sign function half machin precis nevertheless comput invari subspac seem still half machin precis see claim matrix sign function comput invari subspac 15 tabl numer result exampl 2 exampl 2 exampl test matric form 24 12 5 5 0normal distribut random matric submatric 11 22 first set 5 5 1 0normal distribut random upper tridiagon matric diagon element 11 22 replac dja ii j gammadja ii j respect ii 1 n random number normal distribut 0 1 posit paramet 12 5 5 1 0normal distribut random matric numer result report tabl 2 given paramet eigenvalu wellsepar away pure imaginari axi deltaa small howev state claim 2 see influenc condit number converg newton iter therefor accuraci comput matrix sign function invari subspac 6 refin estim approxim invari subspac use matrix sign function base algorithm deflat invari subspac matrix end form 11 12 22 size ke 21 kkak reveal accuraci backward stabil comput invari subspac span b higher accuraci desir may use iter refin techniqu improv accuraci comput invari sub space method due stewart 33 dongarra moler wilkinson 20 chatelin 15 even though method appar solv differ equat shown demmel 19 chang variabl solv riccati equat inner loop let us follow stewart approach present first class method 25 know b span approxim invari subspac b span orthogon complementari subspac let true invari subspac repres b orthogon complementari subspac b deriv follow b invari subspac lower left block zero ie lower left corner gammay h 11 12 22 gammay z bai j demmel zero thu must satisfi equat 12 wellknown algebra riccati equat may use follow two iter method solv 1 simpl newton iter 22 2 modifi newtion iter therefor need solv sylvest equat inner loop iter refin follow numer exampl use simpl newton iter 26 refin approxim invari subspac comput matrix sign function base algorithm follow stop criterion exampl 3 continu exampl 2 tabl 3 list 22 number iter refin step backward accuraci improv invari subspac shown converg analysi iter solver 26 27 riccati equat stewart 33 demmel 18 let 22 assumpt k 14 k 112 iter 26 27 converg respect therefor sep b 22 key factor converg iter refin scheme exampl verifi analysi analysi section 3 recal sep b 22 also affect backward stabil comput invari subspac matrix sign function base algorithm first place iter refin 7 extens gener eigenproblem section outlin scheme extend matrix sign function base algorithm solv gener eigenvalu problem regular matrix pencil gamma b matrix pencil gamma b regular agammab squar detagammab ident zero 22 gardin laub consid extens newton iter comput matrix sign function matrix pencil solv gener algebra riccati equat discuss anoth possibl approach includ comput left right deflat subspac given matrix pencil gamma b problem spectral decomposit seek pair left right deflat subspac l r correspond eigenvalu pencil specifi region complex plane word want find pair unitari matric ql qr matrix sign function comput invari subspac 17 tabl iter refin reresult exampl 2 28 eigenvalu 11 gamma b 11 eigenvalu gamma b select region complex plane discuss region open right half complex plane treatment standard eigenproblem employ mobiu transform ffa divideandconqu union intersect arbitrari half plane complement disk rather gener region end directli appli newton iter ab gamma1 converg practic want invert b ill condit henc let z iter becom lead follow iter converg quadrat matrix z1 next find desir deflat subspac use rank reveal qr decomposit calcul rang space project correspond spectral open right half plane rang space thu comput rank reveal qr decomposit z1 obtain invari subspac ab gamma1 without invert b ie cr eigenvalu pencil gamma b open right half plane cl one gamma b open left half plane therefor obtain left deflat subspac gamma b z bai j demmel comput right deflat subspac agammab appli idea h gamma b h sinc transpos swap right left space newton iter implicitli appli h b gammah turn converg quadrat matrix z1 use argument comput rank reveal qr decomposit qrrr pi r r h b gammah dl eigenvalu pencil agammab open left half plane dr one gamma b open right half plane note desir spectral decomposit transpos need first comput deflat subspac correspond eigenvalu open left half plane let pi pi antidiagon ident matrix 2 29 30 immedi r h0 h l aqr q h bqr partit 21 22 r h0 h note cl eigenvalu pencil gamma b open left half plane dr eigenvalu pencil gamma b open right half plane therefor homogen sylvest equat solut b 31 32 comput unitari orthogon matric ql qr give desir spectral decomposit 28 2 permut pi avoid use rank reveal ql decomposit matrix sign function comput invari subspac 19 8 close remark paper present number new result approach analyz numer behavior matrix sign function algorithm use comput spectral decomposit nonsymmetr matri ce analysi numer experi conclud spectral decomposit problem ill condit algorithm practic approach solv nonsymmetr eigenvalu problem perform evalu matrix sign function base algorithm parallel distribut memori machin intel delta cm5 report 4 cours work discov new approach essenti comput spectral project matrix matrix sign function approach also use basic matrix oper name matrix multipl qr decomposit howev avoid matrix invers point view accuraci promis approach new approach base work bulgakov godunov malyshev 10 27 28 5 improv result sever import way made truli practic invers free highli parallel algorithm standard gener spectral decomposit problem brief differ matrix sign function invers method follow matrix sign function method significantli faster converg difficult problem invers free algorithm give accur answer matrix sign function algorithm interest reader may see paper 5 detail acknowledg first author support part arpa grant dm28e04120 p95006 via subcontract argonn nation laboratori nsf grant asc9313958 part doe grant defg0394er25219 via subcontract univers california berkeley second author fund part arpa contract daah049510077 univers tennesse subcontract ora745302 arpa contract daal0391c0047 univers tennesse subcontract ora446602 nsf contract asc9313958 asc9404748 contract defg0394er25219 defg0394er25206 doe contract w subcontract 951322401 argonn nation labora tori nsf infrastructur grant no cda8722788 cda9401156 inform present necessarili reflect posit polici govern offici endors infer author would like acknowledg ralph byer chunyang nick higham volker mehrmann fruit discuss subject would also like thank refere valuabl comment manuscript r design parallel nonsymmetr eigenroutin toolbox design parallel nonsymmetr eigenroutin toolbox spectral decomposit nonsymmetr matric distribut memori parallel comput invers free parallel spectral divid conquer algorithm nonsymmetr eigenproblem converg shift qr algorithm 3 3 normal matric reorder diagon block real schur form regular result singular valu transfer matrix quadrat converg algorithm comput l1norm bisect method comput h1 norm transfer matrix relat problem circular dichotomi spectrum matrix solv algebra riccati equat matrix sign function bisect method measur distanc stabl matrix unstabl matric matrix sign function method comput invari subspac stabil radiu gener statespac system simultan newton iter eigenproblem qr algorithm fail converg fix condit number equival transform block diagon matrix pencil condit number distanc nearest illpos problem three method refin estim invari subspac improv accuraci comput eigenvalu eigenvector matrix eigensystem routin eispack guid extens gener matrixsign function solut algebra riccati equat matrix sign decomposit relat polar decomposit perturb theori linear oper polar decomposit matrix sign function condit estim matrix sign function algorithm riccati equa tion guarante accuraci spectral problem linear algebra parallel algorithm solv spectral problem linear algebra condit estim matrix function via schur decomposit linear model reduct solut algebra riccati equat separ matrix eigenvalu structur decomposit largescal system matrix eigensystem routin eispack guid perturb bound subspac associ certain eigenvalu problem matrix perturb theori pseudospectra matric tr ctr daniel kressner block algorithm reorder standard gener schur form acm transact mathemat softwar tom v32 n4 p521532 decemb 2006