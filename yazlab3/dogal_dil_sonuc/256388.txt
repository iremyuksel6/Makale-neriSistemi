timeoptim domainspecif queri enhanc mesh abstractqueri process crucial compon variou applic domain includ inform retriev databas design manag pattern recognit robot vlsi mani applic involv data store matrix satisfi number properti one properti occur time specifi row column matrix independ sort customari refer matrix sort instanc batch search rank problem bsr short involv sort matrix item total order univers along collect q queri q arbitrari mix follow queri type search queri qj one interest item closest qj rank queri qj one interest number item strictli smaller qj bsr problem ask solv queri q work consid bsr problem follow context matrix pretil one item per processor onto enhanc mesh size sqrt ntime sqrt n queri store one per processor first sqrt n column platform main contribut twofold first show algorithm solv bsr problem must take least omega rm maxlognsqrt time worst case second show time lower bound tight mesh size sqrt ntime sqrt n enhanc multipl broadcast exhibit algorithm solv bsr problem theta rm maxlognsqrt time platform b introduct due simpl intuit topolog mesh establish one massiv parallel architectur suitabl solv problem imag process robot vi sion comput graphic path plan vlsi design among mani other time mesh notori ineffici come handl nonspati organ data address problem meshconnect comput enhanc variou type bu system 1 22 25 28 recent power eleg architectur refer mesh multipl broadcast obtain endow row column mesh dedic high speed bu 22 35 mesh multipl broadcast proven feasibl implement vlsi adopt among other dap famili comput 35 theoret interest well commerci avail mesh multipl broadcast attract great deal well deserv attent applic rang imag process 23 35 comput graphic robot 6 34 comput geometri pattern recognit 5 6 9 10 12 22 27 33 sort search 8 11 22 fundament problem 3 7 13 14 found effici solut work support nasa grant nas119858 nsf grant ccr 9407180 ccr9522093 onr grant n000149510779 preliminari version work appear proc intern confer applicationspecif array processor stra bourg franc juli 1995 correspond prof olariu email architectur variant 27 queri process crucial transact variou applic domain includ inform retriev databas design manag vlsi mani applic involv data store matrix satisfi number properti one properti occur time applic specifi row column matrix independ sort 16 21 30 customari refer matrix sort matrix said fulli sort entri sort rowmajor resp columnmajor order figur 1a display sort matrix figur 1b featur fulli sort version matrix figur 1a 3 9 14 26 b fig 1 illustr sort fulli sort matric sort matric provid natur gener number reallif situat consid vector j cartesian sum x denot n theta matrix entri clear x sort store succinctli n space 16 19 sinc entri ij comput need constant time task search rank select sort matric receiv consider attent 16 17 19 20 21 30 main goal paper look problem batch search rank bsr short sort matric throughout work gener instanc bsr problem involv sort matrix size n theta store one item per processor mesh multipl broadcast size n collect q queri store first column platform queri two type queri q j first type one interest item closest q j queri q j second type one interest number item strictli smaller q j two queri type refer search queri rank queri respect set q queri arbitrari mix two queri type goal determin solut everi queri q import note search queri occur frequent imag process pattern recognit comput learn artifici intellig one interest find item databas best match sens queri hand 2 18 36 hand rank queri central relat databas design histogram pattern analysi given collect item databas along queri one interest comput number item databas lesser valu queri addit rank queri find applic imag process ing robot pattern recognit 2 6 18 note variant rank queri also receiv attent literatur specif rang queri involv determin number item given databas fall certain rang easi see rang queri answer state rank queri 18 point reader may wonder queri lie leftmost l column mesh shall discuss section ii assum mesh multipl broadcast commun outsid world via io port place along leftmost column platform consist view 29 enhanc mesh serv fast coprocessor presentday comput scenario host comput pass queri mesh batch n presenc input queri leftmost l column use main contribut twofold first show algorithm solv bsr problem must take least omegagammaast flog n time worst case lower bound hold crewpram mesh multipl broadcast second show bsr problem solv timeoptim mesh multipl broadcast size n theta n exhibit algorithm whose run time match lower bound put contribut perspect note recent bhagavathi et al 9 show task solv search rank queri fulli sort matrix perform theta p time mesh multipl broadcast size p n theta p n actual context fulli sort matric differ two queri type vanish solv essenti way context sort matric search queri rank queri much differ requir differ resolut strategi surpris therefor algorithm bsr problem much complic sophist algorithm 9 order obtain timeoptim algorithm bsr problem develop novel interest clone strategi queri scenario follow partit platform number submesh clone given queri done obtain local solut queri submesh fi nalli sinc number clone queri larg larger avail bandwidth allow handl devis strategi wherebi retriev inform gather clone interest featur strategi alway exist rel small subset clone retriev allow resolut queri consequ algorithm devis paper complet differ 9 show whole potenti mesh multipl broadcast paper organ follow section ii introduc model comput section iii present lower bound argument section iv discuss timeoptim algorithm bsr problem final section v offer conclud remark pose open problem ii comput model mesh multipl broadcast size theta n refer mesh confus possibl consist mn ident simd processor posit rectangular array overlaid highspe bu system everi row mesh processor connect horizont bu similarli everi column processor connect vertic bu illustr figur 2 assum processor first column serv io port illustr way platform commun outsid world fig 2 mesh multipl broadcast size 4 theta 4 processor p j locat row column j 1 northwest corner mesh processor p j local link neighbor 1 provid exist processor assum know coordin within mesh constant number regist size olog mn unit time processor perform arithmet boolean oper commun one neighbor use local link broadcast valu bu read valu specifi bu oper involv handl olog mn bit inform due physic constraint one processor allow broadcast given bu one time contrast processor bu simultan read valu broadcast accord research 3 13 22 23 25 28 35 assum constant broadcast delay although inexact recent experi dap ppa yuppi multiprocessor array system seem indic reason work hypothesi 25 28 35 iii lower bound purpos section establish nontrivi lower bound bsr problem mesh multipl broadcast purpos consid platform size n theta store sort matrix size discuss 1 n queri store first column 1 mesh clearli processor store one item one queri lower bound argument reli part follow fundament result cook et al 15 proposit 31 15 time lower bound comput logic n bit crewpram omegagammas2 n matter mani processor memori cell avail also reli follow result lin et al 26 proposit 32 comput take otn comput step nprocessor mesh multipl broadcast perform otn comput step nprocessor crewpram import note proposit 32 guarante tm n execut time algorithm solv given problem nprocessor mesh multipl broadcast exist crewpram algorithm solv problem tp use n processor extra memori word fast algorithm mesh multipl broadcast impli fast algorithm crewpram observ exploit 26 transfer known comput lower bound crewpram mesh multipl broadcast fig 3 illustr lower bound solv singl queri shall prove even solv singl queri search rank type take n time result prove crewpram port mesh multipl broadcast proposit 32 begin reduc problem problem solv search queri q purpos let arbitrari input construct sort matrix illustr figur 3 place n 1 set ae assum simplic n integ construct guarante matrix sort regardless valu b assign queri q valu 09 easi confirm answer problem 0 solut queri see note sequenc b 1 contain 1 1 return solut queri fail 0 return virtu proposit 31 algorithm correctli answer search queri sort matrix must nomegagamma615 n time crewpram regardless number processor memori cell avail continu reduc problem problem solv rank queri q purpos let arbitrari input construct sort matrix illustr figur 3 let queri q valu 09 clear answer problem 0 number element smaller q exactli n p nto see observ construct everi element matrix upper left triangl strictli smaller queri element may strictli smaller queri lie diagon seen figur 3 reader difficulti verifi total number element strictli smaller q element diagon 0 proposit 31 guarante algorithm correctli answer rank queri sort matrix must takeomegagamma324 n time crewpram virtu proposit 32 follow result lemma 33 algorithm correctli solv one search rank queri sort matrix n element must take least omegagammaast n time mesh multipl broadcast size demonstr everi algorithm solv bsr problem fulli sort matrix must take omegagamma time worst case cours impli lower bound sort matric purpos assum fulli sort matrix store rowmajor order mesh multipl broadcast size n theta n refer element row major order 1 note context fulli sort matric search rank queri solv essenti way specif let q arbitrari queri let subscript q i1 clearli q rank type solut denot number item strictli smaller q hand q search type item closest q either i1 observ allow us handl purpos lower bound type queri rank queri turn impli use follow result prove bhavagathi et al 9 proposit 34 algorithm correctli solv queri fulli sort matrix n element must take time mesh multipl broadcast size n theta n lemma 33 34 combin provid main result section state next theorem 35 algorithm correctli solv instanc bsr problem involv sort matrix item store one per processor collect store one per processor first column mesh multipl broadcast size n theta must take least omegagammaast flog n mg time iv timeoptim bsr algorithm gener instanc bsr problem involv sort matrix size n theta n collect queri queri q j follow type 1 search type determin item closest 2 rank type determin rank q j ie number item strictli smaller q j avoid handl doubl subscript item enumer rowmajor order 1 sort matrix store one item per processor mesh r multipl broadcast size n theta n set q store first column r one queri per processor illustr figur 4 shall view mesh r consist submesh size theta r ij involv processor p r c 1 illustr figur 5 occasion shall find conveni view mesh r consist submesh size theta n consist submesh r i1 submesh refer slice r depict figur 5 fig 4 illustr input bsr problem outlin algorithm bsr problem proce follow three stage stage 1 set q queri replic submesh r ij creat local instanc bsr problem stage 2 determin submesh r ij paral lel solut local instanc bsr problem stage 3 solut local instanc bsr problem obtain stage 2 combin r r 11 slice slice fig 5 illustr partit submesh r ij solut origin bsr problem remaind section devot detail descript stage stage 1 purpos stage replic set q queri submesh r ij one queri per processor plan move queri column r column everi r ij specif queri move column r ij give detail data movement illustr reader refer figur 6ad begin everi processor p n broadcast queri hold horizont diagon processor shown figur 6ab turn processor p r r broadcast queri receiv vertic everi processor shown figur 6bc fig 6 illustr data movement stage 1 note result data movement queri origin store column k r replic diagon processor submesh everi slice slice process parallel specif queri store diagon processor r i1 replic use row buse slice th column r ij slice next queri store diagon processor r i2 replic use row buse slice th column r ij illustr refer figur 6d easi see task replic queri origin store one column r take time therefor long n queri initi store leftmost column r replic time case queri replic way similar one de scribe complex data movement goal stage 1 achiev queri replic submesh r ij thu prove follow result lemma 41 set q queri initi store first column r replic one queri per processor submesh r ij time stage 2 import note end stage 1 replic set q queri submesh r ij fact partit origin instanc bsr problem sever instanc local r ij local instanc involv subset store processor r ij entir set q queri main goal stage solv local instanc bsr submesh r ij avoid broadcast conflict stage 2 bu system ignor everi submesh r ij act unenhanc mesh begin sort item queri r ij rowmajor order use optim sort algorithm mesh 31 note sort process tie broken favor queri word queri item equal sort version queri preced item let c 2m result sort sequenc store two item per processor submesh r ij follow two result justifi approach solv local instanc bsr problem lemma 42 let q k queri rank type assum c word q k occur posit sort sequenc c ij number item r ij strictli smaller q k equal number item preced q k c ij proof follow directli sorted c ij along assum tiebreak disciplin lemma 42 motiv follow strategi solv rank type queri r ij assign everi c weight defin follow ae item queri 1 next comput prefix sum sequenc use weight assign 1 2m result virtu lemma 42 valu e correspond c exactli number item r ij strictli smaller q k therefor rank queri solv time sort prefix sum comput p 31 32 task handl search queri requir differ approach motiv strategi consid sort sequenc c refer figur 7 item queri l 1 l 3 l 4 fig 7 illustr sort sequenc c ij queri occur c ij form contigu subsequ everi sequenc p let l p r p stand respect leftmost rightmost queri p illustr figur 7 cours sequenc p consist one queri l 2m motiv terminolog becom clear observ lemma 43 search queri sequenc p solut either c ffgamma1 c fi1 proof let q k arbitrari search queri sequenc p sorted c ij along tiebreak disciplin guarante item r ij closer q k one item c ffgamma1 c fi1 turn lemma 43 suggest follow approach solv search queri r ij first assign everi c weight w defin follow ae c c item queri 2 next comput prefix maxima sequenc use weight assign 2 2m result easi confirm everi search queri c correspond valu e exactli ident item c ffgamma1 previou terminolog gamma1 item exist next assign everi c weight w ae c c item queri 3 comput prefix minima sequenc use weight assign 3 let 2m result easi confirm everi search queri c correspond valu e exactli ident item c fi1 previou terminolog 1 item exist therefor end two comput everi search queri q k becom awar c ffgamma1 c fi1 virtu lemma 43 suffici purpos determin solut everi search queri q k r ij summar find state follow result lemma 44 task solv local instanc bsr problem submesh r ij perform parallel time stage 3 end stage 2 processor gener submesh r ij store along queri q k local solut case q k search queri oei j denot item closest q k case q k rank queri oei j denot number item strictli smaller q k goal stage 3 combin local solut solut q k origin instanc bsr problem fig 8 illustr proof lemma 45 prepar first task stage arrang everi submesh r ij order pair rowmajor order sort subscript k recal use optim sort algorithm mesh 31 task perform time note sort tupl q occupi rel posit submesh r ij process reli heavili technic properti sort matric discuss next refer figur 8 submesh r ij said critic respect queri q k q k larger entri v northwest corner r ij greater entri b v southeast corner r ij word follow result key deriv timeoptim algorithm bsr problem lemma 45 submesh r ij critic respect queri q k one submesh r igamma1j r ij1 may critic respect q k proof refer figur 8 let u v aw stand item store northwest corner respect similarli let b b w stand item store southeast corner r igamma1j r ij r ij1 respect assum r ij critic respect queri q k r igamma1j critic respect q k sinc matrix sort 5 6 combin guarante 4 r ij1 critic respect q k similarli r ij1 critic respect q k sinc matrix sort 7 8 combin guarante confirm virtu 4 r igamma1j critic respect q k complet proof lemma 45 r fig 9 illustr concept activ copi queri q k consid gener slice refer shall call copi queri q k submesh r ij activ one condit a1a4 satisfi refer reader figur 9 illustr r ij critic respect queri q k a2 slice contain critic submesh respect queri q k larger item r ij smaller equal item r ij1 larger item slice case copi q k r activ smaller equal item slice case copi q k r i1 activ leftmost submesh slice contain activ copi queri q k refer lead respect point reader may wonder inform comput clear determin submesh r ij critic respect given queri inform need valu northwest southeast corner submesh time valu circul within submesh everi processor becom awar next everi processor r ij need inform valu item northwest southeast corner neighbor submesh slice inform obtain time obviou way inform avail critic submesh activ copi queri found constant time fig 10 illustr assign buse strategi combin solut queri everi r ij global solut involv consider amount data movement restrict run time theta plan use buse support data movement lemma 45 motiv us assign buse activ copi queri accord follow rule illustr figur 10 r1 copi q k belong lead submesh slice assign horizont bu row r2 remain activ copi q k assign vertic bu column follow result show rule r1 r2 lead conflictfre broadcast lemma 46 everi activ copi q k broadcast simultan assign bu broadcast conflict aris proof first claim broadcast conflict occur horizont buse see note horizont bu assign copi q k either exist one activ copi q k slice case copi q k lead submesh activ rule a2a4 copi q k attempt use bu els copi come critic submesh rule r2 activ copi slice use vertic buse conflict aris next show conflict aris vertic buse suppos contrari let largest subscript broadcast conflict occur copi q k slice broadcast vertic assign bu without loss gener assum q k belong r ij1 conclus lemma 45 along maxim impli copi q k submesh r igamma1j1 also use vertic bu impli neither r igamma1j1 r ij1 lead submesh respect q k slice igamma1 respect howev r igamma1j r ij r ij1 must critic respect q k contradict lemma 45 import note total number activ copi queri q k 2 follow immedi lemma 46 sinc assign buse activ copi q k lead two copi use bu sinc copi q k assign horizont buse copi q k assign vertic buse conclus follow next one may wonder activ copi queri q k carri enough inform yield correct overal solut q k answer natur question provid follow result lemma 47 let q k search queri let item closest q k exist activ copi q k submesh r ij either oei j proof assumpt must solut oep q q k submesh r pq fact sinc item matrix necessarili distinct possibl solut q k number submesh assum without loss gener case submesh slice specif let r ij leftmost submesh oei j k copi q k r ij activ noth prove shall therefor assum copi q k r ij inact propos show least one copi q k r ij gamma1 r ij1 activ sinc copi q k r ij inact 4 guarante r ij critic respect q k therefor v b v denot respect item northwest southeast corner r ij notic oei j along 9 impli must either v b v symmetri allow us assum without loss gener v turn impli notic 10 along fact copi q k r ij inact guarante virtu a4 j 6 1 thu r ij must exist let u b u respect item northwest southeast corner r ij gamma1 r ij leftmost submesh sinc matrix sort must moreov q k b u otherwis a2 combin would guarante copi q k r ij must activ therefor must case howev equat 4 11 12 combin impli copi q k r ij gamma1 must activ desir complet proof lemma 47 lemma 47 suggest obviou way updat solut activ copi search queri q k spell detail follow ffl activ copi q k belong critic submesh r ij r ij gamma1 critic copi q k r ij updat solut oei j combin ffl activ copi q k belong critic submesh r ij r ij1 critic copi q k r ij updat solut oei j combin ffl copi q k activ rule a2 updat solut oei j combin lemma 48 let q k rank queri activ copi q k gener slice carri enough inform comput number item strictli smaller q k proof first copi q k slice activ sum local solut oei j exactli number item strictli smaller q k assum therefor copi q k slice activ consid activ copi q k lead submesh respect q k ffl copi activ rule a4 solut must 0 correct number item strictli smaller q k ffl copi activ rule a3 solut updat read mn correct number item strictli smaller q k ffl copi activ rule a1 a2 solut updat read oei correct number item strictli smaller q k submesh r i1 import note solut activ copi q k chang updat thu requir updat collect activ copi q k slice carri enough inform correctli comput number item smaller q k conclus follow r r 11 fig 11 illustr target data movement stage 3 next task stage 3 move activ copi queri diagon submesh r ii 1 illustr figur 11 task perform two broadcast round follow first round proceed row row submesh r ij specif activ copi queri first row r ij assign vertic buse broadcast local solut bu correspond processor diagon submesh r jj follow queri second row broadcast vertic lemma 46 broadcast conflict aris sinc everi r ij row first round take p time second broadcast round involv broadcast along horizont buse time column everi r ij handl one one sinc column submesh second round take time note ever illustr figur 12 possibl two activ copi queri q k sent locat diagon submesh r jj one copi via horizont bu one via vertic bu lemma 46 number copi restrict two fur thermor one arriv one broadcast round vertic buse second arriv horizont buse processor receiv proceed combin respect solut summar state follow result fig 12 illustr combin solut lemma 49 solut activ copi queri q broadcast diagon submesh r ii one per processor time complet algorithm variou copi queri q move diagon submesh collect combin idea move activ copi queri diagon submesh r ii one sever adjac row origin mesh specif case p copi first move first row mesh copi second group move second row mesh hand case copi q 1 move first row mesh per row data movement case similar discuss next prepar data movement need introduc terminolog consid gener copi queri q k associ q k quantiti rq k cq k refer rvalu cvalu q k rq k ident row mesh copi navig cq k rel posit queri among copi move row rq k note processor store q k comput rq k cq k o1 time recal begin stage 3 everi submesh r ij queri sort rowmajor order thu solut store diagon submesh r ii rel order use vertic buse copi queri first row everi submesh r ii move row mesh correspond rvalu specif gener copi queri q k store processor p broadcast vertic processor p rq k j crucial note queri also sort rowmajor order rvalu broadcast conflict aris proceed sequenti p row r ii process describ thu p time copi broadcast row mesh correspond rvalu import observ processor receiv one copi queri data movement process take place row mesh depend whether 13 14 hold first assum 13 true shall detail process take place first row mesh action perform parallel row copi q 1 broadcast processor p 1 1 order cvalu upon receiv next copi q 1 p 1 1 combin correspond solut obviou way sinc copi q 1 solut queri q 1 obtain time copi remain queri q move row 1 process similarli therefor overal time need solv queri case 13 hold bound case 14 hold recal copi given queri spread row mesh discuss process queri q 1 other han dled parallel perfectli similar way copi q 1 move row copi row proceed sequenti order c valu copi q 1 first row broadcast leftmost processor row processor respons combin solut describ lemma 47 48 end inform need solv queri store processor first column mesh specif processor solut correspond queri q 1 next group processor contain partial solut correspond queri refer figur 13 illustr final consid diagon submesh size theta illustr figur 14 final step stage 3 dedic diagon submesh solv queri q one broadcast partial result store processor first column mesh move along horizont buse first column depict figur 13 combin partial solut queri q 1 fig 13 partial solut contain processor first column fig 14 illustr submesh amount semigroup comput local use result olariu et al 33 comput perform olog final solut queri comput routin matter move back first column mesh consequ case 14 hold overal run time algorithm bound log sinc 16 run time algorithm case 14 hold satisfi log summar state follow result theorem 410 arbitrari instanc bsr problem involv sort matrix size n theta n set queri solv omaxflog n mg time mesh multipl broadcast size thermor timeoptim architectur v conclud remark open problem matrix said sort row column independ sort instanc batch search rank problem bsr short involv sort matrix item total order univers along collect q queri q arbitrari mix follow queri type search queri q j one interest item closest q j rank queri q j one interest number item strictli smaller q j bsr problem ask solv queri q work consid bsr problem matrix pretil one item per processor onto mesh multipl broadcast size n theta n queri store one per processor first column platform main contribut twofold ffl first prove algorithm correctli solv bsr problem must take least omegagammaea flog n time worst case ffl second show time lower bound tight mesh multipl broadcast size n theta n develop novel interest clone strategi queri partit platform number interest featur clone strategi support sorted matrix alway small set clone retriev allow obtain overal solut queri visibl clone strategi perfectli gener interest direct research see dataset strategi work yet anoth direct see practic applic benefit strategi acknowledg author wish express appreci three anonym refere except thorough review job r optim bound find maximum array processor k global buse comput vision squar mesh alway optim design massiv parallel processor squar mesh optim convex hull computa tion unifi look semigroup comput mesh multipl broad cast fast select algorithm mesh multipl broadcast squar mesh optim convex hull compu tation design effici parallel algorithm mesh connect comput multipl broadcast effici median find applic twovari linear program meshconnect comput multipl broadcast upper lower time bound parallel random access machin without simultan write complex search x parallel algorithm search x pattern classif scene analysi parallel search sort multiset gener select rank sort matric commun acm array processor multipl broadcast imag comput mesh multipl broadcast sort x ieee transact comput parallel process letter effici vlsi architectur digit geometri ieee transact parallel distribut system channel rout vlsi biton sort meshconnect parallel comput data broadcast simd comput optim convex hull algorithm enhanc mesh amt dap 500 imag databas system survey tr ctr susumu matsuma nobuki tokura effici selfsimul algorithm reconfigur mesh proceed twelfth annual acm symposium parallel algorithm architectur p216223 juli 0913 2000 bar harbor main unit state dharmavani bhagavathi himabindu gurla stephan olariu larri wilson jame l schwing jingyuan zhang time vlsioptim sort enhanc mesh ieee transact parallel distribut system v9 n10 p929937 octob 1998 r lin olariu j l schwing bf wang mesh hybrid buse effici parallel architectur digit geometri ieee transact parallel distribut system v10 n3 p266280 march 1999