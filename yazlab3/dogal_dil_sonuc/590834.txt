multipl adapt agent tactic drive recent research autom highway system rang lowlevel visionbas control highlevel routeguid softwar howev current system tacticallevel reason system address task pass car make exit time merg traffic stream mani previou approach attempt hand construct larg rulebas system captur interact multipl input sensor dynam potenti conflict subgoal chang roadway condit howev system extrem difficult design due larg number rule manual tune paramet within rule complex interact rule approach intermediatelevel plan system consist collect autonom agent special particular aspect tactic drive agent examin subset intellig vehicl sensor independ recommend drive decis base local assess tactic situat distribut framework allow differ reason agent implement use differ algorithmswhen use collect agent solv singl task vital care consid interact agent sinc reason object contain sever intern paramet manual find valu paramet account agent possibl interact tediou errorpron task system paramet system overal depend agent automat tune use novel evolutionari optim strategi term populationbas increment learn pbilour system employ multipl automat train agent compet drive vehicl term userdefin evalu metric measur behavior sever drive situat cull reallif experi articl describ method multipl agent integr appli autom highway system domain howev also gener mani complex robot task multipl interact modul must simultan configur without individu modul feedback b introduct task drive character consist three level strateg tactic oper 13 highest strateg level rout plan goal determin intermedi tactic level maneuv select achiev shortterm object decid whether pass block vehicl lowest oper level maneuv translat control oper mobil robot research success address three level differ degre strategiclevel planner 18 24 advanc research project commerci product oper level investig mani decad result system rang semiautonom vehicl control 7 11 autonom drive varieti situat 4 15 substanti progress autonom navig simul domain also report recent year 17 3 16 howev decis requir tactic level difficult gener solut remain elus consid situat depict figur 1 car comput control approach desir exit come upon slow move blocker car b lane car tactic reason system must determin whether pass car b risk miss exit obvious correct decis depend number factor distanc exit car desir veloc densiti speed surround traffic scenario particular relev intellig vehicl oper mixedtraff en viron environ comput humancontrol car share roadway tactic decis must made without reli communicationbas protocol shortterm plan problem challeng realtim decis must made base incomplet noisi inform state world furthermor penalti bad decis sever sinc error judgment may result highspe collis sapient describ section 3 tactic reason system design drive intellig hicl carnegi mellon navlab 23 mixedtraff environ sapient decis made collect independ agent term reason agent special particular aspect tactic drive task articl focus agent automat configur optim user specifi evalu function use novel evolutionari algorithm term popul base increment learn pbil articl organ follow section 2 present simul highway environ use train sapient agent section 3 detail sapient architectur describ reason agent vote languag section 4 introduc pbil explain encod scheme use repres agent paramet subsequ section present result smallscal tactic scenario one shown figur 1 larger highway configur final section 8 summar research outlin area research goal fig 1 exampl tacticallevel reason car approach desir exit behind slow vehicl b car attempt pass agent tactic drive 3 fig 2 shiva design simul tool develop intellig vehicl algorithm 2 shiva simul simul essenti develop intellig vehicl system test new algorithm real traffic expens riski potenti disastr shiva 1 simul highway intellig vehicl algorithm 22 21 kinemat microsimul vehicl move interact userdefin stretch roadway model element tactic drive domain use intellig vehicl design vehicl equip simul human driver well sensor algorithm autom control algorithm direct vehi cle motion simul command acceler brake steer wheel shiva user interfac provid facil visual specifi interact vehicl see figur 2 intern structur simul comprehens cover 22 detail design tool may found 21 simul vehicl compos three subsystem percept cognit control percept subsystem consist suit simul function sensor eg global posit system rangesensor lanetrack whose output similar real percept modul implement navlab vehicl simul vehicl use sensor obtain inform road geometri surround traffic vehicl may control sensor directli scan pan sensor need encourag activ percept sensor also model occlus nois forc cognit routin realist input assumpt varieti cognit modul develop shiva articl discuss two type rulebas reason sapient rulebas reason system manual design implement monolith decis tree consist collect tactic drive rule initi left lane chang vehicl ahead move slower fv ms closer hv lane left mark legal travel 4 sukthankar baluja hancock vehicl lane within gv meter desir rightexit fv desir car follow veloc hv desir car follow distanc head way gv requir gap size enter adjac lane ex v distanc threshold exit base current lane distanc exit veloc system perform well mani scenario suffer four disadvan tage 1 exampl illustr realist rule requir design account mani fac tor 2 modif rule difficult sinc small chang desir behavior requir mani nonloc modif handcod rule perform poorli unanticip situat implement new featur requir one consid exponenti number interact exist rule similar problem report cremer et al 3 monolith statemachin implement scenario control sapient distribut architectur discuss next sec tion develop address problem control subsystem compat control avail carnegi mellon navlab ii robot testb vehicl command control issu cognit modul rate 10 hz 3 sapient sapient situat awar planner implement effect navig traffic 20 consist collect independ modul term reason agent expert specif aspect tactic drive task agent assign monitor relev physic entiti environ respons assess repercuss entiti intellig vehicl upcom action see figur 3 exampl reason agent associ vehicl ahead monitor motion vehicl determin whether continu car follow initi lane chang begin brak ing similarli reason agent associ upcom exit concern recommend lane chang speed chang need success maneuv intellig vehicl offramp 31 system overview sapient architectur shown figur 4 percept modul depict ellips connect intellig vehicl sensor perform function lane track vehicl detect wherev possibl correspond exist system avail carnegi mellon navlab eg lane tracker base alvinn 15 reason agent shown dark rectangl obtain inform situat one two percept modul independ calcul util variou cours action inform sent vote arbit integr recommend select appropri respons final tactic action translat steer veloc command execut operationallevel control seen figur 4 reason agent classifi class base area spe cializ sapient looselycoupl architectur allow new class develop without modifi exist reason agent current implement span follow tactic level aspect ffl road properti local geometri legal lane speed limit etc ffl nearbi vehicl size posit veloci tie ffl exit distanc exit lane speed constraint ffl selfstat current veloc later posit explicit goal reason agent track associ physic entiti attribut monitor appropri sensor exampl reason agent associ nearbi vehicl normal track longitudin posit veloc later posit map road coordin track two import implic first allow reason agent obtain better estim relev attribut second reason agent accumul statist help influenc decis instanc base ir agent tactic drive 5 front vehicl tracker region interest exit finder veloc prefer reason agent exit reason agent lane reason agent vehicl reason agent fig 3 sapient reason agent associ relev physic entiti environ situat intellig vehicl follow car approach desir exit regular lanekeep perform nearbi vehicl indic inexperienc intox driver reason agent associ vehicl could favor action maintain greater distanc vehicl thu sapient pure reactiv system local state associ reason agent allow sapient make decis base past tori relev histori maintain agent extern reason agent share similar structur agent accept input subset intellig vehicl percept modul send output vote arbit set vote entir action space see section 32 intern howev sapient reason agent heterogen maintain local state use represent applic assign subtask ex ampl reason agent respons exit manag rulebas reason agent monitor vehicl use gener potenti field 9 10 differ reason agent type associ algorithm detail 20 reason agent myopic outlook exampl exit reason ob ject vote influenc presenc block vehicl convers reason agent associ block vehicl oblivi exit final arbit complet ignor drive task yet combin local reason scheme lead distribut awar tacticallevel situat discuss knowledgefre arbit combin local view tactic drive task closer look action space warrant 32 action tactic maneuv lane chang compos concaten sever basic action reason agent indic prefer basic action assign vote action magnitud vote correspond intens prefer sign indic approv disapprov reason agent must assign vote everi action action space action veloc longitudin laneoffset later compon exam ple brake hard chang left increas speed maintain current lane posit sinc differ reason agent return differ recommend next action conflict must resolv sapient use vote arbit perform integr time step reason agent synchron submit vote veto action action space see tabl 1 arbitr vote given action sum togeth 6 sukthankar baluja hancock oper control lane tracker exit finder car detect modul percept cognit control vote arbit veloc agent lane agent exit agent front left car agent front right car agent back right car agent back left car agent hysteresi agent front car agent fig 4 sapient consist collect reason agent recommend action base upon local consider reason agent monitor subset vehicl sensor vote upon set possibl action hysteresi reason agent respons maintain consist time especi case multipl action equal advantag done vote favor action select previou time step action fusion perform domainindepend vote arbit tabl 1 action space 3 theta 3 discret laterallongitudin space label translat oper level specif number thu left right map later posit eg move leftright 01 lane acceler deceler map chang veloc eg speed upslow 01 ms accelerateshiftleft acceleratestraight accelerateshiftright coastshiftleft coaststraight coastshiftright decelerateshiftleft deceleratestraight decelerateshiftright scale reason agent influenc weight action accumul vote veto agent execut action use implement describ articl summar tabl 1 finer discret altern action space discuss 20 although action space restrict reason object vote adjac lane reason agent intern plan longerrang cours action exampl exit agent vote lane chang toward exit even exit sever lane away agent tactic drive 7 car follow extern exit weight extern bit paramet 3 desir exit intern car follow intern 011 010100101110 101 fig 5 threebit encod scheme use repres paramet search space intern paramet linearli scale extern one exponenti scale 33 paramet differ reason agent use differ intern al gorithm reason agent output depend varieti intern paramet eg thresh old gain etc go arbit agent output scale influenc weight extern paramet new reason agent impl ment difficult determin whether hicl poor perform attribut bad choic paramet new agent bug logic new reason agent serious poor represent scheme inadequ configur reason agent overcom difficulti implement method automat configur paramet space total twenti paramet intern extern select test describ paramet discret eight valu repres threebit string intern paramet whose valu expect remain within certain small rang select linear map three bit string repres integ 0 7 extern paramet use exponenti represent threebit string map eight valu rang 0 128 latter represent increas rang possibl weight cost sacrif resolut higher magnitud represent bit per paramet would allow finer tune increas train time encod illustr figur 5 next section describ evolutionari algorithm use learn task 4 populationbas increment learn populationbas increment learn pbil combin genet algorithm ga 8 competit learn 1 2 pbil algorithm attempt explicitli maintain statist search space use direct ex plorat object algorithm creat real valu probabl vector sampl reveal high qualiti solut vector high probabl full algorithm present figur 6 initi element pbil probabl vector initi 05 sampl vector yield random solut vector zero one gener equal probabl bit posit train progress valu probabl vector gradual shift repres high evalu solut vector follow process number solut vector gener base upon probabl specifi probabl vector probabl vector push toward gener solut vector highest evalu probabl vector updat new set solut vector produc sampl updat probabl vector cycl continu search progress entri probabl vector move away initi set 05 toward either 00 10 best solut ever gener run return final solut note algorithm return best solut gener run converg probabl vector prerequisit success algorithm 8 sukthankar baluja hancock length termin condit gener sampl sampl bestvector findvectorwithbestevalu samplevector evalu updat probabl vector toward best solut length mutat probabl vector length random 01 mutprob random 01 05 mutatedirect els mutatedirect 0 mutatedirect mutshift return best solut found run user defin constant valu use studi sampl number vector gener updat probabl vector 100 lr learn rate fast exploit search perform 01 length number bit gener vector 3 20 mutprob probabl mutat occur posit 002 mutshift amount mutat alter valu bit posit 005 fig 6 pbil algorithm use train sapient reason agent paramet explicit preserv best solut previou gener elitist select shown howev empir probabl vector converg run conduct probabilist gener solut vector guarante creation good solut vector everi iter problem exacerb small popul size use experi therefor order avoid move toward unproduct area search space best vector previou popul includ current popul replac worst member current popul ga literatur term elitist select 8 sinc space limit preclud complet discuss relationship ga pbil provid brief intuit divers popul crucial ga maintain popul solut ga abl theori least maintain sampl mani differ region genet algorithm crossov use merg differ solu tion howev popul converg crossov depriv divers need effect search oper hap pen crossov begin behav like mutat oper sensit converg valu bit individu popul converg bit posit crossov leav bit unalt bit posit individu converg crossov effect mutat valu posit therefor crossov creat new individu differ individu combin bit posit mate individu disagre analog pbil creat new trial solut differ mainli bit posit prior good perform disagre detail found 1 applic challeng pbil number way first sinc vehicl decis depend behavior vehicl agent tactic drive 9 control simul produc differ evalu bit string evalu set vehicl paramet multipl time compens stochast natur envi ronment second pbil algorithm never expos possibl traffic situat thu make imposs estim true perform pbil string third sinc evalu take consider time simul minim total number train evalu import 5 train specif test describ perform track shown figur 8 known shiva cyclotron configur resembl real highway sever benefit testb 1 topolog ident highway equal space exit 2 take nth exit equival travel n lap cours one creat challeng traffic interact entri exit merg small number vehicl train scenario initi one sapientpbil vehicl eight rulebas car handcraft decis tree sapient car direct take second exit car goal zero five lap whenev total number vehicl track drop nine new vehicl inject entri ramp maintain desir traffic densiti one sapient vehicl permit cours time start run pbil algorithm suggest candid bitstr convert sapient paramet instanti simul vehicl evalu pbil paramet string requir one run simul hicl end vehicl run score receiv sent pbil evalu candid bitstr note popul size pbil affect number evalu requir gener pbil algorithm popul size correspond number sapient vehicl present track sinc candid vehicl independ evalu state earlier one sapient vehicl permit track time whenev sapient vehicl left scenario upon take exit crash 10 time evalu comput base statist collect run score use pbil algorithm updat probabl vector thu creat better sapient agent next gener definit good drive larg subject follow characterist strongli correl bad drive 1 collis take wrong exit 3 deviat desir speed weav poor lane track mani possibl evalu function could construct characterist evalu function combin simpl weight sum maxim gamma1000 theta numcrash gamma500 theta ifwrongexit gamma002 theta speeddevi gamma002 theta lanedevi disttravel allveto indic sapient vehicl object action good param eter never happen numcrash number collis involv sapient vehicl ifwrongexit flag true sapient vehicl exit prema ture otherwis miss design exit speeddevi differ desir actual veloc integr entir run lanedevi deviat center lane integr entir run disttravel longitudin distanc cover vehicl meter increment reward partial complet evalu function reason measur perform import note case good driver becom involv unavoid accid con vers favor circumst may enabl bad vehicl score well easi scenario minim effect case test candid string popul set four sce nario addit traffic test case clude patholog situat broken vehicl obstruct one lane 6 train perform seri experi use varieti pbil popul size evalu function initi condit detail individu experi present next section section focus evalu metric train algorithm figur 7 show result train run evalu function describ earlier pbil popul size 100 3d histogram display distribut score gener clear paramet evolv success gener averag perform sapient vehicl increas varianc evalu within gener de creas experi popul size 100 good perform vehicl popul achiev earli fifth gener although consist good evalu observ gener 15 number vehicl score poor evalu drop rapidli gener 10 occasion low score pbil string converg stabl set sapient paramet last gen erat major vehicl abl take proper exit avoid crash sce nario result experi differ popul size similar figur 8 show scenario cyclotron track scenario patholog contain mani brokendown vehicl scatter roadway trace show train sapient vehicl success navig cours avoid obstacl describ overal perform sapient vehicl term global evalu function examin individu compon score metric improv time three observ quantiti play signific role sapient train evalu function total number nearcollis fi whether vehicl made exit distanc travel intellig vehicl sce nario thu given popul sapient vehicl quantiti vehicl v popula tion reflect good popul three graph figur 9 show k b z chang success gener pbil popul contain 40 vehicl vehicl evalu four differ scenario graph show ffl number nearcollis k drop steadili pbil tune sapient reason agent paramet final gener none vehicl popul involv nearcollis entir set four scenario ffl fraction vehicl popul miss exit also decreas steadili time sapient vehicl learn zero final gener ffl third quantiti z reflect increment improv perform vehicl train seen earli vehicl elimin scenario ei ther timeout take wrong exit crash travel far time vehicl abl travel greater distanc note z upper bound greater distanc desir exit investig robust train method two addit set experi perform coeffici evalu function perturb first set six experi conduct experi ment one coeffici multipli 10 result shown figur 10 11 somewhat surprisingli sapient reason agent gener perturb evalu function still success hypothes two reason 1 tacticallevel subtask close link quit like vehicl make correct exit also learn avoid collis otherwis would elimin collis earlier track 2 although pbil respons set intern extern paramet reason agent underli algorithm predefin thu small perturb reason agent paramet caus catastroph failur system agent tactic drive 11 5000 evaluation1030generation2060numb car 5000 evalu fig 7 3d histogram show increas highscor pbil string success gener popul size 100 car gener fig 8 patholog scenario cyclotron track 15 obstacl trace show sapient vehicl success navig cours avoid obstacl second set experi explor limit robust time coeffici perturb factor 1000 tend creat bad car gener coeffici even multipli 1000 still nearcrash gener exit miss gener b60000100000140000180000 distanc cover gener z fig 9 graph show number nearcollis k number missedexit b distanc travel z popul learn sapient vehicl vari success gener test popul size set 40 vehicl evalu four scenario graph show accumul statist vehicl given gener four scenario note k z decreas zero z increment reward rise agent tactic drive 13501502500 nearcrash gener nearcrash gener nearcrash gener nearcrash gener fig 10 graph show sapient paramet learn pbil converg compet vehicl despit variat evalu function use graph show total number nearcollis k popul exit miss gener exit miss gener exit miss gener exit miss gener fig 11 graph show sapient paramet learn pbil converg compet vehicl despit variat evalu function use graph show total number miss exit b popul agent tactic drive 15 fig 12 scenario test tactic reason system overtak slowermov vehicl later posit lane unit time 01 sec interv mono veloc msec time 01 sec interv mono poli fig 13 later displac left veloc right function time rulebas denot mono sapient denot poli vehicl overtak scenario see figur 12 see text discuss graph gener compet vehicl exampl increas penalti collis 1000 1000000 affect vehicl sinc learn avoid collis contrast radic increas penalti speed deviat similar manner lead vehicl will collid other desper effort avoid penalti incur drop target veloc 7 scenariobas evalu tactic drive scenario wide use drive research evalu perform human subject 12 14 similar techniqu also use measur situat awar domain 6 5 19 use microscenario examin perform sapient reason agent situat tacticallevel decis requir comprehens discuss scenario avail 20 follow scenario focu vehicl mark respect dia gram sapient perform compar behavior default rulebas vehicl accompani graph monolith hand code rulebas vehicl denot mono multiag adapt sapient system mark poli emphas sapient vehicl expos tactic scenario train us ing pbil exclus obstacl cours cyclotron environ first scenario see figur 12 involv simpl overtak maneuv common occurr highway initi vehicl move normal highway speed lead vehicl begin brake approach exit exampl traffic car safe overtak seen later displac veloc profil see figur 13 type cognit modul abl solv l3203040fig 14 exit scenario add complex tactic drive domain introduc addit strategiclevel goal conflict two strategiclevel goal lead interest tactic later posit lane unit time 01 sec interv mono veloc msec time 01 sec interv mono poli fig 15 later displac left veloc right function time rulebas sapient vehicl exit scenario see figur 14 see text discuss graph scenario success howev note sapient vehicl aggress maintain smaller headway maneuv handtun rulebas vehicl sapient reason agent respons car follow tune gener potenti field rel vehicl base timetoimpact metric oppos use constant headway notabl featur oscil rulebas vehicl veloc profil caus combin two factor discret veloc control brittl carfollow rule note sapient vehicl perfectli center pass lane overtak maneuv potenti field surround obstacl vote addit space sinc suffici space target lane sapient vehicl abl drive offcent behavior also observ scenario second scenario see figur 14 introduc second possibl conflict strateg goal take exit also ambient traffic introduc vehicl must chang lane make desir exit without collid car figur 15 show interest differ drive behav ior rulebas car slow find gap exit lane chang lane contrast sapient speed overtak vehicl exit lane maneuv allow maintain desir speed make exit final scenario shown figur 16 ident one discuss introduct recal car may take desir exit either stay behind slow blocker pass unlik situat shown figur 14 chang agent tactic drive 17 goal l2203040fig 16 exit scenario difficult lane chang option address strategiclevel goal maintain speed intellig vehicl must decid whether attempt overtak maneuv risk miss desir exit162242832 later posit lane unit time 01 sec interv mono veloc msec time 01 sec interv mono poli fig 17 later displac left veloc right function time rulebas sapient vehicl difficult exit scenario see figur 16 ing lane mandatori fact car decid pass complet two lane chang exit two differ vehicl type choos differ rulebas vehicl opt stay lane base sole rule depend distanc exit hand sapient vehicl choos overtak blocker final set experi vehicl inject initi empti cyclotron track onramp regular interv vehicl given two strategiclevel goal 1 make exactli one circuit track exit 2 maintain speed inject whenev possibl aim experi see two tactic drive system rule base sapient would behav roadway becam congest three set experi differ traffic configur perform allrulebas car allsapi car uniform mix rulebas sapient car expect number vehicl roadway increas rate vehicl enter track equal rate vehicl leav either vehicl success complet circuit vehicl unabl merg traffic stream low rate traffic flow eg 6 second three traffic configur safe negoti scenario miss exit howev traffic flow increas behavior three traffic configur diverg car track time sec mono poli fig 18 graph show number vehicl cyclotron vari function time heavi traffic traffic inject rate car note six rulebas vehicl abl merg onto cyclotron loop contrast sapient vehicl abl merg complet scenario graph figur show number vehicl vari function time second allrulebas allsapi case even heavi traffic neither pure traffic type collis although type vehicl perform well initi roadway clear number vehicl track increas 6 conserv rulebas driver unabl merg traffic stream sinc requir guarante headway two second side gap thu unabl chang lane exit scenario prematur make matter wors rulebas vehicl alreadi roadway becom trap inner loop cyclotron due high rate traffic entryexit lane allsapi traffic hand abl drive success probabl attribut two factor 1 aggress drive style reli timetoimpact reason agent will merg smaller gap 2 distribut reason system better make tradeoff neg vote merg potenti unsaf gap toler sinc altern miss exit seen wors brittl decis tree use rulebas car hand reject gap outright interleav rulebas sapient car heavi traffic scenario lead stabl heterogen behavior collis aggress sapient vehicl still miss fewer exit even rulebas vehicl perform better purerulebas case reduc congest may posit implic deploy autom vehicl mix traffic condit 8 conclus futur direct experi demonstr 1 potenti intellig behavior tactic drive domain use set distribut reason agent 2 abil evolutionari algorithm automat configur collect modul address combin task evalu section compar sapi ent perform rulebas vehicl result taken context clearli possibl encod sapient current knowledg form rule creat compet rulebas vehicl differ agent tactic drive 19 creat monolith rulebas vehicl much difficult task due interact larg number rule manual tune paramet within rule complex interact rule studi use simpl evalu func tion introduc altern object func tion plan extend studi least two direct first autom highway would like car exhibit altruist havior collect pbil vehicl optim share evalu function highway may encourag cooper second develop reason agent address addit complic aris vehicl deploy real world complex vehicl dynam noisi sensor system employ multipl automat train agent compet drive hicl term userdefin evalu metric measur behavior sever drive situat cull reallif exp rienc articl describ method multipl agent integr appli autom highway system domain howev also gener mani complex robot task multipl interact modul must simultan configur without individu modul feedback 9 acknowledg author would like acknowledg valuabl discuss dean pomerleau chuck thorp help shape work thank also gita sukthankar data process script graph research partial support autom highway system project agreement dtfh6194x00001 start shumeet baluja support graduat student fellowship nasa administ lyndon b johnson space center view conclus contain document author interpret repres offici polici either express impli ah consortium nasa note 1 inform interact demo avail httpwwwcscmuedurahulsshivahtml r remov genet standard genet algorithm softwar architectur scenario control iowa drive simul curvaturebas scheme improv road vehicl guidanc comput vision toward theori situat awar automat car control electron highway genet algorithm search gener potenti field approach obstacl avoid control integr path plan dynam steer control autonom vehi cle driver educ task analysi volum critic view driver behavior model know coach experienc driver ii neural network percept mobil robot guidanc use genet algorithm learn reactiv control paramet autonom robot navig select percept robot drive advanc driver inform system world ever get mode situat awar tactic drive also avail cmu tech report cmu ritr9708 simul design system tactic drive algorithm shiva simul highway intellig vehicl al gorithm vision navig carnegi mellon navlab dynam rout guidanc interact transport manag aliscout tr ctr antonio pellecchia christian igel johann edelbrunn gregor schoner make driver model attract ieee intellig system v20 n2 p812 march 2005