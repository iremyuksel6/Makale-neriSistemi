valid augment lagrangian algorithm gaussnewton hessian approxim use set hardspher problem augment lagrangian algorithm use gaussnewton approxim hessian inner iter introduc test use famili hardspher problem gaussnewton model convexifi quadrat approxim augment lagrangian function thu increas effici iter quadrat solver result method consider effici correspond algorithm use true hessian compar studi use wellknown packag lancelot present b introduct recent year involv develop algorithm base sequenti quadrat program 11 inexact restor 16 18 minim problem nonlinear equal constraint bound variabl valid algorithm requir comparison well establish comput method type problem includ method famili sqp method first case grg like method second well method adopt complet dierent point view case penalti augment lagrangian algorithm consolid practic augment lagrangian method current avail one implement packag lancelot describ 4 method use exampl 11 test reliabl new largescal sequenti quadrat program algorithm author support fapesp grant 9681639 author support pronex fapesp grant 9037246 cnpq faep unicamp cours mention experiment studi felt necess interven augment lagrangian code activ way one permit user lancelot result practic necess becam involv develop dierent augment lagrangian code preserv principl lancelot philosophi also import dierenc follow line 4 modern augment lagrangian method essenti compos three nest algorithm extern algorithm updat lagrang multipli penalti pa ramet decid stop criteria intern algorithm rule declar converg failur overal procedur intern algorithm minim augment lagrangian function bound variabl trust region method subproblem consist minim quadrat model intersect two box one defin problem trustregion box use 4 implement third algorithm deal resolut quadrat subproblem lancelot restrict search face determin approxim cauchi point code explor domain subproblem whole second item specif deal formul quadrat subproblem one felt strongli desir interven one hand tri mani altern spars quasinewton scheme without success hand use surprisingli eectiv simplif true hessian lagrangian call paper gaussnewton hessian approxim analog gaussnewton method nonlinear least squar interpret result exclud hessian sum squar term involv hessian individu compon order valid augment lagrangian implement select famili problem particular interest known famili hardspher problem hardspher problem belong famili sphere pack problem class challeng problem date begin seventeenth cen turi tradit famou problem mathemat statement problem elus simpl withstood attack mani worthi mathematician eg newton hilbert gregori instanc remain open problem furthermor relat practic problem chemistri biolog physic see instanc list exampl 19 concern mainli threedimension problem perus 1550itemlong bibliographi 5 hardspher problem maxim minimum pairwis distanc p point sphere r n problem may reduc nonlinear optim problem turn might expect mention histori particularli hard nonconvex problem potenti larg number nonoptim point satisfi kkt condit thu class problem index paramet n p provid suitabl set test problem evalu nonlinear program code conveni fact hardspher problem may regard feasibl problem associ anoth famou problem area kiss number problem seek determin maximum number k n nonoverlap sphere given radiu r n simultan touch kiss central sphere radiu thu distanc obtain solut hardspher problem given n p greater equal radiu sphere point lie one may conclud k n p use known solut threedimension kiss number problem calibr code describ choos test code valu n p might bring forth new knowledg problem strengthen exist conjectur true ala rigor establish valu k n follow tabl known valuesbound k n given 5 tabl 1 known valu bound kn 9 306380 paper organ follow section 2 formul hardspher problem nonlinear program problem relat main characterist albox augment lagrangian algorithm section 3 explain main algorithm paramet albox chosen follow previou studi 15 section 4 introduc gaussnewton hessian approxim discuss eect use comparison use true hessian lagrangian section 5 describ paramet use lancelot numer experi obtain run albox lancelot larg number hardspher problem present section 6 final conclus drawn section 7 2 albox straightforward formul hardspher problem lead follow maxmin problem r radiu sphere center origin point lie st k 1 vector k belong r n euclidean norm sinc answer problem invari choic posit r let use definit standard inner product r n constraint easi see 1 equival st k 2 appli classic trick transform minimax problem constrain minim problem reduc 2 nonlinear program min z st z j ad slack variabl first set constraint squar second set equat order avoid nonsmooth first deriv obtain min z gener form min fx albox augment lagrangian code develop approxim solv min lx outer iter augment lagrangian function associ 5 current approxim lagrang multipli 0 current vector penalti paramet updat end outer iter subproblem 6 solv use box boxconstrain solver describ 10 iter method minim quadrat approxim object function intersect origin feasibl set box x u trust region also box iter origin object function suffici reduc approxim minim quadrat correspond trial point accept new iter otherwis trust region reduc main algorithm dierenc box method use 2 box quadrat explor whole intersect origin box trust region wherea 2 face determin approxim cauchi point examin albox doubl precis fortran 77 code aim cope largescal problem reason factor matric use quadrat solver use solv subproblem boxconstraint algorithm quacan visit dierent face domain use conjug gradient interior face chop gradient search direct leav face refer reader 1 9 10 detail actual implement quacan iter quadrat solver matrixvector product hessian approxim vector comput occasion addit matrixvector product may neccessari perform albox fact sophist algorithm depend choic mani paramet sensit paramet adjust use kiss problem discuss choic next section similar analysi carri lancelot describ section 5 3 choic paramet albox 31 penalti paramet lagrang multipli vector penalti paramet associ equal constraint updat outer iter consid two possibl updat compon accord decreas correspond compon hx use global criterion base hx specif altern contempl assum x initi point outer iter x final one 1 increas hx sucient smaller hx 2 increas hx sucient smaller hx preliminari experi reveal perhap surprisingli global strat egi 2 better first fact updat compon feasibl level hx tend deterior next iter consequent larg number outer iter becom necessari word seem strategi base 1 encourag zigzag havior success iter alternatingli satisfi one constraint anoth thu although origin formul allow one penalti paramet equal constraint practic work one paramet sinc initi valu test indic 10 adequ initi valu updat accord rule base test increas factor 10 sucient improv feasibl detect consid sucient smaller b mean 001b must point behavior penalti paramet independ strategi updat lagrang multipli algorithm simplic mind adopt first order formula let lagrang multipli start new outer iter lagrang multipli penalti paramet previou iter set 32 stop criteria boxconstraint solver outer iter end one sever stop criteria algorithm solv augment lagrangian boxconstrain minim problem 6 reach usual maximum number iter safeguard set 100 quacan call consid boxconstraint algorithm box converg continu project gradient object function 6 point x vector defin dierenc project x lx box point x toler may chang outer iter test two strategi one defin dynam depend degre feasibl current iter anoth fix 10 5 althought conclus result icosahedron problem better constant strategi use therefor strategi adopt test incident opposit adopt 8 similar augment lagrangian algorithm use solv linearli constrain problem deriv physic applic theoret justif inexact minim subproblem augment lagrangian context also found 12 13 boxconstraint code admit stop criteria instanc execut may stop progress number consecut iter good enough radiu trust region becom small nevertheless best result obtain inhibit altern stop criteria 33 paramet quadrat solver quacan code call minim quadrat function augment lagrangian case subject box constraint ecienc lack thereof play crucial role overal behavior augment lagrangian algorithm paramet must therefor care chosen firstli examin converg criterion project gradient quadrat null correspond point stationari accordingli converg consid achiev norm project gradient less fraction correspond norm initi point case use non continu project gradient project comput feasibl box activ constraint fraction 110 1100 1100000 test icosahedron problem first choic provid best behavior one employ subsequ maximum number iter allow also import paramet sinc otherwis may invest much eort solv problem distantli relat origin one found number variabl problem np p suitabl delimit case nonconverg stop criteria inhibit radiu trust region determin size auxiliari box use quacan nonlinear program algorithm sensit choic first trust region radiu test dierent valu select appropri choic anoth import paramet 0 1 paramet determin whether next iter must belong face current one roughli speak small algorithm tend leav current face soon mild decreas quadrat detect hand 1 algorithm abandon current face current point close stationari point quadrat face rather surpris result icosahedron problem conserv valu better smaller valu final quadrat solver hit boundari feasibl region extrapol step may tri depend valu extrapol paramet 1 larg new point tri number activ bound may consider increas extrapol tri indic conveni choic hardspher problem 4 approxim hessian nonlinear optim problem 4 obtain section 2 version hardspher problem chosen test point 4 gener form min fx whose associ augment lagrangian thu although 2 lx tend posit definit larg close correct lagrang multipli x close solut case earli stage augment lagrangian calcul hand simplifi matrix obtain neglect term involv second order deriv constraint function alway posit semidefinit case independ x cours alway case f convex function anoth insight bx provid examin problem min fx z current point use box iter problem 8 obtain replac origin constraint first order linear approx imat bz happen hessian augment lagrangian associ 8 z furthermor augment lagrangian associ 8 gradient evalu z coincid counterpart associ origin problem 4 evalu z matrix vector product 2 lx v bx v seem cumbersom comput first glanc take advantadg structur enabl comput done onp time principl use true hessian lagrangian best possibl choic sinc repres better structur true problem howev avail algorithm minim quadrat convex set much ecient quadrat convex otherwis quacan except rule therefor interest improv overal perform augment lagrangian algorithm decid use bx hessian lagrangian approxim result inde impress tabl 2 list averag statist obtain four eighteen test set n p pair run fifti random start point averag number outer iter box iter function evalu matrix vector product cpu time second minimum distanc given run use exact hessian first row set one use approxim hessian second row minimum distanc obtain close instanc minimum distanc obtain use approxim hessian smaller one obtain use exact hessian number outer iter dier much one choic number box iter consequ number matrix vector product sensibl decreas overal result mark decreas cpu time figur 1 plot averag cpu time eighteen test use exact hessian versu time use approxim hessian also shown line give best fit data linear ane function name approxim hessian option impli decreas almost two third cpu time tabl 2 run albox exact first row approxim hessian second row problem size outer box funct mvp cpu min eval time dist 486 3706 5214 156436 0765 1086487225412 22 456 16002 19314 6702022 373141 0998675348042 cpu time use exact hessian cpu time use approx hessian 500 1000 1500 2000 2500 3000400800 figur 1 cpu time use exact hessian xaxi versu use approxim hessian yaxi 5 choic paramet lancelot lancelot allow choic exact approxim first second order deriv howev lancelot manual 3 p111 strongli recommend use exact second deriv whenev avail hand provis user suppli hessian approxim fact ran test default approxim sr1 result wors obtain use exact second deriv thu option adopt test light experi describ previou section provid corrobor evid eect gener purpos consolid packag design provid good perform littl interfer user may conveni use open end lowlevel interfac code albox user will get hand dirti latter rawer code might prove competit may actual outperform former code polish though restrict finish also experi sever dierent option solv linear equat solver name without precondition diagon precondition band matrix precondition best result obtain first option precondition anoth choic slow algorithm without notic improv qualiti solut requir exact cauchi point com pute settl use inexact cauchi point option maximum number iter allow 1000 final gradient constraint toler chosen albox name 10 8 fortran compil option adopt lancelot albox 6 numer experi test run sun sparcstat 20 follow main characterist 128mbyte ram 70mhz 2047 mip 444 mflop result fifti run n p pair summar follow tabl tabl 3 summar statist machin independ typic involv number iter number function evalu except optim distanc found quot need complet accur sinc number fact depend factor machin precis compil manufactur nevertheless certainli provid independ ground comparison cpu time present tabl 4 along optim distanc tabl 3 present minimum maximum averag amount number tripl box outer box iter function evalu quacan iter matrixvector productsconjugategradi iter box lancelot respect first row set correspond albox second lancelot unfortun statist avail number function evalu box iterationsderiv evalu pair number matrixvector product mvp output albox number conjugategradi iter cgi produc lancelot sinc conjugategradi iter involv matrixvectorproduct tabl 3 albox lancelot test result problem size outer box function quacan mvp deriv eval iter cgi 4546 21 55 347 25 77 455 309 2343 1064 340 2702 1195 15 61 381 16 71 433 377 1949 992 20 62 380 21 80 434 511 2709 1032 22 58 397 24 66 453 553 1776 1069 4548 27 75 479 34104 642 933 4923 2708 1017 5382 2963 27 84 523 29 96 601 967 4248 2313 4546 32110 602 41140 778 1625 8385 4130 1751 8742 4444 30 91 568 33112 651 1107 5652 3015 22 4543 52115 780 62148 974 5688 16767 10502 6097 17871 11222 45225 1041 49262 1200 5122 37546 12381 37176 1089 39208 1246 4799 29367 14607 2541 45141 864 58183 1079 6282 28049 14077 6769 29825 15009 4542 63180 978 75226 1206 10492 35660 17105 11034 37639 18143 54225 1197 60262 1375 6870 38419 18736 26 4642 51176 954 63216 1172 6765 38932 17185 7317 40932 18237 53266 1314 59311 1505 5094 77233 21796 4543 62206 995 76254 1221 11480 45129 19490 12169 47121 20616 62215 1289 68253 1476 9420 41799 21534 4846 80800 1600 102984 1931 27836471751 63778 29476497038 67020 8533419042 95381 2186 9119 96036 56899 4646 89600 1662 107717 2000 29224326333 67969 30804340424 71261 4749 78700 1958 89815 2313 26692448509 88566 27892472730 92422 9138523124 9945326344 24178160611 85972 4749 90700 2029 106880 2429 34936463883 98266 36614485784102816 4849 93800 2251 117954 2716 36194547421117417 38311577662122924 4746 109700 2123 132887 2561 47402502810109630 49993529036114749 102440 2464 115499 2813 34730200558 although algorithm behav dierent timewis shortli see direct consequ number function evalu perform best leastsquar fit first degre polynomi give number function evalu albox x correspond amount lancelot wherea similar fit involv cpu time give coecient less third figur 2 plot function evalu pair eighteen instanc along best fit obtain albox figur 2 number function evalu lancelot versu albox still provid explan higher ecienc albox comparison mvp versu cgi case best fit give 110655x number mvp x number cgi suggest although iter involv matrixvectorproduct cgi substanti costlier timewis mvp perform albox main factor matrixvectorproduct lancelot conjug gradient iter deal true hessian wherea one albox involv approxim simpler hessian figur 3 contain line correspond best linear fit posit cgi mvp pair next tabl 4 present similar statist involv optim distanc encount cpu time second first resp second row n p pair give number obtain albox resp lancelot albox figur 3 number cgi lancelot versu number mvp albox tabl 4 minimum distanc cpu time test problem size minimum distanc 2 point cpu time second 10514622 10914262 108323633 0170 1010 0476 10514622 10514622 105146223 0170 1420 0636 09463817 10514622 104515739 0290 1870 0906 22 09529038 09619429 095809771 25150 86570 41290 26 09606935 09779378 096928704 420170 4527652 1000608 09599791 09798367 097025160 807570 4664 inform contain tabl 4 depict graphic interv min max distancescpu time repres vertic segment averag indic diamond symbol albox bullet lancelot graph left refer distanc wherea graph right refer cpu time min dist time figur 4 albox lancelot result 22 4 26 4 min dist 22 4 26 4 cpu time figur 5 albox lancelot result graph figur 46 evid qualit rel behavior code notic diamond bullet alway close togeth graph left indic qualiti optim solut obtain code min dist cpu time figur 6 albox lancelot result similar hand bullet rise faster diamond graph right mean cpu time lancelot tend higher albox linear fit albox cpu time versu xthe coecient less one third plote figur 7 confirm cpu time cpu time albox 500 1000 1500 2000 2500400800 figur 7 cpu time lancelot versu albox final note cpu time increas sharpli function problem size repres instanc number constraint tri sever fit linear quadrat exponenti though none seem provid good model data quadrat fit best one 7 conclus main aspect augment lagrangian methodolog solv largescal nonlinear program problem consolid work conn gould toint gave origin lancelot packag algorithm framework use last ten year solv practic problem comparison purpos innov nonlinear program method like tendenc maintain near futur present research born result need freedom formul resolut quadrat subproblem aris lancelotlik approach augment lagrangian philosophi one hand decid exploit deepli whole trust region mean use boxconstraint quadrat solver hand perhap importantli test gaussnewton convex simplif quadrat model turn much ecient straight newtonlik version model behind gain ecienc fact quadrat solver though abl deal nonconvex model far ecient underli quadrat posit semidefinit hessian usual numer analysi decis implement high level algorithm depend current technolog solv lowlevel subproblem must warn decis could chang new ecient algorithm solv subproblem nonconvex quadrat program case found main object use albox solv reallif problem also test altern nonlinear program method feel deep knowledg implement detail code enabl us much exact test new code sinc possibl fine tune standard new code test present studi apart call reader attent convex simplifi gaussnewton like subproblem object valid code mean comparison lancelot use set problem independ interest result comparison seem indic albox use competit tool nonlinear program calcul r adapt algorithm bound constrain quadrat minim global converg augment lagrangian algorithm optim gener constraint simpl bound global converg class trust region algorithm optim simpl bound lattic group mathemat scienc pattern compar numer perform two trustregion algorithm largescal boundconstrain minim augment lagrangian adapt precis control quadrat program equal constraint maxim concav quadrat function box constraint new trustregion algorithm bound constrain minim nonlinear program algorithm use trust region augment lagrangian nonmonoton penalti paramet analysi implement dual algorithm constraint optim dual techniqu constraint optim bound kiss number r n mathemat program formul augment lagrangian resolut pack problem twophas model algorithm global converg nonlinear pro gram precondit truncatednewton method linearli constrain spectral gradient method inexact restor subproblem nonlinear program distribut mani point sphere tr dual techniqu constrain optim global converg class trust region algorithm optim simpl bound global converg augment lagrangian algorithm optim gener constraint simpl bound analysi implement dual algorithm constrain optim twophas model algorithm global converg nonlinear program lancelot augment lagrangian adapt precis control quadrat program equal constraint ctr graciela croceri graciela n sottosanto mara cristina maciel augment penalti algorithm base bfg secant approxim trust region appli numer mathemat v57 n3 p320334 march 2007 r andreani friedland p mello santo boxconstrain minim reformul complementar problem secondord cone journal global optim v40 n4 p505527 april 2008 g birgin jo mario martnez largescal activeset boxconstrain optim method spectral project gradient comput optim applic v23 n1 p101125 octob 2002 nikhil arora lorenz biegler trust region sqp algorithm equal constrain paramet estim simpl paramet bound comput optim applic v28 n1 p5186 april 2004 g birgin j martnez structur minimalmemori inexact quasinewton method secant precondition augment lagrangian optim comput optim applic v39 n1 p116 januari 2008