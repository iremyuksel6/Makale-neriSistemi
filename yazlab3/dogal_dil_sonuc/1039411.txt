loadbalanc scatter oper grid comput present solut static loadbal scatter oper parallel code run grid loadbalanc strategi base modif data distribut use scatter oper studi replac scatter oper parameter scatter allow custom distribut data paper present 1 gener algorithm find optim distribut data across processor 2 quicker guarante heurist reli hypothes commun comput 3 polici order processor experiment result mpi scientif code illustr benefit obtain loadbalanc b introduct tradit user develop scientif applic parallel comput mind assum homogen set processor link homogen fast network howev grid 10 comput resourc usual includ heterogen processor heterogen network link order magnitud slower parallel comput therefor execut grid applic design parallel comput usual lead poor perform distribut workload take heterogen account henc need tool abl analyz transform exist parallel applic improv perform heterogen environ loadbalanc ex ecut furthermor will fulli rewrit origin applic rather seek transform modifi origin sourc code littl possibl research support french ministri research acigrid program among usual oper found parallel code scatter oper one collect oper usual ship messag pass librari instanc mostli use messag pass librari mpi 16 provid mpiscatt primit allow programm distribut even part data processor mpi commun less intrus modif enabl perform gain heterogen environ consist use commun librari adapt heterogen thu much work devot purpos mpi numer project includ magpi 15 mpistart 13 mpichg2 8 aim improv commun perform presenc heterogen network gain obtain rework design collect commun primit instanc mpichg2 perform often better mpich dissemin inform held processor sever other mpich alway use binomi tree propag data mpichg2 abl switch flat tree broadcast network latenc high 14 make commun librari awar precis network topolog easi mpichg2 queri underli globu 9 environ retriev inform network topolog user may specifi environ variabl networkawar librari bring interest result compar standard commun librari howev improv often suffici attain perform consid accept user processor also heterog neou balanc comput task processor also need take benefit grid typic usag scatter oper spawn spmd comput section processor receiv piec data therebi comput load processor depend data receiv use scatter oper mean loadbal com putat provid item data set scatter independ mpi provid primit mpiscatterv allow distribut unequ share data claim replac mpiscatt mpiscatterv call parameter clever distribut may lead great perform improv low cost term sourc code rewrit transform oper requir deep sourc code reorgan easili autom softwar tool problem thu loadbal execut comput data distribut depend processor speed network link bandwidth section 2 present target applic real scientif applic geophys written mpi ran raytrac full set seismic event year 1999 section 3 present loadbalanc techniqu section 4 processor order polici deriv case studi section 5 experiment result section 6 relat work conclud section 7 2 motiv exampl 21 seismic tomographi geophys code consid seismic tomographi field gener object applic build global seismic veloc model earth int rior variou veloc found differ point discret model gener mesh reflect physic rock properti locat seismic wave veloc comput seismogram record cap tor locat around globe analyz wave type earthquak hypocent captor locat well wave travel time determin data tomographi applic reconstruct event use initi veloc model wave propag sourc hypocent given captor defin path applic evalu given properti initi veloc model time wave propag along evalu path compar actual travel time final step new veloc model minim differ comput process accur new model better fit numer path mani locat insid earth therefor comput demand 22 exampl applic outlin applic studi exploit potenti parallel comput task distribut across processor recal input data set seismic wave characterist describ pair 3d coordin coordin earthquak sourc receiv captor plu wave type characterist seismic wave model set ray path repres wavefront propag seismic wave characterist suffici perform raytrac whole associ ray path therefor ray path trace independ exist parallel applic present 12 assum homogen set processor implicit target parallel comput follow pseudocod outlin main commun comput phase raydata read n line data file mpiscatterraydata rbuff root p number processor involv n number data item mpiscatt instruct execut root comput processor processor identifi root perform send contigu block bnp c element raydata buffer processor group processor make receiv oper respect data rbuff buffer sake simplic remain n mod p item distribut shown figur 1 show potenti execut commun oper p 4 root process time idl receiv send comput figur 1 scatter commun follow comput phase 23 hardwar model figur 1 outlin behavior scatter oper observ applic run test grid describ section 51 behavior indic network capabl root node send one destin node time singleport model 4 realist grid mani node simpl pc fullduplex network card root processor send data processor turn 1 receiv processor actual begin commun previou 1 mpich implement order destin processor scatter oper follow processor rank processor serv lead stair effect repres figur 1 end time receiv oper black box 3 static loadbalanc overal execut time loadbalanc rather small make assumpt grid characterist chang comput consid static loadbalanc note also comput distribut necessarili base static paramet estim whole execut monitor daemon process like 19 run asid applic could queri scatter oper retriev instantan grid characterist 31 framework consid set p processor character 1 time comp x take comput x data item 2 time tcomm x take receiv x data item root process want process data item look distribut n 1 n p data p processor minim overal comput time paper root processor last process p p start process share data item sent data item processor root processor send data processor turn processor p begin commun processor serv take time tcomm j n j root take tcomm n send p data p take comp n process thu p end process time time taken system comput set n data item therefor 1ip 2 look distribut n 1 n p minim durat 32 exact solut dynam program studi equat 2 remark time process n data processor 1 p equal maximum 1 time taken root send n 1 data p 1 plu time taken p 1 process 2 time processor 2 p process n n 1 data plu time root send n 1 data p 1 lead dynam program algorithm 1 distribut express list henc use list constructor con algorithm 1 costd denot cost process data item processor p p p solutiond list describ distribut data item processor achiev minim execut time costd algorithm 1 comput optim distribut n data processor solution0 p cons0 nil 1 n solutiond p consd nil 1 n e 1 sol e costd min solutiond return costn 1 solutionn 1 algorithm 1 complex op n 2 may prohibit algorithm 1 assum function tcomm x comp x nonneg present effici heurist valid simpl case 33 guarante heurist use linear program ming section make hypothesi function tcomm n comp n affin n increa ing nonneg n 0 equat 2 code follow linear program minim linear program must solv integ find integ solut howev solv ration obtain optim ration solut n 1 n p round obtain integ solut n 0 let 0 execut time solut time ration solut opt time optim integ solut jn n 0 easili enforc round scheme describ 1ip inde hypothesi tcomm j x comp j x non neg increas affin function therefor tcomm j equival upper bound comp j n 0 use upper bound overapproxim express 0 given equat 5 obtain impli equat 4 know opt 0 round scheme round scheme trivial first round nearest integ n nearest integ obtain n 0 make approxim error jej 1 e neg underestim resp overesti mate approxim round ceil resp floor one remain n j nearest ceil dn j e resp floor bn j c obtain new approxim error jej 1 remain approxim one say n let n 0 e distribut n 0 n 0 thu integ n 0 differ n less one 34 choic root process make assumpt origin n data item must process store singl comput denot c processor c may may use root processor root processor c whole execut time equal time need transfer data c root processor plu execut time comput algorithm 1 best root processor processor minim whole execut time pick root result minim p candid 4 case studi solv ration linear commun comput time section studi simpl theoret case make hypothesi function tcomm n comp n linear n word constant tcomm also look ration solut integ one case studi enabl us defin polici order processor must receiv data inde simpl case processor order lead shortest execut time quit simpl show section 43 prove section 42 alway optim ration solut work processor end time also show condit processor receiv share whole work condit come express execut durat processor process share whole work finish date begin studi case section 41 final section 44 deriv case studi consequ gener case 41 execut durat theorem 1 execut durat look ration solut processor p receiv non empti share n whole set n data item processor end comput date execut time processor p receiv data process proof want express n function n equat 2 state processor p end process time current hypothes hypothesi processor end process time find equat 8 express execut durat function n sum equat 8 valu 1 p equival equat 7 rest paper note hypothes theorem 1 42 simultan end paragraph exhibit condit cost function tcomm n comp n set processor necessari suffici optim ration solut processor receiv nonempti share data processor end date tell us theorem 1 use find ration solut system theorem 2 simultan end given p processor p p whose commun comput durat function tcomm n comp n linear n exist optim ration solut processor receiv nonempti share whole set data processor end comput date proof proof made induct number processor one processor theorem trivial true shall next prove theorem true p processor also true p1 processor suppos optim solut comput n data item obtain give n item p 1 1 n item p 2 p p1 0 1 end date processor p 1 1 theorem suppos true p proce sor know exist optim ration solut processor p 2 p p1 work finish work simultan 8i 2 2 p case theorem 1 time taken p data processor p 2 end date 2 1 k 1 strictli increas 2 decreas moreov 1 0 2 0 thu whole end date maxt 1 minim uniqu 0 1 1 case processor data comput end date contrari 1 k 1 2 strictli increas thu whole end date minim case processor p 1 noth comput end date 0 processor p 2 p p1 end date k n thu exist optim ration solut receiv nonempti share whole set data processor end comput date 8i 2 1 p proof theorem 2 show processor p dp interest problem use increas whole process time therefor forget processor theorem 2 state optim ration solut remain processor work date 43 processor order polici state section 23 root processor send data processor turn receiv processor actual begin commun previou processor receiv share data moreov mpich implement mpi order destin processor scatter oper follow processor rank defin programm therefor set processor rank influenc order processor start receiv process share whole work equat 7 show case overal comput time symmetr processor depend order therefor must care defin order order speedup whole comput appear current case best order quit simpl theorem 3 processor order polici function tcomm n comp n linear n 1 p 1 look ration solut smallest execut time achiev processor root processor except order decreas order bandwidth p 1 processor connect root process highest bandwidth p p 1 processor connect root processor smallest bandwidth last processor root processor proof consid order p 1 p p pro cessor except p p root processor explain section 31 consid permut order word consid order p p processor exist denot resp best ration execut time processor order p 1 p p must show p k1 connect root processor higher bandwidth p k strictli smaller word must show implic therefor studi sign differ replac express state equat 7 hypothesi 1 p 1 dp bit complic 1 p 1 dp opposit exist valu 1 p 1 dp optim execut time achiev solut processor receiv nonempti share whole set data processor end comput date therefor solut processor receiv nonempti share whole set data processor end comput date lead execut time strictli greater equat 10 11 summar prove follow implic prove equat 9 henc studi sign express denomin obvious strictli posit sign sign want simplifi second sum equat 14 thu remark valu order take advantag simplif propos equat 15 decompos second sum equat four term sum 1 k 1 term k k 1 sum k 2 p k1 report result equat 16 equat 14 suppress term common side sign divid result equat strictli posit term way obtain sign k k1 equival therefor k1 k 0 equat 13 hold thu equat therefor invers processor p k p k1 profit bandwidth root processor processor higher bandwidth root processor processor p k 44 consequ gener case gener case go order processor exact studi feasibl even gener case know comput commun characterist processor inde consid possibl order p processor use algorithm 1 comput theoret execut time chose best result theoret possibl prac tice larg valu p approach unrealist furthermor gener case analyt studi cours imposs analyt handl function tcomm n comp n build previou result order processor decreas order bandwidth connect root processor except root processor order last even without previou studi polici surpris inde time spent send share data item processor pay processor p p p first processor one less expens send data cours practic thing bit complic work integ howev main idea roughli show suppos comput commun function linear denot opt best execut time achiev ration distribut n data item whatev order processor opt best execut time achiev integ distribut n data item whatev order processor note rat opt int opt may achiev two differ order processor take ration distribut achiev execut time rat opt round obtain integ solut follow round scheme describ section 33 way obtain integ distribut execut time 0 0 satisfi equat 1ip proof equat 4 howev integ solut execut time obvious least equal int opt also integ solut ration solut int opt least equal rat opt henc bound int 1ip 0 execut time distribut obtain round accord scheme section 33 best ration solut processor order decreas order bandwidth connect root processor except root processor order last comput commun function linear order polici even guarante 5 experiment result 51 hardwar environ experi consist comput 817101 ray path full set seismic event year 1999 processor machin run globu 9 use mpichg2 8 messag pass librari tabl 1 show resourc use experi locat two geograph distant site processor 1 6 standard pc intel piii amd athlon xp 7 8 two mip processor sgi origin 2000 premis wherea processor 9 16 taken sgi origin 3800 mip processor name leda end franc input data set locat pc name dinadan first site machin cpu type rate dinadan 1 piii933 pellinor 2 piii800 caseb 3 xp1800 sekhmet 4 xp1800 0004885 190 seven 7 8 r12k300 0016156 057 leda 916 r14k500 0009677 095 tabl 1 processor use comput node experi tabl 1 indic processor speed observ seri benchmark perform applic column indic number second need comput one ray lower better associ rate simpli intuit indic processor speed higher better invers normal respect rate 1 arbitrarili chosen pentium iii933 sever ident processor present comput 5 6 916 averag perform report network link throughput root processor dinadan node report tabl 2 assum linear commun cost column indic time second need receiv one data element root processor machin dinadan 0 caseb pellinor sekhmet seven merlin tabl 2 measur network bandwidth sray sort descend order notic merlin processor 5 6 though geograph close root processor smallest bandwidth connect 10 mbit hub experi wherea other connect fastethernet switch 52 result experiment result section evalu two aspect studi first experi compar unbalanc execut origin program without sourc code modif predict best balanc execut second experi evalu execut perform respect two processor order polici bandwidth descend ascend order origin applic figur report perform result obtain origin program processor receiv equal amount data choos order pro cessor conclus given section 44 order processor descend bandwidth surprisingli processor end time larg differ exhibit huge imbal earliest processor finish 259 latest 853 s1003005007009001000030000500007000090000110000 time data caseb pellinor sekhmet seven seven leda leda leda leda leda leda leda leda merlin merlin dinadan total time comm time amount data figur 2 origin program execut uniform data distribut loadbalanc applic second experi evalu loadbalanc strategi made assumpt comput commun cost function affin increas assumpt allow us use guarante heuri tic simpli replac mpiscatt call mpiscatterv parameter distribut comput heurist larg number ray algorithm 1 take 15 minut run celeron 12 ghz wherea heurist execut use pipmp 7 17 instantan error rel optim solut less 6 time data caseb pellinor sekhmet seven seven leda leda leda leda leda leda leda leda merlin merlin dinadan total time comm time amount data figur 3 loadbalanc execut node sort descend bandwidth result experi present figur 3 execut appear well balanc earliest latest finish time 405 430 respect repres maximum differ finish time 6 total du ration comparison perform origin applic gain signific total execut durat approxim half durat first experi order polici compar effect order polici result present figur 3 obtain descend bandwidth order execut processor sort ascend bandwidth order present figur 41003005007009001000030000500007000090000110000 time data merlin merlin leda leda leda leda leda leda leda leda seven seven sekhmet pellinor caseb dinadan total time comm time amount data figur 4 loadbalanc execut node sort ascend bandwidth load balanc execut accept maximum differ end time 10 total durat earliest latest processor finish 437 486 predict total durat longer 56 processor revers order though load slightli less balanc first experi peak load sekhmet ex differ come idl time spent processor wait actual commun begin clearli appear figur 4 surfac bottom area delimit dash line stair effect bigger figur 3 6 relat work mani research work address problem loadbalanc heterogen environ consid dynam loadbalanc repres dynam approach work 11 strongli relat problem work librari allow programm produc per process load statist execut inform may use decid redistribut array one iter howev dynam load evalu data redistribut make execut suffer overhead avoid static approach static approach use variou context rang data partit parallel video process 1 find optim number processor linear algebra algorithm 3 work closer distribut loop heterogen processor balanc workload studi 6 particular case independ iter equival scatter oper ever comput commun cost function affin loadbalanc solut first present heterogen processor network content occur content taken account homogen processor framework appl project 5 discuss loadbal iter solver make stencil comput suggest linear program techniqu comput distribut actual use less precis though simplest solut solv linear equat anoth way loadbal scatter oper implement follow masterslav paradigm gener framework studi 2 static loadbalanc could serv purpos code rewrit case becom far complex 7 conclus paper partial address problem adapt grid exist parallel applic design parallel comput studi static loadbalanc scatter oper assumpt made processor speed network link bandwidth present two solut comput loadbalanc di tribut gener exact algorithm heurist far effici simpl case affin comput commun time also propos polici processor order order decreas order network bandwidth root proce sor target applic experi show replac mpiscatt mpiscatterv call use clever distribut lead great perform improv low cost acknowledg part comput resourc use taken origin 3800 cine httpwwwcinesfr want thank let us access machin r optim schedul algorithm commun constrain parallel process schedul strategi masterslav task heterogen processor grid linear algebra algorithm heterogen cluster personn comput er parametr integ program globu metacomput infrastructur toolkit grid blueprint new comput infrastructur dynam loadbalanc dataparallel mpi program parallel seismic raytrac global earth mesh deliv network perform numer applic exploit hierarchi parallel comput network optim collect oper perfor manc mpi collect commun oper cluster wide area system mpi messag pass interfac standard pippiplib network weather servic distribut resourc perform forecast servic metacomput tr distribut process divis job commun startup cost grid magpi network weather servic mpistart schedul divis load parallel distribut system schedul strategi masterslav task heterogen processor grid optim schedul algorithm commun constrain parallel process sourc code transform strategi loadbal grid applic bandwidthcentr alloc independ task heterogen platform linear algebra algorithm heterogen cluster person comput exploit hierarchi parallel comput network optim collect oper perform mpi messagepass interfac standard schedul divis workload heterogen platform seismic raytrac earth mesh model variou parallel architectur divis load theori