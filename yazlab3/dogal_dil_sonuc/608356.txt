scenario reduct algorithm stochast program consid convex stochast program approxim initi probabl distribut p finit support supp p ie finit mani scenario behaviour stochast program stabl respect perturb p measur term fortetmouri probabl metric problem optim scenario reduct consist determin probabl measur support subset supp p prescrib cardin closest p term probabl metric two new version forward backward type algorithm present comput optim reduc probabl measur approxim compar earlier version comput perform accuraci run time new algorithm improv consider numer experi report differ instanc scenario tree comput optim lower bound test exampl also includ ternari scenario tree repres weekli electr load process power manag model b introduct mani stochast decis problem may formul convex stochast program form minf z x r given nonempti close convex set close subset r function f 0 r r continu respect convex respect x p xed borel probabl measur p instanc formul cover convex two multistag stochast program recours typic integrand f 0 x x 2 x convex stochast program problem nondierenti local lipschitz continu fol low assum exist continu nondecreas function nondecreas function xed element heitsch romisch x 2 x function c r given c mean function hk 0 describ growth local lipschitz constant f 0 x ball around 0 respect norm k r import particular case function h grow poli nomial ie 1 instanc shown 11 choic appropri twostag model stochast enter price righthand side shown 411 model 1 behav stabl respect small perturb term probabl metric c p q sup z z f c class continu function dene probabl measur p q set p z see also earlier work 13 distanc c probabl metric structur also call fortetmouri type metric gener introduc 14 studi 1012 particular metric c dual represent term kantorovichrubinstein function cf section 53 10 12 import instanc initi probabl measur p discret nite mani atom scenario good discret approxim p avail support may larg reason comput complex time limit probabl measur approxim probabl measur q carri much smaller subset scenario case distanc c p q repres optim valu nitedimension linear program precis 4 obtain c j p denot dirac measur place unit mass particular metric c use evalu distanc specic probabl measur obtain scenarioreduct process variou reduct rule appear literatur context recent largescal reallif applic refer correspond discuss 4 scenario reduct algorithm stochast program 3 recent work 3 scenario gener reduct paper 9 approach scenario gener base fortetmouri distanc given present paper follow approach reduc scenario given discret probabl measur develop 4 consist determin index set j given cardin j probabl measur q problem 7 may reformul mixedinteg program section 2 deriv bound 7 develop two new algorithm fast forward select simultan backward reduct constitut heurist solv 7 studi complex relat algorithm 4 inde fast forward select algorithm turn ecient implement forward select procedur 4 produc reduc probabl measur order compar perform algorithm provid section 3 explicit formula minim distanc 7 case p regular binari ternari scenario tree ie tree specic structur q reduc tree xed cardin n section 4 report numer experi reduct regular binari ternari scenario tree test tree also includ ternari scenario tree repres weekli electr load process power manag model consid 4 turn new implement fast forward select algorithm 10100 time faster earlier version furthermor fast forward select best algorithm compar accuraci result simultan backward reduct algorithm accur backward reduct variant 4 case expens higher run time compar run time fast forward select simultan backward reduct prefer case n n reduct consid stochast program 1 select function c form 3 lipschitz condit 2 satis let initi probabl distribut p discret carri nite mani scenario iwith weight consid probabl measur 4 heitsch romisch ie compar p measur reduc delet assign new probabilist weight q j scenario optim reduct concept describ recommend consid probabl distanc depend index set j q optim reduct concept 7 say index set j optim weight q select dj q jg first recal follow bound min q dj index set j xed 4 theorem 31 theorem 21 redistribut index set j c max furthermor equal 9 henc optim q h 1 conveni reader proof theorem 21 display appendix interpret formula 10 new probabl preserv scenario equal sum former probabl probabl delet scenario closest respect c h 1 call 10 optim redistribut rule next discuss optim choic index set j scenario reduct xed cardin j theorem 21 motiv consid follow formul optim reduct problem given n 2 n n minfd j ng 11 problem 11 mean set cover two set j xed cardin n n cover minim cost j thu 11 repres setcov problem may formul 01 integ program cf 7 nphard sinc ecient solut algorithm hardli avail gener look scenario reduct algorithm stochast program 5 fast heurist algorithm exploit structur cost j specic case solv 11 becom quit easi case j 1 problem 11 take form min l2f1ng l min minimum attain l ie scenario l delet redistribut rule 10 yield probabl distribut reduc measur q j 2 arg min j 6l c l hold q q g cours optim delet singl scenario may repeat recurs prescrib number n n scenario delet strategi recommend conceptu algorithm call backward reduct case j n 1 problem 11 form min u2f1ng minimum attain u scenario u kept redistribut rule 10 provid strategi provid basic concept second conceptu algorithm call forward select first take closer look backward reduct strategi backward type algorithm alreadi suggest 46 determin reduc scenario set reduc n n scenario origin set scenario follow let indic l select l min shown lower bound optim valu 11 furthermor hold index set solut 11 n set nonempti 46 properti motiv follow algorithm rst step index n 1 determin use formula 14 j solut 11 next redistribut rule theorem 21 use lead reduc probabl measur p 1 contain scenario index reduc delet scenario belong index set j 2 j n obtain way use formula 14 procedur continu step r n 6 heitsch romisch final redistribut rule 10 use index set j algorithm call backward reduct scenario set still mani degre freedom choos next scenario step often exist sever candid delet section 4 use one particular implement backward reduct scenario set anoth particular variant consist case j variant without nal redistribut alreadi announc 25 howev numer test shown backward reduct scenario set provid slightli accur result compar backward reduct singl scenario next go present new modic backward reduct principl major dierenc includ delet scenario backward step simultan name next index l determin solut optim problem detail descript whole algorithm call simultan backward reduct given algorithm 22 simultan backward reduct sort fc c 1 min z 1 l p l c 1 l2f1ng z 1 step c kl min z l z step nn1 redistribut 10 algorithm 22 allow follow interpret rst step correspond optim delet one scenario 1 l chosen j 1 flg dene 11 henc index l dene recurs index set optim subject constraint scenario reduct algorithm stochast program 7 previou indic xed sinc run time import characterist scenario reduct al gorithm studi comput complex ie number elementari arithmet oper algorithm 22 shown 6 proper implement without sort backward reduct scenario set requir complex 2 oper hold uniformli respect n compar formula 14 16 one notic increas complex cost structur 16 determin l precis step requir comput n sum consist summand n i1 comparison summand repres product two number one factor requir 2 oper determin minimum sort process step 1 requir 2 log n oper 1 chapter 1 exclud complex evalu function c redistribut rule altogeth obtain n 3on 2 log n oper select subset n scenario henc proposit 23 comput complex reduc set n 2 n scenario subset contain n 2 consist b n n see 18 oper use simultan backward reduct henc complex simultan backward reduct increas decreas n cours minim result correspond run time observ numer test report section 4 next describ strategi opposit backward reduct conceptu idea base formula 13 consist recurs select scenario delet basic concept algorithm given 4 call forward select forward select determin index set fu un g g rst step procedur coincid solv problem 13 last step optim redistribut rule use determin reduc probabl measur formula 19 allow interpret case simultan backward reduct close relat structur j 11 let us consid follow algorithm easi implement call fast forward select 8 heitsch romisch algorithm 24 fast forward select z 1 u2f1ng z 1 step c z z step n1 redistribut 10 theorem 25 index set fu un g determin algorithm 24 solut forward select principl ie u satis condit 19 hold j dene 11 proof result immedi hold z henc index u satis condit 19 hold z condit 17 20 show algorithm base basic idea select next scenario index dierenc scenario reduct algorithm stochast program 9 consist use backward forward strategi respect ie determin set delet remain scenario respect case backward reduct comput complex algorithm 24 interest step requir oper comput c oper z oper determin u altogeth obtain oper select subset n scenario henc proposit 26 comput complex fast forward select reduc set n 2 n scenario subset contain n 2 scenario consist fn n see 21 oper henc complex fast forward select increas increas n maxim thu use fast forward select recommend number n remain scenario satis condit n number n fn n zero polynomi degre 3 depend nonlinearli n turn n nfor larg n 3 minim distanc scenario tree algorithm discuss previou section provid approxim solut 11 gener sinc error estim algorithm avail need test exampl discret origin reduc measur dierent scale known optim c distanc practic import consid probabl measur scenario exhibit tree structur particular deriv optim distanc certain regularli structur origin scenario tree reduc tree contain differ number scenario consid scenario tree repres discret paramet stochast process paramet set f0 scenario path branch paramet k 2 f0 branch degre ie node tree successor case tree call binari ternari respect henc tree consist n k scenario k root node furthermor let scenario equal probabl scenario tree call regular k 2 exist symmetr set v k f k g r heitsch romisch k 1tupl indic correspond index say case mean set v k form v respect clearli hold 0 tree figur 1 c c c c c c c c c c c figur 1 binari scenario tree show exampl regular binari scenario tree scenario specifi function c 3 set h 1 choos maximum norm k k1 r k1 ie c rst result provid explicit formula minim distanc regular binari tree reduc subtre least proposit 31 34solut let regular binari scenario tree hold n 2 n n proof use represent 22 scenario let correspond k 1tupl indic let l 2 kg l 1 obtain r jr j l r scenario reduct algorithm stochast program 11 henc hold j remain show exist index set j j lower bound attain ie end consid index set fi let r denot tree consist figur 2 illustr detail r start node r r r r r r figur 2 detail subtre r level k 0 1 end level k 2 henc cardin j obtain 4 j want show j 2 j exist index 2 relat scenario let us consid behaviour j branch level k 2 distinguish three case k0 case case case 3 k01 consid follow k k 62 fk 12 heitsch romisch denot correspond index clearli 2 consequ hold distanc j r jr j r jr j case 1 case 2 maxfj2 k0 j j2 k0 2 k01 jg case 3 latter equat hold due assumpt k0 maxf 2 k0 henc consid subset j cardin 1 3 result follow gener case 2 second result provid similar formula minim distanc regular ternari tree reduc subtre contain n 2 9 n scenario proposit 32 79solut let regular ternari scenario tree hold n 2 n 2 proof similarli proposit 31 obtain subset j show exist index set j j lower bound n n attain j consid index set fi k0 denot tree consist figur 3 illustr detail r start scenario reduct algorithm stochast program 13 r r r r r r figur 3 detail subtre r node level k 0 1 end level k 2 obtain cardin j 9 3 9 n j similarli proposit 31 shown j 2 j exist index 2 hold k 9 k0 consid subset j cardin 9 n result follow gener case 2 similar result avail addit assumpt case euclidean norm instead maximum norm see also 6 aim section report numer experi test compar algorithm describ section 2 name backward reduct scenario set simultan backward reduct fast forward select algorithm implement c test run perform hp 9000 780j280 computeserv 180 mhz frequenc 768 mbyte main memori hpux 1020 ie congur numer test 4 consid situat function c dene c origin discret probabl measur p given scenario tree form precis use test batteri three binari ternari scenario tree respect test tree regular thu result section 3 appli provid minim distanc p reduc measur support n scenario n small exampl 41 binari scenario tree 05 06 07 09 11 13 16 19 23 27 figur 4 illustr origin scenario tree proposit 31 appli k n hold n 256 n n exampl 42 ternari scenario tree 07 09 12 15 26 33 tree shown figur 5 proposit 32 appli n hold 2n 14 heitsch romisch exampl 43 ternari load scenario tree consid scenario tree construct section 4 4 weekli electr load process german power util see also 58 descript stochast power manag model solut lagrangian relax origin construct base hourli discret weekli time horizon branch point piecewis linear interpol k correspond mean shift tree illustr figur 6 moment disregard nonbranch point time discret consid correspond mean shift tree latter tree regular ternari scenario tree denot standard deviat stochast load process time sinc case increas increas proposit 32 appli k hold min n final remain remark due piecewis linear structur scenario choic maximum norm dene c minim distanc min n chang includ nonbranch point origin scenario tree exampl 4143 reduc tree contain n scenario use 3 reduct algorithm correspond tabl contain rel accuraci run time algorithm need produc reduc tree n scenario addit tabl provid rel lower bound 15 rel minim distanc n percent avail rel alway mean correspond quantiti divid minim c distanc p one scenario endow unit mass particular rel accuraci dene quotient c distanc origin measur p reduc measur qn n scenario c distanc p rel c denot set scenario p dene c c numer experi show algorithm work reason well algorithm reduc 50 scenario p optim way ex pect simultan backward reduct fast forward select produc accur tree backward reduct scenario set expens higher run time result also indic fast forward select slightli accur simultan backward reduct although backward reduct variant sometim competit fast forward select work much faster implement forward select scenario reduct algorithm stochast program 15 figur 4 origin binari scenario tree number backward simultan fast lower minim n scenario set backward forward bound distanc scenario rel c time rel c time rel c time tabl 1 result binari scenario tree reduct heitsch romisch figur 5 origin ternari scenario tree number backward simultan fast lower minim n scenario set backward forward bound distanc scenario rel c time rel c time rel c time tabl 2 result ternari scenario tree reduct scenario reduct algorithm stochast program 17 50050024 48 72 96 120 144 168 figur origin load scenario tree number backward simultan fast lower minim n scenario set backward forward bound distanc scenario rel c time rel c time rel c time tabl 3 result load scenario tree reduct heitsch romisch 4 instanc fast forward select requir 35 second determin load scenario subtre exampl 43 contain 600 scenario instead 8149 second report 4 especi case deepli reduc tree fast forward select work fast accur furthermor turn lower bound good even optim larg n extrem pessimist small n anoth observ reduct half scenario impli loss 10 rel accuraci instanc case exampl 42 possibl determin subtre contain 6 origin 729 scenario still carri 50 rel accuraci final take closer look numer result load scenario tree reduct particular compar run time simultan backward reduct fast forward select case figur 7 displays10300 100 200 300 400 500 600 time second number scenario fast forward simultan backward figur 7 run time reduc load scenario tree run time algorithm show clearli opposit algorithm strategi ect correspond theoret complex result proposit 23 26 show run time fast forward select smaller n napproxim conrm forward select concept favour n small figur 8 9 10 show reduc load tree 15 scenario obtain algorithm gure display scenario line width proport scenario probabl scenario reduct algorithm stochast program 19 50050024 48 72 96 120 144 168 figur 8 backward reduct load tree 50050024 48 72 96 120 144 168 figur 9 simultan backward reduct load tree 50050024 48 72 96 120 144 168 figur 10 fast forward select load tree heitsch romisch acknowledg research partial support bmbf project 03rom5b3 appendix proof theorem 21 let j arbitrari index set set c ij c program dualiti impli feasibl q particular consid hold ki henc obtain next set u min 2 note u henc obtain feasibl q proof complet 2 r introduct algorithm redukt von szenariob handbook oper research manag scienc probabl metric stabil stochast model theori probabl applic 28 tr introduct algorithm integ program quantit stabil stochast program