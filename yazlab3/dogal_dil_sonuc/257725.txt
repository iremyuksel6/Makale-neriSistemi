accuraci enhanc higher deriv use chebyshev colloc map techniqu new method investig reduc roundoff error comput deriv use chebyshev colloc method use grid map deriv kosloff talez proper choic paramet alpha roundoff error kth deriv reduc on2k lgek epsilon machin precis n number colloc point drastic reduct roundoff error make map chebyshev method competit algorithm comput second higher deriv larg n sever aspect map chebyshev differenti matrix also studi reveal map chebyshev method requir much less pi point resolv wave eigenvalu less sensit perturb roundoff error larger time step use solv pde advantag map chebyshev method achiev maintain spectral accuraci b introduct 5 address issu roundoff error comput deriv use chebyshev colloc method detail method see canuto et al 1 gottlieb orszag 2 show construct chebyshev colloc deriv offln 2 roundoff error ffl machin precis n number colloc point care construct entri deriv matrix pde involv higher deriv first exampl viscos term navierstok equat fourth deriv term kuramotosivashinski equat problem roundoff error kth deriv offln 2k ruin comput solut even k n larg limit applic chebyshev colloc method certain type pde valu n paper investig way modifi chebyshev colloc deriv reduc roundoff error also improv accuraci state 5 roundoff error reduc basi function base polynomi sinc roundoff error chebyshev colloc method alreadi achiev theoret minimum therefor hope reduc roundoff error polynomi basi function must replac someth els one way appli coordin transform specif chebyshev colloc point map new set point paramet ff transform function g ff onetoon onto map also appli polynomi basi function chang well paper concentr map form 4 kosloff talez show map increas minimum space deltax colloc point gamma2 gamma1 argu reduc spectral radiu differenti matrix 2 show similar effect roundoff error moreov map reduc roundoff error also requir less point per wave number standard chebyshev method section 2 introduc chebyshev colloc method deriv matrix section 3 illustr problem larg roundoff error comput higher deriv use standard chebyshev colloc method discuss transform chebyshev colloc point properti section 4 minimum roundoff error estim standard map differenti matrix section 5 section 6 numer result standard vs map chebyshev colloc method demonstr studi effect map eigenvalu spectrum matrix dirichlet boundari condit section 7 section 8 give heurist estim resolut power map chebyshev method discuss section 9 pitfal proper procedur comput map chebyshev deriv section present chebyshev colloc method consid chebyshevgauss lobatto colloc point extrema nth order chebyshev polynomi let vx smooth function domain x 2 gamma1 1 vx interpol construct n order interpol polynomi g j x g j ux polynomi degre n u shown differenti deriv ux colloc point x j comput mani differ way obviou way comput deriv matrixvector multipl entri chebyshev deriv matrix comput take analyt deriv g j x evalu colloc point x k entri matrix sin sin deriv ux becom 0 denot deriv unless specifi otherwis also log 2 n algorithm comput deriv involv fast discret fourier andor cosin transform roundoff error properti mostli matrixvector multipl concentr matrixvector multipl algorithm mention occasion tabl 1 absolut maximum error kth deriv 3 accuraci comput higher deriv section show numer experi illustr larg roundoff error standard chebyshev colloc method comput first four deriv test function map kth deriv comput multipli vector gamma deriv matrix k time tabl 1 show absolut maximum error first four deriv differ number chebyshev colloc point clearli illustr problem one wish obtain higher deriv use chebyshev colloc method absolut maximum error fine first deriv accept second deriv n 128 third fourth deriv error becom unaccept n 64 n 32 respect rate growth roundoff error shown tabl 1 approxim 2k see section 5 detail similar conclus reach function sinc situat quit gener chebyshev differenti matrix sinc matrix alreadi achiev minimum roundoff error possibl manipul element matrix useless situat seem hopeless unless basi function found exampl know fourier colloc method roundoff error growth like kth deriv modifi chebyshev basi function resembl fourier method way mayb reduc roundoff error howev done way preserv spectral accuraci standard chebyshev method one way achiev map chebyshev colloc point set interpol point discuss next section 4 grid transform 4 kosloff talez deriv grid transform map chebyshev colloc point new set interpol point grid transform defin sin chebyshev colloc point x j new set interpol point paramet ff 2 0 1 given function ux deriv ux evalu du dx 7 dx sin comput grid point x 7 rewritten gamma u md gamma u 10 diagon matrix element defin new differenti matrix give import properti map g ff ffl map deriv g 0 ff singular ffl deltax one show ffl posit number c 4 n coordin transform result approxim error due fact transform function g entir smooth g singular 4 section 48 kosloff talez show ff chosen approxim error roughli ffl choos ffl machin precis error coordin transform essenti guarante harmless choic ff limit n 1 substitut 12 assum jln fflj ae give minimum grid point space deltax min 0 tabl 2 ff deltax min deltax min ff deltax min 0 ratio function n tabl 2 ff shown function n fix accuraci machin precis cray c90 also list sever valu equat 15 minimum space without map rel size ffn equat 15 impli deltat odeltax min invers proport jln fflj henc larger deltat achiev reduc accuraci ffl interpol situat might accept problem demand high accuraci solut howev tabl 2 also clearli show one still get slightli larger time step without degrad accuraci approxim paper interest issu stabil accuraci allow us fix accuraci requir ffl machin precis choos ff function n alon 5 estim roundoff error section discuss two estim roundoff error 5 section 4 construct follow estim roundoff error ignor round error except occur function vector u store singl precis assum error occur randomli specif assum uncorrel zeromean varianc ie rm averag valu machin precis assumpt averag roundoff error ith compon deriv ik averag l 2 norm error reason estim maximum error see e cheb averag roundoff error chebyshev colloc deriv correspond error deriv use map sinc ii small near edg grid e cheb larg expect map reduc roundoff error usual error larger round error happen comput occasion smaller lucki cancel error estim use lower bound algorithm comput du abl come close use tri improv algorithm mani algorithm comput deriv abl approach bound estim roundoff error heurist estim base minimum grid point space finit differ method equal space point formula kth deriv p jk number pascal triangl o2 k size see size coeffici round error multipli roughli 2deltax k claim situat spectral approxim deriv therefor rough estim norm error take valu deltax min equat 15 give correspond error unmap chebyshev deriv 6 numer result map chebyshev method section comput higher deriv use chebyshev colloc without map techniqu use test function sinmx purpos also test function eg result rel absolut error exact numer result comput l1 pointwis norm note two way comput kth deriv use chebyshev colloc method map one way multipli matrix vector gamma u time ie gamma u k gamma u gamma u k way form express involv l u g l differenti ugx k time exampl gamma u gamma g gamma numer experi techniqu gave exactli result paper use first method simplic program map map mv fft cft mv fft cft first deriv n second deriv third deriv n fourth deriv tabl 3 absolut maximum error first four deriv tabl 3 comput maximum absolut error 1st 2nd 3rd 4th deriv function sin2x comput use cray c90 whose machin precis 65 theta gamma15 singl precis use three differ algorithm name matrixvector multipl fftrecurs cftrecurs without map g ff cosin transform recurs algorithm comput use forward invers cosin transform subroutin fcr fcrinv larclib librari local nasa langley research center sourc code avail cft fft algorithm base rfftmlt subroutin cray scientif librari routin matrixvector multipl algorithm mv use mxm subroutin librari packag base tabl 3 see solut use map chebyshev method uniformli better standard one four differenti anoth observ cft algorithm uniformli wors mv fft algorithm either standard map categori especi third fourth deriv larg n moreov matrixvector multipli mv algorithm fft recurs algorithm fft similar order error concentr discuss data obtain mv algorithm alon figur 1 compar roundoff error map chebyshev deriv error estim equat 18 22 test function sin4x vertic axi graph max errorffl see actual error come fairli close lower bound also see heurist error estim fairli close real error lower bound although depend k exactli right10001000001e071e091e11100 1000 errorepsilon lower bound error error estim figur 1 maximum error vs number grid point kth deriv lower bound equat 18 error estim equat 22 error scale machin precis ie vertic axi max errffl map map tabl 4 absolut maximum error kth deriv 61 accuraci function boundari layer well known chebyshev method good resolut power function boundari layer well map chebyshev method function test function type gradient boundari layer adjust vari paramet ffi 0 smaller ffi becom steeper gradient near boundari paramet k set 2 comput deriv two differ tabl 4 show absolut maximum error case 09 gradient case larg data show algorithm perform equal well small n howev larg n 32 higher deriv map chebyshev method outperform unmap one tabl 5 show absolut rel maximum error case seen tabl 5 unmap chebyshev method perform better small n 32 specul map chebyshev method need point resolv high gradient near boundari quit selfevid function well resolv n 64 map chebyshev method perform better higher deriv sinc error mask larg function valu examin error rel sens third fourth deriv rel accuraci use map rather good fourth deriv 15 error map rather 430 error standard chebyshev method absolut map map tabl 5 absolut rel maximum error kth deriv 7 eigenvalu spectrum differenti matrix section analyz eigenvalu spectrum standard map chebyshev matric respect subject dirichlet boundari condit equival delet first row column matrix eigenvalu comput imsl subroutin evlrg import issu time stabil condit deltat fix 1 explicit time march scheme exampl rungekutta adamsbashford scheme control largest eigenvalu eigenvalu separ two group larg imaginari part ie larger call outlier other outlier stabl perturb matrix 3 trefethen trummer found nonoutli eigenvalu extrem sensit perturb matrix element simpli store element matrix singl doubl precis would complet chang spectrum matrix chang eigenvalu would larg neg real part order 2 n 1 howev show given precis ffl nonoutli eigenvalu neg real part eigenvalu lost 3 simul perturb lower precis arithmet perturb come repres matrix element finit precis figur 2a 2b show eigenvalu spectrum standard chebyshev differenti matrix 32 64 bit precis arithmet respect case exhibit spuriou eigenvalu larg neg real part form arc left 1 largest neg real part comput bit precis much larger comput 64 bit precis fix n way elimin spuriou eigenvalu use much higher precis arithmet undesir impract numer solut pde howev eigenvalu map chebyshev differenti matrix dirichlet boundari condit behav differ figur 2c 2d show eigenvalu spectrum standard chebyshev differenti matrix 32 64 bit precis arithmet respect 32bit precis matrix eigenvalu left line ffl form small arc 64bit precis none less 10 eigenvalu neg real part less 1ln ffl henc conclud stabil numer scheme base map chebyshev colloc method much less sensit precis arithmet unmap method import observ even 64 largest eigenvalu consider smaller map case unmap case also largest eigenvalu singl precisionmap matrix smaller largest eigenvalu doubleprecisionmap matrix largest eigenvalu gamma919 sigma351977 absolut valu e largest eigenvalu gamma521 sigma207987 absolut valu e 214426 ratio close valu 1732 tabl 2 100200a bit precis b 64 bit precis map c bit precis map 64 bit precis figur 2 eigenvalu spectrum standard map chebyshev differenti matrix ab cd respect 32 ac 64 bd bit precis arithmet ff map comput use differ valu ffl 32bit 64bit precis matric seen tabl 6 neg eigenvalu lie real axi grow like 125 least valu n tabl substanti smaller 2 growth seen use standard differenti matrix result 125 actual quit surpris follow reason recal trace detail spectrum singl precis map deriv matrix figur 3 trajectori eigenvalu map chebyshev deriv matrix size perturb matrix increas ffl doubl precis ffl singl precis ff comput accord 32bit precis ffl comput ieee doubl precis r 127 133 120 118 tabl neg eigenvalu lie real axi 0 local expon growth ie r matrix defin eigenvalu anticentrosymmetr ac matric ie satisfi equat 4 trace ac matrix easili shown zero suppos modifi matric throw away first row column call matric ff sinc 00 suppos small map forc eigenvalu closer imaginari axi let take limit n 1 trace real also eigenvalu experiment alway found left halfplan would make useless solv parabol pde rest section assum use knowledg tr say thing spectrum let us consid two extrem arrang eigenvalu satisfi equat 30 31 first suppos eigenvalu one lay imaginari axi real part remain one would tr maxim suppos eigenvalu real part dn 8i minim realiti fall extrem jln fflj 33 125 growth rate eigenvalu lie real axi shown tabl 6 hold n larg enough n exceed limit given equat 32 therefor 125 growth rate asymptot rate n 1 asymptot growth rate real part eigenvalu tabl 6 see r decreas presum n1 r approach 1 case legendr deriv matrix trefethen trummer found sensit eigenvalu matrix effect rais spectral radiu 2 infinit precis spectrum legendr matrix similar chebyshev matrix except doesnt 2 outlier heurist expect map reduc spectral radiu jln fflj reason thing fear eigenvalu sensit might creat eigenvalu larg neg real part increas spectral radiu jln fflj happen least gener eigenvalu larg neg real part equat prevent eigenvalu real part bigger jln fflj equat 33 least eigenvalu left line 1jln fflj clear mean eigenvalu chang roundoff error sinc eigenvalu farthest left appear outlier stabl anyway figur 3 show eigenvalu map deriv matrix chang matrix perturb increas size comput eigenvalu matrix entri matrix e random number uniformli distribut interv curv shown figur 3 path taken eigenvalu complex plane went 10 gamma15 5 theta 10 gamma8 map use valu ff consist comput done ieee doubl precis use lapack subroutin dgeevx end curv diamond smallt end nonoutli eigenvalu nonneg imaginari part shown clearli seen least eigenvalu effect roundoff error diamond dont appear curv attach eigenvalu affect perturb contradict statement 4 eigenvalu map chebyshev matrix affect roundoff error much less unmap matrix resolut power map chebyshev method standard chebyshev method requir least point per wave begin resolv oscillatori function like sinmx mani point map chebyshev method requir limit ff 1 grid point becom equal space chebyshev polynomi becom cosin function resolut requir two pointswav howev ff function n never reach one clear realli happen claim without proof grid begin resolv function densiti point reach two point per wave center domain densiti point lowest impli function cosmx resolv limit n 1 mean per wave requir comput normal l 2 error function cosmx mani n figur 4 x axi repres invers wave number normal factor previou section examin data care fix wave number error decay exponenti fast ffl n increas soon nmg 0 0 ff 1 impli minimum g 0 0 ff point need resolv wave tabl 7 show typic valu g 0 0 ff variou sampl n ffl fix 65 theta 10 gamma15 larg n two point per wave need close perform fourier method figur 4 normal l 2 error function cosmx mani n tabl 7 number pointswav vs n 9 comput deriv sinc comput kth deriv k n larg result larg roundoff error worthwhil work extrahard minim section discuss sever nonobvi sourc roundoff error show avoid 91 illcondit comput associ map recal grid transform function ff map grid point x unmap chebyshev grid point deriv g jffj near 1 jg 0 j larg problem roundoff error associ store singl precis result error x size offlg 0 largest valu 1 comput transform deriv ii also illcondit avoid excess error result problem x ii need comput extend precis store singl precis failur result loss 1 digit precis n larger 100 92 illcondit matrix multipli use form k obviou way obtain kth deriv matrix k construct first deriv matrix multipl bad idea matrix multipl illcondit sum must evalu obtain entri 2nd deriv matrix 2 ignor term sum term sum chang sign twice j problem mean partial sum much larger final sum roundoff error basic proport size partial sum see 6 partial fix ad term sum random order rather order increas k better idea simpli use closedform express entri matrix cours closedform express entri matrix md k strong argument favor use long form map deriv matrix ie accord equat 24 93 cosin transform algorithm algorithm comput matrixvector product one involv discret cosin transform u oper transform data invers cosin transform one way comput cosin transform symmetr extend u vector length 2n fft longer vector two faster altern algorithm describ dollimor 8 cooley lewi welch 7 involv preprocess step fft vector length n postprocess step unfortun pre postprocess step illcondit algorithm ffl roundoff error compar offl roundoff error symmetr extens algorithm use comput chebyshev deriv give 3 ffl roundoff error rather 2 ffl swarztraub 9 describ cosin transform appear free roundoff error prob lem least fast dollimor algorithm howev mani publiclyavail subroutin encod dollimor algorithm abl find exampl swarztraub algorithm acknowledg author would like thank prof alvin bayliss bring subject author attent comput time cray ymp provid us armi corp civil engin waterway experi station high perform comput center first author would like acknowledg support research afosr grant 9310090 darpa grant n0001491j4016 nsf grant dms9211820 r spectral method fluid mechan numer analysi spectral method theori applic instabl phenomenon spectral method modifi chebyshev pseudospectr method accuraci speed comput chebyshev colloc deriv accuraci float point summat fast fourier transform algorithm program consider calcul sine cosin laplac transform algorithm use fast fourier transform symmetr fft tr ctr j mead b zubikkow iter pseudospectr method delay partial differenti equat appli numer mathemat v55 n2 p227250 octob 2005 r barrio j pea numer evalu pth deriv jacobi seri appli numer mathemat v43 n4 p335357 decemb 2002 elsay e elbarbari salah elsay higher order pseudospectr differenti matric appli numer mathemat v55 n4 p425438 decemb 2005 w lyon h cenicero chandrasekaran gu fast algorithm spectral colloc nonperiod boundari condit journal comput physic v207 n1 p173191 20 juli 2005