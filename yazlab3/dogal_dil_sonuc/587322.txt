spars serial test uniform random number gener differ version serial test test uniform independ vector success valu produc pseudorandom number gener studi test partit tdimension unit hypercub k cubic cell equal volum gener n point vector hypercub count mani point fall cell comput test statist defin sum valu univari function f appli k individu counter overlap nonoverlap vector consid differ famili gener linear congruenti tausworth nonlinear invers etc differ way choos function choos k compar formula obtain estim sampl size requir reject null hypothesi independ uniform random variabl function period length gener class altern correspond linear gener effici test turn k gg n contrast usual done recommend simul book use overlap vector b introduct aim paper examin certain type serial test test uniform independ output sequenc generalpurpos uniform random number gener rng found softwar librari rng suppos produc imit mutual independ random variabl uniformli distribut interv 0 1 iid u0 1 short test rng whose output sequenc u amount test null hypothesi iid u0 1 approxim multidimension uniform good rng usual design theoret multiset vector rst success output valu possibl initi seed cover tdimension unit hypercub 0 1 evenli least 0 0 chosen somewher 5 50 initi seed chosen randomli view sens sampl space point chosen random approxim uniform distribut 0 1 background construct rng see exampl 13 17 21 35 larg structur typic hard analyz theoret moreov even small one would often gener sever success tdimension vector form u statist test come play depend structur vector hard analyz theoret excess regular impli statist test fail sampl p lecuy r simard depart dinformatiqu et de recherch operationnel universit de montreal cp 6128 succ centrevil montreal h3c 3j7 canada e mail lecuyeriroumontrealca simardriroumontrealca wegenkittl institut mathemat univers salzburg hellbrunnerstrass 34 a5020 salzburg austria email sterandommatsbgacat work support nation scienc engin research council canada grant odgp0110050 smf0169893 fcarquebec grant 93er1654 austrian scienc fund fwf project p11143mat perform rst author visit salzburg univers north carolina state univers 199798 thank peter hellekalek jame r wilson size approach period length gener close period length one get troubl begin sever goodnessoft test h 0 propos studi past see eg 13 9 26 41 refer therein statist test never certifi good rng dierent type test detect dierent type decienc diversi avail batteri test better simpl wide use test rng serial test 1 6 8 13 oper follow partit interv 0 1 equal segment determin partit 0 1 cubic cell equal size gener nt random number u construct point v let x j number point fall cell j multinomi distribut paramet 1k usual version test describ exampl 6 13 14 among place base pearson chisquar statist averag number point per cell distribut x 2 h 0 approxim chisquar distribut k 1 degre freedom 5 say paper consid test statist gener form f nk realvalu function may depend n k interest instanc power diverg statist realvalu paramet understand limit could also consid seem unnecessari context paper note power diverg statist studi 39 refer given gener class diverg famili f nk x form f nk consid f nk denot indic function correspond number cell least b point number empti cell number collis respect interest dens case 1 also spars case small sometim much smaller 1 also consid circular overlap version statist u replac v slightli modi setup constant n replac poisson random variabl mean n x vector iid poisson random variabl mean instead multinomi vector distribut becom easier analyz iid properti larg k n howev dierenc two setup practic neglig experi rstorder test observ valu say reject h 0 pvalu much close either 0 1 function f usual chosen p close 0 mean point tend concentr certain cell avoid other wherea p close 1 mean distribut cell excess uniform p view measur uniform approxim random variabl h 0 distribut approxim continu secondord twolevel test would obtain n independ copi say theoret distribut h 0 compar empir distribut uniform twolevel procedur wide appli test rng see 6 13 16 29 30 main support argument test rng sequenc global level also local level ie could bad behavior short subsequ cancel larger subsequ permit one appli certain test larger total sampl size exampl memori size comput limit valu n andor k serial test total sampl size exceed n take n 1 extens empir investig indic xed total sampl size nn test rng test typic ecient correspond test n 1 mean typic rng type structur found one reason long subsequ usual found practic subsequ length word rng start given seed fail spectacularli certain test usual fail test admiss seed common way appli serial test rng select specic gener arbitrarili chosen test paramet run test check h 0 reject aim paper examin systemat way interact serial test certain famili rng famili take rng period length near 2 e chosen basi usual theoret criteria integ e rang 10 40 examin dierent way choos k construct point v pvalu test evolv function sampl size n typic behavior take reason valu say n threshold n 0 converg 0 1 exponenti fast n main interest examin relationship n 0 e adjust crude regress model form log e two constant small nois result give idea size period length rng requir within given famili safe respect serial test sampl size practic feasibl current comput turn popular famili rng linear congruenti multipl recurs shiftregist sensit test choos k proport 2 e yield mean n 0 time squar root rng period length result depend cours choic f 12 chosen exampl linear congruenti gener lcg select basi spectral test 6 13 24 serial test sensit k 2 e case k ecient test spars 1 larg valu k yield sensit test usual one k 2 e 5 excess regular lcg realli show level partit k 2 e partit eventu becom ne cell contain either 0 1 point test lose sensit xed n nonoverlap test typic slightli ecient overlap one reli larger amount independ inform howev dierenc typic almost neglig see section 53 nonoverlap test requir time random number x total number u use nonoverlap test base n point wherea overlap one base nt point exampl overlap test typic ecient also costli comput distribut gener complic compar two test xed comput budget overlap one advantag larg time gener random number import fraction total cpu time appli test section 2 collect result asymptot distribut dens case k xed n 1 spars case spars case nk 0 section 3 overlap setup section 4 brie discuss ecienc statist certain class altern systemat experi test certain famili rng report section 5 section 6 appli test short list rng propos literatur avail softwar librari wide use gener fail miser howev sever recent propos rng robust enough pass test least practic feasibl sampl size 2 power diverg test statist nonoverlap vector brie discuss choic f nk 12 correspond previous introduc test provid formula exact mean varianc limit theorem dens spars case 21 choic f nk choic f nk given tabl 21 case measur cluster tend increas point less evenli distribut cell wellknown pearson loglikelihood statist special case power diverg respect 39 h relat g 2 via relat 2 statist n b w b c count number cell contain exactli b point b 0 number cell contain least b point b 1 number collis ie number time point fall cell alreadi point respect relat n 22 mean varianc look distribut give express comput exact mean varianc h 0 number point xed n denot one obtain algebra manipul x tabl choic f nk correspond statist diverg loglikelihood neg entropi number cell exactli b point number cell least b point number empti cell number collis x x x minn x fx fy although contain lot summand formula practic spars case sinc dene tabl 21 n k larg small term small x sum nonneglig term converg 0 exponenti fast function x x rst two moment easi comput truncat sum small number term exampl 1000 rel error eh less sum stop 1000 sum stop similar behavior observ statist express 21 22 still valid dens case larger term need consid approxim mean varianc 1 error term o1n provid 39 chapter 5 page 65 poisson setup n mean poisson random variabl x j iid poisson express becom 23 limit theorem limit distribut chisquar dens case normal spars case twomomentcorrect version 6 pierr lecuy richard simard stefan wegenkittl result state next proposit mean c n proposit exactli mean varianc asymptot distribut eg 0 1 normal case read cressi 39 recommend type standard tend closer asymptot distribut standard asymptot mean varianc twomoment correct becom increasingli import get away around 1 mean varianc comput explain previou subsect anoth possibl would correct distribut eg use edgeworthtyp expans 39 page 68 give extrem complic express due part discret natur multinomi distribut gain small proposit 21 1 follow hold h 0 dens case k xed n 1 multinomi setup converg distribut chisquar distribut k 1 degre freedom poisson setup c ii spars case multinomi poisson setup standard normal distribut proof multinomi setup part found 39 page 46 wherea part ii follow theorem 1 11 note x j distribut proof simplifi poisson setup due independ p nk iid asymptot n0 1 dens case sum squar x 2 asymptot 2 k turn count random variabl n b w b c approxim chisquar dens case fact xed k clear xed b impli w b k random variabl degener poisson setup x poisson p b b 0 n b bnk p b binomi paramet k p b k larg p b small n b thu approxim poisson exact mean b 0 next result cover case well proposit 22 poisson multinomi setup h 0 suppos k 1 n 1 let 1 posit constant one also c ii proof sinc 0 one poisson case en b1 en b 0 rel contribut w b1 sum w sum correl poisson random variabl neglig compar n b n b w b asymptot distribut follow lemma 622 2 likewis condit 2 c asymptot distribut n 2 e 1 multinomi setup shown see 2 section 62 n b w b b 2 asymptot poissonkp b 0 poisson setup argument w 2 appli c use lemma 622 prove poisson setup saw alreadi n 0 asymptot multinomi case result follow theorem 6d 2 prove ii part iii obtain appli theorem 1 11 exact distribut c n 0 h 0 multinomi setup given stirl number second kind see 13 page 71 algorithm also given comput nonneglig probabl time log n implement test base c use poisson approxim 132 normal approxim 132 n 2 15 exact distribut otherwis 3 overlap vector overlap case let x tj number overlap vector j formula 21 22 mean varianc limit theorem proposit 21 22 longer stand analysi dicult disjoint case gener p x depend p x depend pair nontrivi way theoret result avail overlap multinomi setup pearson statist dens case let let x 2 equival x 2 overlap vector dimens 1 consid statist good 8 shown ex 2 exactli see eq 5 top page 280 page 284 setup usual nk 5 call overlap serial test mtupl test literatur use previous test rng eg 1 29 30 next proposit gener result good power diverg statist dens case gener given theorem 42 43 proposit 31 let power diverg statist tdimension overlap vector dene multinomi setup 1 k xed n 1 proof result wellknown 1 moreov taylor seri expans power x easili show probabl theorem a61 therefor asymptot distribut 1t complet proof spars case k simul experi support conjectur overlap emptycellscount test discuss heurist way paper call overlap pair spars occup opso suggest specic paramet without provid underli ori marsaglia zaman 32 specul n 0 approxim normal distribut mean ke varianc ke 1 3e make sens larg close zero studi empir approxim found reason accur 2 5 approxim approxim could certainli improv rene varianc formula proposit 22 ii hold overlap case well simul experi indic poisson approxim c accur say 132 alreadi quit good 1 n larg 4 test statist expect lfsr lcg mrg gener list construct point set entir period superuniformli distribut thu may afraid k larg enough cell contain 1 point c n 0 n b w b b 2 smaller expect extrem case assum distribut c h 0 approxim poisson mean n 2 2k left pvalu collis test xed number cell pvalu approach 0 exponenti fast squar sampl size n exampl k 16 k respect assum k near rng period length ie mean test start fail abruptli sampl size exce approxim 4 time squar root period length shall see precis happen certain popular class gener use statist b instead c situat sampl size requir obtain pvalu less xed small constant 2 setup c n 2 equival w 2 choos ecient test suppos opposit mani collis one simpl model situat altern iid uniformli distribut box k k 1 box alway empti h 1 w b approxim poisson mean larg 1 small instead therefor given 0 x 0 power test level 0 x 0 depend b b increas xed 0 x 0 decreas 1 decreas well nk 1 maxim power unless nk 1 larg fact test signic power 1 exce unit otherwis larg probabl one w reject mean approxim ok b 1b reason larg best choic k 1 small 1 maxim approxim take altern h 1 discuss gener follow suppos probabl larger 1k k k 1 cell smaller probabl h 1 call hole resp peak split altern k 1 k near 1 resp near 0 near 12 made extens numer experi regard power test altern found follow hole altern detect nk reason larg dens case spars case one expect sever empti cell anyway best test statist detect base number empti cell n 0 small possibl eg 0 peak altern power increas concav function rate increas typic becom small larger 3 4 higher peak narrow test statist tabl 21 usual competit 4 say altern except w b come close b nk 1 howev hard choos right b k 1 gener unknown split altern probabl k k 1 lowprob cell equal 0 easi detect collis test use c w 2 recommend power essenti c w 2 ew 3 neglig valu impli almost onetoon correspond c w 2 howev small n suce detect situat ew 2 small distribut concentr small number valu neither normal chisquar good approxim distribut cours power test would improv highprob cell aggreg smaller number cell similarli lowprob cell one need know cell priori observ extend agre made previous sever author see 39 refer therein alreadi note power decreas hole altern increas peak altern impli particular g 2 h better wors test statist x 2 detect hole peak case split altern cell probabl slightli perturb x 2 optim term pitman asymptot ecienc optim term bahadur ecienc see 39 detail 5 empir evalu rng famili 51 select famili rng report systemat experi assess eectiv serial test detect regular specic famili small rng rng famili consid name lfsr3 goodlcg badlcg2 mrg2 combl2 invexpl within famili construct list specic rng instanc period length near 2 e integ valu e rang 10 40 rng small consid seriou gener purpos softwar studi give good indic behavior larger instanc famili step n gener output number un 2 0 1 lfsr3 combin linear feedback shift regist lfsr tausworth gener three compon form mean bitwis exclusiveor constant paramet select k j reason close sequenc fung period length 2 k1 12 k2 12 k3 1 maxim equidistribut see 19 denit detail gener goodlcg linear congruenti gener lcg form prime near 2 e select period length 1 lcg excel behavior respect spectral test ie excel lattic structur least 8 dimens badlcg2 structur except chosen mediocr lattic structur 2 dimens detail valu found 24 26 mrg2 multipl recurs gener order 2 form period length 2 1 excel lattic structur goodlcg 17 21 combl2 combin two lcg propos 15 combin gener period length 1 1m 2 12 excel lattic structur see 28 detail lattic structur invexpl denot famili explicit invers nonlinear gener period length dene prime 1 mod 52 logpvalu given test statist take valu let logpvalu test exampl mean right pvalu 001 0001 given class rng given way choos k appli test dierent valu e sampl size e constant chosen test start fail approxim valu e specic dene resp smallest valu absolut logpvalu satis jj 2 resp jj 14 major valu e threshold arbitrari 53 test result exampl summari tabl 51 52 give log pvalu collis test appli goodlcg badlcg2 respect dimens log pvalu outsid set f1 0 1g correspond pvalu less 001 display symbol mean 14 14 respect column shown mostli blank left tabl lled arrow right tabl small pvalu appear strike regular e tabl also true valu e shown tabl one tabl 51 tabl 52 goodlcg fail structur regular left pvalu small collis wherea badlcg2 opposit behavior right pvalu small mani collis behavior correspond split altern describ section 4 tabl 53 give valu select rng famili collis test 2 4 dimens famili except invexpl fail sampl size proport squar root period length 12 left right pvalu less 10 14 time badlcg2 2 dimens rst fail chosen particularli mediocr 2 dimens test detect apart badlcg2 gener alway fail test due excess regular goodlcg lfsr3 exampl never cell 2 point lfsr3 distinguish two case one chosen alway odd one alway smallest power 2 latter case number collis alway 0 sinc cell contain singl point entir period gener consequ maxim equidistribut properti gener 19 left pvalu behav describ begin section 4 invexpl resist test period length exhaust gener point set randomlook instead evenli distribut howev much slower linear one appli power diverg test 4 case pvalu close collis test fact cell count observ frequent onetoon correspond valu c 1 therefor statist similar pvalu ew 3 observ valu w 3 small spars situat overlap version test valu exactli given tabl 53 mean tabl logpvalu goodlcg period length 2 e collis test base c cell sampl size tabl entri give valu symbol mean 14 14 respect 22 3 11 26 2 6 28 2 overlap test ecient nonoverlap one call rng time less appli test smaller larger number cell found increas move away 2 e typic exampl goodlcg 6 5 7 four choic k given respect wherea classic way appli serial test rng test use larg averag number point per cell dens case appli test base x 2 goodlcg k n8 found empir mean requir sampl size increas 23 instead 12 ie dens setup chisquar approxim much less ecient spars setup observ valu valu similar behavior rng famili result describ xed vari e x ie take rst two bit number vari dimens tabl 54 give result collis test setup note chang goodlcg badlcg2 test less sensit larg valu also experi twolevel test test sampl size n replic time independ collis test use test statist c total number collis n replic approxim poisson mean nn 2 e nk 2k h 0 power diverg test use test statist sum valu n c approxim n0 n 2 nk 1 h 0 respect observ follow power tabl logpvalu collis test setup tabl 51 badlcg2 gener 22 26 28 tabl collis test rng famili dimens k 2 e recal resp smallest integ jj 2 resp jj 14 major valu e test sampl e rng famili lfsr3 power test n n typic roughli test level one sampl size n n singlelevel test thu need smaller total sampl size twolevel test achiev power hand twolevel test justi sampl size n limit memori size comput hand n k counter x j implement via hash 14 pierr lecuy richard simard stefan wegenkittl tabl collis test divis dimens dimens gener combl2 techniqu requir memori proport n instead k anoth way twolevel test comput pvalu n replic compar distribut uniform via say kolmogorovsmirnov andersondarl goodnessoft test experi extens well found advantag term ecienc rng famili tri 6 reallif lcg result preced section one easili predict conserv sampl size specic rng given famili start fail verifi commonli use rng list tabl 61 cours list far exhaust tabl list select gener lcg1 lcg lcg2 lcg lcg3 lcg lcg4 lcg lcg5 lcg lcg6 lcg lcg7 lcg lcg8 lcg lcg9 lcg rlux ranlux wey1 nest weyl see 10 wey2 shu nest weyl see 10 clcg4 combin lcg 25 cmrg96 combin mrg fig 1 18 cmrg99 combin mrg fig 1 23 gener lcg1 lcg9 wellknown lcg base recurr x step lcg1 lcg2 recommend fishman 7 fortran implement lcg1 given fishman 6 lcg3 recommend 14 among other use simscript ii5 insight simul languag lcg4 numer softwar system includ ibm macintosh oper system arena slam ii simul languag note arena rng replac cmrg99 wrote paper matlab imsl librari also provid lcg1 tabl logpvalu collis test cell sampl size gener tabl logpvalu twolevel collis test base c cell sampl size replic replic gener lcg5 numer recip 38 etc suggest sever book paper eg 3 36 40 lcg6 use vaxvm oper system convex comput lcg5 lcg9 rand rand48 function standard librari c program languag 37 lcg7 taken 6 lcg8 use cray system librari lcg1 lcg4 period length 2 31 2 lcg5 lcg6 lcg9 period length lcg7 lcg8 period length rlux ranlux gener implement jame 12 luxuri level 24 luxuri level ranlux equival subtractwithborrow gener modulu 43 propos 31 use exampl mathematica accord document wey1 gener base nest weyl sequenc dene see 10 wey2 implement shu nest weyl sequenc propos dene clcg4 cmrg96 cmrg99 combin lcg 25 combin mrg given figur 1 18 combin mrg given figur 1 23 tabl 62 give logpvalu collis test two dimens lcg1 lcg6 k expect suspect valu start appear sampl size n 4 lcg denit reject n lcg4 mani collis wherea other extrapol lcg7 lcg9 expect start fail n around 2 26 bit memori size current comput allow wrote paper howev appli twolevel collis test total number collis c approxim poisson mean logpvalu tabl 63 total sampl size 32 2 24 lcg7 lcg8 fail decis collis also tri 4 collis test overlap result similar test rng last 5 tabl sever valu rang 2 25 rlux pass test 24 fail spectacularli 25 dimens logpvalu collis test 239 collis ecjh 0 166 twolevel test total number collis c much result surpris gener point v 25 dimens lie famili equidist hyperplan 1 3 apart see 20 42 note ranlux larger valu l pass test least 25 wey1 pass test 2 dimens fail spectacularli 3 point concentr small number box exampl sampl size small 14 wey2 clcg4 cmrg96 cmrg99 pass test tri 7 conclus compar sever variant serial test detect regular rng found spars test perform better usual dens one context choic function f nk seem matter much particular collis count pearson loglikelihood ratio statist power diverg famili perform approxim spars case overlap test requir sampl size n nonoverlap one reject gener ecient term quantiti random number need gener purpos paper recommend specic rng refer reader 22 23 27 33 exampl howev test result certainli elimin mani contend lcg lfsr fail simpl serial test soon sampl size exce time squar root period length regardless choic paramet thu period length less 2 50 case lcg still encount mani popular softwar product easi crack test small gener longer use among gener list tabl 61 last four pass test describ paper sampl size tri other certainli discard r oxford scienc publica tion guid simul invers congruenti pseudorandom number tutori serial test sampl number test random guid chisquar test pseudorandom number gener massiv parallel moleculardynam simul asymptot normal ecienc certain goodnessof test ranlux fortran implement highqual pseudorandom number gener luscher art comput program simul model analysi random number gener base combin four lcg select criteria test objectori randomnumb packag mani long stream substream structur properti two class combin random number gener invers linear congruenti pseudorandom number gener empir test current view random number gener new class random number gener asymptot diverg estim discret distri bution good one hard standard c librari portabl random number gener thought pseudorandom number gener test uniform distribut addwithcarri subtractwithborrow random number gener tr ctr makoto matsumoto takuji nishimura sumdiscrep test pseudorandom number gener mathemat comput simul v62 n36 p431442 3 march peter hellekalek stefan wegenkittl empir evid concern ae acm transact model comput simul tomac v13 n4 p322333 octob pierr lecuy jacinth grangerpich combin gener compon differ famili mathemat comput simul v62 n36 p395404 3 march pierr lecuy softwar uniform random number gener distinguish good bad proceed 33nd confer winter simul decemb 0912 2001 arlington virginia