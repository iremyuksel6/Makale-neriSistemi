symplect balanc hamiltonian matric discuss balanc hamiltonian matric structur preserv similar transform method close relat balanc nonsymmetr matric eigenvalu comput propos osborn j acm 7 1960 pp 338345and parlett reinsch numer math 13 1969 pp 296304 implement linear algebra softwar packag shown isol eigenvalu deflat use similar transform symplect permut matric balanc base equilibr row column norm hamiltonian matrix use symplect scale matric due given structur suffici deal lead half row column matrix numer exampl show method improv eigenvalu calcul hamiltonian matric well numer method solv continuoustim algebra riccati equat b introduct eigenvalu problem hamiltonian matric g g q 2 r nthetan g q symmetr play fundament role mani algorithm control theori area appli mathemat well comput physic chemistri comput eigenvalu hamiltonian matric requir eg comput h1 norm transfer matric see eg 9 10 calcul stabil radiu matrix 13 29 comput respons function 22 mani hamiltonian matric also close relat continuoustim algebra riccati equat care form g q 11 x 2 r nthetan symmetr solut matrix mani numer method solv 12 base comput certain invari subspac relat hamiltonian matric see eg 19 21 26 28 detail discuss relat hamiltonian matric continuoustim algebra riccati equat 12 refer 18 eigenvalu comput matric matrix pencil often preprocess use balanc procedur describ 23 25 gener matrix 2 r nthetan first permut via similar transform order isol eigenvalu ie permut matrix p 2 r nthetan comput upper triangular matric diagon matrix universitat bremen fachbereich 3 mathematik und informatik zentrum fur technomath matik 28334 bremen germani email bennermathunibremend comput row column gamma1 z zdz close norm possibl balanc consist permut step scale step scale step row column matrix scale usual lead decreas matrix norm preprocess step often improv accuraci comput eigenvalu significantli isol eigenvalu ie contain 1 2 even comput without roundoff error unfortun appli balanc strategi hamiltonian matrix h given 11 gener destroy hamiltonian structur problem subsequ eigenvalu algorithm preserv use hamiltonian struc ture past fifteen year sever structur preserv method hamiltonian eigenproblem suggest particular squarereduc method 31 hamiltonian qr algorithm 11 rank 12 recent propos algorithm base symplect urvlik decomposit 7 implicitli restart symplect lanczo method 5 larg spars hamiltonian eigenproblem appropri choic develop subroutin librari usag rais need symplect balanc routin similar transform symplect matric preserv hamiltonian structur thu order balanc hamiltonian matrix preserv structur requir permut matrix diagon scale matrix symplect section 2 give necessari background isol eigenvalu hamiltonian matric without destroy structur achiev use symplect permut matric topic section 3 equilibr row norm hamiltonian matric similar way propos 25 use symplect diagon scale matric present section 4 invari subspac eigenvector solut algebra riccati equat target comput postprocess step requir applic propos symplect balanc method discuss section 5 numer exampl use propos balanc strategi eigenvalu comput numer solut algebra riccati equat given section 6 2 preliminari follow class matric employ sequel definit 21 let n n theta n ident matrix matrix h 2 r 2ntheta2n hamiltonian hj lie algebra hamiltonian matric r 2ntheta2n denot h 2n b matrix h 2 r 2ntheta2n skewhamiltonian hj jordan algebra skewhamiltonian matric r 2ntheta2n denot sh 2n c matrix 2 r 2ntheta2n symplect sj lie group symplect matric r 2ntheta2n denot 2n matrix u 2 r 2ntheta2n unitari symplect u 2 2n uu compact lie group unitari symplect matric r 2ntheta2n denot us 2n observ everi h 2 h 2n must block represent given 11 11 import relat symplect hamiltonian matric prove proposit 22 let 2 r 2ntheta2n nonsingular gamma1 hs hamiltonian h 2 h 2n result show gener similar transform preserv hamiltonian structur symplect scale real scalar follow proposit show structur 2n theta 2n orthogon symplect matric permit repres pair n theta n matric henc arithmet cost storag accumul orthogon symplect matric halv proposit 23 24 orthogon matrix u 2 r 2ntheta2n symplect take form 2 follow wellknown properti spectra hamiltonian matric see eg 18 21 refer given therein proposit 24 spectrum real hamiltonian matrix denot oe h symmetr respect imaginari axi ie 2 oe h gamma 2 oe h spectrum hamiltonian matric therefor partit oe solv hamiltonian eigenproblem one would like comput schur form hamiltonian matric analog real schur form nonsymmetr matric done structurepreserv way definit 25 let h form g 2 r nthetan real schur form quasiupp triangular real hamiltonian quasitriangular b h 2 h 2n exist u 2 us 2n real hamiltonian quasitriangular h real hamiltonian schur form u hu call hamiltonian schur decomposit hamiltonian schur decomposit exist h 22 u chosen oe structurepreserv method hamiltonian eigenproblem ie use symplect similar transform reli follow result hamiltonian matric pure imaginari eigenvalu result first state 24 full gener given prove 20 theorem 26 let h 2 h 2n let iff pairwis distinct nonzero pure imaginari eigenvalu furthermor let associ hinvari subspac span column u k follow equival exist 2 2n gamma1 hs real hamiltonian quasitriangular ii exist u 2 us 2n u hu real hamiltonian schur form congruent j alway appropri dimens note theorem 26 follow pure imaginari eigenvalu h 2 must even algebra multipl order hamiltonian schur form h exist 3 isol eigenvalu symplect permut let p denot n theta n permut matrix easi see symplect permut matric form matric type 31 possibl transform hamiltonian matrix 22 0 z z z z z z 11 33 upper triangular either q exist p prove construct way later algorithm 34 transform hamiltonian matrix form given 32 hamiltonian matrix form 32 total 2p h read directli seen follow result lemma 31 let h 2 h 2n form 32 either g exist permut matrix 2ntheta2n upper triangular 22 g 22 2r theta 2r hamiltonian submatrix h proof let h 32 13 11 12 g 12 g 11 13 22 gammaa diag pi q r 0 r q 07 7 7 7 7 7 5 thu desir form eigenvalu relat 34 follow gammai q 0 gammai q 0 13 11 lemma 31 mere theoret interest demonstr order solv hamiltonian eigenvalu problem proceed work h 22 transform use proof gener nonsymplect want comput invari subspac eigenvector andor hamiltonian schur form given theorem 26 transform hamiltonian matrix 32 hamiltonian schur form row column accomplish use symplect permut matric form 31 therefor need anoth class transform matric definit 32 matrix p j 2 r 2ntheta2n call jpermut matrix symplect ie p c row column exactli one nonzero entri p j 2 us 2n clear similar transform jpermut matrix preserv hamiltonian structur analog standard permut similar transform p j perform without float point opera tion moreov repres sign integ vector ip length n row column k j interchang sign indic correspond entri p j 1 gamma1 entri p j row 2n deduc ip proposit 23 furthermor symplect permut matric given 31 jpermut matric lemma 33 h 2 h 2n form 32 exist jpermut matrix p j 11 12 g 11 22 g g 22 t3 11 upper triangular notat 32 proof let hamiltonian matrix h given 32 need jpermut matrix first step let obvious p 1 jpermut matrix 11 12 gammag 13 g 11 g 12 13 22 assum g q 13 t0 11 12 13 g 11 g 12 thu obtain form 39 anoth similar transform pi q defin 38 case ie q case jpermut matrix p hamiltonian matrix desir form 39 order isol eigenvalu suffici restrict symplect permut comput form 32 possibl still isol eigenvalu h 22 appli procedur use isol eigenvalu h h 22 transform h 22 form 32 process repeat isol eigenvalu found accumul permut symplect permut matrix p form 31 result similar transform 0 0 gp gp jj upper triangular either hamiltonian submatrix tt g tt isol eigenvalu defin p partit h 310 32 first step proof lemma 31 perform obtain form 37 blockstructur upper left lower right diagon block 37 complic still possibl bring upper triangular form use repeatedli sequenc permut use proof lemma 31 show 2p q eigenvalu hamiltonian matrix read directli 310 h permut similar to4 z h tt eigenvalu requir continu work h tt also eigenvector andor invari subspac requir similar transform use solv reducedord eigenproblem h tt appli whole matrix h case h transform form given 39 partit h 310 32 perform first step proof lemma 33 jpermut matrix p 1 subsequ step achiev upper triangular form first p q row column perform first distinguish case q procedur transform hamiltonian matrix h form 310 given follow algorithm note given algorithm algorithm 34 input matric g q 2 r nthetan defin hamiltonian output symplect permut matrix p matric g q defin hamiltonian matrix form end end end end end end execut outer whileloop first search row isol eigenvalu row found look column isol eigenvalu fashion guarante end isol eigenvalu although alway touch first n row column hamiltonian matrix actual implement one would cours never form permut matric explicitli store relev inform integ vector multipl permut matric realiz swap data contain row column permut detail see eg 3 rather difficult give complet account cost algorithm 34 isol eigenvalu algorithm requir 4n float point addit 2n comparison oppos 8n addit 4n comparison unstructur permut procedur 25 implement lapack subroutin xgebal 3 appli h 2 r 2ntheta2n worst case algorithm 34 would execut outer whileloop isol eigenvalu found last execut second inner whileloop case cost consist 4n 3 3 float point addit move float point number worstcas analysi eigenvalu isol permut noth left hamiltonian matrix hamiltonian schur form worstcas studi xgebal show permut part requir 8n 3 move float point number therefor conclud algorithm 34 half expens procedur propos 25 appli hamiltonian matrix 4 symplect scale suppos transform hamiltonian matrix form 310 sinc subsequ transform determin h tt scale paramet balanc h tt chosen row column h tt instead close norm possibl order simplifi notat sequel call hamiltonian matrix h let h offdiagon part h ie may without loss gener assum none row column h vanish ident otherwis could isol anoth pair eigenvalu want scale h norm row column close norm note employ techniqu parlett reinsch 25 destroy hamiltonian structur diagon scale thu perform use symplect diagon matrix matrix must form 2 r nthetan nonsingular diagon matrix let us first note obviou result hamiltonian matric sequel use colon notat see eg 15 h k hj indic kth column jth row respect matrix h lemma 41 let h 2 r 2ntheta2n hamiltonian matrix p 1 ie pnorm ith column equal norm n ith row norm ith row equal norm n proof result obviou note kxk x 2 r 2n observ structur hamiltonian matric furthermor equat 43 follow analog note conclud suffici equilibr norm first row column 2n theta 2n hamiltonian matrix use consequ lemma 41 corollari 42 let h 2 r 2ntheta2n hamiltonian matrix p 1 sinc similar transform diagon matrix affect diagon element transform matrix follow suffici consid h employ notat ith column h transpos ith row h sequel conveni use 1 result also hold pnorm comput point view also reason use 1norm sinc comput involv float point multipl furthermor reduc norm h one norm usual impli also reduct norm equilibr achiev similar way parlettreinsch method fi denot base float point arithmet oe sign integ comput fi oe closest real scalar thu h gener longer hamiltonian unfortun use symplect diagon matrix comput obtain thu gener k nevertheless equilibr 1norm h h achiev requir solv result quartic equat jg ii j remain show equat 46 posit solut theorem 43 let h 2 r 2ntheta2n hamiltonian matrix denot offdiagon part h assum none row column h vanish ident exist uniqu real number h 44 proof solut equat 46 nonzero solut k0 k k recal g ii coeffici polynomi p satisfi sinc one chang sign coeffici polynomi p descart rule sign show one posit zero p exist posit solut 46 uniqu assumpt kh therefor either ii part h either 3 0 4 0 q ii part h thu know p polynomi degre least 3 posit lead coeffici henc lim t1 hand use mean valu theorem follow exist posit zero p g ii 0 zero p third order polynomi posit zero mean valu theorem least one posit zero henc equat 46 least one posit real solut regardless valu g ii hand alreadi observ one solut conclud exist uniqu solv equat 46 whenc k h equal follow immedi corollari 42 comput exact valu equilibr ith nith row column would requir solut fourthord equat 46 sinc diagon similar transform chosen set machin number suffici find machin number fi oe closest ffi done similarli comput gener case propos 25 implement fortran 77 subroutin balanc eispack 14 successor xgebal lapack 3 start quantiti 45 evalu compar k h repeat use achiev follow algorithm algorithm 44 input hamiltonian matrix h 2 h 2n isol eigenvalu base float point arithmet output diagon matrix 2 2n h overwritten gamma1 row column norm equilibr far possibl r end r end end diag diag diag end one execut outer forloop algorithm 44 consid sweep algorithm termin whole sweep usual row column norm approxim equal sweep afterward iter make limit progress therefor parlett reinsch propos 25 modif translat problem becom let ffi determin two inner whileloop algorithm 44 comput jg ii j fl given posit constant comput algorithm 44 otherwis set behavior essenti algorithm 44 case algorithm 44 increas kh happen 1 slightli smaller one step skip would produc insubstanti reduct kh actual comput similar transform appli directli block g q hamiltonian matrix without form hamiltonian matrix thu similar transform perform use 4n gamma 4 multipl standard structur preserv scale procedur 25 appli h similar transform requir multipl recal algorithm 44 two row column equilibr time one row column treat step inner forloop standard procedur number sweep requir converg similar gener case sinc theori deriv 25 requir assumpt similar transform diagon matric step sweep ith row column equilibr far possibl accomplish algorithm 44 moreov ffi taken exact solut 46 converg sequenc similar transform stationari point prove 23 16 solut 46 sweep k lim k1 ffi k henc limit h balanc hamiltonian matrix note sweep length n standard balanc algorithm one go rowcolumn pair matrix thu sweep length 2n thu comput cost scale 2n theta 2n hamiltonian matrix algorithm 44 assum k 1 sweep requir 4n n oppos 8n 2 n standard scale procedur given 25 assum sweep requir converg gener k 1 k 2 structurepreserv scale strategi half expens standard procedur flop count base assumpt cost determin consid small o1 compar similar transform remark 45 17 propos solv matrix balanc problem use convex program approach compar complex approach algorithm 44 suppos algorithm 44 termin k 1 sweep matrix h balanc let ng theta ng eg assum e theorem 5 17 state complex comput diagon matrix posit diagon entri row column gamma1 hy balanc accuraci achiev algorithm 44 ne hmin numer experi assum respect n henc algorithm 44 consid complex 2 complex clearli superior convex program approach still case k algorithm 44 requir care implement guard underflow due largesmal ffi use bound discuss 25 implement lapack subroutin xgebal 3 take account step scale fi sigma2 rather fi xgebal 5 backtransform order eigenvalu applic far consid problem comput eigenvalu hamiltonian matrix order comput eigenvector invari subspac solut algebra riccati equat transform hamiltonian matrix real schur form consid structurepreserv method goal transform hamiltonian matrix real hamiltonian schur form given theorem 26 exist assum appli algorithm 34 hamiltonian matrix obtain symplect permut matrix p p hp form given 310 appli jpermut p j permut hamiltonian matrix row column number hamiltonian schur form ie p form given 39 lemma 33 know p j exist next appli algorithm 44 hamiltonian submatrix h tt 2 h 2r 311 obtain diagon matrix diag 22 g g 22 t3 11 2 r pqthetapq upper triangular hamiltonian submatrix h 22 a22 q22 g22 isol eigenvalu row column equilibr algorithm 44 assum hamiltonian schur form h 22 exist comput u u22 v22 v22 u22 us 2r transform h 22 real hamiltonian schur form set 22 real hamiltonian quasitriangular first n column span lagrangian hinvari subspac applic cstabl hinvari subspac desir let us assum method use transform h 22 hamiltonian schur form choos u 22 first r column u 22 ie column u22 v22 span h 22 invari subspac choic guarante isol eigenvalu 11 desir one case reorder hamiltonian schur form order move undesir eigenvalu lower right block h desir one upper left block assum want comput lagrangian hinvari subspac correspond set ae oe h close complex conjug note necessari condit order obtain lagrangian invari subspac 2 use standard reorder algorithm real schur form n theta n unsymmetr matrix given 15 30 find orthogon matrix u orthogon symplect matrix u diag u u 11 12 g 11 22 g g 22 t3 11 22 quasiupp triangular 22 therefor swap eigenvalu 22 gamma 22 note eigenvalu reorder among isol eigenvalu henc real impli 22 upper triangular reorder achiev analog reorder eigenvalu real schur form given 15 30 follow procedur use standard reorder order swap eigenvalu within 22 22 requir rotat work exclus row column n 2n order exchang eigenvalu 22 eigenvalu gamma 22 assum 22 22 sn gamma n cn given rotat matrix annihil second compon gnn u n symplect given rotat matrix act plane n 2n 11 12 1n g 11 22 g g 22 gnn 22 0 bar indic element chang similar transform next step move n upper diagon block use standard order subroutin obtain form given 51 11 2 r ngammak1thetangammak1 relat 52 hold procedur repeat 11 remark 51 hamiltonian matrix form h correspond linear system stabiliz c detect isol eigenvalu 51 given diagon element 11 neg real part otherwis eigenvalu unstabl undetect stabilizeddetect therefor mix block jpermut matrix p j ie algorithm 34 n cstabl hinvari subspac requir reorder necessari remark 52 solv algebra riccati equat use approach base hamiltonian eigenproblem symplect balanc strategi propos often enough minim error caus illscal due effect balanc hamiltonian matrix h g still may kqk ae kgk may caus larg error comput invari subspac 27 therefor anoth symplect scale use similar transform diag ae n ae 2 r appli h order achiev kak kgk kqk far possibl see 4 detail discuss sever heurist strategi achiev remark 53 everyth deriv far hamiltonian matric appli way skewhamiltonian matric n 2 sh 2n h g skewhamiltonian structur preserv symplect similar transform henc isol eigenvalu reorder etc achiev way hamiltonian matric consid transform depend sign matrix block g q distinct zerononzero isol eigenvalu absolut valu entri equilibr row norm note algorithm 44 even simplifi quit lot real skewhamiltonian matric q comput gener balanc algorithm nonsymmetr matric 45 obtain k eigenvalu skewhamiltonian matric well skewhamiltonian schur form comput numer strong backward stabl way van loan method 31 advis balanc skewhamiltonian matric use propos strategi prior appli algorithm remark 54 consid far real hamiltonian skew hamiltonian matric isol eigenvalu equilibr row column complex skewhamiltonian matric achiev exactli way structurepreserv numer backward stabl henc numer strong backward stabl method solv complex skewhamiltonian eigenproblem recent propos 8 propos symplect balanc method also use prior appli algorithm 6 numer exampl test symplect balanc strategi eigenvalu comput comput done matlab 1 version 52 machin precis 22204 theta 10 gamma16 algorithm 34 44 implement matlab function use modifi algorithm suggest 48 set suggest 25 implement lapack subroutin xgebal 3 eigenvalu balanc unbalanc hamiltonian matrix 1 matlab trademark mathwork inc comput squarereduc method use matlab function sqred implement explicit version squarereduc method see 31 also test effect symplect balanc numer backward stabl structurepreserv method hamiltonian eigenvalu problem present 7 like squarereduc method algorithm use squar hamiltonian matrix avoid form squar explicitli use symplect urvtyp decomposit hamiltonian matrix refer valu use eigenvalu comput unsymmetr qr algorithm parlettreinsch balanc implement lapack expert driver routin dgeevx 3 appli hamiltonian matrix use quadrupl precis moreov test effect balanc solv algebra riccati equat structurepreserv multishift method present 1 exampl benchmark collect 6 present intrigu result exampl 61 6 exampl 6 system data come optim control problem j100 jet engin special case multivari servomechan problem result hamiltonian matrix h 2 r 60theta60 8 isol eigenvalu tripl eigenvalu sigma200 simpl eigenvalu sigma333 algorithm 34 return permut hamiltonian matrix hn1ni l gamma1n1ni l next hamiltonian submatrix scale use algorithm 44 six sweep obtain balanc hamiltonian decreas 2norm matrix use subsequ eigenvalu comput five order magnitud eigenvalu comput squar reduc method appli unbalanc hamiltonian matrix triplet isol eigenvalu return pair conjug complex eigenvalu rel error gamma11 simpl eigenvalu rel error 396 theta 10 gamma11 simpl eigenvalu 333 rel error 77 theta 10 gamma15 balanc version eigenvalu return full accuraci sinc affect roundoff error rel error isol eigenvalu given figur 61 use rel distanc comput eigenvalu comput dgeevx estim real rel error figur 61 contain rel error eigenvalu posit real part sqred return eigenvalu exact plusminu pair 26th eigenvalu miss comput rel error balanc version zero respect machin precis eigenvalu order increas absolut valu figur 61 increas accuraci decreas ratio khk 2 jj obviou without balanc comput eigenvalu balanc matrix accur unbalanc one increas accuraci signific eigenvalu smaller magnitud reflect decreas ratio khk 2 jj less determin accuraci comput eigenvalu see 31 decreas factor khk 2 5 theta 10 gamma6 accuraci eigenvalu smaller magnitud increas almost factor figur 62 see symplect balanc also improv eigenvalu comput method propos 7 method suffer perturb accuraci comput eigenvalu similar also note unbalanc version isol eigenvalu comput rel accuraci rang 70 theta 10 gamma14 12 theta 10 gamma15 eigenvalu number rel error symplect balanc without balanc fig 61 squarereduc method eigenvalu number rel error symplect balanc without balanc fig 62 symplect urv use balanc matrix order solv algebra riccati equat multishift method describ 1 obtain follow result multishift method appli unbalanc data comput solut yield residu size 15 theta 10 gamma6 use balanc hamiltonian matrix get r show numer method solv algebra riccati equat substanti improv employ balanc exampl 62 6 exampl 13 hamiltonian matrix defin 11 diag 1 0 denot fourth unit vector four sweep algorithm 44 khk 2 reduc 10 12 15 theta 10 6 accuraci comput eigenvalu improv significantli stabil solut algebra riccati equat frobeniu norm residu defin 61 drop r 7 conclud remark seen isol eigenvalu real hamiltonian matrix deflat use similar transform symplect permut matric deflat problem scale order reduc norm deflat hamiltonian matrix equilibr row column norm remain isol eigenvalu determin comput eigenvalu deflat balanc hamiltonian submatrix invari subspac requir use jpermut matric symplect reorder strategi order obtain desir invari subspac method appli order balanc skewhamiltonian complex skewhamiltonian matric numer exampl demonstr symplect balanc significantli improv accuraci eigenvalu hamiltonian matric well accuraci solut associ algebra riccati equat comput structurepreserv method final remark acknowledg work present articl continu preliminari result deriv 4 author would like thank ralph byer heik fabend volker mehrmann help suggest r multishift algorithm numer solut algebra riccati equat contribut numer solut algebra riccati equat relat eigenvalu problem collect benchmark exampl numer solut algebra riccati equat continuoustim case structur preserv method comput eigenvalu real hamiltonian symplect pencil bisect method comput h1 norm transfer matrix relat problem fast algorithm comput h1norm transfer function matrix matrix factor symplect qrlike method matrix eigensystem routin eispack guid extens matrix comput matrix balanc complex matrix balanc algebra riccati equat invari subspac method numer solut riccati equat canon form hamiltonian symplect matric pencil autonom linear quadrat control problem solut larg matrix equat occur respons theori schur decomposit hamiltonian matric balanc matrix calcul eigenvalu eigenvec tor comput method linear control system solv continuoustim matrix algebra riccati equat condit accuraci estim algorithm linearquadrat optim fast algorithm comput real structur stabil radiu algorithm 506hqr3 exchng fortran subroutin calcul order eigenvalu real upper hessenberg matrix symplect method approxim eigenvalu hamiltonian matrix tr ctr peter benner daniel kressner volker mehrmann structur preserv challeng comput control futur gener comput system v19 n7 p12431252 octob pierluigi amodio comput eigenvalu posit definit hamiltonian matric futur gener comput system v22 n4 p403411 march 2006 peter benner daniel kressner algorithm 854 fortran 77 subroutin comput eigenvalu hamiltonian matric ii acm transact mathemat softwar tom v32 n2 p352373 june 2006