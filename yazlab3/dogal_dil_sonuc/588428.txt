longtim energi conserv numer method oscillatori differenti equat consid secondord differenti system highfrequ oscil gener linear part present frequenc expans solut discuss two invari system determin coeffici frequenc expans invari relat total energi oscillatori harmon energi origin systemfor numer solut studi class symmetr method discret linear part without error interest case product step size highest frequenc larg sens backward error analysi repres numer solut frequenc expans coeffici solut modifi system allow us prove nearconserv total oscillatori energi long time interv b introduct longtim nearconserv total energi adiabat invari numer solut hamiltonian differenti equat import wide rang physic applic molecular dynam nonlinear wave propag backward error analysi bg94 hal97 rei98 shown symplect numer integr approxim conserv total energi adiabat invari time exponenti long step size precis time length expch highest frequenc system result meaning h 0 often practic assumpt exampl spatial discret wave equat h cfl number chosen small actual comput recent gss99 hol99 new symplect symmetr timestep method studi admit secondord error bound finit time interv independ frequenc domin linear part system particular longtimestep method case comput interest situat reminisc stiff versu nonstiff differenti equat stiff integr appropri analyz consid limit behavior h 0 stiff case much insight gain studi behavior numer method wellchosen rather simpl linear nonlinear stiff model problem first step toward understand numer energi behavior hamiltonian system product step size highest frequenc small quantiti consid articl nonlinear highli oscillatori model problem x dept de mathematiqu universit de genev ch1211 genev 24 switzerland mathematisch institut universitt tubingen auf der morgenstel 10 d72076 tubingen germani email lubichnaunituebingend block arbitrari dimens nonlinear lipschitz constant bound independ situat aris celebr fermipastaulam model present numer experi clearli model problem 11 take strong restrict high frequenc confin linear part problem linear part singl high frequenc diagon form ofomega essenti sinc numer method invari diagon matrix studi longtim energi behavior class symmetr numer method use step size h product h bound away zero arbitrarili larg method integr linear part 11 exactli reduc stormerverlet method class includ method gss99 hol99 classic symmetr method stormerverlet method trapezoid rule numerov method consid articl howev use result present paper energi behavior 11 h rang linear stabil analyz hal99 approach nearconserv energi base frequenc expans solut xt 11 asymptot seri coeffici function yt z k togeth deriv bound independ turn system determin coeffici function two formal exact invari one close total energi accord partit omegagamma invari close repres oscillatori energi system numer solut deriv similar frequenc expans valid grid point nonreson assumpt h equat determin coeffici function similar structur continu problem allow us obtain two almostinvari close h rigor estim nearconserv total oscillatori energi time interv size cn h gamman restrict n come nonreson condit analysi use symmetri method requir symplect sect 2 describ numer method present numer experi fermipastaulam problem experi illustr longtim conserv total oscillatori energi nonreson situat later complet explain theori also show energi behavior method near reson behavior depend strongli properti filter function determin numer method identifi condit yield satisfactori energi conserv near reson correct energi exchang highli oscillatori compon sect 3 give complet analysi twodimension linear case 11 whole rang nonreson nearreson exactli reson case give alreadi much insight condit determin energi conserv gener situat frequenc expans analyt solut 11 introduc sect 4 numer solut sect 5 numer invari deriv sect 6 main result numer longtim conserv energi 11 formul prove sect 7 2 numer method numer experi section present numer method illustr main result paper fermipastaulam problem 21 discret consid differenti equat 11 symmetr posit semidefinit necessarili diagon real matrix assum initi valu x 0 x 0 given variationof constant formula exact solut 11 satisfi tomega gammaomega sin tomega co tomega somega ds observ tomega welldefin also singularomegagamman therefor natur consid fix step size h explicit discret homega xn gammaomega sin real function oe depend smoothli 2 method integr problem 11 without error method consist order 2 fixedomega h 0 secondord converg follow classic result articl mainli interest situat homega take larg valu longtim integr symmetr andor symplect method expect favor properti exchang n 2223 seen method symmetr gx sinc sin shown direct verif 2223 symplect discret addit 24 also hold condit requir analysi paper sinc nonlinear gx 11 depend x elimin xn 22 help 23 case symmetr discret thu get twostep recurr start valu x 1 obtain 22 recogn wellknown stormer method stiff harmon soft nonlinear fig 1 altern soft stiff spring method type 25 2223 propos studi sever author gautschi gau61 suggest take 2 choic 11 integr exactli even const deuflhard deu79 discret integr 21 trapezoid rule thu arriv 25 recent garciaarchilla sanzserna skeel gss99 introduc function oe argument g consid case method symplect hochbruck lubich hol99 consid oe paper gss99 hol99 deriv error bound finit time interv independ smooth solut articl consid gener function oe zero except possibl integr multipl sinc interest energi conserv numer solut need also approxim deriv use twoterm recurr relat 25 obtain relat 23 case symmetr method also formula possibl h nonzero integr multipl obtain 26 subtract 25 twice formula 22 symmetr method obtain formula exchang n 23 subtract result formula 23 obtain twostep recurr gamma2omega sin formula 25 27 give symmetr twostep method even 24 sati fie method exact const choic 1 consid hol99 22 experi fermipastaulam problem consid chain spring soft nonlinear spring altern stiff harmon spring see ggmv92 fig 1 variabl x displac endpoint spring movement describ hamiltonian system use symplect chang variabl u 2 get new hamiltonian system h h h c h 100 200 3001 h 100 200 300 100 200 300 c h fig 2 energi exchang stiff spring exactli form 11 numer experi consid case shown fig 1 initi valu take zero remain initi valu appli method 2223 follow data c 0 1 given 24 studi total energi 28 oscillatori energi along numer solut interv 0 400 chosen initi valu fig 2 plot three differ step size three method numer valu 1 2 3 h gamma 08 see exchang energi take place go first stiff spring energi 1 second stiff spring later third one smallest step size also plot gray numer valu perturb initi valu obtain ad 10 gamma8 u 1 0 illustr solut sensit perturb 6 e hairer ch lubich case see h well preserv whole interv even step size numer solut complet wrong experi shown preserv hold much longer interv test explan phenomenon main object paper 23 numer experi nearreson situat product step size frequenc h close multipl differ method show wide differ behavior energi conserv choic oe satisfactori numer behavior also nearreson situat obtain numer method satisfi follow addit condit condit yield longtim energi conserv valu h except h interv width oh near integr multipl 2 total energi appear conserv uniformli arbitrari valu h necess condit seen analysi linear case given sect 3 h close 2m posit integ condit 29 requir doubl zero 2m similarli h close odd multipl condit requir simpl zero choic hol99 condit 29 obvious satisfi valu h 210 violat near odd multipl condit 210 trivial satisfi h condit 29 fail near even multipl choic satisfi three condit 29 h condit 212 satisfi method previous propos literatur tabl method use numer experi sect 23 sinc 1 2k p let us illustr effect condit 29 210 211 numer solut h close multipl consid fermipastaulam problem sect 22 initi valu appli six differ method characterist given tabl 1 sign p indic correspond condit oe satisfi condit satisfi valu 22 c scale 22 fig 3 energi conserv differ method fig 4 energi conserv differ method fig 5 energi conserv differ method h give valu close violat method b c one condit 29211 fulfil fig 3 show error hamiltonian interv 0 1000 use step size maxim error size 396497 1 given 24 singular 2 2 2 2 fig 6 error total oscillatori energi function h fpu problem method show clear drift constant valu hamiltonian method b e f three condit satisfi close conserv hamiltonian well pictur correspond three method chang scale small oscil becom visibl fig 4 show experi time chosen 20000001 delta situat get qualit behavior plot oscillatori energi instead hamiltonian result experi confirm condit 29 210 211 omit interest longtim energi estim hold uniformli h fig 5 numer result nonreson case includ method give satisfactori result accur result obtain method c upper pictur fig 6 plot maxim error hamiltonian function h take step size 0025 pictur right correspond method e tabl 1 pictur left obtain method f satisfi 212 uniform converg error observ case lower pictur fig 6 show analogu deviat oscillatori energi close integr multipl 2 deviat larg method phenomenon observ alreadi linear problem see fig 8 complet analysi given sect 3 24 energi exchang energi exchang stiff compon take place time interv length fig 2 reproduc qualit correctli larg h case 1 numer frequenc expans sect 5 show condit 2 hh 2 hh 2 ii 2 ii fig 7 experi fig 6 method 25 method 216 right pictur need approxim energi exchang stiff compon h bound away zero compar equat z 2 compon 48 58 sever condit exclud method consid far except abovement method hand seen method rather poor energi conserv properti therefor extend class method 25 homegagamma2 consist function k oe k must satisfi condit 29 210 need condit 213 replac exampl method 26 equival onestep form homega xn gammaomega sin show correct energi exchang larg h method b fig 2 fig 7 compar energi conserv method 25 method step size fig 6 216 total oscillatori energi well conserv long time except h interv length oh around integr multipl eas present follow analysi done method class 25 argument extend obviou way class 214 3 longtim energi conserv linear problem start analysi case twodimension symmetr matrix satisfi 11 0 linear give alreadi lot insight illustr import condit 29212 situat differenti equat 11 becom x total energi h given 15 invari system follow assum h delta bound uniformli requir x 2 31 analyt solut exact solut 31 given gamma2 eigenvalu 11 gamma2 given initi valu x0 consequ impli quantiti remain gamma1 close constant valu delta time 32 numer solut search function b v xn xnh satisfi numer scheme 25 impli eigenvalu v correspond eigenvector section use short notat oeh sinc offdiagon element 33 small eigenvalu close ff respect correspond eigenvector fl gammafl oe gener solut thu written complex coeffici comput initi valu b obtain 22 insert studi longtim nearconserv h delta delta distinguish two case case wellsepar eigenvalu assum one condit 11 satisfi cover nearli choic h valu interv length oh exclud theorem 31 consid numer method 2223 appli 31 one restrict 35 36 step size condit 29 210 211 numer method energi h 15 16 along numer solut satisfi n 0 constant symbol odelta independ h n proof characterist polynomi matrix 33 zero comput explicitli condit 35 36 togeth 211 impli eigenvalu 33 henc suffici small h 1 2 real interv gamma1 1 angl defin therefor also real satisfi next estim coeffici b b 34 sinc v real coeffici b complex conjug b situat 35 36 assumpt 29 consequ condit b use b conveni work b xh gamma co co estim sinc h2 follow 29 210 get second relat consequ fact follow 211 statement 38 immedi consequ 39 modulu c i2 independ nearconserv hamiltonian seen similarli one condit 35 36 satisfi get floe sin 2 impli jbx 0 const togeth 38 prove statement 37 total energi case ii nearli collaps eigenvalu consid complementari case4 h 2 two eigenvalu 33 close theorem 32 consid numer method 2223 appli 31 condit 212 numer method viz n 0 uniformli h c 0 constant symbol odelta independ h n proof condit 212 numer method satisfi 29 210 theorem 31 applic therefor remain consid situat h restrict 310 condit 310 impli 1 2a 11 suffici small h assum oe 0 satisfi choic 212 guarante eigenvalu 33 real oe 11 oh 3 special choic 212 jflj 1 p coeffici 34 satisfi o1 3 2 4 2 4 2 4 2 4 fig 8 error total oscillatori energi function h linear problem hold recal consequ estim oe fact jflj 1 oe relat 312 313 thu yield 11 togeth 34 impli prove tdepend term small need relat 212 oe use also 312 313 obtain sin complet proof theorem 32 proof show gener situat theorem 31 first term righthand express 314 becom neglig longtim conserv conclud 12 6 0 cosh 14 e hairer ch lubich oe fl 1 oe fl oe floe oe initi condit b none term 314 neglect differ integr multipl 2 express 314 remain close constant valu result intuit clear situat 310 two frequenc indistinguish close numer method upper pictur fig 8 show maxim error hamiltonian hxn depend h problem 31 initi valu three curv correspond step size 005 pictur left obtain method satisfi 212 uniform converg error nice observ pictur right correspond method e tabl 1 lower pictur fig 8 plot maxim deviat oscillatori energi ixn function h confirm analysi show h satisfi 11 oscillatori energi well conserv 4 frequenc expans analyt solut main tool analysi nonlinear problem decomposit solut xt 11 smooth part highli oscillatori term smoothli vari amplitud decomposit valid finit time interv show exist two almostinvari coeffici decomposit relat total energi oscillatori energi system repeat use almost invari allow us prove longtim nearconserv oscillatori energi 41 frequenc expans assum nonlinear g 11 analyt open set consid solut 11 satisfi k compact subset assum initi valu limit harmon energy2 k e independ theorem 41 assumpt 42 41 0 solut xt eq 11 arbitrari n 2 expans form e ikt z k rn remaind term deriv bound real function complex function z bound togeth deriv z uniqu term size gamman gamma2 constant symbol onot independ e n order deriv proof determin smooth function put e ikt z k insert function 11 expand nonlinear around yt compar coeffici e ikt notat g yz follow system differenti equat z k z k sum rang 1 multiindic integ ff j satisfi given sum larg domin term differenti equat given leftmost express howev sinc central term involv higher deriv confront singular perturb problem interest smooth function satisfi system defect size gamman spirit euler deriv eulermaclaurin summat formula see eg haw96 remov disturb higher deriv use iter differenti equat 4749 lead system z k formal seri power gamma1 sinc get formal algebra relat elimin variabl function f final obtain algebra relat z k z k system real secondord differenti equat 1 complex firstord differenti equat z point forget deriv take motiv ansatz 410411 truncat gamman term insert ansatz first second deriv 4749 compar like power recurr relat function f k jl show function togeth deriv bound compact set determin initi valu 411 function e xt 46 satisfi e x0 special structur ansatz 410 411 give system implicit function theorem yield local uniqu initi valu 1 0 0 assumpt 42 impli z 2 follow bounded f 2l z 2 look closer structur function g k jl seen contain least k time factor z 2 impli state bound function still estim remaind rn xt consid solut 410411 initi valu 412 construct function satisfi system 4749 defect gamman give defect size gamman function e xt 46 insert 11 henc finit time obtain slightli sharper bound 44 appli proof n replac n 2 42 hamiltonian frequenc expans consid situat 11 hamiltonian system x hamiltonian ux assum analyt let v k 4749 function satisfi sum 1 multiindic integ ff given sum write denot follow vector v satisfi system neglect gamman term hamiltonian theorem 42 assumpt 42 41 constant symbol odelta independ depend e n proof multipli 417 418 respect give dt integr 0 use v bound theorem 41 hand 414 43 use follow insert 422 423 yield statement 421 43 anoth almostinvari besid hamiltonian hy v coeffici frequenc expans anoth almostinvari depend oscil part given almostinvari turn close energi harmon oscil theorem 43 assumpt 42 41 constant symbol odelta independ depend e n proof vector hold uy differenti ident respect yield z gammak proof theorem 43 similar theorem 42 multipli relat 418 gammaikv gammak instead sum yield use 428 gammai deriv iv 424 dt v gammak sum term k gammak cancel henc statement 426 follow 429 430 use bound theorem 41 hand use argument proof theorem 42 prove second statement theorem corollari 44 xt 2 k constant symbol odelta independ depend e n proof fix 0 let v j denot vector frequenc expans term correspond start valu xjt xjt 427 vn vn vn note iv j1 0 uniqu statement theorem 41 v j1 bound 426 theorem 43 argument appli ivn vn vn 0 yield result remark alreadi known articl bgg87 oscillatori energi xt nearli preserv long time proof bgg87 complet differ use coordin transform hamiltonian perturb theori show nearli preserv time interv grow exponenti care trace ndepend constant gamman term possibl obtain nearconserv exponenti long time interv also within present framework frequenc expans 5 frequenc expans numer solut section show numer solut 22 23 nonlinear problem 11 frequenc expans similar analyt solut follow idea backward analysi motiv result sect 4 look function e ikt z k smooth yt z k depend h 1 small defect assum throughout section numer solut phix n remain compact subset region gx analyt ie 51 function calculu comput function yt z k follow function calculu conveni let f entir complex function bound jfij c e fljij converg everi function x analyt disk radiu r flh around note hd k two entir function whenev side exist particular avoid overload notat hat use letter z k analyt solut hope caus confus therefor introduc oper homega sin h 0 approxim h 2 2 next studi applic oper function form e zt leibniz rule calculu hd k e zt short calcul also yield fhde 52 modifi equat coeffici function frequenc expans oper lhd 55 condit 52 becom insert ansatz 51 expand righthand side 57 taylor seri around phiyt compar coeffici e ikt yield function yt z k multiindex proof theorem 41 ff abbrevi mtupel phiz ff get smooth function yt z k solv 58 small defect look domin term taylor expans lhd lhd ikh abbrevi 2 kh ihd situat complic 4749 frequenc expans analyt solut sever coeffici 59 may vanish due numer reson confin discuss nonreson case assum h gamma1 lie subregion small paramet exist posit constant c 2 longtim energi conserv 21 condit exclud h close integr multipl given h condit impos restrict n follow n fix integ 510 hold theorem 51 limitedenergi condit 42 nonreson condit 510 condit 53 54 condit 29 210 numer method 2224 numer solut form uniformli function satisfi 58 defect oh n2 first compon ohh n2 second compon togeth deriv function bound constant symbol onot independ h depend e n proof assumpt 510 first nonvanish coeffici 59 domin one deriv defin relat z k analyt solut theorem 41 insert 59 58 elimin recurs higher deriv motiv follow ansatz comput function z k z k z k function depend smoothli variabl 1 bound paramet h insert ansatz deriv 58 compar like power h yield recurr relat function jl function g k jl k 1 contain least k time factor oehz 2 f 2l contain least factor sinc seri 512 need converg truncat next determin initi valu 1 0 xh 51 coincid start valu x 0 x 1 numer scheme x 1 comput x 0 x 0 via formula 22 use nonreson 22 e hairer ch lubich assumpt 510 condit b formula first compon 22 x b impli second compon x x 22 b x 2 delta divis h sinc h yield four equat 513 514 515 constitut nonlinear system four quantiti 1 0 z implicit function theorem use limitedenergi assumpt 42 get local uniqu solut suffici small h condit 29 210 satisfi initi valu z 2 satisfi z 2 follow 210 512 impli z 2 estim 511 directli obtain 512 cons quentli valu b xnh insert numer scheme 25 yield defect size oh n2 standard converg estim show bound time interv size ot 2 h n first compon size oht 2 h n second compon complet proof theorem 51 53 frequenc expans deriv approxim condit 510 h 6 k integ k deriv approxim xn given 26 defin b x 0 continu analogu use condit 210 theorem 51 impli bound time interv next write function b x 0 e ikt z 0k insert relat 51 gammai equival 517 compar coeffici e ikt obtain sinc ihd particular get z 1 2 z 01 co h sin h theorem 52 assumpt theorem 51 numer solut xn given 26 satisfi uniformli function togeth deriv bound z 01 constant symbol onot independ h depend e n proof estim follow 519 theorem 51 0 1 z 01 2 use formula 512 get sharper result 54 energi along numer solut hamiltonian case gammaru total energi h oscillatori energi relat frequenc expans coeffici follow lemma 53 coeffici frequenc expans xn xn satisfi 511 521 respect proof definit 425 ibx b e z 1 e z 1 statement 523 follow fact jv formula 522 prove way 6 almostinvari numer frequenc expans section show hamiltonian case coeffici frequenc expans numer solut invari obtain sect 4 denot z k coeffici frequenc expans 51 similar 416 consid function sum taken 1 multiindic nonvanish integr compon follow theorem 51 coeffici v k satisfi r factor oeh defect 63 due presenc factor oehz 2 relat 512 defin zcompon similar relat 417 418 allow us obtain invari analogu h sect 4 61 first invari sect 42 multipli 62 63 respect thu obtain dt sinc know bound z k deriv theorem 51 switch quantiti z k get equival relat dt shall show lefthand side total deriv express depend z k deriv inde term 2l written dt similarli get z gammak z z dt z z z z dt z z z z dt z z im z z dt z z z henc exist function b depend valu function first n deriv 64 read dt yield immedi first statement follow result theorem 61 assumpt theorem 51 coeffici function proof formula b h 0 obtain formula 59 lhd togeth estim theorem 51 remark symplect discret 62 second invari proof theorem 43 function 61 consequ follow 63 gammai written z variabl becom gammai sect 61 lefthand express written total deriv function b 0 zt depend valu function z first n deriv dt theorem 62 assumpt theorem 51 coeffici function h theorem 61 proof 65 estim theorem 51 obtain condit 210 yield state formula b 0 7 longtim energi conserv numer discret abl prove main result paper show total energi h oscillatori energi nearli conserv time interv length cn h gamman n nonreson condit 510 satisfi conveni reader restat assumpt ffl limitedenergi condit 26 e hairer ch lubich ffl bounded condit 54 numer solut sequenc phix n stay compact subset domain analyt g ffl condit 53 h 0 ffl condit 29 210 numer method ffl nonreson condit 510 n 2 theorem 71 condit numer solut 11 obtain method 2224 satisfi nh constant symbol odelta independ n h satisfi condit depend n proof consid linear combin b 0 0 follow theorem 61 theorem 62 moreov theorem 61 theorem 62 togeth lemma 53 b xt defin frequenc expans 51 coeffici yt defin 517 relat 71 72 hold finit time frequenc expans defin b appli relat repeatedli interv length h frequenc expans correspond differ start valu long satisfi limitedenergi condit 42 possibl larger constant e theorem 51 give us frequenc expans coeffici yn zn correspond start valu uniqu oh n1 coeffici frequenc expans follow diagram commut term size oh n1 numer method oh n1 construct coeffici function via 512 show also higher deriv n zn h n1 zn1 0 differ oh n1 thu 73 71 use relat repeatedli obtain moreov 72 follow coeffici function correspond start valu xn construct b x 0 theorem 52 obtain give desir bound deviat total energi along numer solut argument appli ixn acknowledg grate sebastian reich draw attent fermipastaulam problem r realiz holonom constraint freez high frequenc degre freedom light classic perturb theori hamiltonian interpol near ident symplect map applic symplect integr algorithm studi extrapol method base multistep scheme without parasit solut problem energi equipartit larg system fermipastaulam type analyt numer estim numer integr ordinari differenti equat base trigonometr polynomi lifespan backward error analysi numer integr energi conserv stormertyp numer integr analysi histori gautschityp method oscillatori secondord differenti equat dynam system tr ctr van dael g vanden bergh geometr numer integr mean exponentiallyfit method appli numer mathemat v57 n4 p415435 april 2007 ernst hairer import aspect geometr numer integr journal scientif comput v25 n1 p6781 octob 2005 j franco new method oscillatori system base arkn method appli numer mathemat v56 n8 p10401053 august 2006 paul j atzberg peter r kramer charl peskin stochast immers boundari method fluidstructur dynam microscop length scale journal comput physic v224 n2 p12551292 june 2007