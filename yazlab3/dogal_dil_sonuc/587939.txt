lower bound select median present reformul 2non lower bound bent john proceed 17th annual acm symposium theori comput 1985 pp 213216 number comparison need select median n element reformul use weight function apart give intuit proof lower bound new formul open possibl improv use new formul show pairform median find algorithm ie median find algorithm start compar lfloor n2rfloor disjoint pair element must perform worst case least 201 n comparison provid strong evid select median requir least cnon comparison c 2 b introduct sort select problem receiv extens attent comput scientist mathematician long time comparison base algorithm solv problem work perform pairwis comparison element rel order element known case ith largest element among n input element found case select sort comparison base comput model quit well understood determinist algorithm model decis tree intern node repres comparison two element everi leaf repres result comput sinc must least mani leav decis tree possibl reorder n element algorithm sort n element use least dlog ne n log n n log e comparison worst case logarithm paper base 2 logarithm best known sort method call merg insert knuth 9 due lester ford jr selmer johnson 7 sort n element use n log n 133n thu gap upper lower bound narrow error second order term bound 011n problem nding median special case select ith largest order set n element although much eort put nding exact number requir comparison still annoy gap best upper lower bound current known know sort could select median rst sort select middlemost element quit evid could better much better question receiv somewhat surpris answer blum et al 3 show 1973 determin median linear time use 543n comparison result improv upon 1976 schnhage paterson pipping 13 present algorithm use 3n school comput scienc raymond beverli sackler faculti exact scienc tel aviv univers tel aviv 69978 israel email doritcheckpointcom zwickposttauacil depart numer analysi comput scienc royal institut technolog 100 44 stockholm sweden email fjohanhstaffanugnadakths dor j h astad ulfberg u zwick main invent use factori massproduc certain partial order easili merg remain best algorithm almost 20 year dor zwick 5 push number comparison littl bit 295n ad green factori recycl debri merg process use algorithm 13 rst nontrivi lower bound problem also present 1973 blum et al 3 use adversari argument 15n lower bound subsequ improv 175n pratt yao 12 1973 yap 14 later munro poblet 10 improv 38 43 no1 respect proof last two bound long complic 1979 fussenegg gabow 8 prove 15n lower bound median use new proof techniqu bent john 2 use basic idea gave 1985 short proof improv lower bound 2n current best avail thu uncertainti coecient n larger nding median sort even though linear term second order term case sort sinc method base proof bent john let us describ detail given decis tree comparison base algorithm invent method prune yield collect prune tree lower bound number prune tree number leav obtain nal argument say leav prune tree almost disjoint give lower bound size decis tree section 2 reformul proof bent john assign weight node decis tree weight node v correspond total number leav subtre root v prune tree v occur proof bent john weight root approxim 2 2n show everi node v decis tree child whose weight least half weight v weight leav small proof formul way becom transpar one easili studi individu comparison rule bad algorithm point view mani problem nding maxim minim element order set nding maxim minim element order set optim algorithm start make bn2c pairwis comparison singleton element refer algorithm start way pair form discuss whether optim pairform algorithm partial order particular question pose open problem aigner 1 exampl found chen 4 show pairform algorithm alway optim interest note algorithm 5 13 pairform still open problem whether optim pairform algorithm nding median section 3 use new approach prove pairform algorithm use least 201227n comparison nd median dor zwick 6 recent abl extend idea describ obtain 2n lower bound tini 0 number comparison perform worst case median select algorithm lower bound select median 3 2 bent john revisit bent john 2 prove 2n comparison requir select median result fact gener provid lower bound number comparison requir select ith largest element 1 n concentr median select although result like bent john extend gener although proof given bent john rel short simpl present reformul two reason rst proof get transpar second formul make easier studi eect individu comparison theorem 21 bent john 2 find median requir 2n comparison proof determinist algorithm nding median repres decis tree intern node v label comparison b two children node v ab v ab repres outcom b b respect assum decis tree contain redund comparis element whose rel order alreadi establish consid univers u contain n element everi node v subset c u make follow denit everi comparison b v b 2 c outcom b everi comparison b v b 2 c outcom b proceed proof select median requir 2n parison present proof somewhat weaker result assum u contain show select two middlemost element requir comparison proof case slightli simpler yet demonstr main idea use proof theorem dene weight function node weight function satis follow three properti weight root 2 2non ii intern node v child whose weight least half weight v iii weight leaf small everi node v decis tree keep track subset size may contain largest element respect comparison alreadi made let av contain set call upper half compat v assign weight estim far solut algorithm assum element largest weight everi 2 av dene weight node v dene superscript 1 w 1 use shall shortli dene second weight function w 2 b 4 dor j h astad ulfberg u zwick case w 1 2 b 2 1 2 b 2 2 2 tabl weight set 2 av children node v rel weight v root r subset size u upper half compat r also 2 ar weight 2 2m nd promis 2m consid weight w 1 set 2 av node v label comparison b weight vs children depend element b belong minim maxim four possibl case consid tabl 21 weight given rel weight w 1 v zero indic longer compat child thu contribut weight weight w 1 vab exampl 1 w 1 otherwis seen v alway least one child weight least half weight v furthermor one four case w 1 leaf v decis tree correspond state algorithm two middlemost element found therefor one set left av sinc identi minimum element maximum element get w 1 4 follow path root tree repeatedli descend child largest weight eventu reach leaf perform least 2n prove select median also requir least 2n ison make median well dene assum 1 problem aris argument weight leav select median two middlemost element consid necessarili small enough possibl know median without know relat element contain 1 element remedi follow node v algorithm close determin minimum element essenti forc determin largest element instead done move element 0 creat set g set lower half compat v median maximum element b suitabl choic 0 max v max v b set b lower half compat v may contain smallest element u keep track bs multiset bv root r let ar contain subset size u let br empti exchang bs algorithm proce lower bound select median 5 case 2 2 tabl weight set b 2 bv children node v rel weight v weight set b dene weight b estim far algorithm solut assum element b smallest element weight node v dene begin algorithm upper part decis tree weight node still sum weight therefor dene av bv rest exactli node v except root simpli copi av bv parent node remov set upper lower half compat v respect ensur weight everi leaf small follow 2 av ne select element 0 2 min v compar fewest number element remov set av add set bv note root jmin r quantiti decreas one comparison leaf reach leaf v median known thu av empti lemma 22 let av bv dene rule describ everi intern node v label b child least half weight v ie wv ab wv2 wv ab wv2 proof tabl 21 give weight set 2 av vs children rel weight v similarli tabl 22 give weight set b 2 bv vs children rel weight w 2 v v b v w 1 v b everi 2 av b 2 bv remain check weight decreas lower half compat set b replac upper half compat set cover lemma 23 lemma 23 remov av b ad place bv fewer 4n comparison perform path root v proof set 2 av replac set ne element 0 case element min v compar fewest number element 0 compar least 2 n element get element min v compar 6 dor j h astad ulfberg u zwick least 2 n element least 4n comparison perform path root v contradict get therefor 0 compar fewer 2 n element thu jmax v bj jmax v n consequ get 4 aj thu 2 4 requir know weight root larg weight decreas fast remain shown weight leav rel small establish follow lemma lemma 24 leaf v median known wv 2m2 4 proof clearli set compat leaf set contain largest element set b contain smallest element sinc get w 2 sinc exactli element remov b obtain correspond copi b bv let comparison tree correspond median nding algorithm height least 4n done otherwis start root repeatedli descend child whose weight least half weight parent trace path whose length least 2n theorem 21 follow let us see current formal give room improv exist origin proof 2n lower bound obtain show node v decis tree correspond median nding algorithm child whose weight least half weight v consid node v along path obtain start root repeatedli descend child larger weight leaf reach could show sucient mani node path weight strictli larger half weight parent would obtain improv lower bound median select wv length path therefor depth least 2n 3 improv lower bound pairform algorithm let v node comparison tree element x singleton v compar v element two element x form pair v element x compar v neither compar element pairform algorithm algorithm start construct concentr comparison involv element part pair obtain better lower bound pairform algorithm theorem 31 pairform algorithm nding median must perform worst case least 200691n proof easi see comparison involv two singleton delay one compar second time therefor restrict attent comparison tree partial order correspond node contain two pair allow one pair enough algorithm allow construct two pair fa bg fa compar element fa bg element fa g focu attent node decis tree element pair compar second time number nonsingleton 1 v node number nonsingleton lower bound select median 7 r r r r r r r r fig 31 six possibl way b c may divid note c necessarili singleton element may part larger partial order 1 bv empti thu consid tabl 22 rest section recal av denot collect subset u size upper half compat v hl u subset u arbitrari size let ag let whl v contribut set ahl v weight v ie breviti write v fh1 h r gfl1 l g v w v w fh1 h r gfl1 l g v proceed describ intuit lie behind rest proof consid tabl 21 last section node v decis tree two case 2 b 2 2 equal like precis contribut w ab v w ba v two case total weight v equal must least one child v whose weight greater half weight v diculti improv lower bound bent john lie therefor node contribut two case 2 b 2 2 almost equal fact easili seen look origin proof given 2 suppos v node element pair fa bg compar arbitrari element c number nonsingleton v assum without loss gener b weight set 2 av vs children depend element b c belong whether c minim maxim six possibl way divid element b c shown figur 31 weight set vs children rel weight w 1 v one six case given tabl 31 tabl 31 similar tabl 21 previou section c play role b one import dierenc howev b c 2 rst row tabl 31 weight v ac equal weight v weight halv may case rst row tabl 21 contribut w abc v case b c 2 weight v neglig must least one child v whose weight greater half weight v improv lower bound obtain show contribut case 2 b 2 2 roughli equal element partial order singleton contribut case b c 2 non neglig larger number singleton partial order larger rel contribut weight w abc v weight wv v thu whenev 8 dor j h astad ulfberg u zwick case w 1 2 b 2 2 b 2 c 2 2 b 2 2 11 tabl weight set 2 av children node v rel weight v element pair b compar arbitrari element c element pair compar second time make small gain intuit made precis follow lemma lemma 32 v node element pair b compar element c number singleton v least 2 p w ac v w ca v proof inequ follow easili consid entri tabl 31 obtain second inequ exampl note wv ac w cab w ac v second inequ follow worth point tabl 31 lemma 32 need assum b use stronger condit b pair stronger condit crucial howev sequel especi lemma 34 make use lemma 32 need bound rel contribut dierent case follow lemma use tool determin bound lemma 33 let e bipartit graph let 1 2 minim degre vertic v 1 v 2 respect let 1 2 maxim degre vertic v 1 v 2 respect assum posit weight function w dene vertic g wv 1 v r proof let denot two vertic connect edg e lower bound select median 9 inequ follow exchang role v 1 v 2 use lemma 33 obtain follow basic inequ lemma 34 v node b pair number non singleton v then2 one inequ relat weight w abc v weight w acb v obtain move one element pair b inequ lose factor 1 element b join togeth factor 2 introduc element b separ factor 1i introduc proof present proof inequ w abc v 1 v proof inequ almost ident construct bipartit graph e whose vertex set v dene edg acb v singleton 2 1 suppos edg 62 min v element extrem respect 1 extrem respect 2 note b 2 min v 2 get w 1 everi set size number singleton least 1 get therefor minim degre vertic v 1 v 2 maxim degre v 1 v 2 1 2 inequ w abc v 1 therefor follow lemma 33 use basic inequ obtain lemma 35 v node b pair number non singleton 1 proof present proof rst inequ proof two inequ similar use inequ lemma 34 get rst inequ follow dor j h astad ulfberg u zwick readi show v node element pair compar second time v child whose weight greater half weight v combin lemma 32 lemma 35 get that2 wv ac wv consequ get coecient wv right hand side minim two express whose maximum taken equal happen plug valu two express get easi check f 1 0 1 pairform comparison comparison two singleton compar form pair pairtouch comparison comparison element pair compar second time pairform algorithm number singleton decreas pairform comparison pairform comparison decreas number singleton exactli two explain pairform comparison alway delay pairform comparison immedi follow comparison touch pair fa bg pairform comparison comparison touch pair g consid path trace root repeatedli descend child larger weight consequ discuss get ith pairtouch comparison along path perform number nonsingleton partial order 4i follow therefor remark made end previou section depth comparison tree correspond pairform algorithm least log lower bound select median 11 r r r r r r r r r r r r r c r r c r r c r r c r r c r r c r r c r fig 32 nine possibl way b c may divid case w 1 tabl weight set 2 av children node v rel weight v element pair b compar element pair c complet proof theorem 31 worst case proof obtain algorithm convert element quartet quartet partial order obtain compar element contain two disjoint pair proof analyz case element pair b compar arbitrari element c element c also part pair tighter analysi possibl perform anaylsi improv theorem 31 theorem 36 pairform algorithm nding median must perform worst case least 201227n proof consid comparison element pair b compar element pair c nine possibl way divid element b c among depict figur 32 may assum without loss gener element compar either c let v node comparison tree b c pair one comparion c perform let 2 av weight set vs children rel weight w 1 v one nine case given tabl 32 two possibl comparison c consid separ follow equal easili veri lemma 37 b c pair v 12 dor j h astad ulfberg u zwick follow inequ analog inequ lemma 34 lemma 38 b c pair v number nonsingleton v 1 then2 consid rst comparison c examin tabl 32 use equal lemma 37 get wvacwvac w abcd v minim express subject equal lemma 37 inequ lemma 38 fact weight nine case sum wv amount solv linear program solv linear program get seem intuit clear comparison bad comparison algorithm point view adversari like answer inde solv correspond linear program get wvad everi 0 1 may disregard comparison consider easi verifi 1f 1 result get lower bound complet proof theorem 36 lower bound select median 13 4 conclud remark present reformul 2n lower bound bent john number comparison need select median n element use new formul obtain improv lower bound pairform median nding algorithm mention dor zwick 6 recent extend idea describ obtain 2n lower bound gener median nding algorithm tini 0 believ lower bound pairform algorithm obtain substanti improv improv seem requir howev new idea obtain improv lower bound pairform algorithm may import step toward obtain lower bound gener algorithm signicantli better lower bound bent john 2 paterson 11 conjectur number comparison requir select median log 43 2n 241n r produc poset find median requir 2n comparison time bound select partial order product select median median select requir 2 tournament problem count approach lower bound select problem art comput program lower bound determin median progress select lower bound comput ith largest element new lower bound median relat problem tr ctr krzysztof c kiwiel floyd rivest select algorithm theoret comput scienc v347 n12 p214238 novemb 2005