adapt verlet method discuss integr autonom hamiltonian system via dynam rescal vector field reparameter time appropri rescal eg base normal vector field minimum particl separ nbodi problem alter timerevers symmetri flow desir maintain symmetri discret standard form mechan system without rescal achiev use explicit leapfrogverlet method show explicit timerevers integr reparameter equat also possibl parameter depend posit veloc gener rescal scalar nonlinear equat must solv step one forc evalu need new method also conserv angular momentum nbodi problem use revers scheme togeth step control base normal vector field arclength reparameter demonstr sever numer experi includ doubl pendulum kepler problem threebodi problem b introduct articl consid numer integr autonom differenti equat r n dt aris celesti mechan 22 classic atom molecular dynam 12 mani import theoret practic situat direct integr simul princip tool studi problem fix stepsiz numer integr nonlinear system 11 lead difficulti particularli neighborhood singular vector field articl describ famili effici adapt method numer solut initi valu problem equat 11 base normal dynam scale vector field recent research 17 14 10 focus develop timestep scheme preserv underli geometr structur flow system eg symplect case hamiltonian system regardless whether scheme faith preserv avail underli structur accur stabl fix stepsiz numer integr often requir excess small timestep particularli true integr vicin fix point singular principl possibl incorpor stepsiz variat mechan base local error estim mani advantag structurepreserv scheme appear lost stepsiz vari use tradit approach 4 3 7 consid approach base introduct time reparameter given appropri smooth scalarvalu function mm integr differenti equat ds ds depart mathemat univers kansa lawrenc ks 66045 usa whuangmathukansedu support part nsf epscor grant osr9255223 z depart mathemat univers kansa lawrenc ks 66045 usa leimkuhlmathukansedu support nsf grant nsf9303223 behavior trajectori extend phase space highli sensit reparameter term phase space orbit reparameter irrelev flow 12 preserv integr invari 11 flow reparameter 12 integr appropri fixedsteps discret scheme natur choic r given heurist r kfk kk euclidean 2norm choic normal vector field also view associ step time directli step arclength measur along phase space orbit choic inde variant reparameter idea use variou applic exampl base r separ particl manyparticl system singular potenti 1 13 11 techniqu 3 21 view framework r construct base embed local error estim heurist would retain approxim constant arclength project solut accur complic control could incorpor estim orbit curvatur point relat recent work 18 19 use reparameter framework design scheme better conserv variou integr energi particularli interest system base separ hamiltonian well known larg system type 1314 one encount molecular dynam comput cost simul domin forc evalu problem often solv explicit leapfrog verlet method second order symplect timerevers symmetr requir one forc evalu per step larg nbodi problem much recent work concentr find method handl singular wide vari forc without evalu full forc field everi integr step base method potentialspecif split sometim achiev effect variabl stepsiz method see 20 articl take differ approach rather tri adapt time stepsiz directli accord prescrib rescal time 1314 use correspond reparameter base norm gradient hamiltonian henc accord densiti flow line along solut gener reparameter 1314 destroy hamiltonian structur timerevers flow easili preserv coupl structur 1314 alter reparameter natur gener leapfrogverlet scheme retain featur conserv angular momentum timerevers becom implicit exampl scheme 21 3 11 lead implicit integr strategi requir evalu forc gammarv sever time per integr step main practic contribut articl show implicit remov use special discret method treat reparameter factor new variabl propag togeth physic variabl call new method adapt verlet actual discuss two variant method one base differenti equat defin reparameter factor base introduct algebra equat solv tandem equat motion use ad hoc discret scheme latter differentialalgebra approach requir addit forc evalu step recommend method typic applic stress reparameter depend q base arclength addit work adapt verlet method standard verlet consist solut singl scalar quartic polynomi equat timestep effici implement would also possibl mani choic rescal fact special case rescal base either posit momenta equat becom fulli explicit control minimum maximum stepsiz also easili incorpor framework method implement variou simpl nonlinear model meant repres typic autonom system doubl pendulum kepler problem threebodi problem found robust effici experi 2 background smooth f initi valu problem 11 ut 0 least local solut given u 0 assum solut exist time associ 11 thu flowmap oet take given point u 2 r n point u solut 11 forward trajectori pass given point set 1g two way trajectori unnatur describ solut autonom differenti equat first 11 autonom follow oet sequel write oet oe0 mean inclus initi time 0 descript solut inher arbitrari second rescal vector field solv instead dt solut u unchang except rescal time reason gener natur replac trajectori u 0 orbit u 0 defin set foetu 0 1g orbit scale translat invari onestep method solv 11 comput approxim flow map ie map deltat r n kdeltatu 0 given stepsiz deltat numer forward orbit point u 0 discret set g method said pth order accur fix k 0 independ deltat implicit midpoint method defin 11 second order accur scheme popular method integr separ system 1314 leapfrogverlet scheme deltat deltatrv q n1 4 w huang b leimkuhl scheme explicit requir one forc evalu per step 2nd order accur hamiltonian system 1314 timerevers flow consequ fact even function mean integr 1314 start point deltat unit forward time chang sign momentum integr anoth deltat unit return us start posit flow map also symplect mean two form dq dp integr motion 6 17 geometr symmetri symplect timerevers impos strong restrict possibl type fix point stabil motion neighborhood fix point recent research timestep scheme concentr find numer method deltat share timerevers andor symplect flow exampl leapfrog implicit midpoint method timerevers also symplect 6 16 implicit midpoint method gausslegendr gener preserv quadrat integr invari 5 leapfrog scheme broader famili lobatto iiiab pair partit rungekutta method shown preserv angular momentum 17 constant stepsiz use method show remark long term stabil respect energi error except presenc larg forc symplect timerevers method exhibit linear error growth period integr case 3 composit two symplect timerevers map symplect timerevers natur consid vari stepsiz step step stepsiz select strategi add layer complex discret dynam system sinc stepsiz becom function dynam variabl 7 experi standard variabl stepsiz integr heurist disappoint exampl gener stabil energi linear growth error integr system lost 16 3 timerevers variabl stepsiz method use conjunct underli symplect scheme consid calvo hairer 3 observ recaptur favor featur symplecticrevers scheme articl mainli concern treatment gener nonintegr dynam also observ linear growth error 3 kepler problem revers scheme 3 singular normal vector field interact pair bodi coulomb potenti r distanc particl regular introduct new coordin system remov singular nbodi problem twobodi interact similarli regular 1 13 15 singular repres collis three particl elimin similar problem aris singular potenti mean sort timestep contract need neighborhood singular order resolv behavior accur even without singular unlik singl fix timestep appropri along whole orbit insight select timestep obtain note mani problem norm gradient hamiltonian henc norm vector field larg place time scale chang rapidli fix stepsiz integr perform poorli norm gradient h measur fastest direct rate chang hamiltonian henc fix stepsiz integr appear fail point mani orbit get squeez togeth put anoth way fix stepsiz integr may develop instabl point densiti fig5a fig5b fig5d fig5c fig 1 fix stepsiz verlet method problem 35 flowlin system larg exampl simpl singular system consid bond problem hamiltonian orbit system phase space consist two lobe close curv separ line sampl orbit shown fig 1a although orbit quit smooth timescal chang dramat neighborhood origin path lower left extrem point orbit upper left point travers extrem rapidli fig 1b rapid variat appear except steep deriv p appli fixedsteps verlet scheme integr bond problem result sever orbit shown fig 1cd singl fix stepsiz 00001 integr proce without difficulti even high energi level long particl stay roughli right vertic line pass fix point nearer origin curv breakup rel low energi level integr becom unstabl fig 1d anoth type difficulti occur equat motion possess isol nearsingular point doubl pendulum unequ mass case cusplik turn point appear solut creat difficulti fix stepsiz integr although diagon rescal weight variabl sometim remov nearsingular behavior gener feasibl complic problem mechan need improv situat consid local reparameter time accord 12 kfuk normal vector field view control arclength measur along phase space orbit travers per unit time similar heurist view normal arclength travers along trajectori 6 w huang b leimkuhl per unit time although articl focus vector field normal method could appli work mani choic r exampl particl motion central forc may typic assum closest twobodi approach determin largest forc problem introduc control min r min repres smallest interparticl separ ff posit constant idea suggest 1 13 15 11 normal vector field reason use fix stepsiz integr howev sometim necessari limit variat r avoid excess small step neighborhood singular point easi incorpor maximum minimum stepsiz exampl given minimum time stepsiz deltat min maximum time stepsiz deltat max fictiv timestep delta set deltasdeltat min deltat bound deltat min deltat max one drawback normal becom evid case separ hamiltonian 1314 normal vector field separ mean explicit scheme particularli leapfrogverlet directli appli next section show verlet method modifi provid effici semiexplicit approach variabl stepsiz integr first show effect combin reparameter timerevers integr procedur exampl exampl 31 doubl pendulum consid doubl pendulum problem hamiltonian graviti constant 1 2 mass posit bob relat 1 2 equat motion make problem challeng gave two bob differ mass 1 hamiltonian nonsepar use symplect timerevers implicit midpoint method fix step size method littl difficulti resolv x fig 2b x fig 2a timestep hh0 fig 2c timestep hh0 fig 2d fig 2 implicit midpoint scheme fix stepsiz doubl pendulum problem use comput ac solut smooth region may fail near cusp result error increas dramat jump behavior illustr fig 2 fix stepsiz 10 gamma4 succe resolv motion near cusp stepsiz 10 gamma3 use howev result instabl energi poor resolut especi long time interv remark stabil energi observ smaller valu deltat hallmark symplect also timerevers method partli explain backward error analysi symplect method see 10 17 cusp point occur point case 1 2 vector field nearli singular conclud norm vector field larg vicin unabl integr doubl pendulum stepsiz larger fix stepsiz method extrem wast term comput sinc larg stepsiz feasibl smooth region result integr reparameter equat time interv 0 50 summar fig 3 scheme place mani point neighborhood turn point use larg timestep smooth segment incorpor stepsiz minimum deltat restrict smallest step taken vicin cusp point 380 000 step integr need problem would requir approxim 50 000 000 fix step similar accuraci 4 semiexplicit integr adapt verlet method section turn attent mechan system separ hamiltonian 8 w huang b leimkuhl time hh0 fig 4c time timestep fig 4d x fig 4b x fig 4a fig 3 implicit midpoint scheme normal vector field doubl pendulum use comput modifi equat motion 1314 reparameter time dq ds ae dp ds p system longer solvabl standard verlet method second order lobatto iiiab partit rungekutta formula 8 view gener verlet method appli 4748 equat delta start view scheme map phase space one may also replac 410 two step delta delta discret follow import featur 8 reduc verlet timerevers iii symplect problem hamiltonian ie preserv angular momentum higher order lobatto pair retain featur restrict second order method articl equat 49410 implicit requir solut nonlinear system step fact r scalar use develop rel effici newton solver base rankon updat howev still effici scheme possibl 41 differenti control subsect describ approach base introduc stepsiz control new variabl differenti equat lead discret algorithm requir evalu hessian potenti energi functionor finit differ approxim two forc evalu per step next subsect see scheme improv differenti equat ae rq p respect reparameter time yield ds ds ds theta r q r idea treat coupl system q p ae illustr choic similar scheme obtain upper lower bound builtin r describ r gamma2 p r q ds discret result coupl system obtain partit variabl q p ae use second order lobatto iiiab pair ae n 1p n 1411 ae n 1 ae ngamma 1 delta delta delta ae n 1414 412 rewritten ae n 1 delta get ae n multipli ae 2 ae delta observ 413 ae n 1p n 1 ae n 1p ngamma 1gamma deltasrv q n ae n 1ae ngamma 1 linear function ae n 1allow us conclud 415 cubic polynomi ae n 1for start may use formula ae n 1 ae n ae n 1 given converg timerevers scheme follow directli correspond featur underli lobatto scheme introduct new scalar variabl fact scheme longer symplect destroy preserv angular momentum sinc assum central forc n1 theta p n1 theta p n1 theta p ae n 1p n theta p experi use precis method describ instead replac 412 slightli differ midpoint formula ae n 1 ae ngamma 1 deltasgq result scheme converg order two linear stabil 411414 observ evid degrad perform case look mani case comput hessian matrix v 00 q intoler expens situat suggest use approxim appropri chosen ffl modif chang definit time reparameter phase space dynam requir two comput forc time step may use effici implement observ forc comput two close point configur space mean forc evalu base list nearbi interact particl list use calcul 42 coupl differentialalgebra system prefer approach view reparameter equat dq ds ae dp ds ae coupl differentialalgebra dae system 2 method previou section view regular base differenti constraint potenti drift effect degrad numer result long time interv integr sinc long time interv simul precis applic timerevers method expect make substanti differ may import correct situat moreov would like find method requir comput hessian matrix one forc evalu per step reason propos instead follow direct discret coupl dae ae deltasrv ae n 1 ae ngamma 1 rqn method requir singl evalu gammarv step scheme deriv base differenti control reduc implicit singl scalar equat ae n 1ae n 1 ae ngamma normal dynam easili seen multipli side 423 ae 2 n 1 left quartic polynomi ae n 1 gener situat arbitrari parameter r would still obtain scalar nonlinear equat solv ae particular situat comput ae n 1becom complet explicit ae n 1 2rqn depend p one simpli revers role p q stagger discret develop explicit method discret 419421 index1 differentialalgebra integr 2 standard form easili seen second order accur analyz linear stabil scheme confirm bounded converg iter standard assumpt smooth vector field bounded exact solut particular condit stabil analysi go ae remain strictli bound away zero along exact solut interest argument precis analog given x41 easili seen differentialalgebra method conserv angular momentum method clearli timesymmetr set deltat ae n 1 solv 419 p n 1and substitut 420 obtain deltat n deltat n deltat deltat thu view method tradit variabl stepsiz version stormer rule start differentialalgebra scheme given valu q could employ differenti constraint approach previou section instead use follow start step good success delta ae 1 rq 5 numer experi section give sever numer experi use new scheme case integr normal vector field without minimum stepsiz control maximum stepsiz deltat use experi conduct ieee float point arithmet use doubl precis machin excel result also obtain bond problem 35 use normal conjunct integr larg nbodi problem typic appropri sinc effect separ strong contribut forc field unreason compound determin stepsiz outsid wellstudi gravit pure electrostat nbodi problem pairwis potenti 1r see 1 13 awar systemat studi appropri time transform numer integr small problem consid experi normal vector field appear suitabl choic 51 kepler problem kepler problem hamiltonian long standard benchmark numer integr low eccentr orbit integr without difficulti use standard fixedsteps verlet method one recov good fidel relev featur flow notabl featur contrast standard result numer integr error growth use symplect method verlet linear time goal variabl stepsiz method obtain method robust respect variat eccentr e use small stepsiz orbit pass near origin thu improv effici also demonstr similar behavior three differ method method base differenti control method finit differ approxim evalu hessian differentialalgebra system figur 4 compar behavior three adapt approach give similar result experi figur 5 see adapt method easili outperform fix stepsiz method observ fig 5a energi error maximum time interv record adapt method essenti constant independ eccentr e fact rel energi error decreas slightli increas e number step variou energi error shown fig 5b sever order magnitud smaller fix stepsiz fig 5b also show second order converg adapt method fix stepsiz version difficult case shown fig 6 use adapt scheme comput high eccentr 14 w huang b leimkuhl hh0 fig2a hh0 fig2b hh0 fig2c time step time stepsiz fig2d time step time stepsiz fig2 time step time stepsiz fig2f fig 4 comparison three adapt method kepler problem f 0999 delta 001 use fig differenti formula b e differ formula c f algebra formula adapt fix 1e fig3a adapt fix number step fig3b 02 fig3c fix stepsiz 02 fig3d adapt fig 5 comparison adapt verlet differentialalgebra method nonadapt verlet method kepler problem f plot everi 100 step delta 001 use b use delta 001 use hh0 fig4a 5 fig4b fig 6 adapt verlet differentialalgebra method kepler problem use comput plot everi 100 step 52 threebodi problem final exampl look classic problem well known present sever challeng standard numer method threebodi problem gravit electrostat interact three point particl problem recent treat detail 15 thorough studi classic dynam helium sinc insight quantum mechan atom obtain understand bifurc phase space structur period orbit author point quan tit classic studi complic multidimension nonsepara biliti unbound charact motion govern singular longrang potenti problem also someth benchmark celesti mechan model calcul sought resolv format binari pair tripl follow threebodi nearcollis experi regular twobodi collis suggest 15 1 13 somewhat effici integr probabl possibl howev threebodi approach stumbl block experi 15 introduct fictiv time time reparameter separ two atom frozen nucleu helium use improv behavior dynam simul use unit mass normal gravit constant assign initi posit momenta result appli adapt method delta 05 delta 01 shown fig 7abc respect latter two integr produc nearli ident orbit sinc timestep use fig 7def order magnitud smaller third case second conclud high probabl success comput true motion notic qualit chang behavior timestep t33 time particl locat small region fig 7a fig 7b fig 7c time timestep fig 7d time timestep fig 7e time timestep fig 7f fig 7 adapt verlet method threebodi problem ad 01 cf delta 001 point 025 25 forc becom larg one particl eject two form binari pair small stepsiz need resolv close threebodi interact much larger stepsiz use resolv motion binari pair qualit chang also illustr energi plot three calcu lation shown fig 8 averag stepsiz use three variabl stepsiz simul 0012 000081 0000073 attempt solv problem use fix stepsiz disastr result shown fig 9abc case integr becam complet unstabl vicin threebodi approach energi error extrem small earli go rose dramat suddenli event fig 10 show closeup earli behavior case stepsiz smaller orbit success integr fix stepsiz method shown fig 11 6 conclus long known use time reparameter improv behavior numer method dynam system particularli orbit pass neighborhood singular point vector field articl introduc adapt verlet method timerevers integr reparameter nbodi problem shown robust effici numer experi one limit approach yet precis quantit understand relationship free paramet delta accuraci orbit subject current work also investig effici higherord adapt timerevers method work time energi error fig 8 fig 8 energi error adapt verlet method step refer delta appli method constrain mechan system acknowledg skeel read preliminari draft articl provid use comment 200200x fig 9a 200200x fig 9b x fig 9c time energi error fig 9d time energi error fig 9e time energi error fig 9f fig 9 fix stepsiz integr threebodi problem ad time energi error fig 10b x fig 10a fig 10 fix stepsiz integr threebodi problem vicin 25 2 time energi error fig 10b x fig 10a fig 11 fix stepsiz integr threebodi problem 20 w huang b leimkuhl r integr method small nbodi system numer solut initi valu problem differentialalgebra equat accur longterm integr dynam system develop variablestep symplect integr stabil rungekutta method trajectori problem canon integr techniqu variabl stepsiz ruin symplect integr symplect partit rungekutta method matrix comput backward error analysi numer integr symplect method build better leapfrog numer integr method moleculardynam numer experiment view fewbodi problem explicit canon method hamiltonian system classic mechan twoelectron atom chapman hall stabil symplect energymomentum algorithm nonlinear hamiltonian system symmetri symplect integr variabl stepsiz variabl step revers integr method aspect chaotic behavior solar system tr ctr b cano durn techniqu construct symmetr variablesteps linear multistep method secondord system mathemat comput v72 n244 p18031816 octob b cano durn analysi variablesteps linear multistep method special emphasi symmetr one mathemat comput v72 n244 p17691801 octob ben leimkuhl effici multipl timescal revers integr gravit nbodi problem appli numer mathemat v43 n12 p175190 octob 2002