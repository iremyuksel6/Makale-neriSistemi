column approxim minimum degre order algorithm spars gaussian elimin partial pivot comput factor spars matrix row order p select factor use standard partial pivot row interchang goal select column preorder q base sole nonzero pattern limit worstcas number nonzero factor fillin also depend p q select reduc upper bound fillin subsequ choic p choic q dramat impact number nonzero l u one scheme determin good column order comput symmetr order reduc fillin choleski factor ata convent minimum degre order algorithm would requir sparsiti structur ata comput expens term space time sinc ata may much denser altern comput q directli sparsiti structur strategi use matlab colmmd preorder algorithm new order algorithm colamd present base strategi use better order heurist colamd faster comput better order fewer nonzero factor matrix b introduct spars gaussian elimin partial pivot comput factor spars nonsymmetr matrix p q permut matric l lower triangular matrix u upper triangular matrix gilbert peierl 30 shown spars partial pivot implement time proport number point oper requir method use matlab solv system linear equat spars 27 improv implement spars matrix packag superlu 11 solut process start nding sparsitypreserv permut q next permut p select numer factor use standard partial pivot row interchang permut p select without regard sparsiti goal comput sparsitypreserv permut q sole pattern lu factor remain spars possibl regardless subsequ choic p result code incorpor superlu matlab version 6 section 2 provid theoret background algorithm section 3 describ symbol lu factor column interchang precursor colamd order algorithm present section 4 section 4 also describ variou metric select column evalu design code experiment result squar nonsymmetr matric rectangular matric symmetr matric present section 5 section 6 present conclus describ obtain colamd symamd code notat follow set subtract denot n oper ator use jj denot either absolut valu scalar number nonzero entri matrix size set usag clear context structur matrix denot structa set contain locat nonzero entri 0g throughout paper algo rithm assum exact numer cancel occur entri matrix may happen becom zero factor caus accident cancel still refer nonzero entri let given nonsymmetr matrix assum nonsingular follow du 14 row column permut diagon entri permut nonzero therefor assum throughout paper given matrix permut accordingli zerofre diagon suppos l u triangular factor obtain gaussian elimin partial pivot appli row permut p consid symmetr posit denit matrix choleski factor l c lower triangular georg ng 25 show zerofre diagon pattern lc l includ pattern l u regardless row permut use partial pivot summar result follow theorem theorem 21 georg ng 25 let nonsingular nonsymmetr matrix zerofre diagon let l c denot choleski factor let l u lu factor obtain partial pivot structu structl entri within column l rearrang yield triangular matrix l struct gilbert ng 28 also show bound u tight strong hall matrix theorem 22 gilbert ng 28 let nonsingular nonsymmetr matrix zerofre diagon assum strong hall let lc denot choleski factor let l u lu factor obtain partial pivot choic exist assign numer valu nonzero entri u ij 6 0 well known sparsiti l c depend drastic way row column permut 23 thu theorem 21 1 matrix strong hall everi set k column 1 k n 1 contain least row strong hall matrix irreduc see coleman et al 6 detail 22 suggest way reduc amount l u 25 26 given matrix rst form pattern comput symmetr order q reduc amount lc final appli permut q column main disadvantag approach cost form even spars product may dens consequ time storag requir form product may high primari goal paper describ order algorithm comput q pattern without explicitli form 3 symbol lu factor column order techniqu base symbol analysi convent outerproduct formul gaussian elimin nbyn matrix row interchang maintain numer stabil let denot bottom right n kbyn submatrix k 1 gaussian elimin perform assum row column k label k 1 n kth step gaussian elimin one nd entri largest magnitud column k k 1 swap row place entri diagon column k l scale version column k k 1 row k u row k k 1 outer product column k l row k u subtract k 1 give k result factor permut matrix determin row interchang spars updat use outer product may turn zero entri nonzero new nonzero entri refer llin amount llin occur depend order column elimin 23 goal therefor nd column order q matrix prior numer factor lu factor columnpermut matrix aq sparser lu factor origin matrix regardless p chosen anoth applic column order spars qr factor 33 order control llin occur spars need know nonzero pattern matric k k 0 n 1 determin column order q attempt keep factor aq spars factor progress must comput symbol pattern l u k account possibl row interchang may occur numer factor actual structur l u k factor pa specic row permut p subset pattern let l k u k denot nonzero pattern column k l row k u respect k let r k denot set column indic nonzero entri row k r k similarli j k let c k denot set row indic nonzero entri column j k note denit impli 1 k j describ comput l k u k k order increas k begin use assumpt zerofre diagon easi see pattern kth column l simpli column k k 1 may take regardless nonzero numer valu interchang consid possibl nonzero pattern kth row u partial pivot row select pivot row k 1 ik nonzero mean potenti candid pivot row correspond set l k pattern kth pivot row bound union candid pivot row 26 may take arbitrari row r 2 l k select pivot row r k 1 2 l k u k accommod row interchang due numer partial pivot outer product step multipl pivot row ad row pivot column pattern row matrix k outer product step must contain set u k n fkg sinc know row pivot row bound pattern row k r k note row l k n fkg pattern save time space store step modi one row modifi row nonzero pattern let fkg step p l k n fkg l p r p nfkg thu step k replac row singl superrow r k r repres pattern row set l k nfkg integ r arbitrari placehold symbol factor algorithm choos arbitrari row index set c k 1 dene r set row size jrj repres superrow r symbol factor start everi row belong exactli one set ie frg comput symbol updat need place singl repres r set c k remov discard row l k n frg sherman 43 introduc concept supercolumn context spars choleski factor simplic step k set r c repres bound pattern k lu factor also quotient graph represent 17 21 matrix obtain kth step choleski factor column preorder method requir pattern l u discard result algorithm shown figur 1 requir ojaj space superscript r c drop clariti initi storag requir ojaj step k r r comput r r r ia n fkg 2 set r c k n frg discard outer product form column c j j 2 r r reduc size stay 2 impli 9i 2 c k j 2 r symbol lu factor algorithm n determin pattern pivot row column let r arbitrari index c k outer product updat end end end figur 1 symbol lu factor algorithm impli j thu step strictli reduc total storag requir pattern k total time taken domin symbol updat comput pivot row r r entir algorithm take total oju j time sinc fkg pattern odiagon part row k u sinc r r discard includ set union subsequ pivot row modifi singl column c j symbol updat take oja j j time sinc jc j j ja j j column j modi row u k contain column index j thu column j modi ju j j time entir algorithm u j upper bound pattern column j matrix u row permut p due partial pivot thu total time taken nonzero pattern u accommod row permut p due partial pivot time requir comput spars matrix product au typic much less time requir numer factor equal time requir comput spars matrix product l time u 31 faster method exist comput upper bound symbol factor partial pivot georg ng method 26 comput pattern l u take ojlj column order xed method produc nonzero pattern k howev use basi colamd algorithm describ next section 4 colamd order algorithm present column order method base symbol lu factor algorithm present last section time complex storag requir step k select pivot column c minim metric candid pivot column attempt reduc llin column c k exchang presenc dens nearli dens row column greatli aect order qualiti run time singl dens row render bound useless bound nonzero pattern 1 complet dens matrix hope dens row select rst pivot row numer factor withhold row order algorithm dens column aect order qualiti increas order time singl dens column increas order time 2 dens column withheld symbol factor order algorithm place last column order q determin dens row column ignor problem depend use default threshold use matlab 50 probabl high matric take advantag supercolumn greatli reduc order time symbol updat step look column j set r r two column pattern test via hash function 2 merg singl supercolumn save time storag subsequ step select supercolumn c allow us masselimin 24 column c repres supercolumn c skip ahead step symbol factor pattern column supercolumn becom pivot column pattern c updat elimin immedi sinc column c repres supercolumn keep nonzero pattern elimin need maintain degre column select metric repres column c superrow size set c j dier sum number row repres superrow set c j similarli jr j number supercolumn row number column repres supercolumn r let kr k denot sum number row repres supercolumn j r similarli dene kc j k similarli jc superrow necess choic pivot column c heurist sinc obtain order minimum llin npcomplet problem 45 sever strategi possibl select column c minim metric describ method need comput initi metric column prior symbol factor order recomput metric column j pivot row pattern r r step k 1 exact extern row degre select c minim size result pivot row r ia n fcg exclud pivot column thu comput extern row degre 37 exact degre expens comput time domin symbol factor time experi symmetr order exact degre provid better order good approxim degre order method amdbar mc47bd 1 thu test method 2 matlab approxim extern row degre colmmd column order algorithm matlab base symbol lu factor algorithm present section 3 27 colmmd select pivot column c minim loos upper bound extern row degre note c 2 r kr n jcj use bound symbol updat increas asymptot time complex order algorithm symbol lu factor algorithm comput matlab metric initi column fast take ojaj time 3 amd approxim extern row degre amd algorithm order symmetr matric prior choleski factor base bound extern row degre tighter matlab bound 1 rst use nonsymmetr pattern multifront method umfpack comput order numer factor 8 9 context column order algorithm bound llin spars partial pivot method bound kr r k r recent pivot row modi c c symbol updat thu 2 c c comput amd metric initi column select arbitrari 2 c c comput bound column c comput initi amd metric take amount time take comput spars matrix product aa although costli increas asymptot time algorithm time comput bound symbol updat phase asymptot comput matlab bound 4 size household updat symbol lu factor also comput pattern r qr factor 6 32 step k size household updat kc k kbykr r k term kc k k known exactli kr r k term comput approxim use method method test select c minim product kc c k amd approxim kr r k 3 test discard method sinc gave much wors order method 5 approxim markowitz criterion markowitz heurist select pivot entri ij minim product degre row column j amount work requir subsequ outer product step 38 criterion assum rst k 1 pivot row column select case know exact pivot row order yet know true row column degre test select c minim kc c k time max i2cc kr k tighter upper bound actual pivot row degre column c select kth pivot column row select kth pivot row although r bound pattern r r kth pivot row arbitrari row partial bound size actual pivot row row order select sinc kc c k kr k known exactli approxim need use test discard method sinc gave much wors order method 6 approxim decienc decienc pivot number new nonzero entri would creat pivot select select pivot least decienc lead minimum decienc order algorithm exact decienc costli comput approxim minimum decienc order algorithm success use symmetr matric context choleski factor 40 42 nonsymmetr context decienc column c bound new nonzero limit kc c kbykr r k household date superrow howev contain submatrix thu reduc possibl llin number nonzero repr sent kc c k kr k term known exactli use amd approxim kr r k 3 test one variant approxim decienc 35 36 initi phase comput approxim decienc column approxim decienc recomput time column mod i aggress row absorpt use discuss sinc worsen approxim experiment result mix compar nal colamd variant approxim decienc better 60 matric larg test suit wors colamd sometim much wors vice versa byproduct amd row degre comput comput size set dierenc kr n r r k superrow r bound pivot row step k row remain matrix nd set dierenc zero r subset row r r presenc row aect exact row degre although aect matlab amd approxim row delet absorb r refer delet r r r aggress row absorpt similar element absorpt introduc du reid 17 amd row degre comput initi metric initi aggress row absorpt occur phase well aggress row absorpt reduc run time sinc cost almost noth detect condit amd metric use result fewer row consid subsequ step test sixteen variant colamd base possibl combin follow design decis 1 initi metric matlab amd approxim 2 metric comput symbol outer product updat matlab amd approxim 3 without initi aggress row absorpt 4 without aggress row absorpt symbol factor note combin somewhat costli sinc aggress row absorpt easi use amd row degre dicult use matlab approxim sinc amd metric shown superior matlab approxim context minimum degre order spars choleski factor 1 expect four variant base sole amd metric superior much intend test sixteen method surpris found better order obtain initi matlab metric amd metric symbol updat discov accid bug initi comput amd metric result matlab approxim comput instead bug gave us better order kept use initi matlab metric gave averag order 8 fewer oatingpoint oper subsequ numer factor use initi amd metric initi matlab metric also faster comput version order algorithm recommend simpli call colamd use initi matlab metric amd metric symbol updat initi aggress row absorpt aggress row absorpt symbol updat sinc amd metric incompat incomplet degre updat 18 19 multipl elimin 37 use neither strategi multipl elimin set pivot column select symbol updat column set aect column set select set reduc number symbol updat must perform matlab colmmd order algorithm use matlab metric throughout multipl elimin relax threshold superrow supercolumn mass elimin aggress row absorpt aggress row absorpt free colamd instead explicit test made everi three stage multipl elimin supercolumn search everi three stage default row 50 dens ignor sinc matlab metric lead lower qualiti order exact metric option provid select exact extern row degre metric modifi multipl elimin threshold chang frequenc supercolumn detect aggress row absorpt chang dens row threshold select spparm tight matlab improv order comput colmmd high cost order time 5 experiment result test colamd order algorithm three set matric squar nonsymmetr matric rectangular matric symmetr posit de nite matric test set entir univers florida spars matrix collect 7 includ harwellbo test set 15 16 linear program problem netlib httpwwwnetliborg 13 well mani matric exclud complex matric nonsymmetr matric pattern provid unassembl nite element trice matric includ explicit zero entri descript pattern sinc ignor numer cancel includ entri nding order determin result factor method compar order time qualiti number nonzero factor number oatingpoint oper comput factor izat although test matric collect present summari larger problem best order result factor requir 10 7 oper com pute complet result present larimor thesi 36 avail technic report httpwwwciseufledu perform experi sun ultra enterpris 40005000 2 gb main memori eight 248 mhz ultrasparcii processor one processor use code written ansiiso c compil use solari c compil via mathwork mex shell script interfac matlab softwar written c strict ansiiso complianc 51 squar nonsymmetr matric squar nonsymmetr matric use colamd nd column preorder q spars partial pivot result compar colmmd default option set amdbar 1 appli pattern ignor numer cancel withhold dens row column ignor colamd colmmd amdbar routin mc47bd harwel subroutin librari except perform aggress row absorpt amdbar mc47bd use amdstyl approxim degre spars partial pivot matric test set amdbar provid slightli better order mc47bd nding column order factor matrix aq superlu packag 11 packag chosen sinc colamd written replac column order current version superlu superlu base bla 12 2 exclud matric permut upper block triangular form 14 substanti improv factor time two rea son 1 bound tight matrix strong hall 2 superlu take advantag reduc block upper triangular form matric factor order factor irreduc diagon submatrix permut matrix block triangular form result test set 106 matric requir oper factor repres sampl shown tabl 1 sort accord colamd versu colmmd order qualiti 3 tabl 2 report order time colamd use bla routin provid superlu factor time secondari measur diculti use sunoptim bla matlabcal driver 3 obtain sampl sort 106 matric accord rel point oper count colamd order colmmd order select everi 8th matrix also includ twoton matrix largest dimens test set tabl 1 unsymmetr matric matrix n nnz descript goodwin 7320 324784 niteel uid dynam navierstok ellipt mesh r goodwin raefsky2 3242 294276 incompress ow pressuredriven pipe raefski twoton 120750 1224224 frequencydomain analysi nonlinear analog circuit 20 comput uid dynam cfd charleston harbor steve bova lhr17c 17576 381975 light hydrocarbon recoveri problem 47 exchang ow redistribut aver rdist3a 2398 61896 chemic process separ 46 garon2 13535 390607 2d niteel navierstok garon twophas uid ow graham cavity25 4562 138187 driven caviti niteel chapman ex20 2203 69981 2d attenu surfac disturb nonlinear cfd saad wang1 2903 19093 electron continu 3d diod 39 ex14 3251 66775 2d isotherm seepag ow saad ex40 7740 458012 3d die swell problem squar die comput uid dynam saad colmmd amdbar time comput pattern includ amdbar time comparison last column report superlu factor time use colamd order tabl 3 give result number nonzero l u oatingpoint oper requir factor permut matrix order method median result report paper repres sampl full test set result sampl full test set similar colamd superior method matric colamd typic 39 time faster colmmd 21 time faster amdbar two matric colmmd took time order matrix superlu took factor order found colmmd result median increas tabl 2 order factor time second matrix colamd colmmd amdbar superlu goodwin 031 042 151 4465 raefsky2 111 158 211 6236 twoton 588 7082 1415 30685 lhr17c 162 1522 308 580 ex40 234 1358 261 2721 median time rel 39 21 371 tabl 3 order qualiti factor superlu nonzero l u matrix colamd colmmd amdbar colamd colmmd amdbar goodwin 5634 3103 2734 1909 665 498 twoton ex20 483 589 464 48 86 50 ex14 711 1012 885 91 214 157 ex40 4315 8537 6072 1075 5369 2606 median result rel 110 099 136 105 10 nonzero lu factor 36 oatingpoint oper compar colamd order qualiti colamd amdbar similar although larg variat direct small number matric matric larger test set tabl 1 amdbar requir space store superlu requir factor permut matrix 52 rectangular matric mbyn rectangular matric n found column order q choleski factor aq aq one method solv least squar problem n found row order p choleski factor pad 2 pa aris interior point method solv linear program problem 34 44 diagon matrix latter case colamd colmmd found column order use row order p compar two method amdbar correspond matrix n test set limit includ 37 matric requir three netlib linear program problem n repres select 4 shown tabl 4 compar three method base order time number nonzero factor l oatingpoint oper count requir choleski factor metric obtain symbfact matlab fast symbol factor 22 23 29 perform numer choleski factor time construct aa includ order time amdbar result shown tabl 5 6 matric colamd twice fast colmmd slightli faster amdbar three produc compar order method matric well poorli colamd colmmd typic requir less storag amdbar sometim sever order magnitud need comput pattern aa prior order amdbar size choleski factor alway domin size aa howev primari advantag colamd 4 everi 5th matrix 37 larg matric increas order colamd versu colmmd order qualiti chosen tabl 4 rectangular matric linear program problem gran 2629 2525 20111 60511 british petroleum oper lower bound quadrat assign problem 41 tting linear inequ data min sum piecewiselinear penalti r fourer pd 20 33874 108175 232647 320196 militari airlift oper 5 d2q06c 2171 5831 33081 56153 j tomlin tabl 5 order time second matrix colamd colmmd amdbar gran 004 007 006 pd 20 386 1053 392 median time rel 200 114 colamd tabl order qualiti nonzero l 10 3 flop count 10 6 matrix colamd colmmd amdbar colamd colmmd amdbar gran 191 158 143 48 33 27 pd 20 6827 8159 6929 8598 12640 8812 median result rel 100 099 102 098 colamd colmmd amdbar context abil analyz choleski factor nding order size result factor l space proport number nonzero matrix rather proport size matrix factor 53 symmetr matric symmetr matric matlab symmmd routin construct matrix pattern nd column order use colmmd one row entri ij diagon nonzero entri column j method give reason order choleski factor implement analog symamd routin base colamd test set includ 50 matric requir 10 7 oper factor largest comput uid dynam problem ed rothberg requir 136 billion oper factor cfd2 sampl test matric 5 shown tabl 7 result symamd symmmd amdbar mc47bd shown tabl 8 9 time construct includ order time symamd symmmd 9 matric symamd six time faster symmmd 5 everi 7th matrix order increas ratio symamd symmmd order qualiti chosen tabl 7 symmetr matric matrix n nnz descript pwt 36519 326107 pressur wind tunnel r grime msc00726 726 34518 symmetr test matrix mscnastran bcsstk38 8032 355460 stiness matrix airplan engin compon r grime engin problem nasa langley cfd2 123440 3087898 comput uid dynam e rothberg 3dtube pressur tube e rothberg gearbox 153746 9080404 zf aircraft ap actuat e rothberg finan512 74752 596992 portfolio optim 4 tabl 8 order time second matrix symamd symmmd amdbar mc47bd pwt 078 353 045 044 msc00726 cfd2 736 4868 390 371 3dtube 609 7775 095 092 gearbox 1658 45449 294 289 finan512 160 261 092 095 median time rel 613 039 039 symamd tabl 9 order qualiti nonzero l 10 3 op count 10 6 matrix symamd symmmd amdbar mc47bd symamd symmmd amdbar mc47bd pwt 1497 1425 1592 1556 156 140 173 162 msc00726 103 108 111 111 20 22 23 23 cfd2 74832 94444 75008 75008 137470 211328 136476 136476 3dtube 26128 33213 26355 26355 29969 45578 30053 30053 median result rel 126 103 103 152 108 104 colamd averag nearli alway produc signicantli better order con trast symamd alway slower amdbar mc47bd although found order similar qualiti finan512 notabl except none method nd good order tree dissect method 4 order algorithm design symmetr matric amdbar mc47bd thu superior one base column order may least one import except howev applic better matrix avail consid nbyn nite element matrix construct summat e nite element normal e n nite element matrix dens symmetr submatrix suppos element k nonzero entri ij j set e k construct ebyn matrix row k pattern e k sinc pattern comput column order use choleski factor colamd would faster use construct without knowledg nite element structur space perform order symbol analysi less well sinc fewer nonzero although mani matric test set aris nite element problem small one avail unassembl form collect nite element thu abl evalu strategi larg realist test matric 6 summari two new order routin colamd symamd present squar nonsymmetr matric colamd much faster provid better order matlab colmmd routin also faster symmetricbas order method amdbar use less storag rectangular matric aris least squar problem interior point method linear program colamd faster colmmd amdbar nd order compar qualiti present symmetr order method symamd base colamd although produc order good truli symmetr order algorithm amdbar slower amdbar colamd symamd routin written ansiiso c matlab callabl interfac version 20 code freeli avail follow sourc 1 univers florida httpwwwciseufleduresearchspars 2 netlib httpwwwnetliborglinalgcolamd 3 mathwork inc usercontribut contribut matlab httpwwwmathworkscom colamd symamd builtin function matlab version 60 4 collect algorithm acm algorithm 8xx describ 10 r compress graph minimum degre algorithm test collect nonhermitian eigenvalu problem solv multistag stochast program use tree dissect univ florida spars matrix collect algorithm 8xx colamd supernod approach spars partial pivot distribut mathemat softwar via electron mail yale spars matrix packag algorithm data structur spars symmetr gaussian elimin fast implement minimum degre algorithm use quotient graph optim algorithm symbol factor symmetr matric comput solut larg spars posit de applic minimum degre algorithm implement gaussian elimin partial pivot spars system symbol factor spars gaussian elimin partial pivot spars matric matlab design implement predict structur nonsymmetr spars matrix factor spars partial pivot time proport arithmet oper two fast algorithm spars matric multipl permut transposit find good column order spars qr factor new polynomi time algorithm linear program ming approxim de approxim minimum degre column order algo rithm elimin form invers applic linear program exponenti perform greedi order heurist spars choleski factor resend ramakrishnan drezner node select strategi bottomup spars matrix order e comput minimum spars matrix method chemic process separ calcul supercomput multifront vs frontal techniqu chemic process simul supercomput er tr new polynomialtim algorithm linear program predict fill spars orthogon factor distribut mathemat softwar via electron mail symbol factor spars gaussian elimin partial pivot spars matrix test problem set level 3 basic linear algebra subprogram empir evalu korbx algorithm militari airlift applic gener envelop method spars factor row spars matric matlab spars matrix method chemic process separ calcul supercomput sparsiti analysi italicqrital factor effici algorithm comput row column count spars choleski factor modif minimumdegre algorithm multipl elimin compress graph minimum degre algorithm approxim minimum degre order algorithm unsymmetricpattern multifront method spars lu factor combin unifrontalmultifront method unsymmetr spars matric node select strategi bottomup spars matrix order supernod approach spars partial pivot perform greedi order heurist spars choleski factor two fast algorithm spars matric multipl permut transposit algorithm obtain maximum transvers multifront solut indefinit spars symmetr linear comput solut larg spars posit definit algorithm 836 algorithm 837 ctr timothi davi john r gilbert stefan larimor esmond g ng algorithm 836 colamd column approxim minimum degre order algorithm acm transact mathemat softwar tom v30 n3 p377380 septemb 2004 patrick r amestoy enseeihtirit timothi davi iain duff algorithm 837 amd approxim minimum degre order algorithm acm transact mathemat softwar tom v30 n3 p381388 septemb 2004 marco morandini paolo mantegazza use dens storag solv small spars linear system acm transact mathemat softwar tom v33 n1 p5e march 2007 kai shen parallel spars lu factor differ messag pass platform journal parallel distribut comput v66 n11 p13871403 novemb 2006 xiaoy li overview superlu algorithm implement user interfac acm transact mathemat softwar tom v31 n3 p302325 septemb 2005 frank dellaert michael kaess squar root sam simultan local map via squar root inform smooth intern journal robot research v25 n12 p11811203 decemb 2006 nichola gould jennif scott yifan hu numer evalu spars direct solver solut larg spars symmetr linear system equat acm transact mathemat softwar tom v33 n2 p10e june 2007 doron chen daniel cohenor olga sorkin sivan toledo algebra analysi highpass quantiz acm transact graphic tog v24 n4 p12591282 octob 2005 timothi davi column preorder strategi unsymmetricpattern multifront method acm transact mathemat softwar tom v30 n2 p165195 june 2004