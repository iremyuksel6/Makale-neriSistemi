nondeterminist nonmonoton logic databas abstractw consid paper extens datalog mechan tempor nonmonoton nondeterminist reason refer datalog show mean exampl flexibl express queri concern aggreg data cube also show iter fixpoint stabl model semant combin purpos clarifi semant datalog program support effici execut final provid concret implement strategi basi design optim techniqu tailor datalog address b introduct motiv name datalog use paper refer datalog extend mechan support limit form tempor reason mean tempor stage argument relat rang discret tempor domain style 5 nonmonoton reason mean form stratifi negat wrt stage argument call xystratif 26 nondeterminist reason mean nondeterminist choic construct 12 essenti fragment ldl 2 advoc 27 chap 10 reveal highli express languag applic divers area ai plan 4 activ databas 25 object databas 8 semistructur inform manag web restructur 10 data mine knowledg discoveri databas 15 3 11 howev thorough studi semant datalog still miss provid basi sound effici implement optim techniqu preliminari studi semant datalog sketch 4 discuss relat declar modeltheoret semant fixpoint bottomup semant discuss howev inform moreov fail achiev precis coincid two semant arbitrari program found therefor motiv indepth studi semant datalog program also explain reason miss coincid semant 4 propos gener condit ensur coincid object contribut paper aim 1 illustr express flexibl datalog queri languag 2 provid declar semant datalog integr tem poral nonmonoton nondeterminist mechan justifi adopt iter fixpoint semant languag 3 provid basi queri optim datalog thu make viabl effici implement purpos proceed follow 1 use datalog queri languag discuss section 2 2 natur pure declar semant datalog assign use notion stabl model section 3 construct semant assign use iter procedur exploit stratif induc progress tempor argument 3 main result paper show two semant equiva lent provid natur syntact restrict fulfil impos disciplin use tempor argument within choic construct 4 basi result introduc section 4 concret oper semant use relat algebra oper section 5 repertoir optim techniqu especi tailor datalog particular discuss possibl support effici historyinsensit tempor reason mean real sideeffect iter comput 19 materi section 2 3 base result present compact form 9 14 materi section 4 5 new conclus paper provid thorough account pragmat semant implement datalog relat work nondetermin introduc deduct databas mean choic construct origin propos 17 later revis 23 refin 12 studi expos close relationship connect nonmonoton reason nondeterminist construct lead definit stabl model semant choic declar semant choic base stabl model semant intract gener choic amen effici implement actual support logic databas languag ldl 20 evolut ldl 2 side stratif crucial notion introduct nonmonoton reason deduct databas origin idea 1 static stratif base predic depend stratifi negat refin deal dynam notion case local stratifi program 21 modularli stratifi program 22 dynam local stratif close connect tempor reason progress time point yield obviou stratif programsconsid instanc 1s 5 therefor natur non monoton tempor reason combin sever deduct databas languag 18 16 howev strike mismatch appar two line nondetermin lead multipl stabl model wherea stratif lead uniqu perfect model far comprehens studi address combin two line occur datalog requir develop non determinist iter fixpoint proce dure notic howev mention except 4 approach problem sketch refer local stratifi program augment choic present paper present instead thorough treatment program repair inconveni approach 4 concern incomplet iter fixpoint procedur preliminari assum reader familiar concept relat databas datalog languag 24 variou extens consid paper datalog languag unrestrict use negat bodi rule subset datalog consist predicatestratifi pro gram sens 1 languag introduc 5 predic may design argument call stage argument rang natur number natur number n repres term n nil 1s languag datalog 1s unrestrict use negat rule bodi datalog subset 1s negat use disciplin manner accord mechan xystratif nondeterminist choic introduc next section 2 queri answer datalog datalog basi deduct databas essenti friendli syntax express relat queri extend queri facil relat calculu recurs datalog simplic express complex queri impact databas technolog nowaday recurs queriesview becom part sql3 standard recurs queri find natur applic area inform system comput transit closur travers issu billofmateri queri rout plan format graph travers howev wide recogn express datalog recur sive rule limit sever extens along variou direct propos paper address particular two direct name nondeterminist nonmonoton reason support respect choic construct notion xystratif introduc mechan mean exampl meant point enhanc queri capabl nondeterminist choic choic construct use nondeterminist select subset answer queri obey specifi fd constraint instanc rule st adst ad majorst area facultyad area choicest ad assign student uniqu arbitrari advisor area sinc choic goal constrain st ad relat obey fd st ad fore base relat major form tupl fsmith db gray seg base relat faculti form tupl fbrown db scott db miller seg two possibl outcom queri st adstad either fsmith brown gray millerg fsmith scott gray millerg practic system ldl one two solut comput present result thu first use choic comput nondeterminist nonrecurs queri howev choic combin recurs follow rule comput arbitrari order given relat r root fresh constant conveni use simplifi program base relat r form k tupl k possibl outcom queri ord rx name set ford rroot root ord rroot 1 permut ft 1 g tupl r therefor possibl outcom mention queri relat ord r total order tupl r doubl choic constraint recurs rule specifi successor predecessor tupl r uniqu interestingli choic employ comput new determinist queri inexpress datalog well pure relat calculu remark exampl capabl express aggreg follow program comput summat aggreg relat r use arbitrari order r comput ord r sum rroot 0 sum ry n sum rx ord rx total sum rn sum rx n ord rx sum rxn use accumul n summat x respect order given ord r therefor total sum reconstruct sum rx n x last tupl order notic use stratifi negat purpos select last tupl practic languag ldl syntact sugar aggreg use abbrevi program 26 total sum rsum x rx basi simpl exampl sophist form aggreg datacub olap function built exampl consid relat salesd depart sale problem aggreg sale along dimens date depart three aggreg pattern possibl correspond variou facet datacub date depart former two pattern correspond aggreg sale along singl dimens respect depart date obtain origin relat appli method shown latter pattern obtain recurs appli method one two pattern previous comput order aggreg along remain dimens case sever dimens along aggreg simpli repeat process aggreg step along new ie still nonaggreg dimens thorough account program nondetermin deduct databas found 7 13 semant choic assign use socal stabl model semant datalog program concept origin autoepistem logic appli studi negat horn claus languag gelfond lifschitz 6 defin notion stabl model need introduc transform h given interpret map datalog program p posit datalog program hp next defin said stabl model p sp gener datalog program may zero one mani stabl model multipl stabl model exploit give declar account nondetermin fact defin stabl version program given datalog program p stabl version defin program obtain p replac refer choic atom rule r h b choicex x disjunct vector variabl appear also b atom chosen r x chosen r predic defin follow rule chosen r diffchoic r definit fix valu x choic inhibit possibl one via diffchoic r stabl model sv p one notic construct occurr choic atom pair chosen diffchoic atom thu bound scope atom rule appear variou stabl model transform program sv p thu correspond choic model origin program xyprogram anoth notion use paper xyprogram origin introduc 26 languag program 1s admit negat bodi atom unari constructor symbol use repres tempor argument usual call stage argument gener definit xyprogram follow xystratif set p 1s rule defin mutual recurs predic xyprogram satisfi follow condit 1 recurs predic distinguish stage argument 2 everi recurs rule r either xrule yrule r xrule stage argument everi recurs predic r variabl r yrule head r stage argument sj j variabl ii goal r j stage argument iii remain recurs goal either j sj stage argument intuit rule xyprogram atom pj denot extens relat p current stage present time j wherea atom psj denot extens relat p next stage futur time sj use differ prime predic symbol p 0 psj atom obtain socal prime version xyprogram say xyprogram xystratifi prime version stratifi program intuit depend graph prime version cycl negat edg possibl obtain order origin rule modulo stage 1 eas present includ definit sv p case one choic atom per rule definit gener case found 13 argument consequ xystratifi program also local stratifi therefor uniqu stabl model coincid perfect model 21 let p xystratifi program 0 defin p stage argument head rg rxi stand r replac x ie p set rule instanc p defin predic stage argument iter fixpoint procedur comput uniqu minim model p defin follow 1 comput 0 minim model p 2 j 0 comput j minim model notic j 0 p j stratifi definit henc perfect model j comput via iter fixpoint procedur paper use name datalog refer languag xy program augment choic goal 3 semant choic construct allow xyprogram multipl stabl model exist given program therefor need clarifi phenomenon combin iter fixpoint semant choicefre xyprogram task accomplish three step 1 first present gener result state whenev datalog program p stratifi hierarchi recurs cliqu ie minim set mutual recurs rule stabl model entir program p reconstruct iter construct approxim stabl model associ cliqu 2 second observ syntact restrict use choic construct compromis express datalog program natur stratifi hierarchi recurs cliqu use tempor argument recurs predic 3 third observ 2 appli gener result 1 program thu obtain stabl model entir program comput iter fixpoint procedur follow stratif induc tempor argument given possibl infinit program p consid possibl infinit topolog sort distinct recurs cliqu q 1 oe induc depend relat predic p given interpret use notat denot subset atom whose predic symbol predic defin cliqu q follow observ straightforward analog predic defin q i1 depend definit consequ interpret q i1 ignor next definit show transform recurs cliqu within given topolog order selfcontain program take account inform deduc previou cliqu transform resembl gelfondlifschitz transform report sect 2 definit 3 consid program p topolog sort recurs cliqu interpret defin defin q defin q ut idea underli transform remov cliqu q depend induc predic defin lower cliqu abbrevi q redi q red interpret clear context exampl 1 consid program recurs cliqu rg consid interpret fs q rg q red red follow lemma 1 state relat model transform cliqu model program abbrevi analog q lemma 1 given possibl infinit datalog program p interpret topolog sort p induc depend relat p follow statement equival 1 sp 2 8i 0 q red 3 8i 0 q proof sketch proof structur follow 1 3 2 3 3 1 next show sp b sp rule hp come rule r p turn appear q model r hypothesi atom n appear r also model r model hp henc sp b 2 2 hypothesi definit sp moreov 0 readili check 1 3 observ minfi j impli g 2 3 proceed induct base case trivial induct case next show q b vice versa notic induct hypothesi suffic show simpl case analysi b exploit induct hypothesi igamma1 q igamma1 definit hp show induct n 8n 0 n red base case induct case n 0 2 n red exist rule b red red definit h q red exist rule q fc e l observ definit h b furthermor induct hypothesi igamma1 follow fb henc definit 2 q complet innermost induct obtain 3 2 proceed way similar preced case see suffic verifi rule instanc r head follow properti hold 8n 2 n red convers simpli observ model q red result state arbitrari datalog program stabl model approxim cliqu accord given topolog sort local stabl model result give us intuit idea comput stabl model approxim program mean comput stabl model approxim cliqu notic lemma 1 hold arbitrari program provid stratif hierarchi cliqu given sens result wide applic variou notion stratifi program modularli stratifi program 22 requir cliqu q red local stratifi contrari requir cliqu sens stratifi motiv object deal non determin justifi adopt nondeterminist stabl model semant rather determinist semant stratifi datalog program instanc perfect model semant 21 turn attent xyprogram result instanti claus xyprogram p possibl valu natur number stage argument yield new program sgp stage ground precis rule stage argument rg stabl model p sgp close relat lemma 2 let p xyprogram interpret proof sketch show induct 8nt n impli thesi base case trivial induct case observ sinc p xystratifi 2 n1 hpi b fb hsgp vice versa 2 n1 fb hpi ut howev depend graph sgp obvious p induc necessarili topolog sort gener xyprogram predicatestratifi therefor lemma 1 directli applic tackl problem distinguish predic symbol p program fragment p predic symbol fragment p j j 6 differenti predic symbol use tempor argument therefor pi x atom involv rule p modifi version p x precis introduc xyprogram p modifi version sop stageout defin sop obtain program fragment p sgp extract stage argument atom ad predic symbol atom similarli modifi version soi interpret defin therefor atom pi x iff atom p x soi valu stage argument posit relat p unsurprisingli stabl model sgp sop close relat lemma 3 let p xyprogram interpret proof sketch easi see sosgp henc least herbrand model sohsgp hsop soi coincid ut aim conclud given topolog sort sop hypothesi lemma recal 0 cliqu sop consist rule sop stage argument head b lemma 1 2 3 interpret stabl model p iff construct i0 0 stabl model sop redi ie cliqu sop reduc substitut atom deduc stage earlier basi b possibl defin iter procedur construct arbitrari stabl model p union interpret defin follow iter stabl model procedur base case 0 stabl model bottom cliqu sop induct case 0 stabl model sop redm ie cliqu sop reduc respect 0 interpret call iter stabl model p observ construct close procedur call iter choic fixpoint 4 also follow approach 13 local stabl model turn effici construct nondeterminist fixpoint comput polynomi time unfortun desir result notion stabl model iter stabl model coincid hold full gener sens iter procedur complet arbitrari datalog program give rise inconveni 4 mention introduct fact demonstr exampl undisciplin use choic datalog program may caus presenc stabl model comput increment hierarchi cliqu exampl 2 consid follow simpl stabl version sv p p rule defin predic p replac chosenx qi x diffchoicex gener sop compos one cliqu express replac sop howev eas present ignor sinc gener case trivial deduc follow readili check sv p admit two stabl model name fq0 first model iter stabl model therefor second model comput use iter choic fixpoint 4 ut technic reason problem free use choic construct inhibit possibl defin topolog sort sop base valu stage argument exampl 2 predic depend relat depend among stage stage j depend chosen predic predic q stage prevent problem suffic requir choic goal refer stage argument domain associ function depend program compli constraint call choicesaf follow way turn program exampl 2 choicesaf program differ semant syntact restrict moreov greatli compromis express queri languag possibl simul within restrict gener use choic see 19 consider summar follow main result paper mention restrict choicesafeti direct consequ lemma 1 2 3 theorem 1 correct complet iter stabl model procedur let p choicesaf datalog program interpret stabl model sv p iff iter stabl model p ut follow exampl show comput iter stabl model procedur exampl 3 consid follow datalog version semina pro gram discuss 26 nondeterminist comput maxim path node graph g assum graph given eig follow interpret carri stage iter stabl model procedur 1 ag 2 bg 3 1 cg 2 dg 4 1 b 3 5 theorem 1 conclud two stabl model program 2 3 clearli realist implement provid ldl comput non determinist one possibl stabl model ut 4 oper semant translat iter stabl model procedur concret form use relat algebra oper control construct follow style 24 associ predic p relat p name capit elementari deduct step tq translat assign appropri relat 0 tq ie relat defin cliqu q togeth extension relat evalp rel denot notat 24 singl evalu step rule predic p respect current extens relat rel show translat datalog cliqu increment three step start simpl datalog program stratifi negat introduc choic construct eventu describ translat full languag translat whole program trivial obtain gather singl translat cliqu natur order stratifi negat appli straightforwardli transform given 24 safe stratifi datalog program neg liter refer previous comput extension relat translat complement relat wrt univers constant translat templat 1 8p defin repeat 8p defin q last 8p defin q last p translat illustr follow exampl 4 program translat follow naiv evalu procedur eval instanc appropri ra queri repeat last last last p ad choic need translat relat algebra term oper compos nondeterminist comput follow approach 13 12 partit rule sv q stabl version q three set chosen rule diffchoic rule ie remain rule nondeterminist fixpoint procedur comput stabl model choic program repres follow translat templat 2 0 init 8p defin sv 1 satur repeat 8p defin last p p 8p defin last 2 gather choic 8chosen r defin c chosen 0 3 termin test 8chosen r defin c chosen 0 4 choic execut fairli follow choos chosen 0 b choos 2 chosen 0 r 5 inhibit choic 8diffchoic r defin diffchoic r evaldiffchoic r step 1 procedur tri deriv possibl atom alreadi given choic none first iter step 2 collect candid atom chosen later atom ie reach fixpoint evalu nondeterminist choos one step 4 propag effect choic step 5 order forc fd impli readi repeat process exampl 5 stabl version studentsadvisor exampl seen section 2 follow st adst ad majorst area facultyad area chosenst ad follow translat schema obtain follow procedur 0 st ad chosen diffchoic 1 st ad stad majorst area f acultyad area chosenst 2 chosen 0 stad majorst area f acultyad area diffchoicest ad 3 chosen 4c chosen chosen f st ad g 5 diffchoic diffchoic st g theta f ad g notic step slightli modifi step 1 sim plifi sinc rule recurs modulo chosen predic ii one choic rule step 4a becom useless ignor iii step 5 rewritten brief readabl form exactli mean shown gener schema ad xystratif analyz evalu procedur xy cliqu q easi see step n atom deriv form stage argument syntact form rule ensur rule refer atom stage argument rule serv distinguish liter comput actual stage comput previou stage gamma 1 therefor safe omit stage argument xyrecurs predic renam liter refer previou stage ie stage insid rule head stage 1 ad prefix old appli exitrul stage argument valu signific must preserv denot q 0 result rule p 0 predic obtain p exampl 6 program q translat new program suffic store extern regist j valu stage evalu fire exitrul stage argument j ii evalu new rule q 0 stratifi possibl choic describ last two section complet evalu actual stage need store newli deriv atom p correspond old p increment j repeat process order evalu next stage result procedur follow translat templat 3 0 init defin q 1 fire exit rule 8exitrul 2 fire q translat follow translat templat 1 2 3 updat relat defin q 4 j j simpli reduc evalu xycliqu iter evalu stage instanc step 2 sequenti ascend order step 4 stage instanc stratifi modulo choic broken subcliqu step 2 translat templat 1 choicefre templat 2 choic result relat step easili obtain collect stage j relat p 0 translat correspond p ie ad stage argument j exampl 7 let g2 extension predic repres edg graph consid follow cliqu q correspond transform cliqu q partit exitrul r 0 subcliqu q 0 subcliqu g appli translat templat 3 obtain 0 j 0 old old 0 0 1 3 old old 0 4 j j notic step 2a 2b simplifi wrt translat templat 1 q 0 recurs iter cycl useless inde would reach satur first step exit second one 5 optim datalog queri systemat studi queri optim techniqu realiz basi concret implement iter stabl model procedur discuss previou section sketch repertoir ad hoc optim exploit particular syntact structur program queri way use tempor argument first observ comput translat templat 3 never termin obviou termin condit check relat comput two consecut stage empti purpos translat templat 3 modifi insert follow instruct step 2 3 8p defin q gener termin condit applic determinist cliqu assumpt extern call predic cliqu specifi particular stage ie extern call form case termin condit simplifi follow 8p defin q forgetfulfixpoint comput mani applic eg model updat activ rule 25 10 queri issu refer final stage repres commit state databas queri often exhibit form intend mean find valu x p final state p impli comput next stage forget preced state last one see 26 ii stage pi x psi uniqu quit comput process queri satisfi instanc program exampl 7 queri deltai x deltasi comput leaf node maxim depth breadthfirst visit graph root purpos evalu queri suffic keep track last comput stage ii exit current delta empti code program exampl 7 optim replac step 3 3 old old 0 ie drop instruct record previou stage ii insert step 2 3 instruct old anoth interest case occur answer queri distribut along stage eg interest answer queri ignor stage argument case collect partial answer via gather predic defin copyrul instanc predic exampl 7 collect node reachabl queri alli x allsi amen describ optim equival queri delta x contrari allow fore possibl modifi program copyrul predic appli systemat space optim forgetfulfixpoint deltafixpoint comput alreadi mention presenc copi rule exampl 7 effect copi tupl stage next one avoid useless space occup maintain stage modif appli origin relat order obtain actual version exampl rule repres modif henc effect inde suffic keep track addit origin databas request rule realiz supplementari relat contain stage new tupl produc case replac copyrul deleterul form need simpli keep track neg contribut due liter qx store relat gamma obtain integr j method particularli effect larg relat illustr point let us assum program exampl 7 modifi ad new exit rule relat r extension predic result code follow 0 j 0 old old 1 3 old old 0 4 j j way avoid construct relat ie replic relat r stage fact reconstruct fli need step 2a sideeffect comput direct combin previou two techniqu give rise form sideeffect comput let us consid ex ampl nondeterminist order array perform swap step two element violat order array 1 repres relat extens a1 1 ar0 stage nondeterminist select unord pair x element delet array atom ari p1 x ari p2 ap pear add new atom arsi p1 arsi p2 x repres swap pair queri allow forgetfulfixpoint comput particular stage select queri uniqu definit predic ar compos deleterul addrul mean step forget previous comput stage last ii avoid copi relat ar keep track delet addit per form request updat immedi perform execut propos program boil effici iter comput follow nondeterminist pascallik program 9i ai 6 conclus work report paper concern fixpointoper semant optim logic databas languag non determinist nonmonoton reason constitut start point actual implement sy tem project current progress basi ldl system develop ucla plan incorpor propos optim ldl compil purpos evalu effect propos optim realist ldl program ie whether yield better perform evalu applic propos optim realist ldl program ie often appli experi integr propos optim classic optim techniqu magicset r toward theori declar knowledg classificationbas methodolog plan audit strategi fraud detect logic total partial order plan deduct databas approach tempor deduct databas stabl model semant logic program program non determin deduct databas queri answer non determinist non monoton logic databas deduct data model repres queri semistructur data experi logicbas knowledg discoveri support environ semant express power non determinist construct deduct databas effect semant tempor integr deduct induct mine supermarket sale data el program effici evalu nonstratifi program transform el logic framework activ rule nondetermin xystratif deduct databas italian logic languag data knowledg base everi logic program natur stratif iter fix point model modular stratif magic set datalog program negat stabl model nondetermin logic program negat principl databas knowledgebas system activ databas rule transact consciou stabl model se mantic negat aggreg recurs rule ldl tr ctr christo nomiko pano rondogianni manoli gergatsouli tempor stratif test linear branchingtim deduct databas theoret comput scienc v342 n23 p382415 7 septemb 2005 fosca giannotti giusepp manco franco turini specifi mine algorithm iter userdefin aggreg ieee transact knowledg data engin v16 n10 p12321246 octob 2004