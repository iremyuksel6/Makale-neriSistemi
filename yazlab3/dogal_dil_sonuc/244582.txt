strict time lower bound optim schedul parallel prefix resourc constraint abstractprefix comput basic oper core mani import applic eg grand challeng problem circuit design digit signal process graph optim comput geometry1 paper present new strict timeoptim parallel schedul prefix comput resourc constraint concurrentreadexclusivewrit crew parallel random access machin pram model prefix n element p processor p independ n n pp 12 deriv harmon schedul achiev strict optim time step leftlceil 2left n1 right mathordleft vphantom 2left n1 right left p1 right right kernnulldelimiterspac left p1 right rightrceil also deriv pipelin schedul better programspac effici harmon schedul yet requir small constant number step optim time achiev harmon schedul harmon schedul pipelin schedul simpl easi implement prefix n element p processor p independ n npp 12 harmon schedul timeoptim case establish optim method determin key paramet timeoptim schedul base connect structur parallel prefix pascal triangl use deriv paramet devis algorithm construct schedul restrict class valu n p prove construct schedul strictli timeoptim also give strong empir evid algorithm construct strict timeoptim schedul case npp b introduct given comput evalu 0 ffi associ oper ffi prefix sum firstord linear recurr coeffici 1 special case prefix comput state simpl loop refer problem interchang recurr prefix sum prefix comput sinc result prefix sum readili appli prefix comput associ oper prefix comput fundament oper core mani key applic grand challeng problem circuit design digit signal process graph optim comput geometry1 8 15 addit also import tool loop parallel tradit automat loop parallel techniques4 respect loopcarri depend thu unabl gener scalabl parallel code loop contain loopcarri depend understand parallel loop loopcarri depend beyond techniqu essenti understand simplest case loop loopcarri depend name prefix sum optim schedul techniqu use deriv paper could appliedwith extens parallel mani sequenti algorithm contain loop carri depend sinc practic applic amount resourc ie function unit processor fix priori independ problem size desir devis scheme perform prefix comput optim time given set resourc constraint sinc interest extend techniqu handl gener form loop loopcarri true depend also concern properti optim schedul clariti simplic implement extend prefix n element p processor p independ n n pp 12 deriv harmon schedul achiev strict optim time step 1e also deriv pipelin schedul better programspac effici harmon schedul yet take small constant number step optim time achiev harmon schedul harmon schedul pipelin schedul simpl thu easi implement prefix n element p processor p independ n n pp 12 exist kind structur parallel prefix comput n pp 12 establish optim method determin key paramet timeoptim schedul base connect structur parallel prefix pascal triangl use paramet devis algorithm construct schedul restrict class case term n p deriv strict timeoptim schedul subject optim condit case give strong empir evid algorithm construct strict timeoptim schedul conjectur schedul n pp achiev strict optim time paper organ follow section 2 present assumpt definit section 3 review relat work section 4 present harmon schedul n pp show strict time optim harmon schedul properti section 6 give pipelin schedul section 7 establish optim method determin key paramet timeoptim schedul n pp give algorithm construct schedul n pp strict timeoptim schedul within optim restrict class case term n p provid strong empir evid algorithm construct strict timeoptim schedul case result assum parallel random access machin pram concurrentreadconcurrentread crew model 15 analysi pram consist p autonom processor execut synchron access global share memori processor comput oper one time step unit schedul timeoptim term number parallel time step result comput crew model multipl processor may read simultan memori locat ie broadcast data exclus access requir write memori locat facilit studi comput complex comparison previou work area previou result pram crew assum memori access data transfer commun take zero time step defin term frequent use paper schedul use perform comput 1 denot time ie number time step run schedul machin p p unambigu p refer number processor machin refer p interchang time time step step time comput sequenti denot 1 speedup machin p processor uniprocessor schedul denot simpli unambigu let p number oper execut comput use p processor defin oper redund r sinc oper assum take one time step number oper sequenti program 1 defin run time final defin util u maximum number oper p processor perform p step three type datadepend defin literatur 11 purpos need concern true flow depend defin follow oper use result anoth oper said true flow depend simpli depend unambigu loopcarri depend type true depend loop oper iter use valu produc previou iter depend oper repres direct arc depend graph consist set node repres oper input valu depend arc connect binari depend graph depend graph oper take two operand operand may either input valu valu output oper depend graph prefix comput schedul use treeheight reduct thr 11 refer thr graph final valu prefix sum valu comput definit prefix sum final oper prefix sum oper assign final valu redund oper auxiliari intermedi oper oper comput auxiliari valu effort speed final valu comput redund valu auxiliari intermedi valu refer auxiliari valu comput redund oper figur 1 show depend graph sequenti schedul parallel schedul prefix comput eight input illustr two graph node final oper top fring node redund oper inner one identifi squar insid node given valu one without incom arc place bottom note depend graph sequenti schedul prefix sum tree one parallel schedul defin j particular ah0 prefix sum first j element note distinguish algorithm schedul algorithm use produc schedulefor given prefix comput run pram execut actual prefix comput 3 relat work result parallel prefix comput divid two categori resourc constraint usual number processor p function problem size n resourc constraint p independ n comprehens survey parallel comput use prefix problem given 14 special form prefix circuit previous known ofman earli 1963 whose carri circuit18 form carri circuit later discuss ladner fischer 13 muraoka16 show simplest linear recurr comput log n n2 processor use name treeheight reduct techniqu kogg stone recurs doubling12 firstord linear recurr essenti equival treeheight reduct appli prefix problem chen kuck11 show linear recurr comput 1 log n p n2 ladner fischer13 found class circuit prefix size assum enough processor avail unlimit resourc fich9 gave upper bound lower bound circuit size ie number gate oper prefix circuit n input depth log n dlog ne extra depth case unbound bound fanout fich construct circuit use complex recurs procedur ladner fischer unbound fanout lower bound prefix circuit input n upper bound fanout bound f 2 also obtain final lower bound fanout two k2 1 bilgori gajski5 gave differ algorithm gener suffixth term use solut minimum cost given length n depth initi valu avail e fanout f cost defin minimum number oper node along pair correspond input output lower bound cost therefor maximum number node path input correspond output instead circuit size chose cost measur fit better consider silicon layout cole vishkin6 gave algorithm solv prefix sum problem olog n log log n use log log n log n processor provid ai repres olog n bit differ problem address resourc constraint wellknown algorithm describ 3 comput prefix problem 2np log p time given p processor algorithm divid problem p partit conquer local comput partit one processor combin result algorithm take 2npp step optim time snir 19 gave algorithm dynam construct parallel prefix circuit fix number processor crew machin depth result circuit p processor 2np 1 o1 close strict timeoptim depth given problem size n snir algorithm work find right partit problem minim depth result schedul must recomput partit time new n given overhead associ problem size n either compil time run time n known run time frequent overhead incur find right partit impact perform parallel prefix comput also studi erew pram model kruskal rudolph snir 10 shown prefix n element comput use p processor 2np step egecioglu koc 7 studi tradeoff parallel arithmet step requir perform associ oper parallel rout step requir transfer operand one processor anoth prefix comput present prefix algorithm use 2p rout step 4 harmon schedul a3 a4 a5 a6 a7 x3 x2 x3 sequenti full thr i1 figur 1 sequenti schedul vs full treeheight reduct thr prefix sum given prefix problem size n shown figur 1 number oper sequenti schedul reduc definit requir output left draw figur 1 give comput tree sequenti schedul prefix sum size 8 tree height ie depend distanc critic path tree sequenti schedul equal n gamma 1 minimum number time step comput problem sequenti way parallel comput use associ oper reduc tree height time draw right figur 1 give full treeheight reduct thr schedul prefix sum size 8 shown use associ comput redund valu ahead final valu comput comput multipl final valu parallel thu trade multipl processor redund oper speedup parallel speed prefix schedul thought measur averag number final valu produc step given fix number processor want introduc mani redund oper reduc averag number result produc per step exampl fix number processor full thr shown figur 1 slow comput farther away optim problem size n increas order produc mani final result possibl given fix number processor schedul redund oper possibl howev one reduc number redund oper certain threshold would leav processor idl slow comput exampl remov redund oper schedul would degener sequenti schedul shown figur 1 one processor would stay idl therefor fastest parallel schedul fix number processor would use minimum number redund oper simultan achiev full processor util idea harmon schedul remaind section describ detail deriv properti harmon schedul shall prove next section harmon schedul inde timeoptim exampl 41 figur 2 illustr iter harmon schedul processor node top fring figur repres final valu prefix comput final oper inner node repres redund valu comput redund oper bottom end vertic line repres given element prefix sum first step iter one final oper oper second step two final oper redund oper kth step k final oper redund oper step one final oper one fewer redund oper immedi preced step p processor full util p step iter ieloop bodi final redund comput meet end iter end iter redund valu use comput final valu anoth nice properti number oper iter sum final oper redund oper sp henc call schedul harmon schedul 2 number correspond step loop bodi comput redund oper top node final valu comput final oper inner node output redund valu figur 2 iter schedul h processor schedul 41 harmon schedul let multipl sp case discuss shortli harmon schedul comput prefix sum n element p processor denot h decrib recal ahi ji repres partial sum element ai throught aj refer section 2 translat schedul one use array gamma 1 straightforwardli shown figur 3 k f li gthe inner loop k harmon schedul consist p iter iter inner loop execut singl parallel step parallel step consist p oper shown inner loop bodi execut p processor parallel first group p gamma oper comput look ahead redund valu prefix valu second group k oper comput final valu refer inner loop period comput harmon schedul also easili verifi schedul h memori locat written multipl oper simultan schedul 41 instanti given number processor compil neglig time note unlik 19 runtim schedul overhead sinc full instanti schedul depend p depend n array subscript calcul instanti h schedul ie actual valu p becom simpl reduc addit use strength reduction2 step parallel 7 processor 2 a28i 3 4 a28i 5 a28i 7 figur 3 instanti schedul h processor illustr instanti harmon schedul processor figur 3 28 21 inner node height l figur 2 comput oper lth step instanti schedul figur 3 note oper step execut parallel use array store redund valu distinguish redund valu final valu given element size array reduc sp gamma 1 sinc content produc iter use iter thu reus iter theorem 41 prefix sum size processor harmon schedul comput given prefix sum comput final valu yield speedup p 12 processor util u p proof prove correct harmon schedul suffic show produc correst result first period sp element plu start element 0 sinc period ident comput structur note period harmon schedul correspond iter program templat observ harmon schedul comput prefix sum sp element p parallel time step follow schedul comput k th step use induct number parallel step assum end k th step first sk prefix sum ah1 1i ah1 well avail end p th step harmon schedul comput number time step taken schedul h comput msp final valu iter determin follow number iter n elementsnumb time step per iter shown schedul h comput msp final valu multipl p step next show perform state theorem 41 also true n pp subject ceil effect theorem 42 extend harmon schedul schedul h extend comput prefix sum size n sp time 1e yield speedup proof previou theorem prove statement 1 suffic show statement true n sp n 6 msp 1 proof proce two case case 1 sp last q element call trail element final oper comput q trail element call trail final oper redund oper whose valu use trail final oper call trail redund oper without loss gener let us look exampl figur 413a1 m1 p7 new delay op step 3 74746755511811913 use delay slot step 3 7 comput intermedi valu use idl slot step 8 13 comput figur 4 amort scheme extend schedul h odd p mp 1th step want comput p final oper p gamma 12 redund oper given redund tree height 3 take exactli 3 step comput solut m1 p6 comput intermedi valu use delay oper slot idl slot delay op step 4 6 use idl slot step 7 11 comput new4667551081197108 figur 5 amort scheme extend schedul h even p amort comput ie delay final oper step use freed processor time slot comput redund tree incur q step comput delay oper idl processor slot step mp 1 exampl figur 4 redund tree use step 8 comput step 5 6 7 caus three final oper one step 5 7 delay three idl slot step 8 use comput three delay oper step 5 7 question whether feasibl amort scheme delay oper idl processor time slot ie whether alway enough delay oper match tail redund oper fashion note final oper iter delay oper depend henc enough delay oper match trail redund oper similar fashion alway find feasibl amort scheme step mp1 1p gamma 1 argument true odd p 2 therefor extend schedul h comput prefix sum size n sp time processor case 2 p 2 even let n case 1 amort scheme shown figur 5 note even p height trail local tree turn bp subject number trail element odd p height local tree alway p subject number trail element rest proof similar case 1 henc extend schedul h comput prefix sum size n sp time theorem 42 construct extend part schedul h follow unwind last iter minimum number step number nonredundantli schedul element number redund tree schedul need least 12 step complet nonredundantli schedul element redundantli schedul element redund tree redund tree redund tree figur redund tree redundantli schedul element nonredundantli schedul element schedul unextend schedul h use amort scheme delay oper last iter idl processor slot q step thu obtain gener extend schedul h epilogu handl length trail step 1 q p note although precis q depend n gener extend schedul h precomput instal librari routin q known run time correspond epilogu chosen run 5 optim harmon schedul section show schedul h comput strict optim time step prefix sum size n sp processor lemma 51 present lower bound time parallel schedul p processor lemma 53 show schedul r r h p h given number processor p theorem 51 prove optim schedul h consid element given prefix problem store array call element array redundantli schedul element use redund oper otherwis call nonredundantli schedul element nonredundantli schedul element particip redund oper directli use final oper ie direct arc nonredundantli schedul element final oper figur 6 element nonredundantli schedul element redundantli schedul set redund oper said form redund comput cluster redund cluster short iff depend oper form connect graph remov final oper depend graph use result produc redund oper without consid directed result graph redund cluster provid redund lookahead valu use final oper parallel step schedul shown figur 6 note depend graph redund cluster schedul restrict tree nonleaf node redund cluster redund valu produc redund oper cluster leav redund cluster redundantli schedul element cluster redund cluster cover redundantli schedul element leav ie use comput redund valu lemma 51 schedul comput prefix sum number nonredundantli schedul element number redund cluster proof singl parallel step one nonredundantli schedul element alon redund valu one redund cluster alon use comput final valu particular schedul prefix sum redund cluster take least completelemma 52 parallel schedul prefix sum size n number redundantli schedul element smaller equal sum number redund oper number redund cluster ie number redundantli schedul element r anumb redund cluster proof redund cluster c r c redund oper use h redundantli schedul element array least c number redund cluster schedul note also redund cluster disconnect ie depend pair redund cluster thu number redundantli schedul element number redundantli schedul element redund cluster c j r anumb redund cluster alemma 53 prefix sum size multipl p schedul r r h tp schedul comput given prefix fewer step schedul h proof lemma 52 number nonredundantli schedul element array sizegammanumb redundantli schedul element anumb redund cluster lemma 51 number redund cluster number nonredundantli schedul element gamma 1 number redund cluster anumb redund cluster a1 r theorem 42 p r two statement given r r h r t109100918273645546101938881746760534673676155494337312519615651464136312621162624222018164945413733292521171393532292623221916131074336298577696153453737221141412108642242220181614121086428642t time step p number processor n array size figur 7 maximum size n prefix sum done time use p processor 2 2 theorem 51 optim schedul h given p processor prefix problem size schedul must time proof number final oper schedul comput prefix sum size n n gamma 1 henc suffic show 1 schedul redund oper h comput prefix size n fewer step h 2 schedul redund oper h comput prefix size n fewer step h statement 1 true schedul h maximum possibl processor util p step schedul redund oper h step produc fewer final result h regardless redund oper arrang assum fulli util p processor statement 2 hold lemma 53 2 corollari 51 optim extend schedul h given p processor prefix problem size strict optim time p proof theorem 51 prove statement multipl sp multipl sp theorem 42 state schedul h achiev time p 1e amort scheme optim time shown similar way proof theorem 51 2 corollari 52 ratio timeoptim schedul prefix sum ratio final redund oper p multipl p proof follow theorem 42 theorem 51 2 corollari 52 use deriv simpler concis programspac effici optim schedul illustr figur 7 show maximum size n prefix sum comput time processor number diagon equal 1 sp start number diagon p larger preced number diagon impli optimalitygiven one step p final valu comput row odd p start increas p12 increas one row even p start increas one n increas turn bp 12e n increas averag p 6 pipelin schedul schedul h strict timeoptim prefix sum size n sp schedul p iter inner loop bodi wonder whether simpler shorter schedul compar perform exist corollari 52 ratio final redund oper optim schedul p h achiev ratio everi iter p step schedul achiev ratio fewer step p smaller loop bodi h still optim appli idea softwar pipelin inde deriv simpler concis programspac effici schedul h call pipelin schedul schedul p schedul p loop bodi singl parallel step p final p gamma 12 redund oper yield speedup schedul h except small constant number step startup odd p achiev ratio p singl parallel step even p amort need achiev ratio remaind section give complet schedul p odd number processor p schedul p even number processor p deriv similarli prefix sum size n comput pipelin schedul odd number processor p first p step schedul set actual iter iter step comput final valuesus preced final valu previous comput redund valu redund valu futur iter array subscript instanti schedul p simplifi compil time p given note oper loop bodi singl step thu execut parallel schedul 61 pipelin schedulep step parallel p processor forin iter p 1 final valu array comput first p 1 express p valu comput last p comparison schedul h schedul p choos proper epilogu either compil run time also schedul p may extend handl loop multipl statement easili schedul h 13 initi step 4 iter step figur 8 pipelin schedul 7 5 iter step 14 initi step figur 9 pipelin schedul exampl 61 let us instanti schedul p 7 schedul given illustr figur 8 oper step done parallel one processor step 3 step parallel p processor figur 9 illustr schedul deriv gener schedul obtain even number processor p amort schedul odd iter comput bp12c final dp gamma 12e redund oper even iter comput dp final bp gamma 12c redund oper theorem 61 prefix sum size n comput schedul p p 2 processor time d2np schedul p speedup util u infin proof proof straightforward 2 7 formul strict timeoptim schedul deriv strict timeoptim schedul prefix sum size n sp schedul n sp use parallel loop contain loopcarri depend schedul n sp equal use design highspe circuits13 5 section present new formul find strict timeoptim schedul term combinatori optim unifi singl framework optim schedul prefix problem n sp sp thu new approach yield gener scheme optim schedul prefix sum n p establish connect structur prefix comput pascal triangl thu formul problem find strict timeoptim schedul solv system inequ base algorithm construct optim schedul deriv first give intuit solut character differ cost final result full thr graph final find minimum cost produc n final result p processor particular form foundat algorithm present next section build timeoptim schedul prefix problem size n p processor next section strict time lower bound n sp1 schedul given n sp p 1 find optim p equival find maximum size n prefix sum comput p step shall find optim schedul n sp follow line think lemma 51 optim schedul step cluster thu processor optim schedul must comput maximum number final valu cluster way make redund cluster produc within maximum allow height mani redund result possibl use comput final result want make redund cluster cover mani element array possibl within maximum allow height maximum allow height redund cluster determin rel posit cluster among redund cluster nonredundantli schedul element graph redund cluster exce maximum allow height critic path comput lengthen neither height redund cluster lower would make redund cluster cover fewer origin element ie produc fewer final result could otherwis comput tree height k maximum number origin element cover 2 k enough processor redund cluster schedul grow full binari depend graph schedul satur ie final result comput processor step basic idea tri achiev dual goal maximum util processor minimum number redund oper howev n sp harmon schedul section 4 longer applic intuit enough prefix element make singl periodth minimum number prefix element make singl period spthe period length plu start element henc given regular pattern comput exist n sp difficulti lie determin mani redund oper use redund cluster organ dual goal accomplish definit 71 node n 1 binari depend graph said right depend node n 2 iff n 1 use second operand valu produc n 2 given valu repres n 2 node n 1 said right depend figur 10 rightdepend comput tree node n k1 distanc k iff exist distinct node n right depend k concept left depend left depend distanc k defin similarli notat 71 cost vector let top fring oper comput graph height cost vector j rightdepend distanc oper aj valu j cost vector equal number oper jth partial sum graph right depend thu sum j 0 j equal number oper whole graph shown figur 10 cost vector graph left right 0 respect total number oper graph equal 0 respect shall see soon depend graph construct cost vector determin theorem 71 corollari character differ cost final valu full thr graph show relev properti help us minim total cost problem size number processor given theorem 71 full graph height k number node top fring rightdepend distanc j proof prove theorem induct height k full graph base graph height one node top fring rightdepend distanc show one case facilit understand graph height two node top fring rightdepend distanc 0 1 respect illustr figur 11 left leaf graph height 1 also node top fring rightdepend distanc 0 root node top fring rightdepend distanc 1 thu induct assumpt assum theorem hold show theorem hold 1 intuit shown figur 11 number node rightdepend distanc j top fring full graph height k1 sum number height k height k height 0 height 1 full graph full graph full graph full graph height k1 full graph figur 11 number node top fring graph height k rightdepend distanc topfring oper node first subgraph height k rightdepend distanc j number topfring oper node second subgraph height k rightdepend distanc sinc new layer oper node top second subgraph height k preced argument induct assumpt corollari 71 1 total number oper node top fring full graph height k k 0 2 given n full graph height 0 sum number oper node top fring rightdepend distanc j 3 total number oper node top fring n full graph height 0 equal 2 n gamma 1 proof claim 1 true total number oper top fring full graph height k equal sum number oper top fring rightdepend distanc j ie sum g kj k theorem 71 note truth claim 1 also found observ number array element cover full graph proof claim 2 requir claim theorem 71 43 44 g g g g g 1 3 4 figur 12 correspond theorem 61 corollari 61 pascal triangl 3 follow claim 1 sum g k figur 12 show correspond theorem 71 corollari pascal triangl corollari 72 cost vector full thr graph let 1 idimension vector element equal 1 let dimc dimens vector c cost vector c k full graph height k determin recurs follow proof proof straightforward 2 figur 10 cost vector full graph height 3 given follow recurs sequenc follow tri find minimum cost depend graph prefix size n p processor theorem 72 give system inequ determin minimum time step requir comput prefix problem use p processor theorem 72 lower bound time requir comput prefix problem size n processor determin use follow system inequ number topfring oper ie number final result rightdepend distanc k equal l k maximum rightdepend distanc use schedul proof theorem 71 delta number oper ie number final result top fring graph rightdepend distanc iwhich seen cost full graph height number final oper rightdepend distanc k full graph height goal choos use schedul final oper minimum sum cost ie right depend distanc simultan maxim util p processor solv first inequ k mean find minimum graph height minimum rightdepend distanc k given prefix comput time final oper rightdepend distanc k sinc number processor p involv first inequ may multipl pair solut k ie pair k give minimum number oper use comput prefix respect particular number processor given number processor p uniqu pair k determin comput result given prefix minimum number oper second inequ use choos k respect p ie pair k choos enabl us construct schedul p processor maxim util second inequ equal number oper requir redund cluster height 0 mean suffici mani processor slot step p processor comput oper requir cluster cover n prefix element pt gamma mean minimum number step produc final result p processor thu second inequ state lower bound time give suffici mani processor slot comput minimum number oper requir produc prefix result p processor 2 solut inequ impli width schedul ensur timeoptim goal achiev minimum cost number oper maximum resourc util simultan width schedul prefix comput paper defin maximum number oper comput singl step schedul mani case width schedul must larger number resourc p order ensur exist legal schedul given resourc shown exampl 81 restrict width schedul equal number processor p could way lead find strict timeoptim schedul schedul n sp theorem 72 suggest construct schedul start full thr graph 2 minimum number smaller n cut expens column graph optim produc precis harmon schedul proven strictli timeoptim exampl 83 illustr deriv n sp prove optim gener construct strict timeoptim schedul need prove 1 legal schedul devis use optim n p n sp 2 schedul strictli timeoptim show next section class n p n sp optim enabl us deriv legal schedul optim schedul follow theorem 72 subject condit mention schedul deriv full thr graph cut expens column devis schedul n sp base theorem 72 construct schedul comput prefix n element p processor use algorithm 81 given algorithm 81 input prefix comput n element number processor p output depend graph make parallel schedul perform prefix comput construct schedul ppcn p f 1 find min time min pn p 2 find min cost vectort k l 3 construct graphc tn gwe describ three procedur algorithm 81 remaind section complet section exampl built depend graph parallel schedul given prefix complet alloc oper graph p processor shall discuss processor alloc end section procedur 81 find min time input prefix size n number processor p output procedur find min time min pn p solv inequ theorem 72 minimum time minimum number processor p 0 requir maximum rightdepend distanc k result schedul number final result l rightdepend distanc k given p greater deriv p 0 procedur complet result schedul construct use sinc remain processor would use achiev minimum time given p smaller deriv p 0 procedur find min time pn p continu search minimum time n p procedur sped start better k one outer loop procedur optim omit favor readabl find min timen p f find min time min pn p find min time min pn p f 1for 2 3 4 5 ffind 2 6 p 7 0 pt gamma 8 p els return g g g find min time pn p f 1 2 3 0 return k lg gprocedur 82 construct cost vector cut scheme procedur take input solut l procedur 81 gener output cost vector comput graph evalu given prefix construct dimens result vector equal size n given prefix cost vector full graph deriv use techniqu given corollari 72 construct cost vectort k l f 1 deriv cost vector c full thr graph height 2 remov c element greater k 3 remov c l equal k follow group mean group consecut element equal k c 31 point rightmost group let 32 remov last element group point shift pointer group left point rightmost group leftmost group oper ie pointer move clockwis circular fashion 4 return result cost vector c gnote scheme choos c l element equal k chose use simpl scheme state step 3 facilit understand cut scheme discuss 20 procedur 83 construct graph procedur establish depend arc node depend graph place matrix tn describ next matrix encod depend graph evalu given prefix problem size n p processor store oper graph theta n spars matrix tn call construct matrix graph organ use cost vector c follow element given prefix problem store 0th row tn j oper jth partial sum graph right depend store jth column oper rightdepend distanc place ith four field associ oper oi j tn left sourc right sourc right dep distanc number depend field oi jleft sourc oi jright sourc point left right sourc node respect field oi jright dep distanc store rightdepend distanc node field oi jnumber depend number node node oi j depend includ oi j construct 1 2 oi jright dep distanc 1 oi jright sourceright dep distanc 3 column left sourcej gamma 1oi jright sourcenumb depend 4 row left sourc column left sourc gamma 5 oi jleft sourc orow left sourc column left sourc 6 jnumber depend sourcenumb depend oi jright sourcenumb depend gexampl 81 find minimum time optim schedul prefix size processor procedur find min time min p determin 22 result comput processor step ie depend graph height result rightdepend distanc procedur construct cost vector gener cost vector cost vector procedur construct graph construct schedul shown figur 13 theorem 72 fact valid schedul construct use cost vector schedul figur 13 achiev strict optim time prefix size 23 10 processorsexampl 82 find minimum time optim schedul prefix size processor exampl show procedur produc full treeheightreduct schedul n power 2 given enough processor procedur find min time min p determin result comput processor step ie depend graph height rightdepend distanc obtain full thr schedul height procedur construct cost vector gener cost vector c procedur construct graph construct schedul shown figur 14 well known strict timeoptim schedul prefix 2 processor cost vector32 22 figur 13 optim schedul prefix input size 23 p processor determin procedur cost vector figur 14 procedur gener full treeheight reduct schedul find minimum time optim schedul prefix size processor exampl illustr procedur produc precis harmon schedul procedur find min time min p decid minimum time requir comput 28 prefix sum 5 step minimum number processor accomplish p find min time p therefor continu find minimum time requir comput 28 prefix sum processor 7 step 28 result comput processor step ie depend graph height result rightdepend distanc 2 procedur construct cost vector gener cost vector construct graph creat precis comput graph harmon schedul one shown figur 2 shown achiev strict optim time section 5 2 algorithm 81 construct depend graph comput prefix n element p processor whether depend graph would make valid schedul depend sole exist legal processor alloc onto comput graph arbitrari n p n sp turn difficult prove exist sinc one would need character certain properti depend graph n p n sp abl character class depend graph show exist legal processor alloc ie exist class strict timeoptim schedul theorem 72 time impli depend graph lower bound theorem 71 column oper node show alloc exist ie strict timeoptim schedul n p found follow lemma say number processor slot ie number oper node depend graph alway multipl n lemma 81 proof observ thu delta integ 2 theorem 81 prefix n element comput step p processor class n p strict optim time step comput prefix n element p processor proof consid set column exactli 1s number 1s row set equal consid set column k 1s number 1s row set correspond number oper node time step equal total number processor slot requir comput prefix lemma 81 thu prefix n element comput step p processor sinc depend graph n p character theorem also construct use algorithm 81 theorem 72 algorithm 81 base strict optim time prefix size n p processor 2 depend graph class n p theorem 81 nice structur exactli p oper node time step thu p minimum number processor requir carri comput step gener valu n p n sp depend graph seem much less appar clean character class n p theorem 81 thu exist legal processor alloc depend graph n p n sp consid theorem 81 remain open strict timeoptim theorem 81 subject optim condit impli theorem 72 schedul n sp construct full thr graph cut expens column howev conjectur optim construct strictli timpoptim schedul n p n sp subject optim condit support fact 1 algorithm 81 construct precis harmon schedul proven strictli timeoptim 2 prefix problem n sp1 construct strict timeoptim schedul use algorithm 81 9 conclus present strictli timeoptim schedul parallel prefix comput resourc constraint divid parallel schedul prefix comput size n two area accord number processor p schedul n sp n sp1 2 prefix schedul n sp use parallel loop contain loopcarri depend schedul n sp equal use design highspe circuits13 5 prefix n element p processor p independ n n sp pp 12 deriv harmon schedul show harmon schedul achiev strict optim time step d2n gamma harmon schedul prefix comput also construct use algorithm 81 1e also deriv pipelin schedul optim schedul time take constant overhead dp gamma 12e time step strict optim time harmon schedul pipelin schedul express program templat parameter number processor p ie gener neglig time compil time p known harmon schedul pipelin schedul exhibit simpl nice pattern loop structur make easi implement main advantag pipelin schedul harmon schedul former singl parallel step loop bodi ie small program size prefix n element p processor p independ n n sp harmon schedul timeoptim n larg enough accommod repeat pattern n sp case establish optim method theorem 72 determin key paramet timeoptim schedul base connect theorem 71 corallari depend graph parallel prefix pascal triangl found use deriv paramet devis algorithm 81 construct schedul restrict class case term n p prove construct schedul strictli timeoptim subject optim condit discuss end section 7 also give strong empir evid conjectur algorithm 81 construct strict timeoptim schedul case fact optim method also appli deriv strict timeoptim schedul shown exampl 83 exist legal schedul n p n sp optim strict timeoptim schedul n p n sp remain open except open end conclud search strict optim time schedul achiev strict optim time parallel prefix comput resourc constraint crew pram model acknowledg author wish thank anonym review valuabl comment earlier draft paper r comput fluid dynam parallel processor compilersprincipl techniqu tool chapter 4 automat program parallel heurist suffix solut faster optim parallel prefix sum list rank parallel prefix comput processor chapter new bound parallel prefix circuit power parallel prefix structur comput comput parallel algorithm effici solut gener class recurr equat parallel prefix comput parallel comput use prefix problem introduct parallel algorithm architectur arraystreeshypercub parallel exposur exploit program optim schedul parallel prefix comput bound resourc algorithm complex discret function depthsiz tradeoff parallel prefix comput parallel program contain loopcarri depend resourc constraint tr ctr sukanya suranauwarat hideo taniguchi design implement initi evalu advanc knowledgebas process schedul acm sigop oper system review v35 n4 p6181 octob 2001 yenchun lin chaocheng shih new class depthsiz optim parallel prefix circuit journal supercomput v14 n1 p3952 juli 1999 armita peymandoust giovanni de mich symbol algebra time driven dataflow synthesi proceed 2001 ieeeacm intern confer computeraid design novemb 0408 2001 san jose california yenchun lin yaohsien hsu chunkeng liu construct h4 fast depthsiz optim parallel prefix circuit journal supercomput v24 n3 p279304 march yenchun lin jiannan chen z4 new depthsiz optim parallel prefix circuit small depth neural parallel scientif comput v11 n3 p221236 septemb yenchun lin junwei hsiao new approach construct optim parallel prefix circuit small depth journal parallel distribut comput v64 n1 p97107 januari 2004 jin hwan park h k dai reconfigur hardwar solut parallel prefix comput journal supercomput v43 n1 p4358 januari 2008 yenchun lin chinyu su faster optim parallel prefix circuit new algorithm construct journal parallel distribut comput v65 n12 p15851595 decemb 2005