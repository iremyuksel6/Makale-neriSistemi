interact timedepend particl trace use tetrahedr decomposit abstractstreak line particl trace effect visual techniqu studi unsteadi fluid flow realtim applic accuraci often sacrif achiev interact frame rate physic space particl trace algorithm produc accur result although usual expens interact applic effici physic space algorithm present paper develop interact investig visual larg unsteadi aeronaut simul perform increas appli tetrahedr decomposit speed point locat veloc interpol curvilinear grid preliminari result batch comput 1 show approach six time faster common algorithm use newtonraphson method trilinear interpol result present show tetrahedr approach also permit interact comput visual unsteadi particl trace statist given frame rate comput time singl multiprocessor benefit interact featur detect unsteadi flow also demonstr b introduct unsteadi particl trace rel new visual techniqu emerg need visual unsteadi timedepend data set steadyst flow simul requir one set grid solut data describ flow unsteadi flow simul may compris hundr thousand time step data time step associ grid solut file size data set run hundr gigabyt 23 numer techniqu visual unsteadi flow mirror use experiment fluid mechan includ path line time line streak line path line gener trace path singl particl also call particl path time line gener trace line particl releas time streak line gener continu inject particl fix locat line also call filament line popular visual techniqu also simplest gener wind tunnel produc inject smoke flow 4 stream line curv tangenti vector field gener use visual unsteadi flow show actual motion particl fluid rather theoret trajectori particl infinit veloc steadi flow stream line ident path line streak line unsteadi flow differ significantli exampl fig 1 show stream line path line streak line time line comput unsteadi simul flow around oscil airfoil techniqu shown 128th time step import flow featur data set vortex shed caus stall streak line time line reveal vortic well stream line path line latter techniqu fail captur featur show actual motion fluid time fig 1 comparison stream line path line streak line time line unsteadi flow goal studi interact comput visual streak line larg unsteadi comput fluid dynam cfd simul comput flow visual streak line gener releas particl discret interv usual accord simul time step continu inject particl lead rapid growth number particl flow must trace leav flow field simul end may sever thousand activ particl unsteadi flow essenti advect trace process effici possibl ii previou work mani algorithm present particl trace steadi flow yet rel consid extens unsteadi flow extens trivial time vari natur flow grid add complex almost everi part algorithm 3 consequ unsteadi particl trace usual comput batch process play back upon complet 5678 signific problem approach particl inject point must chosen advanc usual excess number particl releas 10000 prevent miss import flow structur better approach interact posit streak line injector studi particl motion real time interact unsteadi particl trace achiev bryson levit 9 simplifi algorithm data set transform veloc vector field uniform comput space make numer integr simpler resampl grid enabl entir data set store memori howev mani subtl featur flow lost result particl trace comput space recent come scrutini 10 shown poor accuraci compar physic space scheme iii physic vs comput space trace bodyfit curvilinear grid wide use model complex geometri aerospac vehicl cfd flow solver intern transform curv grid uniform cartesian space usual call comput space make numer calcul simpler effici output solut data gener transform back physic grid space post analysi visual flow solver particl trace algorithm may oper comput physic space comput space scheme requir curvilinear grid associ veloc field remap comput space particl advect map done preprocess step whole grid make particl trace effici 9 main disadvantag trace comput space transform jacobian matric usual approxim transform vector field may discontinu also irregular grid cell collaps edg transform veloc may infinit 11 analys sadarjoen et al 10 hultquist 12 steadi flow shown map techniqu produc signific error distort curvilinear grid calcul jacobian matric unsteadi flow move grid inaccur matrix three addit timedepend term must approxim 13 remark would prefer accur comput space data save directli flow solver howev provis plot3d data file format use wide nasa store field motiv improv physic space particl trace physic space trace scheme prefer interpol integr process done curvilinear grid elimin need evalu jacobian matric transform veloc field disadvantag task locat particl complic henc expens problem address paper explicit point locat techniqu present yield signific speedup common point locat techniqu newtonraphson iter method iv physic space trace algorithm physic space algorithm proceed first search element cell bound given point term cell search point locat process found veloc evalu point interpol nodal veloc unsteadi flow veloc compon usual need interpol tempor well spatial necessit load two time step data memori intermedi posit grid may also interpol grid chang time particl path determin solv differenti equat field line dt r particl locat v particl veloc time integr 1 yield r r v r 2 integr term right hand side evalu numer use multistag method eg rungekutta bulirschsto multistep method eg backward differenti adamsbashforth issu concern accuraci stabil method discuss darmof haim 14 regardless solv end result displac ad current posit rt give new particl locat time td essenti step timedepend particl trace algorithm follow 1 specifi inject point particl physic space xyzt 2 perform point locat locat cell contain point 3 evalu cell veloc coordin time interpol simul time step 4 interpol veloc field determin veloc vector current posit xyz 5 integr local veloc field use equat 2 determin particl new locat time td 6 estim integr error reduc step size repeat integr error larg 7 repeat step 2 particl leav flow field exce last simul time step import note step 5 may involv repeat applic step 2 3 4 depend numer integr scheme use 4th order rungekutta scheme use studi actual requir three repetit advanc time tdt refer section ive detail point locat tetrahedr cell core problem particl tracer given arbitrari point x physic space cell point lie natur coordin natur coordin also call barycentr comput coordin local nondimension coordin cell strictli comput coordin differ global defin wide use trilinear interpol function provid opposit map requir point locat determin coordin x given natur coordin xhz unfortun invert easili nonlinear product usual solv numer use newtonraphson method use point locat techniqu base tetrahedr element natur coordin evalu directli physic coordin tetrahedr element permit use linear interpol function map natur physic coordin note x 1 x 2 x 3 x 4 physic coordin vertic tetrahedron see fig 2 natur coordin xhz vari per usual 0 1 nondimension cell x z x z fig 2 tetrahedron geometri natur nondimension physic coordin space equat 3 invert analyt nonlinear term solut natur coordin given physic point x z z z constant 3x3 matrix determin v actual 6 time volum tetrahedron given natur coordin xhz evalu 104 float point oper implement equat figur halv precomput common term evalu matrix coeffici determin b tetrahedr decomposit hexahedr cell curvilinear grid must decompos tetrahedra order use equat 4 sinc data set timedepend flow usual extrem larg impract decomposit preprocess step must perform fli particl enter cell hexahedr cell divid minimum five tetrahedra fig 3 decomposit uniqu diagon edg altern across cell sinc face hexahedron usual nonplanar import ensur adjoin cell match diagon prevent gap achiev altern odd even decomposit illustr fig 3 curvilinear grid correct configur select simpli ad integ indic specif node node lowest indic use practic choos odd configur sum odd even configur sum even guarante continu cell remark odd even configur may switch impact point locat affect veloc interpol differ vertic use practic cfd grid fine resolut differ slight detect region high veloc gradient fig 3 subdivis altern two configur ensur continu cell c cellsearch scheme equat 4 allow natur coordin evalu directli physic coordin rel littl effort four condit must valid point lie within tetrahedron one invalid point outsid tetrahedron particl trace algorithm happen particl cross cell boundari problem aris tetrahedron advanc next solut quit simpl sinc natur coordin tell direct move exampl x0 particl would cross x0 face similarli h0 z0 particl would cross h0 z0 face respect fourth condit violat ie 1xhz0 particl would cross diagon face cellsearch proce advanc across respect face adjoin tetrahedron lookup tabl need identifi tetrahedron given appendix occasion two condit 5 may violat particl cross near corner cell travers sever cell case worst violat four condit use predict next tetrahedron even bound tetrahedron immedi neighbour alway move direct worst violat search rapidli converg upon correct tetrahedron test numer grid includ complex cgrid singular point never turn case techniqu fail locat bound tetrahedron cell search procedur describ use cell sought nearbi within cell previou one usual case particl trace sinc major particl cross one cell time two situat cell sought like nearbi start particl trace ii jump grid multizon data set circumst cell search preced anoth scheme order prevent weav across larg grid one tetrahedron time use boundari search techniqu describ bune 15 veloc interpol tetrahedron unsteadi flow veloc field chang time well space sinc veloc field solv discret time step discret locat grid must interpol time space present algorithm interpol handl separ d1 tempor interpol tempor interpol perform first use linear function appli two closest time step exampl given time lie time step l l1 veloc u arbitrari grid node ijk given time fraction tt l l1 l note equat 6 evalu veloc given node spatial interpol perform stage note also grid move time tempor interpol grid posit also requir use similar linear interpol function purpos tempor grid interpol must preced point locat although tempor veloc interpol howev conveni perform sinc time fraction interpol tempor interpol appli local singl tetrahedron current one use point locat veloc interpol procedur d2 spatial interpol one three techniqu may use spatial interpol veloc physic space linear interpol 16 volum weight interpol 15 linear basi function interpol 17 three mathemat equival 118 produc ident interpol function author show previous 1 linear basi function effici techniqu applic reus natur coordin comput point locat use number convent fig 2 linear basi function spatial veloc interpol x h z natur coordin comput equat 4 u 1 u 2 u 3 u 4 veloc vector vertic e numer integr scheme numer integr equat 2 perform 4th order rungekutta scheme timedepend flow move grid geometri take form r r r particl posit v veloc vector posit dt time step four stage rungekutta scheme span three time valu tdt2 tdt therefor requir new grid veloc data one fortun need interpol tetrahedron surround particl howev particl move time space integr may lie differ tetrahedra four intermedi stage equat 8 point locat veloc interpol must therefor perform everi stage remark numer integr scheme requir fewer veloc evalu rungekutta scheme eg bulirschsto method 19 may substitut improv perform unsteadi particl trace algorithm f step size adapt integr step size fix constant valu along entir particl path regul achiev specifi number step per cell particl may underst around bend flow chang direct rapidli prevent use adapt step size control scheme integr step size chang accord error toler error toler comput use standard numer techniqu step doubl 19 wherebi particl advanc forward given point use step size dt process repeat point use two half step size dt2 step size reduc distanc endpoint greater specifi toler number usual deduc trial error techniqu implement test found expens interact particl trace perform larg number point locat heurist techniqu adapt step size suggest darmof haim 20 measur angl veloc vector success point along particl path estim chang veloc direct implement scheme similar one adapt step size accord angl success line segment path line fig 4 particl path r r r co fig 4 step size adapt base chang path line direct scheme work well practic ran approxim three time faster step doubl algorithm case initi step size estim use u magnitud veloc current posit v determin equat 4 ensur initi particl displac commensur length scale tetrahedron follow initi estim step size halv angl q n larg doubl small q n 3 kept limit 3 q n 15 experiment sever data set found scheme produc particl trace accuraci step doubl scheme base error toler 5 latter adapt angl 15 degre upper limit 3 degre lower limit use v interact perform evalu previou paper author 1 perform accuraci tetrahedr method compar convent particl trace algorithm batch comput streak line convent algorithm origin develop bune 15 steadi flow extend unsteadi flow lane 8 use iter newtonraphson method point locat trilinear function grid veloc interpol execut profil confirm veloc interpol point locat comput expens task convent algorithm tetrahedr method comput time improv factor six still maintain accuraci streak line tetrahedr method sinc implement c virtual windtunnel 9 interact visual system studi unsteadi flow result present demonstr interact perform tetrahedr method system interact test perform sgi onyx four 75mhz r8000 processor five gigabyt ram larg memori capac enabl moder size unsteadi flow simul load physic memori thu avoid disk latenc access data taper cylind data set 7 use interact test see fig 5 100 simul time step 131k grid point grid dimens 64 x 64 x 32 time step consist approxim 15 megabyt veloc data fig 5 taper cylind data set use interact perform test ten streak line shown could comput render 33 frame per second find import flow featur unsteadi flow larg number particl must inject flow time respect object determin mani streak line could gener interact tetrahedr method fig 6 show aggreg time taken comput render streak line function number streak line 100 time step comput perform runtim use precomput field fig 6 show linear relationship number streak line comput time also show near linear speedup comput distribut two three processor linear trend occur streak line compris discret particl advect independ run multi processor virtual windtunnel creat p1 light weight process p number processor use sgi parallel program primit mfork one processor alway reserv virtual windtunnel oper system graphic task 1001030number streak line aggreg time comput renderfram 3 processor processor sec fig 6 time taken comput render 100 frame function number streak line time given one two three processor perform express term frame rate fig 7 one frame correspond one simul time step frame rate 10 frame per second accept baselin interact visual 9 result fig 7 show 15 streak line could comput render rate one processor likewis 32 streak line could comput render two processor 44 streak line three processor 10 framessec import note number particl streak line increas linearli time earlier frame much quicker comput later one frame rate shown averag step higher frame rate could obtain reduc number time step processor processor processor frame per second number streak line interact threshold fig 7 frame rate comput render streak line one two three processor anoth interest metric particl advect rate total number particl advect line n time step given number advect divid time taken comput streak line give particl advect rate interact threshold see fig 7 advect rate 8k particlessec one processor 14k particlessec two processor 22k particlessec three processor vi interact streak line featur detect illustr fig 1 particl path individu particl give mislead result sometim fail detect import flow featur inject larg number particl like captur featur although actual see difficult particl clump togeth cloud lot mix recircul flow found use interact probe flow use rake 10 40 injector howev user warn problem interact streak line streak line unlik stream line take time propag user move rake injector quickli best period stop let streak line cycl time step move anoth locat benefit near realtim perform interact rake adjust demonstr fig 8 exampl user want visual von karman vortex shed wake taper cylind gener area interest first identifi use wide rake injector rake shorten use probe region flow revers desir locat found number injector increas make streak line coher highlight vortex shed particl colour depict veloc magnitud fig 8 flow featur easili detect unsteadi flow interact move streak line injector interact streak line also use visual flow delta wing high angl attack shown fig 9 data set 100 simul time step singlezon grid like taper cylind nine time larger veloc field time step nearli 14 megabyt entir data set nearli 14 gigabyt although data set significantli larger test case perform particl trace degrad particl advect requir local cell search interpol previou result 1 shown perform penalti multizon grid global search requir particl move new grid fig 9 local global flow structur visual interact chang number streak line length rake unsteadi flow around delta wing vii futur direct taper cylind delta wing data set use studi small compar multizon data set current comput nasa ame research center small number time step larg multizon data set fit physic memori even largest workstat two approach investig allow scientist visual data first simpli subset grid reduc size local region interest second use larg disk array high bandwidth disk array 96 disk 200 gigabyt storag capac current evalu applic data transfer rate 300 megabyt per second measur potenti enabl us read solut file megabyt data per time step interact frame rate viii conclus tetrahedr decomposit made point locat veloc interpol task effici particl trace algorithm timedepend flow streak line comput render interact frame rate sgi onyx workstat data set 100 time step almost linear scale perform measur one two three processor use 44 streak line could comput visual 10 frame per second calcul perform three processor permit interact posit adjust streak line injector aid vortex detect unsteadi flow node number convent differ node number convent use odd even tetrahedr decomposit simplifi lookup tabl use point locat appendix ic2834 x z a752x z fig 10 odd b even number convent b tetrahedr decomposit follow diagram illustr hexahedr cell decompos 5 tetrahedra note tetrahedra drawn natur coordin system refer fig 2 detail x x z x z x z x z tetrahedron 1 tetrahedron 2 tetrahedron 3 tetrahedron 4 tetrahedron 5 x x z x z x z x z tetrahedron 1 tetrahedron 2 tetrahedron 3 tetrahedron 4 tetrahedron 5 b fig 11 odd b even tetrahedr decomposit c point locat lookup tabl two lookup tabl use locat tetrahedron bound particl first tabl predict tetrahedron particl move exit current tetrahedron particular face exit face determin four condit test base natur coordin xhz refer section ivc detail note tabl appli odd even tetrahedr decomposit condit test tetrahedron 1 tetrahedron 2 tetrahedron 3 tetrahedron 4 tetrahedron 5 z 0 4 1 2 3 1 fig 12 adjac tetrahedron lookup tabl second tabl use updat cell indic ijk particl move differ hexahedr cell cell divid five tetrahedra particl may cross sever tetrahedra actual leav cell previou tabl number current tetrahedron exit face need identifi appropri row column entri cell tabl indic neighbour tetrahedron hexahedr cell condit test tetrahedron 1 tetrahedron 2 tetrahedron 3 tetrahedron 4 tetrahedron 5 z 1xhz 0 cell cell cell cell cell condit test tetrahedron 1 tetrahedron 2 tetrahedron 3 tetrahedron 4 tetrahedron 5 z 1xhz 0 cell cell cell cell cell b fig 13 cell index lookup tabl odd b even tetrahedr decomposit acknowledg grate steve bryson help us instal tetrahedr method virtual windtunnel also grate follow peopl allow us use data set sungho ko oscil airfoil denni jespersen creon levit taper cylind neal chaderjian delta wing work support nasa contract na 212961 r optim timedepend particl trace use tetrahedr decomposit softwar model visual larg unsteadi 3d cfd result scientif visual larg scale unsteadi fluid flow analysi visual complex unsteadi threedimension flow numer simul streaklin unsteadi flow numer simul flow past taper cylind visual timedepend flow field virtual windtunnel environ explor threedimension unsteadi flow particl trace algorithm 3d curvilinear grid sourc error graphic analysi cfd result interact numer effici solut method navierstok equat analysi 3d particl path integr algorithm numer algorithm cfd postprocess finit element analysi fluid dynam finit element method display finit element method engin numer recip visual 3d vector field variat stream tr ctr guy albertelli roger crawfi effici subdivis finiteel dataset consist tetrahedra proceed 8th confer visual 97 p213219 octob 1824 1997 phoenix arizona unit state ralph bruckschen falko kuester bernd hamann kenneth joy realtim outofcor visual particl trace proceed ieee 2001 symposium parallel largedata visual graphic octob 2223 2001 san diego california falko kuester ralph bruckschen bernd hamann kenneth joy visual particl trace virtual environ proceed acm symposium virtual realiti softwar technolog novemb 1517 2001 baniff alberta canada dale lawrenc christoph lee luci pao roman novoselov shock vortex visual use combin visualhapt interfac proceed confer visual 00 p131137 octob 2000 salt lake citi utah unit state jen kruger peter kipfer polina kondratieva rudig westermann particl system interact visual 3d flow ieee transact visual comput graphic v11 n6 p744756 novemb 2005 john g hagedorn steven g satterfield john kelso whitney austin judith e terril adel p peskin correct locat orient error electromagnet motion track presenc teleoper virtual environ v16 n4 p352366 august 2007 dale lawrenc luci pao christoph lee roman novoselov synergist visualhapt render mode scientif visual ieee comput graphic applic v24 n6 p2230 novemb 2004 j schroeder berk geveci mathieu malaterr compat triangul spatial decomposit proceed confer visual 04 p211218 octob 1015 2004 shyhkuang ueng christoph sikorski kwanliu outofcor streamlin visual larg unstructur mesh ieee transact visual comput graphic v3 n4 p370380 octob 1997