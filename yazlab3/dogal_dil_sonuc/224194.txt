effici algorithm atmospher correct remot sens data remot sens imageri use develop valid variou studi regard land cover dynam howev larg amount imageri collect satellit larg contamin effect atmospher particl object atmospher correct retriev surfac reflect remot sens imageri remov atmospher effect introduc number comput techniqu lead substanti speedup atmospher correct algorithm base use lookup tabl exclud io time previou known implement process one pixel time requir 263 second per pixel sparc10 machin implement base process whole imag take 420 microsecond per pixel machin also develop parallel version algorithm scalabl term comput io experiment result obtain show themat mapper tm imag 36 mb per band 5 band need correct handl less 43 minut 32node cm5 machin includ io time b introduct data landsat seri satellit avail sinc 1972 primari sourc data first three satellit multispectr scanner system mss themat mapper tm landsat 4 5 repres major improv compar mss term spectral resolut 4 waveband mss 7 narrow waveband tm spatial resolut 79 meter mss meter tm tm data wide use resourc inventori environment monitor varieti applic 1 sinc 1979 advanc high resolut radiomet avhrr board nation ocean atmospher administr noaa seri satellit continu polar orbit avhrr data becom extrem import global studi carri multipl band visibl infrar thermal spectrum complet coverag earth avail twice daili 11 km resolut nadir two platform avhrr allow us first time improv studi earth surfac region scale global scale use remot sens techniqu 1 2 radiat earth surfac highli character surfac inher properti larg contamin atmospher atmospher particl aerosol molecul scatter absorb solar photon reflect surfac way part surfac radiat detect sensor hand atmospher particl scatter sunlight sensor field view directli result radiat contain surfac inform combin atmospher effect due scatter absorpt wavelength depend vari time space depend surfac reflect spatial variat 3 tm band 1 like aerosol contribut order 50 even rel clear sky condit although qualit evalu remot sens data use develop quantit linkag satellit imageri surfac characterist greatli depend remov atmospher effect object socal atmospher correct retriev surfac reflect remot sens imageri demonstr 4 5 atmospher correct significantli improv accuraci imag classif atmospher correct algorithm basic consist two major step first optic characterist atmospher estim either use special featur ground surfac direct measur atmospher constitu 10 use theoret model variou quantiti relat atmospher correct comput radi transfer algorithm given atmospher optic properti second remot sens imageri correct invers procedur deriv surfac reflect shortli discuss detail paper focu second step describ work improv comput effici exist atmospher correct algorithm section 2 present background materi known atmospher correct algorithm describ section 3 describ section 4 substanti effici version algorithm section 5 develop parallel implement algorithm scalabl term number processor intern memori size number io node case studi present section 6 conclud remark given section 7 background 21 atmospher correct order correct atmospher effect relationship upward radianc l measur satellit surfac reflect ae estab lish radi transfer theori use purpos assum atmospher bound lambertian surfac ie reflect solar energi isotropi calli upward radianc top cloudfre horizont homogen atmospher express 6 l 0 upward radianc atmospher zero surfac reflect often call path radianc f downward flux total integr irradi ground transmitt surfac sensor probabl photon travel path without scatter absorb atmospher albedo probabl photon reflect surfac reflect back surfac eqn 1 see factor ae sum infinit seri interact surfac atmospher order invert ae l eqn 1 need determin quantiti function wavelength atmospher optic properti set locat paramet locat inform includ surfac level observ height observ solar zenith angl observ azimuth angl figur 1 two main task involv first estim atmospher properti second calcul function requir invert surfac reflect ae zenith f z figur 1 angular coordin use algorithm xy plane horizont plane tangent earth surfac observ point solar zenith angl observ zenith angl observ azimuth angl oe shown easi obtain simultan measur atmospher optic properti oper rapid variat atmospher estim atmospher optic properti imageri way oper atmospher correct one main paramet need tm avhrr imageri aerosol optic depth defin socal dark object 7 approach use studi idea behind approach quit simpl search pixel low surfac reflect use tm band 7 8 avhrr band 3 9 10 aerosol effect small assign small surfac reflect dark pixel aerosol optic depth figur eqn 1 note case deviat assign reflect true reflect result larg uncertainti estim aerosol optic depth sinc small given aerosol optic depth determin l 0 f eqn 1 simpl task due fact quantiti relat solut radi transfer equat 6 integrodifferenti equat analyt solut avail coupl approach obtain practic solut first use numer iter approach discreteordin algorithm 11 gaussseidel algorithm 12 result solut accur method involv comput expens feasibl larg scale studi anoth approach simplifi radi transfer equat use approxim twostream approxim 13 fourstream approxim 14 approxim algorithm comput effici accuraci limit altern set offlin lookup tabl 15 certain input valu addit tabl quantiti l 0 f effici calcul high accuraci use interpol approach follow studi refer lookup tabl approach 22 high perform comput hpc exist code 15 atmospher correct base lookup tabl approach process one pixel time meant use interact take 263 second correct singl pixel sparc10 machin exclud io singl tm imag cover area size 180km theta 180km consist approxim 36 million pixel per band therefor requir 15 year correct exist code exclud io time address appar intract attempt achiev follow two object ffl minim overal comput complex maintain accuraci algorithm ffl maxim scalabl comput io function avail resourc comput node io node size intern mem ori believ algorithm describ rest paper achiev object simultan fact abl correct tm imag less 13 minut sparc10 exclud io less 43 minut 32processor cm5 includ io 23 data sourc studi tm avhrr use primari sourc input data algorithm essenti featur imageri type follow tm imageri consist 7 channel correspond 7 spectral band resolut 30m five band need correct band 6 correspond thermal channel atmospher much scatter effect band 7 16 imag cover approxim area size 180km theta 180km requir per channel pathfind avhrr imageri consist 12 channel 5 channel origin band inform 2 band need correct 17 remain channel provid locat qualiti cloud time inform band requir 20mb resolut 8km avhrr imag cover entir globe 3 atmospher correct algorithm 31 descript algorithm direct implement atmospher correct algorithm base lookup tabl approach describ 15 fortran version given overal algorithm sketch follow algorithm atmospher correct input n pixel valu follow inform pixel measur wavelength atmospher correct paramet locat inform day measur moreov lookup tabl solar flux function provid output surfac reflect pixel pixel step read input paramet appropri lookup tabl step b perform initi requir normal step c comput interpol use lookup tabl step comput surfac reflect ae use eqn 1 step b comput solar flux measur wavelength linear interpol use spectral irradi earthsun distanc given wavelength correct solar flux day year measur made use result convert measur radianc l absolut unit reflect unit also comput default valu water gaseou carbondioxid ozon absorpt linear interpol measur wavelength interpol step b spline interpol degre one spline interpol consist polynomi piec subinterv join togeth certain continu condit formal suppos tabl spline function degre k point function 1 interv polynomi degre k 3 continu 1st deriv x 0 x n thu spline interpol degre one piecewis linear function interpol point x want find valu function point x assum x 0 x x n henc spline interpol degre one need find index 0 approxim valu gammay j1 step c comput intens involv linear nonlinear terpol give next detail step c comput l 0 function wavelength locat atmospher paramet algorithm interpol input wavelength atmospher correct paramet locat inform lookup tabl begin 1 interpol l 0 measur height 2 interpol l 0 wavelength adjust excess deficit gaseou water absorpt 3 interpol l 0 measur solar zenith angl 4 interpol l 0 measur observ azimuth angl 5 interpol l 0 measur observ zenith angl 6 interpol l 0 measur optic thick step 1 linear interpol extrapol perform interpol step 2 piecewis exponenti interpol requir step 3 4 5 spline interpol degre one piecewis exponenti interpol point x x log x log interpol measur optic thick requir step 6 nonlinear consist follow substep first find minimum nonlinear function subinterv costli process given complex function minim second perform linear nonlinear interpol depend outcom first substep 32 implement direct atmospher correct algorithm code fortran 15 test 20 pixel use eight lookup tabl one tabl 2 avhrr band 0639 0845 one 6 tm band 0486 0587 0663 0837 1663 2189 tabl contain valu l 0 f nine solar zenith angl 1020304050606672and 78 degre 13 observ zenith angl 0 78 degre everi 6 degre 19 observ azimuth angles0 180 degre everi 10 degre plu 5 175 degre 4 aerosol optic thick 00 025 050 10 3 observ height 045 45 800 kilomet one tabl use give solar spectral irradi 60 wavelength rang 0486 2189 code correct singl pixel imag wavelength solar observ angl aerosol optic thick data assum rang discuss extrapol perform select paramet match valu use construct lookup tabl algorithm interpol paramet observ height algorithm interpol extrapol choos one show minim atmospher effect lower valu intens higher valu transmitt select comput pixel begin read input data lookup tabl follow approxim valu l 0 f interpol final surfac reflect pixel comput use eqn 1 result algorithm take 263 second correct singl pixel sparc system henc code suitabl handl imag singl tm imag cover area size 180km theta 180km take 15 year correct 5 band next section present modifi version algorithm run substanti faster quit effici handl imag optim overal comput complex introduc number techniqu lead substanti effici version atmospher correct algorithm group new techniqu 5 major type describ briefli next reorder classifi oper previou algorithm oper repeat pixel rearrang oper three group 1 imag base 2 window base 3 pixel base first group includ oper independ pixel valu exampl read lookup tabl initi interpol base height sensor imag base oper correspond oper perform one pixel use remain pixel second class oper window base reserv depend paramet remain fairli constant window size w theta w suitabl valu w exampl aerosol optic thick remain fairli constant small neighborhood atmospher condit resolut imag determin valu w follow comput interpol belong second group depend paramet consid constant window oper perform window perform pixel base comput remain comput interpol belong third group depend pixel valu paramet differ pixel reorgan oper atmospher correct algorithm first group imag base oper appear first follow second group window base third group oper result substanti reduct total number oper use perform interpol subcub group origin al gorithm interpol caus one dimens remov moreov interpol piecewis interpol reduc number oper ation first identifi appropri index along dimens interpol requir within certain class imag window pixel extract subcub obtain intersect index techniqu comput complex reduc also comput complex becom almost independ size lookup tabl data depend control anoth techniqu use characterist differ data input reduc overal comput complex high resolut data paramet constant whole imag coars data paramet chang window pixel window pixel hand comput complex per pixel much import high resolut data coars data due larg differ amount data involv chang nonlinear interpol linear interpol replac nonlinear interpol linear interpol expens increas size lookup tabl techniqu decreas number comput nonlinear interpol window base oper increas lookup tabl size mostli affect imag base oper ex ampl replac nonlinear interpol measur optic thick induc window base oper linear interpol remov unnecessari interpol replac interpol simpler oper whenev possibl exampl sinc deal satellit imag need interpol observ height sinc assum constant techniqu quit effect improv perform preserv qualiti correct imageri tabl 1 show perform atmospher correct algorithm differ window size differ type input data execut time includ io time obtain machin clearli new code substanti faster code 15 use correct 5 band tm imag cover area size 180km theta 180km window size 19 theta 19 less 13 minut sparc10 machin exclud io data type window size timesecpixel tm 19 theta 19 401 avhrr 19 theta 19 1525 tabl 1 perform sparc10 machin interest notic substanti speedup achiev increas window size certain point point 5 theta 5 tm speedup start level also tm data correct much faster avhrr data algorithm follow reason first comput tm imag base oper avhrr mostli window base oper second skip interpol tm data observ angl mention input code raw data need preprocess input code 15 format need anoth program transform raw data special format input 5 parallel implement atmospher correct global data set requir extens handl larg amount data resid extern storag henc optim io time must consid addit comput time seek achiev effici layout input imageri disk effici map comput across processor way total comput io time minim concentr first model io perform give descript parallel algorithm togeth overal theoret perform follow experiment result 32node cm5 interconnect network iop iop iop pn pn pn figur 2 process node io node connect interconnect network 51 io model parallel model consist number p comput node p number io node n 0 connect interconnect network figur 2 purpos view io node hold larg disk disk array data transfer extern storag unit block block consist number b contigu record disk simultan transfer block network therefor theoret total io bandwidth time bandwidth provid singl io node actual bandwidth depend sever factor includ interconnect network ratio p network io interfac current parallel system use techniqu disk stripe consecut block store differ disk case n theta n imag say rowmajor order form stripe across disk block unit imag access parallel adopt singl disk model larg bandwidth singl disk model time transfer data sum two compon access setup time n data size e transfer time per element thu io time depend essenti two param eter e serial machin access setup time mostli seek time around 20msec parallel machin consider larger wherea transfer time per element substanti smaller invers total bandwidth spite fact e vari one applic anoth approxim reason well constant io perform estim use number n p pass data number n disk access case total data transfer time given n theta access setup time much larger transfer time minim number disk access usual much import minim number pass implement atmospher correct algorithm discuss shortli possibl minim io time minim paramet independ problem eg matrix transposit possibl come algorithm use pass requir less total io time reduc number disk access 18 brief descript cm5 io system relationship model present appendix 52 parallel algorithm sketch parallel atmospher correct algorithm achiev comput io scalabl algorithm design singl program multipl data spmd model use multiblock parti librari therefor processor run code differ part imag multiblock parti librari 19 20 runtim support librari parallel applic code effici provid share memori view distribut memori machin make code portabl larg set parallel machin sinc librari avail cm5 intel ipsc860 paragon ibm sp1 pvm messag pass environ network workstat straightforward parallel implement algorithm appli band n theta n imag 4 requir one pass imag done follow read block maximum possibl size say n theta n imag fit intern memori correspond paramet part 4 assum number column row equal simplic type analysi carri gener case imag appli atmospher correct procedur current block write back result procedur repeat entir imag process method requir n disk access per iter henc cn n 2 disk per band requir memori size per processor c constant howev modifi algorithm minim number disk access follow iter instead read block read slab consist maximum possibl number say r consecut row imag fit intern memori correspond paramet appli atmospher correct procedur slab write back result repeat procedur entir imag process need one disk access per iter henc total number disk access reduc c n 2 mp clearli optim new algorithm still requir one pass imag therefor total transfer time also optim given mp b number band correct b 5 tm c 1 cost constant number disk access per pass c 2 number byte per pixel read write given relat io time control chang number processor number disk io node algorithm interprocessor commun introduc possibl partit window across processor elimin replac r r wp c theta w theta p done least w row fit intern memori processor realist assumpt reason valu w ie 500 comput time tm avhrr estim c 3 c 4 c 5 machin depend constant fact c 3 requir time imag base comput c 4 requir time per window window base oper c 5 requir time per pixel pixel base oper constant accur estim given machin exampl tm data cm5 c 3 26sec c 4 62sec c 5 18sec note c 3 includ io time read lookup tabl number valid larg data agre observ experiment result summar total time given mp perform analysi indic algorithm scalabl term paramet p term n numer denomin also desir valu total deriv number processor number disk io node achiev imag size pixel sec figur 3 atmospher correct perform tm imageri cm5 differ imag size two window size differ number processor result run code 32node cm5 illustr figur 3 figur show total time second differ imag size two window size differ number processor use least squar approxim smooth curv also includ real data one case theta 5 16 processor show linear experiment data experiment result consist analysi carri model graph run time scale properli imag size number processor differ window size 6 case studi applic algorithm real tm imageri present section figur 4 show subset tm imag band 1 3 7 acquir aug 17 1989 amazon basin area see larg portion imag band 1 3 middl occupi hazi aerosol thin cloud band 7 less contamin larg wavelength scatter effect neglig order remov aerosol contamin first step implement socal darkobject approach estim aerosol optic depth use band 7 develop preliminari program estim aerosol optic depth tm imag appli mention imag 5 obtain aerosol optic depth channel surfac reflect retriev use new atmospher correct algorithm describ section 5 retriev reflect shown figur 4 evid hazi aerosol channel 1 3 remov also interest see correct channel 3 look even clear channel 7 retriev 5 detail algorithm publish valid band 1 correct band 1 correct band 3 correct band 3 correct band 7 figur 4 tm imageri 512 theta 512 surfac reflect underneath hazi aerosol evalu knowledg ground truth 7 conclus introduc number techniqu obtain effici atmospher correct algorithm base lookup tabl approach result algorithm correct 5 band tm imag cover area size 180km theta 180km less 13 minut sparc10 machin exclud io parallel version algorithm scalabl term number processor number io node size intern memori also describ analyz experiment result 32node cm5 machin provid work constitut part larg multidisciplinari grand challeng project appli high perform comput land cover dynam aspect includ parallel algorithm system imag process spatial data handl emphasi object orient program parallel io larg scale imag map acknowledg thank dr alan sussman help us use multiblock parti librari ms shana mattoo provid origin nasa code describ 15 answer mani question regard atmospher correct algorithm base lookup tabl help greatli appreci also thank professor ralph dubayah provid comment regard project r represent veget continent data set deriv noaaavhrr data global dataset land applic advanc high resolut radiomet introduct atmospher effect remot sens correct rel import scatter absorpt remot sens effect atmospher classif satellit observ identifi surfac featur london oxford univers press remot sens aerosol contin dark target identifi 22 um channel aerosol retriev land avhrr data applic atmospher correct size distribut scatter phase function aerosol particl retriev sky bright measur calcul angular radianc distribut coupl atmospher canopi algorithm atmospher correct aircraft satellit imageri themat mapper data characterist use long term data set global terrestri observ report avhrr pathfind land scienc work group effici transposit algorithm larg matric compil runtim support structur block structur applic manual multiblock parti runtim primit version 4 connect machin cm5 technic summari tr manual multiblock parti runtim primit revis 4 compil runtim support structur block structur applic