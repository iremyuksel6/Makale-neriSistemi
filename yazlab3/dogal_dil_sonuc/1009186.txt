solv equat relat algebra enumer solut relat algebra equat natur power oper ad queri languag primit nest relat algebra yield queri languag nest relat databas equival wellknown powerset algebra studi spars equat equat polynomi mani solut look complex compar express power similar notion powerset algebra b introduct suppos allow see view databas b comput relat algebra express e still want find b might tri invert e assum ing know express work also know finit domain b specif enumer databas test x whether satisfi equat eb one solut b cours set solut big might provid us use inform start detect work simpl scenario databas secur led us wonder said gener solut equat relat algebra gener e 1 e 2 two algebra express databas schema augment relat variabl x 1 consid equat e solut equat given databas b finit domain tupl x relat e 1 e 2 evalu relat augment databas ask whether exist solut relat algebra equat databas almost exactli thing ask whether existenti secondord logic sentenc true databas henc fagin theorem fag74 ef95 problem formul find solut relat algebra equat noth problem np howev present paper start observ set solut equat set tupl relat nest relat one therefor consid enumer solut equat queri languag primit ad nest relat algebra introduc studi extens nest relat algebra call equat al gebra equat algebra extrem pow er equival wellknown powerset algebra nest relat particular interest howev express equat algebra use equat solut set polynomi size databas call equat spars interest spars equat stem time effici consider deed obviou know equat spars would help actual find even one solut quickli neither obviou howev would help exampl consid problem check given databas whether fix spars relat algebra equat solut use extens fagin theorem nest relat databas show problem nphard everi problem np alreadi decid polynomialtim nondeterminist ture machin polynomi mani accept comput input latter one mani unresolv question comput complex theori all86 nevertheless spars equat still interest space effici standpoint deed natur evalu strategi equat algebra express run polynomi space necessari equat occur express spars interest fragment power queri languag natur evalu strategi polynomialspac new databas theori research exampl abiteboul vianu av91 show pariti queri express polynomialspac fragment variou comput complet queri languag closer topic work suciu paredaen sp97 show queri transit closur pariti express polynomialspac fragment powerset algebra nest relat 1 fragment consist powerset algebra express intermedi result polynomi size databas also mention grumbach vianu gv95 also studi sparsiti notion connect queri nest relat databas although consid sparsiti properti databas rather queri languag express suciu paredaen conjectur gener polynomialspac fragment powerset algebra power nest relat algebra without powerset conjectur confirm monad databas schema vdb first sight oper add nest relat algebra enumer solut equa tion seem differ powerset oper oper perform kind potenti exponenti enumer yet point analogu suciuparedaen conjectur hold spars fragment equat alg bra specif use spars equat express transit closur fact express fixpoint queri complement result abiteboul hillebrand ah95 show transit closur becom fragment make sens express alway produc result logarithm size appli exponenti powerset oper express produc result polynomi size express powerset algebra polynomi space provid use clever pipelin evalu strategi actual everi fixpoint queri alreadi express use equat spars even unambigu uniqu solut databas unambigu equat relat algebra known implicit definit firstord logic studi context finit model theori kolaiti kol90 kolaiti alreadi show everi fixpoint queri implicitli defin offer straightforward direct proof anoth exampl given wellknown nest oper nest relat alg bra oper becom redund extend algebra solut oper powerset oper ever origin nest oper never blow exponenti show without use nest oper nest express equat algebra use spars equat possibl polynomialspac powerset algebra express howev also similar two fragment specif prove analogu suciuparedaen result effect pariti queri express spars fragment equat algebra either main technic contri bution proof involv eleg argu ment style liebeck lie83 invok bochert theorem order primit permut group paper organ follow section 2 recal nest relat data model section 3 introduc relat algebra equa tion section 4 introduc equat al gebra section 5 introduc spars equat well natur evalu strategi equat algebra express section 6 studi time complex spars equat fi nalli section 7 present comparison polynomialspac powerset algebra appendix addit detail complement main bodi paper preliminari quickli recal nest relat data model algebra tf86 ahv95 relat type defin follow type set atom valu relat type induct defin follow relat type 0 element serv mere base case duction relat type set ktupl relat type databas schema finit set relat name relat name associ type differ 0 databas b consist nonempti finit domain atom valu togeth relat name r relat r b type type r oper nest relat algebra standard relat algebra union differ gamma relat type cartesian product theta project select oe equal plu oper nest unnest defin follow let r relat type kg nest r equal relat ni x type let r let 6 0 form unnest r equal relat type express nest relat algebra schema built use oper relat name symbol stand finit domain input databas relat express e evalu databas b denot eb one extend nest relat algebra powerset algebra ad powerset oper defin follow let r relat type powerset pir equal relat fs j rg type equat let x disjoint databas schema actual databas schema x thought set addit relat variabl let e 1 e 2 two express expand defin definit 31 given databas b solut equat e databas x finit domain b e 1 b b denot expans b ie databas x finit domain b equal b equal x exampl 32 simpl exampl let type r x equa tion given databas b databas fxg solut x r b anoth exampl let x relat variabl type 0 0 one write relat algebra express e databas fxg finit domain ea empti x onetoon project disjoint union equal equat solut databas b finit domain cardin even technic equat symbol express easili take stand arbitrari express alway evalu empti relat remark 33 exampl use equat special form e actual form special equat brought form stand altern one might wonder use disequ form e 6 noth equat disguis also written 1 theta convers equat e also written disequ theta e 1 delta 4 equat algebra readi extend nest relat algebra solut oper equa tion refer result algebra equat algebra allow eleg definit fix schema advanc rather assum suffici larg suppli relat name possibl type relat name occur express like logic formu la occur free other occur bound relat name bound solut equat serv variabl equat within equat howev still free denot set relat name occur free equat algebra express e freee construct nest relat al gebra straightforward relat name r freer frg express e form e 1 freee freee 1 freee 2 express e form oee 0 freee freee 0 express freed definit new solut oper follow definit 41 let e 1 e 2 express let sequenc distinct relat name also express defin free set g say note recurs definit sens e 1 e 2 contain solut oper turn avoid clutter disallow equat algebra express free relat name time becom bound subexpress x theta fx express e equat algebra evalu databas b schema contain freee alreadi know evalu defin construct nest relat algebra defin definit 42 solut express e form fx databas b evalu eb equal lation databas fx solut relat type type x exampl 43 recal simpl exampl equat 32 turn equat follow equat algebra express e frg databas b frg relat eb equal pir b recal powerset oper pi section 2 word equat algebra express e equival powerset algebra express pir equat algebra allow equat use insid equat exampl want comput powerset powerset r write third exampl let r relat name binari type one write relat algebra express e tc databas c fr tg e tc empti r c c c transit close one also write nest relat algebra express e min select set binari relat minim one wrt set inclus follow equat algebra express comput transit closur relat r exampl saw powerset oper express equat alg bra convers solut oper easili express powerset algebra henc proposit 44 equat algebra equival powerset algebra 5 spars equat far equat algebra mere anoth syntax powerset algebra want higherord logic howev consid natur evalu strategi equat algebra express start notic differ natur strategi evalu solut express form fx mean follow enumer databas fx g finit domain given input databas one one reus space test whether solut recurs evalu e 1 e 2 includ result construct nest relat al gebra natur evalu strategi clear evalu express form creat two intermedi result recurs evalu e 1 appli theta two intermedi result similarli evalu express form e 2 f oe g creat intermedi result recurs evalu e appli intermedi result view natur evalu strategi defin definit 51 equat call spars relat variabl flat type ie type form number solut given databas polynomi size databas exampl 52 two equat exampl 32 spars probabl simplest exampl nontrivi spars equat follow let x relat name type 0 one write relat algebra express e fxg databas fxg ea empti x singleton equat taken relat variabl solv spars inde given databas b finit domain solut precis singleton subset clearli linear thu polynomi number possibl solut remark 53 one may wonder whether notion sparsiti would chang definit 51 would look databas schema consist relat name actual occur free equat answer easili seen neg spars equat connect natur evalu strategi follow way proposit 54 natur strategi evalu equat algebra express e run polynomi space equat occur e spars count space occupi intermedi result store eval uation also size final result ifdirect proposit clear onlyif direct proven appendix 6 time complex equat nonempti time complex solv spars equat close link open question comput complex theori unlik previou section section talk natur evalu strategi whose time complex clearli least exponenti soon equat solv instead look time complex nonempti problem equa tion nonempti problem equat schema relat variabl x problem decid given databas whether equat solut databas present section consid equat contain equat insid let us begin consid equat necessarili spars still flat variabl nonempti problem flatvari equat clearli np suppos moreov databas schema also flat sx expans relat variabl equat entir flat schema cours equat still gener nest relat algebra ie e 1 e 2 contain oper result paredaen howev impli nest relat algebra condit e also express form e 6 e flat relat algebra express nonempti problem equat thu amount ask whether fx given databas b equival ask whether existenti secondord logic sentenc true b e firstord logic sentenc express e 6 moreov equival relat algebra firstord logic 9so properti obtain way fa gin theorem fag74 ef95 state 9so captur exactli np properti flat relat databas henc class nonempti problem flatvari equat flat databas schema exactli class np properti flat relat databas necessarili flat next show still get exactli np essenc extens fagin theorem nest relat databas proposit 61 everi properti nest relat databas fix schema np close isomorph correspond nonempti problem flatvari equat crux proof proposit given appendix represent nest relat databas pseudoflat one also use gyssen suciu van gucht gsvg95 readi turn spars equat nonempti problem actual complex class fewp all86 consist problem decid polynomialtim nondeterminist ture machin polynomi mani accept comput input clearli strict inclus remain open obviou question ask whether proposit 61 remain true focu spars equat replac np fewp answer easi ye must restrict attent order databas databas includ total order finit domain one relat deed usual proof fagin theorem yield fewp version theorem restrict order databas free flat databas gener nest relat databas use represent techniqu proof proposit 61 corollari get corollari 62 exist spars equat whose nonempti problem npcomplet 7 spars equat versu spars powerset express natur call equat algebra express spars equat occur spars cf proposit 54 inspir proposit also defin sparsiti condit powerset algebra express call powerset algebra express spars natur evalu strategi defin obviou way run polynomi space remark 71 use standard techniqu one show sparsiti undecid equat algebra express wel powerset algebra express relat question also typic undecid exampl test whether given express equival spars one suciu paredaen sp97 show transit closur flat binari relat express spars powerset express exampl 43 gave obviou equat algebra express transit closur express spars better proposit 72 transit closur flat relat express spars equat algebra express proof given binari relat r natur number n 1 defin relat r n classic composit oper binari relat ffi defin r n r jrj equal transit closur r n jrj r n consid follow 6ari relat run run r theta r i1 theta r i1 appendix show equat whose solut given r run prove proposit unnest solut set project middl two column get transit closur except run empti case transit closur r r also easili test nest relat algebra remark 73 equat construct proof spars unam biguou uniqu solut input databas moreov proof work gener fixpoint queri ahv95 flat databas difficulti fixpoint queri start empti relat proof proposit 72 start r easili dealt alreadi explain introduct thu basic rediscov earlier result kolaiti effect everi fixpoint queri implicitli defin firstord logic kol90 note direct proof straightforwardli specifi run fixpoint comput unambigu way origin proof also present ebbinghau flum ef95 bit roundabout specifi stage comparison relat instead anoth perhap bit frivol exampl queri express use spars equat use spars powerset express nest oper easi express powerset algebra use powerset oper oper self primit powerset al gebra consequ proposit 44 primit equat algebra either next observ restrict spars express nest remain imprimit equat algebra becom primit powerset algebra proposit 74 nest express spars powerset express without use oper proof proposit given appendix standard argument finit model theori involv quantifi elimin monad structur proposit 75 nest express spars equat express without use oper proof let r relat name type 0 0 let x relat variabl type 0 write relat algebra express e databas c fr xy g ec empti x singleton fxg x rg henc express spars equat express equival construct gener nest oper analog final main technic contribut concern pariti queri suciu paredaen show pariti cardin finit set express spars powerset express show analogu equat algebra proposit 76 pariti queri express spars equat express proof suppos contrari spars equat express express pariti cardin finit domain may assum input schema empti ie input databas consist noth els consid innermost equat occur express section 6 written form fx e flat relat algebra express flat schema fx g let solut given input size n everi permut f fa also solut number differ precis njautaj auta group automorph sinc equat suppos spars number n fix equival put suffici larg n thu need know larg permut group follow crucial lemma prove appendix give us inform need group permut finit set denot symd altern subgroup even permut altd g subgroup symd fix set g subset delta everi map delta delta action g fix set delta subgroup symdelta denot g delta lemma 77 let k fix natur number let g subgroup symd suffici larg jgj n gamma k impli exist fix set delta g delta contain altdelta invok lemma get fix set delta size n gamma k even permut delta extend automorph let x one relat variabl equat ariti say r consid rtupl whose compon either gamma delta let r 0 number compon symbol let equal type r 0 tupl denot neighbor set r 0 tupl delta equal type replac compon compon r 0 tupl left right get tupl x follow claim proven appendix 78 neighbor either empti consist r 0 tupl delta equal type call rari pattern neighbor nonempti thu full say pattern instanti x note also extrem case consist exclus star star also allow make sens thu see solut gener follow nondeterminist procedur 1 initi relat empti 2 choos k differ element play role element outsid delta 3 everi relat variabl x ariti r say run rari pattern nondeterminist instanti x fix number possibl pattern also fix henc write express nest relat algebra given construct set possibl output nondeterminist procedur set superset solut set equat select solut use nest relat algebra also easi matter henc get rid innermost equa tion repeat process get rid equat end left standard nest relat algebra express pariti queri well known imposs ahv95 acknowledg indebt laszlo babai point us liebeck paper r space usag function queri lan guag foundat databas complex spars set p gener comput complex finit model theori gener firstord spectra polynomialtim recogniz set restrict bound fixpoint closur nest relat algebra equival tractabl queri languag complex object databas implicit defin finit structur unambigu comput graph whose full automorph group altern group finit classic group convert nest algebra express flat algebra express complex evalu complex algebra express nest relat structur finit permut group tr