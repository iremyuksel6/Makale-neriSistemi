approxim invers techniqu blockpartit matric paper propos precondit option system matrix blockpartit form form may aris natur exampl incompress navierstok equat may impos domain decomposit reorder approxim invers techniqu use gener spars approxim solut whenev need form precondition storag requir precondition may much less incomplet lu factor ilu precondition tough largescal comput fluid dynam cfd problem numer experi show precondition help solv difficult linear system whose coeffici matric highli indefinit b introduct consid block partit matrix form 1 block natur occur due order equat variabl matric form aris mani applic incompress navierstok equat scalar momentum equat continu condit form separ block equat 2d case system form b pc b f u f pc 2 u v repres veloc compon p repres pressur b submatrix convectiondiffus oper f submatric pressur gradient oper e submatric veloc diverg oper tradit techniqu uzawa algorithm use problem often linear system must solv much smaller zero small valu diagon fullycoupl system socal segreg approach howev suffer slow converg rate compar aggreg fullycoupl solut techniqu anoth sourc partit matric form 1 class domain decomposit method method interior node subdomain order consecut subdomain subdomain follow interfac node order end order unknown give rise matric follow structur 0 typic linear system associ b matrix produc reorder easi solv result restrict origin pde problem set independ similar pde problem much smaller mesh one motiv approach parallel approach ultim requir solut method schur complement danger howev gener matric b may singular reorder much work done exploit form block conjunct precondit one earlier paper subject concu golub meurant introduc idea block precondit design blocktridiagon matric whose diagon block tridiagon invers tridiagon matric encount approxim approxim tridiagon matric exploit exact formula invers tridiagon matrix later extend gener case diagon block arbitrari 4 17 mani case incomplet block factor develop matric aris discret pde 2 3 7 17 19 util approxim invers diagon block need invert recent elman silvest 13 propos techniqu specif case stoke navierstok problem number variat block precondition also develop 1 9 techniqu offblock diagon term either neglect attempt made approxim effect paper explor precondit option matrix express blockpartit form either natur domain decomposit type order iter method act fullycoupl system precondit similar segreg method approach requir precondit approxim solv submatric submatric correspond combin oper reaction diffus convect particularli advantag use blockpartit form know enough submatric appli special precondition exampl operatorsplit semidiscret well lowerord discret blockpartit techniqu also requir spars approxim solut spars linear system solut need spars form row column precondition use comput dens solut caus construct applic precondition expens problem ideal suit spars approxim invers techniqu approxim solut spars system found use iter method implement spars matrixspars vector spars vectorspars vector oper intermedi final solut forc spars numer drop element x small magnitud righthand side b initi guess x spars econom method comput spars approxim solut use techniqu construct precondition base approxim invers directli 6 paper organ follow section 2 describ spars approxim invers algorithm techniqu find spars approxim solut schur complement section 3 describ blockpartit factor may use precondition effect approxim block lu factor approxim block gaussseidel precondition section 4 report result sever numer experi includ perform new precondition problem aris incompress navierstok equat spars approxim invers use common develop precondition base block techniqu face need comput approxim invers spars matrix approxim column f b f spars particularli case block precondition blocktridiagon matric 7 19 algorithm practic must provid approxim spars number techniqu recent develop construct spars approxim invers matrix use precondition 5 6 8 10 15 17 18 mani techniqu approxim row column independ focus columnori case individu minim e j jth column ident matrix precondition distinctli easier exist precondition construct appli massiv parallel comput reli matrix factor precondition often complementari ilu precondition 6 22 previou approach select sparsiti pattern x minim 4 least squar sens approach minim 4 method reduc residu norm step minim residu fgmre 20 begin spars initi guess sparsiti preserv drop element search direct current solut step base magnitud criteria relat residu norm reduct final number nonzero column guarante paramet lfil case fgmre krylov basi also kept spars drop small element keep iter econom comput perform spars matrixspars vector spars vectorspars vector oper applic point approxim invers techniqu column may gener find spars approxim solut spars linear problem minim possibl exist precondition 21 approxim invers algorithm describ modif techniqu report 6 guarante reduct residu norm minim residu step start spars initi guess fillin increas one iter end iter possibl use second stage exchang entri solut new entri caus reduct residu norm without second stage entri solut annihil introduc problem paper howev second stage necessari first stage search direct deriv drop entri residu direct r sparsiti pattern solut x control chosen sparsiti pattern x plu one new entri largest entri absolut valu minim perform choos steplength ad ad thu residu norm new solut guarante previou residu norm solut residu updat end stage indefinit normal equat residu direct r may use search direct simpli determin locat new fillin interest note largest entri r give greatest residu norm reduct onedimension minim explain transpos initi guess approxim invers combin selfprecondit precondit r current approxim invers effect problem 6 mani possibl second stage choos drop one entri x introduc one new entri caus decreas residu norm candid drop smallest absolut nonzero entri x candid ad largest absolut entri previou search direct begin stage 1 alreadi includ previou direct use candid may determin stage 1 addit search requir steplength fi chosen minim new residu norm e ith coordin vector x entri x drop posit fi entri ad posit l largest gener notat b righthandsid vector previous denot j let j denot jth column minim give involv one spars saxpi sinc b gamma ax alreadi avail r one spars dotproduct sinc may scale column unit 2norm guarante 6 l sinc l chosen among entri includ precondit version algorithm minim kb gamma axk 2 explicit precondition may summar follow assum scale column unit 2norm number inner iter usual chosen lfil somewhat larger algorithm 21 approxim invers algorithm 1 start initi guess x r b gamma ax 2 3 mr 4 choos pattern x one entri largest remain entri absolut valu 5 q ad 6 ff rq 7 r r gamma ffq 8 x 9 index smallest nonzero absx 10 l index largest nonzero abst gamma 11 fi r 12 r r 13 krk krk 14 set x 0 x l fi 15 r r 16 end 17 end 22 spars solut schur complement spars approxim solut schur complement often requir precondit blockpartit matric briefli describ three approach section 1 approxim 2 approxim gamma1 3 exploit partial approxim invers 221 approxim approxim spars matrix use comput approxim invers techniqu possibl precondit whatev use solv b sinc spars comput way also spars moreov sinc usual rel dens solv econom approach typic zero initi guess use remark usual expens form solv b approxim drop small element sinc rather costli search element drop also note gener columnbycolumn necessari comput factor columnbycolumn basi well linear system solv fashion includ iter process without precondit 222 approxim gamma1 anoth method comput approxim gamma1 use idea induc pre condit 22 block gamma comput spars approxim use approxim invers techniqu appli last blockcolumn throw away upper block practic upper part column may discard comput next column experi sinc approxim invers algorithm appli indefinit matrix problem normal equat search direct r use algorithm scale ident initi guess invers 223 partial approxim invers drawback approach top submatrix last blockcolumn discard result approxim gamma1 may actual contain nonzero relat techniqu comput partial approxim invers last blockrow techniqu give approxim gamma1 defin simpl precondit method write invers form get approxim solut f necessari solv accur b normal equat search direct use approxim invers algorithm numer experi result rel inexpens method given section 4 blockpartit factor consid spars linear system put block form condit requir partit b nonsingular use extens follow block lu factor schur complement wellknown solv 12 solv reduc system comput backsubstitut first blockrow system 11 obtain x ie comput x block structur exploit sever differ way defin precondition thu block precondition defin section combin one precondition seen section 22 choic block factor next describ option 31 solv precondit reduc system method often use solv reduc system 14 possibl help certain precondition schur complement matrix although involv block factor discuss indirectli relat wellknown algorithm exampl uzawa method typic formul full system view richardson fix point iter appli reduc system matrix need comput explicitli instead one perform matrixvector product matrix via follow sequenc oper 1 comput 2 solv 3 comput wish use krylov subspac techniqu gmre precondit reduc system need solv system step 2 exactli ie direct solver iter solver requir high accuraci matrix coeffici matrix system solv must constant throughout gmre iter experi approach found seriou limit converg reach number step typic compar obtain method base full matrix howev step cost much unless direct solut techniqu use case initi lu factor may expens altern highli accur ilu factor employ b reduc cost mani system must solv success outer step 32 approxim block diagon precondition one simplest block precondition matrix partit 1 blockdiagon matrix mc precondit matrix c case incompress navierstok equat defin exampl interest particular case c nonsingular mc c correspond blockjacobi iter case eigenvalu squar root eigenvalu matrix c converg fast eigenvalu small 33 approxim block lu factor block factor 12 suggest use precondition base block lu factor izat precondit precondition schur complement matrix spars approxim schur complement could comput precondit matrix exampl form approxim lu factor must point precondition induc precondition discuss section 31 notabl disadvantag approach base solv reduc system 14 iter process action vector must comput accur krylov acceler part approach base larger system 11 necessari fact iter process use solv b provid use flexibl variant gmre fgmre 20 system involv b may solv mani way depend difficulti know b b known wellcondit triangular solv incomplet lu factor may suffici difficult b matric incomplet factor may use precondition inner iter process b incomplet factor unstabl see section 42 approxim invers b may use either directli precondition b oper approxim may use factor may use either directli precondition kind flexibl typic avail use iter method blockpartit matric import observ solv exactli b error block ilu factor lie entir 22 block sinc one rais question whether approach better one base solv reduc system 14 precondit known fact two approach mathemat equival start proper initi guess specif initi guess make xpart residu vector equal 0 origin system 11 ie initi guess result due eisenstat report 16 immedi follow 16 show precondit matrix particular form thu initi residu xcompon equal zero iter vector compon gmre iter system reduc gmre iter matrix gamma1 involv variabl mani possibl option choos matrix among consid follow one ffl precondit ffl precondit c matrix nonsingular altern precondit ilu factor c construct spars approxim use precondition gener need approxim action vector exampl method describ section 221 222 follow algorithm appli one precondit step get algorithm 31 approxim block lu precondit 1 x 2 3 x experi number option solv system step 2 algorithm exampl may approxim comput approxim invers techniqu approxim use possibl also use place b gamma1 f step 3 34 approxim block gaussseidel ignor u factor approxim block lu factor led form block gaussseidel precondit defin remark way solv system b way defin precondit matrix appli algorithm precondition algorithm 31 without step 3 analyz precondition start observ show differ precondit matrix 17 addit 12 posit iter associ block form associ schur complement approach gamma1 longer simpli relat howev connect 17 19 first spectra two matric ident mean howev two matric requir number iter converg gener consid gmre iter solv precondit system take initi guess form x 0 arbitrari denot precondit initi residu gmre find vector u form belong krylov subspac minim km arbitrari u affin space precondit residu form 19 becom result ks note ks repres precondit residu norm reduc system obtain approxim larg system ks impli residu bigger system less ffl residu obtain use full gmre associ precondit reduc system also less ffl observ pass second term righthandsid 21 alway reduc zero postprocess step consist forc first part residu zero chang ffi equival current pair x obtain x recomput satisfi first block equat ie postprocess step requir one addit b solv assum know someth residu vector associ step gmre appli precondit reduc system say someth residu norm associ precondit unreduc system begin establish simpl lemma lemma 31 let follow equal hold proof first easi prove multipli member equal gamma z obtain state main result concern comparison two approach theorem 31 assum reduc system 14 solv gmre use precondition start arbitrari initi guess 0 let precondit residu obtain mth step precondit residu vector r m1 obtain 1st step gmre solv block system 11 precondit matrix 18 initi guess u x 0 arbitrari satisfi inequ particular proof precondit matrix unreduc system form 22 residu vector mth gmre approxim associ reduc system form ae mth residu polynomi minim kpg 0 k 2 among polynomi p degre satisfi constraint consid polynomi degre 1 defin clear residu um1 m1st approxim solut obtain gmre algorithm solv precondit unreduc system minim pzr 0 polynomi p degre 1 consist ie therefor use equal establish lemma observ first matrix righthandsid last equal noth gamma z henc residu vector r m1 complet proof 2 also interest relat converg algorithm blockdiagon approach particular case case correspond block gaussseidel iter exploit young frankel theori 2cyclic matric compar converg rate block jacobi approach inde case 19 therefor eigenvalu matrix squar matrix associ blockjacobi precondition section 32 4 numer experi section organ follow section 41 describ test problem list method use section 42 illustr comparison purpos difficulti incomplet lu factor solv problem fullycoupl manner section 43 make comment regard domain decomposit type reorder section 44 show result new precondition simpl pde problem final section 45 46 present result new precondition realist problem aris incompress navierstok equat linear system construct solut vector one zero initi guess rightprecondit fgmre 20 restart everi 20 iter use solv system tabl show number iter requir reduc residu norm 10 gamma7 iter stop 300 matrixvector multipl reach indic dagger code written fortran 77 use mani routin sparskit 23 run singl precis cray c90 supercomput 41 test problem method first set test problem finit differ laplac equat dirichlet boundari condit three differ size grid use matric reorder use domain decomposit reorder 4 subdomain follow tabl n order matrix nnz number nonzero entri nb order b submatrix nc order c submatrix second set test matric extract exampl incompress navierstok problem fidap 14 packag problem zero c submatrix test case transient problem matric jacobian newton iter converg matric reorder continu equat grid n nnz nb nc 48 48 2209 10857 2116 93 64 3969 19593 3844 125 tabl 1 laplacian test problem order last scale mani matric poor sinc matrix contain differ type equat thu scale row unit 2norm scale column way problem origin nonsymmetr except 4 12 14 32 matrix n nnz nb nc hamel flow ex12 3973 79078 2839 1134 stoke flow surfac disturb attenu ex23 1409 42761 1008 401 fountain flow coat ex26 2163 74465 1706 457 driven thermal convect ex28 2603 77031 1853 750 two merg liquid speci deposit radiat heat transfer ex36 3079 53099 2575 504 chemic vapor deposit tabl 2 fidap exampl matric third set test problem finiteel discret squar lid driven caviti problem rectangular element use biquadrat basi function veloc linear discontinu basi function pressur show result problem reynold number 0 500 1000 matric aris mesh 20 20 element lead matric size nnz 138187 nonzero entri matric 3363 veloc unknown 1199 pressur un known matric scale way fidap matricesth problem otherwis difficult solv use follow name denot method test ilutnfil ilutpnfil incomplet lu factor threshold nfil nonzero per row l u factor precondition describ section 42 parlfil partial approxim invers precondition describ section 223 use lfil nonzero per row 2 abj approxim blockjacobi precondition describ section 32 precondition appli c 6 0 ablulfil approxim block lu factor precondition describ section 33 approxim 6 lfil nonzero per column use ablu ylfil use whenev b need appli step 3 algorithm 31 ablu slfil approxim block lu factor precondition use 7 approxim gamma1 lfil nonzero per column approxim last block column invers abgslfil approxim block gaussseidel precondition describ section 34 approxim 6 lfil nonzero per column use storag requir precondition given tabl 3 ilut precondition describ next subsect requir consider storag approxim blockpartit factor sinc storag depend n rather nc approxim gamma1 discard upper block storag less lfil thetan c storag requir difficult estim sinc least product two spars matric gener less 2 theta lfil theta nc tabl 11 section 45 give exact number nonzero fidap problem 42 ilu fullycoupl system wish compar new precondition gener experi enc one effect generalpurpos precondition solv fullycoupl system particular show result ilut dualthreshold incomplet lu factor precondition base droptoler maximum number new fillin element allow per row l u factor latter threshold allow storag precondition known beforehand droptoler ilu rather levelfil ilu often effect indefinit problem numer valu play much import role variant perform column pivot call ilutp even suitabl highli indefinit problem matric matrix locat abj none none less 2 theta lfil theta nc ablu ylfil lfil theta nc less 2 theta lfil theta nc tabl 3 storag requir precondition use small modif found often perform better rare wors matric wide rang number element per row column aris variou reason includ fact matrix contain discret differ equat instead count number new fillin keep nonzero row l u fix nfil regardless number origin nonzero row also found better perform keep nfil constant rather increas decreas factor progress highli indefinit larg nonsymmetr part ilu factor often produc unstabl l u factor ie klu gamma1 k extrem larg caus long recurr forward backward triangular solv 11 illustr point comput number factor rough lower bound e vector one fidap exampl matrix ex07 model natur convect order 1633 46626 nonzero see tabl 4 norm bound increas dramat nfil decreas incomplet factor gmre could solv linear system factor precondition matrix chose strike exampl solv without precondit log tabl 4 estim klu gamma1 k1 ilut factor ex07 illustr difficulti solv fidap problem ilutp progress allow fillin problem could solv increment nfil multipl 10 drop toler result shown tabl 5 type prob lem typic larg amount fillin must use factor success iter solut attempt lu condit lower bound greater 10 zero pivot must use ilut ilutp attempt complet factor use small valu proport norm row matric taken origin band order degre freedom node element number togeth discuss next subsect type order low bandwidth often essenti ilutyp preconditioningmani problem includ solv otherwis matrix nfil ex06 50 tabl 5 nfil requir solv fidap problem ilutp note ilutp occasion wors ilut allevi somewhat use low valu mbloc paramet ilutp determin far search pivot summari indefinit problem aris incompress navierstok equat may tough ilutyp precondition 43 domain decomposit reorder consider graph partition subdivid domain number piec use give domain decomposit reorder describ section 1 techniqu impos blockpartit structur matrix adapt parallel process sinc b blockdiagon matrix techniqu also use b highli indefinit produc unstabl lu factor limit size factor instabl grow beyond point factor use gener nonsymmetr matric partition may appli symmetr graph tabl 6 show result ilut40 driven caviti problem differ matrix reorder use origin unblock order degre freedom element order togeth block order continu equat order last domain decomposit reorder found use simpl automat recurs dissect procedur four subdomain latter order found node intern subdomain 882 interfac node unblock block dd order 1000 78 51 tabl effect order ilut caviti problem poorer qualiti incomplet factor driven caviti problem blockpartit form due poor order rather instabl l u factor fact zero pivot encount problem reynold number 0 unblock format produc 745187 nonzero strictli lowertriangular part incomplet factor drop less ntheta nonzero blockpartit format produc 2195688 nonzero almost three time factor domain decomposit reorder matric encount mani zero pivot reach 22 block latter order necessarili caus ilut fillin zero diagon nevertheless substitut small pivot describ seem effect domain decomposit reorder also reduc amount fillin shape matrix downward point arrow combin tendenc limit growth instabl result show reorder advantag even serial comput tabl 7 compar difficulti solv b subsystem block domain decomposit reorder driven caviti problem comput comput use approxim invers techniqu lfil 30 use ilut30 solv linear system toler 10 gamma5 solv submatric blockpartit precondition usual need much less accur experi follow use unprecondit iter toler 10 gamma1 100 matrixvector multipl solv b method would necessari depend difficulti problem tabl give idea difficult solv b show advantag use domain decomposit reorder hard problem block dd order 1000 7 tabl 7 solv b differ order 44 test result laplacian problem tabl 8 9 present result laplacian problem three differ grid size use precondit approxim block diagon partial approxim invers approxim block lu approxim block gaussseidel precondition note tabl 9 lfil zero approxim block lu gaussseidel precondition respect indic precondition grid nopr abj par 48 48 367 50 29 21 19 17 64 532 57 36 33 25 20 tabl 8 test result laplacian problem grid ablu abg 48 48 17 64 19 20 tabl 9 test result laplacian problem 45 test result fidap problem blockpartit factor precondition unprecondit gmre restart everi 20 iter use approxim solv inner system involv b reduc initi residu norm factor 01 use 100 matrixvector multipl solv matrix b usual difficult problem posit definit zero initi guess solv use result number precondition variou option shown tabl 10 best precondition appear ablu use b gamma1 f better solv system b inaccur number nonzero small illustr tabl 11 two valu lfil matrix tabl 10 test result fidap problem 46 test result driven caviti problem driven caviti problem much challeng b block longer posit definit fact acquir larger larger neg eigenvalu reynold number increas problem unprecondit gmre iter b done toler 10 gamma3 maximum 100 matrixvector multipl ablu appear best precondition result shown tabl lfil ex26 13395 21468 ex36 13621 21063 tabl 11 number nonzero ablu ablu abg 1000 164 118 tabl 12 test result driven caviti problem conclus present precondition defin combin two ingredi 1 spars approxim invers techniqu obtain precondition schur complement part invers 2 block factor full sy tem schur complement appear block factor approxim precondition approxim invers techniqu 6 use differ way approxim either directli part gamma1 seen compar tabl 5 10 solv problem block approach standard ilu factor addit typic achiev far smaller memori requir ilut direct solver better robust method due fact solv perform small matric effect implicitli use power divideandconqu strategi characterist domain decomposit method smaller matric obtain block partit precondit standard ilut approach larger matric use blockilu glue two precondit schur complement acknowledg author wish acknowledg support minnesota supercomput institut provid comput facil excel environ conduct research r incomplet block matrix factor precondit method iter solut method approxim factor method block matric suitabl vector parallel processor iter solut larg spars linear system aris certain multidimension approxim problem approxim invers precondition gener spars matri ce block precondit conjug gradient method approxim invers precondit spars linear system paralleliz block diagon precondition compress navierstok equat new approach parallel precondit spars approxim invers stabil analysi incomplet lu factor multigrid krylov subspac method discret stoke equa tion fast nonsymmetr iter precondit navierstok equat fidap exampl manual parallel precondit approxim invers connect machin comparison domain decomposit techniqu ellipt partial differenti equat parallel implement famili twolevel precondit incomplet block factor type factor spars approxim invers precon dition incomplet block factor precondition spars spd matric flexibl innerout precondit gmre algorithm ilut dual threshold incomplet lu factor precondit krylov subspac method cfd applic sparskit basic tool kit spars matrix comput tr ctr n guessou souhar multilevel block ilu precondition spars nonsymmetr mmatric journal comput appli mathemat v162 n1 p231246 1 januari 2004 kai wang jun zhang multigrid treatment robust enhanc factor spars approxim invers precondit appli numer mathemat v43 n4 p483500 decemb 2002 prasanth b nair arindam choudhuri andi j kean greedi learn algorithm spars regress classif mercer kernel journal machin learn research 3 312003 edmond chow michael heroux objectori framework block precondit acm transact mathemat softwar tom v24 n2 p159183 june 1998 howard c elman victoria e howl john n shadid ray tuminaro parallel block multilevel precondition 3d incompress navierstok equat journal comput physic v187 n2 p504523 20 may michel benzi precondit techniqu larg linear system survey journal comput physic v182 n2 p418477 novemb 2002