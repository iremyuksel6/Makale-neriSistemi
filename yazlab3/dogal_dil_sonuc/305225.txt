jacobidavidson style qr qz algorithm reduct matrix pencil recent jacobidavidson subspac iter method introduc new power techniqu solv varieti eigenproblem paper exploit method enhanc sever techniqu practic accur algorithm obtain present two algorithm jdqz gener eigenproblem jdqr standard eigenproblem base iter construct gener partial schur form algorithm suitabl effici comput sever even multipl eigenvalu correspond eigenvector near userspecifi target valu complex plane attract properti algorithm explicit invers oper avoid make potenti attract larg spars matrix problemsw show effect restart incorpor jacobidavidson method similar implicit restart procedur arnoldi process discuss use precondit final illustr behavior algorithm number wellchosen numer experi b introduct paper expand usag jacobidavidson method 26 24 comput sever solut gener eigenproblem 1 b larg spars n nmatric may complex andor nonnorm also discuss standard eigenproblem 2 cours gener eigenproblem reduc standard eigen problem could restrict gener eigenproblem case howev simplif possibl help reduc memori requir comput complex phenomena easier explain algorithm base jacobidavidson method describ 26 adapt gener eigenproblem polynomi eigenproblem 24 modifi jacobidavidson approach partial gener ize schur form comput partial schur form chosen mainli receiv editor march 4 1996 accept public revis form march 5 1997 publish electron august 7 1998 httpwwwsiamorgjournalssisc20130007html depart mathemat utrecht univers po box 80010 nl3508 utrecht netherland sleijpenmathruunl vorstmathruunl current address ise integr system engin ag technopark zurich technopark strass 1 ch8005 zurich switzerland fokkemaisech 1 famili b call matrix pencil gener eigenvalu solut 1 also call eigenvalu matrix pencil cf eg 30 numer stabil sinc involv orthogon base base also use deflat anoth ingredi algorithm jacobidavidson approach lowdimension search subspac gener onto given eigenproblem project standard rayleigh ritz procedur also underli lanczo arnoldi davidson method small project eigenproblem solv standard techniqu lead approxim want eigenvector eigenvalu given larg problem davidson method 5 solut simplifi correct equat use expans search subspac follow old idea jacobi 11 also set correct equat act subspac orthogon current eigenvector approxim defin optim orthogon expans search subspac precis exact valu eigenvalu known correct equat defin exact eigenvector modif davidson method refer jacobidavidson method note noth diagon precondit popular combin davidson method jacobi correct equat may solv method choic larg problem often ecient solv equat approxim iter method speed converg iter method may improv precondit place precondit exploit jacobidavidson method note precondit aect given eigenproblem includ shift jacobidavidson method proper select approxim eigenpair correct equat process tailor find eigenpair close given target valu detail given section 22 3 small project problem reduc gener schur form qz method 15 qr 8 construct subspac project system may view iter inexact form qz qr reason name new method jdqz jdqr respect jdqz produc partial gener schur form gener eigenproblem partial qzdecomposit jdqr gener partial schur form standard eigen problem partial qrdecomposit restart form essenti ingredi almost iter method also jacobidavidson method either comput eigenpair one eigenpair converg limit dimens subspac memori limit case usual restart procedur disadvantag subspac may contain use inform replac one singl vector much valuabl inform may lost problem solv elegantli arnoldi method 28 see also 17 approach cf section 23 relat see also 26 section 53 approach subspac suitabl filter retain much relev inform possibl expans filter use repetit way gener eigenproblem section 2 form heart paper shown implicit restart techniqu precondit use order get inversefre comput ecient algorithm result algorithm jdqz enhanc deflat techniqu sever solut eigenproblem comput comput interior eigenvalu normal riski aair want avoid shiftandinvert oper discuss rather robust techniqu base idea harmon ritz valu 16 19 26 r fokkema g l g sleijpen h van der vorst section 3 focus standard eigenproblem cours standard eigenproblem view simplif gener eigenproblem obviou way jdqz simplifi jdqr method standard eigenproblem howev chosen pay slightli attent standard eigenproblem sinc simplif make easier discuss comput aspect algorithm particular consid problem precondit detail ponder observ speed converg use wellknown argument section 4 illustr converg behavior jdqz jdqr numer experi number eigenproblem aspect investig concern among other eect approxim error solut correct equat section 41 eect precondit section 42 multipl eigenvalu section 46 interior eigenvalu section 43 47 dierent approach construct project deflat problem section 43 47 implicit versu explicit deflat section 45 section 5 collect conclus remark 1 comput done complex arithmet necessari altern real matric would use quasischur form 2 2 block diagon comput real arithmet real matric possibl deriv variant jacobidavidson base block form discuss altern variant remark 2 boldfac letter indic variabl associ larg ndimension space lowdimension space use ital letter use tild indic quantiti approxim correspond quantiti without tild q approxim q etc algorithm given matlab style use matlab convent refer entri matric vector particular algorithm new valu overwrit old one tild delet 2 gener eigenproblem 21 preliminari convent 1 denot gener eigenvalu matrix pair b pair approach prefer underflow overflow finit precis arithmet may occur andor zero close zero case pair still mean use 15 21 30 chvi remark 3 observ 0 pair correspond gener eigenvalu rather scale coecient algorithm instanc 0 1 follow advis 15 show result produc qz algorithm size may give valuabl inform condit comput eigenpair howev construct algorithm choic paramet lead implicit scale gener eigenproblem partial gener schur form defin follow definit 1 partial gener schur form dimens k matrix pair b decomposit orthogon nkmatric k k upper triangular kmatric column q q k refer gener schur vector jacobidavidson style qr 97 refer pair q k k gener schur formul 3 equival furthermor x gener eigenpair k k q k x gener eigenpair b 22 jacobidavidson briefli describ jacobidavidson gener eigenproblem 1 detail refer 24 similar subspac approach standard eigenproblem step approxim eigenvector q select search subspac spanv galerkin condit associ approxim gener eigenvalu requir orthogon respect test subspac spanw gener case view 3 4 natur take test subspac spanw dierent search subspac petrovgalerkin approach search subspac test subspac dimens say j equat 5 lead project eigenproblem solv convent techniqu solut u select note 6 jdimension problem petrov vector residu r q associ petrov valu comput subspac spanv spanw expand step iter process variant jacobi davidson method use paper search subspac expand vector v orthogon q solv approxim jacobi correct equat z essenti dierenc davidson approach inclus left right orthogon project correct equat shown nonzero z spana q b q 7 solv exactli converg gener eigenvalu quadrat see 24 th 32 next iter algorithm spanv v defin new search subspac explain expand w appropri sinc prefer orthogon matric v w similar z q 3 new column v w orthonorm modifi gramschmidt stabl variant gram schmidt use qz algorithm 15 reduc 6 gener schur form j dimens spanv algorithm yield orthogon j jmatric u r u l upper triangular j jmatric b decomposit reorder first column u r 1 1 entri b repres want petrov solut 6 33 34 7 matlab version reorder algorithm see 7 ch 6c r fokkema g l g sleijpen h van der vorst decomposit 8 construct approxim partial gener schur form cf 3 vu r approxim q k wu l approxim associ z k sinc spanz k make sens choos w scalar 0 0 say 0 space spanw coincid span choic also line restrict z quadrat converg summari propos method follow main ingredi form project system 6 reduc order gener schur form 8 select approxim gener eigenpair vu r 1 1 1 b 1 1 form jacobi correct equat b q normal constant choic 0 0 discuss later section 24 comput approxim solut v q 9 note vur 1 normal expand v orthonorm complement v w orthonorm complement w modifi gramschmidt use comput orthonorm complement shown choic z w approach relat partial gener schur form larg problem complet gener schur form small problem 6 via right vector similar relat via left vector fact also conveni restart purpos see section 23 converg expand partial schur form converg schur vector repeat algorithm deflat pencil eigenpair detail deflat see section 25 23 practic select implicit restart reduc project eigenproblem 6 gener schur form qz algorithm 15 exploit gener schur form variou purpos select petrov pair q select correspond left vector z cf 12 restrict dimens subspac spanv spanw necessari deflat converg petrov pair explain first third point detail section jacobidavidson style qr 99 suppos gener schur form pencil given order respect j dimens spanv vu r 1 1 1 b 1 1 petrov approxim correspond project system 6 petrov valu closest target correspond left vector given furthermor vu r span subspac contain promis petrov vector correspond test subspac given wu l therefor want reduc dimens subspac implicit restart j min j min j simpli discard column v j min1 v j w j min1 w j continu jacobidavidson algorithm cf 26 section 53 remark 4 restart strategi follow similar idea implicitli restart arnoldi ira 28 howev 28 implicit shift use delet unwant part instead explicitli select want portion krylov subspac situat ira complic reduc search subspac krylov subspac detail see 28 13 24 valu 0 0 explain select scalar 0 0 10 restrict 0 scale avoid trivial expans discuss two approach first one section 241 view gener approach ritz valu standard eigenproblem optim expans test subspac second one section 242 relat approach harmon ritz valu aim optim select petrov pair 241 fix valu 0 0 v expans vector search subspac gener set expand test subspac 0 av 0 bv note q new approxim eigenvector expand old search subspac v equival expand q new test subspac also obtain expand 0 q obviou choic would obviou choic would case although b q direct q close eigenvector q multipl b may diminish import eigenvector compon q eigenvalu b associ q small therefor expand test space b q may much less optim expand q presenc round error eect may even promin 100 r fokkema g l g sleijpen h van der vorst valu function maxim denot complex conjug approach seen attempt expand test subspac spanw optim direct z z normal vector aq bq sinc choos 0 0 know gener eigenvalu best particular initi phase process select 0 target valu approach choic scalar made adapt see 7 ch 6 section 31 practic seen much advantag approach compar approach discuss section 242 242 valu 0 0 base harmon petrov valu section introduc harmon petrov valu see harmon petrov valu closest target consid extrem ritz valu specif test subspac also target interior spectrum particular comput interior eigenvalu harmon petrov valu appear attract competitor standard petrov valu approach section 241 gener eigenproblem cost comput harmon petrov valu standard petrov valu extrem properti harmon petrov valu closest target appear best choic also earli stage process line observ standard eigenproblem made 16 26 first consid comput eigenvalu standard eigenproblem close target valu interior convex hull spectrum transform 1 map eigenvalu extrem eigenvalu case correct eigenpair approxim obtain easili howev want avoid matrix invers formula manipul shown achiev take search subspac test subspac equal spana iv cf 26 section 51 result eigenvalu approxim solut solut call harmon ritz valu respect cf 19 26 also use 16 vu associ harmon ritz vector sinc w w 1 span space harmon ritz valu appear petrov valu test subspac gener 11 0 jacobidavidson style qr 101 gener problem 0 0 17 petrov valu closest target valu correspond absolut largest ritz valu standard eigenproblem matrix therefor gener case also better select appropri eigenpair approxim may expect refer petrov valu associ choic test subspac harmon petrov valu 25 expans schur form deflat section focu ecient comput set gener eigenpair idea use jacobidavidson method comput partial gener schur form major step solv gener eigenproblem suppos partial gener schur form aq bq want expand partial gener schur form suitabl q z deduc gener schur pair q satisfi lead henc q satisfi gener schur pair q therefor also eigenpair deflat matrix pair jdqz solv eigenproblem jacobidavidson method detail procedur follow let v w orthogon n j matric v q denot gener schur form matrix pair b 2 note jacobi correct equat 7 similar structur deriv similar way r fokkema g l g sleijpen h van der vorst gener schur form order respect target valu vu r 1 1 1 b 1 1 petrov pair approxim solut 20 correspond left vector given jacobidavidson method expand v orthogon complement v approxim solut gener deflat jacobi correct equat q note q also expand w expand complement z k1 z q orthogon respect w gener schur pair q sucient close q may continu still anoth gener schur pair case v w replac vu r order obtain new search subspac orthogon spanq k1 q new test subspac orthogon spanz k1 respect continu process 26 solut deflat correct equat section discuss gener deflat jacobi correct equat solv precondit involv correct equat 20 involv oper domain imag space dier mean krylov subspac method appli right away fortun fix easili incorpor precondit precondit correct equat 20 propos use precondition k b introduc follow notat notat 1 q matrix q k1 expand z matrix z k1 expand z k expand matrix precondit vector k project precondition z k notat left precondit correct equat gener correct equat 24 written section 32 give detail simpler standard eigenproblem jacobidavidson style qr 103 cours right precondit gener correct equat deriv well v note oper precondit correct equat 26 domain imag space coincid krylov subspac method use pseudocod precondit jacobidavidson qz algorithm harmon petrov valu discuss section 242 given algorithm 1 tabl 1 list main comput ingredi per iter jdqz tabl comput cost jdqz per iter integ j k denot dimens spanv spanq respect part dot axpi mv k correct equat variabl cost project problem 6j petrov approxim 2k krylov subspac method use solv correct equat product av bv often alreadi avail side product mv need part b instead comput residu r bq r may also comput algorithm 1 depend number nonzero b valu j may ecient 3 jacobidavidson standard eigenproblem jdqz algorithm simplifi greatli use improv comput ecienc also consid situat order discuss specif aspect precondit note simplif lead memori ecient algorithm give work harmon ritz valu sinc involv skew instead orthogon project standard set 26 comput exterior eigenvalu pose seriou problem interior eigenvalu prefer robust harmon eigenvalu approxim section 242 orthogon project mean prefer jdqz instead algorithm discuss section natur choic project eigenproblem reduc cf 6 lowdimension problem select solut u standard comput techniqu ritz valu ritz vector approxim 104 r fokkema g l g sleijpen h van der vorst algorithm 1 precondit jdqz use harmon petrov valu function qzra rb k k max els correct equat solv v approxim project problem found found implicit restart part see algorithm 2 jdqz return partial gener schur form q z ra rb dimens kmax matrix pair b gener eigenvalu near target k precondition b v 0 initi guess stop toler jmax j min specifi dimens search subspac implicit restart respect qz matlab function comput gener schur decomposit function mg perform modifi gramschmidt qzsort sort gener schur form matlab implement mg qzsort found 7 ch 6ac jacobidavidson style qr 105 algorithm 2 found implicit restart part precondit jdqz harmon petrov valu found eigenvalu eigenvector respect residu r q assum q expans v take vector v q solv approxim correct equat expand search subspac spanv v exact arithmet v orthonorm use modifi gramschmidt comput construct orthonorm basi search subspac mention introduct replac correct equat 29 eigenvalu associ eigenvector contain space span v exact solut jacobicorrect equat correct equat 29 solv exactli speed converg select ritz valu asymptot quadrat cf 26 24 reduc project eigenproblem 28 schur form qr algorithm 8 exploit schur form select ritz pair q restrict dimens subspac spanv way explain section 23 note case reorder algorithm schur form found instanc 29 9 20 fortran implement avail lapack 1 simpl matlab implement reorder respect target valu given 7 ch 6b 31 jdqr standard eigenproblem use jd algorithm comput partial schur form written cf 22 106 r fokkema g l g sleijpen h van der vorst orthogon n kmatrix r k upper triangular k k matrix column q matrix q k schur vector pair q schur pair diagon entri matrix r k repres eigenvalu x eigenpair r k q k x eigenpair result simplif jdqz refer jdqr although simplif obviou give main express jdqr eas refer suppos k 1 schur pair detect ie alreadi partial schur form aq new schur pair q eigenpair deflat matrix solv eigenproblem deflat matrix 30 precis jd algorithm deflat matrix 30 construct subspac spanv find approxim eigenpair v orthogon matrix v q deflat interact matrix order schur form give approxim q want eigenpair deflat matrix 30 accord jacobi davidson approach search subspac spanv expand orthonorm complement v v v approxim solut deflat jacobi correct equat q note project 32 subdivid two part part associ jacobidavidson deflat part observ also q k1 remark 5 two deflat techniqu found literatur subspac method like arnoldi method refer explicit implicit deflat cf eg 22 ch vi section 23 explicit deflat comput continu deflat matrix detect schur vector ecienc reason qrq use schurwielandt deflat rather stabl represent implicit deflat new vector search subspac gener made orthogon detect schur vector ad search subspac approach mixtur techniqu jacobi correct equat use explicitli deflat matrix sinc solut deflat correct equat orthogon detect schur vector need use deflat matrix comput deflat interact matrix comput similar observ hold interact matric mb gener case cf 22 exclus implicit deflat possibl well solv correct equat approxim nondefl make result solut orthogon jacobidavidson style qr 107 detect schur vector approach avoid expens matrixvector multipl explicit deflat appear improv condit number linear system lead faster converg process jacobi correct equat 29 decreas number iter step correct equat appear often compens expens multipl numer illustr see section 45 moreov explicitli deflat correct equat 32 appear lead stabl result understood follow without deflat result solut correct equat may signific compon space span detect schur vector subtract compon implicit cancel may occur work explicitli deflat matrix cancel avoid remark 6 implicitli deflat arnoldi method accuraci approxim schur pair method depend norm residu condit number pair also approxim error previous detect schur pair cf eg 22 ch iv section 25 13 section 641 deriv algorithm assum v true exact schur vector practic spanaq contain spanq 32 precondit section discuss precondit correct equat precondit straightforward project involv deriv explicit express left right precondit correct equat iter step need solv deflat jacobi correct equat 32 given q cf 32 approxim solut equat may use krylov subspac method eg gmre 23 bicgstab 25 rate converg ecienc krylov subspac method often improv precondit identif eectiv precondition may prob lem instanc interior eigenvalu construct eectiv incomplet lufactor 14 10 may requir much fillin 3 make construct expens argu section 33 may good strategi comput good possibl expens precondition k one fix valu use precondition variou q note project k necessari let k oper proper subspac cf 24 give detail deriv express precondit correct equat use notat notat 1 typic usag precondition krylov subspac method would look like solv 3 incomplet factor design linear system relat eigenprob lem solut factor eectiv usual rather smooth mean compon slowli vari eigenvector favor precondit 108 r fokkema g l g sleijpen h van der vorst follow lemma give us explicit express solut 34 term easili comput matrixvector product k k 1 lemma gener proposit 75 24 proof run along line detail see 7 ch 6 section 24 note h k small dimens cheapli invert need invert k explicitli instead comput solv v lemma 1 h k nonsingular solut equat 34 given remark 7 one store matrix k1 k precondit schur vector one comput last column k 1 q matrix q iter step furthermor store project precondition last column last row comput iter step remark 8 precondition k indefinit matrix may becom singular unlucki choic approxim ritz pair q caus breakdown never happen experi breakdown may cure select dierent nearbi approxim ritz pair q temporarili current jacobidavidson iter precondit lemma 1 follow left precondit correct equat equival note project appli explicitli residu unprecondit case need explicit project sinc fact residu associ deflat matrix ritz pair impli orthogon observ equat 36 equival one 32 cours right precondit correct equat similar 27 deriv correspond manner detail see 7 ch 6 section 24 remark 9 one use krylov subspac method solv second equat 36 one encount matrixvector product form form obvious approxim solut v provid case initi guess well moreov project k front 37 redund 37 reduc jacobidavidson style qr 109 algorithm 3 precondit jdqr function k k max els correct equat solv v approxim project problem found found implicit restart part see algorithm 4 jdqr return partial schur form q r matrix dimens kmax eigenvalu near target k precondition v 0 initi guess stop toler jmax j min specifi dimens subspac v implicit restart respect schur matlab function comput schur decomposit function mg perform modifi gramschmidt qrsort sort schur form matlab implement mg qrsort see 7 ch 6ab pseudocod precondit jacobidavidson qr algorithm given algorithm 3 tabl 2 list main comput ingredi per iter jdqr r fokkema g l g sleijpen h van der vorst algorithm 4 found implicit restart part jdqr found tabl comput cost jdqr per iter integ j k denot dimens spanv spanq respect part dot axpi mv k correct equat variabl cost project problem 3j krylov subspac method use solv correct equat product av often alreadi avail side product mv need part b instead comput residu r aqq r may also comput q v av cf algorithm 3 depend number nonzero valu j may ecient 33 qualiti deflat precondition even precondition k construct fix correct equat still involv project becom expens schur pair detect necessarili lead expens comput process com pare explicit restart iter solver use may converg faster field valu project oper contain field valu may smaller especi exterior eigenvalu detect project may also posit eect precondition jacobidavidson style qr 111 see one hand precondit error enlarg small shift hand project diminish error filter detect schur vector error r larg respect eigenvector correspond eigenvalu near project error significantli smaller penalti small shift due seem plausibl cf 32 ch iv lead significantli less eectiv precondition may help explain eectiv fix precondition jdqr experi 34 note speed converg section make comment respect converg behavior jdqr use wellknown argument jdqr algorithm nice properti respect overal perform adjust one schur pair subspac spanv also accumul compon schur pair result one schur pair detect schur pair may follow quickli complet restart compon appear similar way shiftandinvert arnoldi 22 process shift deflat eigenproblem understood follow simplic suppos complet set eigenpair tri find approxim q exact solut 29 given cf 26 section 41 write q may assum without loss gener 0 q ritz vector mean 2 latter case unlik happen due round error first case indic full converg henc eigenvector compon correspond eigenvalu closer amplifi q compon orthogon q use expans v thu soon q larg compon direct x 1 say angl less 4 necessarili compon x 1 becom domin fig 1 illustr phenomenon bullet repres amplif factor 1 compon direct x 112 r fokkema g l g sleijpen h van der vorst theta3fig 1 amplif factor eigenvector subsequ iter similar amplif occur closer rapid angl argument repetit angl small correspond 2 small compon due orthogon becom domin consequ process converg schur pair search subspac v provid good initi approxim nearbi schur pair moreov slow converg one stage may compens faster converg next stage subspac spanv enrich compon schur pair due repeat amplif observ numer experi see section 4 4 numer experi section present numer result obtain jdqz jdqr sever gener eigenproblem standard eigenproblem purpos experi get impress actual behavior method tri find ecient paramet choic particular problem illustr eect accur solv correct equat eect includ appropri precondit ing show harmon petrov valu choic test subspac may lead superior converg behavior gener eigenproblem also standard eigenproblem demonstr project correct equat 32 involv detect schur vector essenti compon algorithm also consid eigenproblem multipl eigenvalu involv comput done doubl complex precis 15 digit sun workstat facilit comparison select case j dimens subspac implicit restart respect fix random real vector v 0 initi guess cf algorithm 3 1 iter solver correct equat consid full gmre 23 maximum step denot gmresm bicgstab2 25 bicgstab2 maximum 100 matrix multipl allow cours compar appl pear main purpos mimic two reali jacobidavidson style qr 113 tic scenario one fix number matrixvector multipl gmresm one iter method satisfi stop criterion bicgstab2 stop criterion iter method correct equat also gmresm use r initi residu residu correspond approxim solut produc inner method j iter number current eigenvalu approxim outer iter henc outer iter proceed inner iter solv accur choic inspir fact jacobidavidson method may view newton process 24 27 newton process stop criterion may lead ecient algorithm 6 initi guess inner iter method alway took null vector figur converg behavior jdqz jdqr perform plot term actual amount work million float point oper flop versu log 10 residu norm reason comput work jdqz jdqr consist two part dierent natur one part inner iter process correct equat approxim solv part outer iter approxim gener schur pair construct inner iter correct equat solv accur number outer iter may decreas therefor would mislead monitor total number matrix multipl might give bad impress total cost matric spars therefor dot product vector updat outer inner iter repres substanti cost jdqz jdqr furthermor plot entir converg behavior mean converg histori residu subsequenti select approxim eigenpair plot whenev residu norm curv drop accept level indic dot horizont line eigenvalu accept search process next one continu larg residu norm step immedi accept mark start new search 401 construct suitabl initi subspac specif first step process ritz petrov vector usual poor approxim want eigenvector target valu may rel much closer want eigenvalu approxim eigenvalu case correct equat 26 36 lead rel poor expans search subspac see recal want eigenvector would new search subspac space would expand exact solut correct equat want eigenvalu instead cf section 3 observ indic improv expans first step take correct equat instead detect whether close enough replac monitor norm residu take instead 1 correct equat soon first residu norm drop threshold valu tr similar switch propos 18 moreov experi use gmre 1 first j min iter order build search subspac spanv rel inexpens way especi precondition involv approach justifi argument similar preced paragraph cf 24 section 94 402 stop criterion experi consid approxim eigenpair converg residu r sucient small r q 114 r fokkema g l g sleijpen h van der vorst tabl four eigenvalu dw1024 comput jdqr cf section 41 96473e 01 96551e 01 97780e 01 97880e 01 log10 residu norm number flop x 1e6 fig 2 converg histori dw1024 show eect solv correct equat accur cf section 41 detect eigenpair algorithm weight residu eg ra sophist stop criteria employ well cf 4 experi vari valu paramet jdqz jdqr easi refer recal mean paramet descript target valu k max number want schur pair stop toler outer iter tr threshold use build initi subspac 41 influenc correct equat purpos exampl show eect accur solut correct equat consid squar dielectr waveguid standard eigenproblem dw1024 order 2048 2 problem come integr circuit applic rightmost eigenvalu eigenvector want use jdqr standard ritz valu took use precondit comput eigenvalu given tabl 3 converg histori plot fig 2 jdqr gmre 1 gmre 10 summari number iter number matrix multipl mv number flop given tabl 4 jacobidavidson style qr 115 tabl summari result dw1024 cf section 41 method correct equat jdqr iter mv flop tabl five eigenvalu bwm2000 comput jdqr cf section 42 24427e 07 21395e 24427e solv correct equat accur number mv increas number outer iter reduc significantli see tabl 4 result much better overal perform gmre 1 search subspac span residu case jd implicit restart gener subspac ira 28 eigenvalu well separ case therefor arnoldi converg slowli explain poor converg jdqr gmre 1 note initi phase two small bump jdqr converg quit fast next eigenvalu initi stagnat appar iter first eigenvalu compon next schur vector alreadi collect spanv cf section 34 42 eect precondit increas number step gmre correct equat solv accur number outer iter may decreas seen sometim need mani inner iter gmre accept converg outer iter appropri precondit may see dramat improv see exampl consid standard eigenproblem bwm2000 order 2000 bruss lator wave model 2 22 problem model concentr wave reaction transport interact chemic solut tubular reactor task determin eigenvalu largest real part order verifi whether real part posit neg correspond stabl unstabl mode use jdqr standard ritz valu problem select comput eigenvalu list tabl 5 converg histori plot fig 3 jdqr unprecondit gmre 10 precondit summari result given tabl 6 fig 3 see jdqr gmre 10 converg check even gmre 50 littl improv precondit jdqr perform rather well see speed converg first eigenvalu somewhat slower speed converg eigenvalu note although project correct equat becom expen r fokkema g l g sleijpen h van der vorst log10 residu norm number flop x 1e6 gmre ilu0fig 3 converg histori bwm2000 illustr eect includ precondit solver correct equat cf section 42 tabl summari result bwm2000 cf section 42 method correct equat jdqr iter mv flop sive detect eigenvalu comput work eigenvalu roughli constant except first eigenvalu note popular softwar packag solv eigenproblem report fail problem bwm2000 12 precondit correct equat 26 requir comput storag term notat 1 k good approxim span invari subspac nearli ideal case reason tempt use 26 instead k howev approach work well may even lead slower converg experi instanc qh882 discuss section 43 lost converg complet experi littl eect 43 harmon ritz valu jdqr algorithm comput partial schur form standard eigenproblem standard ritz pair schur pair howev jdqz also comput partial schur form standard eigenproblem harmon ritz pair give exampl illustr improv converg behavior harmon ritz valu consid quebec hydroelectr power system problem qh882 order 882 2 matrix repres hydroquebec power system smallsign model jacobidavidson style qr 117 tabl five eigenvalu qh882 comput jdqr cf section 43 4e06 2e062e068e06 6e06 4e06 2e06 0 imaginari axi real axi fig 4 spectrum qh882 cf section imaginari axi real axi eigenvalu target fig 5 part spectrum qh882 eigenvalu interest eigenvalu box 300 100 complex plane problem select comput eigenvalu given tabl 7 converg histori plot fig 7 jdqr standard ritz valu jdqz harmon choic cf section 242 problem rather dicult eigenvalu neighborhood interior spectrum see fig 4 5 three method correct equat solv gmre 20 precondit exact invers summari result given tabl 7 although comput complex jdqr less comput complex jdqz cf tabl 1 2 ecient method irregular converg behavior jdqr fig 6 may conclud jdqr problem select correct ritz pair result converg delay eventu jdqr lose track complet stagnat peak converg behavior show sometim ritz pair select jdqr process correspond closebi schur pair result search subspac expand poor direct clearli exampl may lead failur converg anticip cf section 22 jdqz harmon choic test subspac make better select indic smooth converg henc perform much better 44 identif suitabl ritz valu track comput point view jdqr less complex jdqz even save standard eigenproblem problem allow exploit jdqz therefor may attract identifi ecient strategi avoid incorrect select ritz r fokkema g l g sleijpen h van der vorst residu norm jdqr number flop x 1e6 jdqz harmon fig 6 converg histori qh882 although qh882 standard eigenproblem comput interior eigenvalu ecient use jdqz test subspac dierent search subspac bottom pictur better select harmon ritz valu bottom pictur appear compens less optim expans test subspac cf section 43 pair correctli select ritz pair converg may expect less irregular stagnat may complet avoid discuss strategi ritz vector previou iter alreadi fair approxim norm residu give inform select ritz vector current step case poor select new residu much larger previou one would requir addit comput work find ritz pair small residu norm still close enough target cheap altern case select ritz valu close previous accept one forget experi discuss replac case target ritz valu select accept previou step consid ritz valu accept associ residu smaller specifi threshold exampl took threshold equal tr valu use criterion leav initi stage see section 401 converg ritz pair origin target valu restor start comput next eigenpair track strategi requir addit comput cost per step appear reduc number step significantli see rather regular converg ritz valu exterior eigenvalu improv eigenvalu may expect track strategi standard problem illustr fig 7 eect one may see includ track jdqr appli jdqr exampl section 43 choic paramet nevertheless see converg behavior jdqz harmon choic test subspac still superior see also tabl 8 45 influenc q k z k correct equat exampl show project detect schur vector cf 24 jacobidavidson style qr 119 residu norm jdqr number flop x 1e6 jdqz harmon fig 7 converg histori qh882 obtain track strategi variant interior eigenvalu track strategi improv jdqr significantli compar present upper pictur upper pictur fig 7 improv jdqz compar two bottom pictur present figur fig 7 cf section 44 tabl summari result qh882 cf section 43 44 method iter mv flop jdqr track cf section 44 99 1482 1221e jdqz harmon 57 essenti correct equat cf section 34 show happen project neglect note still take jacobi project q z account consid bound finelin dielectr waveguid gener eigenproblem bfw782 2 order 782 problem stem finit element discret maxwel equat propag mode magnet field profil rectangular waveguid fill dielectr pec structur result matrix nonsymmetr matrix b posit definit special interest gener eigenvalu posit real part ie 0 correspond eigenvector problem paramet set spectrum matrix pair shown fig 8 magnif region interest plot fig 9 comput gener eigenvalu repres given tabl 9 jdqz discov four posit gener eigenvalu converg histori harmon version jdqz gmre 10 plot upper pictur fig 10 summari result given tabl 10 see jdqz converg quit nice bottom pictur fig 10 converg behavior jdqz given case correct equat 24 solv without take account project involv q k z k cours correct equat use 120 r fokkema g l g sleijpen h van der vorst 8000 6000 4000 2000200060003e06 2e06 1e06 0e00 imaginari axi real axi fig 8 spectrum bfw782 cf section 45 04 imaginari axi real axi eigenvalu target fig 9 part spectrum bfw782 tabl five gener eigenvalu bfw782 comput jdqz cf section 45 25233e residu norm gmre harmonic10 number flop x 1e6 gmre harmon without q zfig 10 converg histori bfw782 upper pictur without bottom pictur deflat matric correct equat respect detect schur vector cf section 45 tabl summari result bfw782 cf section 45 method correct equat jdqz iter mv flop jacobidavidson style qr 121 tabl gener eigenvalu ac1331 comput jdqz cf section 46 includ rankon project involv q z project essenti jacobidavidson furthermor deflat case realiz make approxim solut correct equat orthogon detect schur vector modifi gramschmidt latter twice overal perform improv significantli result shown cf fig 10 modifi gramschmidt appli twice howev explain section 34 benefit improv oper inner iter although result algorithm comput cheaper fig 10 show lead overal better perform speed converg becom increasingli slower even stagnat eventu 46 multipl eigenvalu consid eigenproblem neumann boundari condit cube 0 4 3 finit element discret equat 11 11 11 regular grid tetrahedr element linear interpol function lead gener eigenproblem order 1331 ac1331 one posit gener eigenvalu rel close zero ie 0 gener eigenvalu also posit may doublet even triplet problem paramet set comput 15 leftmost gener eigenvalu repres given tabl 11 residu norm versu number flop plot fig 11 harmon version jdqz gmre 10 bicgstab2 respect summari result given tabl 12 plot see eect multipl gener eigenvalu may converg behavior jdqz converg initi quit fast point discov gener eigenvalu actual doubl tripl converg speed stagnat iter two three peak plot gmre plateau plot bicgstab2 eigenvalu discov quickli one anoth behavior agreement section 34 stagnat phase compon schur vector amplifi inner iter collect search subspac lead faster converg next schur pair stagnat explain fact rankon jacobi project correct equat may becom nearli singular select petrov approxim multipl gener eigenvalu iter method use solv correct equat often suer see also 31 variabl block version correct equat take multipl account may prefer case fall outsid scope paper 122 r fokkema g l g sleijpen h van der vorst residu norm gmre harmonic10 log10 residu norm number flop x 1e6 harmon fig 11 converg histori ac1331 stagnat follow fast detect tripl gener eigenvalu cf section 46 tabl summari result ac1331 cf section 46 method correct equat jdqz iter mv flop 47 harmon petrov valu gener problem last exampl show interior gener eigenvalu harmon version jdqz quit power consid mhd416 gener eigenproblem order 416 2 24 3 problem stem magnetohydrodynam mhd model interact hot plasma magnet field studi matrix nonhermitian matrix b hermitian posit definit goal comput interior gener eigenvalu correspond socal alfven branch spectrum see fig 12 13 problem paramet set comput gener eigenvalu plot fig 14 converg histori harmon version jdqz gmre 1 plot fig 15 exact invers b fix use precondition eigenvalu gener eigenvalu rate converg almost comput one schur pair search subspac appar accumul compon next schur pair well jacobidavidson style qr 123 imaginari axi real axi fig 12 spectrum mhd416 cf section 4702061 imaginari axi real axi fig 13 alfven branch mhd416 cf section 47050607 imaginari axi real axi eigenvalu target fig 14 20 gener eigenvalu comput jdqz mhd416 cf section 47 5 conclus propos two algorithm jdqz jdqr comput sever select eigenpair approxim gener standard eigen problem respect method base jacobidavidson method comput iter partial gener schur form gener eigenvalu near userspecifi target valu method exact invers matrix strictli necessari suitabl solv larg eigenproblem fast converg obtain project correct equat solv approxim iter method appropri precondit converg jdqz jdqr asymptot quadrat correct equat solv exactli furthermor converg particular schur pair search subspac accumul compon schur pair gener eigenvalu near target well usual lead faster converg next eigenpair dimens involv subspac control ecient implicit restart techniqu way relev part subspac maintain restart 124 r fokkema g l g sleijpen h van der vorst 5 log10 residu norm number flop x 1e6 gmre harmonicfig 15 converg histori jdqz mhd416 harmon petrov valu allow good select petrov pair comput interior gener eigenvalu also gener problem cf section 47 algorithm incorpor simpl mechan select want eigenpair approxim also multipl gener eigenvalu detect wherea jacobidavidson method test subspac chosen arbi trarili jdqz algorithm essenti two choic test subspac remain standard petrov valu choic harmon petrov valu choic argu confirm experi especi interior eigenvalu harmon approach also superior gener eigenproblem acknowledg acknowledg help discuss rich lehoucq beresford parlett name convent also appreci help comment refere r test matrix collect nonhermitian eigenvalu problem iter calcul lowest eigenvalu correspond eigenvector larg real symmetr matric subspac method linear qr transform unitari analogu lr transform matrix comput class first order factor method ueber ein leicht verfahren evalu softwar comput eigenvalu spars nonsymmetr matric deflat techniqu within implicitli restart iter ation iter solut method linear system coe algorithm gener matrix eigenvalu problem comput interior eigenvalu larg matric gener davidson method comput eigenvalu spars symmetr matric approxim solut eigenvalu bound krylov subspac perturb bound mean eigenvalu invari subspac ration krylov algorithm nonsymmetr eigenvalu problem ii numer method larg eigenvalu problem gmre gener minimum residu algorithm solv nonsymmetr linear system jacobidavidson iter method linear eigenvalu problem jacobidavidson method eigenvalu problem relat acceler inexact newton scheme implicit applic polynomi filter kstep arnoldi method algorithm 406 hqr3 exchng fortran subroutin calcul order eigenvalu real upper hessenberg matrix matrix perturb theori rate converg conjug gradient precondit incomplet decomposit gener eigenvalu approach solv ricatti equat algorithm 590 tr ctr jame h money qiang ye algorithm 845 eigifp matlab program solv larg symmetr gener eigenvalu problem acm transact mathemat softwar tom v31 n2 p270279 june 2005 ivo bleyleven ralf peeter bernard hanzon effici improv nd system approach polynomi optim journal symbol comput v42 n12 p3053 januari 2007 lorenzo valdettaro michel rieutord thierri braconni valri frayss converg roundoff error twodimension eigenvalu problem use spectral method arnoldichebyshev algorithm journal comput appli mathemat v205 n1 p382393 august 2007 peter arbenz martin beka roman geu ulrich hetmaniuk tiziano mengotti parallel multilevel precondit maxwel eigensolv parallel comput v32 n2 p157165 februari 2006 peter arbenz roman geu multilevel precondit iter eigensolv maxwel eigenvalu problem appli numer mathemat v54 n2 p107121 juli 2005 daniel kressner block algorithm reorder standard gener schur form acm transact mathemat softwar tom v32 n4 p521532 decemb 2006 richard tran mill andrea stathopoulo evgenia smirni algorithm modif jacobidavidson parallel eigensolv dynam balanc extern cpu memori load proceed 15th intern confer supercomput p454463 june 2001 sorrento itali pa absil c g baker k gallivan truncatedcg style method symmetr gener eigenvalu problem journal comput appli mathemat v189 n1 p274285 1 may 2006 comput smallest singular triplet implicitli restart lanczo bidiagon appli numer mathemat v49 n1 p3961 april 2004 lawrenc k saul sam rowei think global fit local unsupervis learn low dimension manifold journal machin learn research 4 p119155 1212003 jame r mccomb andrea stathopoulo parallel multigrain iter solver hide network latenc mpp network cluster parallel comput v29 n9 p12371259 septemb