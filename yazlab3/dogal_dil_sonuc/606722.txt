parallel solver largescal markov chain consid parallel comput stationari probabl distribut vector ergod markov chain larg state space precondit krylov subspac method parallel precondition obtain explicit approxim factor form particular gener invers gener matrix markov process graph partit use parallel whole algorithm result twolevel methodcondit guarante exist precondition given result parallel implement present result indic method well suit problem gener matrix explicitli form store b introduct discret markov chain larg state space aris mani applic includ instanc reliabl model queue network analysi larg scale econom model comput system perform evalu stationari probabl distribut vector ergod markov process n theta n transit probabl matrix p uniqu 1 theta n vector satisfi let comput stationari vector reduc find nontrivi solut homogen linear system 0 ergod assumpt mean p therefor irreduc perronfrobeniu theori 9 guarante rank n gamma 1 onedimension null space n span vector x posit entri upon normal 1 norm stationari distribut vector markov process coeffici matrix singular mmatrix call gener markov process 3 matrix nonsymmetr although sometim structur symmetr see 26 good introduct markov chain numer solut due larg number n state typic mani realworld applica tion increas interest recent year develop parallel algorithm markov chain comput see 2 5 10 17 19 24 attent far focus linear stationari iter meth od includ block version jacobi gaussseidel 10 19 24 iter aggregationdisaggreg scheme specif tailor stochast matric 10 17 contrast littl work done parallel precondit krylov subspac method partial except 5 symmetriz stationari iter cimmino method acceler use conjug gradient cray t3d 19 outofcor parallel implement conjug gradient squar precondi tion use solv larg markov model 50 million state suitabl precondit krylov subspac method solv markov model demonstr eg 25 although discuss parallel issu given paper investig use parallel precondit iter method larg spars linear system context markov chain com strictli speak gener matrix work instead q conform familiar notat numer linear algebra putat precondit strategi twolevel method base spars approxim invers first introduc 3 howev due singular gener matrix applic approxim invers techniqu context obviou inde possibl consequ fact singular mmatrix paper organ follow section 2 discuss problem precondit singular equat gener establish link standard precondition gener invers section 35 devot ainv precondit markov chain problem includ discuss parallel implement theoret analysi exist precondition numer test report section 6 conclus present section 7 precondit markov chain problem markov chain context precondit typic amount find easili invert nonsingular matrix precondition good approxim krylov subspac method use solv precondit notic even singular precondition must nonsingular chang solut set ie null space precondition gener mean split n use stationari iter method includ jacobi gauss seidel sor block version scheme see 26 also class popular incomplet lu ilu factor precondition ilutyp method success appli markov chain problem saad 25 sequenti environ exist incomplet factor nonsingular mmatric alreadi prove 20 investig exist ilu factor singular mmatric found 11 incomplet factor method work quit well wide rang problem easili implement parallel comput reason much effort put recent year develop altern precondit strategi natur parallel compar ilu method term robust converg rate work result sever new techniqu known spars approxim invers precondition see 7 recent survey extens refer spars approxim invers precondition base directli approxim invers coeffici matrix spars matrix g gamma1 applic precondition requir matrixvector product easili parallel techniqu appli almost exclus nonsingular system equat b except seem 13 spai precondition 16 use connect fast wavelet transform techniqu singular system stem discret neumann problem poisson equat applic approxim invers techniqu singular case rais sever interest theoret practic question invers exist clear matrix g approxim presum gener invers one note question ask gamma1 precondition 26 page 143 state gamma1 approxim group gener invers ilu factor u implicitli yield approxim see interpret entir correct somewhat mislead group invers see 12 one mani possibl gener invers well known 21 group invers play import role modern theori finit markov chain howev seldom use comput tool part comput requir knowledg stationari distribut vector turn differ precondition result implicitli explicitli approxim gamma1 differ gener invers typic group invers let us consid ilu precondit first ntheta irreduc singular mmatrix ldu factor l u unit lower upper triangular matric respect diagon matrix rank see 26 notic l u nonsingular mmatric particular l gamma1 u gamma1 nonneg entri defin matrix easili verifi gamma satisfi first two penros four condit 12 first ident state gamma inner invers second gamma outer invers gener invers satisfi two condit call 1 2invers innerout invers anoth term found literatur reflex invers see 12 gamma necessarili satisfi third fourth penros condit moorepenros pseudoinvers gener obvious 1 2invers kind gener invers nonuniqu inde infinit mani 1 2invers gener pair r n subspac ir n complement null space rang respect uniqu determin 1 2invers gnr null space n gnr rang rgnr see 12 case gamma readili verifi denot ith unit basi vector ir n easi see r complementari n n complementari ra pseudoinvers correspond 1 2invers gamma also differ group invers gener seen fact gener aa gamma 6 gamma wherea group invers alway satisfi aa also notic singular irreduc mmatrix 1 2invers nonneg trix true gener either group moorepenros let u incomplet ldu factor unit lower triangular u u unit upper triangular diagon matrix posit entri main diagon clearli henc ilu factor yield implicit approxim gamma rather also seen fact alway nonneg true straightfoward check gamma obliqu projector onto along n aa gamma obliqu projector onto along g therefor gamma eigenvalu 0 multipl 1 1 multipl likewis aa gamma henc make good sens construct precondition base approxim gamma either implicitli explicitli sinc case eigenvalu precondit matrix cluster around 1 next consid approxim invers precondition ainv see 4 6 method base observ z w matric whose column abiorthogon w diagon matrix lead princip minor except possibl last one nonzero z w obtain appli gener gramschmidt process unit basi vector e 1 case z w unit upper triangular follow uniqu ldu factor u gamma1 ldu ldu factor diagon matrix factor approxim invers factor form w obtain drop small entri cours gener gramschmidt process similar ilu incomplet invers factor guarante exist nonsingular matric 4 see next section singular mmatrix case either case w nonneg matrix henc precondition interpret direct explicit approxim 1 2invers gamma lastli take look spars approxim invers techniqu base frobeniu norm minim see eg 16 14 class meth od approxim invers g comput minim function subject sparsiti constraint jj delta jj f denot frobeniu matrix norm sparsiti constraint could impos priori dynam cours algorithm either case natur ask kind gener invers approxim g singular matrix shown moorepenros pseudoinvers matrix smallest frobeniu norm minim jji gamma axjj f see instanc 23 page 428 henc singular case spai precondition seen spars approxim moorepenros invers gener differ approxim 1 2invers obtain either ilu ainv instanc spai produc nonneg precondition gener next section restrict attent ainv precondition applic markov chain problem 3 ainv method singular matric ainv precondition 4 6 base abiorthogon gener gramschmidt process appli unit basi vector e n gener standard inner product replac bilinear form hx ay process well defin exact arith metic lead princip minor nonzero otherwis form pivot row andor column interchang may need nonsingular mmatrix lead princip minor posit process well defin need pivot perfectli analog lu factor inde exact arithmet abiorthogon process comput invers triangular factor singular irreduc mmatrix lead princip minor except nth one determin posit process still complet order obtain spars precondition entri fillin invers factor z w less given drop toler magnitud drop cours comput result incomplet process stabil incomplet process mmatric analyz 4 particular denot ith pivot ie ith diagon entri incomplet process proposit 31 4 mmatrix pivot breakdown occur exactli argument appli case irreduc singular mmatrix case breakdown first step incomplet abiorthogon process sinc first lead princip minor posit pivot incomplet process smaller exact one even nth pivot happen zero could simpli replac posit number order nonsingular precondition argument 4 show n must nonneg number extrem unlik exactli zero incomplet process anoth way guarante nonsingular precondition perturb matrix ad small posit quantiti last diagon entri make matrix nonsingular mmatrix incomplet abiorthogon process appli slightli perturb matrix yield well defin nonsingular precondition practic ever perturb necessari sinc drop factor typic equival effect see theorem 3 ainv precondition extens test varieti symmetr nonsymmetr problem conjunct standard krylov subspac method like conjug gradient symmetr posit definit matric gmre bicgstab tfqmr unsymmetr problem precondition found compar ilu method term robust rate converg ilu method somewhat faster averag sequenti comput main advantag ainv ilutyp method applic within iter process requir matrixvector multipli much easier vector parallel triangular solv unfortun comput precondition use incomplet biorthogon process inher sequenti one possibl solut problem adopt 8 comput precondition sequenti one processor distribut approxim invers factor among processor way minim commun cost achiev good load balanc approach justifi applic like consid 8 matric small enough fit local memori one processor precondition reus number time case time comput precondition neglig rel overal cost markov chain set howev precondition reus gener imper setup cost minim furthermor markov chain problem larg desir abl comput precondition parallel 4 parallel precondition present section describ achiev fulli parallel precon dition strategi use parallel precondition construct base use graph partit approach first propos 3 context solv nonsingular linear system aris discret partial differenti equat idea illustr follow p processor avail graph partit use decompos adjac graph associ spars matrix structur symmetr p subgraph roughli equal size way number edg cut approxim minim node connect cut edg remov subgraph put separ set number node separ set last symmetr permut q aq obtain permut matrix follow structur diagon block correspond interior node graph decomposit approxim order offdiagon block connect subgraph diagon block connect node separ set order equal cardin separ set kept small possibl note irreduc assumpt block nonsingular mmatrix ldu factor ldu ldu factor q aq easi see invers unit lower triangular factor schur complement matrix next section show singular irreduc mmatrix henc well defin ldu factor likewis u invers unit upper triangular factor import observ l gamma1 u gamma1 preserv good deal sparsiti sinc fillin occur within nonzero block matrix simpli defin note diagon entri posit except last one zero 1 2invers gamma defin obviou way henc write gener dens gener invers q aq gamma product spars matric l practic howev invers factor l gamma1 u gamma1 contain mani nonzero sinc interest comput precondition need comput spars approxim l gamma1 u gamma1 accomplish follow graph partit matrix distribut processor p hold one processor mark p also hold processor comput spars approxim invers factor w use ainv algorithm done processor comput product point comput proce parallel commun next step accumul approxim schur complement accumul done step fanin across processor next section show although exact schur complement singular approxim schur complement nonsingular mmatrix rather mild condit soon comput processor p comput factor spars approxim use ainv algorithm sequenti bottleneck explain size separ set must kept small approxim invers factor comput broadcast remain processor actual precondition applic implement way need broadcast notic matrixvector product requir applic precondition need explicitli way factor spars approxim 1 2invers q aq obtain twolevel precondition sens comput precondition involv two phase first phase spars approxim invers diagon block comput second phase spars approxim invers approxim schur complement comput second step precondition would reduc block jacobi method inexact block solv terminolog domain decomposit method addit schwarz inexact solv overlap well known fix problem size rate converg precondition tend deterior number block subdomain grow henc assum block assign processor parallel comput method would scalabl howev approxim schur complement phase provid global exchang inform across processor act coars grid correct coars grid node interfac node ie correspond vertic separ set see prevent number iter grow number processor grow long cardin separ set small compar cardin subdomain subgraph algorithm scalabl term parallel effici inde case applic precondition step krylov subspac method like gmre bicgstab easili implement parallel relativeley littl commun need 5 approxim schur complement section investig exist approxim 1 2invers gener matrix key role play approxim schur complement first briefli review situat case nonsingular mmatrix assum partit 21 22 wellknown schur complement also nonsingular mmatrix see eg 1 moreov true approxim schur complement provid x 11 gamma1 inequ hold componentwis see 1 page 264 singular case situat slightli complic follow examin basic properti exact schur complement singular irreduc mmatrix correspond ergod markov chain recal irreduc rowstochast transit probabl matrix irreduc rowstochast matrix partit assum 21 22 schur complement 11 singular irreduc mmatrix onedimension null space proof consid stochast complement 22 sigma p 22 note gamma p 11 invert sinc p irreduc theori develop 22 know sigma row stochast irreduc sinc p consid schur complement 11 22 clearli irreduc singular mmatrix follow perronfrobeniu theorem onedimension null space 2 previou lemma especi use case exact schur complement use context precondit often import know properti approxim schur complement shown previou section graph partit induc reorder block partit matrix form 1 interest properti approxim schur complement obtain approxim invers diagon block ainv particular interest condit guarante nonsingular mmatrix case ainv algorithm safe appli result well defin precondition begin lemma recal zmatrix matrix nonposit offdiagon entri 9 lemma 2 let singular irreduc mmatrix let c c 6 nonsingular mmatrix proof sinc singular mmatrix aeb denot spectral radiu b let zmatrix b c gamma therefor write modifi distinguish two follow simpl case assum first nonsingular mmatrix sinc written aebi gamma b gamma c c last inequ follow irreduc b properti nonneg matric see 9 page 27 cor 15 b assum hand b note assumpt least one diagon entri ii must posit let denot largest posit diagon entri sinc b ffii irreduc similar previou case follow nonsingular mmatrix final 6 c 6 result follow combin two previou argument 2 context parallel precondition lemma say inexact approxim invers diagon block result approxim schur complement still zmatrix furthermor nonneg nonzero nonsingular mmatrix follow theorem state suffici condit nonsingular approxim schur complement b b lambdaj denot ith row jth column matrix b respect theorem 3 let 21 22 singular irreduc mmatrix 11 2 ir mthetam assum 11 approxim gamma1 11 11 furthermor assum exist indic follow three condit satisfi approxim schur complement 12 nonsingular mmatrix proof lemma 1 know exact schur complement 11 singular irreduc mmatrix note approxim schur complement induc approxim 11 block gamma1 11 exact schur complement relat follow gamma1a c sinc 21 12 gamma1 zmatrix definit assumpt gamma16 gamma1and exist least one nonzero entri ff ij 11 equal fact strictli less correspond entri gamma1 11 see correspond row 21 column j 12 nonzero nonzero entri c result follow lemma 2 2 let us appli result precondition describ previou section case 11 block diagon ainv algorithm use approxim invers diagon block separ parallel approxim schur complement 2 result subtract p term refer term schur complement updat one updat nonneg approxim exact updat c entrywis nonneg order sinc see 6 theorem 3 say long least one updat entri strictli less correspond entri c approxim schur complement nonsingular mmatrix practic condit satisfi result drop approxim invers diagon block nevertheless desir rigor condit ensur nonsingular follow theorem give suffici condit nonsingular approxim schur complement consequ drop ainv name specifi condit drop forc nonsingular note condit theorem appli global matrix 1 sinc 11 block diagon therefor reduc howev appli individu schur complement updat correspond diagon block irreduc make result fairli realist theorem 4 let 11 2 ir mthetam singular mmatrix 21 22 irreduc let lu factor 11 assum column l 11 except last one row u 11 except last one least one nonzero entri addit diagon one denot z 11 11 factor spars approxim invers 11 obtain ainv algorithm approxim schur complement nonsingular mmatrix provid z 11 6 z 11 proof first note two condit nonzero entri l 11 u 11 impli similar condit entri lower upper triangular part 11 name easi see bar fortuit cancel 0 trilb triub denot lower upper triangular part matrix b respect condit easier check weaker one triangular factor 11 condit 3 4 impli path graph l 11 path graph u 11 matrix irreduc 12 6 21 6 mean exist indic rs 6 0 exist previous mention path impli w 11 z 11 exact invers factor 11 approxim invers factor ainv algorithm satisfi 6 z 11 henc condit theorem 3 satisfi result prove 2 instruct consid two extrem case 11 diagon approxim schur complement necessarili equal exact one therefor singular case cours condit last theorem violat hand 11 irreduc tridiagon invers factor complet dens last theorem enough drop singl entri invers factor obtain nonsingular approxim schur complement purpos theori develop shed light observ robust propos precondition rather serv practic tool word seem necessari check condit advanc inde thank drop approxim schur complement alway found nonsingular mmatrix actual comput 6 numer experi section report result obtain parallel implement precondition sever markov chain problem underli krylov subspac method bicgstab 27 found perform well markov chain 15 fortran implement use mpi dynam memori alloc packag meti 18 use graph partit work graph whenev structur symmetr test problem aris real markov chain applic provid dayar matric use 15 compar differ method sequenti environ descript test problem provid tabl 1 n problem size nnz number nonzero matrix test problem structur nonsymmetr except ncd mutex matric unstructur tabl 211 contain test result run perform sgi origin 2000 lo alamo nation laboratori use 64 processor except matric leaki ncd 2d perform origin 2000 helsinki univers technolog use 8 processor case initi guess constant nonzero vector similar result obtain randomli gener initi guess tabl ptime denot time comput precondition pdensiti ratio number nonzero precondition number nonzero matrix denot number iter need reduc 2 norm initi residu eight order magnitud ittim time perform iter tottim sum ptime ittim time second furthermor sepsiz cardin inform test problem matrix n nnz applic hard 20301 140504 complet buffer share atm network multiplex model leaki bucket 2d 16641 66049 twodimension markov chain model telecom 20491 101041 telecommun model ncd 23426 156026 ncd queue network mutex 39203 563491 resourc share model qn 104625 593115 queue network separ set ie order schur complement matrix avg dom averag number vertic subdomain subgraph graph partit problem drop toler ainv algorithm level precondition approxim invers approxim invers approxim schur complement except mutex problem see tabl present result matrix hard use three differ valu drop toler ainv algorithm seen chang valu chang densiti precondition number itera tion howev total time scarc affect especi least 8 processor use see 8 similar observ differ con text also clear run good speedup obtain long size separ set small compar averag subdomain size soon separ set compar size averag subdomain larger sequenti bottleneck repres schur complement part comput begin domin perform deterior number iter remain roughli constant slight downward trend number processor grow due influenc approxim schur complement problem also solv use bicgstab diagon precondi tion requir approxim 700 iter 164 second one processor implement parallel method would probabl give result slightli wors obtain ainv similar observ appli matric qn mutex hand diagon precondit bicgstab converg telecom problem henc ainv robust approach furthermor abil reduc number iter therefor total number inner product advantag distribut memori machin inner product incur addit penalti due need global commun matrix hard ptime 235 119 065 040 034 pdensiti 621 590 567 514 452 ittim 943 291 142 099 088 tottim 118 410 207 139 122 sepsiz 156 321 540 900 1346 avgdom 10073 5155 2470 1213 592 tabl matrix hard ptime 119 060 035 022 021 pdensiti 310 302 295 278 252 106 109 99 98 97 ittim 685 290 159 105 119 tottim 804 350 194 127 140 tabl matrix hard ptime 073 038 022 015 014 pdensiti 139 136 134 128 119 170 167 159 151 153 ittim 603 252 150 130 164 tottim 676 290 172 145 178 result matric leaki 2d report tabl 5 6 two matric rather small 8 processor use note speedup better 2d leaki also notic precondition spars leaki rather dens 2d tabl 7 8 refer telecom test problem found small valu consequ dens precondition necessari order achiev converg reason number iter problem complet differ matric aris solut ellipt partial differenti equat notic fairli small size sep matrix leaki ptime 026 017 009 pdensiti 134 134 132 ittim 139 084 062 tottim 165 101 071 sepsiz 48 144 335 avgdom 4105 2028 990 tabl matrix 2d ptime 038 016 009 pdensiti 860 712 654 33 36 37 ittim 146 056 038 tottim 184 072 047 sepsiz 129 308 491 avgdom 8256 4083 2018 tabl matrix telecom ptime 249 100 335 121 105 137 pdensiti 167 116 70 44 28 11 12 14 13 12 12 ittim 365 140 604 096 038 043 tottim 614 240 939 217 143 180 sepsiz 34 97 220 471 989 1603 avgdom 10229 5099 2534 1251 609 295 arat set caus densiti precondition decreas fast number processor correspond subdomain grow result speedup quit good even superlinear 32 processor suffici high number processor densiti precondition matrix telecom ptime 704 378 137 061 049 056 pdensiti ittim 594 270 128 218 136 171 tottim 664 308 142 279 186 227 tabl matrix ptime 142 069 031 pdensiti 413 265 190 292 288 285 ittim 170 845 638 tottim 184 914 669 sepsiz 3911 6521 12932 avgdom 9758 4226 1379 tabl matrix ptime 119 040 010 pdensiti 014 014 014 ittim 164 119 151 tottim 283 159 161 sepsiz 13476 17749 20654 avgdom 12864 5363 2319 come accept converg rate compar obtain dens precondition small number processor tabl result matric ncd mutex respect first matrix see separ set larger averag subdomain alreadi nevertheless possibl use effect 8 processor matrix mutex exhibit behavior radic differ matrix qn ptime 412 237 226 282 pdensiti 127 123 118 114 ittim 134 633 458 568 tottim 175 870 684 850 sepsiz 2879 6579 13316 20261 avgdom 50873 24511 11414 5273 matric aris pde two three space dimens separ set huge alreadi 2 due fact problem state space graph high dimension lead unfavor surfacetovolum ratio graph partit order solv problem use two differ valu two level ainv subdomain level use form approxim schur complement drop everyth outsid main diagon result diagon spite converg rapid nevertheless pay use processor tabl 11 report result largest exampl data set qn model consist network three queue analog threedimension problem fairli rapid growth separ set pay use processor test problem consid far although realist rel small henc difficult make effici use 16 processor partial except matric hard telecom test scalabl propos solver larger problem gener simpl reliabl problem analog use 2 5 see also 26 page 135 problem close form solut tabl 12 show time result run 100 precondit bicgstab iter reliabl problem entri problem suffici larg show good scalabl algorithm processor conclud section numer experi note virtual run precondition construct time quit modest total solut time domin cost iter phase reliabl model ptime 953 486 249 131 090 090 pdensiti 405 402 397 390 380 370 ittim 1388 705 372 168 947 796 tottim 1483 754 397 181 104 886 sepsiz 542 1229 2186 3268 4919 7336 avgdom 124729 62193 30977 15421 7659 3792 conclus investig use parallel precondition krylov subspac method context markov chain problem precondition direct approxim factor form 1 2invers gener matrix base abiorthogon process parallel achiev graph partit although approach also possibl exist precondition justifi theoret numer experi parallel comput carri order assess effect scalabl propos techniqu numer test indic precondition construct cost modest good scalabl possibl provid amount work per processor suffici larg compar size separ set method appear well suit problem gener explicitli form store parallel base graph partit usual effect possibl except problem state space high dimension ie larg state descriptor set problem differ parallel strategi need order achiev scalabl implement acknowledg would like thank professor gutknecht w schonauer kind invit take part commemor friend colleagu rudig weiss indebt tugrul dayar provid test matric use numer experi use inform problem well comment earli version paper thank also carl meyer valuabl input gener invers r arithmet mean method find stationari vector markov chain spars approxim invers precondition conjug gradient method parallel block project method cimmino type finit markov chain spars approxim invers precondition nonsymmetr linear system compar studi spars approxim invers precondition approxim invers precondit parallel solut spars eigenproblem nonneg matric mathemat scienc academ press distribut steadi state analysi use kroneck algebra incomplet factor singular mmatric gener invers linear transform pitman publish ltd fast wavelet iter solver appli neumann problem priori sparsiti pattern parallel spars approxim invers precondition comparison partit techniqu twolevel iter solver larg parallel precondit spars approxim invers asynchron iter solut markov system fast high qualiti multilevel scheme partit irregular graph distribut diskbas solut techniqu larg markov model iter solut method linear system coeffici matrix symmetr mmatrix role group gener invers theori finit markov chain theori nearli reduc system matrix analysi appli linear algebra siam experiment studi parallel iter solut markov chain block partit precondit krylov subspac method numer solut markov chain introduct numer solut markov chain princeton univers press bicgstab fast smoothli converg variant bicg solut nonsymmetr linear system tr incomplet factor singular mmatric stochast complement uncoupl markov chain theori nearli reduc system bicgstab fast smoothli converg variant bicg solut nonsymmetr linear system iter solut method spars approxim invers precondition conjug gradient method parallel precondit spars approxim invers spars approxim invers precondition nonsymmetr linear system fast high qualiti multilevel scheme partit irregular graph compar studi spars approxim invers precondition matrix analysi appli linear algebra comparison partit techniqu twolevel iter solver larg spars markov chain priori sparsiti pattern parallel spars approxim invers precondition ctr aliakbar montaz haghighi dimitar p mishev parallel prioriti queue system finit buffer journal parallel distribut comput v66 n3 p379392 march 2006 ilia g maglogianni elia p zafiropoulo agapio n plati georg gravvani comput success factor consist acquisit recognit object color digit imag explicit precondit journal supercomput v30 n2 p179198 novemb 2004 nichola j dingl peter g harrison william j knottenbelt uniform hypergraph partit distribut comput respons time densiti larg markov model journal parallel distribut comput v64 n8 p908920 august 2004 michel benzi precondit techniqu larg linear system survey journal comput physic v182 n2 p418477 novemb 2002