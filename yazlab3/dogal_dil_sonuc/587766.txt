twice differenti spectral function function f space n n real symmetr matric call spectral depend eigenvalu argument spectral function symmetr function eigenvalu show spectral function twice continu differenti matrix correspond symmetr function twice continu differenti vector eigenvalu give concis usabl formula hessian b introduct paper interest function f symmetr matrix argument invari orthogon similar transform orthogon u symmetr depart combinator optim univers waterloo waterloo ontario n2l 3g1 canada email aslewismathuwaterlooca research support nserc depart combinator optim univers waterloo waterloo ontario n2l 3g1 canada email hssendovbarrowuwaterlooca research support nserc everi function decompos map give eigenvalu matrix f symmetr function see next section detail call function f spectral function function eigenvalu depend spectrum oper classic interest function aros import role quantum mechan 7 20 nowaday insepar part optim 11 matrix analysi 4 5 modern optim key exampl semidenit program one encount problem involv spectral function like log deta largest eigenvalu constraint must posit denit mani exampl properti spectral function f actual equival correspond properti underli symmetr function f among rstorder dierenti 9 convex 8 gener rstorder dierenti 9 10 analyt 26 variou secondord properti 25 24 23 also worth mention chevalley restrict theorem context identi spectral function polynomi symmetr polynomi eigen valu secondord properti matrix function great interest optim applic newton method interior point method 13 secondord nonsmooth optim condit 19 requir know secondord behaviour function involv mathemat model standard refer behaviour eigenvalu matrix subject perturb particular direct 6 secondord properti eigenvalu function particular direct deriv 25 problem interest us paper spectral function twice dierenti function matrix rather particular direct hessian continu analyt discuss 26 thu result lie sens result 9 26 smooth properti special spectral function largest eigenvalu certain manifold help perturb theori newtontyp method see exampl 15 16 18 17 22 21 14 show spectral function twice continu dierenti matrix correspond symmetr function twice con tinuous dierenti vector eigenvalu thu particular spectral function c 2 restrict subspac diagon matric c 2 exampl schatten pnorm symmetr matrix pth root function eigenvalu matrix see latter function c 2 p 2 although analyt unless p even integ part gener result also give concis easytous formula hessian result 26 analyt function rather implicit paper selfcontain result deriv essenti scratch make use complexvari techniqu 2 ex ampl parallel paper 12 give analog character spectral function quadrat expans point may twice dierenti notat preliminari result follow n denot euclidean space n n symmetr matric inner product ha vector eigenvalu order nonincreas order n denot set nn orthogon matric vector x r n diag x denot diagon matrix vector x main diagon x denot vector entri x order nonincreas order x 1 x n let r n denot set vector x r n x 1 x 2 x n let also dene diag m1 denot sequenc symmetr matric converg 0 m1 denot sequenc orthogon matric describ set r n function r n symmetr invari coordin permut denot function dene open symmetr set properti permut matrix p x 2 domainf denot gradient f rf f 0 hessian r 2 f f 00 vector understood column vector unless state otherwis whenev denot vector r n make convent thu r number distinct eigenvalu dene correspond partit call set block denot standard basi r n e vector entri equal 1 also dene correspond matric arbitrari matrix denot ith row row vector ij denot jth entri final say vector block rene vector b impli need follow result r symmetr function twice dierenti point 2 r n let p permut matrix particular represent r1 e r1 r2 e r2 rr r rr e uv matric dimens ji u j ji v j entri equal ij1 real symmetr matrix b b 1 b n vector block rene j u ident matrix dimens proof appli chain rule twice equal order get part ii deduc block structur hessian consid block structur permut matric p permut row column hessian way dene p must stay unchang use notat lemma dene matrix note 22 make convent ith diagon block represent dimens 1 1 set otherwis valu b k uniqu determin dierenc diagon odiagon element block note also matrix b vector b depend point function f lemma 23 2 r n sequenc symmetr matric mm 0 diag mm proof combin lemma 510 10 theorem 312 3 follow main technic tool lemma 24 let fmmg sequenc symmetr matric converg 0 mm kmm k converg let r n um u 2 n sequenc orthogon matric diag diag mm 2 follow properti hold orthogon matrix u form l orthogon matrix dimens ji l j ji l j l ii 2 l lim p2i l u ip 0 iii j belong block lim u ij iv 2 l l diag x l mx l l v l p 62 l lim u ip 0 vi indic 6 j lim p2i l u ip 0 vii indic 6 j l diag x l mx l l viii three indic j p distinct block lim u ip 0 ix two indic j 2 l lim p2i l u ip ks p2i u ip proof take limit equat 2 left diag describ represent matrix u follow ii let us denot use lemma 23 equat 2 obtain diag diag hm u equival form diag um divid side equat kmm k rearrang diag um diag u diag hm u diag u diag um diag hm notic right hand side equat converg nite limit increas inniti call matrix limit right hand side rst equat l clearli limit second equat u lu go prove part ii iii togeth induct divid orthogon matrix um block structur u begin consid rst row block um let index rst block 1 limit ith entri matrix left hand side equat 4 lim u ip ks p2i u ip recal v 1 orthogon matrix notic idiag x sum equat 6 1 get lim u ip ks u ip 0 notic coecient front k l numer sum zero u ip r u ip us choos number add everi coordin vector thu shift coordin shift vector rst block strictli bigger zero rest strictli less zero comment last limit remain true shift way rewrit last limit shift vector summand posit immedi see must lim u ip lim u ip rst limit written lim u ip summand posit conclud lim u ip second limit impli immedi lim u ip thu prove part ii 2 1 part iii case speci good place say word idea proof said divid matrix um block compli block structur vector exactli part matrix u prove part ii iii element rst row block divis go prove thing rst column block order x index 1 consid ith entri matrix left hand side equat 5 take limit lim u pi ks p2i u pi use also blockdiagon structur matrix u proceed order conclud lim u pi lim u pi readi second step induct let index 2 limit ith entri matrix left hand side equat 4 lim u ip u ip r ks p2i u ip analog sum limit 2 get lim u ip u ip r ks u ip 0 know 8 lim u ip 0 choos number exchang shift version conclud lim u ip lim u ip repeat step second column block matrix um induct exhaust block complet proof part ii iii iv proof part one need consid ith entri right hand side equat 4 diagon left hand side converg zero ii iii take limit prove statement part v part follow immedi part iii vi take limit equat 4 give lim s6l ks p2i u ip p2i l u ip l ij jth entri limit right hand side equat 4 note coecient ks sum zero s6l p2i u ip p2i l u ip um orthogon matrix part v s6l p2i u ip p2i l u ip requir moreov l vii statement part detail way write fact prove previou part l viii part follow immedi part iii fact express part viii ident one part v reiter dierent index condit later conveni ix take limit jth entri matric side equat 4 lim t6l u ip p2i l u ip ks p2i u ip part viii lth sth summand converg zero hand mm diag hm u ij lim diag hm u u j row dierent block diag hm kmm k converg diagon matrix tool prove main result paper 3 twice dierenti spectral function section prove symmetr function f twice dierenti point correspond spectral function f twice dierenti matrix recal hadamard product two matric size matrix elementwis product let symmetr function f r n r twice dierenti point 2 r n dene vector lemma 21 specic index say 2 l l 2 f1 2 rg dene ii ji l pq p 6 q 2 l lemma 21 guarante second case denit doesnt depend choic p q also dene matrix ij notic similar denit classic divid dierenc construct lowner theori see 1 chap v exampl simplic iti argument understood context write b ij follow lemma theorem 11 9 lemma 31 let 2 n suppos belong domain dierenti point f dierenti point case orthogon matrix u satisfi recal standard notion twice dierenti consid function f n r gradient point exist linear function euclidean space n thu identi element n denot rf thu rf map n n map dierenti say f twice dierenti case interpret hessian r 2 f symmetr bilinear function n n r valu particular point denot r 2 f ah particular xed h function r 2 f ah linear function n consid element n breviti denot r 2 f ah hessian continu say f twice continu dierenti case follow ident hold t0 next theorem preliminari version main result theorem 32 symmetr function f r n r twice dierenti point 2 r n f twice dierenti point diag case hessian given henc proof easi see f must twice dierenti point whenev f twice dierenti diag restrict f subspac diagon matric get function f interest case direct let f twice dierenti point 2 r n suppos contrari either f twice dierenti point diag equat 10 fail dene linear oper lemma 31 tell us f least dierenti around diag linear oper 0 sequenc symmetr matric fmm g 1 m1 converg 0 loss gener may assum sequenc fmmg 1 m1 mm kmm k converg matrix subsequ fmm g 1 m1 sure properti let fum g 1 m1 sequenc orthogon matric diag diag mm without loss gener may assum um u 2 n otherwis take subsequ fmmg 1 m1 fumg 1 m1 inequ show everi correspond pair precis least one pair indic j ij least one pair indic call j innit mani number j correspond pair necessari take subsequ fmmg 1 m1 fumg 1 m1 may assum without loss gener pair indic j last inequ hold dene symbol hm equat 3 notic use lemma 31 lemma 23 fact rf dierenti get consid three case everi case go show left hand side inequ 11 actual converg zero contradict assumpt case use equat 12 left hand side inequ 11 less equal diag rf diag r 2 fhm go show summand approach zero goe inniti assum 2 l l 2 f1 rg use fact vector block rene vector rf lemma 21 part rst term written askmmk f 0 l p2i l u ip ss6l ks p2i u ip appli lemma 24 part ii iii last express concentr second term use notat equat 1 r bdiag b term less equal diag diag bh diag bdiag mm approach inniti u dene vector h hm take limit express 13 turn diag bdiag go investig term sum separ show actual equal zero rst use block structur matrix b see lemma 21 block structur vector h obtain r qs tr x use fact 2 l v l orthogon get l diag bh l l diag bhx l l r ls tr x l r ls tr x bdiag show rst term zero second term use block structur vector b write diag next last equal use part iv lemma 24 l diag diag bh l l diag diag bhx l l l diag b k l l mx l l diag bdiag see second term also zero case ii 6 j l l 2 f1 2 rg use equat 12 left hand side inequ 11 becom diag rf use fact block rene vector rf write rst summand askmm k s6l ks p2i u ip l p2i l u ip use part v vi lemma 24 conclud express converg zero left substitut r 2 diag b get diag diag bh recal notat lemma 21 use denot entri matrix b limit rst summand written lim r sl tr x l mx l p2i u ip u jp clearli p2i u ip u rg left follow limit lim diag diag bh use lemma 24 part vii observ right hand side zero case iii 2 l j 2 l 6 use equat 12 left hand side inequ 11 becom o1 diag rf diag r 2 fhm l ks ks start second term limit lim case u nonzero coordin entri u j zero left lim diag rf l ks ks expand rst term limit diag rf l p2i l u ip ks p2i u ip t6l u ip use lemma 24 part viii see third summand converg zero goe inniti part ix lemma tell us lim p2i l u ip ks p2i u ip order abbrevi formula introduc follow notat l p2i l u ip substitut everyth 14 get follow equival limit lim l ks l ks ks l ks simplifi get lim ks l ks ks notic r l um orthogon matrix numer sum product ith jth row next lemma 24 part viii say lim t6l lim complet proof nalli readi give prove full version main result theorem 33 let nn symmetr matrix symmetr function twice dierenti point spectral function f twice dierenti matrix moreov case hessian spectral function matrix w orthogon matrix w diag dene equat 9 henc diag hi proof let w orthogon matrix diagon order fashion let mm sequenc symmetr matric converg zero let um sequenc orthogon matric diag w use lemma 31 get also goe inniti w orthogon matrix kwxw matrix x easi check result theorem 32 4 continu hessian suppos symmetr function f r n r twice dierenti neighbourhood point hessian continu point theorem 33 show f must twice dierenti neighbourhood point section go show r 2 f also continu point dene basi fh ij g space symmetr matric entri matrix h ij zero except jth j ith one one ith posit suce prove hessian continu appli matrix basi begin lemma lemma 41 let 2 r n let symmetr function f r n r twice continu dieren tiabl point let f g 1 m1 sequenc vector r n converg lim proof everi permut matrix pm p see begin section 2 mean bar vector nite mani permut matric name n form n subsequ f g two vector particular subsequ order descend order permut matrix prove lemma everi subsequ done without loss gener may assum p everi xed permut matrix p clearli larg enough consequ matrix p blockdiagon permut matric main diagon dimens match block structur consid block structur vector f g nite mani dierent block structur divid sequenc subsequ vector particular subsequ block structur prove lemma subsequ done without loss gener may assum vector f g block structur everi next use formula hessian theorem 33 lemma 21 togeth theorem 32 give us equat show without loss gener suce prove lemma case vector f g order descend order vector block rene vector case consid four case case lim diag r r 2 f continu case ii 6 j belong block j block well lim r 2 f continu case iii j belong dierent block block lim prove lim ii see denit b begin section 3 everi dene vector conclud sequenc f converg f g 1 appli mean valu theorem twice vector vector notic vector obtain swap ith jth coordin use rst part lemma 21 see f 0 final take limit use continu hessian f point case iv j belong dierent block dierent block lim rf continu denomin never zero readi prove main result section theorem 42 let nn symmetr matrix symmetr function continu dierenti point spectral function f twice continu dierenti matrix proof know f twice dierenti f twice dierenti left prove continu hessian suppos f twice continu dierenti f twice continu dierenti hessian continu take sequenc famg 1 m1 symmetr matric converg 0 let fum g 1 m1 sequenc orthogon matric without loss gener may assum um u u orthogon otherwis take subsequ famg fumg use formula hessian given theorem 33 lemma 41 easili see lim everi symmetr h contradict direct follow chain rule observ complet proof 5 exampl conjectur exampl suppos requir second direct deriv function f point direct b want nd second deriv function w orthogon matrix wdiag aw let dierenti twice use lemma 31 theorem 33 diag rfa diag principl function f analyt second direct deriv also comput use implicit formula 26 work show answer agre nal illustr consid classic exampl power seri expans simpl eigenvalu case consid function f given kth largest entri x matrix function result show follow formula familiar perturb theori quantum mechan agre result 6 p 92 conclud follow natur conjectur conjectur 51 spectral function f ktime dierenti matrix correspond symmetr function f ktime dierenti point moreov f c k f c k r matrix analysi deriv deriv chain rule sensit analysi eigenvalu symmetr matrix matrix analysi topic matrix analysi short introduct perturb theori linear op erat fundament principl quantum mechan convex analysi hermitian matric deriv spectral function nonsmooth analysi eigenvalu eigenvalu optim quadrat expans spectral func tion minim maximum eigenvalu symmetr matrix second deriv optim eigenvalu symmetr matric toward secondord method structur nonsmooth optim wet variat analysi quantum mechan first second order analyi nonlinear semid eigenvalu optim valeur propr de matric sym analyt function involv eigenvalu tr ctr xin chen houduo qi liqun qi koklay teo smooth convex approxim maximum eigenvalu function journal global optim v30 n23 p253270 novemb 2004 lin xiao stephen boyd seungjean kim distribut averag consensu leastmeansquar deviat journal parallel distribut comput v67 n1 p3346 januari 2007