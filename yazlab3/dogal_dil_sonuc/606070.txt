global optim approach unequ sphere pack problem 3d problem unequ sphere pack 3dimension polytop analyz given set unequ sphere polytop doubl goal assembl sphere way overlap ii sum volum sphere pack polytop maxim optim applic autom radiosurg treatment plan formul nonconvex optim problem quadrat constraint linear object function basi special structur associ problem propos varieti algorithm improv markedli exist simplici branchandbound algorithm gener nonconvex quadrat program heurist algorithm incorpor strengthen effici algorithm comput studi demonstr propos algorithm obtain success optim limit size b introduct optim pack unequ sphere 3dimension polytop ana lyze given set unequ sphere polytop object assembl way 1 sphere overlap 2 sum volum pack sphere maxim note convent 2dimension 3dimension pack problem also call binpack problem extens studi 2 7 11 fundament dierent problem consid present work unequ sphere pack problem import applic autom radio surgic treatment plan 12 14 stereotact radiosurgeri advanc medic technolog treat brain sinu tumor use gamma knife deliv set extrem high dose ioniz radiat call shot target tumor area 13 good approxim shot consid solid sphere larg irregular target region multipl shot use cover dierent part tumor howev procedur usual result 1 larg dose inhomogen due overlap dierent shot 2 deliveri larg amount dose normal tissu aris enlarg treat region two shot overlap optim number posit individu size shot significantli reduc inhomogen dose normal tissu simultan achiev requir coverag unfortun sinc treatment plan process tediou qualiti protocol depend heavili experi user fore autom plan process desir achiev goal wang wu et al 12 14 mathemat formul plan problem pack sphere 3d region pack densiti greater certain given level pack problem prove npcomplet approxim algorithm propos 12 work formul question nonconvex quadrat optim present solut method base branchandbound techniqu let k number dierent radii sphere given set r k 1 k correspond radii l avail sphere radiu therefor total number sphere set kl use singl valu l simplic present howev model easili modifi case dierent number l k sphere avail dierent radii r k total number sphere given set let polytop given x z r 3 l maximum number sphere pack design variabl locat sphere pack sphere pack radiu assign variabl ik 1 k use handl task sphere radiu r k preliminari optim formul follow 3 st 2 constraint 1 3 respect ensur two sphere overlap sphere center within polytop constraint 4 5 guarante one radiu chosen sphere ie sphere pack radiu r k sphere radiu r k pack togeth 3 4 5 constraint 2 state distanc center sphere boundari polytop least larg radiu sphere henc 2 3 forc sphere pack insid polytop 3 constraint 2 rewritten 6 sinc righthand side 6 nonneg 6 impli 3 moreov binari 01 variabl ik 5 replac inequ ik ik note ik 1 impli constraint 4 step allow restat problem p1 follow note constant 4 origin object function omit number variabl quadrat constraint 3kl ll1lk respect quadrat function constraint 7 neither convex concav exist sever algorithm 1 9 develop solv gener nonconvex quadrat program nqp short nqp transform semidefinit program problem sdp addit rankon constraint drop rankon constraint one obtain sdp relax problem tightest relax among other 3 henc p2 solv use branchandbound type method base sdp relax howev due rel slow instabl sdp softwar conceptu algorithm impract even problem small size sinc requir mani iter sdp relax commonli method solut nqp class design linear program lp relax approach known reformulationlinear techniqu 10 assumpt addit box constraint variabl new nonlinear constraint gener pair box constraint order construct relax convex area origin nonconvex feasibl region nonlinear term nonlinear constraint accordingli replac new variabl result recast linear program base techniqu linear alkhayy et al 1 propos rectangular branchandbound algorithm solv class quadrat constrain program raber 9 propos anoth branchandbound algorithm problem base use simplic partit element use underestim ane function whose valu vertex simplex agre correspond nonconvex quadrat function work 9 demonstr simplici algorithm often better perform rectangular algorithm respect comput time interestingli raber 9 mention simplici rectangular algorithm exhibit poor perform pack problem give experiment detail obviou pack problem similar much simpler structur constraint paper examin custom raber simplici branchandbound algorithm 9 tailor problem well known underli simplici subdivis key factor influenc qualiti relax therefor ecienc branchandbound algorithm investig structur optim suggest ecient simplici subdivis ii dierent underestim nonconvex function base observ three variant algorithm construct discret natur pack enabl heurist design obtain good feasibl solut outcom lead save comput time memori size remaind paper organ follow section 2 deriv lp relax problem respect simplici subdivis simplici branch andbound algorithm present section 3 section 4 give heurist algorithm section 5 present three variat previou algorithm base use special structur section 6 report comput result propos branch andbound algorithm conclus work present section 7 program relax construct lp relax problem p2 one develop 9 sake complet descript outlin procedur transpos vector first write problem p2 follow form ik r n c r n coecient vector object correspond constraint 7 8 respect av b repres linear constraint 9 10 11 furthermor matrix q il specifi follow il matrix zero entri appropri size 1 1 1 1 correspond coecient 7 l r 2 r 1 r k r 2 r k r 2 r 2 r 1 r k r 2 r k r 2 k correspond 11 1k l1 lk 7 k similarli r 3l3l ik r klkl written follow 0 number linear constraint p2 denot polytop defin linear constraint mn b r construct lp relax problem need repres matrix q il resp sum posit semidefinit matrix c il resp neg semidefinit matrix il resp ik usual spectrum decomposit achiev goal howev need perform task sinc matric q il possess special structur give decomposit immedi readili seen decomposit il satisfi desir properti consid construct linear program relax problem let nsimplex u v vertic let w r nn matrix consist column v point v repres substitut v p2 14 obtain follow equival problem st replac q il 12 13 quadrat term lefthand side constraint 15 16 divid convex concav function replac q il 12 13 respect relax problem construct ignor convex part replac concav part linear underestim function underestim use convex envelop concav function f respect simplex ane function whose valu vertex coincid f precis quadrat constraint 15 v convex envelop w il w respect similar fashion quadrat constraint 17 v convex envelop w ik w respect obvious upper bound object function p3 obtain solv follow lp relax problem 3 simplici branchandbound algorithm simplici branchandbound algorithm present section mention use algorithm 9 prototyp howev two heurist design obtain feasibl solut embed branch oper carri divid current simplex two simplic let v v j two vertic satisfi 2 denot 2norm vector defin simplex split two simplic split simplic properti nest sequenc q simplic detail see horst 4 5 result algorithm present branch bound algorithm step 1 start heuristic1 calcul possibl feasibl solut v f object function valu fv f success set step 11 let construct simplex 0 contain polytop u set solv problem lpr s0 problem infeas origin problem solut stop otherwis let optim solut optim valu 0 set feasibl solut p2 stop otherwis start heuristic2 v 0 calcul feasibl solut v 0 valu fv 0 lb fv 0 set step 12 ub lbub stop k 2 k accord 25 28 set k step 21 solv problem lpr j infeas set let optim solut k optim valu j step 22 v j k feasibl solut p2 set step 23 v j k feasibl run heuristic2 v j k calcul feasibl solut v j valu fv j otherwis select simplex set 2 detail heuristic1 heuristic2 given section 4 paramet give toler solut obtain algorithm call solut obtain algorithm optim solut converg algorithm guarante follow theorem 1 6 8 9 algorithm gener infinit sequenc v k everi accumul point v sequenc optim solut problem 1 algorithm heuristic1 heuristic2 describ section recal heuristic1 find feasibl solut begin branchandbound algorithm heuristic2 gener feasibl solut infeas solut obtain relax subproblem first give algorithm heuristic1 basic idea place mani sphere possibl rel larg radii polytop let c list given set kl candid sphere order r 1 r kl consid 3d triangl defin four constraint arbitrarili chosen polytop p design triangl fix p algorithm start pick sphere top c check whether sphere locat one four corner triangl p procedur continu rest sphere list four sphere place search sphere list exhaust sphere pack satisfi 1that touch exactli three side triangl 2 mutual intersect occur pair sphere see figur 1 3 satisfi constrain p obtain initi pack algorithm attempt insert sphere pair sphere p without violat pack condit see figur 2 phase figur 1 figur 2 step 1 determin center sphere l tangent three plane correspond three constraint p sphere l satisfi constraint polytop p overlap sphere 1 k 1 pack sphere l set step 2 ik l ii l kl k 0 go step 5 step 3 stop otherwis set l1 go step 1 step 4 set l step 1 phase ii step 5 otherwis pair pack sphere j set l 1 repeat step 6 7 step 6 l kl stop otherwis set step 7 locat center sphere l satisfi constraint p overlap sphere 1 k pack sphere l set go step 6 termin algorithm k 0 feasibl pack obtain next describ heuristic2 let solut relax subproblem suppos feasibl either ik integr sphere overlap radiu decid ie use r k radiu sphere see figur 3 follow fix center sphere determin radii mutual overlap see figur 4 note triplet mean sphere place let r 1 r k figur 3 figur 4 heuristic2 step 1 set step 2 sphere l center satisfi polytop constraint overlap sphere 1 l 1 set sphere l center l z l radiu r k go step 4 step 3 k k set 2 otherwis set lk sphere center l z l step 4 l l set l 2 otherwis stop 5 improv algorithm section discuss special structur optim present improv previou algorithm base structur first describ construct initi simplex 51 gener initi simplex start branchandbound algorithm need initi simplex 0 contain polytop u gener follow algorithm gener initi simplex step 1 choos nondegener vertex v 0 polytop u step 2 construct matrix r nn n bind constraint step 3 comput step 4 set remark 1 n constraint decid nondegener vertex v 0 select follow choos three constraint 9 constraint 11 dicult see n coecient vector constraint linearli independ set linear inequ constraint linear equat ie system linear equat determin uniqu solut consid v 0 remark 2 vertex v 0 kl zero entri determin 31 equat 30 replac solut obtain maintain k repeat process equat 30 yield 3l solut index v 1 v 3l solut gener replac denot v 3l1 v n precis 52 split simplex dierent way well known simplici branchandbound paradigm comput time usag memori grow extrem fast dimens polytop u increas simplex split two simplic accord 25 28 length longest among pair vertic simplex vertex v 0 replac vertex v matrix w 1 w except column v v 0 replac column v v 0 similarli column matrix w 2 w except column v j v 0 replac v v 0 recal entri zero matric 12 henc coecient j sil 22 depend first 3l coordin v 0 valu first 3l coordin sil remain unchang constraint 22 subproblem respect simplic j j 1 2 qualiti relax would significantli improv split lead comput subproblem provid neither good lower use upper bound avoid situat choos v v j v maximum among consequ coordin correspond ik consid one neg eect choic qualiti relax constraint necessarili improv howev sinc linear constraint alway consid defect expect seriou accordingli number subproblem decreas whole branchandbound process anoth potenti diculti converg algorithm must address let v vertic q sinc divid simplex minim largest valu v vertic possibl nest sequenc q simplic satisfi 29 case guarante accumul point infinit sequenc obtain algorithm optim solut 53 anoth decomposit matrix q il shown section 2 make underestim quadrat function lefthand side quadrat constraint 7 use decomposit 12 replac 2 ik ik 7 could result dierent matrix il r 2 r 1 r k r 2 r k r 2 spectral decomposit matrix q il provid posit semidefinit neg semidefinit matric dierent given 12 follow procedur similar section 2 c il il posit semidefinit neg semidefinit respect exampl two magnitud radii r 1 r 2 consid c il r klkl construct follow let 2 il r 2r 23r 2s r 2r 23r 2s r 1 r 2 r 2 r 2 r 2 r 1 r 2 r 2 il shown eigenvalu matrix c il nonneg resp nonposit henc two matric desir properti consequ anoth lp relax construct base new spectral decomposit remain chang decomposit 54 anoth form relax section focu dierent form relax problem p2 let us omit quadrat constraint 8 correspond 0 1 condit ik furthermor relax condit two sphere overlap distanc two sphere need greater small posit valu precis consid problem st remark one take smallest valu among radii given set magnitud sinc variabl quadrat p4 convex envelop concav function x x l determin first 3l coordin vertic correspond simplex given impli sucient construct simplic 3ldimension space let initi simplex 3ldimension space contain polytop p ith entri v j ident v j defin similarli q il respect let x submatric correspond follow quadrat program st neg semidefinit matrix convex envelop quadrat term v therefor obtain relax p4 follow sinc constraint 8 ignor constraint 7 relax 42 problem qualiti relax may inferior previou method howev dimens simplic kept memori 3l therefor total memori use may far smaller requir method 6 comput studi section discuss detail implement algorithm report experiment result reoptim suppos simplex branch node simplex divid 1 2 25 28 vertex v 0 replac v column matric w 1 w 2 replac v v 0 respect column remain unchang therefor case two new subproblem gener split 1 2 could use inform optim solut lp relax problem associ construct lp relax problem respect 1 2 coecient correspond j constraint 22 23 chang due substitut column v v 0 w 1 w 2 respect consequ chang coecient could use reoptim techniqu solv lp relax problem start optim solut correspond simplex test problem test problem gener follow first construct simplex vertic 0 0 10 10 0 0 0 10 0 10 10 10 calcul maximum inscrib sphere simplex radiu 288675 randomli gener point surfac sphere construct tangent plane x z pass point respect let z halfspac contain inscrib sphere intersect h simplex 3dimension polytop sphere pack problem consid henc total number linear constraint polytop test set 4 dierent pair radii sphere use shown tabl 12 tabl 1 combin radii c r radiu 6 100 050 tabl 2 combin radii c r radiu comput experi conduct dec alpha 21164 workstat 600mhz use cplex 651 lp solver relax problem limit memori comput time set 512mb 3600 second respect besid prototyp algorithm given section 3 three variat also implement 1 algorithm nss use simplex split given section 52 2 algorithm nmd use matrix decomposit given section 53 3 algorithm xyz use simplex xyz space given section 54 algorithm test 5 instanc pair c r radii tabl 1 sinc three algorithm reach either limit memori limit comput time instanc present result algorithm xyz data shown tabl 47 tabl 10 repres averag result legend use tabl given tabl 3 tabl 47 observ comput time grow drastic number sphere pack increas sinc dimens problem 3 outcom consist observ 1 9 comput time tabl 3 legend use tabl legend mean l maximum number sphere pack c r combin radii lp number linear program solv number case termin caus limit cpu time 3600 second e number case termin number case termin caus limit memori 512 mb time cpu time second ublb ratio valu ub lb ub ub lb upper lower bound object function valu respect algorithm org prototyp algorithm given section 3 algorithm nss algorithm use simplex split given section 52 algorithm nmd algorithm use spectral decomposit given section 53 algorithm xyz algorithm use simplex xyz space section 54 increas exponenti dimens increas big dierenc algorithm org algorithm nmd sens gross behavior algorithm nss solv fewer lp two previous mention algorithm therefor need less time lead solut greater number instanc without violat limit either memori time sinc simplex split base length first 3l coordin avoid solv unnecessari subproblem among algorithm algorithm xyz show best perform instanc solv except case c even success obtain solut half instanc 5 two reason behavior consid first sinc dimens simplic 3l much less memori need keep inform simplic second sinc simplic involv coordin variabl x z simplex split favor characterist algorithm nss fewer lp need solv note dimens instanc solv previou paper 1 9 rang 16 ii comput time memori demand simplici branchandbound algorithm usual increas exponenti dimens problem therefor modest increas dimens could put solut rang contrast sphere pack problem discuss dimens instanc solv algorithm xyz extend henc conclud algorithm xyz gain ecienc sinc take advantag intrins structur problem next let us focu algorithm org algorithm xyz consid influenc polytop p perform five instanc polytop gener randomli number constraint take result shown tabl 89 observ even l c r ident compar behavior algorithm sensit shape polytop behavior aris sinc qualiti solut gener heurist depend shape polytop ii initi simplex 0 depend polytop skinni polytop volum 0 p 0 would larg fact mean algorithm copious wast eort solv lp defin zone reach optim solut tabl show result three valu radii consid ie valu k eect number quadrat constraint 8 ii increas number quadrat constraint enhanc diculti problem compar case result tabl 7 observ big chang number lp solv algorithm less sensit valu k size l occur sinc number quadrat constraint 7 8 grow increas l final algorithm exhibit reduc perform c name dierenc radii larg conclus paper consid optim unequ sphere pack demonstr improv exist simplici branchandbound algorithm advantag use intrins structur problem special comput studi show improv algorithm xyz could solv instanc much larger size observ optim solut found mani instanc algorithm reach limit either comput time memori signal tabl 4 result algorithm org time e algorithm spend larg amount eort verifi optim solut turn behavior indic 1 develop improv method relax necessari solv problem larger size 2 algorithm termin solut obtain high qualiti 3 better heurist method could start feasibl solut obtain branchandbound algorithm would import obtain approxim solut larger problem tabl 5 result algorithm nmd time e tabl result algorithm nss tabl 7 result algorithm xyz time e tabl 8 result algorithm org time tabl 9 result algorithm xyz time tabl 10 result algorithm xyz time e r relax method nonconvex quadrat constrain quadrat program semidefinit program relax nonconvex quadrat program gener bisect nsimplic handbook global optim global optim determinist approach siam journal comput ing global optim action simplici branchandbound method solv nonconvex quadrat program new reformulationlinear techniqu bilinear program problem strippack algorithm absolut perform bound 2 pack unequ sphere autom radiosurg treatment plan ning physic dosimetri gamma knife tr threedimension pack gener bisect italicnitalicsimplic strippack algorithm absolut perform bound 2 simplici branchandbound method solv nonconvex allquadrat program