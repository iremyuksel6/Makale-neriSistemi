bound error estim radios present method determin posteriori bound estim local total error radios solut abil obtain bound estim total error crucial fro reliabl judg accept solut realist estim local error improv effici adapt radios algorithm hierarch radios indic adapt refin necessaryfirst describ hierarch radios algorithm comput conserv lower upper bound exact radios function well approxim solut bound account propag error due interreflect provid conserv upper bound error also describ nonconserv version algorithm capabl comput tighter bound realist error estim obtain final deriv express effect particular interact total error yield new errordriven refin strategi hierarch radios shown superior brightnessweight refin b introduct past decad radios becom method choic simul global illumin environ consist entir lambertian ideal diffus reflector emitt global illumin environ govern fredholm integr equat second kind z kx ybi dy 1 email danix be dpggraphicscornelledu bx total radios point x ex emiss aex reflect 1 kernel integr oper xy describ pointtopoint transfer x x angl surfac normal line connect x r xy distanc two point vx 1 visibl x 0 otherwis radios algorithm comput approxim solut b bx equat 1 project continu integr equat finit dimension function space radios algorithm use space piecewis constant function although recent sever investig describ radios algorithm use higher order basi function 12 21 22 project continu equat result discret system n linear equat n dimens finit dimension space sinc radios algorithm produc approxim result reliabl error bound realist error estim crucial assess accept particular solut well automat adapt refin theori integr equat 1 10 provid priori error analysi comput method fredholm equat second kind gener framework valuabl analyz convergencer 10 boundingvari compon error term correspond oper norm 3 howev priori error bound typic pessimist often difficult evalu requir inform oper exact solut may avail paper discuss posteriori method bound combin effect variou error sourc particular instanc problem analysi take place comput solut method provid tighter bound easili 1980 issu posteriori error estim automat adapt refin receiv consider attent finit element literatur 4 19 work relat partial differenti equat recent result becom avail also boundari integr equat andboundaryel method 5 essenti similar radios method radios literatur howev littl written regard posteriori error analysi particular current radios algorithm provid user neither guarante bound total error function norm k delta k reliabl 1 quantiti depend wavelength simplic restrict discuss singl wavelength throughout paper estim total error goal paper address defici begin brief account past attempt estim error radios approxim section 3 describ algorithm comput two piecewis constant function guarante bound exact solut bx done simultan comput approxim solut b bx bound pertain bx b bx use comput conserv upper bound error algorithm resembl gener bracket techniqu suggest brown 6 util special properti equat 1 produc tighter bound mani instancesa conserv error bound requiredor pessimist good error estim prefer section 4 describ nonconserv bound algorithm comput tighter bound longer guarante contain exact solut bx everywher nonconserv bound much cheaper comput result realist error estim ie estim closer actual error final contribut deriv express describ effect particular interact total error bound express use boundson import radios comput use algorithm give rise new errordriven refin strategi hierarch radios shown superior brightnessweight refin cohen adapt subdivis algorithm 8 view first attempt posteriori error estim algorithm element subdivid radios differ neighbor certain threshold thu differ radios adjac element treat indic local error note heurist may fail identifi element subdivid conserv approach describ campbel 7 use numer optim find minimum maximum radios element differ extrema use criterion adapt subdivis among variou radios methodshierarch radios hr come closest bound error solut bound comput error interact link patch hanrahan et al 13 comput approxim upper bound formfactor correspond link use obtain approxim upper bound transfer energi smit et al 17 obtain estim error interact point sampl kernel function area two interact patch differ maximum minimum valu thu obtain taken error form factor error estim less conserv hanrahan gener accur given error estim link environ one approxim total error patch sum error associ link howev take account propag error parallel propag light sever error estim techniqu survey cohen wallac 9 techniqu canb classifi two group compar approxim higher order approxim ii comput residu z dy comput expens provid foolproof subdivis criteria 3 radiositybound algorithm simplic start radiositybound algorithm full matrix radios later section extend algorithm work within effici radios algorithm name hierarch radios goal bound algorithm comput two piecewis constant function bx bx bound exact radios bx respect word given discret environ set n element roughli achiev replac coeffici discret linear system 2 infima supremabound correspond continu function area element 31 comput lower bound infima reflect emi sion respect also let f ij denot infimum pointtoarea formfactor point z let k lower bound vector obtain solv linear system n equat use standard method jacobi gaussseidel iter proof easi see matrix gamma k strictli diagon domin follow 11 spectral radiu k strictli less 1 thu invers matrix express neumann seri solut vector b written altern b express limit seri vector b k defin recurr relat note correspond jacobi iter matrix nota tion easi see induct b k lower bound radios k light bounc therefor limit b lower bound total radios function bx 2 32 comput upper bound unfortun use straightforward approach comput upper bound let k defin way k except suprema taken instead infima matrix gamma k necessarili diagon domin entri k upper bound formfactor thu sum absolut valu entri row gamma k exceed 1 case iter solut method jacobi gaussseidel could diverg furthermor possibl gamma k singular describ iter algorithm transform k strictli diagon domin matrix k solut linear system equat vector upper bound solut b comput simultan transform k k algorithm start form matrix k perform jacobi iter use modifi matrix sum formfactor given element exceed 1 zero element row k formfactor correspond remain nonzero entri sum 1 ensur modifi matrix still yield upper bound current light bouncew zero entri correspondingto dimmest element sinc bright order element may chang one iter anoth differ entri matrix may zero iter howev iter converg solut b order element becom fix point obtain k precis iter sort current solut vector order decreas bright permut column matrix accordingli entri solut vector updat l l largest index row shown induct iter sort describ upper bound radios k inter reflect thu iter converg converg total upper bound radios function bx proof prove converg must examin behavior entri solut vector algorithm progress entri matrix k nonneg b 0 set e entri solut vector increas iter ie b k allow formfactor row exceed 1 entri b k bound emax maximum emiss ae max maximum reflect environ elementari analysi know monoton increas seri bound must converg sinc vector b k finit dimens follow vector sequenc converg 2 gatherlowerboundsnod lower foreach link 2 nodelink lower noderho linkfmin linksourcelow end isleafnod els foreach child 2 nodechildren gatherlowerboundschild lower end gatherupperboundsnod contriblist foreach link 2 nodelink add pair linkfmax linksourceupp contriblist end isleafnod foreach pair ff upper 2 contriblist ffsum ff nodeupp noderho ff upper els break end els foreach child 2 nodechildren gatherupperboundschild contriblist end figur 1 pseudocod gather lower upper bound 33 radiositybound algorithm hr algorithm section 31 32 present context full matrix radios algorithm involv comput bound formfactor therefor practic howev modifi work effici within hr framework requir chang standard hr algorithm need comput store upper lower bound fmin fmax formfactor associ link gather push pull radios bound way similar patch radios see figur 1 note gather push pull perform singl sweep hierarchi thu bound updat place make gaussseidel iter iter converg faster jacobi iter use previou hr algorithm speedup appli comput bound comput radios well gather upper bound bit involv gather lower bound seen pseudocod figur 1 gatherupperbound essenti push link leav sort accord bright correspond sourc node upper bound leaf node updat use equat 3 one undesir featur algorithm sort link impli ok log work must done updat upper bound leaf node k number contribut link howev complet sort avoid case sort necessari sum contribut formfactor exce 1 even dimmest sourc must remov list done effici use heap data structur deletemin oper tarjan 20 provid detail descript data structur 34 bound formfactor thu far assum bound f ij f ij avail us obtain know analyt way comput bound thu must resort numer optim find minimum maximum valu pointtopolygon formfactor point j numer method discuss detail campbel 7 method gener requir comput formfactor gradient presenc occlud done either use finit differ analyt describ arvo 2 current implement estim formfactor bound evalu analyt pointtopolygon formfactor 18 center vertic receiv patch partial occlud case analyt formula appli visibl part sourc 16 upper lower bound formfactor set maximum minimum valu bound conserv element decreas size pointtoarea formfactor function becomesmonoton element heurist yield accur bound particularli sowhena discontinuitydriven subdivis strategi 15 employ plot figur 2 3 4 show piecewiseconst bound function comput hierarch bound algorithm three simpl environ shown figur 5 exact radios function also plot three case function plot along dot line across floor environ bound figur 2 found singl iter sinc interreflect environ error propag bound tight fact tighter piecewis constant bound possibl element use figur 3 4 show two case interreflect result looser bound due error propag illustr figur boundscomputedbi algorithm becom tighter accuraci solut increas note radios function bound symmetr correspond environ reflect left wall higher right wall obtain bound radios element obtain upper bound local error assum the050607radios bound exact figur 2 upper lower bound configur shown figur 5a smooth curv middl exact radios coars fine exact figur 3 nest lower upper bound correspond two hr solut configur figur 5b one solut coars fine smooth curv middl exact radios function0206114 radios coars fine exact figur 4 nest lower upper bound correspond two hr solut configur figur 5c one solut coars fine smooth curv middl exact radios function b c figur 5 three simpl test case direct illumin b interreflect without occlus c interreflect occlus surfac grey reflect 03 07 approxim radios b lie halfway b b error l1 l 1 l 2 norm r r howev error bound repres worst case scenario give accur error estim even bound radios tight figur 2 realist estim obtain assum valu bx uniformli distribut b b assumpt l 1 l 2 norm error estim comput local error estim leav hierarchi estim pull root hierarchi combin obtain estim total error error parent node sum children error l 1 norm maximum children error l1 norm norm squar children error sum squar root sum taken 41 obtain tighter nonconserv bound conserv algorithm produc bound quit loos even simpl environ result pessimist error esti mate practic purpos good nonconserv error estim could prove use conserv error bound quot delv moham 10 given two error estim equal realism equal cost given one also bound would clearli prefer bound practic bound usual prove expens pe simist user usual prefer cheaper realist error estim recogn accept estim sometim err side optim present way comput tighter although conser vativ bound radios error estim comput radios bound guarante error bound much closer true error comput tighter bound approxim equival first set b b b b perform singl gather iter environ use gatherlowerbound gatherupperbound routin one iter perform error propag longer account comput significantli simpli fie conserv estim obtain use two iter yield tradeoff speed conserv two addit chang algorithm use produc even tighter bound first instead bound formfactor separ sum bound directli bound radios contribut node link contribut evalu center vertic patch extrema valu use bound second set nodelow nodeupp areaweight averag children bound rather minimum maximum respect 42 result test qualiti error estim comput extrem fine radios solut three environmentsin figur 5 floor polygon eachenvironmentwassampledon 400 400 grid serv refer comput seri radios solut variou degre accuraci environ floor polygon sampl differ solut refer solut comput differ refer measur error solut two error estim comput one conserv bound tighter nonconserv bound case equat 4 7 8 use estim error figur 6 show plot error estim togeth measur error three test case left column correspond l1 norm right column l 1 norm error plot l 2 norm given sinc look almost exactli l 1 plot test case top pair plot correspond figur 5a conserv nonconserv bound algorithm yield bound therefor correspond error estim alway l1 norm estim follow tightli measur error l 1 norm give realist upper bound remain two case signific differ two type error estim l1 norm nonconserv estim alway yield bound error see lower left plot l 1 norm estim bound measur error conserv error estim much pessimist nonconserv counterpart h element size conserv nonconserv h element size conserv nonconserv h element size conserv nonconserv h element size conserv nonconserv h element size conserv nonconserv h element size conserv nonconserv measur figur estim measur error function element size three environ shown figur 5 top row correspond figur 5a middl row 5b bottom row 5c l1 error shown left l 1 error right type estim becom closer measur error accuraci solut increas estim measur error vari linearli element size h expect piecewiseconst approxim origin hierarch radios algorithm 13 adapt improv accuraci solut estim error associ link link error estim exce given threshold ffl refin solut recomput specif hanrahan et al suggest refin link estim upper bound transfer energi exce ffl link refin subdivid node greater formfactor seen center node strategi refer brightnessweight refin give prioriti link transfer energi bright sourc make two observ respect brightnessweight refin link carri largest amount energi necessarili one greatest error transfer energi ii due propag error refin link node j reduc error patch may also reduc error patch receiv light thu make benefit link refin prioriti given link greatest effect total solut error first observ suggest use estim link formfactor error rather use upper bound formfactor error transfer energi given address second observ deriv express relat dk ij overal valu upper bound overal error l 1 norm done use concept import 51 import linear function recal import shall denot z solut adjoint transport equat 14 17 adjoint real matrix context radios receiv vector dual emiss vector e linear function f b radios express inner product r b r give contribut b valu f b shown 17 thu ith element import vector give contribut made unit emiss patch valu r b note entri vector non neg valu l 1 norm given linear function vector patch area deriv main result section express relat link error dk error emiss term z dkb sum link valu sum link formfactor error dk ij weight lower bound import receiv z upper bound radios sourc b j intuit upper bound incorrect radios patch receiv patch j z give contribut incorrect radios total error bound z e term give effect nonconst emiss total error bound proof let k system lower boundson radios adjoint equat written upper bound system written note follow term dk follow rel brightnessweight errordriven figur 7 rel l 1 error function number link brightnessweight vs errordriven refin substitut equat 10 express eequat 9 exact express relat error transfer energi valu linear function r particular express appli viewdepend function use smit et al 17 thu express smit et al use assess viewdepend error view approxim conserv bound 52 new refin strategi equat suggest new errordriven refin strategi hr strategi refin link z sinc link greatest effect total error bound order evalu express link routin gatherlowerbound must modifi solv lower bound import addit lower bound radios chang straightforward significantli increas amount work done routin refin link receiv node sourc node j need decid node subdivid obtain greatest reduct error use follow heurist node subdivid node j subdivid otherwis intuit mean subdivid receiv error due nonconst formfactor greater error due nonconst radios sourc 53 result implement brightnessweight errordriven refin strategi test simpl environ shown figur 5c plot figur 7 show measur rel error floor decreasesa function number link plot demonstr clearli errordriven refin much effici capabl achiev much smaller error use fraction link requir brightnessweight refin similar result observ sever test case 6 conclus describ hierarch radios algorithm comput conserv bound exact radios function simultan comput approxim solut contrast previou attempt estim error radios algorithm properli account propag error due interreflec tion provid conserv upper boundson error also present nonconserv version algorithm provid tighter bound realist error estim final deriv new errordriven adapt refin strategi hierarch radios significantli outperform bright weight refin hope result describ paper prove use reliabl imag synthesi also field similar integr equat aris exampl includ radi heat transfer illumin engin remot sens field numer accuraci result even crucial imag synthesi much work need posteriori error analysi radios instanc need techniqu effici comput reliabl tight bound formfactor perhap use tool irradi jacobian 2 also would like extend techniqu describ paper higher order basi function abl bound exact radios function bound necessarili appli higher order approxim may exhibit oscil 22 even approxim contain within bound equat 7 8 probabl produc pessimist error estim sinc assum approxim piecewiseconst prior render imag radios solut usual project onto new set basi function typic piecewiselinear piecewisequadrat 15 need analyz effect project error order extend error estim solut imag final would like emphasizeth need develop perceptu error metric imag synthesi fast convergencein quantit error metric l 1 norm necessarili impli fast converg result imag perceiv human observ thu expect perceptu errordriven refin strategi would appropri imag synthesi acknowledg special thank go jim arvo without encourag advic paper would written would also like thank richard lobb charli van loan help discuss review manuscript comment provid anonym review help greatli improv paper work support nsf grant interact comput graphic input display techniqu ccr8617880 nsfdarpa scienc technolog center comput graphic scientif visual asc8920219 gener donat equip hewlettpackard r converg error bound approxim solut integr oper equat irradi jacobian partial occlud polyhedr sourc framework analysi error global illumin algorithm adapt finit boundari element method upper lower bound solut integr equat brock effici radios approach comput method integr equat loan matrix computa tion rapid hierarch radios algorithm adjoint function physic basi variat perturb theori transport diffus problem greenberg combin hierarch radios discontinu mesh salesin importancedriven radios algorithm new simpler formul radi angl factor max radios algorithm use higher order finit element tr data structur network algorithm comput method integr equat rapid hierarch radios algorithm importancedriven radios algorithm model global diffus illumin imag synthesi radios realist imag synthesi combin hierarch radios discontinu mesh radios algorithm use higher order finit element method galerkin radios wavelet radios framework analysi error global illumin algorithm irradi jacobian partial occlud polyhedr sourc ctr robert garmann heinrich mller comput complex hierarch radios comput scienc perspect springerverlag new york inc new york ny fraoi sillion georg drettaki featurebas control visibl error multiresolut cluster algorithm global illumin proceed 22nd annual confer comput graphic interact techniqu p145152 septemb 1995 pellegrini mont carlo approxim form factor error bound priori proceed eleventh annual symposium comput geometri p287296 june 0507 1995 vancouv british columbia canada jame arvo irradi jacobian partial occlud polyhedr sourc proceed 21st annual confer comput graphic interact techniqu p343350 juli 1994 hualin zhou min chen mike f webster compar evalu visual experiment result use imag comparison metric proceed confer visual 02 octob 27novemb 01 2002 boston massachusett wu enhua wang wenp interleav radios journal comput scienc technolog v17 n1 p18 januari 2002 wolfgang heidrich philipp slusallek hanspet seidel sampl procedur shader use affin arithmet acm transact graphic tog v17 n3 p158176 juli 1998 frdo durand georg drettaki claud puech visibl skeleton power effici multipurpos global visibl tool proceed 24th annual confer comput graphic interact techniqu p89100 august 1997 franoi x sillion unifi hierarch algorithm global illumin scatter volum object cluster ieee transact visual comput graphic v1 n3 p240254 septemb 1995 volevich karol myszkowski andrei khodulev edward kopylov use visual differ predictor improv perform progress global illumin comput acm transact graphic tog v19 n2 p122161 april 2000 cyril soler f x sillion texturebas visibl effici light simul acm transact graphic tog v19 n4 p302342 oct 2000 doug l jame dinesh k pai artdefo accur real time deform object proceed 26th annual confer comput graphic interact techniqu p6572 juli 1999 georg drettaki eugen l fium structur penumbr irradi comput ieee transact visual comput graphic v2 n4 p299312 decemb 1996 frdo durand georg drettaki claud puech fast accur hierarch radios use global visibl acm transact graphic tog v18 n2 p128170 april 1999 kavita bala juli dorsey seth teller radianc interpol acceler boundederror ray trace acm transact graphic tog v18 n3 p213256 juli 1999