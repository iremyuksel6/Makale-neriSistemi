partial evalu view mani databas applic environ mediat heterogen databas sourc data wareh decis support lead complex queri queri often nest defin previous defin view may involv union good reason one might want remov piec subqueri subview queri subview queri may effect cach previou queri may materi viewssemi may known evalu empti reason integr constraintssemi may match protect queri secur evalu usersin paper present new evalu strategi respect queri defin view call tupletag allow effici remov subview queri approach rewrit queri subview remov effect gone evalu rewritten queri tupl tag evalu rewrit origin queri necessaryw describ formal discount queri queri subview mark consid remov present tupl tag algorithm evalu discount queri provid analysi algorithm perform present experiment result result strongli support tupletag algorithm effici mean effect remov subview view queri evalu viabl optim strategi certain applic experi also suggest rewrit techniqu may perform wors evalu origin queri much wors tupl tag approach b introduct 11 motiv object mani current databas applic environ mediat heterogen databas sourc data wareh decis support incur complex queri queri often nest defin previous defin view may involv union special type queri call fusion queri selfjoin view defin union discuss 25 necess mediat view metaschema defin combin data dispar sourc environ view definit mainten paramount import mani reason one might want remov piec subqueri given queri let us call subqueri unfold queri unfold via view definit specif subqueri reason includ follow 1 unfold queri may effect cach previou queri 5 9 may materi view 16 2 unfold may known evalu empti reason integr constraint 1 3 3 unfold may match protect queri secur evalu user 22 4 unfold may subsum previous ask queri interest 5 unfold share two queri except differ oper remov queri oper carri e figur 1 andor tree represent origin queri mean remov unfold queri modifi queri subsumeand thu evalu never evaluateth remov unfold subsum everyth els origin queri case 1 one might want separ certain unfold evalu much less expens network distribut environ evalu local remaind queri evalu independ find remain answer 5 remaind queri less expens evalu origin optim case 2 unfold free evalu sinc known advanc must evalu empti case 3 unfold protect mean rest queri safe evalu case 4 user ask seri queri may interest stream answer return previous seen answer longer interest case 5 except queri might optim techniqu consid follow exampl exampl 1 let six relat defin databas db departmentsdid address insti tutesdid address facultyeid rank staffeid posit health inseid premium provid life inseid premium provid also three view defin term relat creat view creat view creat view academ unit employe benefit select address select eid select eid premium provid depart faculti life in union union union select address select eid select eid premium provid institut staff health in defin follow queri q q select eeid academ unit employe e benefit b adidedid eeidbeid bproviderblu cross queri q repres pars tree relat algebra represent andor tree shown figur 1 ignor breviti explicit represent project select oper evalu queryin order oper specifi relat algebra representationi equival materi node queri tree type evalu represent refer bottomup assum follow queri f ask result store cach select eeid depart faculti f life in l ddidfdid feidleid lproviderblu cross figur 2 andor tree represent modifi queri equival assum formula repres materi view match protect queri whose answer display f protect queri join express comput evalu thu elimin queri otherwis f cach queri materi view may still benefici remov queri call result discount queri one way achiev rewrit q union join base tabl remov join repres f explicitli present final evalu remain join express may ineffici howev number join express remain evalu may exponenti size collect view definit furthermor shown 11 evalu plan often call topdown may requir evalu join mani time incur expens given tupl may comput mani time whenev project part base tabl overlap significantli topdown evalu q figur 1 union eight follow join express depart 1 faculti 1 life in depart 1 faculti 1 health in depart 1 staff 1 life in depart 1 staff 1 health in institut 1 faculti 1 life in institut 1 faculti 1 health in institut 1 staff 1 life in institut 1 staff 1 health in seemingli effici evalu plan discount queri devis rewrit queri number oper union join minim see figur 2 side effect approach redund join evalu well redund answer comput reduc howev redund entir elimin exampl join institut 1 faculti comput twice implicitli left subtre explicitli right subtre one verifi rewrit queri tree remov join depart 1 faculti in yet guarante time redund comput join thu optim queri sometim cost evalu origin queri experiment result show see section 4 inde case exampl paper present new strategi partial evalu queri defin view call tupletag offer mani advantag explicit queri rewrit ffl tupletag easili implement logic level accomplish rewrit sql express queri ffl techniqu modular implement independ optim stage particular tradit relat databas queri optim work conjunct stage ffl tupletag algebra rewrit queri preserv queri tree thu scale complex queri ffl tupletag interleav queri evalu thu reliabl heurist devis employ decid stepwis whether given optim step appli paper organ follow section 2 present formal framework discount queri section skip first read section 3 present tupletag techniqu evalu discount queri perform analysi techniqu experiment result tpcd benchmark databas db2 present section 4 section 5 conclud issu futur work 12 relat work substanti bodi research rewrit base queri optim 4 6 7 19 howev techniqu discuss literatur consid rewrit queri logic equival form differ goal one consid interest gener effici evalu queri view unfold remov thu result queri equival origin queri problem address also differ problem answer queri use materi view 2 14 16 20 latter problem goal replac subqueri queri view queri gener queri equival contain origin queri goal remov precis avoid evalu part queri optim secur reason work close relat work 15 author consid queri involv nest union oper propos techniqu rewrit queri known join evalu part queri empti techniqu appli howev simpl class queri complex issu address anoth research area relat problem multipl queri optim 21 goal optim evalu set queri rather singl queri sinc queri set arbitrari may relat structur way allow use techniqu propos develop techniqu multipl queri optim focus toward find reus common subexpress across collect queri heuristicsbas problem queri tree rewrit purpos optim also consid context deduct databas recurs 12 problem detect elimin redund subgoal occurr proof tree gener program presenc function depend discuss 13 residu method 1 extend recurs queri investig comput complex queri rewrit 10 show optim rewrit queri nphard also identifi special class queri unfold rewrit result simpler queri thu alway provid optim discount queri section formal defin notion unfold discount queri precis use notat datalog 24 write queri set atom interpret conjunct atom instanc fa e bg repres queri exampl 1 1 atom may intension written view predic defin base tabl predic perhap view definit 2 given queri set q u call u 1step unfold queri set q respect databas db iff given q 2 q rule ha b defin view q j gener unifi 17 present proposit exampl simplic sake extend obviou way queri variabl made explicit e l h 1 2 1 2 1 2 figur 3 andor tree exampl 1 two unfold mark denot u 1 q call u 1 simpli unfold q written u 1 q iff finit collect queri set u unfold u call extension iff everi q 2 u atom q refer base tabl call unfold intension otherwis word atom refer view exampl 3 view exampl 1 repres simplifi datalog letter repres atom e f b l e b h sinc b queri q unfold l use singl rule hb li fa e lg one 1step unfold q sinc atom unfold f q f l extension extension unfold q easi see unfold andor tree inscrib queri andor tree atom unfold mark queri tree shown figur 3 unfold say bg queri consid equival union extension unfold defin unfold q set extension unfold q defin concept discount queri repres queri unfold remov discount definit 4 given queri set q unfold u q express qnfu discount queri defin mean unfold unfold u call u unfoldingstodiscount tupl answer set unfold tuplestodiscount exampl 5 consid queri q exampl 1 sinc fd f lg fd f hg fd lg fd hg fi f lg fi f hg fi lg fi hg fd f lg fd f hg fd lg fd hg fi f lg fi f hg fi lg fi hg similarli unfold g fi bg figur 3 fd f hg fd f lg fd lg fd hg fi f lg fi f hg lastli fd f hg fd lg fd hg fi f lg fi f hg discuss formal semant discount queri 8 3 tupletag evalu strategi 31 overview strategi bottomup materi strategi queri tree union join oper modifi account discount unfold strategi ensur two thing ffl tupl result unfoldingtodiscount contribut answer set discount queri ffl join repres unfoldingtodiscount never fulli evalu tupl result unfoldingtodiscount remov either actual queri evalu ensur second properti thu gain optim need somehow avoid evalu unfoldingstodiscount prevent tupl materi queri evalu propos method tupletag keep extra inform temporari tabl creat materi queri tree essenc tabl extra column unfoldingto discount domain tag column boolean valu tag column given tupl true tupl deriv correspond unfoldingtodiscount fals otherwis union join oper creat new temporari tabl tag column valu must maintain properli exampl 6 consid queri q exampl 1 queri f repres unfoldingtodiscount join depart faculti life in tabl new column cf ad valu initi true similarli tabl institut staff health in union tabl column ad valu initi fals keep deriv inform tupl evalu easili ensur first properti evalu queri select tupl fals valu tag column also project away tag column shall abl use tag columnsand ultim satisfi second propertyto determin join oper tupl join result tupl would unfoldingtodiscount comput save primarili depend size true section tabl present evalu strategi two version simpler version ensur first properti final answer set contain tupl aris sole unfoldingstodiscount strategi use case unfold remov secur reason littl howev optim queri evalu gross save equal differ cost write back result origin queri versu cost write back result discount queri sometim new tag column needbi basi u 2 u add column cu instanti valu cu true u cu belong tb add column cu instanti valu cu tb fals union two tabl union tln trn creat tn algorithm 1 modifi union oper significantli smaller save substanti queri result sent network second version remov tuplestodiscount queri evalu soon possibl strategi reduc cost queri evalu version algorithm requir modifi union join oper defin next 32 modifi union oper assum queri tree contain union join node oper implicit furthermor without loss gener assum tree binari refer one child branch nonleaf node n binari queri tree ln left child rn right child assum leaf n queri tree correspond tabl databas answer set n deriv tabl perhap temporari databas via select project call n tabl select project implicit tn handl discount queri modifi tradit algorithm bottomup queri evalu involv replac union join oper special version handl exploit tag column unfoldingstodiscount discuss given discount queri qnfu introduc new column cu tag column correspond unfoldingsto discount describ exampl 6 assum wellform queri tree tabl union union step union compat addit tag column could violat two tabl union may unioncompat tag column thu need modifi union step first make tabl unioncompat ad tag column need algorithm 1 show way need modifi union step note algorithm 1 effici implement sql ad tag column initi valu execut union oper show section 4 add littl overhead cost queri execut 33 modifi join oper must assign correct valu tag column join tabl tupl result join one tupl deriv given unfoldingtodiscount u henc valu cu true second tupl henc valu cu fals result tupl answer set u cu result tupl valu fals tupl join deriv u result tupl column cu set true thu tag conjunct combin let n join node queri tree children ln rn let u unfoldingsto discount tag column cu tabl tln trn modifi join oper execut node n modifi ad follow assign statement 2 unfoldingtodiscount u exampl 7 consid final join queri exampl 1 three join tabl academ unit employe benefit contain extra column cf store valu unfold todiscount f column introduc execut union oper describ algorithm 1 queri modifi join oper follow select eeid acf ecf bcf cf academ unit employe e benefit b adidedid eeidbeid bproviderblu cross modifi union join oper influenc except ad extra column final answer set queri purpos keep trace inform unfoldingstodiscount via tag column last step tupletag algorithm first version consist use inform select tupl known deriv unfold unfoldingtodiscount ensur suffici select tupl valu fals tag column show tupletag algorithm modifi union join oper correct prove need show tupl tupl valu true tag column given unfoldingtodiscount final answer set queri tupl answer set unfold theorem 8 let qnfu discount queri let denot answer set tabl repres result evalu qnfu use tupletag algorithm tupl proof assum without loss gener unfoldingstodiscount extension intension unfold alway repres union extension unfold let unfold u join consid tupl mark true column unfold u cu true assum 62 initi valu set modifi union oper cu true r thu least one fals valu cu chang fals remain sometim evalu join contradict assumpt henc 2 2 statement per sql92 standard 18 perform requisit logic and tag column introduc tag column back new tabl f benefit academ unit employe institut figur 4 final join queri exampl 9 assum initi true r sinc modifi join oper assign conjunct valu cu join tabl cu remain true durat evalu process note modifi union oper never chang valu tag column henc cu 34 optim state section 31 remov tuplestodiscount final queri answer set accord optim describ gener improv effici queri evalu complex queri howev remov execut queri evalu final answer set produc word push select fals tag column queri tree constitut tupletag algorithm second version consid follow exampl exampl 9 let queri exampl 1 unfoldingtodiscount mark 2 figur 3 thu tupl join intitut 1 staff 1 benefit remov queri answer set let us assum final join queri academ unit 1 employe 1 benefit execut specifi queri tree left right consid result evalu academ unit 1 employe tupl result join valu true column c g see figur 4 tupl tabl benefit valu true column tabl part unfoldingtodiscount g thu tupl mark true result join academ unit 1 employe remain true join benefit henc remov final queri answer set 3 elimin soon academ unit 1 employe evalu note provid optim size one tabl input final join decreas gross save achiev optim estim cost join result institut 1 staff benefit mark dot line figur 4 introduc notion close unfoldingtodiscount node queri tree definit 10 unfoldingtodiscount u close node n respect binari queri tree qt tupl mark true tn contribut tupl u 3 final tupletag queri plan would even need add tag column cg benefit reason thu node repres join academ unit 1 employe close node unfoldingto discount g exampl 9 cours root queri tree close node unfoldingstodiscount next prove theorem specifi method identifi close node queri tree theorem 11 unfold u close node n respect binari queri tree qt everi node u reach root qt join node subtre root n proof consid node u lie n none node contain column u sinc none tabl use union join node node queri tree root column never creat tupl tabl henc tupl tabl repres node n could contribut chang valu column cu join evalu tabl repres node u thu tupl valu true unfold close n remov immedi tabl tn materi 2 sinc may sever close node given unfold use identifi first one sequenc oper specifi queri tree order elimin tuplestodiscount soon possibl condit properti simpl n close node u u close node subtre root n n first close node u tupletag algorithm util describ exampl 9 exist close node elimin unfoldingstodiscount also provid optim experiment result confirm inde case perform analysi 41 experi purpos experi threefold 1 evalu overhead queri evalu time introduc tupletag algorithm modif union join oper 2 compar perform tupletag versu queri rewrit techniqu elimin unfold todiscount 3 evalu optim queri execut tupletag use tpcd benchmark databas size 100mb experi detail benchmark see 23 instal db2 windowsnt order abl defin view union modifi slightli tpcd schema thu three tabl supplier partsupp lineitem base tabl tpcd schema partit horizont half new base tabl repres subtabl supplier1 supplier2 forth creat view supplier v partsuppv lineitemv defin union supplier1 supplier2 partsupp1 partsupp2 lineitem1 lineitem2 respect thu view exactli content origin tabl tpcd benchmark databas test sever version follow three queri select supplierv partsuppv p supplierv partsuppv p ssuppkeypsuppkey ssuppkeypsuppkey select 1 1 1 3 2 2 2 figur 5 queri tree q 2 mark unfoldingstodiscount supplierv partsuppv p ssuppkeypsuppkey ppartkeylpartkey 1 defin one unfoldingtodiscount ffl u 0 join supplier1 partsupp1 defin follow three unfoldingstodiscount mark queri tree figur 5 1 u 1 join supplier1 lineitem1 partsupp1 2 u 2 join supplier2 lineitem2 partsuppv 3 u 3 join supplier2 lineitem2 partsupp2 follow discount queri test g note q 2 q exactli structur respect q qnffg exampl 1 similarli structur qnfgg exampl 9 sinc db2 support boolean data type use integ 0 1 tag use multipl instead logic manipul exampl queri q evalu tupletag strategi follow form select supplierv partsuppv p lineitemv l ssuppkeypsuppkey ppartkeylpartkey psuppkeylsuppkey stag1 ptag1 tag1 tag2 stand tag u 1 u 3 respect valu set definit view supplierv partsuppv lineitemv tabl 1 present result test measur evalu cost sever queri use tupl tag explicit rewrit evalu discount queri thu suffix tag rew top mean discount queri evalu use respect tupletag explicit rewrit queri tree minim number oper describ exampl 1 topdown approach evalu join base tabl particular queri tree rew structur queri tree figur 2 similarli q rew follow form 4 allattribut supplier1 4 express relat algebra breviti queri total execut time number retriev row tag 3495 1 tag 175 7242 tag 36438 rew 58282 65219 tag 35618 rew 48265 55537 tag 29888 56002 tabl 1 experiment result one easili verifi compact represent q g recal q 2 nfu 1 g top evalu union extension unfoldingsthat union join base tablesand similarli top 42 discuss purpos test q 1 q 1 nfu 0 g measur overhead ad manipul tag queri design way optim queri execut time possibl achiev use tag done make root close node u 0 q 1 nfu 0 g join tabl ident size q minim size answer set thu make sure benefit write less data back disk inde queri execut time 3495 second larger q 1 3485 second good news differ neglig 029 case q g size answer becom substanti tupletag begin optim queri q 0 project attribut two join tabl reduc size answer set q 0 provid optim queri execut time q 0 vs 256 second q 0 1 purpos queri compar tupletag two techniqu remov unfold queri topdown queri evalu explicit rewrit queri tree minim algebra form tupletag outperform two techniqu respect margin fact topdown approach explicit queri rewrit approach add substanti overhead cost evalu discount queri see tabl 2 conjectur section 1 due introduct redund join evalu techniqu hand evalu tupletag strategi provid modest optim q 2 see figur 6 still achiev reduct size answer set reduct size join tabl last queri q 2 nfu 2 g provid crucial test techniqu temporari tabl creat join supplierv 1 lineitemv close node unfold u 2 mean tupl mark true tabl elimin next join partsuppv execut thu reduc queri evalu strategi tupletag topdown explicit rewrit tabl 2 evalu time second discount queri differ evalu strategi cost last join inde reduct execut cost q 2 nfu 2 g origin queri q 2 257 43 heurist state section 1 one advantag tupletag explicit queri tree rewrit reliabl heurist devis decid stepwis whether given optim step appli decis depend reduct size tabl repres close node unfold set unfold queri tree exampl queri q half tupl supplierv half tupl lineitemv mark true henc proport tupl mark true join supplierv 1 lineitemv assum uniform distribut valu estim 25 tupl elimin cost join partsuppv roughli estim reduc 25 well show formal reduct estim gener thu provid main compon heurist use tupletag algorithm proport tuplestodiscount versu tupl p tabl repres close node n depend three factor proport tupl tag true unfoldingtodiscount close n number unfoldingstodiscount close n size join mani tabl particip state depend formal follow assum uniform distribut tuplesto discount among tupl tabl theorem 12 let tabl 0 creat join tabl 1 n differ tag column proport tupl tabl j valu true column proport tupl 0 tag column valu true proof induct n 1 one unfoldingtodiscount tupl discount creat join tabl particip join tupl valu true column cu probabl pi valu formula 2 assum formula hold n unfoldingstodiscount show hold tupl discount consid one follow case would discount n unfoldingstodiscount consid b discount answer set n 1st unfoldingtodiscount probabl 2a given induct hypothesi q2 q2nfu1g q2nfu2g figur comparison execut time origin queri queri evalu tupletag probabl 2b condit probabl tupl discount n unfoldingstodiscount consid discount 1st unfoldingto discount consid probabl express pi n thu probabl tupl discount n 1 unfoldingstodiscount consid equal sum probabilitu case 2a 2b special case proport tupl mark true tabl tag column ident equal valu p reduc show applic result predict size tabl close node experi exampl 13 queri g root queri tree close node proport tupl mark true u 1 u 3 05 three tabl supplierv partsupp v lineitemv thu queri q 2 nfu 3 g formula 1 form sinc size answer origin queri q 73943 row reduc 125 would produc tabl size 64700 close actual size 65219 row observ g similarli queri q form 0234 predict size final queri answer set thu 56566 close actual size 55537 g valu formula 1 p function n plot figur 7 2way 5way join sever valu pt surprisingli number discount tupl grow number unfoldingsto discount well proport tuplestodiscount tabl particip join also howev strong invers relationship number join involv multiway join number discount tupl even tabl particip join 30 tuplestodiscount differ unfold remov number discount tupl small 5way join conclus paper introduc new framework queri repres collect select unfold queri discount queri repres queri unfold remov pt10 pt30 pt50 pt90 pt70 1006020a 2way join pt30 pt50 pt70 pt902060100 b 5way join figur 7 proport discount tupl result join respect number unfold todiscount select unfold may remov secur reason answer readili avail cach materi view present effici evalu strategi discount queri call tupletag show experi discount queri gener evalu effici queri experi also suggest rewrit techniqu seem intuit approach remov unfold queri may perform wors evalu origin queri much wors tupl tag approach thu discount framework tupletag algorithm offer viabl approach optim queri employ view numer issu explor respect optim queri view type optim orthogon optim techniqu directli use conjunct exist optim would benefici identifi type interact tradit queri optim could increas overal optim current tupletag done prior stage optim appli result queri also need understand better variou cost tradeoff tupletag best balanc r optim queri materi view implement two semant queri optim techniqu db2 univers databas rule languag intern algebra rule base optim data cach replac rule specif framework queri optim framework intension queri optim answer queri semant cach view disassembl queri optim bottomup evalu structur queri optim uniform framework semant queri optim deduct databas push semant insid recurs gener framework semant optim recurs queri comput queri deriv relat queri reformul deduct databas answer queri use view foundat logic program understand new sql complet guid extensiblerul base queri rewrit optim starburst queri fold multiplequeri optim problem constraint process multilevel secur distribut databas manag system transact process perform council principl databas knowledgebas system fusion queri internet databas tr rulebas view queri optim foundat logic program 2nd extend ed principl databas knowledgebas system vol logicbas approach semant queri optim structur queri optimizationmyampersandmdasha uniform framework semant queri optim deduct databas extensiblerul base queri rewrit optim starburst understand new sql answer queri use view extend abstract rule languag intern algebra rulebas optim multiplequeri optim problem constraint process multilevel secur distribut databas manag system fusion queri internet databas queri reformul deduct databas prair push semant insid recurs optim queri materi view queri fold view disassembl implement two semant queri optim techniqu db2 univers databas semant data cach replac queri optim bottomup evalu answer queri semant cach ctr park godfrey jarek gryz view disassembl rewrit extract portion view journal comput system scienc v73 n6 p941961 septemb 2007