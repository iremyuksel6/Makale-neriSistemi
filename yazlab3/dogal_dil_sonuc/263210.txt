perturb analys qr factor paper give perturb analys q1 r qr factor aq1r q1tq1i given real mtime n matrix rank n gener perturb suffici small norm analys accur reflect sensit problem previou result condit number alter column pivot use apq1r condit number r bound fix n standard column pivot strategi use strategi also tend improv condit q1 comput q1 r probabl greatest accuraci use standard column pivot strategyfirstord perturb analys given q1 r seen analysi r may approach two waysa detail matrixvector equat analysi provid tight bound correspond condit number unfortun costli comput intuit simpler matrix equat analysi provid result usual weaker easier interpret allow effici comput satisfactori estim actual condit number approach power gener tool appear applic perturb analysi matrix factor b introduct qr factor import tool matrix comput see exampl 4 given theta n real matrix full column rank exist uniqu theta n real matrix q 1 orthonorm column uniqu nonsingular upper triangular n theta n real matrix r posit diagon entri matrix q 1 refer orthogon factor r triangular factor suppos tg uniqu qr factor differenti rt respect set given g linear equat upper triangular matrix r0 determin sensit rt core perturb analysi qr factor effect involv use 11 determin bound r0 essenti two main way approach problem discuss togeth recent histori xiaowen chang 1 2 3 first realiz publish result sensit factor lu choleski qr extrem school comput scienc mcgill univers montreal quebec canada h3a 2a7 changcsmcgillca chriscsmcgillca research first two author support nserc canada grant ogp0009236 depart comput scienc institut advanc comput studi univers maryland colleg park md 20742 usa stewartcsumdedu g w stewart research support part us nation scienc foundat grant ccr 95503126 g w stewart weak mani matric origin gener approach obtain provabl tight result sharp condit number problem call matrix vector equat approach qr factor involv express 11 matrixvector equat form wr zr matric involv element r vecdelta transform argument vector element notat uvecdelta denot variant vecdelta defin section 52 chang also realiz condit mani problem significantli improv pivot provid first firmli base theoret explan g w stewart 11 3 stimul chang work understand deepli present simpl explan go chang work use approach perturb analys factor call matrix equat approach keep equat like 11 matrixmatrix form stewart 11 also see 3 use eleg construct partli illustr low notat section 2 make matrix equat approach far usabl intuit tool combin deep insight scale produc new matrix equat analys appealingli clear provid excel insight sensit problem new matrix equat analys gener provid tight result like matrixvector equat analys usual simpl provid practic estim true condit number obtain latter third author chri paig insist write brief histori delin except contribut chang stewart requir combin two analys provid full understand case examin interplay two approach first reveal 3 hope convey even clearli qr factor perturb analysi qr factor consid sever author first normbas result r present stewart 9 modifi improv sun 13 use differ approach sun 13 stewart 10 gave first order normwis perturb analys r first order componentwis perturb analysi r given zha 17 strict componentwis analysi r given sun 14 paper also gave analys q 1 recent sun 15 gave strict perturb bound q 1 alon purpos paper establish new first order perturb bound gener sharper equival result r factor 10 13 straightforward sharp result 15 q 1 factor section 2 defin notat give result use throughout paper section 3 survey import key result sensit r q 1 section 4 give refin perturb analysi show simpl way standard column pivot strategi benefici certain aspect sensit q 1 section 5 analyz perturb r first straightforward matrix equat approach detail tighter matrixvector equat approach give numer result suggest practic condit estim section 6 summar comment find section 7 perturb analys qr factor 3 2 notat basic simplifi present n theta n matrix x defin upper lower triangular matric upx gener x symmetr x f gamma2 illustr basic use show given n theta n nonsingular upper triangular r given n theta n symmetr equat form cf 11 alway uniqu upper triangular solut u sinc ur gamma1 upper triangular see immedi ur gamma1 therefor u uniqu defin describ use later perturb bound tighter bound separ perturb along column space along orthogon complement thu introduc follow notat real theta n let p 1 orthogon projector onto ra p 2 orthogon projector onto ra real theta n deltaa defin 2 ffl 0 25 also defin qr factor use follow standard result lemma 21 real theta n rank n real orthogon projector onto ra 4 xiaowen chang chri paig g w stewart proof let qr factor necessarili full column rank kq smallest singular valu inequ 28 2 corollari 22 nonzero deltaa satisfi 28 ffl g defin 25 26 tg full column rank therefor uniqu qr factor jtj ffl 2 3 previou normbas result section summar strongest normbas result previou author first give deriv essenti sun 13 stewart 10 first order normwis perturb result r sinc techniqu result use later theorem 31 13 let 2 r mthetan full column rank qr factor real theta n matrix uniqu qr factor proof let g j deltaaffl theorem trivial corollari 22 atg uniqu qr factor jtj ffl notic easi verifi q 1 rt twice continu differenti ffl algorithm qr factor thu 11 see 24 linear equat uniqu defin element term element q g upper triangular r0r gamma1 see 21 perturb analys qr factor 5 23 sinc 25 27 kq taylor expans rt combin 38 give 32 2 proof show key point deriv first order perturb bound r use 35 give good bound sensit k obtain bound directli 37 matrix equat analysi show recent perturb result q 1 given sun 15 obtain present set sinc analysi easili extend obtain refin result simpl way note hypothes follow theorem theorem 31 use result latter theorem theorem 32 15 let 2 r mthetan full column rank qr factor real theta n matrix hold deltaa uniqu qr factor proof let g j deltaaffl theorem trivial corollari 22 atg uniqu qr factor jtj ffl differenti follow q 2 q 6 xiaowen chang chri paig g w stewart use 21 37 theorem 31 see 22 311 kgk 27 f taylor expans kdeltaq 1 4 refin analysi q 1 note sinc q 1 orthonorm matric 31 deltaq 1 small deltaq follow analysi assum n 1 result sun 15 give good possibl overal bound chang deltaq 1 q 1 look deltaq 1 distribut orthogon complement follow idea theorem 32 abl obtain result tight unlik relat tight result 15 easi follow make clear exactli illcondit lie 314 squar orthogon key bound first term right separ second note 311 25 27 g chosen give equal given henc true condit number part deltaq 1 rq 2 part deltaq 1 rq 1 see 312 skew symmetr clearli zero diagon let r j j denot lead block r respect g j matrix first j column g perturb analys qr factor 7 j j1 element upper triangular form r 42 ks ks f r ngamma1 equal obtain take kr gammat follow bound tight true condit number part deltaq 1 rq 1 problem mainli interest chang q 1 lie rq 1 result show bound smaller previous thought particular one small singular valu use standard column pivot strategi comput qr factor r ngamma1 quit wellcondit compar r kr gamma1 5 perturb analys r section 3 saw key deriv first order perturb bound r qr factor full column rank equat 35 gener form find bound x term given r f matrix equat upper triangular r nonsingular sun 13 stewart 10 origin analyz use matrix equat approach give result theorem 31 analyz two new way first stewart 11 3 refin matrix equat approach give clear improv theorem 31 second chang 2 3 matrixvector equat approach give improv still provabl tight bound lead true condit number r r qr factor approach provid effici condit estim see 2 matrixvector equat approach nice result special case permut matrix give standard column pivot deriv matrix equat version tighter complic matrixvector equat analysi case pivot given 2 result quot 51 refin matrix equat analysi r proof theorem 31 use 35 produc matrix equat 37 deriv bound directli look approach close first use gener form 51 keep think clear see 8 xiaowen chang chri paig g w stewart let n set n theta n real posit definit diagon matric r note matrix b upbd henc defin b r r gammat f r obviou notat upper triangular matrix bound use follow result lemma 51 n theta n b 2 n 1ijn proof clearli cauchyschwarz theorem bound solut x 51 sinc true 2 n know upper triangular solut x defin 54 give encourag result 5 perturb analys qr factor 9 compar 35 51 see qr factor 25 27 henc 39 chang 511 never wors bound theorem 31 use standard column pivot strategi permut matrix analysi lead nice result element r r 2 nn diagon r 1 59 follow 6 theorem 813 sinc k thu use standard pivot strategi see sensit r bound n remark 51 clearli potenti candid condit number r qr factor 59 depend sole r true condit number nonsingular upper triangular r find f 51 give equal 58 57 true everi column f lie space right singular vector correspond maximum singular valu r gammat restrict gener strong 56 made equal well see lead 55 howev class r possibl r diagon take first restrict f disappear let j g w stewart see least diagon r bound tight restrict case true condit number refin matrix equat analysi show extent solut x 51 sensit r qr factor depend row scale r term r gammat f 52 saw multipli occur j result obtain bound rather equal minimum element come maximum diagon thu obtain full cancel gamma1 first term right hand side 52 partial cancel second give insight r qr factor less sensit earlier condit estim indic illcondit r mostli due bad scale row correct choic r give 2 near one time larg r 510 much smaller pivot alway ensur exist fact give 514 howev use pivot remark 51 suggest rel small earlier element diagon r could correspond poor condit factor return r seek practic estim true condit number deriv next section 52 matrixvector equat analysi r obtain provabl sharp less intuit result view matrix equat 51 larg matrixvector equat matrix c nthetan denot c j vector first element c j defin u denot upper c 1c 2delta c n vector form stack column upper triangular part c one long vector analyz 35 consid gener form 51 repeat clariti upper triangular r nonsingular saw via 24 uniqu upper triangular solut x upper lower triangular part 51 contain ident inform write upper triangular part matrixvector rather matrixmatrix format first j element jth column 515 given r f jtf jtdelta f jt perturb analys qr factor 11 rewrit see solv x j r r 1t r j gamma1t r r jt r jt divid last row 2 give 2 theta nn1 r 11 zr 2 r nn1 r 11 sinc r nonsingular wr also 516 r zr vecf rememb x upper triangular see r zr vecf k 2 nonsingular upper triangular r equal obtain choos vecf lie space span right singular vector correspond g w stewart largest singular valu w gamma1 r zr follow 518 tight 58 deriv matrix equat approach 511 remark 52 usual first second inequ strict exam ple let solv optim problem remark 51 first inequ becom equal r diagon second also becom equal r n theta n ident matrix upper bound tight structur wr zr reveal column wr one column zr w gamma1 r zr nn 12 squar ident submatrix give remark 53 lower bound approxim tight n seen take take 510 see remark 51 result analysi section 4 q 1 lead new first order normwis perturb theorem theorem 52 let qr factor 2 r mthetan full column rank let deltaa real theta n matrix hold uniqu qr factor wr zr 516 59 510 perturb analys qr factor 13 proof corollari 22 deltaa uniqu qr factor 522 35 515 517 g j deltaaffl 25 r zr vecq take 2norm give combin thu taylor seri 39 rt 523 follow remain result restat 520 519 41 43 2 remark 54 524 know first order perturb bound 523 least sharp 32 suggest may consider sharper fact sharper arbitrari factor consid exampl remark 53 take see first order perturb bound 32 sever overestim effect perturb remark 55 take close upper bound show rel small earli diagon element r caus poor condit suggest use pivot signific chanc condit problem approach upper bound least randomli chosen matric use standard pivot see 524 514 follow tighter result shown 2 th 22 theorem 53 let 2 r mthetan full column rank qr factor standard column pivot strategi use 14 xiaowen chang chri paig g w stewart parametr famili matric 2 0 2 r zr theorem 53 show standard column pivot strategi use r ap bound fix n matter larg mani numer experi strategi suggest r ap usual close lower bound one give extrem exampl section 6 use pivot simpl result r far see unreason expens comput approxim r directli usual approach fortun appar excel approxim r quit easi estim need choos suitabl r 510 consid next section 6 numer experi condit estim section 5 present new first order perturb bound r factor qr factor use two differ approach defin r zr k 2 true condit number r factor suggest r could estim practic r new first order result sharper previou result r least sharp q 1 give numer test illustr possibl estim r would like choos r good approxim 59 show good estim true condit number r procedur obtain 2 condit estim r qr factor ie estim r choos use standard condit estim see exampl 5 estim 2 gamma1 r take r 510 appropri estim well known result van der slui 16 2 gamma1 r nearli minim row gamma1 r equilibr could lead larg 510 three obviou possibl first one choos equilibr r precis specif take n second one choos equilibr r far possibl keep 1 specif take n third one choos comput show third choic sometim caus unnecessarili larg estim give result choic specifi diagon matrix obtain first method second method 1 2 respect follow give three set exampl first set matric n theta n pascal matric element 15 result shown tabl 61 without pivot give tabl 62 pivot give r note tabl 61 far wors true condit number r much greater lower bound 1 tabl 62 pivot seen give signific improv r bring close lower bound cours still also observ tabl 61 r 1 r 2 good estim r latter littl better former tabl 62 fact also good estim r ap perturb analys qr factor 15 tabl result pascal matric without pivot 7 66572e02 44665e03 42021e03 21759e05 21120e06 8 24916e03 18274e04 16675e04 27562e06 29197e07 9 94091e03 74364e04 66391e04 36040e07 41123e08 20190e06 19782e07 16614e07 12819e12 18226e13 14 77958e06 79545e07 66157e07 18183e13 26979e14 tabl result pascal matric pivot r 3 12892e00 21648e00 21648e00 12541e01 87658e01 6 22296e00 47281e00 47281e00 75426e03 15668e05 7 20543e00 51140e00 51140e00 84696e04 21120e06 8 26264e00 65487e00 65487e00 11777e06 29197e07 9 34892e00 88383e00 88383e00 14573e07 41123e08 14 36106e00 12386e01 12386e01 53554e12 26979e14 second set matric 10 theta 8 j obtain random 10 theta 8 matrix produc matlab function randn jth column multipli 10 gamma8 give j result shown tabl 63 without pivot result pivot similar 63 given close upper bound significantli smaller result expect sinc matrix r illcondit due fact r jj small row r alreadi essenti equilibr expect r much g w stewart better also first seven case smallest singular valu lead part r ngamma1 close r q 1 could much better even though r still illcondit due fact r 88 small equilibr becom wellcondit row scale notic time close 1 r d1 r 2 therefor much better case smallest singular valu r significantli smaller r ngamma1 thu q 1 condit number chang q 1 lie rang q 1 spectacularli better contriv exampl serv emphas benefit pivot condit q 1 r tabl pivot 5 12467e08 31208e08 23992e08 39067e08 42323e08 6 88237e07 22252e08 16584e08 34710e08 39061e08 7 92648e07 21010e08 17127e08 44303e08 54719e08 8 22580e00 54735e00 49152e00 66109e00 62096e08 third set matric n theta n upper triangular matric introduc kahan 7 cours condit number depend r interest result shown tabl 65 found list result correspond 1 tabl result kahan matric exampl see r 1 r 2 gave excel estim r r 2 margin prefer kahan matric correspond correctli pivot see extrem case larg enough n r larg even pivot bad result get perturb analys qr factor 17 pivot get bit wors 0 r sinc kahan matric parameter famili mention theorem 53 nevertheless r still estim r excel 7 summari conclus first order perturb analys present show sensit condit q 1 r qr factor full column rank provid true condit number respect measur use suffici small deltaa well effici way approxim key normbas condit number deriv part deltaq 1 ra see 41 part deltaq 1 ra see 43 r zr k 2 r see theorem 52 ffl estim r j inf d2dn r r j condit number obey r see 524 numer exampl analysi case given suggest r chosen equilibr subject 1 give excel approxim r gener case special case orthogon column r diagon remark 51 show take gener use standard column pivot strategi qr factor izat saw 514 2 result analys see r certain sens q 1 less sensit thought previou analys true condit number depend column pivot show standard pivot strategi often result much less sensit r sometim lead much smaller possibl chang q 1 rang q 1 given size perturb matrix equat analysi section 51 also provid nice analysi interest possibl gener matrix equat 51 follow approach stewart 8 th 31 see also 12 th 211 would straightforward detail lengthi extend first order result provid strict perturb bound done 3 could also provid new componentwis bound chose either order keep materi basic idea brief approach possibl condit number result bound asymptot sharp less need strict bound new componentwis bound r given 2 g w stewart acknowledg would like thank jiguang sun suggest encourag provid us draft version work r phd thesi perturb analysi r qr factor new perturb analys choleski fac toriz matrix comput survey condit number estim triangular matric accuraci stabil numer algorithm perturb bound subspac associ certain eigenvalu problem perturb bound qr factor matrix perturb lu perturb lu choleski factor matrix perturb theori perturb bound choleski qr factor componentwis perturb bound matrix decomposit perturb bound qr factor condit number equilibr matric componentwis perturb analysi qr decomposit tr ctr youn chahlaoui kyle gallivan paul van dooren increment method comput domin singular space comput inform retriev societi industri appli mathemat philadelphia pa 2001