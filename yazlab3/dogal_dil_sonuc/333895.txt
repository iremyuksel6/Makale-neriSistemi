backward error analysi numer integr backward error analysi becom import tool understand long time behavior numer integr method true particular integr hamiltonian system backward error analysi use show symplect method conserv energi exponenti long period time result typic base two aspect backward error analysi shown modifi vector field qualit properti share given problem ii estim given differ best interpol vector field numer method aspect investig recent exampl benettin giorgilli j statist phi 74 1994 pp 11171143 hairer ann numer math 1 1994 pp 107132 hairer lubich numer math 76 1997 pp 441462 paper aim provid unifi framework simplif exist result correspond proof approach backward error analysi base simpl recurs definit modifi vector field requir explicit taylor seri expans numer method correspond flow map abovecit work applic discuss long time integr chaotic hamiltonian system approxim time averag along numer comput trajectori b introduct paper consid relationship solut given system ordinari differenti equat vector field dt numer approxim solut associ modifi equat dt vector field formul term asymptot expans stepsiz ffit ie chosen numer solut formal inter prete increas index accur solut modifi equat previou paper backward error analysi differenti equat includ warm hyett 38 griffith sanzserna 12 beyn 6 feng 10 fiedler scheurl 11 sanzserna 31 anoth earli refer relat idea moser 24 discuss approxim symplect map near equilibrium flow map hamiltonian vector field recent gener formula comput modifi vector field deriv hairer 16 calvo murua sanzserna 7 nettin giorgilli 5 reich 26 paper neishtadt 25 benettin giorgilli 5 hairer lubich 18 question close numer approxim solut modifi equat address konradzusezentrum takustr 7 d14195 berlin current address depart mathemat statist univers surrey guildford surrey gu2 5xh uk sreichsurreyacuk particular shown paper differ made exponenti small stepsiz ffit ie provid vector field z numer one step method psi ffit real analyt appropri constant phi ffit denot timeffitflow map vector field index ffit chosen differ minim backward error analysi utmost import understand qualit behavior symplect method 32 hamiltonian problem shown hairer 16 calvo murua sanzserna 7 reich 26 benettin giorgilli 5 symplect discret modifi vector field hamiltonian special case see also paper auerbach friedman 4 yoshida 40 hamiltonian structur modifi equat impli symplect integr almost preserv total energi exponenti long period time 25 23 5 18 similarli adiabat invari hamiltonian system rapidli rotat phase also preserv exponenti long period time provid symplect method use 29 fact symplect method lead modifi equat hamiltonian special instanc call geometr properti backward error analysi mean follow vector field z belong certain class vector field like integr preserv divergencefre vector field numer approxim phi ffit also preserv correspond quantiti modifi vector field class z besid symplect method special instanc geometr aspect discuss see exampl paper reich 26 hairer stoffer 20 gonzalez higham stuart 13 paper revisit backward error analysi use simpl recurs scheme definit modifi vector field first propos author unpublish report 26 main advantag formul requir taylor seri expans numer one step method psi ffit flow map phi ffit term step size ffit use paper benettin giorgilli 5 hairer 16 hairer lubich 18 turn allow simpl character 1 geometr properti modifi vector field rather simpl proof exponenti small truncat error 11 approach close one discuss benettin giorgilli 5 sens consid gener one step method 2 use direct approach 3 howev differ techniqu use discuss detail x4 x5 consid numer integr chaotic hamiltonian system symplect method discuss approxim timeaverag along numer comput trajectori assum poincar section 14 defin correspond poincar section uniformli hyperbol backward error 1 gener idea alreadi found report 26 hairer lubich 18 consid method repres pseri 19 note rungekutta partit rungekutta method fall categori 3 contrast indirect approach use neishtadt 25 one step method first interpol flow timedepend vector field averag time use obtain optim approxim timeindepend vector field analysi shadow lemma 33 use show numer comput trajectori stay close exact solut exponenti long period time larg deviat theorem 36 allow us discuss converg long time averag along numer comput trajectori anisotrop kepler problem 15 serv us numer illustr problem requir applic symplect variabl stepsiz method first discuss author technic report 27 independ hairer 17 2 modifi vector field recurs let us consid smooth vector field dt discret one step method 19 assum psi ffit u ae r n r n smooth map method order p 1 ie x 2 u phi ffitz timeffitflow map differenti equat 21 describ introduct look famili vector field phi ffit equival ffit suffici small phi 1x denot timeoneflow map vector field xffit famili modifi vector field xffit ffit 0 formal defin term asymptot expans stepsiz ffit ie formal infinit sequenc vector field fdeltax g i1 1 obtain taylor seri expans one step method psi ffit ie x ident map comparison seri expans timeoneflow map phi 1xffit term ffit vector field deltax chosen two seri coincid term term gener approach follow benetttin giorgilli 5 hairer 16 two paper differ way taylor seri expans written lead exactli sequenc vector field fdeltax g i1 1 obvious deltax method order p give recurs definit modifi vector field xffit requir explicit taylor seri expans recurs introduc author unpublish report 26 first formal introduc truncat expans mean obvious let us assum x ffit chosen differ time oneflow map x ffit numer one step method psi ffit offit i1 suggest consid follow recurs deltax inde definit deltax i1 impli x i1 ffit defin 23 gener timeoneflow map offit i2 away numer method psi ffit seen thu eq 23 24 recurs defin modifi vector field x 1 recurs start x 1 ffitz gener sequenc cours equival sequenc obtain use taylor seri expans describ 16 5 throughout paper exclus work recus 2324 x3 shown lead simpl character geometr properti modifi vector field x4 explicit estim differ timeoneflow map modifi vector field x ffit numer method given like point result also 16 5 18 20 13 deriv use explicit taylor seri expans flow map numer method howev feel applic recurs lead simplif present result 3 geometr properti backward error analysi section consid differenti equat 21 whose correspond vector field z belong certain linear subspac g infinit dimension lie algebra 4 smooth vector field r n 211 assumpt given linear subspac g infinit dimension lie algebra smooth vector field r n let us assum correspond subset g infinit dimension frechet manifold 21 diffeomorph r n 4 algebra oper lie bracket xy two vector field x 3 id g defin set vector field x psi 0 oneparametr famili diffeomorph psi 2 g smooth psi linear space lie algebra hamiltonian vector field r n exampl subset canon transform 1 import aspect differenti equat correspond flow map phi tz form oneparametr subgroup g 211 especi context long term integr desir discret differenti equat type way correspond iter map psi ffit belong subset g phi tz call integr geometr integr follow result concern backward error analysi geometr integr first state unpublish report 26 theorem 31 let us assum vector field z dt belong linear subspac g lie algebra smooth vector field r n let us assum furthermor geometr integr subspac g ie psi ffit 2 g ffit 0 suffici small perturb vector field x defin recurs 2324 belong g ie proof statement certainli true us assum also hold ffit 0 suffici small sinc ffit 0 suffici small well deltax g impli x i1 ffit 2 g requir remark often linear subspac g fact subalgebra lie bracket 3 g properti need theorem 31 let us discuss five exampl exampl 1 consid subspac g vector field preserv particular first integr f r n r fact space subalgebra lie bracket 31 word impli show differenti 32 wrt x give procedur appli 33 use ident definit 31 34 yield desir result correspond subset g given f preserv diffeomorph psi ie fact let psi smooth famili f preserv diffeomorph psi x psi sinc thu id appli theorem 31 particular numer method modifi vector field x possess f first integr result recent deriv gonzalez higham stuart 13 use contradict argument pi exampl 2 consid lie subalgebra divergencefre vector field z ie correspond subset g volum preserv diffeomorph ie det id g name x psi x trace x psi x 0 thu numer method psi ffit volum conserv modifi vector field x divergencefre result formul gonzalez higham stuart 13 use contradict argument pi exampl 3 let involut 5 2 r nthetan given consid subspac g vector field z r n satisfi timerevers symmetri subspac subalgebra lie bracket 31 correspond subset g given timerevers diffeomorph psi ie psi let psi 2 g smooth psi theta spsi impli x psi g follow id appli theorem 31 thu numer method psi ffit satisfi timerevers symmetri modifi vector field x timerevers result first proven hairer stoffer 20 use idea 26 pi exampl 4 let f g denot poisson bracket linear poisson manifold lie algebra hamiltonian vector field p given dt r smooth function correspond subset g given set smooth diffeomorph p preserv poisson bracket f g 1 let psi famili map g psi smooth function f condit vector field x local hamiltonian sinc p simpli connect vector field also global hamiltonian 3 discret evolut 22 satisfi psi ffit 2 g ffit 0 psi ffit call symplect method follow theorem 31 modifi vector field hamiltonian vector field p result also found 5 16 26 symplect method expand pseri vector field x ffit global hamiltonian even phase space p ae r n simpli connect 16 result appli symplect rungekutta partit rungekutta method furthermor symplect method defin gener function third kind 32 also alway global hamiltonian 5 statement true symplect method base composit exact flow map 40 pi exampl 5 let us consid differenti equat matrix lie group g ae r nthetan 35 gener time independ differenti equat g written form dt 5 involut nonsingular matrix satisfi ae r nthetan lie algebra g mani recent paper see 8 refer therein devot method preserv lie group structur ie n 2 g impli n1 2 g thu psi ffit diffeomorph defin submanifold g ae r nthetan fact submanifold character least local set nonlinear equat denot f f integr preserv map ie f ffi psi g follow exampl 1 know modifi vector field well given vector field satisfi henc modifi vector field x ffit vector field g give rise modifi differenti equat type dt g see 28 result backward error analysi numer method manifold pi 4 truncat error backward error analysi like deriv explicit estim norm vector field deltax i1 differ timeoneflow map phi 1x ffit numer approxim psi ffit assum vector field z 21 real analyt also introduc follow notat let b r denot complex ball let us consid compact subset k ae r n phase space constant r 0 given real analyt vector field bound b r defin also defin b find estim deltax i1 defin 24 need estim map appear right hand side 24 start estim map psi ffit lemma 41 let us assum vector field z 21 real analyt compact subset k phase space constant k r 0 also assum numer method psi ffit real analyt exist constant k proof given assumpt flow map z zphi tz x dt defin complex valu 2 c integr right hand side independ path zero complexifi flow map satisfi z jjzphi tz xjj jdtj 1 consist numer method impli exist constant deltak 0 complexifi map psi take k remark let us consid sstage rungekutta method coeffici ij1 fb g i1 19 satisfi 1 assum rungekutta method uniqu 6 defin real analyt map psi stepsiz 2 c j j rk 41 follow fact state assumpt stage variabl brk vector field z bound constant k similar statement hold partit rungekutta method pi theorem 42 let assumpt lemma 41 satisfi exist famili real analyt vector field order method famili modifi vector field xffit satisfi estim r 6 implicit method solut obtain fixpoint iter j j suffici small p 1 constant depend order p method exampl proof know x 1 psi ffit method order p 1 thu jjx 1 jj r j jm deltax next find estim differ timeoneflow map phi 1x 1 map psi use 41 42 obtain sinc map real analyt differ offit p1 obtain estim 5 1 use 24 next show 1 estim true compar 43 proceed induct first note replac paramet ff 2 0 1 formula ff j 0067 yield ff 2 0 1 2 c j use 0891 46 2 particular substitut j j j ff 45 use inequ 46 deriv 1 next introduc vectorvalu real analyt function observ 1 use x 2 b ffr k impli phi tx j x 2 find estim differ timeoneflow map phi 1x j map psi use 41 47 obtain sinc map real analyt differ offit j1 obtain estim 5 1 use 24 final obtain verifi 44 next need estim differ timeoneflow map map psi ffit compact set k use 48 immedi r famili vector field xffit defin take optim number ffit iter take ffit integ part thu ffit complet first part proof accord 45 differ modifi vector field xffit z given r r next use ffit r c obtain r e r r p 1 chosen j 2 remark proof theorem 42 similar spirit one given benettin giorgilli 5 exponenti small differ optim interpol vector field neartotheident map howev coupl import differ explicitli take order method account ii directli deriv estim differ flow map phi 1x psi ffit instead use taylor seri expans phi 1x psi ffit correspond estim element seri believ simplifi proof theorem 42 iii introduc paramet ff 2 0 1 shrink domain definit vector field x iter index increas feel simplifi proof iv 18 work directli estim given vector field z instead make assumpt map psi ffit rather pessimist constant enter estim seem main disadvantag approach pi elabor version proof theorem 42 found 30 5 applic ergod hamiltonian system let us consid real analyt hamiltonian system dt dt togeth smooth function r 2n r interest evalu timeaverag along trajectori qt pt hamiltonian system 5152 ie assum exist equal microcanon ensembl averag correspond hamiltonian ie assum system 5152 ergod 7 even mix 37 thu r aq p z z inner product ffie gamma h let us write equat 5152 compact form dt hamiltonian h preserv flow map phi th let us assum hypersurfac 0 constant energi 7 precis ergod system impli time averag equival ensembl averag except set initi condit measur zero compact subset r 2n also assum constant jjrxhxjj fl 1 x 2 0 impli 0 smooth dimension compact submanifold furthermor famili hypersurfac suffici small smooth compact well fact diffeomorph defin open subset u phase space u e2gammadeltaedelta far made fairli gener assumpt sequel becom specif ensur hamiltonian system 5152 ergodicmix first step construct poincar return map 14 let r smooth function posit constant jf hgxj fl 2 level set delta 0 suffici small let us assum defin poincar section follow way x 2 posit number solut xt 0 initi condit xt 0 posit number call poincar return time point x know poincar return time x 2 defin global poincar map assum poincar return time p x x 2 v bound constant interest solut particular level set constant energi simplic take level set 0 suffici consid restrict defin restrict pi thu reduc studi dynam properti hamiltonian system 5152 energi shell 0 studi properti poincar ergod mix map hamiltonian system ergod mix 0 note pi 0 volum preserv ie det x pi 0 assum pi 0 uniformli hyperbol map ie linear x pi 0 x x possess strictli expand contract direct 1436 stochast behavior determinist map investig exampl 36 point four main result ffl uniqu invari densiti 0 invari pi 0 furthermor 0 given lebesgu measur ffl autocorrel function ha holder continu function exponenti fast ie appropri constant ffl timeaverag along trajectori fx g i1 n pi 0 satisfi central limit theorem ffl timeaverag hain along trajectori pi 0 initi valu x satisfi larg deviat theorem specif 39 given c 0 hc 0 larg n 1 result proven see exampl 36 care studi properti correspond frobeniusperron oper defin definit 51 call hamiltonian system 5152 introduc properti poincar hyperbol particular assum level set constant energi compact submanifold ii constant global poincar map pi defin uniformli hyperbol map restrict poincar return time p x x 2 v bound constant k 0 v constant let e h perturb h x 2 u ffl 0 call e h fflperturb h lemma 52 properti poincar hyperbol stabl ffl perturb hamiltonian h provid ffl suffici small proof assumpt jjrxhxjj fl 1 level set impli set persist small perturb furthermor exist constant perturb hamiltonian h x 2 v thu poincar map also defin perturb hamiltonian h uniform hyperbol also stabl small perturb poincar map 2 let us discret 5152 symplect real analyt integr psi ffit order 1 assumpt assum backward error analysi appli compact subset k u ae k correspond perturb hamiltonian denot e ie x 2 k constant let stepsiz ffit suffici small perturb hamiltonian system also poincar hyperbol simplic shift modifi hamiltonian e hffit hx 0 let us introduc coupl notat perturb system unperturb system defin compact level set f open set e u replac h e h definit without loss gener assum e u ae k furthermor e delta correspond set e v e defin obviou way final global poincar map e pi reduc poincar map e pi 0 introduc unperturb system without loss gener assum ae e extend discret time map psi ffit map psi 2 0 ffit use exact flow map phi e h modifi problem interpol 2 0 ffit map extend ffit obviou way 8 composit k step psi ffit one step phi dt e thu correspond definit global poincar map e defin x 2 e poincar return time e p x x 2 e v definit e pi lemma 52 impli constant e sup follow backward forward error analysi 18 constant x 2 e v ffit suffici small importantli let fx g i1 n numer comput sequenc point x correspond sequenc map e pi x sequenc fx g respect gener two sequenc real number fe g fs g f e fe g respect defin e 8 result map discontinu multipl stepsiz ffit smooth interpol could defin need context paper e obvious e drift valu e per step away zero exponenti small sum linearli number step energi conserv properti symplect method discuss benettin giorgilli 5 hairer lubich 18 exponenti slow drift follow sequenc fs g lipschitz constant e word start initi e point comput numer poincar map b pi stay exponenti small neighborhood e exponenti mani iter b pi sinc numer method order p 1 compact manifold f offit p away ie modifi hamiltonian e h fflperturb hamiltonian h ffl ffit p thu sequenc fx g also stay offit p neighborhood long number iter n satisfi appropri constant shadow lemma 33 appli sequenc fx g i1 n proposit 53 exist exact trajectori fx g i1 n poincar map pi 0 numer comput sequenc fx g i1 n stay offit p neighborhood shadow exact trajectori provid number iter n satisfi 54 proof first project sequenc fx g i1 n onto use search direct orthogon manifold denot result fx g project sequenc fx g sequenc fx g offit p close provid n satisfi 54 local error per step exact poincar map pi numer poincar map b pi also order p stepsiz ffit follow standard forward error analysi thu shadow lemma 33 uniformli hyperbol map appli poincar map project sequenc fx g shadow distanc offit p shadow result also appli sequenc fx g let us assum want comput ensembl averag smooth r certain accuraci c 0 larg deviat theorem hyperbol map tell us probabl obtain ensembl averag desir accuraci time averag along singl trajectori goe one exponenti fast length n trajectori increas numer comput approxim trajectori system 5152 know proposit 53 trajectori offit p close exact trajectori exponenti mani integr step n let us denot time averag along exact trajectori hai e n numer comput time averag hain n satisfi bound type 44 thu obtain follow proposit 54 let 5152 poincar hyperbol realanalyt system discret symplect method order p 1 stepsiz ffit timeaverag hain observ along numer comput trajectori fxn gn1 n satisfi 55 hai e n timeaverag along exact trajectori number step n satisfi bound type 54 furthermor assum want comput ensembl averag within given accuraci c 0 assum simplic constant c larger differ time averag 55 alway true suffici small stepsiz ffit probabl obtain averag desir accuraci time averag along numer comput trajectori goe one exponenti fast number integr step n increas take maximum number 54 step probabl made doubl exponenti close one 53 ffit 0 exampl numer exampl look follow planar anisotrop kepler problem 15 dt dt initi condit chosen note angular momentum l conserv defin poincar section 0 record sequenc point conserv energi impli thu defin sequenc restrict subset subset awkward shape transform rectangl mean area preserv transform 102 correspond poincar map hyperbol ie stabl unstabl manifold intersect transvers dynam encod binari bernoulli shift 15 main comput difficulti consist exist weak singular remov singular scale equat motion introduc time transform impli new time norm vector field remain bound time transform introduc transform equat motion still hamiltonian constant stepsiz symplect method use integr transform system let us describ gener assum hamiltonian function hq scale function aeq given follow zare szebeh 41 introduc modifi hamiltonian function correspond hamiltonian equat motion extend phase space r 2n theta r 2 particular let us consid case p0 59511 simplifi hypersurfac constant energi scale vector field desir hamiltonian anymor therefor suggest author 27 independ hairer 17 hamiltonian equat 59511 discret symplect method exampl equat discret symplect euler method ie method explicit variabl q unfortun impli method first order ffi howev method symplect therefor time time averag time time averag time averag time time averag time actual stepsiz 22time angular momentum time total energi b fig 51 time evolut averag hrin mean distanc shown four differ initi condit equal initi energi evolut error energi angular momentum actual stepsiz bottomright figur show intersect trajectori poincar section x1 x2 coordin one thousand intersect plot hamiltonian conserv offi exponenti long period time secondord symplect discret obtain use secondord lobatto iiiab partit rungekutta formula 34 ie result scheme implicit aeq approach appli anisotrop kepler problem scale function chose initi valu equat motion integr use second order symplect method 512 005 time averag observ aq along trajectori comput accord recurs formula hain n time averag comput four differ initi condit evolut correspond time averag hri n found fig 51a differ length time interv due fact number step stepsiz ffi taken lead differ actual stepsiz ffit n within toler c 004 averag converg valu 133 fig 51b total energi h angular momentum l variat actual stepsiz found particular trajectori also plot intersect trajectori q x x theoret point fill rectangl uniform way invari meassur lebesgu meassur one thousand point plot uniform distribut satisfi quit well pi acknowledg like thank ernst hairer chu sanzserna andrew stuart claudia wulff comment earlier version paper refere make valuabl suggest r lie group structur diffeomorph group invert fourier integr oper applic geometr method theori ordinari differenti equat mathemat method classic mechan hamiltonian interpol near ident symplect map applic symplect integr algorithm numer method dynam system modifi equat ode aspect backward error analysi numer ode formal power seri numer algorithm dynam system discret homoclin orbit invis chao scope modifi equat qualit properti modifi equat dynam system bifurc vector field chao classic quantum mechan backward analysi numer integr symplect method variabl time step integr symplect method lifespan backward error analysi numer integrat or solv ordinari differenti equat revers longterm integr variabl step size invers function theorem nash moser lectur hamiltonian system separ motion system rapidli rotat phase numer integr gener euler equat backward error analysi numer integr higher order semiexplicit symplect partit rungekutta method constrain hamiltonian system preserv adiabat invari symplect discret dynam system symplect integr hamiltonian problem overview rigor verif trajectori comput simul dynam system symplect partit rungekutta method stochast dynam determinist system introduct ergod theori modifi equat approach stabil accuraci finitediffer method larg deviat dynam system construct higher order symplect integr time transform extend phase space tr ctr p f tupper comput statist hamiltonian system case studi journal comput appli mathemat v205 n2 p826834 august 2007 ernst hairer import aspect geometr numer integr journal scientif comput v25 n1 p6781 octob 2005 yk zou wj beyn manifold connect orbit discret dynam system nonlinear analysi theori method applic v52 n5 p14991520 februari b cano durn analysi variablesteps linear multistep method special emphasi symmetr one mathemat comput v72 n244 p17691801 octob p calvo portillo high order variabl step equistag initi better standard start algorithm journal comput appli mathemat v169 n2 p333344 15 august 2004 brian e moor sebastian reich multisymplect integr method hamiltonian pde futur gener comput system v19 n3 p395402 april fong eric darv adrian lew stabil asynchron variat integr proceed 21st intern workshop principl advanc distribut simul p3844 june 1215 2007 jess izaguirr scott hampton shadow hybrid mont carlo effici propag phase space macromolecul journal comput physic v200 n2 p581604 novemb 2004 b cano durn techniqu construct symmetr variablesteps linear multistep method secondord system mathemat comput v72 n244 p18031816 octob