ration filter passiv depth defocu fundament problem depth defocu measur rel defocu imag perform previous propos focu oper inevit sensit frequenc spectra local scene textur result focu oper laplacian gaussian result poor depth estim altern use larg filter bank dens sampl frequenc space though approach result better depth accuraci sacrific comput effici depth defocu offer stereo structur motion propos class broadband oper use togeth provid invari scene textur produc accur dens depth map sinc oper broadband small number suffici depth estim scene complex textur properti addit depth confid measur deriv comput output oper confid measur permit refin comput depth map experi conduct synthet real scene evalu perform propos oper depth detect gain error less irrespect textur frequenc depth accuraci found 0512 distanc object imag optic b introduct pertin problem comput vision recoveri threedimension scene structur twodimension imag problem studi vision far attract attent result varieti sensor algorithm jarvis1983 besl1988 broadli classifi two categori activ passiv activ techniqu produc rel reliabl depth map appli mani industri applic howev environ control case distant object outdoor scene activ method prove impract consequ passiv techniqu alway desir passiv sens method stereo structur motion reli algorithm establish local correspond two imag result dispar estim motion vector depth point scene comput process determin correspond wide acknowledg comput expens addit techniqu suffer occlus miss part problem possibl comput depth scene point visibl one imag altern passiv techniqu base focu anal ysi depth focu use sequenc imag taken chang focu set imag optic small step pixel focu set maxim imag contrast determin turn use comput depth correspond scene point horn1968 jarvis1983 krotkov1987 darrel wohn1988 nayar nakagawa1994 contrast depth defocu use two imag differ optic set pentland1987 subbarao1988 en lawrence1991 bove jr1993 subbarao surya1994 nayar et al1995 xiong shafer1995 rel defocu two imag principl use determin threedimension structur focu level two imag vari chang focu set len move imag sensor respect len chang apertur size depth defocu confront abovement miss part correspond problem make attract prospect structur estim despit merit point time fast accur dens depth defocu demonstr use activ illumin constrain domin frequenc scene textur nayar et al1995 watanab et al1995 past investig passiv depth defocu indic prove comput expens obtain reliabl depth map frequenc characterist scene textur larg extent unpredict furthermor textur vari dramat imag sinc respons defocu blur function vari textur frequenc singl broadband filter produc aggreg estim defocu unknown textur lead accur depth estim obviou solut use enorm bank narrowband filter comput depth leastsquar sens use domin frequenc textur xiong shafer1995 gokstorp1994 requir one forego comput effici worsen mat ter depth map high spatial resolut obtain filter bank small kernel size uncertainti relat bracewell1965 tell us frequenc resolut filter bank reduc proport invers kernel size use short one design filter narrow enough respons support area filter kernel small xiong shafer xiong shafer1995 propos attract way cope problem use moment filter compens frequenc spectrum textur within passband narrowband filter approach result accur depth estim requir use four addit filter tune filter filter bank translat five time mani convolut need typic filter bank method xiong shafer xiong shafer1995 use convolut total make approach comput expens en lawrenc en lawrence1991 propos method base spatialdomain analysi two blur imag estim convolut matrix convolv one two imag produc imag matrix correspond rel blur two imag matrix comput map depth estim method produc accur depth map ever iter natur convolut matrix estim make comput expens subbarao surya subbarao surya1994 propos stransform appli depth defocu model imag thirdord polynomi spatial domain arriv simpl eleg express subbarao surya 1994 far near focus imag respect blur circl diamet imag 1 2 express second central moment oe 2 2 oe 1 respect sinc addit relat oe 2 oe 1 obtain focu set use two imag oe 2 oe 1 solv map depth estim see term depend scene frequenc equat 1 consid sort texturefrequ invari depth defocu method produc reason depth estim larg planar surfac scene howev yield depth map high spatial resolut need depth variat scene signific argu requir detail analysi imag format well design novel filter base frequenc analysi paper propos small set filter oper passiv depth defocu oper use conjunct yield invari textur frequenc comput depth underli idea precis model rel imag blur frequenc domain express model ration function two linear combin basi function ration express lead us textur invari set oper output oper use coeffici depth recoveri equat solv get depth estim attract featur approach use small number broadband linear oper small kernel support consequ depth map comput high effici accuraci also high spatial resolut sinc oper deriv use ration express model rel imag blur refer ration oper ration oper gener deriv blur model paper structur follow first concept textur invari oper set describ next oper need depth defocu discuss includ use prefilt coeffici smooth effici algorithm obtain confid measur oper output outlin confid measur effect use refin comput depth map specif implement ration oper use three basi function model rel blur function result set three ration oper kernel size 7theta7 oper set use comput depth map synthet scene real scene experiment result analyz quantifi perform propos depth defocu approach depth defocu 21 principl fundament depth defocu relationship focus defocus imagesborn wolf1965 figur 1 show basic imag format geometri light ray radiat object point p pass apertur refract len converg point q imag plane relationship object distanc focal length len f imag distanc given len lawd f point object plane project onto singl point imag plane caus clear focus imag f form howev sensor plane coincid imag plane displac energi receiv p len distribut patch sensor plane result blur imag clear singl imag includ suffici inform depth estim two differ scene defocus differ degre could produc ident imag solut depth estim problem achiev use two imag separ known physic distanc 2e en lawrence1991 subbarao surya1994 distanc fl imag 1 len also known given describ set problem reduc analyz rel blur scene point two imag comput posit focus imag restrict imag scene point must lie far focus sensor plane 1 nearfocus sensor plane 2 eas descript introduc normal depth ff equal gamma1 1 1 2 use ffe len law 2 obtain depth scene point r f figur 1 imag format depth defocu two imag 1 2 includ inform requir recov scene structur focus plane scene correspond two imag 22 defocu function precis model defocu function critic accur depth estim defocu function describ detail previou work born wolf1965 horn 1986 figur ffe distanc focus imag scene point defocus imag form sensor plane light energi radiat scene point collect imag optic uniformli distribut sensor plane circular patch radiu 1 sigma ffe ad 1 distribut also call pillbox defocu function use imag use imag 2 pir rectangular function take valu 1 jrj 1and 0 otherwis f e effect fnumber optic optic system shown figur 1 f e equal 2a order elimin magnif differ near far focus imag use telecentr optic describ appendix 711 detail watanab nayar1995b telecentr case f e equal f2a 0 fourier domain defocu function 3 j 1 firstord bessel function first kind u v denot spatial frequenc paramet x direct respect 2 evid express defocu serv lowpass filter bandwidth filter decreas radiu blur circl increas ie plane focu get farther sensor plane figur 2 illustr effect figur 2a show imag f x form focus plane fourier spectrum f u v sensor plane displac distanc 1 gamma ffe defocus imag 2 convolut focus imag pillbox h 2 x shown figur 2b effect defocu spatial geometr model valid far imag exactli focus case wave optic model need describ point spread function assum len induc aberr small compar radiu blur circl born wolf1965 2 past investig use gaussian model instead pillbox model blur function mainli facilit mathemat manipul fourier transform gaussian function also gaussian convert quadrat function use logarithm see approach depth defocu form blur function use frequenc domain written 2 u sinc ff vari point point imag strictli speak spacevari system express convolut therefor equat 5 hold rigor sens howev assum ff constant small patch around pixel equat 5 remain valid within small patch hereon use term fourier transform spectrum assum small imag patch assumpt ff variat patch small valid patch must small practic realiz requir one forc use broadband filter kernel size linear filter invers proport bandwidth filter figur 2c similar b except sensor lie distanc 1 focus plane produc defocus imag 1 1 u note spectrum plot use polar coordin f r f spatial frequenc rather cartesian coordin u v defocu function usual rotat symmetr symmetri allow us express defocu spectrum use singl paramet name radial frequenc f see figur 2 sinc imag c defocus one b lowpass respons h 1 u v greater h 2 u v 23 depth two imag introduc normal ratio p u equival spatial domain spectrum f u v focus imag appear equat 5 6 get cancel normal ratio simpli 1 e 2fe x 122fe 1 ae 4fe p 1 e 1 e 2fe x 4fe p 1 e ft ft ft 122fe 1 ae b c2 figur 2 effect blur near far focus imag focus imag f fourier spectrum b pillbox defocu model h 2 fourier spectrum 2 blur imag c pillbox defocu model h 1 fourier spectrum 1 imag larger blur f radial frequenc figur 3 show relationship normal imag ratio mp normal depth ff sever spatial frequenc seen mp monoton function ff larg rule thumb frequenc rang equal width main lobe defocu function h maxim defocus ie distanc focus imag f sensor plane 2e zerocross defocu function figur 2 highest frequenc normal imag ratio mp monoton found given frequenc within bound sinc mp monoton function ff mp unambigu map depth estim fi shown figur 3 figur 3 relat normal imag ratio mp defocu paramet ff upper frequenc bound determin mp monoton function defocu paramet ff given frequenc within bound mp unambigu map depth estim fi besid serv critic role develop figur 3 also give us new way view previou approach depth defocu one method determin amplitud 1 2 spectra two defocus imag predefin radial frequenc f 2 uniqu depth estim obtain basic idea previou work base pentland1987 gokstorp1994 xiong shafer1995 although ratio use past simpli 1 2 rather normal ratio mp introduc magnitud two imag spectra predefin frequenc determin use linear oper convolut howev trivial problem imag textur unknown includ unpredict domin frequenc henc possibl fix priori frequenc interest problem may resolv use larg bank narrowband filter dens sampl frequenc space estim power larg number individu frequenc howev import tradeoff emerg implement narrowband linear oper gokstorp1994 xiong shafer1995 first approach clearli ineffici comput perspect furthermor uncertainti relat bracewell1965 tell us appli frequenc analysi small imag area frequenc resolut reduc proport invers area use obtain dens depth map one must estim h 1 h 2 use small area around pixel narrow filter spatial domain correspond broadband filter frequenc domain result oper output inevit averag local imag spectrum band frequenc sinc respons defocu function h depend local depth ff uniform within passband oper output oper best approxim focu measur result larg error depth given linear oper howev care design end pass band would desir set broadband oper togeth provid focu measur invari textur oper broadband small number could cover entir frequenc space avoid use extens filter bank result would effici robust highresolut depth estim next section describ method accomplish 3 ration oper set 31 model rel defocu use ration express establish monoton respons normal imag ratio mp normal depth defocu ff frequenc see equat 7 figur 3 object model relat close form would like model precis yet lead us small number linear oper depth recoveri end model function mp ration express two linear combin basi function basi function g p u v coeffici function frequenc u v u v ff residu error fit model function mp model accur residu error neglig becom possibl use model map normal imag ratio mp normal depth ff express rewritten ff left hand side repres actual depth scene point fi right estim depth differ two aris residu error nonzero normal ratio left side given us frequenc u v obtain depth estim fi solv equat 10 model normal imag ratio gener principl basi captur monoton structur normal ratio use specif discuss use basi chosen implement sinc respons mp ff oddsymmetr almost linear small radial frequenc f r see figur 3 could model respons use three basi function power fi equat 10 becom 3 term includ fi 3 seen small correct compens discrep mp linear model previou section know blur model complet determin mp given depth ff frequenc u v 3 found replac b p2 ff tanh aff give us slightli better fit defocu model pillbox function yet reduc comput cost solv equat 10 depth fi chosen simpl polynomi model polynomi model rfi u v therefor fit theoret mp equat 7 assum fi ff give us unknown ratio g p1 gm1 g p2 gm1 function frequenc u v case rotat symmetr blur model pillbox function ratio reduc function radial frequenc f r fix one coeffici function say g p1 u v coeffici determin ratio 4 therefor possibl determin coeffici function ensur polynomi model accur fit normal imag ratio mp given equat 7 figur 4 show exampl set base arbitrari select g p1 u v coeffici function g p1 g p2 gm1 case pillbox blur model gener form ration express equat 9 coeffici ration express determin multipl constant frequenc therefor u v unknown scale function coeffici function g p u v gm u v repres structur ratio obtain fit rfi u v ff frequenc respons unknown scale function u v need determin coeffici function without ambigu accomplish gener ration express describ section 41 examin well polynomi model fit plot figur 3 normal ratio precis interest know well model use estim depth end frequenc select true depth valu ff find correspond ratio mp use analyt express 7 ratio plug polynomi model 12 calcul depth estim fi use newtonraphson method process repeat frequenc let us rewrit equat 12 thirdord term consid small correct follow initi practic gp1 u v select arbitrarili restrict need consid exact select procedur discuss later section 41 gp1fr fq gp2fr fq gm1fr fq figur 4 exampl set coeffici function obtain fit polynomi model normal imag ratio mp g p1 u v chosen remain two function determin fit invari fr figur 5 depth fi estim use polynomi model equat 12 plot function spatial frequenc differ valu actual depth ff see estim depth equal actual depth invari frequenc within upper bound f r max given equat 17 valu provid newtonraphson method solut one iter figur 5 show estim depth fi practic purpos equal actual depth indic polynomi model inde accur estim depth invari insensit textur frequenc far radial frequenc f r f r max frequenc limit f r max respons ff shown figur 3 becom nonmonoton within region accur depth estim obtain practic imag convolv use passband filter ensur frequenc f r max remov rule thumb use determin f r max given equat 8 howev pillbox blur model found via numer simul f r max fact 12 time larger 5 limit given equat 8 e valuabl sideeffect introduc normal imag ratio mp util 20 frequenc spectrum inform convent method use ratio 1 2 32 ration oper set introduc ration express model normal ratio mp shown solut equat 10 give us robust depth estim frequenc within permiss rang thu far robust demonstr individu frequenc section show ration model use design small set broadband oper handl arbitrari textur 5 number increas 12 13 larger number newtonraphson iter use howev depth result addit rang numer stabl presenc nois sinc respons curv mp tend flatten henc use one iter take crossproduct equat 10 get integr entir frequenc space get invok power theorem bracewell1965 f u v gu v fourier transform function fx gx respect sinc conduct spatialfrequ analysi analyz frequenc content small area center around pixel right hand side equat 20 noth convolut impli cm ff c p ff actual function x determin convolut invers fourier transform gm u v short coeffici need comput depth use polynomi equat 19 determin convolv differ imag mx sum imag px linear oper spatial domain equival coeffici function refer ration oper output oper pixel x plug equat 19 determin depth fix exampl use model equat 12 depth recoveri equat becom substitut equat 22 ration oper noth invers fourier transform coeffici function shown figur 4 see though oper broadband see figur 4 recoveri equat independ scene textur provid effici mean comput precis depth estim 4 implement ration oper previou section describ theori underli ration oper section discuss variou design implement issu must address ensur ration oper produc accur depth defocu particular describ design procedur use optim ration oper kernel estim depth confid measur prefilt imag prior applic ration oper postprocess output oper sinc ration express model equat 9 gener focu simpler model equat 12 use experi howev procedur describ appli form ration model 41 design ration oper kernel sinc ration oper broadband linear filter implement small convolut kernel benefici two reason low comput cost b high spatial resolut howev shall see design problem trivial note deriv oper function g equat must ratio equal one obtain fit polynomi model normal imag ratio discrep ratio would natur caus depth estim error fortun base form function u v equat 13 remain discret adjust minim discrep impli u v select arbitrarili rather given conveni initi form optim clearli effect discrep ratio would vari frequenc henc depend textur properti scene design oper kernel therefor done minim object function repres ratio error frequenc relat depth estim error ratio error deriv appendix 72 argu appendix depth error kept minimum ratio error must satisfi follow oe gm1 u oe g p2 u oe gm1 u v oe g p2 u v determin weight function use minim error gm1 u v g p2 u v constant deriv express set u v equal g p1 u v ie g p1 u therefor equat 13 u g p2 u posit formul object function oper design follow oe gm1 oe gm1 p2 u v actual ratio design discret kernel gm1 u v g p2 u v ratio obtain previou section fit polynomi model normal imag ratio oe gm1 constant use ensur minim 2 produc trivial result zerovalu oper m1 0 0 actur dc respons design discret kernel g m1 gm1 0 initi valu summat discret frequenc sampl suffici dens kernel size n theta n frequenc sampl least 2n theta 2n order avoid gibb phenomenon oppenheim schafer1989 optim use 32 theta 32 sampl point 7 theta 7 kernel sinc 2 nonlinear minim done use levenbergmarquardt algorithm press et al1992 still need defin p u v ff equat 25 depend unknown textur imag howev sinc p u v ff use fix weight function equat 25 rough approxim suffic end assum distribut imag spectrum optim use correspond brownian motion 6 though p u v ff chang ff use approxim p u v 6 denot fractal dimens peitgen saupe1988 h two dimension case last issu concern base form function u equat 25 initi select made function refin optim 2 gm1 u must 0 order realiz gm1 u use finit kernel also g p1 u v must smooth without rapid fluctuat obtain ration oper small kernel implement impos rotat symmetri ad constraint use laplacian gaussian initi g p1 u v g p1 f r f peak f peak f peak radial frequenc g p1 maximum frequenc set 04f nyquist optim function use initi refin optim 2 exampl set discret ration oper obtain optim 2 present shortli 42 prefilt discuss prefilt need appli input imag 1 x purpos remov dc compon high frequenc appli ration filter dc compon harm small chang illumin two imag caus unanticip bia imag mx bia would propag error coeffici imag cm1 x sinc gm1 oper appli mx essenti lowpass filter turn would caus depth error end spectrum radial frequenc greater f r max see equat 17 also harm violat monoton properti mp need ration oper work therefor high frequenc must also remov although possibl emb desir prefilt within ration filter given prefilt done use linear oper chosen use separ prefilt follow reason sinc prefilt attempt cut low high frequenc tend larg kernel embed prefilt ration oper would requir oper also larg kernel thu result low spatial resolut well unnecessari addit comput hold true correspond case extrem fractal 15 correspond brownian motion correspond smooth imag final correspond white nois complet random imag 7 equat 12 mp zero ju vj 0 sinc ff nonzero 1gm1 u must zero equat 12 valid ration oper design prefilt pose optim object function let us defin desir frequenc respons prefilt fu v reason state earlier frequenc respons must cut dc compon high frequenc addit frequenc respons smooth rotat symmetr ensur small kernel size function desir properti laplacian gaussian given right hand side equat 28 use f defin object function oe pass oe stop frequenc respons design prefilt kernel oe pass oe stop repres weight assign passband stopband region prefilt respect stopband levenbergmarquardt algorithm press et al1992 use determin prefilt kernel 43 exampl set discret ration filter figur 6 7 show kernel frequenc respons ration oper prefilt deriv kernel size set 7theta7 ef pixel order make oper uniformli sensit textur direct impos constraint kernel must symmetr respect x axe well line constraint reduc number degre freedom dof kernel design problem case 7theta7 kernel dof reduc 10 reduc 6 6theta6 5theta5 kernel dof 6 small design oper desir frequenc respons therefor smallest kernel size chosen k 7 note passband respons prefilt figur 7 refin kernel size increas final design issu pertain maximum frequenc f r max sinc discret fourier transform kernel size k minimum discret frequenc period 1k difficult obtain precis respons frequenc region 1k spectrum region go suppress prefilt close dc compon therefor maximum frequenc f r max must well 1k express condit f r ks use equat 17 obtain 2e condit interpret follow maximum blur circl diamet 2ef e must smaller 73 kernel size k also intuit reason kernel larger blur circl seek measur blur 8 44 coeffici imag smooth appli prefilt ration oper figur 6 imag mx px obtain coeffici plug equat 23 comput depth fi howev problem aris solv depth c p1 x equat 24 close zero depth estim becom unstabl evid solut step equat 15 sinc frequenc respons g p1 x cut dc compon figur 5 zerocross usual common coeffici imag c p1 x ff also obviou imag area weak textur 9 c p1 x approach zero solv problem appli smooth oper coeffici imag enabl us avoid unstabl depth estim zerocross coeffici imag otherwis must remov ad hoc postfilt optim smooth oper minim depth error need analyt model depth error use depth recoveri equat 23 get drop paramet x breviti solv dfi get c p2 small correct factor follow approxim made c p1 denot standard deviat error cm1 c p1 c p2 oe cm1 oe cm1 oe cm1 respect simplifi matter assum error independ get hoel1971 oe fi 8 sinc condit relat kernel size rough suggest linear depth estim check use synthet imag find best kernel size k evalu report experiment section 9 weak textur equival low spectrum power high frequenc region gamma000133 00453 01799 0297 01799 00453 gamma000133 00453 04009 08685 1093 08685 04009 00453 01799 08685 2957 4077 2957 08685 01799 0297 1093 4077 6005 4077 1093 0297 01799 08685 2957 4077 2957 08685 01799 00453 04009 08685 1093 08685 04009 00453 gamma000133 00453 01799 0297 01799 00453 gamma000133c c c c c c c c c c c c gamma003983 gamma009189 gamma0198 gamma0259 gamma0198 gamma009189 gamma003983 gamma009189 gamma03276 gamma04702 gamma04256 gamma04702 gamma03276 gamma009189 gamma0259 gamma04256 1393 3385 1393 gamma04256 gamma0259 gamma009189 gamma03276 gamma04702 gamma04256 gamma04702 gamma03276 gamma009189 005685 gamma002031 gamma006835 gamma006135 gamma006835 gamma002031 005685 gamma002031 gamma006831 005922 01454 005922 gamma006831 gamma002031 gamma006835 005922 01762 gamma001998 01762 005922 gamma006835 gamma006135 01454 gamma001998 gamma0698 gamma001998 01454 gamma006135 gamma006835 005922 01762 gamma001998 01762 005922 gamma006835 gamma002031 gamma006831 005922 01454 005922 gamma006831 gamma002031 005685 gamma002031 gamma006835 gamma006135 gamma006835 gamma002031 005685c c c c c c c c c c c c pref ilter gamma0143 gamma01986 gamma01056 gamma007133 gamma01056 gamma01986 gamma0143 gamma01986 gamma01927 001795 007296 001795 gamma01927 gamma01986 gamma01056 001795 02843 04601 02843 001795 gamma01056 gamma007133 007296 04601 06449 04601 007296 gamma007133 gamma01056 001795 02843 04601 02843 001795 gamma01056 gamma01986 gamma01927 001795 007296 001795 gamma01927 gamma01986 gamma0143 gamma01986 gamma01056 gamma007133 gamma01056 gamma01986 gamma0143c c c c c c c c c c c c figur ration oper kernel deriv use kernel size 7theta7 ef pixel regardless scene textur passiv depth defocu accomplish use small oper set u001003a g m1 b g p1 u00050015c g p2 prefilt figur 7 frequenc respons ration oper shown figur 6 express use give us estim depth error invers estim 1oe fi 2 view depth confid measur use combin adjac depth estim maximum likelihood sens obtain accur depth estim also one wish appli depth defocu differ scale use pyramid framework jolion rosenfeld1994 burt adelson1983 darrel wohn1988 gokstorp1994 confid measur use combin depth valu differ level pyramid equat 34 oe c m1 oe c p1 oe c p2 constant defin readout nois imag sensor use frequenc respons ration oper hand fi assum local constant sinc depth expect vari smoothli point imag fact lead us error model place develop method coeffici imag smooth multipli equat 23 c p1 x ff sum depth valu neighborhood r pixel get c p1 x c p1 x fi depth estim coeffici smooth sinc last term equat 36 23 small correct fi approxim fi c p1 c p1 x c p1 c p1 equat 35 see fi weight averag raw depth estim fi neighborhood r weight 1oe fi 2 x statist hoel1971 know optim weight averag independ variabl whose varianc oe 2 obtain weight x 1oe 2 therefor weight averag depth estim view optim varianc oe 2 result depth estim fi given byoe 2 henc coeffici smooth equat 36 optim minim 10 error estim depth fi addit result smooth coeffici c p1 x proport invers varianc fi ie 1oe fi 2 clear equat 35 37 38 therefor smooth coeffici c p1 x ff use confid measur postprocess comput depth map anoth method cope zerocross cp1 coeffici imag base hilbert approach detail watanab nayar1995a prefilt prefilt far focus imag near focus imag ration oper coeffici smooth depth comput figur 8 flow depth defocu algorithm use datacub mv200 pipelin processor entir algorithm execut littl 016 msec obtain 512theta480 depth map 45 algorithm figur 8 illustr flow depth defocu algorithm implement far near focus imag first ad subtract produc px mx respect convolv prefilt subsequ three ration oper result coeffici imag smooth local averag final step comput depth coeffici use singl iter newtonraphson method use equat 15 16 altern depth comput achiev use precomput twodimension lookup tabl lookup tabl configur take c 0 input provid depth fix output summari depth map gener 5 twodimension convolut simpl smooth coeffici imag straightforward depth comput step oper execut effici use pipelin imag processor one use datacub mv200 pipelin processor comput realiz use 10 pipelin entir depth defocu algorithm execut 016 msec imag size 512theta480 effici algorithm come use ration oper set far superior exist depth defocu algorithm attempt comput accur depth estim xiong shafer1993 gokstorp1994 5 experi 51 experi synthet imag first illustr linear depth estim invari textur frequenc use synthet imag synthet imag shown figur 9 correspond planar surfac inclin away sensor normal depth valu 0 top 255 bottom plane includ 10 vertic strip differ textur properti left 7 strip textur narrow power spectra whose central frequenc 0015 003 008 013 018 025 035 left right th strip white nois next two strip fractal dimens 3 25 respect peitgen saupe1988 near far focus imag gener use pillbox blur model defocu condit use ef pixel experi digit imag use size 640theta480 depth map estim use 7theta7 ration oper 5theta5 coeffici smooth shown gray code imag figur 9c wirefram figur 9d evid propos algorithm produc high accuraci despit signific textur variat vertic strip figur summar quantit result obtain experi figur includ plot gradient estim depth map b rm root mean squar error oe comput depth c averag confid valu point squar plot correspond one strip imag number left right see number next squar note gradient estim depth map noth depth detect gain figur 10a show gain invari except left three strip slight gain error left three strip ratio gm1 u vg p1 u v high low frequenc result farfocus imag b nearfocus imag c graycod depth map wirefram depth map figur 9 depth defocu appli synthet imag inclin plane accur recov despit signific textur variat g p1 u v small low frequenc region small error g p1 u v caus larg error ratio low valu g p1 u v lowfrequ textur reflect extrem low confid valu correspond strip howev low frequenc cut prefilt depth error suppress exist frequenc compon one want util low frequenc pyramid jolion rosenfeld1994 darrel wohn1988 construct ration filter appli level pyramid depth map comput differ level pyramid combin maximumlikelihood sens use confid measur easili comput along coeffici imag use equat 34 figur 10b c show rough agreement confid measur plot function 1oe 2 02center freq101103105gain 1f 1f 1f a02cent freq c 1f 1f 1f b0408confid 1f 1f 1f 15freq distribut confidence4080120246 figur 10 analysi depth error textur inclin plane shown figur 9 point squar plot correspond singl textur strip inclin plane number 110 gradient comput depth map correspond depth detect gain invari depth estim imag textur evid b rm error oe comput depth c depth confid valu seen rough agreement 1oe 2 figur 11 synthet imag gener assum staircas like threedimension structur step staircas textur use figur 9 comput depth map accur depth discontinu sens sharp preserv demonstr high spatial resolut propos algorithm spike two left strip due extrem low depth confid valu area case natur textur enough textur contrast low confid valu unlik frequenc textur provid suffici inform robust depth estim graycod depth map wire frame plot depth map figur 11 depth defocu appli synthet imag staircas textur stair strip figur 9 depth discontinu estim high accuraci reflect high spatial resolut produc propos algorithm 52 experi real imag imag real scene taken use soni xc77 monochrom camera len use cosmicar b1214d2 f25mm len convert telecentr len use addit apertur make magnif invari defocu see appendix watanab nayar1995b result telecentr imag shift far near focus imag lower 110 pixel len apertur set f83 farfocus imag 1 taken len focus 869mm camera nearfocus imag 2 len focus 529mm two distanc chosen scene point lie focu set result maximum blur circl radiu ef pixel two focu set 256 imag averag 85 sec get imag high signaltonois ratio figur 12 show result obtain scene includ varieti textur figur 12a b farfocus nearfocus imag respect figur 12c comput depth map wirefram plot depth map curv planar surfac detect high fidel high resolut without postfilt 9theta9 median filter get even better depth map shown figur 12e farfocus imag b nearfocus imag c graycod depth map without postfilt wirefram plot c wirefram plot 9theta9 median filter figur 12 depth defocu algorithm appli real scene complex textur figur 13 show result scene includ area extrem weak textur white background clay cup figur 13a b farfocus nearfocus imag respect figur 13c comput depth map wirefram plot imag area except white background area produc accur depth estim depth confid valu oe textur background 05 object distanc 11 error tabl surfac 10 rel object distanc even white background area reason depth map despit fact textur weak see confid map figur 13e reflect lack textur motiv us develop modifi algorithm call adapt coeffici smooth repeatedli averag coeffici comput ration oper confid valu reach certain accept level figur 13f show depth map comput use algorithm last experi seek quantifi accuraci depth estim target use plane paper similar textur background scene figur 12 plane move step 25mm depth map plane comput posit sinc estim depth fi measur imag side map object side use len law equat 2 optic set process condit use previou experi plot figur 14 illustr algorithm excel depth estim linear rm error line fit measur depth 42 mm slight curvatur plot probabl due error optic set focal length apertur depth valu 50theta50 area use estim rm depth error posit planar surfac figur 14 rm error plot sigmao error bar rm error rel object distanc seen vari object distanc 04 08 close object 08 12 object farther 880 mm partli map depth measur imag side depth object side reason error estim depth oe fi larger scene point larger fi seen equat 34 note rm error depend coeffici smooth postfilt stage found empir error gaussianlik distribut use distribut one show error reduc factor 18 depth map convolv 8theta8 averag filter definit error often use quantifi perform rang sensor farfocus imag b nearfocus imag c graycod depth map wirefram depth map confid valu 12 map f wirefram adapt coeffici smooth figur 13 depth defocu appli scene includ weak textur white background larger error region weak textur reflect confid map adapt coeffici smooth algorithm use confid map refin depth estim region weak textur actual depth mm estim depth fit error figur 14 depth estim linear textur plane plane move increment 25mm away len plot distanc measur len rm error rel object distanc 04 12 6 conclus propos class ration oper passiv depth defocu though oper broadband use togeth provid invari scene textur sinc broadband small number oper suffici cover entir frequenc spectrum henc ration oper replac larg filter bank expens comput perspect advantag come without need sacrific depth estim accuraci resolut detail procedur use design ration oper exampl construct 7theta7 oper use polynomi model normal imag ratio howev notion ration oper gener repres complet class filter design procedur describ use construct oper base ration model normal imag ratio ration oper deriv desir blur function addit ration oper discuss wide rang issu pertin depth defocu particular detail analys techniqu provid prefilt near far focus imag well postprocess output ration oper oper output also use deriv depth confid measur measur use enhanc comput depth map propos depth defocu algorithm requir total 5 convolut test algorithm use synthet scene real scene evalu perform found depth detect gain error less 1 regardless textur frequenc depth accuraci found 05 12 object distanc sensor result sever natur extens sinc scene area expect low textur frequenc would meaning emb propos scheme pyramidbas process framework imag area domin low frequenc higher frequenc higher level pyramid propos algorithm appli level pyramid result depth map combin use depth confid measur b given effici al gorithm worth implement realtim version use pipelin imag process architectur datacub mv200 estim algorithm would result least 6 depth map per second 512theta480 resolut c present im plement vari posit imag sensor chang focu set altern apertur size vari ration oper deriv optic setup use basi function b p1 see watanab nayar1995a final would worthwhil appli algorithm outdoor scene larg structur appendix 71 problem imag registr ration oper give accur result farfocus imag 1 near focus imag 2 need precis regist within 01 pixel respect one anoth howev convent lens magnif vari focu set henc misregistr introduc experi mechan chang focu set process introduc translat two imag len aberr small misregistr decompos two factor global magnif chang global translat two factor magnif chang prove much harm chang correct use imag warp techniqu darrel wohn1988 wolberg1990 howev gener introduc undesir effect smooth alias sinc warp base spatial interpol resampl techniqu use optic solut problem describ follow section detail watanab nayar1995b 711 telecentr optic imag system shown figur 1 effect imag locat point p move along princip ray r sensor plane displac caus shift imag coordin imag p variat imag magnif defocu manifest correspond like problem depth defocu correspond point imag need estim blur approach problem optic perspect rather comput one consid imag format model shown figur 15 modif made respect model figur 1 use extern apertur 0 apertur place frontfoc plane ie focal length front princip point len simpl addit solv problem magnif variat distanc ff sensor plane len simpl geometr analysi reveal ray light r 0 scene point pass center 0 apertur 0 emerg parallel optic axi imag side len kingslake1983 result despit blur effect imag coordin point p imag 1 coordin focus imag q f given offth shelf len apertur easili append case len result optic system call telecentr len nomin effect fnumber classic optic figur 1 fa respect equal fa 0 telecentr case magnif chang reduc order less 003 ie 01 pixel 640theta480 imag detail discuss telecentr implement found watanab nayar1995b recent use idea develop realtim activ depth defocu sensor nayar et al1995 watanab et al1995 712 translat correct seen previou section magnif chang farfocus nearfocus imag avoid focu set chang translat may also introduc translat correct done use imag process without introduc harm imag artifact howev process must care r f f figur 15 constantmagnif imag system depth defocu achiev simpli place apertur frontfoc plane optic result telecentr optic avoid need regist farfocus nearfocus imag watanab nayar1995b implement sinc seek 01 pixel registr two imag procedur use briefli describ detail watanab nayar1995b use fftphase base local shift detect estim shift vector subpixel accuraci divid fourier spectra correspond local area two imag fit plane phase ratio spectra gradient fit plane noth rel shift two imag get shift vector sever posit imag similar transform use model shift vector field fit vector similar model estim global translat residu magnif chang separ watanab nayar1995b residu magnif correct tune apertur posit telecentr optic translat correct shift imag opposit direct need subpixel accuraci interpol imag resampl gener regist imag interpol function lanczos4 window sinc function wolberg 1990 sinc translat correct remain constant entir imag singl shift invari convolut achiev desir shift though convolut distort imag spectrum sinc imag undergo amount shift distort imag common distort elimin normal imag ratio mp comput applic ration filter translat correct found maximum registr error experi small 002 pixel 72 oper respons depth error deviat ratio function g p u v gm u v filter design obtain fit polynomi model normal imag ratio vari frequenc u v henc depend textur scene filter design describ section 41 need relat ratio error depth estim error start equat 12 get g p1 u v g p2 u v fi f u v depth estim singl frequenc u v sinc u v ratio condit 13 fix defin g p1 u becom differenti get mu v ff p u v ff treat constant sinc wish find error fi f u v caus error gm1 u v g p2 u v solv dfi f u v get sinc g p2 u v small correct factor approxim equat 23 20 sinc c p2 c p1 c p2 repres small correct depth estim fi approxim integr frequenc du dv henc error fi caus error fi f u v combin express equat 43 du dv optim valu dgm1 u v dg p2 u v would minim depth error dfi question trivial dgm1 u v dg p2 u v influenc complex way avoid either two term integrand numer take disproportion larg valu decid assum term constant valu give us follow bound dgm1 u v dg p2 u v oe gm1 u oe g p2 u jfi f u vj set 1 repres worst case ie largest normal depth error acknowledg research conduct center research intellig system depart comput scienc columbia univers support part product engin research laboratori hitachi part david lucil packard fellowship author thank yasuo nakagawa hitachi ltd support encourag work r rang imag sensor principl optic fourier transform applic laplacian pyramid compact imag code pyramid base depth focu matrix base method determin depth focu comput depth outoffocu blur use local frequenc represent introduct mathemat statist focus memo 160 robot vision perspect rang find techniqu comput vision pyramid framework earli vision optic system design journal comput vision shape focu effect approach rough surfac scienc fractal imag new sens depth field numer recip c depth defocu spatial domain approach parallel depth recoveri chang camera paramet minim oper set textur invari depth defocu telecentr optic constantmagnif imag digit imag warp depth focus defocus moment filter high precis comput focu stereo tr ctr boissenin j wedekind n selvan b p amavasai f caparrelli j r travi comput vision method optic microscop imag vision comput v25 n7 p11071116 juli 2007 n rajagopalan chaudhuri uma mudenagudi depth estim imag restor use defocus stereo pair ieee transact pattern analysi machin intellig v26 n11 p15211525 novemb 2004 lime chen georgi kukharev tomasz ponikowski pca reconstruct base approach extend facial imag databas face recognit system enhanc method comput secur biometr artifici intellig system springerverlag london 2005 boissenin j wedekind n selvan b p amavasai f caparrelli j r travi comput vision method optic microscop imag vision comput v25 n7 p11071116 juli 2007 vinay p namboodiri subhasi chaudhuri defocu diffus depth estim pattern recognit letter v28 n3 p311319 februari 2007 paolo favaro stefano soatto geometr approach shape defocu ieee transact pattern analysi machin intellig v27 n3 p406417 march 2005 reinhard erum arif khan depthoffieldbas alphamatt extract proceed 2nd symposium appli percept graphic visual august 2628 2005 coroa spain lyubomir zagorchev ardeshir goshtasbi paintbrush laser rang scanner comput vision imag understand v101 n2 p6586 februari 2006