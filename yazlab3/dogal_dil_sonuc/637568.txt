step toward accur reconstruct phylogeni geneord data report progress reconstruct phylogeni geneord data develop polynomialtim method estim genom distanc greatli improv accuraci tree obtain use popular neighborjoin method also improv run time grappa softwar suit combin tighter bound better use bound present new experiment result extend present ismb01 wabi01 demonstr accuraci robust distanc estim wide rang model condit moreov use best distanc estim ede grappa softwar suit along sophist bound techniqu produc spectacular improv alreadi huge speedup wherea earlier experi show onemillionfold speedup run 512processor cluster latest experi demonstr speedup one hundr million combin variou advanc enabl us conduct new phylogenet analys subset campanulacea famili confirm variou conjectur relationship among member subset confirm invers view princip mechan evolut chloroplast genom give repres result extens experiment conduct real simul dataset order valid character approach b introduct genom rearrang modern laboratori techniqu yield order stranded gene chromosom allow us repres chromosom order sign gene sign indic strand evolutionari event alter order rearrang invers transposit collect call genom rearrang event rare give us inform ancient event evolutionari histori group organ consequ mani biologist embrac new sourc data phylogenet work 16 26 27 29 appropri tool analyz data remain primit compar develop dna sequenc data thu develop tool becom import area research attest recent meet topic 14 15 optim problem natur optim problem phylogeni reconstruct geneord data reconstruct evolutionari scenario minimum number permit evolutionari event treewhat known parsimoni tree unfortun problem nphard criteriaeven simpl problem comput median three genom model nphard 9 28 howev suboptim solut yield differ evolutionari reconstruct exact solut strongli prefer approxim solut see 33 moreov rel probabl rearrang event invers transposit invert difficult estim overcom latter problem blanchett et al 5 propos use breakpoint phylogeni tree minim total number breakpoint breakpoint adjac two gene present one genom neighbor tree note construct breakpoint phylogeni remain nphard 7 method reconstruct phylogeni blanchett et al develop bpanalysi 31 softwar implement variou heurist breakpoint phylogeni reimplement extend approach grappa 17 softwar run sever order magnitud faster thank algorithm engin techniqu 24 heurist solv breakpoint phylogeni problem propos 8 12 13 rather attempt deriv parsimoni tree approxim thereof use exist distancebas method neighborjoin nj 30 perhap popular phylogenet method conjunct method defin leaftoleaf distanc phylogenet tree leaftoleaf distanc comput linear time current includ breakpoint distanc invers distanc latter thank new algorithm 3 also estim true evolutionari distanc rather expect true evolutionari distanc specif model evolut work backward breakpoint distanc minimum invers distanc approach suggest sankoff 32 caprara 10 develop us seri paper 23 34 35 show estim significantli improv accuraci tree obtain use neighborjoin method result paper paper report new experiment result use distanc estim reconstruct phylogeni geneord data use simul real data present sever new result first two extens result present ismb01 23 third extens result present 510 moret tang wang warnow simul studi examin relationship true evolutionari distanc distanc estim find distanc estim give good predict actual number event varieti model condit includ match assumpt simul studi examin relationship topolog accuraci neighborjoin specif distanc measur use breakpoint invers one three distanc estim find neighborjoin significantli better distanc estim breakpoint invers distanc detail investig robust neighborjoin use distanc estim assum rel probabl three rearrang event differ true rel probabl find neighborjoin use estim remark robust hardli show worsen even erron assumpt detail studi efficaci use best distanc estim significantli improv lower bound still comput low polynomi time invers length candid phylogeni novel way structur search maxim use bound find combin yield much stronger bound natur occur rang evolutionari rate yield addit speedup one two order magnitud grappa code success analysi dataset campanulacea bluebel flower use combin techniqu result onehundredmillionfold speedup origin approachin particular abl analyz dataset singl workstat hour wherea previou analysi requir use 512node superclust research combin develop mathemat techniqu extens experiment perform studi present crosssect result experiment studi conduct character valid approach use larg varieti simul dataset well sever real dataset chloroplast mitochondri genom test speed sequenti parallel implement robust particular mismatch model efficaci new bound techniqu accuraci reconstruct distanc estim 2 background 21 nadeautaylor model evolut genom set gene gene appear exactli genom describ order circular linear gene gene given orient either posit g neg g let g genom sign order g 1 g 2 g k invers indic b b produc genom linear order transposit linear circular order g act three indic b c b c b pick interv g g a1 g b insert immedi g c thu genom g assumpt c b replac invert transposit transposit follow invers transpos subsequ gener nadeautaylor model 25 genom evolut use genom rearrang event genom retain equal content model assum number three type event obey poisson distribut edg rel probabl type event fix across tree event given type equiprob thu repres nadeautaylor model tree triplet e triplet defin rel probabl three type event invers transposit invert transposit instanc triplet 1 1 1 indic three event class equiprob triplet 1 0 0 indic invers happen 22 distancebas estim phylogeni given tree set genom given two leav j denot path j let e denot number event invers transposit invert transposit edg e evolut genom within tree actual number event edg defin actual distanc addit given addit matrix mani distancebas method guarante reconstruct tree edg weight root atteson 1 show nj guarante reconstruct true tree given estim addit matrix ij long estim bound error theorem 21 1 let binari tree let e ij defin describ let let n n dissimilar matrix ie symmetr zero diagon x nj tree njd comput ident nj guarante reconstruct true tree topolog input distanc matrix suffici close addit matrix defin tree topolog consequ techniqu yield good estim matrix ij signific interest distanc measur edit distanc two gene order minimum number invers transposit invert transposit need transform one gene order invers distanc edit distanc invers permit invers distanc comput linear time 3 18 transposit distanc unknown comput complex 4 given two genom g g set gene breakpoint g order pair gene g g b g g b appear consecut order g neither g g b g b g appear consecut order g number breakpoint g rel g breakpoint distanc g g breakpoint distanc easili calcul inspect linear time see figur 1 exampl distanc estim true evolutionari distanc estim true evolutionari distanc requir assumpt model case geneord evolut assumpt 512 moret tang wang warnow fig 1 exampl transposit invers breakpoint distanc obtain g 3 g 0 3 invers gene invers interv highlight step g 3 also obtain g 0 one transposit move gene segment 6 7 8 posit gene 1 3 b transposit invers breakpoint distanc respect genom evolv common ancestor nadeautaylor model evolut sankoff techniqu 32 applic invers calcul valu exactli iebp 35 ede 23 applic gener model evolut obtain approxim valu exactiebp 34 calcul valu exactli combin invers transposit invert transposit estim comput low polynomi time 23 perform criteria let tree leaflabel set delet edg e produc bipartit e two set let true tree let estim illustr figur 2 fals neg respect denot fnt bipartit appear appear fals neg rate number fals neg divid number nontrivi bipartit similarli fals posit respect defin bipartit appear fals posit rate ratio fals posit number nontrivi edg exampl figur 2 edg correspond bipartit 1 2 3 4 5 6 7 8 present true tree estim thu fals neg note tree binari number fals neg equal number fals posit report result use fals neg rate254713 57 4 true tree b estim fig 2 fals posit fals neg edg true tree reconstruct tree bold edg fals neg edg fals posit edg b 3 true distanc estim 31 definit given two sign permut comput breakpoint distanc one edit minimum distanc invers distanc actual number evolutionari event directli recover done estim number assumpt model evolut thu true distanc estim return like number evolutionari event given breakpoint invers distanc develop three estim iebp estim 35 approxim like number evolutionari event work breakpoint distanc use simplifi analyt deriv exactiebp estim 34 refin analyt deriv return exact valu quantiti ede estim 23 use curv fit approxim like number evolutionari event work invers distanc three estim provid consider accur estim true evolutionari distanc breakpoint invers distanc least larg moreov tree obtain appli neighborjoin method estim accur obtain also use neighborjoin base upon breakpoint distanc invers distanc 32 comparison distanc estim simul nadeautaylor model evolut differ weight set studi behavior differ distanc estim number gene dataset 37 anim mitochondria 6 120 chloroplast genom mani plant 20 dataset experi chose number 1 upper bound b number rearrang event b chosen 25 time number gene accord experiment result enough make distanc two genom similar distanc two random genom comput bp breakpoint inv invers distanc correct get iebp exactiebp ede distanc figur 3 4 5 plot unnorm comput distanc actual number eventsus inversiononli scenario case 37 gene scenario equal like event well inversiononli scenario case 120 gene figur indic expect bp inv distanc underestim actual number eventsalthough number event low highli accur small varianc linear regionth rang xcoordin valu curv straight linei longer inv distanc bp distanc inv distanc produc unbias estim larger rang bp distanc contrast three estim provid good estim averag although varianc increas sharpli edit distanc valu exactiebp produc good estim rang clearli improv iebp ede tend underestim distanc unless scenario use invers also plot differ actual true evolutionari distanc minimum estim distanc variou model evolut mixtur inver sion transposit invert transposit two differ genom size 37 120 variou number event rate evolut figur 6 show result three differ model evolut 37 120 gene respect valu plot cumul fashion posit x along horizont axi plot mean absolut differ gener pair true evolutionari distanc x figur show exactiebp usual best choic ede distanc 514 moret tang wang warnow breakpoint distanc actual number event invers distanc actual number event bp distanc b inv distanc iebp distanc actual number event exactiebp distanc actual number event distanc actual number event c iebp distanc exactiebp distanc e ede distanc fig 3 mean standard deviat plot two distanc three distanc estim 37 gene inversiononli scenario dataset divid bin accord xcoordin valu bp inv distanc actual number event actual number event bp distanc b inv distanc actual number event actual number event actual number event c iebp distanc exactiebp distanc e ede distanc fig 4 mean standard deviat plot two distanc three distanc estim 120 gene scenario three type event equal like dataset divid bin accord xcoordin valu bp inv distanc actual number event actual number event bp distanc b inv distanc actual number event actual number event actual number event c iebp distanc exactiebp distanc e ede distanc fig 5 mean standard deviat plot two distanc three distanc estim 120 gene inversiononli scenario dataset divid bin accord xcoordin valu bp inv distanc actual number event absolut differ actual number event absolut differ actual number event absolut differ invers b transposit c equal like event actual number event absolut differ actual number event absolut differ actual number event absolut differ invers b transposit c equal like event fig 6 mean differ true evolutionari distanc five distanc estim three model evolut plot function tree diamet 37 gene top 120 gene bottom 516 moret tang wang warnow nearli good occasion better model use inversionsalthough varianc larger distanc high make difficult draw firm conclus iebp ede clearli improv bp inv 33 neighborjoin perform conduct simul studi compar perform nj use five distanc figur 7 plot fals neg rate normal pairwis invers distanc three differ model weight set 1 0 0 1 transposit 1 1 1 three event equal like plot pool result model weight differ number genom 10 20 40 80 160 note njede remark robust even though ede engin inversiononli scenario handl dataset signific number transposit invert transposit almost well njede recov 90 edg even nearli satur dataset maximum pairwis invers distanc close 90 maximum valu njede improv njiebp spite fact iebp compar estim may attribut greater precis smaller varianc ede smaller distancesmost choic made neighborjoin made among small distanc ede like return approxim within small factor true distanc exactiebp expens three estim comput yield second best perform although differ error rate njede njexactiebp small statist signific normal maximum pairwis invers distanc fals neg rate normal maximum pairwis invers distanc fals neg rate normal maximum pairwis invers distanc fals neg rate invers b transposit c equal like event fig 7 fals neg rate nj method variou distanc estim function maximum genom result differ number genom pool singl figur model weight ident 34 robust distanc estim discuss earlier estim true evolutionari distanc requir assumpt model paramet case ede assum evolut proceed invers onlyso well njede perform face dataset produc combin transposit invert transposit case two iebp method comput requir valu respect rate inver sion transposit invert transposit respect obvious leav lot room mistaken assumpt ran seri experi condit similar shown earlier deliber mismatch evolutionari paramet use product dataset use comput distanc estim use nj figur 8 show result exactiepb estim result 1515normal maximum pairwis invers distanc fals neg rate 1515normal maximum pairwis invers distanc fals neg rate 1515normal maximum pairwis invers distanc fals neg rate invers b transposit c equal like event fig 8 robust exactiebp method respect model paramet tripl legend indic model valu use exactiebp method estim similar indic estim use conjunct nj remark robust face erron model assumpt 4 maximum parsimoni topolog accuraci main goal phylogeni reconstruct produc correct tree topolog two basic approach current use phylogeni reconstruct whole genom distancebas method nj appli techniqu estim distanc maximum parsimoni mp approach attempt minim length tree suitabl defin measur length examin two specif mp problem section breakpoint phylogeni prob lem seek minim total number breakpoint tree edg phylogeni problem seek minim total number invers want determin use simul studi whether topolog accuraci improv reduc number invers number breakpoint possibl also want determin whether breakpoint phylogeni problem invers phylogeni problem topolog accur certain evolutionari condit condit ran larg seri test model tree investig hypothesi minim total breakpoint distanc invers length tree would yield topolog accur tree ran nj total 209 dataset invers breakpoint distanc test consist least 12 data point set 40 genom use two genom size 37 120 gene repres mitochondri chloroplast genom respect variou ratio invers transposit invert tran posit well variou rate evolut dataset comput total invers breakpoint distanc compar valu percentag error measur fals neg use nonparametr coxstuart test 11 detect trendsi test whether reduc breakpoint invers distanc consist reduc topolog error use 95 confid level found 97 dataset invers distanc 96 breakpoint distanc exhibit trend inde even 999 confid level 82 dataset still exhibit trend figur show result score differ nj tree two optim criteria breakpoint score invers length tree gener rel order trend curv agre curv figur 7 suggest de 110210611normal maximum pairwis invers distanc rel breakpoint score breakpoint score 37 gene 110210611normal maximum pairwis invers distanc rel invers length c invers length 37 gene 110210611normal maximum pairwis invers distanc rel breakpoint score b breakpoint score 120 gene 110210611normal maximum pairwis invers distanc rel invers length invers length 120 gene fig 9 score nj method variou distanc estim function maximum pairwis invers distanc 10 20 40 genom plot ratio nj tree score model tree score breakpoint invers inversiononli model tree 110210611normal maximum pairwis invers distanc rel breakpoint score breakpoint score 37 gene 110210611normal maximum pairwis invers distanc rel invers length c invers length 37 gene 110210611normal maximum pairwis invers distanc rel breakpoint score b breakpoint score 120 gene 110210611normal maximum pairwis invers distanc rel invers length invers length 120 gene fig 10 score nj method variou distanc estim function maximum pairwis invers distanc 10 20 40 genom plot ratio nj tree score model tree score breakpoint invers model tree three class event equiprob creas number invers breakpoint lead improv topolog accuraci correl strongest 120gene case may number event larger number gene rate evolut effect goe overlap event becom less like final trend still hold evolutionari model transposit occur 5 search maximum parsimoni tree 51 lower bound use follow theorem well known theorem 51 let n n matrix pairwis distanc taxa set let tree leaflabel taxa let w edgeweight circular order leav planar embed corollari immedi follow corollari 51 let matrix minimum distanc everi pair genom set let fix tree let 1 2 n circular order leav planar embed length least 1d 12 corollari form basi old twice around tree heurist tsp base minimum span tree 19 note theorem corollari hold distanc measur obey triangl inequ earlier work 22 24 use bound simpl manner reduc cost search tree space obtain initi upper bound minimum achiev invers length use nj invers distanc upper bound updat everi time search find better tree tree examin present standard nestedparenthes format nexu format 21 format defin particular circular order leav use order comput lower bound corollari 51 use invers distanc lower bound exce upper bound tree discard bound may reduc run time substanti bound comput effici wherea score tree tool like grappa 17 involv solv numer tsp instanc howev rate evolut high size genom bound often prove looseth bound exact distanc addit high rate evolut produc distanc much smaller addit valu thu set improv bound well use context grappa prune tree score new result come three separ idea tighten lower bound ii return accur score tree larg edg length iii process tree take better advantag bound 52 tighten bound particular circular order defin tree descript one larg number circular order compat tree sinc tree intern order ie notion left vs right child swap two subtre alter 520 moret tang wang warnow phylogeni yield differ circular order order defin valid lower bound could search order retain largest bound produc order tighten bound unfortun number compat circular order exponenti number leav full search ex pensiv develop test fast greedi heurist swapasyougo provid highqual approxim optim bound heurist start given tree impli circular order travers tree preorder arbitrarili chosen initi leaf decid local node whether swap children comput score result circular order move toward larger valu standard greedi fashion increment comput search take linear time swap alter coupl adjac differenti cost swap comput constant time experi result bound alway close even equal optim bound much better origin valu almost case test relat bound techniqu propos bryant 8 found slow order yield reason tight bound requir introduct lagrangian variabl solut system linear equat determin valu alway experi domin algorithm sinc use bound strictli reduc total amount work essenti lower bound comput littl effort 53 accur score long edg long edg tree suffer problem larg leaftoleaf distanc serious underestim edit distanc comput thu decid use remedi present first part paper correct edit distanc one true distanc estim chose ede estim offer best tradeoff accuraci comput cost three estim use within grappa wherev distanc comput comput distanc matrix nj comput circular lower bound matrix importantli comput distanc along edg comput medianofthre lie heart grappa approach 24 distanc estim effect stretch rang possibl valu stretch pronounc edit distanc alreadi larg worst case circular bound use distanc estim yield signific benefitsa number challeng instanc suddenli becam tractabl combin ede distanc improv circular bound 54 layer search ad third signific improv bound scheme sinc bound longer significantli improv obtain better prune requir better use bound origin approach prune 24 simpli enumer tree keep score best tree date upper bound comput lower bound new tree decid whether prune score approach tree gener bound score upper bound use comput may quit poor close end optim nearoptim tree appear toward end enumerationin case program must score nearli everi tree remedi problem devis novel radic differ approach motiv fact gener bound tree inexpens wherea score one involv solv potenti larg number instanc travel salesperson problem expens new approach call layer search still bound tree still score typic examin tree work follow first phase comput nj tree use ede distanc score obtain initi upper bound origin code second phase everi tree turn gener lower bound comput describ bound compar cost nj tree tree prune away store along comput lower bound bucket order valu lower bound 3 begin layer search proce principl lower bound tree correl actual parsimoni score tree search look success bucket tree turn score tree prune lower bound updat upper bound whenev better score found search techniqu applic class optim problem cost evalu object solut space much larger cost gener object work well whenev good correl lower bound valu optim solut experi indic unless interleaf distanc nearli maxim given number gene correl lower bound parsimoni score quit strong layer search strategi quickli reduc upper bound score optim nearli therebi enabl drastic better prune detail frequent observ prune rate 99999 55 experiment assess bound measur percentag tree prune bound thu score function three model paramet number genom number gene number invers per edg use inversiononli scenario well one approxim half invers half transposit invert transposit data consist two collect 10 dataset combin paramet number genom 10 20 40 80 160 number gene 10 20 40 80 160 rate evolut vari 2 8 event per tree edg total 75 paramet combin 1500 dataset use ede distanc score edg swapasyougo bound comput layer searchbecaus layer search requir enumer tree front someth simpli possibl 20 genom data set 10 genom grappa test tree score updat upper bound necessari kept statist prune rate 20 genom number tree well beyond realm enumerationwith 20 genom case began run grappa 6 hour score mani tree possibl use best score obtain first phase upper bound second phase ran anoth 6 hour random select 3 requir storag exceed memori capac machin case store bucket disk suitablys block cost secondari memori access easili amort comput 522 moret tang wang warnow gene fig 11 percentag tree elimin bound variou number gene genom three rate evolut tree bound use method bound compar upper bound obtain first phase result potenti pessimist estim prune rate figur 11 show percentag tree prune away circular lower bound tabl paramet r denot expect number invers per edg use simul evolut could run enough test set 160 gene mere score tree accur easili take day computationth instanc tsp gener circumst timeconsum comparison similar tabl earlier approach 23 new approach show dramat improv especi high rate evolut found circular order dataset 20 genom elimin howev tabl also show bound elimin mani tree dataset 40 genom unless dataset larg number gene reason clear number gene dictat rang valu pairwis distanc thu also tree scorein term invers distanc instanc roughli mn possibl tree score number gene n number genom yet number distinct tree 2n 5 number larg even small fraction tree near optim fraction contain mani tree effici distinguish other mn bucket cours grappa 6 hour examin vanishingli small fraction tree space upper bound use almost certainli much high contrast find layer method gave us prune rate 90 10genom case gene huge improv complet failur prune normal search method 6 test method real repeat analysi campanulacea dataset consist 13 chloroplast genom one outgroup tobacco time reconstruct ede oppos breakpoint invers phylogeni 13 genom 105 segment though highli rearrang consid low rate evolut previou analysi found grappa first bound ap proach prune 85 tree substanti speedup order 510 version without prune use ede distanc improv bound compu tation increas percentag 95 anoth substanti speedup 510 ad layer search howev manag prune almost 1375 billion treesal hundr thousand quickli score dispatch speedup close 20 prune rate 9999 reduc number tree score factor nearli 800 result dataset requir coupl hour 512processor superclust use first bound strategi 2 22 24 run hour singl workstationand one minut cluster term origin comparison bpanalysi code achiev speedup superclust one hundr million also confirm result previou analysisthat tree return new analysi use ede distanc match return analysi use minimum invers distanc pleasantli robust result speedup obtain bound depend two factor percentag tree elimin bound difficulti tsp instanc avoid use bound tabl 11 show rate evolut high close 100 tree elimin use bound howev tsp instanc solv grappa quit small evolutionari rate low due compress data see 24 consequ speedup also depend rate evolut lower rate evolut produc easier tsp instanc thu smaller speedup campanulacea dataset good exampl dataset quit easi grappa sens produc easi tsp instancesbut even case signific speedup result gener speedup increas larger number genom point higher rate evolut one forc exhaust search tree space speedup repres substanti save time 7 conclus futur work describ new theoret experiment result enabl us analyz signific dataset term invers event also extend model incorpor transposit work part ongo project develop fast robust techniqu reconstruct phylogeni geneord data distanc estim develop clearli outperform straight distanc measur term accuraci use conjunct distancebas method neighborjoin effici use searchbas optim method implement grappa softwar suit current softwar suffer sever limit particularli exhaust search constrain tree space howev bound describ use conjunct branchandbound base insert leav subtre extend circular order well heurist search techniqu acknowledg thank r jansen introduc us research area sankoff j nadeau invit us dcaf meet idea paper came fruition work support part nation scienc foundat grant aci 0081404 moret deb 0120709 moret warnow eia 0113095 david lucil packard foundat warnow r perform neighborjoin method phylogenet reconstruct grappa run record time lineartim algorithm comput invers distanc sign permut experiment studi sort permut transposit breakpoint phylogeni gene order breakpoint evid anim mitochondri phi logeni complex breakpoint median problem lower bound breakpoint phylogeni problem formul hard multipl sort revers experiment statist analysi sort revers practic nonparametr statist empir comparison phylogenet method chloroplast gene order data campanulacea new fast heurist comput breakpoint phylogeni experiment phylogenet analys real synthet data workshop gene order dynam dimac workshop whole genom comparison use chloroplast dna rearrang reconstruct plant phylogeni grappa genom rearrang analysi parsimoni phylogenet algorithm transform cabbag turnip polynomi algorithm genom distanc problem travel salesman problem minimum span tree person commun extens file format systemat infor mation new approach reconstruct phylogeni base gene order new implement detail studi breakpoint analysi length chromosom segment conserv sinc diverg man mous chloroplast dna systemat review method data analysi chloroplast mitochondri genom evolut land plant median problem breakpoint npcomplet chloroplast dna evid ancient evolutionari split vascular land plant neighborjoin method new method reconstruct phylogenet tree multipl genom rearrang breakpoint phylogeni probabl model genom rearrang linear invari phylogenet infer phylogenet infer exactiebp new techniqu estim evolutionari distanc whole genom estim true evolutionari distanc genom tr transform cabbag turnip formul hard multipl sort revers probabl model genom rearrang linear invari phylogenet infer sort permut tansposit estim true evolutionari distanc genom highperform algorithm engin comput phylogenet new fast heurist comput breakpoint phylogeni experiment phylogenet analys real synthet data lower bound breakpoint phylogeni problem ctr bernard e moret lisan wang tandi warnow toward new softwar comput phylogenet comput v35 n7 p5564 juli 2002 nikla eriksen revers transposit median theoret comput scienc v374 n13 p111126 april 2007 bernard e moret tandi warnow reconstruct optim phylogenet tree challeng experiment algorithm experiment algorithm algorithm design robust effici softwar springerverlag new york inc new york ny 2002