accur conjug gradient method famili shift system consid solut linear system real valu famili shift system aris exampl tikhonov regular comput lattic quantum chromodynam singl shift system solv use conjug gradient method least squar problem cgl literatur variou implement socal multishift cgl method propos method mathemat equival appli cgl method shift system separ solv system simultan requir two matrixvector product one one two inner product per iter step unfortun numer experi show due roundoff error case implement multishift cgl method attain accuraci depend squar condit number matrix paper argu multishift cgl method impact attain accuraci round error lanczo part method independ effect roundoff error made construct iter make suitabl design choic part deriv new effici implement tri remov limit previou propos partial roundoff error analysi variou numer experi show promis result b introduct variou scientif comput problem aris comput solut variou valu matrix denot ident matrix krylov subspac method iter solut method solv linear system method zero initi guess character fact construct approxim step j socal j dimension krylov subspac defin k j b spanb ab j1 b import properti krylov subspac shift invari k exploit properti equat 11 solv variou valu mathemat institut utrecht univers po box 80010 nl3508 utrecht netherland shift construct basi krylov subspac observ led mani ecient implement known krylov subspac method handl multipl shift simultan refer interest reader inform applic 4 6 11 9 17 10 22 8 21 multishift variant gener requir number matrixvector product inner product origin method appli singl system solut addit shift system extra vector updat need paper focu numer solut system sever real valu 0 solut famili system play import role tikhonov regular 10 comput overlap oper simul quantum chromodynam 18 despit fact system sensit eect use comput arithmet sinc ill condit overwhelm numer evid accur solut shift system obtain appli sucient number iter cgl method variant cg method design solv least squar problem unfortun previous propos implement multishifttyp solv 12 ie multishift cgl method case achiev final precis shift system depend squar condit number matrix due roundo error present paper demonstr numer exampl cf section 52 main goal paper deriv new implement tri overcom limit use comput arithmet aect standard cgl method two way alter converg properti method restrict accuraci method eventu achiev also case multishift version cgl method paper mainli focu second aspect implement tri improv previou propos area ultim attain accuraci cgtype method often investig eg 14 3 consid residu gap defin dierenc recurs comput approxim residu unknown true residu cgl method fairli straightforward multishift variant situat complic order understand influenc finit precis arithmet attain accuraci multishift cgl method discrimin round error made construct basi krylov subspac ie lanczo part comput approxim solut vector krylov subspac invers part subdivis lanczo invers part immedi visibl standard implement cgl method also reflect analysi attain accuraci inspect residu gap stress multishift context two part necessarili independ priori clear even possibl develop multishift version cgl method abl obtain approxim similar precis direct applic cgl method system separ paper propos implement multishift cgl method make suitabl design choic implement lanczo part comput iter shift system confid success method given partial round error analysi import situat partial numer experi paper follow structur section 2 review cg method variant least squar problem cgl discuss wellknown result attain accuraci abstract formul multishift cgl method given section 3 implement lanczo part subject section 4 review import result paig finit precis behavior method altern comput orthogon basi krylov subspac propos use cgl recurr section 5 deal influenc round error made altern lanczo method attain accuraci multishift cgl method topic section 6 accur comput iter shift system final show sever numer experi main ingredi chosen properli achiev high accuraci shift system conjug gradient method section review two variant conjug gradient method paper hesten stiefel 16 properti conjug gradient method iter solut method solv linear system matrix symmetr posit definit method iter x j correspond residu r comput use recurr relat coecient given initi norm paper euclidean approxim solut follow use recurr practic nonzero start vector sometim use futur conveni assum initi guess x 0 zero key character cg method iter x j minim error energi norm aweight norm approxim jth krylov subspac k j b see eg 16 consequ residu r orthogon basi k j b anoth use properti fact r follow equat 52 16 posit show combin 22 follow proposit summar import result due greenbaum help provid insight attain accuraci standard conjug gradient method proposit 21 greenbaum 14 dierenc true residu bax k comput residu r k satisfi x unit roundo doubl precis comput order 10 16 c constant depend error matrixvector product quantiti k dicult bound comput arithmet howev exact arithmet immedi follow 23 k 1 argument bound quantiti use 14 depend fact also exact arithmet error cg method euclidean norm monoton decreas 16 theorem 63 therefor 2 24 unfortun argument prove reduct error euclidean norm 16 use orthogon residu gener lost finit precis comput howev use relat cg method exact cg method appli larger matrix specif righthand side author argu 14 section 31 24 might also hold approxim finit precis context relev proposit 21 explain attain precis conjug gradient method depend experiment observ practic comput comput vector r k converg zero least stagnat norm mani order magnitud smaller machin precis assumpt therefor follow proposit 21 iter x k essenti sucient larg k impli follow bound rel error least squar problem cg method directli appli normal equat nevertheless common practic use altern mathemat equival variat cg known cgl case 16 section 10 method defin follow recurr relat c j1 z comput 22 advantag method compar appli cg directli normal equat least squar residu z directli avail furthermor shown 14 section 33 3 similar argument use proof proposit 21 cg recur residu least squar problem z j improv attain accuraci method futur conveni state result 3 algorithm 1 cgl implement solv 12 proposit 22 bjorck elfv strako 3 dierenc true least squar residu b ax k comput least squar residu z k satisfi x c constant depend error matrixvector product z bax appli result author bound k accomplish similar heurist use cg method assum furthermor cgl method termin point z k z dax author conclud cgl method eventu expect achiev approxim solut good forward stabl method solv least squar problem return detail section 52 damp least squar problem 12 equival least squar problem henc shift system solv one shift appli cgl method augment matrix righthand side howev due special structur matrix righthand side comput work save cgl method see exampl algorithm 6 10 conveni reader result algorithm summar algorithm 1 3 abstract formul multishift cgl method previou section review celebr conjug gradient least squar method 16 exact arithmet mathemat equival method obtain base lanczo method eg 12 chapter 9 appli matrix start vector b method construct orthonorm basi krylov subspac k k k iter process summar lanczo relat column v 0 v k v k1 form orthonorm basi k k1 symmetr kk tridiagon matrix k collect coecient comput execut lanczo algorithm often conveni includ also k1 one tridiagon matrix k ad addit row e vector e k denot kth standard basi vector ie vector compon one similarli 0 vector compon zero dimens vector appar context approxim step k correspond cg process equal vector r initi residu equat 31 32 togeth give us abstract formul cgl method follow 31 lanczo relat shift system read k 33 show lanczo relat known one system iter cgl method damp least squar problem 28 directli comput relat fact equal multishift cgl method construct orthonorm basi time comput 34 requir valu cours without store lanczo vector sinc mani mathemat equival way comput lanczo vector tridiagon matrix k mani way comput vector 34 number possibl implement countless two specif implement present 17 10 howev discuss introduct obtain precis comput iter implement limit propos new ecient implement choos suitabl algorithm lanczo part comput iter 34 discuss relationship previous propos multishift cgtype method implement cours paper 4 implement lanczo part discuss previou section first key ingredi multishift cgl method construct orthonorm orthogon basi krylov subspac tridiagon matrix contain orthogon coecient obviou choic appli standard lanczo method eg 12 algorithm 921 matrix start vector b dicult see optim choic context solv least squar problem give detail argument section 5 discuss impact round error lanczo part attain accuraci multishift cgl method well known coupl twoterm recurr cg method use altern applic lanczo method construct orthonorm basi krylov subspac see 7 1 numer experi paper show altern recurr could case consider improv robust method similar spirit recurr 26 use build orthonorm basi krylov subspac k j b section consid use cgl recurr altern lanczostyp method refer cglslanczo method first littl remark notat convent r k denot n k matrix column r 0 r k1 similarli capit use group togeth correspond vector relat 26 summar follow matrix formul k2 j k lower bidiagon matrix 1 1 respect diagon subdiagon substitut yield residu relat apart dierenc scale precis lanczo relat given 31 obtain quantiti lanczo method standard form use simpl diagon scale k diagon element show hold sinc j avail cgl method recurr 26 use altern appli lanczo method start vector b virtual cost 1 argu cgl recurr use altern standard lanczo method therefor iter shift system comput use 34 quantiti given 42 equival altern avoid scale 42 directli comput k defin upper k k block k given 41 1 notic vector v j ie column v k plu minu lanczo vector standard lanczo method 41 perturb lanczo relat comput arithmet finit precis comput comput lanczo vector v k tridiagon matrix satisfi lanczo relat exactli standard lanczo method paig 19 prove instead comput quantiti satisfi perturb lanczo relat section give analog result cglslanczo method need remaind paper assum standard rule float point arithmet machin precis see eg 12 section 242 b float point number stand basic oper like addi tion subtract multipl divis furthermor assum error matrixvector product vector appropri length respec tive bound notat result paig certain implement lanczo method appli matrix start vector b summar follow proposit proposit 41 paig 19 lanczo method comput arithmet result perturb lanczo relat ignor higher order term turn attent cglslanczo altern lanczo type method discuss previou section let f c j denot perturb comput c j caus use comput arithmet assum similar notat perturb use standard model float point arithmet get cf 26 initi comput assum quantiti step minu one length zero f z f r combin notat previou section find quantiti comput cgl recurr finit precis arithmet satisfi perturb relat given k r k final straightforward sequenc substitut multipl suitabl matric yield perturb relat summar follow lemma lemma 41 cgl recurr given 26 finit precis comput lead perturb relat form k given 41 perturb form upper bound norm column perturb right given 4548 lemma explicitli provid bound norm perturb proposit 41 standard lanczo method note norm perturb much larger norm perturb term standard lanczo method take account dierenc scale explain fact p j r j becom larg typic occur matrix small isol eigenvalu howev perturb term lemma 41 interest structur next section exploit special structur investig attain accuraci multishift cgl method base cglslanczo final conclud section give futur use explicit express iter step k cgl method assum roundo error made 22 approxim given x cgl r k u first express follow 22 fact j 1 5 impact error lanczo part multishift cgl discuss eect round error lanczo part attain accuraci multishift cgl method first choic mention lanczo part applic standard lanczo method appli matrix start vector b good choic argu use line argument given 3 section 42 explain failur lscg method main observ startup lanczo method comput b obtain first lanczo vector sinc vector b appear lanczo part follow multishift cgl method base standard lanczo method best comput solut show nearli consist case 0 forward error best much less optim detail argument consult 3 section 42 focu altern lanczo procedur cglslanczo assum multishift iter comput defin 41 moreov moment round error consid comput vector ie x assum comput exactli multishift cgl method iter comput independ lanczo part consequ gener addit sourc error present cgl method impact attain accuraci point warn reader unconvent notat appli matrix k column vector k assum vector expand zero necessari oper equal case k matrix assum appli first k element vector remain element assum unchang oper futur conveni defin note use relat relat given section 41 true residu correspond normal equat written plug express perturb term given lemma 41 arriv main relat express play similar role section proposit 22 play analysi attain accuraci cgl method show vector z k eventu approach z therefor first term becom small true residu correspond 12 stagnat level determin three wvector 51 precis assum termin iter step k ax 52 constant although rigor proof condit eventu alway achiev accord 3 overwhelm experiment evid justifi assumpt see also numer experi 3 attain forward error given multipli express true residu 51 left give w 1 5 get similar express least squar residu multipli left notic special structur perturb lemma 41 play import role deriv express next section bound size wvector import case notic alreadi simpl case multishift cgl base standard lanczo method fail section 52 combin obtain bound 53 compar attain accuraci cgl method multishift cgl method base cglslanczo method furthermor discuss situat gener 51 bound size wvector bound size vector w 1 w 3 case equal zero sinc express first wvector rewritten therefor estim 4548 lead follow bound wvector w 2 bound quantiti turn conveni use relat exact conjug gradient process appli 1matrix righthand side b gener matrix k therefor coecient cgl process defin 54 element diagon scale k chosen k k upper block k symmetr symmetr matrix defin take upper left block equal 1element arbitrari assum matrix posit definit requir comput coecient posit vector b equal interest notic matrix advanc complet could chosen case higher dimens exampl greenbaum 13 show matrix k complet eigenvalu tini cluster around eigenvalu give import insight finit precis converg behavior conjug gradient method purpos precis complet import work simpl k 1dimension matrix dicult see exact conjug gradient method appli matrix righthand side b inde yield comput matrix k vector hypothet conjug gradient process denot nonbold charact contrast bold charact denot comput vector cglslanczo method exampl append k 1 j addit zero upper j j block follow lemma give use relat lemma 51 proof let denot variabl vari use standard model float point arithmet 43 follow second inequ use recurs applic estim lead 12 plug express 55 express find 56 continu origin goal bound w 1 k last inequ use 23 second quantiti appear w 1 proposit 22 show furthermor combin lemma 51 49 dicult see x cgl togeth get follow upper bound w 1 order estim size vector w 3 problem reduc bound purpos follow lemma use lemma 52 let j k proof first observ r j e first inequ follow 16 theorem 53 know p j r j r valu j essenti norm minim residu approxim correspond approxim x mr j compon first j element vector thu second inequ 510 follow use r j x mr j fact error cg method 2norm monoton decreas 16 theorem 63 notic obviou estim e could use proof lemma would given crude bound k 12 similar estim 913 23 cg method finit precis comput sinc contain term 1 would sucient purpos proof use fact larg valu r j cancel smaller 1th element vector x k combin express j k final find w 3 52 attain accuraci multishift cgl method use bound wvector express true residu 51 posit give discuss ultim attain accuraci multishift cgl method base cglslanczo method recal neglect moment round error made comput x condit number least squar problem eg 2 section 143 written defin aa denot pseudoinvers matrix given mean x comput use normwis backward stabl method forward error essenti bound 512 provid us idea expect case 0 first term 53 bound contribut w 1 w 3 forward error defin although exact arithmet express exceed one finit precis valu unknown follow assum quantiti modest stress howev quantiti x j x proposit 21 argu bound finit precis comput use similar assumpt use 58 511 fact bzax final arriv follow result theorem 51 assum 52 hold let accuraci multishift cgl approxim least squar residu notic forward error appear smaller upper bound error normwis backward stabl method given 512 howev remark 3 number iter k reach state might also depend condit matrix direct applic cgl method follow 49 x cgl k therefor dierenc attain accuraci multishift cgl method direct applic cgl method determin vector w 3 analysi clearli show term expect form essenti dierenc addit show residu gap cgl method influenc third wvector preced restrict attent zero shift case gener 0 straightforward want provid preliminari insight use cglslanczo method lanczo part multishift cgl method yield notic perturb righthand side b size b lead forward error size therefor error multishift cgl method small might expect figur 1 plot upper bound quantiti 53 two illcondit test problem 15 gener valu purpos ran cglslanczo method 100 iter comput upper bound perturb term lemma 41 use estim given 4548 evalu use comput quantiti cglslanczo method furthermor refer includ two upper bound error smaller upper figur 1 upper bound function quantiti w 1 b dot left pictur heat100 right pictur ursell100 bound predict condit number least squar problem damp least squar problem 28 pictur show behavior observ test problem small error domin contribut w 1 larg valu contribut w 2 becom domin impact vector w 3 alway rel small upper bound contribut w 2 increas increas reach maximum valu appear decay speed proport coincid bound ai b numer experi quantiti never becom much larger upper bound contribut w 1 unfortun precis express bound quantiti gener 6 solut shift system second main compon multishift cgl method comput approxim solut x k use equival formul given 34 start section summar approach use sever place literatur multishift version bicg method base coupl twoterm recurr also requir comput 61 see 17 8 detail consult refer import observ residu shift system colinear cg type method exist constant j r write threeterm recurr residu r k similar 41 compar term reveal recurr iter search direct initi p r 0 x 0 scale j lead version stabil properti j1 63 stabl method appli comput invers 61 lead approxim solut usual sucient accur deal ordinari linear system howev might case normal equat sinc depend attain precis squar condit number may introduc therefor point concern approach given 6263 implicitli form illcondit tridiagon matrix k cf 41 comput 62 exampl failur algorithm multishift cgl context given end section 62 61 altern implement goal give altern algorithm prevent format illcondit case cglslanczo method use lanczo part clear 42 also l dl factor k directli avail quotientdier algorithm introduc rutishaus 20 provid mean construct l dl factor shift matrix k directli factor k algorithm construct factor l stepbystep fashion diagon diagon element l upper bidiagon diagon element one upper diagon element l k2 take dierenti form stationari qd transform dstqd present 5 algorithm 42 follow recurr relat comput element factor l conjug gradient method construct vector x accomplish ecient introduc auxiliari vector p defin relat p start simpl scale p denot lead slightli ecient equal stabl variant j1 64 lanczo part invers part algorithm 2 multishift cgl implement solv famili form 12 j1 65 discuss two compon implement multishift cgl method consist combin 64 65 cgl recurr 26 result algorithm summar alg 2 compar 65 63 reveal search direct j scalar coincid exact arithmet recurs 64 seen reformul equival recurs given 62 hope stabl consequ furthermor norm residu shift system normal equat equal r j section 52 address influenc round error lanczo part attain accuraci multishift cgl method base cgl recurr discuss second main sourc error multishift method dierenc x comput use 64 65 exact express r k 5 section 43 dhillon parlett present roundo error analysi dstqd algorithm show outcom algorithm rel close outcom exact transform appli factor rel close origin input also expect hold scale recurs 64 altern stabil also understood close inspect recurs 64 element ad sign therefor comput valu rel close exact valu sinc cancel reason expect influenc round error recurs j small hand threeterm recurr 62 requir comput may sensit roundo error due cancel case two quantiti rel close iter rel error 2iter rel error figur 2 rel error function k alg 1 solid algorithm 6 10 dash multishift cgl base cglslanczo 65 dashdot 63 dot two dierent shift anoth issu impact roundo error vector updat 65 impact error analyz detail use techniqu section 51 defin x k iter comput exact conjug gradient method appli matrix start vector b defin section 51 show use essenti techniqu use bound vector w 3 case henc expect round error comput vector x signific influenc attain accuraci multishift cgl method 62 numer comparison numer experi suggest multishift cgl method base cglslanczo method combin 6263 invers part often remark accur situat accur altern given alg 2 nevertheless exampl dierenc clear show two simpl system matrix eigenvalu 1250 240 241 250 n 12 orthonorm eigenvector basi random righthand side equal compon eigenvector direct result solv system 12 present figur 2 1 pictur also present result alg 1 refer method case coupl recurr 64 clearli give accur result threeterm recurr larger valu small valu dierenc becom small implement multishift cgl method present 10 alg 6 use variant standard lanczo method lanczo part implement base threeterm recurr least squar residu result tridiagon matrix standard form even chang lanczo part improv attain accuraci method accuraci expect limit invers tridiagon sinc illcondit tridiagon given factor form dash line figur confirm 7 numer experi section compar attain accuraci cgl method damp least squar problem alg 1 attain accuraci version multishift cgl method alg 2 exact solut x comput use singular valu decomposit matrix report rel error given comput approxim either method number iter k chosen error particular method minim result variou test problem 15 given tabl 1 alg 1 4913 5115 6616 6516 alg 2 4813 5215 6116 7016 alg 1 6714 2915 2916 2616 alg 2 8714 3315 2516 2716 alg 1 2213 3015 3716 6716 alg 2 2713 3015 3716 7316 alg 1 9213 1814 1215 6716 alg tabl 1 attain rel error variou problem variou choic result tabl confirm propos implement multishift cgl method achiev compar accuraci appli cgl method directli regular system howev interest dierenc method occur appar tabl one properti alg 1 larg shift method appear tendenc diverg reach maxim precis interest observ multishift version cgl behavior illustr left figur figur 3 comput cost per step much lower multishift version cgl matrixvector multipl inner product less vector updat solv shift problem direct applic cgl howev remark addit multishift version sometim need less iter step exampl given right pictur figur 3 iter rel error 1iter rel error figur 3 rel error function k alg 1 solid alg 2 dashdot left problem foxgood100 8 summari outlook paper propos new implement multishift cgl method solv famili damp least squar problem work motiv observ case previou propos attain precis depend squar condit number first key ingredi implement use coupl recurr construct orthogon basi krylov subspac show lead perturb lanczostyp relat perturb desir structur size perturb rel larg compar perturb term standard lanczo process nevertheless use extens round error analysi exploit special structur perturb term show altern lanczo method desir multishift cgl method second advantag use cgl recurr lanczo part fact tridiagon matrix avail factor form import inform second key ingredi construct iter shift system show exploit factor form tridiagon use stationari qd transform 5 algorithm 42 iter accur ecient construct futur work plan extend analysi lanczo part situat gener also gener theoret confirm suitabl cglslanczo method lanczo part anoth interest extens paper consid implement multishift cgl method base lanczo bidiagon eg 12 section 933 furthermor believ analysi provid key ingredi analyz advantag coupl twoterm recurr lanczo qmr method experiment shown 7 qmr method also clear separ lanczo invers part multishift cgl method could also help analyz advantag altern lanczo method applic eg 1 acknowledg research j van den eshof financi support dutch scientif organ nwo project 613002035 thank two refere remark help us improv present paper r symmetr band lanczo process base coupl recurr applic arnoldi method larg sylvesterlik observ matrix equa tion solut shift linear system quasiminim residu iter implement qmr method base coupl twoterm recurr bicgstabl famili shift linear system restart gmre shift linear system fast cgbase method tikhonovphillip regular mani mass one stroke econom comput quark matrix comput behavior slightli perturb lanczo conjugategradi recur renc matlab packag analysi solut discret illpos problem method conjug gradient solv linear system krylov space solver shift linear system numer challeng lattic quantum chro modynam berlin analysi lanczo algorithm tridiagon symmetr matrix der quotientendierenzenalgorithmu restart full orthogon method shift linear system numer solut error estim conjug gradient method work finit precis comput tr implement qmr method base coupl twoterm recurr matrix comput 3rd ed estim attain accuraci recurs comput residu method restart gmre shift linear system stabil conjug gradient lanczo method linear least squar problem fast cgbase method tikhonovphillip regular symmetr band lanczo process base coupl recurr applic numer solut lambda2 applic structur dynam