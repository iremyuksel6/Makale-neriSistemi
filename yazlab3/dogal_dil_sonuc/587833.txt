stabil structur hamiltonian eigensolv variou applic give rise eigenvalu problem matric hamiltonian skewhamiltonian also symmetr skewsymmetr defin structur backward error use test stabil numer method solut four class structur eigenproblem introduc symplect quasiqr factor show three class enabl structur backward error effici comput also give detail round error analysi recent develop jacobilik algorithm fassbend mackey mackey linear algebra appl appear eigenproblem base direct solut 4 4 one case 8 8 structur subproblem algorithm produc complet basi symplect orthogon eigenvector two symmetr case symplect orthogon basi real invari subspac two skewsymmetr case prove rotat implement use suitabl formula algorithm strongli backward stabl show qr algorithm desir properti b introduct work concern real structur hamiltonian skew hamiltonian eigenvalu problem matric either symmetr skew symmetr interest algorithm strongli backward stabl problem gener numer algorithm call backward stabl comput solut true solut slightli perturb initi data addit perturb initi problem structur given problem algorithm said strongli backward stabl three reason interest strongli backward stabl algorithm first algorithm preserv algebra structur problem henc forc eigenvalu lie certain region complex plane occur particular kind pair round error algorithm respect structur problem caus eigenvalu leav requir region 26 second take advantag structur storag comput lower final structurepreserv algorithm may comput eigenpair accur one provid gener algorithm structur hamiltonian eigenvalu problem appear mani scientif engin applic instanc symmetr skewhamiltonian eigenproblem aris quantum mechan problem time revers symmetri 9 23 respons theori studi close shell hartreefock wave function yield linear respons eigenvalu equat symmetr hamiltonian 21 also total least squar problem symmetr constraint lead solut symmetr hamiltonian problem 17 receiv editor februari 23 2000 accept public revis form v mehrmann novemb 24 2000 publish electron may 3 2001 httpwwwsiamorgjournalssimax23136800html depart mathemat univers manchest manchest m13 9pl england ftisseurmamanacuk httpwwwmamanacukftisseur work support engin physic scienc research council grant grl76532 motiv work come recent develop jacobi algorithm structur hamiltonian eigenproblem 10 algorithm structurepreserv inher paralleliz henc attract solv largescal eigenvalu prob lem first contribut defin show comput structur backward error structur hamiltonian eigenproblem backward error use test stabil numer algorithm second contribut concern stabil new jacobilik algorithm give unifi descript algorithm four class structur hamiltonian eigenproblem provid framework detail round error analysi enabl us show algorithm strongli backward stabl rotat implement use suitabl formula organ paper follow section 2 recap necessari background concern structur hamiltonian section 3 deriv comput structur backward error structur hamiltonian eigenproblem section 4 describ structurepreserv qrlike algorithm propos 5 structur hamiltonian eigenproblem give unifi descript new jacobilik algorithm detail jacobilik updat four class structur hamiltonian section 5 give round error analysi section 6 use comput backward error confirm empir strong stabil algorithm 2 preliminari matrix p r 2n2n symplect p n n n ident matrix matrix h r 2n2n hamiltonian hamiltonian matric form e f g r nn f g denot set real hamiltonian matric h 2n matrix r 2n2n skewhamiltonian skewhamiltonian matric form e f g r nn f skewsymmetr denot set real skewhamiltonian matric sh 2n note h h 2n p sh 2n p arbitrari symplect matrix thu symplect similar preserv hamiltonian skewhamiltonian structur also symmetr skewsymmetr structur preserv orthogon similar transform therefor structurepreserv algorithm symmetr skewsymmetr hamiltonian skewhamiltonian eigenproblem use real symplect orthogon tran format matric u r 2n2n satisfi u 10 denot spo2n group real symplect orthogon matric u spo2n written tabl 21 22 summar structur hamiltonian skew hamiltonian matric either symmetr skewsymmetr eigenvalu stabil structur hamiltonian eigensolv 105 tabl properti structur hamiltonian matric h h 2n symmetr real skewsymmetr pure imaginari pair tabl properti structur skewhamiltonian matric sh 2n symmetr real doubl 0 skewsymmetr pure imaginari doubl properti symplect orthogon canon form use r nn denot diagon matrix b r nn denot blockdiagon matrix direct sum 1 1 zero block 2 2 block form 0 b 0 canon form consequ result 19 next show eigenvector skewsymmetr hamiltonian matric chosen structur properti import defin deriv structur backward error lemma 21 eigenvector skewsymmetr hamiltonian matrix h chosen form z iz z c n proof let hu canon form h symplect orthogon matrix ii ii unitari diagon canon form h henc eigenvector basi h show eigenvector taken form z iz z c n note eigenvector skewsymmetr hamiltonian matrix necessarili form z iz instanc consid 106 francois tisseur tabl number paramet defin h hamiltonian skewhamiltonian eigenvector h correspond eigenvalu id form z 3 structur backward error begin develop structur backward error use test strong stabil algorithm class hamiltonian eigenproblem 31 definit notat conveni symbol h denot hamiltonian skewhamiltonian matric let x approxim eigenpair structur hamiltonian eigenvalu problem r 2n2n natur definit normwis backward error approxim eigenpair measur perturb rel sens denot vector norm correspond subordin matrix norm deif 8 deriv explicit express 2norm x hx residu show normwis rel backward error scale residu componentwis backward error stringent measur backward error compon perturb h measur individu x h h inequ matric hold componentwis geurt 12 show 1i2n componentwis backward error provid meaning measur stabil normwis version element h vari wide magnitud howev measur entir appropri problem respect structur sparsiti h bunch 2 van dooren 25 also discuss situat desir preserv structur definit backward error four class structur hamiltonian matric deal defin real paramet make e f see tabl 31 write depend extend notion componentwis backward error allow depend perturb stabil structur hamiltonian eigensolv 107 set paramet defin structur componentwis backward error follow idea notat defin structur rel normwis backward error x impli h structur h structur rel componentwis backward error x defin 31 constraint hf hf replac h h case depend data paramet linear natur requir x properti forc upon exact eigenpair otherwis backward error infinit next subsect give algorithm comput backward error start describ gener approach use 13 context structur linear system extend case approxim solut lie complex plane 32 gener approach comput x let equat real imaginari part constraint x 31 becom u equival h u appli vec oper stack column matrix one long vector obtain denot kroneck product refer lancast tismenetski 18 chap 12 properti vec oper kroneck product linear full rank p tvector paramet defin h exist diagon matrix 1 depend structur h symmetricskew symmetr hamiltonianskewhamiltonian u use 34 rewrit 33 bd use 35 x show structur backward error given term minim 2norm solut underdetermin system underdetermin system consist minim 2norm solut given term pseudoinvers case x h symmetr structur hamiltonian assum x real therefor 32 appli vec oper give u 2n veci h also symmetr structur hamiltonian linear veci tvector paramet defin lie rang bd therefor underdetermin system 36 consist symmetr hamiltonian symmetr skew hamiltonian skewsymmetr hamiltonian prove consist pure imaginari approxim eigenvalu approxim eigenvector form lemma 21 abl prove underdetermin system consist skewsymmetr skewhamiltonian case depend paramet linear definit structur rel componentwis backward error x equival h h p p q smallest satisfi p p q minim norm solut bd 2 approxim minim 2norm look problem individu possibl reduc size underdetermin system nevertheless solut system standard techniqu still take 3 oper next section show use symplect quasiqr factor approxim eigenvector residu appropri part deriv express x cheaper comput structur hamiltonian interest except skewsymmetr skewhamiltonian first defin symplect quasiqr factor 33 symplect quasiqr factor defin symplect quasiqr factor 2n matrix q real symplect orthogon 1 r nm upper trapezoid 2 r nm strictli upper trapezoid symplect quasiqr factor also discuss bunsegerstn 3 cor 45iibefor give algorithm stabil structur hamiltonian eigensolv 109 comput symplect quasiqr factor need describ two type elementari orthogon symplect matric use zero select compon vector symplect household matrix h r 2n2n direct sum nn household matric diag k1 nk1 v v n otherwis v determin given x r n p k symplect given rotat gk r 2n2n given rotat rotat perform plane k k gk form chosen given x r 2n gk use combin orthogon transform comput symplect quasiqr factor symplect household matric use zero larg portion vector symplect given use zero singl entri algorithm 31 symplect quasiqr factor given matrix 1 2 r nm algorithm comput symplect quasiqr factor 38 end determin g end illustr procedur gener 6 4 matrix g3 34 symmetr hamiltonian eigenproblem let residu vector symplect quasiqr factor 38 q symplect orthogon 0 e n12 q equival e 110 e 22e n12 still symmetr hamiltonian matrix equat 310 defin first column h e 11 e 22 e 11 h e stabil structur hamiltonian eigensolv 111 e 11 e 22 0 e 11 arbitrari real coecient symmetr hamiltonian f f x frobeniu norm h minim set zero definit f obtain follow lemma lemma 32 backward error approxim eigenpair symmetr hamiltonian eigenproblem given x e 11 quasitriangular factor symplect quasiqr factor x r hx also x e 2 second unit vector 35 skewsymmetr hamiltonian eigenproblem skewsymmetr hamiltonian eigenproblem techniqu develop section 34 need modifi case r x complex vector want defin real skewsymmetr hamiltonian perturb h x definit structur backward error 31 assum pure imaginari x form see lemma 21 take plu sign x equat h x written ez multipli 312 give 311 henc carri analysi 311 set 311 equat real imaginari part yield equival use show w orthogon choic sign equat x equival show w carri analysi section 34 let symplect quasiqr factor w w e obtain h solv underdetermin system e 110 e 22e n12 lemma 33 backward error approxim eigenpair x skewsymmetr hamiltonian eigenproblem pure imaginari x form given x e 11 quasitriangular factor symplect quasiqr factor w also x e 2 second unit vector 36 symmetr skewhamiltonian eigenproblem analysi symmetr skewhamiltonian eigenproblem similar section 34 dierenc come note f stabil structur hamiltonian eigensolv 113 use v iex 1 instead comput symplect quasiqr factor x r comput symplect quasiqr factor x r order introduc one zero triangular factor r summar result next lemma lemma 34 backward error approxim eigenpair symmetr skewhamiltonian eigenproblem given x e 11 x r quasitriangular factor symplect quasiqr factor j x r hx also x hf 37 comment lemma 3234 provid explicit formula backward error comput 2 oper skewsymmetr skewhamiltonian matric h eigenvector complex particular structur constraint h x 31 written form hx residu unabl explicitli construct matric h satisfi constraint via symplect qr factor x x r r thu case use approach describ section 32 comput x drawback requir 3 oper 4 algorithm hamiltonian eigenproblem simpl ineci approach solv structur hamiltonian eigenproblem use symmetr unsymmetr appropri qr algorithm 2n 2n structur hamiltonian matrix approach comput expens use 4n 2 storag locat moreov qr algorithm use symplect orthogon transform therefor structurepreserv benner merhmann xu method 1 comput eigenvalu invari subspac real hamiltonian matrix use relationship eigenvalu invari subspac h extend 4n 4n hamiltonian trix algorithm structurepreserv extend hamiltonian matrix structurepreserv h therefor strongli backward stabl sens paper 41 qrlike algorithm bunsegerstn byer mehrmann 5 provid chart numer method structur eigenvalu problem base qrlike algorithm section describ recommend algorithm structur hamiltonian eigenproblem limit case rankf byer hamiltonian qr algorithm 6 base symplect orthogon transform yield strongli backward stabl algorithm symmetr hamiltonian eigenproblem quaternion qr algorithm 4 suggest quaternion qr algorithm extens franci qr algorithm complex real matric quaternion matric algorithm use exclus quaternion unitari similar transform backward stabl compar standard qr algorithm symmetr matric algorithm cut storag work requir approxim half howev implement requir quaternion arithmet clear whether strongli backward stabl skewsymmetr hamiltonian h first reduc via symplect orthogon transform block antidiagon form 0 block symmetr tridi agon complet solut obtain via symmetr qr algorithm appli whole algorithm strongli backward stabl use real symplect orthogon transform known backward stabl symmetr skewhamiltonian problem use xtrick suggest x 2 ii ii eigenvalu h comput eigenvalu hermitian matric use hermitian qr algorithm instanc one drawback approach use complex arithmet provid real symplect orthogon eigenvector basi henc algorithm preserv real origin matrix final skewsymmetr skewhamiltonian case h reduc blockdiagon form via finit sequenc symplect orthogon transform block tridiagon skewsymmetr paardekoop jacobi algorithm 22 algorithm 11 skewsymmetr tridiagon matric use obtain complet solut whole algorithm strongli backward stabl 42 jacobilik algorithm byer 7 adapt nonsymmetr jacobi algorithm 24 special structur hamiltonian matric hamiltonian jacobi algorithm base symplect given rotat symplect doubl jacobi rotat form j 2n j 2 2 jacobi rotat preserv hamiltonian structur jacobi algorithm converg build hamiltonian schur decomposit 7 thm 1 symmetr h jacobi algorithm converg canon form d0 strongli backward stabl skewsymmetr hamiltonian h jacobi algorithm converg symplect orthogon canon form h hamiltonian triangular recent fabend mackey mackey 10 develop jacobi algorithm structur hamiltonian eigenproblem preserv structur produc complet basi symplect orthogon eigenvector two symmetr case symplect orthogon basi real invari subspac two skewsymmetr case jacobi algorithm base direct solut 4 4 one case 8 8 subproblem use appropri transform algorithm work entir real arithmet note real initi matrix view addit structur jacobi algorithm preserv give unifi descript jacobilik algorithm four class structur hamiltonian eigenproblem consider let h r 2n2n structur hamiltonian matrix see tabl 21 22 jacobi method attempt reduc quantiti odiagon norm stabil structur hamiltonian eigensolv 115 set indic depend structur problem use sequenc symplect orthogon transform h sh r 2n2n aim h converg canon form follow note ijinjn restrict n plane algorithm 41 given structur hamiltonian matrix h r 2n2n toler tol 0 algorithm overwrit h approxim canon form orthogon ophp choos comput symplect orthogon sh ijinjn canon form preserv structur preserv structur note pair uniqu determin 4 4 princip submatrix also inherit hamiltonian skewhamiltonian structur togeth symmetri skewsymmetri properti mani way choos indic j choic aect rest analysi refer nn 12 updat sweep sweep must complet everi part matrix must reach see immedi complet sweep 1 1 block h consist 22 princip submatric gener correspond complet sweep h 4 4 target submatrix symplect orthogon matrix directli comput correspond canon form construct embed way 4 4 target extract skewsymmetr skewhamiltonian 44 base jacobi algorithm converg aim jacobi algorithm move weight diagon either diagon block odiagon block done skewsymmetr skewhamiltonian diagon zero safe place norm target submatrix kept howev 8 8 skewsymmetr skewhamiltonian problem solv instead 2 2 diagon block h becom safe place norm target submatric result 8 8 base jacobi algorithm expect converg complet sweep defin partit block along rightmost lower edg n odd henc case must also abl directli solv subproblem immedi see dicult part deriv algorithm defin appropri symplect orthogon transform comput canon form restrict n plane h fabend mackey mackey 10 show use quaternion represent 4 4 symplect orthogon group well 4 4 hamiltonian skewhamiltonian matric tensor squar quaternion algebra defin construct 4 4 symplect orthogon matric r job transform base rotat subspac pure quaternion need give requir transform form suitabl round error analysi also facilit descript structur preserv jacobi algorithm start defin two type quaternion rotat enabl us encod formula 10 one let e e 1 standard basi vector r 4 p r 4 p 0 e p pure quaternion pp 2 e let defin left quaternion rotat ql symplect orthogon dicult comput x compon x permut coordin p defin right quaternion rotat matrix qr orthogon symplect 3 x r 4 nonzero follow 10 defin 4 4 symplect orthogon given rotat associ p tool need defin symplect orthogon transform directli comput canon form 4 4 structur hamiltonian eigenproblem interest refer 10 detail transform deriv 421 symmetr hamiltonian let h r 44 symmetr hamiltonian matrix canon form h obtain two step first h reduc 2 2 block diagon form complet diagon obtain use doubl jacobi rotat first step consid singular valu decomposit 33 matrix let u 1 v 1 left right singular vector correspond largest singular valu 1 let v1 stabil structur hamiltonian eigensolv 117 e v vector x 43 impli right quaternion rotat qr v 2 symplect orthogon shown 10 product diagon h qhq e complet diagon obtain use doubl jacobi rotat chosen sin sin diagon summari symplect orthogon transform use algorithm 41 equal ident matrix except plane j n jrestrict matrix given 422 skewsymmetr hamiltonian let h r 44 skewsymmetr hamiltonian matrix let p r 4 defin element h easi verifi 423 symmetr skewhamiltonian let h r 44 symmetr skew hamiltonian matrix let p r 4 defin element h diagon h 424 skewsymmetr skewhamiltonian converg jacobi algorithm possibl need solv 8 8 subproblem matrix h r 88 block diagon three 4 4 symplect given rotat form 46 one symplect given rotat form 39 let g product rotat tridiagon skewsymmetr complet 2 2 block diagon obtain directli transform real schur form follow 20 mackey show transform directli comput real schur form e q 2 g symplect orthogon transform comput real schur form 8 8 skewsymmetr skew hamiltonian h n odd solv 66 subproblem complet sweep jacobi algorithm 88 case 66 skewsymmetr skewhamiltonian h first reduc form 47 tridiagon skewsymmetr done use one 4 4 symplect given rotat follow one symplect given rotat let comput directli real schur form moreov e q 5 error analysi jacobi algorithm float point arithmet algorithm 41 comput approxim canon form p symplect orthogon approxim basi symplect orthogon eigenvector p want deriv bound h 51 preliminari use standard model float point arithmet 16 u unit roundo assum 51 hold also squar root oper keep track higher term u make use follow result 16 lem 31 lemma 51 u defin p denot small integ constant whose valu unimport follow comput quantiti denot hat first consid construct 4 4 given rotat left right quaternion rotat lemma 52 let 4 4 given rotat construct accord 46 p r 4 comput g satisfi gg 5 g proof result straightforward extens lemma 186 16 concern given rotat round error properti right left quaternion rotat requir attent p 0 comput p therefor comput ql p qr p aect cancel problem overcom use anoth formula shown next lemma lemma 53 let 4 4 left right quaternion rotat construct accord p r 4 given comput ql ql ql proof straightforward verifi express ql p qr p 52 53 agre definit 44 45 f p 0 exist 5 f use argument also f l use 16 lem 33 henc certainli follow use term elementari symplect orthogon matrix describ doubl given rotat 44 given rotat left right quaternion rotat embed princip submatrix ident matrix r 2n2n prove comput elementari symplect orthogon matrix use jacobi algorithm satisfi bound form lemma 54 let x r 2n2n consid comput px p comput elementari symplect orthogon matrix satisfi 55 comput satisfi p exact elementari symplect orthogon matrix proof vector dier x element obtain similar result ni nj henc final defin note x consid pre postmultipl matrix h approxim elementari symplect orthogon matrix lemma 55 let h r 2n2n p r 2n2n elementari symplect orthogon matrix f lp satisfi 55 f stabil structur hamiltonian eigensolv 121 proof let h ith column h lemma 54 result hold h j h ni h nj column h un chang henc f similarli bp bf consequ lemma 55 h k1 matrix obtain one jacobi updat k product six elementari symplect orthogon matric exact transform made assumpt h h structur hamiltonian matrix jrestrict rhr canon form instanc h skewsymmetr hamiltonian matrix comput implement diagon element h comput set zero also h ij h ijn skewsymmetri h ji h jni set zero forc element zero make error smaller bound still hold structur problem storag flop count reduc factor four structur hamiltonian matrix need less n 2 n storag locat paramet defin h comput structur error preserv h structur h easi see bound lemma 56 still valid properti h structur h theorem 56 algorithm 41 structur hamiltonian h comput canon h structur h hf k hf k number symplect orthogon transform appli jacobi updat comput basi symplect orthogon eigenvector satisfi proof 56 one jacobi updat h satisfi second updat 122 francois tisseur continu fashion find k updat 1 k h k f similar way use first part lemma 55 k updat readili theorem 56 show comput eigenvalu exact eigenvalu nearbi structur hamiltonian matrix comput basi eigenvector orthogon symplect machin precis prove strong backward stabil jacobi algorithm 6 numer experi illustr result present numer exampl comput carri matlab unit roundo symmetr hamiltonian symmetr skewhamiltonian skewsymmetr hamiltonian approxim eigenvector x form z iz comput x involv symplect quasiqr factor 2n 2 matrix done order n 2 flop cost neglig compar 3 cost whole eigendecomposit skewsymmetr hamiltonian approxim eigenvector x form iz skewsymmetr skewhamiltonian comput x requir 3 flop find minim 2norm solut larg underdetermin system 36 thu case x quantiti would comput routin cours solv problem note implement jacobilik algorithm skewsymmetr hamiltonian choos approxim eigenvector column p ii p accumul symplect orthogon transform use algorithm build canon form case approxim eigenvector x guarante form z test strong stabil numer algorithm solv structur hamiltonian eigenproblem appli direct search maxim routin mdsmax matlab test matrix toolbox 15 function 1i2n comput eigenpair way carri search problem algorithm perform unstabl expect theori could gener exampl structur backward error jacobilik algorithm larg x nuhf test symmetr qr algorithm use symplect orthogon transform therefor structurepreserv surpris could gener exampl symmetr hamiltonian symmetr skewhamiltonian matric stabil structur hamiltonian eigensolv 123 tabl backward error eigenpair 44 skewsymmetr hamiltonian defin 61 max x jacobilik algorithm tabl backward error approxim eigenvalu 0 3030 random skewsymmetr skewhamiltonian matrix eigenpair comput symmetr qr algorithm larg backward error howev qr algorithm comput symplect orthogon basi eigenvector also easi gener exampl structur symmetr hamiltonian eigenvalu multipl 2 structur symmetr skewhamiltonian preserv gener definit structur backward error singl eigenpair set k eigenpair symmetr qr algorithm like produc set eigenpair infinit structur backward error qrlike algorithm symmetr skewhamiltonian like provid eigenvector complex instead real yield infinit structur backward error 314 good backward stabil individu eigenpair comput qr algorithm hold skewsymmetr hamiltonian case instanc consid skewsymmetr hamiltonian eigenproblem whose eigenvalu distinct tabl 61 give normwis componentwis structur normwis backward error eigenpair comput unsymmetr qr algorithm skewsymmetr jacobi algorithm qr algorithm use symplect orthogon transform comput eigenvector structur iz therefor comput max x use gener formula 37 skewsymmetr skewhamiltonian case n odd 0 eigenvalu multipl two alway well approxim unsymmetr qr algorithm gener random 15 15 e f give tabl 62 backward error associ approxim eigenvalu 0 qr algorithm jacobi algorithm 7 conclus first contribut work extend exist definit backward error way appropri structur hamiltonian eigen problem provid comput formula inexpens evalu except skewsymmetr skewhamiltonian numer experi show symmetr structur hamiltonian eigenproblem symmetr qr algorithm comput eigenpair small structur backward error algebra properti problem preserv second contribut detail round error analysi new jacobi algorithm fabend mackey mackey 10 structur hamiltonian eigen problem algorithm structurepreserv inher paralleliz henc attract solv largescal eigenvalu problem prove strong stabil left right quaternion rotat implement use formula 52 53 jacobi algorithm easi implement oer good altern qr algorithm name unsymmetr qr algorithm show strongli backward stabl skewsymmetr hamiltonian skewhamiltonian eigenproblem algorithm symmetr skewhamiltonian base appli qr algorithm 41 respect real problem acknowledg thank nil mackey point open question concern strong stabil jacobi algorithm structur hamiltonian eigenproblem suggest fix cancel problem comput quaternion rotat also thank steve mackey help comment earlier manuscript r new method comput stabl invari subspac real hamiltonian matrix weak strong stabil algorithm numer linear algebra matrix factor symplect qrlike method quaternion qr algorithm chart numer method structur eigenvalu problem hamiltonian qr algorithm ieee tran rel backward perturb theorem eigenvalu problem hamilton jacobi come full circl jacobi algorithm structur hamiltonian eigenproblem accur count singular valu bidiagon matric eigenvalu skewsymmetr tridiagon matric contribut theori condit backward error condit structur linear system structur backward error condit gener eigenvalu problem test matrix toolbox matlab version 30 accuraci stabil numer algorithm oxford univers press theori matric canon form hamiltonian symplect matric pencil hamilton jacobi meet quaternion eigenvalu problem solut larg matrix equat occur respons theori eigenvalu algorithm skewsymmetr matric jacobilik algorithm comput schur decomposit nonhermitian matrix structur linear algebra problem digit signal process symplect method approxim eigenvalu hamiltonian matrix tr