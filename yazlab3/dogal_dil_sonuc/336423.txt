analyz bound box object intersect heurist exploit boun box common algorithm render model anim experi shown bound box improv perform algorithm practic previou theoret analysi conclud bound box perform poorli worst case paper reconcil discrep analyz intersect among n geometr object term two paramet agr upper bound aspect ratio elongated object sgr upper bound scale factor size dispar largest smallest object let ko kb number intersect object pair bound box pair respect analyz ratio measur bound box effici rkbnko analysi prove roa log2 rwa one import consequ agr sgr small constant often case practic kb oko algorithm use bound box time complex proport number actual object intersect theoret result valid effici bound box demonstr practic anoth consequ analysi proof outputsensit algorithm report intersect pair set n convex polyhedra constant agr sgr algorithm take time onlogd1n kolog d1n dimens 3 run time improv perform previou algorithm make assumpt agr sgr b introduct mani comput graphic algorithm improv perform use bound box bound box geometr object simpl volum enclos object form conserv approxim object common form axisalign bound box whose extent dimens space bound minimum maximum coordin object dimens see figur 1 exampl bound box use algorithm process object intersect two object intersect bound box intersect intersect test almost alway effici object bound box object thu bound box allow algorithm quickli perform trivial reject test prevent costli process unnecessari case heurist appear algorithm render tradit algorithm visiblesurfac determin 10 algorithm optim clip viewfrustum cull 13 recent imagebas techniqu reconstruct new imag reproject pixel refer imag 23 bound box also common algorithm model techniqu defin complex shape boolean combin simpler shape 18 techniqu verifi clearanc part assembl 11 anim algorithm also exploit bound box especi collis detect algorithm path plan 21 simul physic base motion 2 20 25 empir evid demonstr bound box heurist improv perform practic goal prove bound box maintain high perform worst case remain elus proof import reassur practition applic one bound box happen perform poorli understand difficulti proof consid use bound box detect pair collid object set n polyhedra let k number collid pair object let k b number collid pair bound box figur 1 b show exampl mean bound box heurist add unnecessari overhead collis detect algorithm use heurist slower one naiv test everi pair object collis intuit poor perform exampl due patholog shape object paper identifi two natur measur degre object shape patholog analyz bound box heurist term measur show aspect ratio ff scale factor oe bound small constant gener case practic bound box heurist avoid poor perform worst case aspect ratio measur elongated object classic geometri aspect ratio rectangl defin ratio length width definit extend varieti way gener object dimens b figur 1 polygon object axisalign bound box b exampl k greater two often defin ratio volum smallest ball enclos object largest ball contain object find conveni use volum l1norm ball dspace 1 given solid object p dspace let bp denot smallest l1 ball contain p let cp denot largest l1 ball contain p aspect ratio p defin volp denot ddimension volum p call bp enclos box cp core p thu aspect ratio measur volum enclos box rel core set object aspect ratio smallest ff ff ffp scale factor set object measur dispar largest smallest object set object dspace say scale factor oe 1 analysi paper focus ratio two dimens instanc l1 ball radiu r center axisalign squar side length 2r center choic norm affect small dimensiondepend constant factor result appli also l 2 ball commonli use norm small chang constant note also estim deriv l1 norm pessimist sinc l1 box conserv bound volum k number object pair nonempti intersect k b number object pair whose enclos box intersect 2 denomin repres bestcas work algorithm use bound box heurist ratio seen rel perform measur heurist ideal ratio would small constant unfortun patholog case figur 1 b show without assumpt ff oe ae omegagamma n howev includ aspect ratio scale factor analysi prove follow theorem main result paper theorem 11 let set n object dimens aspect bound ff scale factor oe constant oe log 2 oe asymptot bound almost tight show famili achiev oe two main implic theorem first provid theoret justif effici bound box heurist show practic applic ff oe small constant ae also constant theorem indic k algorithm use bound box heurist thu nearli optim asymptot sens wast time process bound box intersect number grow faster number actual object intersect plu factor match overhead algorithm must incur anyth object poor perform requir uncommon situat ff n figur 1 b theorem also show perform affect aspect ratio scale factor may worthwil decompos irregularlyshap object regular piec reduc aspect ratio second implic theorem outputsensit algorithm report pair intersect object set n convex polyhedra two three dimens use bound box heurist algorithm report k pair intersect polyhedra log time maximum number vertic polyhedron assum polyhedron preprocess linear time effici pairwis intersect detect 6 without aspect scale bound awar outputsensit algorithm problem three dimens even two dimens best algorithm find intersect pair set n convex polygon take 43 oe constant common practic algorithm run time log nearli optim 2 notic l1 ball conserv estim axisalign bound box k b upper bound number bound box intersect relat work use bound box heurist collis detect algorithm repres use algorithm thu analysi focus collis detect believ result extend applic collis detect algorithm use bound box consid two phase call broad phase narrow phase basic structur algorithm follow ffl broad phase find pair intersect bound box ffl narrow phase intersect pair found broad phase perform detail intersect test correspond object broad narrow phase distinct characterist often treat independ problem research effici algorithm broad phase must avoid look 2 pair bound box exploit special structur bound box edelsbrunn 8 mehlhorn 24 describ provabl effici algorithm axisalign bound box dspace algorithm find k intersect pair log dgamma1 n time log dgamma2 n space varieti heurist method use practic 2 19 empir evid suggest algorithm perform well sweepandprun algorithm implement icollid packag cohen et al 2 current appear method choic might seem desir use broad phase replac axisalign bound box object convex hull provid tighter form bound unfortun provabl effici algorithm known find intersect n convex polyhedra three dimens two dimens though recent algorithm gupta et al 14 report intersect pair convex polygon time 43 narrow phase solv problem determ contact interpenetr two object thu perform narrow phase algorithm depend n number object set rather complex object object convex polyhedra method due dobkin kirkpatrick 6 decid whether two object intersect olog dgamma1 time total number edg two polyhedra 3 dimens algorithm preprocess polyhedra separ phase run linear time use preprocess one also comput explicit represent intersect two convex polyhedra time om shown chazel 1 one object pair convex intersect detect perform time om log 5 problem difficult polyhedra nonconvex recent subquadrat time algorithm discov decid two nonconvex polyhedra intersect 27 algorithm take om 85 time determin first collis two polyhedra one stationari translat provabl run time algorithm import result primarili theoret interest algorithm complic practic altern varieti heurist method develop tend work well practic 12 20 method use hierarchi bound volum treedesc scheme determin intersect analysi bound box heurist relat idea realist input model becom topic recent interest comput geometri recent paper de berg et al 4 suggest classifi variou model realist input model four main class fat densiti clutter cover complex briefli object fat long skinni part scene low clutter cube contain vertex object intersect constant number object scene low densiti ball radiu r intersect constant number object whose minimum enclos ball radiu least r cover complex measur rel spars object neighborhood one first nontrivi result direct matousek et al 22 show union n fat triangl complex log log n oppos arbitrari triangl triangl fat minimum angl exce ffi constant result show union convex object complex 1 provid object fat pair object intersect constant number point addit result fat unclutt object found 3 15 29 3 analysi overview proof upper bound ae consist three step first consid case arbitrari ff fix oe section 4 next section 5 allow ff oe arbitrari assum two kind object one box size ff box size ffoe two extrem end scale factor final section 6 handl gener case object box size rang ff ffoe first detail proof two dimens sketch extend arbitrari dimens section 7 arbitrari aspect ratio fix scale start assum set scale factor one aspect ratio bound ff arbitrari constant bound oe work proof assum one conveni straightforward way enforc scale bound make everi object enclos box size show case ae describ proof two dimens extens higher dimens quit straightforward sketch section 7 without loss gener let us assum object p volcp volbp recal l1 box volum ff two dimens squar side length p ff call size ff box consid tile plane size ff box cover portion plane occupi bound box object name figur 2 consid box semiopen boundari share two box belong one left thu point plane belong one box figur 2 tile plane box size ff unit size core object b 1 also shown assum underli unit lattic plane assign object p lexicograph smallest lattic point contain p point exist core close volum least one let mq number object assign lattic point q let denot total number object assign lattic point contain box b mean lattic point q lie box b sinc box tile disjoint equal deriv bound k b k term lemma 41 given set object aspect bound ff scale bound oe 1 let denot tile size ff box defin let denot total number object assign lattic point b proof consid object p assign b let p j anoth object whose box intersect bp suppos p j assign box b j sinc bp l1 norm distanc box b b j 2 ff mean among 24 box lie within 2 ff wide corridor around b figur 3 box shown dark center 24 neighbor suppos box label rowmajor ordertop bottom left right row assum number column box tile k preced discuss show box object p intersect object assign box b b j must ck c 2 fgamma2 gamma1 0 1 2g box b j two row two column away b instanc box preced two row two column b b igamma2kgamma2 see figur 3 number box pair intersect contribut b b j clearli j thu total number intersect bound c 2 fgamma2 gamma1 0 1 2g recal x 1 x 2 1x 2 bound intersect count 5 possibl valu c altogeth 25 valu j sinc index appear j get maximum number intersect complet proof lemma 2 next establish lower bound number intersect object pair need follow elementari fact lemma 42 consid nonneg number 1 proof let denot index ratio b maxim sinc sum get divid side complet proof lemma 2 let us focu object assign box b tile l number intersect pair among object assign b follow second last inequ follow fact last inequ follow preced lemma establish upper bound right hand side inequ prove lower bound denomin term fix box b follow discuss 1 p consid lattic point q sinc mq object q common least object pair intersect contribut object assign q observ object assign uniqu lattic point count intersect thu total number pairwis intersect l among object assign b least show ratio 25m 2 never exce cff c absolut constant consid fix ratio maxim l minim lemma 43 let x nonneg number sum z minimum valu zz gamma n2n achiev x proof observ follow equal x thu minim ii minim use cauchi inequ 16 latter minim x zn lemma follow 2 sinc squar box size ff 2dffe lattic point get lower bound l set 2dffe q thu lemma 44 proof use bound l 2dffe 100dffe complet proof 2 theorem 45 let set n object plane aspect bound ff scale 5 object two fix size section gener result previou section case object come two extrem end scale box size either ff ffoe simplifi analysi assum use next nearest power 4 upper bound ff oe dimens ff oe assum integr power 2 let us call object larg enclos box size ffoe small otherwis clearli three kind intersect largelarg smallsmal larg small let k l b k sl b respect count intersect enclos box exampl k sl b number pair consist one larg one small object whose box intersect similarli defin term k l object intersect ratio bound restat k l 1 k l k sl know result previou section k l cff constant c need establish bound third ratio k sl k l follow let us tile plane box volum ffoe call box underli tile two grid level oe grid divid box cell size oe level 1 grid divid box cell size 1 level oe grid vertic coordin oe finer grid vertic coordin j integ j level oe grid use reason larg object level 1 grid use small object mimic proof previou section assign object class appropri box order need defin subbox size ff within size ffoe origin box figur 4 box left show larg grid one right show small grid well subbox figur consid larg box b level oe grid partit b ff box volum oe next also partit b oe subbox volum ff sinc subbox perfectli align level 1 level oe grid along side b oe grid vertic distanc multipl vertic subbox lie distanc multipl label oe subbox within b row major order figur 4 illustr definit show two box side side member larg object set resp small object set contain least one grid point larg resp small grid previou section assign object uniqu grid point say one lexicograph smallest coordin let x denot number larg object assign grid point b let ij oe denot number small object assign total number small object assign level one grid point b estim upper bound k sl b lower bound k sl term x fix box b enclos box larg object p assign b intersect box small object p j assign b j b j one 25 neighbor b includ form two layer box around b see figur box maximum number small object among 25 neighbor b let count small object b one 25 neighbor b g b box correspond follow upper bound k sl next estim lower bound number object pair intersect let number object pair intersect among larg object assign denot object pair intersect among small object assign b sinc ff grid point larg object b lemma 43 ff similarli subbox point level 1 grid thu also oe ff deriv bound use conserv estim count intersect two larg two small object also use notat number objectpair intersect among small object assign b follow inequ k sl second inequ follow fact third follow fact particular contribut term 25 neighbor final inequ follow lemma 42 remain step proof show inequ oe first sum term eq 2 3 observ follow recal thu cauchi inequ invok show oe easili shown ratio 2ff p oe follow oe oe show k sl oe combin ineq 2 get desir result state follow theorem theorem 51 suppos set n object plane object aspect ratio ff enclos box object size either ff ffoe oe 6 gener case posit prove main theorem suppos set n polyhedr object aspect ratio bound ff scale factor oe recal simplic assum ff oe power four partit set olog oe class c log oe polyhedron p belong class c equival enclos box object class c volum ff2 ff2 i1 class behav like fix size famili case consid section 4 aec log oe pair class behav like case consid section 5 impli aec log oe formal argument show oe log 2 oe b 0 log oe denot number object pair enclos box intersect similarli defin k ij follow log 2 oe oe log 2 oe second inequ follow fact j bound log oe last inequ follow directli theorem 51 prove main result restat follow theorem theorem 61 let set n object plane aspect ratio bound ff scale factor bound oe oe log 2 oe 7 extens higher dimens 2dimension result might lead one suspect bound dimens 2 oe 1d fact asymptot bound dimens turn two dimensionsonli constant factor differ closer examin show expon oe theorem 61 aris dimens rather cauchi inequ proof theorem 61 extend easili dimens 3 structur proof remain exactli tile ddimension space box l1 ball main differ aris number neighbor box plane box 5 2 neighbor box two surround layer number increas 5 dimens sinc argument volum base hold dimens well main theorem dimens state follow theorem 71 let set n polyhedr object dspace aspect ratio bound ff scale factor bound oe oe log 2 oe constant 5 8 lower bound construct first describ construct famili construct work dimens eas exposit describ two dimens see figur 5 illustr figur 5 lower bound construct show consid squar box b size ff standard posit name ff theta ff pack roughli ff unit box b regular grid pattern number b ffc 2 exact convert unit box polyhedr object aspect ratio ff attach two wire extens two endpoint main diagon specif consid one unit box u endpoint whose main diagon coordin 1 2 b u connect point ff manhattan path whose ith edg parallel posit icoordin axe length p similarli endpoint u connect origin manhattan path whose ith edg parallel neg icoordin axe length easi see unit box togeth two wire extens form polyhedr object aspect ratio ff small perturb ensur two object intersect bound box object pair intersect howev least bound box intersect b group n object bnffc group group correspond ffsize box give us ff c theta hand k next gener construct establish lower bound omegagamma ff oe assum ffoe n see figur 6 object object small c larg figur lower bound construct show oe take squar box b 0 volum 4ffoe divid lower right quadrant subbox size oe take copi construct figur 5 scale factor oe put place lower right quadrant b 0 extend wire attach object corner c b 0 thu smallest enclos box object exactli b 0 aspect ratio 4ff big object next take upperleft quadrant divid oe subbox size ff ffsize subbox place copi construct figur 5 small object altogeth want small object sinc total ff locat big object superimpos xff copi big object locat similarli ffoe locat small object superimpos ffoe copi small object locat need condit ffoe n sinc want ensur locat receiv least one object let us estim bound k b k enclos box everi big object intersect enclos box everi small object oe hand object pair intersect exist object assign locat therefor ffoe ffoe thu oe ff oe constant c 0 ratio ff1 n bound constant sinc ffoe n theorem 81 exist famili n polyhedr object aspect ratio bound ff scale factor oe oe assum ffoe n 9 applic conclud remark theorem 61 71 two interest consequ first theoret valid bound box heurist mention section 1 practic object famili tend bound aspect ratio scale factor thu number extran box intersect constant factor number actual objectpair intersect result need assumpt convex object aspect ratio scale factor grow n theorem indic impact effici heurist degrad heurist smooth abrupt furthermor result suggest depend aspect ratio scale factor symmetricth complex grow linearli ff squar root oe common practic decompos complex object simpler part work suggest collis detect purpos reduc aspect ratio may higher payoff reduc scale factor would interest verifi empir strategi perform practic second consequ theorem output sensit algorithm report intersect among polyhedra bound strongest convex polyhedra dimens 3 awar one nontrivi result problem hold two dimens gupta et al 14 give 43 k algorithm report k pair intersect convex polygon plane problem wide open three higher dimens theorem lead significantli better result two three dimens small aspect scale bound nearli optim result convex polyhedra given n polyhedra two three dimens report pair whose bound box intersect time log number intersect bound box pair polyhedra convex narrow phase intersect test perform olog dgamma1 time 6 assum polyhedra preprocess linear time maximum number vertic polyh dron convex polyhedra aspect ratio ff scale factor oe theorem 71 total run time algorithm log ff 3 ff oe constant run time log nearli optim final obviou open problem suggest work close gap upper lower bound ae believ correct bound thetaff oe analysi quit loos actual constant proportion like much smaller estim would interest establish better constant theoret empir acknowledg author wish thank peter shirley valuabl comment earlier version proof r optim algorithm intersect threedimension convex polyhedra icollid interact exact collis detect system largescal environ linear size binari space partit fat object realist input model geometr algorithm comput intersectiondepth polyhedra determin separ preprocess polyhedraa unifi approach complet effici algorithm intersect gener convex polyhedron new approach rectangl intersect part ii complex union fat object plane solv collis detect problem obbtre hierarch structur rapid interfer detect detect intersect rectangular solid convex polyh dron effici algorithm count report pairwis intersect convex polygon cambridg univers press collis detect fli through virtual environ morgan kaufmann collis detect interact graphic applic robot motion plan fat triangl determin linearli mani hole imagebas approach threedimension comput graph ic data structur algorithm 3 multidimension search comput geometri collis detect respons comput anim comput geometri introduct effici collis detect move polyhedra simpl effici method accur collis detect among deform object arbitrari motion effici algorithm exact motion plan amidst fat obstacl tr data structur algorithm 3 multidimension search comput geometri geometr solid model introduct determin separ preprocess polyhedra unifi approach optim algorithm intersect threedimension convex polyhedra fat triangl determin linearli mani hole solv collis detect problem sphere molecul hidden surfac remov detect intersect rectangular solid convex polyhedron comput graphic 2nd ed c effici collis detect move polyhedra obbtre collis detect flythrough virtual environ complex union fat object plane realist input model geometr algorithm imagebas approach threedimension comput graphic analysi bound box heurist object intersect robot motion plan collis detect interact graphic applic effici collis detect use bound volum hierarchi kdop linear size binari space partit fat object ctr yunhong zhou subhash suri algorithm minimum volum enclos simplex r pankaj k agarw mark de berg sariel harpel mark h overmar micha sharir jan vahrenhold report intersect pair convex polytop two three dimens comput geometri theori applic v23 n2 p195207 septemb 2002 orion sky lawlor laxmik v kale voxelbas parallel collis detect algorithm proceed 16th intern confer supercomput june 2226 2002 new york new york usa