parallel precondit spars approxim invers parallel precondition present solut gener spars linear system equat spars approxim invers comput explicitli appli precondition iter method comput precondition inher parallel applic requir matrixvector product sparsiti pattern approxim invers impos priori captur automat keep amount work number nonzero entri precondition minimum rigor bound cluster eigenvalu singular valu deriv precondit system proxim approxim true invers estim extens set test problem scientif industri applic provid convinc evid effect approach b introduct consid linear system equat work grote support ibm fellowship work huckl support research grant deutsch forschungsgemeinschaft scientif comput comput mathemat bldg 460 stanford univers stanford ca 94305 grotesccmstanfordedu z institut fr angewandt mathematik und statistik universitt wurzburg d97074 wurzburg germani hucklevaxrzuniwuerzburgd400d larg spars nonsymmetr matrix due size direct solver becom prohibit expens amount work storag requir altern consid iter method gmre bcg bicgstab cg appli normal equat 6 given initi guess x 0 algorithm comput iter new approxim x k true solut b iter xm accept solut residu r gener converg guarante may extrem slow henc origin problem 1 must transform tractabl form consid precondit matrix appli iter solver either right left precondit system therefor chosen good approxim ident ultim goal reduc total execut time comput matrixvector product evalu parallel sinc matrixvector product must perform iter number nonzero entri exceed success precondit method term reduc number iter incomplet lu factor ssor notori difficult implement parallel architectur especi unstructur matric inde applic precondition iter phase requir solut triangular system step difficult parallel recurs natur comput see 2 section 444 aim find inher parallel precondition retain converg properti incomplet lu natur way achiev parallel comput approxim invers sens evalu easi parallel cheap spars although spars approxim invers alway exist often occur applic entri gamma1 small 5 1 instanc problem result discret partial differenti equat gener meaning look spars approxim invers polynomi precondition inher parallel lead much improv converg incomplet lu see 2 section 3 differ approach minim kam gamma ik yet confin whole spectrum vicin 1 els would minim 1norm 2norm would expens sinc solut long kam gamma ik 1 ensur fast converg reason cost need cluster eigenvalu singular valu 1 give outlier addit freedom achiev minim kam gamma ik frobeniu norm moreov choic natur lead inher parallel column k comput independ one anoth inde sinc solut 3 separ n independ least squar problem thu solv 4 parallel obtain explicit approxim invers spars 4 reduc n small least squar problem solv quickli 9 13 difficulti lie determin good sparsiti structur approxim invers els solut 4 yield effect precondition therefor seek method captur sparsiti pattern main entri gamma1 automat yet reason cost start given sparsiti pattern diagon augment progress 2 norm residu small enough maxim sparsiti reach key algorithm lie strategi use determin locat entri select criterion simpl cheap comput yet yield effect precondition without gener excess fillin extens set difficult test problem consid end show algorithm produc spars effect precondition comput approxim invers base minim 4 propos sever author yeremin et al comput factor spars approxim invers 11 12 13 consid fix sparsiti pattern simon grote solv 4 explicitli allow band sparsiti pattern 9 10 approach cosgrov diaz griewank 4 similar differ criteria use augment chow saad 3 use iter method comput approxim solut 4 method automat gener new entri appli drop strategi remov excess fillin appear section 2 introduc spai algorithm comput spars approxim invers section 3 deriv theoret properti spectrum precondit system 2 section 4 5 present wide rang numer experi use test matric engin scientif applic 2 comput spars approxim inver shall first show comput spars approxim invers given sparsiti structur matrix solut minim problem 4 sinc column independ one anoth need present algorithm one denot k let j set indic j k j 6 0 denot reduc vector unknown k j set indic ai j ident zero enabl us elimin zero row submatrix j denot result submatrix ai j similarli defin e set solv 4 k equival solv min n 1 theta n 2 least squar problem 5 extrem small spars matric nonsingular submatrix must full rank thu qrdecomposit r nonsingular upper triangular n 2 theta n 2 matrix let solut 5 solv 7 yield approxim invers minim kam gamma ik f given sparsiti structur aim improv upon augment sparsiti structur obtain effect precondition shall reduc current error reduc kam recal k optim solut least squar problem 4 denot residu exactli kth column gamma1 improv upon assum r 6 0 demonstr augment set indic j reduc krk 2 sinc k spars compon r zero denot l remain set indic r 6 0 typic l equal sinc r exact zero entri finit precis contain k must includ l sinc rk equal gamma1 everi 2 l correspond index set n consist indic nonzero element j yet potenti new candid might ad j contain must select new indic j lead profit reduct krk 2 cheap effect way consid j onedimension minim problem solut 10 2 11 j comput 2norm ae j new residu r given 11 2 12 least one index j r ae j 6 0 lead smaller residu 12 otherwis would impli rl zero sinc al full rank note j j contain column indic nonzero element al j reduc j set profit indic j smallest ae j add j note equat 9 also use 4 estim reduct residu alreadi found 8 use augment set indic j solv spars least squar problem 4 yield better approxim k kth column gamma1 repeat process residu satisfi prescrib toler maximum amount fillin reach numer studi section 4 show iter procedur captur main entri gamma1 extrem well everi time augment set nonzero entri k solv least squar problem exactli shall demonstr one easili updat qr decomposit greatli reduc amount work recal j current set j set new indic ad k denot new row correspond nonzero row j j contain yet 2 number indic j thu need replac 5 submatrix larger submatrix ai solv 5 use known qr decomposit updat qr decomposit augment ai requir comput qr decomposit b 2 note alreadi contain indic nonzero entri present column j let r use 16 rewrit 15 n 2 r procedur enabl us add new indic j solv least squar problem optim solut without recomput full qr decomposit step gener updat strategi propos 4 singl entri allow sever new entri time stop process algorithm comput kth column gamma1 practic howev stop process prescrib toler met maxim amount fillin reach present full spai algorithm spai stand spars approxim invers spai algorithm everi column k choos initi sparsiti j b comput row indic correspond nonzero entri qr decomposit 6 ai j comput solut k least squar problem 4 residu r given 8 c set l equal set indic r 6 0 set j equal set new column indic appear l row j e j 2 j solv minim problem 10 f j 2 j comput ae j given 12 delet j profit indic g determin new indic updat qr decomposit use 17 solv new least squar problem comput new residu j remark 1 initi sparsiti structur arbitrari may chosen empti diagon priori inform sparsiti gamma1 avail yet solv sequenc problem similar sparsiti pattern vari entri clever initi guess initi sparsiti choos sparsiti previous comput approxim invers greatli reduc comput cost sinc initi sparsiti structur would almost optim numer exampl initi sparsiti chosen diagon 2 addit stop criterion krk 2 constrain loop maxim number iter limit maxim fillin per column threshold almost never reach total number nonzero entri usual compar amount 3 f first reduc j set indic j ae j less equal mean valu ae j remain indic keep indic smallest ae j small integ avoid excess fillin set equal 5 numer calcul criterion cheap comput remov useless indic effect parameterfre sinc use dynam mean valu criterion requir threshold input user sophist weight could appli distribut ae j control rate fill 4 updat qr decomposit 17 store household matric result factor matric b 2 separ never construct q explicitli 5 select process c may restrict easili access row minim commun data flow also restrict largest element r 6 onedimension minim replac anoth minim method steepest descent exact minim problem relat j fjg experi former accur enough latter expens 7 approxim invers comput spai algorithm permut invari replac p 1 ap 2 p 1 p 2 permut matric obtain p 1 instead spai algorithm may also appli comput spars approxim left invers use left precondition 2 may yield better result row gamma1 spars column full case discuss section 5 iter solver precondit current con verg easi improv upon use sparsiti initi sparsiti spai algorithm iter proceed new precondition moreov sinc comput residu individu column k easi singl difficult column concentr improv converg iter solver may prove use connect flexibl precondit precondition adapt iter process see 17 14 3 theoret properti shall deriv rigor bound spectrum precondit matrix furthermor shall estim differ deriv condit guarante nonsingular let approxim invers obtain spai algorithm let k kth column denot r k residu everi k assum satisfi theorem 31 1kn fnumber nonzero element r k note p usual much smaller n spars thu bound deriv section tighter discuss 4 ch 8 1 directli appli comput approxim invers precondit system 2 basic assumpt 18 coincid stop criterion use spai algorithm proof sinc immedi obtain left inequ 19 deriv left inequ 20 use definit 2norm get right inequ 19 20 use 23 hold 2norm frobeniu norm kr k k 1 bound immedi get 21if appli gershgorin theorem see eigenvalu lie insid disk radiu center 1 therefor nonsingular summar result corollari corollari 31 gener know p advanc 21 use comput sinc p n see p must nonsingular give criterion choos given n although practic often costli run algorithm small even symmetr nonsymmetr gener may appropri use symmetr precondition deriv estim begin follow inequ hold 2norm frobeniu norm symmetr therefor symmetr precondition 2 satisfi gener equat 26 pessimist estim much practic use spai algorithm take advantag symmetri yield symmetr approxim invers easi howev reformul algorithm comput lower triangular part yield symmetr precondition algorithm lose inher parallel interest altern would comput factor spars approxim invers 11 leav sparsiti open like spai algorithm converg iter method heavili depend distribut eigenvalu singular valu precondit matrix 6 inde eigenvalu cluster 1 outlier present converg gener fast thu crucial deriv estim spectrum determin theoret effect precondition estim summar follow two theorem theorem 32 let 1kn fnumber nonzero element r k eigenvalu k cluster 1 lie insid circl radiu proof let qrq schur decomposit gamma eigenvalu k cluster 1 next use gershgorin theorem 21 conclud k lie insid disk radiu p center 1 immedi consequ 28 see minim kam gamma ik f also reduc departur normal knk 2 schur decomposit deriv bound singular valu condit number theorem 33 singular valu cluster 1 lie insid interv 1 gamma furthermor condit number satisfi proof sinc singular valu squar root eigenvalu bound 31 next appli 28 amm instead conclud singular valu must cluster 1essenti properti converg iter method cluster eigenvalu singular valu condit number departur normal precondit linear system section shown minim kam gamma ik frobeniu norm produc precondition improv four point 4 first numer exampl begin detail studi orsirr2 smallest among orsx oil reservoir simul problem harwellbo matrix collect converg result orsreg1 orsirr1 present end section brief descript problem bcg cg bicgstab gmres20 cgne tabl 1 converg result orsirr2 unprecondit precondit 02 06 orsreg1 oil reservoir simul matrix 21 theta 21 theta 5 full grid size entri orsirr1 oil reservoir simul matrix 21 theta 21 theta 5 irregular grid orsirr2 oil reservoir simul matrix 21 theta 21 theta 5 irregular grid rather small size orsirr2 comput true invers eigenvalu singular valu precondit system numer experi present section comput doubl precis use matlab implement initi guess alway stop criterion tabl 1 present converg result varieti iter method decreas valu algorithm variou iter method obtain 2 converg result without precondit list denot cgne cg algorithm appli precondit normal equat amm reduc kam gamma ik f number iter drop significantli iter method result tabl 1 exemplifi robust precondition respect tabl 2 orsirr2 kam gamma ik condit number differ valu tabl 2 compar differ norm gamma function reduc 1norm 2norm remain nearli constant thu better solut minim problem kam gamma ik 1 comput 02 also true 2norm long 03 indic neither 1norm 2norm good measur proxim ident frobeniu norm minim reduc singular valu cluster one demonstr theorem 33 clearli shown tabl 2 sinc condit number ratio largest smallest singular valu figur 1 verifi improv cluster eigenvalu predict theorem 32 reduc next compar approxim bcg cg bicgstab gmres20 gmres50 tabl 3 converg result orsreg1 orsirr1 unprecondit precondit 02 02 figur 1 orsirr2 eigenvalu 02 bottom invers true invers gamma1 comput gamma1 discard entri whose absolut valu less equal 0001 comput approxim invers 02 quit strike well sparsiti pattern matric agre qualit figur 2 conclud section converg result orsreg1 orsirr1 given tabl 3 rel sparsiti nzmnza 094 orsreg1 088 orsirr1 5 numer experi section consid wide spectrum problem come scientif industri applic shall demonstr effect precondition two standard differ iter method bicgstab gmresm restart recal former requir two matrixvector multipl per iter wherea latter requir one matrixvector multipli per iter numer calcul figur 2 orsirr2 sparsiti pattern entri gamma1 larger 0001 absolut valu left spars approxim invers 02 right initi guess x unless specifi stop criterion 33 comput done doubl precis fortran partli sparc10 sun station partli iri 4d35 sgi station fortran code provid 2 use gmre begin converg result five shermanx black oil simul set consist sherman1 black oil simul shale barrier size sherman2 thermal simul steam inject 6 theta 6 theta 5 grid 5 unknown sherman3 black oil imp simul 35 theta 11 theta 13 grid 1 unknown sherman4 black oil imp simul 16 theta 23 theta 3 grid 1 unknown sherman5 fulli implicit black oil simul 16 theta 23 theta 3 grid 3 unknown sh1 sh2 sh3 sh4 sh5 tabl 4 converg result shermanx unprecondit top precondit bottom righthand side alway provid tabl 4 show precondit clearli improv converg consid problem max denot upper limit number nonzero element per column sherman2 bicgstab gmres20 reduc rel residu 10 gamma5 4 7 step respect never reach gamma8 may due larg condit number 964 theta 10 11 sherman2 could improv upon differ implement gmre 16 might reduc residu pursu matter figur 3 display origin matrix approxim invers sherman2 pictur clearli show simpli set equal band matrix like 10 inde sparsiti structur total differ particular case wherea number nonzero entri matric compar next set exampl consist larger problem poresx collect pores2 nonsymmetr matrix pores3 nonsymmetr matrix saylor3 nonsymmetr problem saylor4 nonsymmetr problem righthand side randomli chosen sinc pores2 gener spars approxim invers iter never reach rel figur 3 sherman2 origin matrix left spars approxim invers toler 10 gamma8 opt left instead right precondit thu case pores2 consid kma gamma ik f instead 4 yet still comput exact residu origin problem check converg approach prove effici row gamma1 could approxim effect column figur 4 compar pores2 left approxim invers number nonzero entri similar sparsiti pattern quit differ pores2 gmres20 reduc rel residu 10 gamma6 106 iter improv differ implement gmre 16 might mitig problem saylor3 discov column 988 989 998 999 two independ 2 theta 2 singular submatric ignor four column comput simpli replac two submatric 2 theta 2 ident matric guarante exist solut set righthand side time random vector orsx shermanx poresx saylorx problem taken harwellbo matrix collect compar studi problem differ iter method use incomplet lu precondit found 15 final part section shall consid sever larg problem righthand side alway provid initi guess x toler 33 start four typic problem centric engin figur 4 pores2 origin matrix left spars approxim invers pore 2 pore 3 saylor 3 saylor 4 bicgstab 78 118 104 285 tabl 5 converg result poresx saylorx unprecondit top precondit middl bottom left precondit use pores2 tabl 6 converg result px unprecondit top precondit bottom p1 incompress flow pressur driven pipe p2 incompress flow pressur driven pipe p3 land hydrofoil airplan fse model p4 slosh tank model remark use actual number nonzero element px matric sinc 03 entri zero origin data file quit remark although px matric rather full obtain big improv converg much sparser approxim invers moreov period pattern figur 5 one could determin sparsiti pattern first column slide pattern diagon lower right corner get full sparsiti structur conclud seri numer experi consid three problem come implicit 2d euler solver unstructur grid 19 matric order correspond initi later stage flow simul none problem converg without precondit first problem t01 much easier sinc flow still initi stage also discuss 7 see t01 obtain consider improv figur 5 p1 origin matrix left spars approxim invers converg spars approxim invers ran t01 04 maximum 50 nonzero entri per column lead rel sparsiti t25 t50 ran 03 maximum 100 nonzero entri per column lead rel sparsiti figur 6 converg histori tx bicgstab rel residu vs number iter t01dashdot t25dot t50solid 6 conclus spai algorithm comput spars approxim invers gener spars matrix inher parallel sinc column calcul independ one anoth matrix give valuabl insight gamma1 provid measur proxim gamma1 instead impos priori sparsiti pattern upon let algorithm captur automat relev entri invers thu minim number nonzero entri concentr comput effort need algorithm gener robust flexibl precondition iter solver give full control sparsiti qualiti shown theoret practic point view precondition gener spai algorithm effect improv converg iter solver possibl minim total execut time particular problem architectur choos optim clear spars precondition cheap may lead much improv con vergenc becom dens becom expens comput optim precondition lie somewher two ex treme problem architectur depend parallel environ slow commun capabl cluster workstat may advantag comput fairli dens approxim invers increas local floatingpoint intens comput reduc number iter henc amount commun requir iter inner product matrixvector product diminish implement method parallel comput straight forward sinc calcul done independ yet processor must access data requir solv subproblem although precondition invari permut order unknown affect amount interprocessor commun involv comput may optim particular applic approach prove particularli effect linear system need solv repeatedli implicit timemarch scheme solut nonlinear equat acknowledg thank horst simon provid us matric help comment paper written second author visit sccm program stanford univers would like thank gene golub kind hospit r cambridg univers press templat solut linear system approxim invers precondition gener spars matric approxim invers precondit spars linear system decay rate invers band matric iter solut linear system implement detail coupl qmr algorithm numer method solv linear least squar problem parallel precondit approxim invers connect machin parallel precondit approxim invers connect machin factor spars approxim invers precondit factor spars approxim invers fsai precondit solv 3d fe system massiv parallel comput ii spars approxim invers precondit solv 3d cfd problem massiv parallel comput flexibl innerout precondit gmre algorithm compar studi precondit lanczo method nonsymmetr linear system effici high accuraci solut gm resm gmresr famili nest gmre method unstructur grid solver ipsc860 tr ctr e flrez garca l gonzlez g montero effect order spars approxim invers precondition nonsymmetr problem advanc engin softwar v33 n710 p611619 29 novemb 2002 sangback comparison ilu0 pointssor spai precondition crayt3 nonsymmetr spars linear system aris pde structur grid intern journal high perform comput applic v14 n1 p3948 februari 2000 thoma huckl factor spars approxim invers precondit journal supercomput v25 n2 p109117 june ravindra boojhawon muddun bhuruth restart simpler gmre augment harmon ritz vector futur gener comput system v20 n3 p389397 april 2004 j martnez g larrazb waveletbas spai precondition use local drop mathemat comput simul v73 n1 p200214 6 novemb 2006 kai wang sangba kim jun zhang kengo nakajima hiroshi okuda global local parallel precondit techniqu larg scale solid earth simul futur gener comput system v19 n4 p443456 may tanaka nodera effect approxim invers precondit use mr algorithm origin 2400 proceed third intern confer engin comput technolog p115116 septemb 0406 2002 stirl scotland davod khojasteh salkuyeh faezeh toutounian bilu block version ilu factor korean journal comput appli mathemat v15 n12 p299312 may 2004 oliv brker oscar chinellato roman geu use python larg scale linear algebra applic futur gener comput system v21 n6 p969979 june 2005 liang j weston szularz gener leastsquar polynomi precondition symmetr indefinit linear equat parallel comput v28 n2 p323341 februari 2002 olivi besson band precondition applic precondit conjug gradient method parallel comput parallel numer linear algebra nova scienc publish inc commack ny 2001 georg gravvani konstantino giannoutaki parallel precondit conjug gradient squar method base normal approxim invers scientif program v13 n2 p7991 april 2005 n guessou souhar multilevel block ilu precondition spars nonsymmetr mmatric journal comput appli mathemat v162 n1 p231246 1 januari 2004 bhuruth k jain gopaul precondit iter method ninepoint approxim convectiondiffus equat journal comput appli mathemat v138 n1 p7392 1 januari 2002 kai wang jun zhang multigrid treatment robust enhanc factor spars approxim invers precondit appli numer mathemat v43 n4 p483500 decemb 2002 stephen barnard lui bernardo horst simon mpi implement spai precondition t3e intern journal high perform comput applic v13 n2 p107123 may 1999 clau koschinski new method adapt approxim invers precondition appli numer mathemat v41 n1 p179218 april 2002 denni c smolarski diagonallystrip matric approxim invers precondition journal comput appli mathemat v186 n2 p416431 15 februari 2006 matthia bollhfer volker mehrmann converg estim algebra multilevel precondition contemporari mathemat theori applic american mathemat societi boston 2001 oliv brker marcu j grote spars approxim invers smoother geometr algebra multigrid appli numer mathemat v41 n1 p6180 april 2002 prasanth b nair arindam choudhuri andi j kean greedi learn algorithm spars regress classif mercer kernel journal machin learn research 3 312003 georg gravvani solut boundari valu problem use fast gener approxim invers band matrix techniqu journal supercomput v25 n2 p119129 june michel benzi miroslav tma parallel solver largescal markov chain appli numer mathemat v41 n1 p135153 april 2002 keita teranishi padma raghavan esmond ng new datamap scheme latencytoler distribut spars triangular solut proceed 2002 acmiee confer supercomput p111 novemb 16 2002 baltimor maryland g gravvani k giannoutaki p bekako b efremid parallel systol solut normal explicit approxim invers precondit journal supercomput v30 n2 p7796 novemb 2004 edmond chow parallel implement practic use spars approxim invers precondition priori sparsiti pattern intern journal high perform comput applic v15 n1 p5674 februari 2001 f f hernndez j e castillo g larrazb larg spars linear system aris mimet discret comput mathemat applic v53 n1 p111 januari 2007 anwar hussein ke chen fast comput method locat fold point power flow equat journal comput appli mathemat v164165 n1 p419430 1 march 2004 j denni h tufo scale climat simul applic ibm blue genel system ibm journal research develop v52 n1 p117126 januari 2008 michel benzi precondit techniqu larg linear system survey journal comput physic v182 n2 p418477 novemb 2002