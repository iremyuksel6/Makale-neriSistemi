algebra approach ip traceback present new solut problem determin path packet travers internet call traceback problem denialofservic attack articl refram traceback problem polynomi reconstruct problem use algebra techniqu code theori learn theori provid robust method transmiss reconstruct b introduct denial servic attack design prevent legitim access resourc context internet attack flood victim connect random packet prevent legitim packet get internet denial servic attack becom preval recent due near untrac rel eas execut 9 also avail tool stacheldraht 11 tfn 12 greatli simplifi task coordin hundr even thousand compromis host attack singl target attack difficult trace hint victim sourc given packet sourc address easili forg although ingress filter help prevent packet leav border network without sourc address border network 14 attack counter choos legitim border network address random traceback problem also difficult mani attack launch compromis system find sourc attack packet may lead attack disregard problem find person respons attack victim abl determin path attack packet near realtim would much easier quickli stop attack even find partial path inform would use attack could throttl far router paper present new scheme provid traceback data router emb inform randomli packet similar techniqu use savag et al 24 major differ scheme base algebra techniqu advantag provid scheme offer flexibl design power techniqu use filter attack gener nois separ multipl path scheme share similar backward compat increment deploy properti previou work specif scheme encod path inform point polynomi use algebra method code theori reconstruct polynomi victim appear power new approach ip traceback problem note although studi traceback mechan motiv denial servic attack applic well method might use analysi legitim traffic network exampl congest control robust rout algorithm dynam network reconfigur might benefit realtim traceback mechan rest paper organ follow section 2 discuss relat work section 3 contain overview problem assumpt section 4 present approach algebra code path section 5 give detail specif scheme section 6 provid mathemat analysi victim reconstruct task section 7 discuss issu encod mark data ip packet 8 give conclus futur work relat work idea randomli encod traceback data ip packet first present savag et al 24 propos scheme adjac router would randomli insert adjac edg inform id field packet key insight traceback data could spread across multipl packet larg number packet expect also includ distanc field allow victim determin distanc particular edg host prevent spoof edg closer nearest attack biggest disadvantag scheme combinatori explos edg identif step feasibl parameter work song perrig provid depth analysi scheme 25 mani notabl propos ip traceback sinc origin propos bellovin propos router creat addit icmp packet traceback inform random public key infrastructur verifi sourc packet 4 scheme also use nonauthent mode although attack easili forg part rout farther victim closest attack song perrig improv packet mark scheme cope multipl attack 25 unfortun scheme requir victim current map upstream router attack although song perrig describ map maintain addit increment deploy requir router attack path particip although song perrig note also suffic upstream map indic router particip doeppner klein koyfman propos ad traceback inform ip option 13 besid larg space overhead solut would caus seriou problem current router unabl process ip packet option hardwar r 4 r 5 r 6 r 7 3 4 figur 1 exampl network also caus other issu exampl ad option may requir packet fragment burch cheswick scheme use udp packet requir particip intermedi isp 8 scheme howev assum denial servic attack come singl sourc network differ us aim distinguish multipl attack host lee park analyz packet mark scheme gener 19 paper contain gener tradeoff mark probabl recov path length packet receiv appli probabilist mark scheme includ one paper refer reader savag paper discuss method detect prevent ip spoof denial servic attack algebra techniqu appli origin develop field code theori 15 machin learn 2 overview algebra code theori refer reader survey sudan 27 book berlekamp 6 overview paper address savag et al call approxim traceback problem would like recov path attack victim allow path invalid prefix exampl network shown figur 1 true path attack 1 victim v r 4 r 2 r 1 allow techniqu also produc path form r 2 r 6 r 4 r 2 r 1 true path suffix recov path famili algebra scheme motiv assumpt use previou work 1 attack abl send packet 2 multipl attack act togeth 3 attack awar traceback scheme 4 attack must send least thousand packet 5 rout host gener stabl packet reorder lost 6 router much perpacket comput 7 router compromis router particip algebra code path present seri scheme use algebra approach encod traceback inform scheme base princip reconstruct polynomi prime field basic idea polynomi f x degre prime field gfp recov f x given f x evalu 1 uniqu point let 1 32bit ip address router path p associ packet id x j jth packet somehow evalu f p packet travel along path accumul result comput run total along way enough packet path reach destin f p reconstruct interpol interpol calcul might simpl set linear equa tion packet receiv destin travel path otherwis need employ sophist interpol strategi succeed even presenc incorrect data data multipl path 5 28 15 7 method develop origin use code theori learn theori naiv way evalu f p w would jth router add j w n j accumul kept run total unfortun would requir router know posit path total length path could elimin need router know total length path still requir router know posit path reorder coeffici f howev even better stick origin order use altern mean comput polynomi specif comput f p w router r j multipli amount accumul w add return result accumul pass packet next router path horner rule 18 exampl 0 wr 1 wr 2 wr 3 wr notic router doesnt need know total length path posit path comput f p 41 determinist path encod simplest scheme use algebra techniqu encod entir path begin path let fullpath 0 router path calcul fullpath random valu pass packet r router ip address p smallest prime larger 2 32 1 valu fullpath pass packet along x j next router packet destin fullpath equal r n x reconstruct solv follow matrix equat gfpb b b fullpath n1 fullpath n2 fullpath n3c c c long x distinct matrix vandermond matrix thu full rank solvabl 2 field oper 22 assum get uniqu x j packet recov path length packet downsid howev scheme would requir log bit per packet first term encod run fullpath second term encod x j j valu even modest maximum path length 16 space requir 68 bit count 4 bit record number router path 32 bit x coordin coordin point polynomi far exce number bit avail us ip header could split router ip address c chunk add dlog 2 ce bit indic chunk repres given packet anoth approach would router add chunk packet router would updat fullpath c time substitut chunk ip address order destin could trivial reconstruct ip address interpol recov r 11 r 12 success chunk r j would increas degre f factor c would impact perform reconstruct algorithm 42 random path encod scheme requir fullpath 0 impli way router know first particip router particular path current internet architectur reliabl way router inform must therefor extend scheme mitig problem revis scheme router first flip weight coin came tail router would assum first router simpli follow fullpath algorithm present ad ip address ip address chunk data hand coin came head router would assum first router randomli choos x j use path refer state mark mode overal approach might call reset paradigm also use savag et al traceback solut destin would receiv number differ polynomi repres suffix full path exampl network packet 1 could contain r could chang mark strategi slightli whenev router receiv packet still flip weight coin instead simpli go mark mode one packet coin come head router could stay mark mode next packet receiv gener reset behavior could follow markov process one problem attack caus fals path true path receiv victim due fact choic small p creat larg number packet router packet path mark mode attack thu insert path inform wish packet attack gener find path victim use tracerout exampl comput fullpath 0 choic caus victim receiv fullpath tri reconstruct path victim indic path real path fake two solut problem increas p store hop count distanc field packet particip router would increment increas probabl make even harder receiv long path ad hop count would prevent attack forg path suffix path closer actual distanc victim would requir dlog 2 de bit packet scheme could also make use hmac techniqu discuss song perrig ensur edg fake would requir us either use addit space packet store hash lose increment deploy properti 25 decid make one tradeoff scheme would compar secur multipl attack 43 edg encod could add anoth paramet repres maximum length encod path valu set mark router decrement particip router add ip inform valu reach 0 router add inform exampl full path encod scheme encod edg router call algebra edg encod scheme benefit chang would decreas maximum degre polynomi order reduc number packet need given set packet recov rout cost chang would add dlog bit packet cours less true path length reconstruct find arbitrari subsequ path suffix full path encod victim still work combin subsequ properli describ savag et al thu reconstruct scheme algebra step follow combinatori step 5 pseudocod sampl algebra scheme section present pseudocod sampl algebra mark scheme base principl describ previou section recal router uniqu 32bit id 51 algebra edg encod router pseudocod edge1 algebra edg encod scheme packet mark number x valu degre polynomi one mark procedur router r packet w probabl p wxval random wyval r wflag otherwis wflag wyval wyval wxval wflag 0 edge2 algebra edg encod c chunk per hop packet mark d32ce dlogne1 bit degre polynomi 2c 1 mark procedur router r packet w probabl p wxval random wyval rc wxvalc1 wflag otherwis wflag wyval wyval wxvalc wflag 0 edge3 ident edge2 except packet also distanc field hop count follow savag et al reserv five bit distanc field packet mark d32ce dlogne6 bit degre polynomi 2c 1 mark procedur router r packet w probabl p wxval random wyval rc wxvalc1 wflag wdist 0 otherwis wflag wyval wyval wxvalc wflag 0 wdist edge4 ident edge3 except second router contribut half bit router id lower degre polynomi introduc littl uncertainti reconstruct process two router distanc victim router id agre contribut bit packet mark d32ce dlogn 6 bit degre polynomi 15c 1 mark procedur router r packet w probabl p wxval random wyval rc wxvalc1 wflag wdist 0 otherwis wflag wyval wyval wxvalc2 wflag 0 wdist 52 algebra full path encod router pseudocod full1 full path encod scheme packet mark 32dlogn bit n number possibl x valu degre path polynomi l length path full1 mark procedur router r packet w probabl p wxval random wyval 0 wyval wyval wxval router pseudocod full2 full path encod scheme distanc field hop count follow savag reserv five bit distanc field packet mark 37 dlogn bit full2 mark procedur router r packet w probabl p wxval random wyval 0 wdist 0 wyval wyval wxval wdist 6 path reconstruct victim section look close problem path reconstruct victim let k denot number attack path let l denot expect length attack path simplic assum attack path close l length main scheme savag et al use total 16 bit complex path reconstruct victim olk 8 expon eight reflect combinatori task victim must tri brute forc cours room work mark scheme reconstruct complex would go exampl use 23 bit mark scheme divid pad router id four 16bit chunk victim reconstruct task reduc olk 4 goal design algebra scheme improv reconstruct complex savag et al two main algebra reconstruct approach consid reedsolomon list decod given polynomi degre pass least point guruswamisudan give algorithm solv problem time 3 n 2 improv olshevski shokrollahi reduc time 25 precis reconstruct algorithm due guruswami sudan 15 implement number way straightforward implement would take time 3d recov edg receiv least dn packet howev drop 3 requir slightli packet dn1d n 1 scale appropri allow us trade comput time memori accuraci recent algorithm breakthrough olshevski shokrollahi would reduc reconstruct time even 25 21 moreov new algorithm highli paralleliz processor suggest distribut reconstruct task might speed thing even noisi polynomi interplo given find polynomi f degre f bleichenbachernguyen give algorithm solv problem whenev nd run time ident reedsolomon list decod problem give algorithm work even bound nd met type packet let us assum packet victim receiv one three possibl type true packet contain point polynomi correspond real attack path bogu packet contain point creat attack outsid peripheri never reset honest router along attack path stray packet contain point polynomi correspond normal nonattack traffic denial servic attack underway assum fraction stray packet small compar true bogu packet fals posit fals posit polynomi recov reconstruct algorithm correspond part actual attack path reedsolomon list decod expect number fals posit random sampl nmn 1q 1 noisi polynomi interpol expect number fals posit random sampl n q n 1 main scheme savag et al expect number fals posit 8 2 mark scheme distanc field must also concern bogu edg bogu path attack caus appear sam ple consid separ issu fals posit aris random moder number fals posit seriou problem consid mark scheme edge3 victim reconstruct set candid edg distanc set candid edg includ true edg fals posit bogu edg attack assum attack within distanc vic tim victim attempt assembl path connect edg distanc edg distanc 1 certainli problem unless first endpoint fals posit edg distanc match second endpoint fals posit true edg distanc 1 let f expect number fals posit distanc let k number true edg distanc f expect fals posit distanc expect fals posit true edg distanc 1 let number distinct router id partial router id possibl eg 2 edge3 probabl accident match less 1 f f k close 1 e f f km f close probabl unaccept high probabl accident match distanc less length longest path analyz effect approach path reconstruct approach best known algorithm impos constraint design paramet mark scheme conveni us consid separ mark scheme distanc field mark scheme 61 reconstruct distanc field mark scheme distanc field task victim simplifi victim select sampl packet wdist given long attack within distanc victim sampl contain true packet point polynomi last reset router distanc 611 guruswamisudan reconstruct distanc field path reconstruct problem face victim view reedsolomon list decod problem distinct point chosen random sampl distinct point packet reach victim victim filter packet last reset distanc everi simplifi reedsolomon list decod problem creat smaller problem instanc distanc need nk packet distanc n distinct point k polynomi victim collect largest possibl sampl distinct point packet wdist everi need n n 2 reconstruct polynomi use guruswamisudan algorithm lastli need effici reconstruct improv savag et al least solut improv compel exampl use edge3 three 11bit chunk competit savag et al certain valu k 612 bleichenbachernguyen reconstruct distanc field problem face victim view noisi polynomi interpol problem valu x possibl x valu set contain distinct valu occur packet within random sampl receiv packet polynomi f could polynomi correspond true attack path stray path victim could proceed follow look sampl n packet suitabl larg n x choos set size sampl number distinct valu occur sampl greater victim choos valu includ random victim filter packet last reset distanc everi creat smaller problem instanc distanc problem instanc number set equal n number possibl x valu size k number attack path degre polynomi depend particular algebra encod method use fals posit k n way take one x valu set actual polynomi degre less probabl 1q n 1 q size finit field essenti number distinct valu need expect number fals posit k n q n 1 reason small basic reconstruct algorithm bleichenbachernguyen need k nd three algorithm bleichenbachernguyen work mani knd even satisfi k nd meetinthemiddl algorithm run time n dm n2 precomput use memori om n4 logq note independ k grobner basi reduct algorithm comput grobner basi reduct system k polynomi equat 1 unknown best known grobner basi algorithm superexponenti reason effici small eg 20 lattic basi reduct algorithm perform lattic basi reduct 1dimension lattic z nk finit field size n method ineffect applic size finit field small effici savag et al need nk 25 k 8 interest instanti scheme respect method reconstruct exampl 1 edge3 encod 12 distinct x valu repres 4bit xval field 8bit yval field noisi polynomi problem 12 set size k number attack path degre polynomi 7 size finit field 256 meetinthemiddl algorithm take time 8k 6 compar favor k 8 requir savag et al grobner basi reduct algorithm also reason effici total size mark scheme bit howev number fals posit unaccept high k 12 2 exampl 2 edge4 encod 12 distinct x valu 4bit xval field 8 bit yval field degre polynomi 5 run time meetinthemiddl algorithm 8k 6 run time grobner basi reduct algorithm faster previou exampl expect number fals posit lower previou exampl k 12 2 48 expect one fals posit distanc cours risk fals posit slightli greater previou case number possibl partial router id 2 22 thu slightli accident match endpoint involv bogu edg significantli wors total size mark scheme bit exampl 3 edge4 encod degre polynomi 4 use 22 bit second router id run time meetinthemiddl 6k 5 versu k 8 savag et al number fals posit savag exampl expect posit fals posit quit manag total size mark scheme 21 bit exampl 4 edge4 encod polynomi 4 run time meetinthemiddl 4k 4 number fals posit k 8 2 33 eg 12 total size mark scheme 20 bit exampl 5 edge4 encod polynomi 4 run time meetinthemiddl 8k 6 number fals posit k 12 2 77 eg 2 5 quit manag total size mark scheme 21 bit 62 reconstruct without distanc field reconstruct mark scheme distanc field achiev scheme competit savag et al analysi begin fact simplifi assumpt distribut receiv packet victim 621 distribut receiv packet fraction packet arriv ith attack path reach victim bogu packet let fraction packet ith attack path reach victim true packet let f fraction packet ith attack path reach victim true packet reset furthest router path assumpt encod scheme unless mark mode use f view function p fraction take maximum valu impli f encod scheme impli b fact larg fraction bogu packet arriv path seriou consequ mark scheme without distanc field let btf fraction bogu packet true packet furthest packet path victim assum arriv rate packet attack path approxim mark mode use probabl router reset mode coupon collector bound sampl lc logc element drawn replac accord uniform distribut like contain c possibl valu small constant l 622 guruswamisudan reconstruct without distanc field victim choos random sampl distinct point packet reach without distanc field partit packet smaller sampl last assum router use edg encod scheme assum succeed reconstruct furthest edg polynomi let us also assum search polynomi pass n distinct point n number distinct x valu actual three distinct level reconstruct success con sider sampl n point contain least n point everi furthest edg polynomi overwhelm probabl b sampl n point contain least n point furthest edg polynomi overwhelm probabl c sampl n point contain least n point furthest edg polynomi nonneglig probabl q case guruswamisudan algorithm need appli random sampl n point case b algorithm need appli lklogk time independ random sampl n point coupon collector problem set k furthest edg polynomi case c algorithm need appli lklogkq time independ random sampl n point case suffic n lnklognkp1 p l 1 like get complet set n possibl x valu k edg poli nomial impli lnklognk sampl suffici analysi preced subsect sampl furthest edg polynomi expect fraction packet combin guruswamisudan bound get n 2 lnklognkp1 p l 1 assum case b suffic n nk p1 p l 1 nk answer follow occup problem throw nk ball k bin expect find lnlogn ball bin ball pigeonhol principl certainli true nk lnklogn fact actual valu nk quit close combin guruswamisudan bound get n 2 lnklognp1 assum lnlogn dkl 1e case c reduc valu nk littl doesnt appear signific purpos cours b c reduc n elimin sampl duplic point sinc mani 1e packet sampl could bogu packet attack remov duplic point limit benefit find solut yield mark scheme effici savag et al moreov plausibl instanti number fals posit bogu edg bogu path unaccept high 623 bleichenbachernguyen reconstruct without distanc field victim proceed describ start section 612 although without distanc field packet partit last reset distanc version h length type servic 8bit total length fragment id 16bit flag fragment offset time live protocol header checksum sourc ip address destin ip address figur 2 ip header darken area repres underutil bit suppos n chosen larg enough point furthest polynomi includ high probabl probabl given includ point f least mn probabl reconstruct succe least mn n basic algorithm bleichenbach nguyen solv noisi polynomi interpol whenev nk approach seem promis k 1 case mn n 2 n thu reconstruct unlik succeed victim choos posit integ c probabl reconstruct succe least 1 cn n e c un fortun either number fals posit unaccept larg success probabl unaccept small anoth approach would victim bia sampl respect frequent differ point occur packet reach unfortun appear work well either sinc victim abl recogn true packet contain point furthest polynomi conclud mark scheme distanc field see use bleichenbachernguyen method polynomi reconstruct least use simplest algorithm possibl algorithm eg base grobner basi reduct might effect 7 encod path data need way store traceback data ip packet tri maxim number bit avail us preserv part backward compat 71 ip option ip option seem like reason altern store path informa tion unfortun current router unabl handl packet option hardwar 3 even futur router abil number problem associ approach present savag et al 24 reason conclud store data ip option feasibl 72 addit packet instead tri add path data exist ip packet could instead send data band use new protocol would encapsul data may limit use special case deal ip fragment gener solut base insert addit packet requir mean authent packet presum number insert packet mani order magnitud less number packet insert attack thu assum attack insert packet network victim delug fake traceback packet prevent inform gain legitim packet 73 ip header last sourc bit ip header sever field header may exploit bit vari tradeoff shown figur 2 found 25 bit might possibl usedx 731 to field type servic field 8 bit field ip header current use allow host way give hint router kind rout import particular packet maxim throughput minim delay exampl 1 field littl use past limit experi found set field arbitrarili make measur differ packet deliveri propos internet standard 20 would chang to field differenti servic field even propos ds field unus bit howev alreadi propos use bit eg 23 732 id field id field field use ip permit reconstruct fragment naiv tamper field break fragment reassembl sinc less 025 internet traffic fragment 26 think overload field appropri indepth discuss issu relat overload found savag work 24 733 unus fragment flag unus bit fragment flag field current internet standard requir zero found set bit one effect current impl mentat except receiv packet system think fragment packet still success deliv howev look system though fragment 1 1 select could choos use 25 bit id flag to field would suffic exampl given section 612 implic use multipl field ip header simultan modest sinc lost function appear union would break due overwrit field separ impact header checksum calcul modest done hardwar use standard algorithm cours algebra mark scheme independ choic bit decis put mark data must seen condit subject chang new standard aris 74 ipsec interoper traceback scheme ipsec consid encapsul payload esp 17 encrypt datagram confidenti provid problem traceback scheme assum anyth surround datagram header authent header ah 16 present issu ipv4 use ah content surround datagram header hash certain header field consid mutabl eg fragment offset includ hash comput unfortun mutabl field ipv4 header unus traceback either necessari basic ip function reus break backward compat current ip implement 75 ipv6 sinc ipv6 nearli mani backward compat issu ipv4 logic place put traceback inform hopbyhop option ipv6 header 10 howev scheme present still valuabl use fix number bit per packet therebi avoid gener fragment unlik case ipv4 set appropri bit option type field indic data option mutabl treat zero purpos authent header work best way accommod ipv6 128bit address note due align issu one like select option length 8n6 byte n 0 would like case 0 8 conclus futur work present new algebra approach provid traceback inform ip packet approach base mathemat techniqu first develop problem relat error correct code machin learn though propos context probabilist packet mark scheme algebra approach could also appli outofpacket scheme result scheme would desir properti allow multipl router act extra packet remain small constant size mark scheme applic network manag scenario besid defens denial servic one import open problem find better instanti specif method propos particular success approach base full path trace would attract gener would interest explor resourc secur tradeoff mani parametr schemata lower bound size mark scheme would help would also interest explor use algebra geometr code mark scheme acknowledg would like thank david goldberg dan boneh valuabl discuss would also like thank dawn song adrian perrig ramarathnam venketesan glenn durfe anonym refere help comment earlier version paper r type servic internet protocol suit reconstruct algebra function mix data person commun icmp traceback messag correct algebra block code algebra code theori bleichenbach nguyen trace anonym packet approxim sourc cert coordin center denial servic attack internet protocol stacheldraht tribe flood network use router stamp identifi sourc ip packet network ingress filter defeat denial servic attack employ ip sourc address spoof improv decod reedsolomon algebraicgeometr code ip authent header ip encapsul secur payload esp art comput program effect probabilist packet mark ip traceback denial servic attack definit differenti servic field ds field ipv4 ipv6 header displac approach effici decod algebraicgeometr code numer recip fortran art scientif comput propos add explicit congest notif ecn ip practic network support ip traceback advanc authent mark scheme ip traceback provid guarante servic without per flow manag algorithm issu code theori decod reed solomon code beyond errorcorrect bound tr numer recip fortran 2nd ed art comput program volum 2 3rd ed decod reed solomon code beyond errorcorrect bound displac approach effici decod algebraicgeometr code provid guarante servic without per flow manag practic network support ip traceback use router stamp identifi sourc ip packet algorithm issu code theori ctr karthik lakshminarayanan daniel adkin adrian perrig ion stoica tame ip packet flood attack acm sigcomm comput commun review v34 n1 januari 2004 hikmat farhat protect tcp servic denial servic attack proceed 2006 sigcomm workshop largescal attack defens p155160 septemb 1115 2006 pisa itali florian p buchholz clay shield provid process origin inform aid comput forens investig journal comput secur v12 n5 p753776 septemb 2004 david g andersen mayday distribut filter internet servic proceed 4th confer usenix symposium internet technolog system p33 march 2628 2003 seattl wa katerina argyraki david r cheriton loos sourc rout mechan traffic polici proceed acm sigcomm workshop futur direct network architectur august 3030 2004 portland oregon usa hain wang danlu zhang kang g shin changepoint monitor detect do attack ieee transact depend secur comput v1 n4 p193208 octob 2004 andrey belenki nirwan ansari determinist packet mark comput network intern journal comput telecommun network v51 n10 p26772700 juli 2007 sherif khattab rami melhem daniel moss taieb znati honeypot backpropag mitig spoof distribut denialofservic attack journal parallel distribut comput v66 n9 p11521164 septemb 2006 brent water ari juel j alex halderman edward w felten new client puzzl outsourc techniqu do resist proceed 11th acm confer comput commun secur octob 2529 2004 washington dc usa hassan aljifri ip traceback new denialofservic deterr ieee secur privaci v1 n3 p2431 may zhiqiang gao nirwan ansari practic robust interdomain mark scheme ip traceback comput network intern journal comput telecommun network v51 n3 p732750 februari 2007 christo siaterli vasili maglari one step ahead multisensor data fusion ddo detect journal comput secur v13 n5 p779806 octob 2005 christo douligeri aikaterini mitrokotsa ddo attack defens mechan classif stateoftheart comput network intern journal comput telecommun network v44 n5 p643666 5 april 2004