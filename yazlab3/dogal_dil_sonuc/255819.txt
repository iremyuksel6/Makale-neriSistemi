integ multiflow maxim gener twocommod flow theorem rothschild whinston oper re 14 1966 pp 377387 multiflow theorem lovsz acta mat akad sci hungarica 28 1976 pp 129138 cherkaski ekonommat metodi 13 1977 pp 143151 karzanov lomonosov mathemat program larichev ed institut system studi 1978 pp 5966 1978 prove minmax theorem maximum multiflow origin proof quit long technic reli earlier investig metric main purpos present paper provid rel simpl proof theorem proof reli lock theorem anoth result karzanov lomonosov polymatroid intersect theorem edmond combinatori structur applic r guy h hanani n sauer j schnheim ed gordon breach 1970 pp 6987 complet also provid simplifi proof lock theorem final introduc notion node demand problem anoth applic lock theorem deriv feasibl theorem concern itth present approach give rise combinatori polynomialtim algorithm b introduct e two undirect graph v call path g h admiss connect two node x xy 2 f g call suppli graph h demand graph element termin element v call inner node maxim problem consist find maximum number edgedisjoint hadmiss path h consist one edg menger theorem give answer gener problem npcomplet even special case g eulerian graph call eulerian degre everi node even howev import special case problem tractabl rothschild whinston 1966 prove maxflow mincut type theorem g inner eulerian h consist two edg say pair g inner eulerian degre dv even everi inner node v anoth result due independ l lovasz 1976 bv cherkasskij 1977 solv maxim problem h complet graph g inner eulerian 1978 av karzanov mv lomonosov found common gener two theorem origin proof rather lengthi technic certainli much difficult two special case mention detail proof describ karzanov 1979 lomonosov 1985 later karzanov 1985 1987 exhibit anoth proof base splittingoff techniqu gave rise strongli polynomi solut algorithm howev latter proof also rather complic main contribut paper rel simpl proof theorem karzanov lomonosov proof reli two ingredi socal lock theorem anoth result karzanov lomonosov depart oper research eotvo univers muzeum krt 68 budapest hungari h1088 research author partial support hungarian nation foundat scientif research grant otka t17580 partial carri author visit imag universit de grenobl bp 53 38041 grenobl cedex franc institut system analysi prospect imag universit j fourier bp 53 38041 grenobl cedex franc research first author partial support european project donet 1978 polymatroid intersect theorem j edmond 1970 complet also provid simplifi proof lock theorem sinc ingredi solv combinatori polynomialtim algorithm approach give rise altern strongli polynomialtim algorithm capacit maxim problem question faster karzanov 1985 follow distinguish oneel set fxg element x set x element let denot union x vector use notat famili pairwis disjoint nonempti subset set call subpartit two element set x call tsset 2 x 62 x integervalu vector function call even valu even integ polyhedron p use notat graph e cut x denot set edg precis one endnod x cardin denot dx call degre function g let dx denot number edg one x gamma gamma x let easi prove satisfi follow ident everi pair xy subset v let b two disjoint subset v path connect element element b call bpath path connect two distinct element call apath b g simpli b stand maximum number edgedisjoint bpath menger theorem one may consid fraction version edgedisjoint path problem let g h hmultiflow briefli multiflow x mean famili fp path g along nonneg coeffici ff p connect endnod demand edg x call integervalu ff integ p connect element element b h complet bipartit graph bipartit b speak bflow hmultiflow x let xe e xt end call cadmiss xe ce everi e 2 e 2 lock problem e graph v subset termin node subset notat abbrevi g confus aris throughout paper assum current g inner eulerian lovasz 1976 cherkasski 1977 prove follow theorem theorem 21 inner eulerian pair g maximum number edgedisjoint path equal equival formul follow theorem 21 given inner eulerian pair g famili f edgedisjoint path g f contain path end 2 word singl famili edgedisjoint path includ maximum famili edgedisjoint simultan 2 karzanov lomonosov 1978 extend theorem formul result let us say famili f edgedisjoint path lock subset f contain apath furthermor say f lock famili l subset f lock member l theorem 21 assert famili f path lock singleton alway possibl find famili edgedisjoint path lock specifi famili l answer gener shown follow exampl l consist three pairwis cross set two subset xy call cross none fig 1 exampl indic natur requir l 3crossfre famili l subset call three pairwis cross member lock theorem 22 karzanov lomonosov 1978 karzanov 1984 lomonosov 1985 let g inner eulerian l 3cross free famili subset famili edgedisjoint path lock l proof slightli weaker version sketch karzanov lomonosov 1978 present proof reli idea split use alreadi karzanov 1984 technic simpler split pair adjac edg graph g mean oper replac e f new edg connect x way may introduc parallel edg x result graph denot g ef proof may assum gamma 2 l 2 l 2 l ad gamma l affect neither 3crossfre lockabl also assum g connect proceed induct number edg incid element number zero statement trivial therefor edg st go show edg theorem follow sinc induct famili f path g ef lock l path use new edg h g ef arisen split e f revis f replac p e f 21 revis f lock l g proof sinc analog therefor 11 claim follow ffl call set x v tight close complement tight g inner eulerian pair edg precis tight set x x 2 22 three maxim tight tsset proof let xy z maxim tight tsset sinc l 3crossfre two three set x z say noncross either first two case x tight contradict maxim x last case appli claim 1 contradict exist edg st ffl let denot set neighbour claim 3 possibl cover two tight tsset proof suppos xy x tight tsset let ff ds symmetri may assum ff fi impli dx x hand sinc fl posit claim 2 3 edg satisfi 22 21 hold proof lock theorem complet ffl ffl one may interest possibl lock theorem rather 3crossfre properti assum famili l 2 lock neg side karzanov pevzner 1979 show everi l includ three pairwis cross set graph g subset node g inner eulerian famili path lock member l hand lock theorem restrict impos relationship g famili l exampl let g planar eulerian graph let denot node outer face cyclic order defin l consist subset form though l 3cross free k 4 lock theorem hold theorem equival planar dualiz result hurken schrijver tardo 198889 need slight extens theorem 22 let z nonneg integervalu function famili f edgedisjoint path call mindepend everi termin 2 end mt member f let denot maximum number edgedisjoint mindepend apath say famili f edgedisjoint path mlock subset f independ contain apath furthermor say f mlock famili l subset f mlock member l follow theorem straightforward consequ theorem 22 use proof theorem 43 theorem 23 let g innereulerian l 3cross free famili subset let z vector mt dt even 2 famili f edgedisjoint path mlock l proof let g 0 graph aris g split everi node 2 follow sens add new node 0 along mt parallel edg 0 replac edg xt g xt 0 result immedi follow theorem 22 appli g 3 flow polymatroid nonneg setfunct call polymatroid function 1 2 b monoton increas e 3 b submodular ie degreefunct graph g satisfi properti 1 3 typic 2 polyhedron p b fx call polymatroid call integr everi vertex p integervalu concept polymatroid introduc j edmond 1970 prove polymatroid uniqu determin defin polymatroid function furthermor polymatroid integr b integervalu polymatroid p b face bb p b call basi polyhedron element base edmond also prove follow result theorem 31 edmond 1970 integr polymatroid p b integervalu vector x 2 p b integervalu basi x polymatroid intersect theorem edmond state linear system two polymatroid total dual integr tdi need follow consequ theorem 32 edmond 1970 two polymatroid function b defin power set furthermor b integervalu maximum attain integ vector follow vector x p p b bipartit fa bg b integralvalu x e graph endow capac function c subset node cadmiss bflow x everi v 2 ag f submodular monoton increas multitermin version maxflow mincut theorem vector 2 r belong pa mx f x therefor pa polymatroid furthermor c integervalu cadmiss integervalu bflow x e eulerian graph subset node defin c partit denot direct sum polymatroid lemma 33 let q integ basi p famili f edgedisjoint path connect distinct member 2 endpoint exactli qt path f proof 2 let x minim subset v claim set disjoint indirectli contradict minim x claim famili f 0 edgedisjoint path g connect distinct x use edg induc x f 0 contain end x 1 k inde appli theorem 21 pair g graph g 0 aris g contract x node denot 0 g sinc q basi p famili f 0 qt connect 2 endnod qt member f 0 member eras edg outsid x denot f famili result path glue togeth path f 0 path f obtain famili f path satisfi requir ffl lemma 34 let q integ basi p integ vector q independ famili f path mlock contain least qt 2 path connect distinct member proof lemma 33 q impli q sinc f mlock connect k lemma follow ffl remark sinc q basi f contain qt f contain qt 2 path connect distinct member number path f precis qt 2 need fact let b two partit let l ab let h demand graph uv edg h x 2 l includ u v setfunct defin seen polymatroid function defin b j analog b b polymatroid function let p p b polymatroid defin b respect arbitrari even vector p p b h 0 2 h edgedisjoint hadmiss path proof sinc g eulerian p a2 p a2 integr polymatroid appli theorem 31 p a2 x 0 2 obtain even base p 0 analog even base b p b b 0 defin vector mt maxm b even henc sinc l 3cross free appli theorem 23 let f denot famili mindepend path provid theorem jf go prove number h 0 hadmiss path f least h note path hadmiss precis connect two node belong member l appli lemma 34 choic p p q obtain gammam 2 path f endnod member analog endnod member b henc note element 2 need endnod exactli 0 member famili assur lemma 35 comment see begin section 6 4 maxim e suppli graph throughout section assum pair g inner eulerian dv even everi stand degre function g maxim form edgedisjoint path problem consist find maximum number g h edgedisjoint hadmiss path easili get upper bound let us call subpartit v admiss x stabl clearli valu call valu subpartit let g h denot minimum valu admiss subpartit follow exampl show equal gener fig 2 two known special case equal hold theorem 21 show case h complet graph reformul theorem 21 theorem 41 suppos g inner eulerian demand graph h complet anoth special case h consist two edg theorem 42 suppos g inner eulerian h consist two edg theorem rothschild whinston actual prove follow simpler form theorem 42 rothschild whinston 1966 suppos g inner eulerian h consist two edg minimum cardin 0 cut x g equival two form 0 may prove follow sinc cut x provid admiss partit special form clearli 0 see direct let p fx minim admiss subpartit g k minimum sinc jt j 4 exactli two termin node connect h furthermor say would also admiss partit whose valu bigger fx anoth optim admiss partit henc k 3 two member p say x 1 x 2 contain one termin node two termin node say connect h replac x 1 x 2 anoth minim admiss subpartit contradict minimum choic k ffl let us call graph bistabl two partit b x 2 xy edg h precis x belong differ part differ part b easili seen graph bistabl complement linegraph bipartit graph also shown bistabl graph famili maxim stabl set h partit two part consist disjoint set clearli cliqu gener complet kpartit graph bistabl 2k 2 also bistabl therefor theorem 21 22 special case follow theorem 43 karzanov 1985 lomonosov 1985 suppos g inner eulerian bistabl g proof slightli weaker halfintegr version sketch alreadi karzanov lomonosov 1978 reader may feel bistabl demand graph form rather peculiar class graph may larger natur class graph hold karzanov pevzner 1979 howev show bistabl contain isol node suppli graph g section 6 outlin origin plan proof intend use polymatroid intersect theorem point attempt fail perhap help reader understand led invok lock theorem proof proof 41 g see direct first prove theorem follow special case graph complet eulerian suppos theorem true eulerian want prove g h g inner eulerian let k denot set node g odd degre sinc g inner eulerian k k empti done new node let 0 let e respect maximum minimum question concern g assumpt obvious optim solut maxim problem concern everi edg xt x 2 k path solut thu optim admiss subpartit sinc everi edg xt x 2 belong henc mgammafxg admiss subpartit g h therefor conclud let b two partit defin bistabl graph h note stabl set h subset 2 b let b defin 31 sinc p a2 p b2 integr polymatroid theorem 32 exist even vector 0 p p b bipartit fa bg henc g henc proof complet find admiss subpartit valu end let us assum maxim subset b gamma satisfi 42 claim inde 0 bipartit fa would also satisfi 42 contradict maxim choic note choic b role b fulli symmetr 2 nonempti exist set x last equal follow 42 definit analog nonempti exist set j assum x j chosen minim let nonemptyg lemma 44 k admiss subpartit valu proof clearli element belong least one member k show one claim 0 henc 44a must hold otherwis element 2 x would violat 43 also everi 44b true element 2 j proper subset j contradict minim choic j henc proof 44 complet claim k subpartit assum contrari l k 6 kl 2 k definit k 44 minim choic member k impli definit k admiss valu lemmata 35 44 42 proof theorem 43 complet ffl ffl section briefli outlin proof give rise strongli polynomi combinatori algorithm capacit case inform polynomialtim algorithm strongli polynomi number step depend magnitud occur capac cost input algorithm consist two graph e g endow nonneg ration capac function assum two partit xy 2 f contain one x note graph h given incid matrix one test h effici bistabl name decid first enumer whether 2jt j maxim stabl set h answer ye h bistabl answer h bistabl intersect graph maxim stabl set bipartit output algorithm consist cadmiss hmultiflow x admiss subpartit v moreov c integervalu eulerian sens ffi c v even everi node v 2 v output x integervalu well actual assum c integervalu eulerian case one multipli capac 2n n denot least common denomin capac c inner eulerian appli reduct describ section 4 obtain complet eulerian case first remark proof lock theorem immedi provid polynomialtim algorithm setsystem l ab c ident 1 difficult show gener integervalu eulerian c everi step one split much capac possibl algorithm strongli polynomi cf karzanov 1984 follow comment use polymatroid intersect algorithm construct even vector 0 admiss subpartit occur proof theorem 43 disjoint set xy v let c x denot valu flow x help maxflow mincut mfmc comput c x comput strongli polynomi time set function defin analog b polymatroid defin b known polymatroid theori p c eulerian a2 b2 integervalu henc p a2 p b2 integr polymatroid therefor z integervalu vector p even vector p p b 0 v maximum polymatroid intersect theorem 32 bipartit fa bg combinatori strongli polynomi algorithm due p schonsleben 1980 comput z henc 0 fa bg algorithm work oracl avail minim vector case oracl inde construct invok mfmc algorithm way one obtain pure combinatori strongli polynomi algorithm comput 0 b satisfi 42 use proof claim 1 2 proof theorem 43 one may comput strongli polynomi time integervalu maximum multiflow admiss subpartit minimum valu karzanov 1985 describ direct way comput 0 minim admiss subpartit method consist one mfmc comput appropri defin auxiliari digraph jv jjt j node complex ojt jjv j n denot complex mfmc comput network n node next even basi p defin proof theorem 43 construct jaj resp jbj mfmc comput thu vector defin 44 comput 0 ojt jjv j step mlock problem solv appli ojv splittingoff oper everi node v 2 oper consist find jajjbj maximum flow g requir ojv j 2 jajjbjjv j ojv j 2 jt jjv j oper thu overal complex algorithm ojv one use mfmc algorithm complex upper bound run time algorithm compar complex algorithm karzanov 1985 6 nodedemand problem reader might feel invok lock theorem proof contain seemingli unnecessari twist fact origin tri prove theorem 43 use follow natur direct approach exampl show attempt fail recal polymatroid intersect theorem ensur exist maximum even vector 0 precis g h theorem 43 would follow exist system hfeasibl path 2 endnod precis 0 unfortun system need alway exist shown follow exampl figur demand graph h defin partit ffv admiss subpartit valu 3 maximum g h 3 hand three hadmiss edgedisjoint path g name p 1 henc valu primal dual optima 3 easili check system path optim solut bad thing two node v 1 v 4 endnod one odd number path therefor hope obtain path first determin optim even vector 0 intersect two polymatroid question find hadmiss path node 2 endnod 0 furthermor one must insist even 0 sinc lock theorem true vector incident vector 0 2 2 2 0 optim element polymatroid intersect fa g bipartit satisfi 42 vector aris proof 2 2 2 2 theorem 23 appli obtain famili f four path name among path p 4 nonhadmiss obtain optim solut maxim problem though direct approach maxim problem prove success led us follow problem consid sake e graph z demand function nodedemand problem consist find system hadmiss path termin endnod precis mt path call problem also vector feasibl solut exist nodedemand problem call eulerian inner eulerian mtdt even 2 call demand graph h twocov onecov everi node 2 belong two exactli one maxim stabl set h note bistabl graph alway twocov 5element circuit exampl twocov bistabl shown graph h twocov h complement line graph trianglefre graph theorem 61 suppos nodedemand problem defin g hm eulerian h two cover feasibl follow condit hold everi stabl h proof sinc stabl h solut nodedemand problem path endnod endnod gamma among ms path mx may end x gamma henc least ms must end outsid x 61 follow prove suffici first observ famili l maxim stabl set h 3crossfre inde contradict let stabl set h pairwis cross sinc h 2 distinct element stabl maxim stabl set containa b c distinct element b c well would belong two maxim stabl set contradict h twocov stabl set h proof recal defin maximum number edgedisjoint path connect x 2 endnod mx ot version menger theorem appli edgedisjoint undirect version menger theorem graph aris g ad two new node respect connect node x resp gamma mx new parallel edg x denot set minimum attain 61 claim follow ffl appli theorem 23 g ml consid path system f provid theorem l collect maxim stabl set h solut node demand problem proof let element l maxim stabl set h sinc f lock f contain connect gamma show node x endnod precis mx member f path f endnod must endnod everi node x h belong maxim stabl set h x endnod precis mx member f moreov sinc everi pair nonadjac node x h belong maxim stabl set h path f may connect x f consist hfeasibl path ffl ffl remark condit theorem 62 may formul equival form take 61 see 61 impli everi maxim stabl set z h convers claim 61 follow 61 inde let z maxim stabl set h includ ms mx z 61 follow 61 advantag maxim stabl set twocov graph 2jt j hand proof slightli easier work 61 r solut problem multicommod flow network combinatori method solv cutdetermin multiflow problem finit infinit set multicommod flow problem integervalu optim solut class maximum multicommod flow integervalu optim solut system flow undirect network mathemat program complet descript class cutnondetermin maximum multicommod flow problem combinatori approach multiflow problem combinatori approach multiflow problem connect properti eulerian graph ganzzahlig polymatroid intersect algorithmen tr ctr michael lomonosov return path pack european journal combinator v25 n1 p3553 januari 2004