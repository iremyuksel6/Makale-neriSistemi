multivari local adapt densiti estim multivari version variabl bandwidth kernel densiti estim lead improv kernel densiti estim use global bandwidth choic estim flexibl better abl model complex multimod densiti work two variabl bandwidth estim discuss balloon estim vari smooth matrix estim point sampl point estim use differ smooth matrix data point bin version sampl point estim develop variou situat low moder dimens exhibit less error mise fix bandwidth estim balloon estim practic implement sampl point estim shown simul exampl better job reconstruct featur underli densiti fix bandwidth estim comput detail includ parameter smooth matrix discuss throughout b introduct kernel densiti estim becom stapl data analysi tool box larg flexibl gener method much research done theoret properti kernel estim superior naiv estim histogram wellestablish crossvalid rudemo 1982 bowman 1984 plugin sheather jone 1991 rule choos smooth paramet data driven automat bandwidth select achiev certain level matur rule choos bandwidth gener base rel simpl import idea balanc bia varianc global idea work well regular densiti ie densiti unimod extrem skew consid multivari kernel densiti estim given n dvariat random sampl densiti f kernel k taken dvariat densiti function contour kernel restrict spheric symmetr smooth paramet h control size kernel straightforward asymptot approxim yield integr squar bia isb integr varianc iv equal nh z r k 2 wdw tr indic trace matrix 5 2 fx hessian matrix second partial deriv f combin term yield estim mean integr squar error dx optim bandwidth easili deriv equal oe 4 choic h yield univari standard normal distribut global optim smooth paramet sampl size 0421 valu reflect best tradeoff varianc bia densiti sampl size interestingli optim smooth paramet region near mode gamma1 1 slightli smaller global bandwidth either tail 11 11 optim bandwidth larger reflect spars data attempt control higher variabl tail ultim global bandwidth closer bandwidth optim mode largest contribut error come area near mode effect tail substanti enough greatli influenc global bandwidth dimension increas howev socal curs dimension becom influenti effect multivari densiti estim well note friedman stue zle 1981 scott wand 1991 due spars data higher dimens multivari neighborhood gener empti particularli tail densiti exercis 41 wand jone 1995 furthermor less probabl mass near mode effect slow converg rate mise dimension increas rel contribut varianc bia chang univari set ratio bia varianc 41 gener dimens ratio 4d henc dimens increas larger larger bandwidth necessari control increas variabl particularli contribut tail howev also advers effect averag away featur near mode sain scott 1996 give anoth exampl tradeoff varianc bia fail consid bimod normal mixtur form 14oe 13 normal densiti mean varianc oe 2 mixtur characterist densiti difficult kernel estim mode equal height differ scale global optim smooth paramet sampl size 0248 consid sampl size associ mode optim smooth paramet global valu reflect attempt find sort middl ground optim mode howev valu h undersmooth oversmooth depend mode analyst face difficult decis choos featur real nois graphic idea propos minnott scott 1993 chaudhuri marron 1997 proven effect aid explor structur univari multimod densiti approach use famili kernel estim bandwidth allow rang small larg method attract allow user chang resolut focus larg bandwidth gain insight gener structur smaller bandwidth finer detail howev serv emphas lesson singl smooth paramet ineffect complex densiti propos vari amount smooth fashion intuit task seem straightforward smooth necessari data scarc ie tail valley less smooth necessari near mode howev easi model bandwidth function level underli densiti alon attempt account curvatur must made well sain scott 1996 actual proven difficult gain understand exactli vari bandwidth appli understand vari bandwidth practic particularli multivari case paper variabl bandwidth estim studi multivari set build work terrel scott 1992 sain scott 1996 follow brief introduct issu involv gener fix bandwidth multivari kernel estim section 2 comparison two common approach variabl bandwidth estim present section 3 4 final brief discuss issu problem variabl bandwidth estim practic present section 5 fix bandwidth estim gener multivari kernel densiti estim given kh gamma12 unlik 1 smooth paramet h actual symmetr posit definit matrix analog covari matrix k henc kh straightforward asymptot analysi involv multivari taylor seri expans yield estim mise follow scott 1992 wand jone 1995 asymptot approxim mise given z indic determin matrix choos form h depend complex underli densiti number paramet must estim wand jone 1993 give excel discuss issu bivari case three primari class parameter smooth matrix assum k multivari normal kernel ie x2 first class introduc 1 kernel contour restrict spheric symmetr one independ smooth paramet keep notat wand jone 1993 class denot h 1 h second class h 2 allow kernel ellipsoid howev axe restrict parallel coordin axi independ smooth paramet allow diag indic diagon matrix class commonli refer product kernel estim allow differ amount smooth dimens optim bandwidth h still proport n gamma1d4 amis order h 1 howev gain obtain use differ smooth paramet dimens especi scale variabl differ final class full smooth matrix employ involv dd independ smooth paramet denot h 3 class allow ellipsoid kernel arbitrari orient given unfortun close form express optim smooth matrix case numer method requir find h candid densiti particular sampl size underli densiti spheric symmetr contour standard mal optim smooth matrix class ie proport ident matrix howev interest exercis compar smooth parameter case order evalu gain term amis well develop understand smooth matrix adapt shape densiti class consid case bivari normal densiti center origin oe 06 sampl size case optim bandwidth matric class given 10 00 00 10 05 00 00 20 0625 075 075 25 smooth matric h 1 h 2 h 3 respect standard normal kernel note smooth matric written form h control size kernel control orient see scott 1992 restrict case singl smooth paramet yield smaller kernel tri adjust structur densiti eg differ scale correl h 2 h 3 correctli adjust scale squar smooth paramet four time larger second dimens unrestrict kernel h 3 largest area suggest tradeoff flexibl model orient scale densiti size kernel unrestrict product kernel estim yield amis valu 30 16 smaller use one smooth paramet practic common approach scale data sampl varianc dimens sphere data linear transform appli yield ident sampl covari matrix approach essenti dimens reduct idea allow use singl smooth paramet transform data howev wand jone 1993 urg caution use approach guarante give correct transform rotat achiev gain possibl use full smooth matrix mani author note densiti particular unimod one allow differ amount smooth dimens product kernel estim adequ complex densiti especi multimod one situat less clear although rotat help structur distribut align coordin axi wand jone 1993 3 local adapt densiti estim conceiv consid bandwidth function adapt point estim also observ data point shape underli densiti matter practic howev two simplifi version studi first vari bandwidth estim point refer balloon estim second vari bandwidth data point refer samplepoint estim see jone 1990 detail comparison two estim univari case 31 balloon estim gener form balloon estim given hx smooth matrix estim point x consid pointwis construct estim fix bandwidth estim given 2 point densiti estim kernel size orient center data point densiti estim comput take averag height kernel estim point type estim introduc loftsgaarden quesenberri 1965 kth nearest neighbor estim gener consid kernel estim directli written 4 take k uniform densiti unit sphere restrict smooth matrix h 1 thu bandwidth function written measur distanc x kth nearest data point much written kth nearest neighbor estim seem clear effect densiti estim univari case bandwidth function discontinu discontinu manifest directli densiti estim silverman 1986 furthermor estim suffer sever bia problem particularli tail mack rosenblatt 1979 hall 1983 terrel scott 1992 howev terrel scott 1992 show kth nearest neighbor estim improv dimension increas perform well dimens greater 4 terrel scott 1992 also studi error properti gener balloon estim found remark result appli pointwis balloon estim behav like fix bandwidth estim author show choos orient smooth matrix appropri bia dramat reduc fact bia higherord follow import result terrel scott 1992 outlin extens shown paper allow comparison sampl point estim consid use 4 pointwis 1 notat conv nienc argument h drop follow h control size kernel orient asymptot approxim bia written x matrix second partial deriv underli densiti terrel scott 1992 look three case base form x demonstr consid f bivari standard normal densiti k bivari standard normal kernel first x assum posit neg definit choic make asymptot bia equal zero best possibl asymptot mean squar error gamma4d4 order fix bandwidth estim exampl case correspond point insid unit ball chosen minim bia solut aa x given form h comput minim result pointwis ams result second case correspond densiti saddl shape eigenvalu x posit neg case shown properli choos lead bia made zero exampl correspond point outsid unit ball jjxjj 1 choos form absolut valu eigenvalu x matrix eigenvector x chosen find fashion h chosen minim ams determin ams result valu h fourth order term taylor seri expans expect bia must consid expect given kh z z z ijth element f repres ith partial deriv f respect x assumpt kernel proper choic expect reduc f ijkl z z yield bia oh 4 write bia cf k constant depend mix fourthord partial deriv f evalu x mix fourthord moment k combin bia asymptot express varianc pointwis mse point outsid unit ball given take partial deriv respect h set zero solv h give third case correspond x posit neg semidefinit eigenvalu equal zero henc hessian lower rank bia higher order proper choic correspond point exampl unit circl unfortun close form express mise comput express optim pointwis smooth matric howev terrel scott 1992 point asymptot mse numer integr studi behavior balloon estim 32 samplepoint estim multivari samplepoint estim given hx smooth matrix associ x samplepoint estim still place kernel data point kernel size orient regardless densiti estim type estim introduc breiman meisel purcel 1977 suggest use hx distanc x kth nearest data point asymptot equival choos hx dimens data abramson 1982ab suggest squareroot law ie set practic use pilot estim densiti calibr bandwidth function formul bandwidth function popular small part due earli result show bia associ squareroot law higher order silverman 1986 hall marron 1988 jone 1990 howev recent work shown earli result may alway hold due bia contribut tail hall 1992 mckay 1993 terrel scott 1992 hall hu marron 1994 sain scott 1996 squareroot law suffer bia properti diminish gain vari bandwidth asymptot also suffer certain inflex restrict bandwidth function function height densiti sain scott introduc bin version samplepoint estim use piecewis constant bandwidth function attempt provid gener studi properti estim work author show estim exhibit higherord mise lead substanti improv fix bandwidth estim univari case multivari version bin samplepoint estim given number data point jth bin j center jth bin smooth matrix associ jth bin gener equal space mesh point laid support densiti defin bin although bin rule linear bin defin hall wand 1996 could consid bin use densiti estim varieti reason hall 1982 studi round truncat data silverman 1982 hardl scott 1992 wand 1994 hall wand 1996 use bin devic radic reduc comput time scott sheather 1985 build result hall 1982 show bin result inflat bia mise insensit reason amount bin adapt estim bin becom much comput tool comput bia adapt estim difficult imposs without specifi form bandwidth function done squar root law bin expect estim 6 easi comput note random quantiti n count thought realiz multinomi distribut paramet r denot jth bin assum k multivari normal kernel follow sain scott 1996 mise multivari binnedsampl point estim given z z z gamman z z note normal integr follow directli formula present appendic wand jone 1995 specifi f usual sort normal mixtur probabl comput mise function optim collect smooth matric h 4 comparison variabl bandwidth method compar optim bandwidth function balloon samplepoint estim difficult task especi multivari set howev develop understand optim smooth paramet behav yield insight particularli design practic algorithm would seem reason sort fundament relationship two method least asymptot sain scott 1996 notic similar samplepoint estim socal zerobia bandwidth discuss hazelton 1996 sain scott 1997 devroy 1998 howev finit multivari sampl differ appear illustr let f bivari standard normal let k also standard normal figur 1 display optim kernel fix bandwidth estim balloon estim bin samplepoint estim use equal space mesh 9 bin per dimens two version samplepoint estim consid one restrict contour kernel circular h 1 second allow unrestrict size orient h 3 optim kernel comput use formula techniqu discuss previou section four case consid correspond bin center origin along xaxi 09 18 27 correspond mesh samplepoint estim laid squar defin gamma3 3 sinc contour densiti radial symmetr follow contour optim kernel center differ bin distanc origin behav similarli figur 1 optim kernel fix bandwidth estim solid line balloon estim dot line samplepoint estim smooth matrix restrict h 1 short dash line samplepoint estim unrestrict smooth matrix long dash line ellips 95 contour kernel optim kernel fix bandwidth estim contour circular regardless densiti estim data point parameter smooth matrix use 95 contour kernel plot figur 1 solid line center origin refer indic scale variabl bandwidth kernel examin optim kernel balloon estim samplepoint estim import keep mind construct estim balloon estim plot kernel center estim point densiti construct center kernel data point binnedsampl point estim densiti estim place weight kernel center bin bin differ size orient practic kernel assum data point bin first consid kernel origin jjxjj 00 figur 1 kernel circular surpris consid structur densiti origin howev variabl bandwidth kernel smaller fix bandwidth kernel next plot 09 center bin still within unit circl fix bandwidth kernel still much larger samplepoint kernel still roughli circular balloon estim kernel alreadi adjust local curvatur major axi ellips parallel line origin center bin third plot show kernel bin outsid unit circl variabl bandwidth kernel much larger fix bandwidth kernel howev distinct chang orient note balloon kernel unrestrict samplepoint kernel recal balloon kernel higherord bia region base fourthord deriv densiti henc orient chang major axi ellips perpendicular line origin center bin major axi unrestrict kernel retain lowerord bia behavior major axi kernel parallel origin move even tail densiti 27 variabl bandwidth kernel dwarf fix bandwidth kernel restrict samplepoint kernel except larg phenomenon explain samplepoint estim restrict kernel attempt minim variabl tail trade much larger size correct orient note kernel samplepoint estim much larger balloon estim kernel bin samplepoint estim allow headtohead comparison gener samplepoint estim fix bandwidth estim balloon estim actual bin samplepoint estim entir gener smooth matrix assum constant data point particular bin howev optim smooth matric allow adapt level curvatur someth squareroot law accomplish estim bin per dimens fix tabl 1 mise valu fix samplepoint adapt method use normal kernel h 1 n0 densiti sampl size scott sheather 1985 hall wand 1996 show bin inflat bia sain scott 1996 show bin samplepoint estim need enough bin counteract bia give suffici flexibl improv fix bandwidth estim true multivari case fact tabl 1 show bin per dimens may need achiev gain tabl 1 base multivari standard normal densiti 100 fix bandwidth method mise comput use express deriv worton 1989 marron wand 1992 kernel bin samplepoint estim restrict spheric simplic equal space mesh laid approxim support densiti assum 33 dimens consist clear tabl 1 consider gain term mise achiev rel small number bin per dimens restrict shape kernel use 5 bin actual wors fix bandwidth estim howev use 5 bin per dimens 125 total bin abl achiev gain fix bandwidth estim use bin achiev 44 gain mise suggest may necessari use bin per dimens use gener smooth matric bin tabl 2 mise valu also comput bivari standard normal howev samplepoint estim includ allow unrestrict smooth matric consider gain term mise realiz restrict kernel remov restrict kernel samplepoint estim bin lead 29 improv mise unrestrict smooth matric lead 51 reduct mise fix balloon tabl 2 mise valu fix samplepoint balloon estim use normal kernel n0 2 samplepoint estim bin samplepoint estim also allow direct comparison balloon estim case unrestrict samplepoint estim actual give slight improv balloon estim impli samplepoint estim better job even near mode place estim actual compet balloon estim higher order tail result also suggest small sampl curios improv also achiev moder sampl size n 1000 howev larger result like chang impact tail balloon estim higher order becom pronounc vari bandwidth aid combat curs dimension real power samplepoint estim may lie abil model complex multimod distribut consid normal mixtur densiti label k wand jone 1993 bivari trimod densiti compris three normal compon paramet p3 p3 contour mixtur shown left frame figur 2 densiti pose problem fix bandwidth kernel even unrestrict orient covari structur entir densiti far ident mode howev vari height differ covari structur tabl 3 show comparison mise fix kernel estim smooth estim mise fix tabl 3 mise valu fix samplepoint estim use normal kernel trimod normal mixtur sampl size matrix h 1 unrestrict smooth matrix h 3 sampl point estim bin per dimens also consid two smooth matrix struc ture result two parameter fix bandwidth estim terribl differ slight improv go unrestrict smooth matrix howev allow kernel vari lead signific reduct mise even allow size kernel vari give signific gain restrict samplepoint estim give 35 reduct mise contour optim bandwidth function shown right frame figur 2 rough contour due interpol piecewis constant bandwidth function howev clear contour size kernel mirror shape densiti difficult discern plot howev kernel adapt simpli base height alon curvatur also taken account kernel near left mode first compon mixtur much smaller near top right mode second compon mixtur despit similar height mode final unrestrict samplepoint estim yield even promis result mise 62 smaller unrestrict fix estim 5 practic algorithm previou section show vari bandwidth fashion lead substanti theoret gain design practic databas algorithm realiz gain practic difficult task mani thing consid univari case least estim bandwidth function parameter figur 2 contour normal mixtur distribut left frame contour optim bandwidth function right frame bin samplepoint estim kernel exampl balloon estim attract varieti reason tremend potenti good pointwis estim densiti tail requir ever orient balloon kernel lead higherord bia requir knowledg fourth order deriv pilot estim could use calibr kernel suggest terrel scott 1992 estim fourthord deriv gener perceiv harder estim densiti gain adapt would overwhelm error estim deriv samplepoint estim current asymptot approxim mise would allow plugin style bandwidth selector due part tradit asymptot approxim inabl model behavior optim bandwidth function sain scott 1996 howev leastsquar crossvalid offer method unbias estim mise reli asymptot approxim also shown sain scott 1996 perform well univari set estim optim bandwidth function henc use test case illustr difficulti may encount leastsquar crossvalid also refer unbias crossvalid ucv introduc rudemo 1982 bowman 1984 approxim integr squar error averag criterion equal mise henc term unbias crossvalid set ucv function given note fulli bin version ucv actual data use estim crossproduct express mise bin count comput criterion minim space smooth matric illustr consid lipid data scott et al 1978 data consist measur cholesterol triglycerid 320 men diagnos coronari arteri diseas origin paper show data bimod indic increas risk heart diseas associ increas cholesterol level studi data reveal potenti third mode figur 3 show scatterplot data mesh use bin data sampl point estim shown dot line 11theta11 mesh use bin data indic plot note data scale zero mean unit varianc dimens figur 4 show perspect contour plot fix bandwidth estim use smooth matrix h 1 smooth paramet select crossvalid estim show evid two distinct mode third mode margin also consider amount nois exhibit spuriou mode tail figur 3 scatterplot cholesterol triglycerid level male heart diseas grid indic mesh use samplepoint estim data scale zero mean unit varianc dimens 22 22 figur 4 perspect contour plot fix bandwidth h 1 estim lipid data bandwidth samplepoint estim smooth matric restrict shown figur 5 observ pattern consist intuit larger bandwidth tail smaller near mode estim shown figur 6 initi appear oversmooth howev mode actual pronounc higher three clear mode adapt estim also littl evid spuriou mode tail distribut result estim achiev goal adapt procedur name correctli emphas featur height posit mode minim nois spuriou mode figur 7 show samplepoint estim use unrestrict kernel h 3 chosen ucv unfortun estim reflect promis mise result previou section estim quit rough mani spuriou mode determin caus consid examin estim kernel kernel near mode shown figur 8 sourc difficulti found mani appear close degener seem wildli vari orient may artifact wellestablish aggress behavior crossvalid yield highli variabl bandwidth often much smaller optim unfortun mani paramet estim case 48theta3144 moder sampl size clearli attempt estim fulli parameter smooth matric requir much data stabl procedur one way reduc dimension problem base notion fix bandwidth procedur adequ unimod distribut henc pilot estim could use calibr bandwidth function use bandwidth data point near sampl mode exampl shown figur 9 fix bandwidth estim figur 4 use partit data 16 sampl mode estim data point assign nearest mode mode assign separ smooth paramet effect defin piecewis constant bandwidth function mesh equal space figur 9 show estim bandwidth use restrict smooth matric h 1 behavior expect smaller bandwidth near domin mode larger bandwidth tail estim use bandwidth plot figur 259 186 218 173 07 08 155 209 209 202 figur 5 estim bandwidth restrict samplepoint estim 22 figur perspect contour plot samplepoint estim h 1 lipid data figur 7 perspect contour plot estim densiti use fulli parameter bandwidth matrix h 3 22 figur 8 estim kernel fulli parameter bandwidth matrix 1378 222103480433295623431901 figur 9 left plot mode partit calibr smooth matrix right plot estim bandwidth base partit 22 figur 10 perspect contour plot estim densiti use bandwidth function calibr pilot estim show two mode clearli third mode appar variabl tail also diminish good samplepoint estim shown figur 6 estim still improv fix bandwidth estim particularli tail number spuriou mode reduc one interpret result improv gain use restrict bandwidth function put adapt may need tail 6 conclus two primari point made work first local adapt densiti estim allow smooth vari fashion lead substanti gain fix bandwidth densiti estim extent combat curs dimension result even promis underli densiti complex exhibit multipl mode differ scale orient second possibl achiev gain practic necessarili easi overparameter smooth matric concern work certainli requir understand complex theori behind local adapt method connect mixtur model work certainli requir build practic algorithm leastsquar crossvalid hold lot promis certainli problem well research blur line parametr nonparametr densiti es timat propos certainli inspir kernel estim motiv desir learn variabl bandwidth kernel estim applic higher dimens kernel estim alreadi possess great flexibl local adapt kernel estim add significantli alreadi rich class concern kernel necessarili local howev addit assumpt underli densiti propos also flavor mixtur model inspir desir parametr model data appear gener sever subpopula tion mixtur model surpris abil model distribut whose compon necessarili parametr famili compon mixtur see sain et al 1998 exampl practic among other work also explor connect kernel mixtur exampl prieb 1994 marchett et al 1996 final much work done requir sort numer optim optim done splu use function nlminb statist scienc 1995 base subroutin port mathemat subroutin librari att bell laboratori 1984 case gradient also comput use optim expect optim criteria time cpu intens point make procedur unattract case realtim estim r bandwidth variat kernel estim squar root law arbitrari pilot estim adapt kernel method altern method crossvalid smooth densiti estim variabl kernel estim multivari densiti sizer explor structur curv variabl kernel estim imposs tune paramet project pursuit regress influenc round error nonparametr estim densiti deriv near neighbor estim multivari densiti global properti variabl bandwidth densiti estim accuraci bin kernel densiti estim improv variabl window kernel estim probabl densiti smooth weight averag round point bandwidth select local densiti estim variabl kernel densiti estim variabl kernel densiti estim nonparametr estim multivari densiti function note bia reduct variabl kernel densiti estim multivari knearest neighbor densiti esti mate filter kernel densiti estim exact mean integr squar mode tree tool visual nonparametr densiti featur adapt mixtur empir choic histogram kernel densiti estim outlier detect mixtur distribut train data unlabel local adapt densiti estim zerobia local adapt densiti estim multivari densiti estim theori plasma lipid collater risk factor coronari heart diseas studi 371 male chest pain feasibl multivari densiti estim reliabl databas bandwidth select method kernel densiti estim kernel densiti estim use fast fourier transform densiti estim statist data analysi splu guid statist mathemat analysi variabl kernel densiti estim fast comput multivari kernel estim comparison smooth parameter bivari kernel densiti estim kernel smooth optim smooth paramet multivari fix adapt kernel method tr accuraci bin kernel densiti estim ctr ander adamson marc alexa anisotrop point set surfac proceed 4th intern confer comput graphic virtual realiti visualis interact africa januari 2527 2006 cape town south africa yaser sheikh mubarak shah bayesian model dynam scene object detect ieee transact pattern analysi machin intellig v27 n11 p17781792 novemb 2005