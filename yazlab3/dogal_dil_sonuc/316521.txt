modifi spars choleski factor given spars symmetr posit definit matrix bf aasf associ spars choleski factor bf ldlsf bf llsf develop spars techniqu obtain new factor associ either ad column bf delet column bf techniqu base analysi manipul underli graph structur idea gill et al math comp 28 1974 pp 505535 modifi dens choleski factor show method extend gener case arbitrari spars symmetr posit definit matrix modifi method optim sens take time proport number nonzero entri bf l bf chang b introduct paper present method updat downdat spars choleski factor matrix aa n precis evalu choleski factor aa either oe 1 correspond updat w arbitrari oe gamma1 correspond downdat w column aa aa must symmetr posit definit techniqu develop matrix aa extend determin effect choleski factor gener symmetr posit definit matrix symmetr chang form preserv posit definit method optim sens take time proport number nonzero entri l chang mani applic techniqu present paper linear program dual activ set algorithm lp dasa 19 matrix correspond basic variabl current basi linear program success iter bring variabl basi lead chang form aa applic area techniqu develop paper applic includ leastsquar problem statist analysi electr circuit structur mechan sensit analysi linear program boundari condit chang partial differenti equat domain decomposit method boundari element method discuss applic area other see 18 section 2 introduc notat introduct spars matrix techniqu see 4 8 x3 discuss structur nonzero element choleski factor aa x4 discuss structur associ choleski factor aa symbol updat downdat method provid framework spars version method c5 gill golub murray saunder 15 modifi dens choleski factor discuss spars algorithm x5 section 6 present gener algorithm modifi spars choleski factor spars symmetr posit definit matrix implement detail modif algorithm associ aa summar x7 result numer experi larg optim problem netlib 3 present x8 section 9 conclud discuss futur work notat throughout paper matric capit bold letter like l vector lower case bold letter like x v set multiset calligraph style like l p scalar either lower case greek letter ital style like oe k given locat nonzero element aa perform symbol factor terminolog introduc georg liu 8 matrix predict locat nonzero element choleski factor l actual predict nonzero may zero due numer cancel factor process statement l ij 6 0 mean l ij symbol nonzero diagon l alway nonzero sinc matric factor posit definit see 24 p 253 nonzero pattern column j l denot l denot collect pattern similarli j denot nonzero pattern column j collect pattern elimin tree defin term parent map see 20 give row index associ given node j first nonzero element column j l beneath diagon element denot smallest element convent min empti set zero note j j except case diagon element column j nonzero element parent map children multifunct children node k set defin ancestor node j denot pj set success parent power map defin usual way 0 ident ifold composit sequenc node j j form pk call path j associ tree root collect path lead root form elimin tree set tree elimin forest typic singl tree whose root howev column j aa one nonzero element diagon element j root separ tree number element size set x denot jx j jaj jlj denot sum size set contain defin direct graph gm matrix nonzero pattern vertex edg set vertex set direct edg set 3 symbol factor approach gener pattern set l call 23 symbol factor matrix form aa given algorithm 1 see 9 20 algorithm 1 symbol factor aa min k j ka end algorithm 1 basic say pattern column j l express union pattern column l whose parent j pattern column whose first nonzero element j elimin tree connect child parent easili form symbol factor algorithm 1 done ojlj 1 asymptot complex notat defin 2 write exist posit constant c n 0 0 fn cgn n n 0 observ pattern parent node j contain entri pattern column j except j 22 proceed induct k ancestor j lead follow relat l j path pj first part proposit proof given 22 proof differ slightli one 22 includ sinc proof techniqu exploit later proposit 31 j l j pj furthermor k j 2 proof obvious given element l j 6 j sinc see follow relat hold suppos 2 hold integ l 0 let k denot l j 1 fact k impli henc either 2 hold l replac l 1 sinc 2 violat l suffici larg conclud exist l consequ element l j contain pj ancestor k pj pk sinc alreadi shown l j pj proof complet see symbol factor aa obtain updat symbol factor aa use algorithm structur algorithm 1 new pattern l j equal old pattern l j union entri aris new children pattern new column put bar matrix set multiset denot valu updat downdat complet downdat easi set union comput undon without knowledg entri enter set keep track inform store element l multiset rather set multiset associ column j form multipl mi j number children j contain row index pattern plu number column whose smallest entri j contain row index equival definit undo set union subtract multipl defin oper involv multiset first x multiset consist pair mi mi multipl associ x set obtain remov multipl word multiset x associ base set x satisfi relat defin addit multiset x set follow way similarli subtract set multiset x defin multiset subtract x undo prior addit multiset x set contrast x n equal x x disjoint set algorithm 2 perform symbol factor aa set union oper replac multiset addit algorithm ident algorithm 1 except bookkeep associ multipl algorithm 2 symbol factor aa use multiset c 2 gamma1 j end k min end end conclud section result concern relat pattern aa pattern aa ww proposit 32 let c pattern associ symmetr posit definit matric c respect neglect numer cancel c j j j impli l c j l c ld pattern associ choleski factor c respect proof 8 21 shown edg j contain graph choleski factor symmetr posit definit matrix c path j graph c intermedi vertex path 1 min fi jg c j j j path associ graph c subset path associ graph follow l c j ignor numer cancel edg graph aa subset edg graph aa ww proposit 32 conclud edg graph associ choleski factor satisfi inclus result column vector w use updat aa ww chosen column fix matrix b fillreduc permut p found choleski factor pbb p spars 1 exampl proposit 32 choleski factor paa p paa ww p least spars pbb p 4 modifi symbol factor let modifi version put bar matrix set multiset denot valu updat downdat complet updat obtain append column w right downdat obtain delet column w henc oe either 1 w last column updat oe gamma1 w column downdat sinc differ singl column follow proposit 32 l j l j j updat l j l j downdat moreov multiset associ choleski factor either updat downdat matrix structur describ follow theorem theorem 41 let k index associ first nonzero compon w updat pk pk l complement pk l except k one new ancestor k downdat pk pk l l except k one old ancestor k proof begin let us consid updat show element pk member pk well clearli k lie pk pk proceed induct suppos 0 k need show complet induct pk induct step complet j1 l 6 l proposit 32 l l follow relat hold suppos 3 hold integ p 1 let q denot p l proposit 32 l 2 l l l l combin 3 follow 1 l 2 l q l definit parent henc either p1 hold p replac p 1 sinc 3 violat p suffici larg conclud exist integ p l follow pk induct step complet pk pk suppos l 2 pk c import recal k index first nonzero compon w vector appear updat observ l equal k sinc l 2 pk c k 2 pk proof l l induct depth defin l children child loop algorithm 2 skip either l l l l evalu sinc l 6 k pattern associ w ad l l henc l trivial assum p 0 l l whenev l 2 pk c dl p let us suppos induct assumpt sinc l 6 k pattern w ad l l consequ algorithm 2 execut l l complet induct step consid downdat part theorem rearrang downdat relat aa henc downdat think updat version consequ second part theorem follow directli first part 41 symbol updat algorithm present algorithm evalu new pattern l associ updat base theorem 41 set l j chang associ pk k index first nonzero compon w refer algorithm 2 set march path j evalu chang induc addit column order bookkeep four case consid case 1 start new path need add pattern w l case 2 c 2 pk case c child j new old elimin tree sinc pattern l c may differ l c need add differ l j sinc j uniqu child path pk one node c satisfi condit also note theorem 41 l henc node lead adjust l algorithm 2 case 3 case c child j new elimin tree old tree entir set l c ad l sinc includ l theorem 41 henc c 62 pk c equival c 2 pk sinc node path pk k one child path one node c satisfi condit lie path pk case 4 case c child j old elimin tree new tree set l c subtract l sinc previous ad l fact impli c 2 pk algorithm follow refer node c satisfi condit lost children case everi node c led adjust pattern locat path pk detail algorithm appear simpli march path k root make adjust enumer algorithm 3 symbol updat add new column w case 1 first node path j 6 0 case 2 c old child j possibl chang els case 3 c new child j lost child c place c lostchildqueu c case 4 consid lost child j c lostchildqueu j end time taken algorithm given follow lemma lemma 42 time execut algorithm 3 bound constant time number entri associ pattern node new path pk time ob proof algorithm 3 simpli march path pk make adjust j proceed node j take time proport jl j j plu time taken process children j node visit child c twice sinc fall one two four case enumer node c new child one node lost child anoth work proport jl c j jl c j account step c instead j time make adjust pattern bound constant time either jl j j jl j j sinc jl theorem 41 proof complet practic reduc execut time algorithm 3 skip node l current node j lost children child c fall case 2 l j updat skip execut time modifi algorithm one implement 42 symbol downdat algorithm let us consid remov column w let k index first nonzero entri w symbol downdat algorithm analog symbol updat algorithm role pk pk interchang accord theorem 41 instead ad entri l j subtract entri instead lost child queue new child queue instead walk path pk walk path pk pk algorithm 4 symbol downdat remov column w case 1 first node path j 6 0 case 2 c old child j possibl chang els case 3 c lost child j new child c place c newchildqueu c case 4 consid new child j c newchildqueu j end algorithm 4 similar algorithm 3 execut time obey follow estim lemma 43 time execut algorithm 4 bound constant time number entri associ pattern node old path pk time achiev practic speedup check whether l chang given node j 2 pk time taken modifi algorithm 4 5 numer factor add delet column updat downdat symbol factor order determin locat choleski factor either new nonzero entri nonzero entri zero know locat nonzero entri updat numer valu entri first consid case l dens draw idea 15 show method extend spars case 51 dens matric algorithm implement numer updat downdat base method c5 15 dens matric summar approach start write posit account assumpt aa aa posit definit sinc matric aa congruent sylvest law inertia see 24 number posit neg zero eigenvalu eigenvalu one multipl correspond eigenvector orthogon v 1 correspond eigenvector v sinc aa posit definit eigenvalu posit impli 1 combin 4 5 sequenc given rotat product denot g 1 chosen 1 e 1 vector everi entri zero except first entri matrix lower hessenberg structur second sequenc given rotat product denot g 2 chosen lower triangular matrix denot g follow form ffi fl vector comput algorithm 5 diagon element g given g element diagon algorithm 5 comput g dens case els find g 1 zero first entri v 1 end find g 2 combin obtain g end algorithm 5 algorithm 6 evalu new choleski factor form g explicitli 15 take advantag special structur g product comput column column move right left practic l overwritten l algorithm 6 comput 1 end end algorithm 6 observ 13 multipli elimin l store product ld diagon matrix compon ffi absorb fl adjust accordingli ffi algorithm 6 elimin exploit simplif numer result report x8 52 sparsiti pattern v spars case spars nonzero pattern crucial sinc element g satisfi j conclud column l associ nonzero compon v enter comput l nonzero pattern v found use follow lemma lemma 51 node reachabl given node k path direct graph gl coincid path pk proof pk singl element lemma hold proceed induct suppos lemma hold k jpkj j pk element induct hypothesi node reachabl k path direct graph gl coincid path pk node reachabl one step k consist element l k proposit 31 element l k contain path pk induct hypothesi node reachabl coincid pi pk node reachabl k consist fkg union node reachabl l k sinc node reachabl k contain pk hand p element l row p k column p1 k nonzero henc element pk reachabl k sinc node coincid node reachabl k path direct graph gl induct step complet theorem 52 symbol downdat aa w column nonzero pattern equal path pk old elimin tree l proof let 0g theorem 51 gilbert 10 11 14 state nonzero pattern v set node reachabl node w path direct graph gl algorithm 1 w l k henc element w reachabl k path length one node reachabl w subset node reachabl k convers sinc k 2 w node reachabl k subset node reachabl w combin inclus node reachabl k w lemma 51 node reachabl k coincid path pk corollari 53 symbol updat aa nonzero pattern equal path pk new elimin tree l k defin 6 proof sinc view l choleski factor downdat henc appli theorem 52 effect replac p p 53 spars matric dens algorithm present start section write specif let us consid case 7 correspond updat nonzero element lie along diagon intersect row 2 pk column j 2 pk k defin 6 essenc extract submatrix correspond row column appli algorithm 5 dens submatrix modifi submatrix l consist row column associ pk reinsert dens submatrix spars matrix l algebra level think process follow way p permut matrix properti column associ pk move first jpkj column multipl right matrix p diagon ident lower right corner dens upper left corner v element l 21 correspond element l ij l 2 pk c follow 2 l c note gener algorithm 6 columnori 8 multipli given rotat comput algorithm 5 obtain appli p left p right 9 obtain l neither l 12 l 22 modifi 7 correspond downdat discuss updat except pk replac pk role l j l j interchang summari spars updat downdat choleski factor accomplish first evalu nonzero entri contain path pk pk k defin 6 appli dens algorithm 5 vector symbol nonzero entri v updat entri l row column associ indic pk pk use algorithm 6 follow result indic algorithm 6 appli l 11 specif structur proposit 54 symbol downdat l 11 lower triangular matrix dens profil row 1 integ proof row column column l 11 correspond node path pk assum node relabel follow l 11 1 consequ l let p smallest index p proof complet corollari 55 symbol updat l 11 lower triangular matrix dens profil row 1 integ proof follow immedi proposit 54 replac pk pk consequ proposit 54 corollari 55 proposit 32 skip index algorithm 6 algorithm 6 appli spars l oppos dens submatrix indic j take valu pk l j respect downdat take valu pk l j respect updat 6 arbitrari symbol numer factor method develop comput modif choleski factor aa correspond addit delet column use determin effect choleski factor gener symmetr posit definit matrix symmetr chang form preserv posit definit briefli describ algorithm 1 6 modifi gener case let j denot nonzero pattern lower triangular part symbol factor 5 6 7 8 23 obtain replac union k term algorithm 1 set j chang l j algorithm 1 given lead chang algorithm 2 comput multipl multipl index l j becom loop involv k term algorithm 2 replac singl statement precis k min end entri remov ad symbol aa delet addit column numer cancel ignor numer cancel entri ignor howev way entri drop numer cancel taken account neither inclus may hold resolv problem use symbol modif scheme two step symbol updat phase new nonzero entri taken account follow separ downdat phase handl entri becom numer zero sinc modif step involv updat phase follow downdat phase attach section overbar quantiti associ updat underbar quantiti associ downdat let w nonzero pattern w name 0g first phase entri w symbol ad j j 2 w second symbol phase entri w symbol delet j 2 w practic need introduc drop toler replac equal 10 inequ gener matrix analogu theorem 41 follow theorem 61 ff first index ff 6 ff pff pff l 2 pff c fi first index fi 6 fi evalu modif symbol factor associ start first index ff ff 6 ff march path pff make chang l j second phase start first index fi 6 fi march path pfi make chang analogu algorithm 3 gener case differ start index ff addit set j n j pass jloop algorithm 7a symbol updat phase gener matrix case 1 first node path j 6 0 case 2 c old child j possibl chang els case 3 c new child j lost child c place c lostchildqueu c case 4 consid lost child j c lostchildqueu j end algorithm 7a similarli analogu algorithm 4 gener case differ start index fi subtract set j n j pass jloop algorithm 7b symbol downdat phase gener matrix case 1 first node path j 6 0 case 2 c old child j possibl chang els case 3 c lost child j new child c place c newchildqueu c case 4 consid new child j c newchildqueu j end algorithm 7b algorithm 5 6 complet unchang gener case appli complet algorithm 7b know locat new nonzero entri choleski factor process submatrix associ row column pk k index first nonzero element w form aa gotten either ad delet column assum numer cancel algorithm 7b skip add column sinc j similarli column remov algorithm 7a skip sinc j henc algorithm 7a follow algorithm 7b appli matrix form aa algorithm 7a take effect updat algorithm 7b take effect downdat thu approach present section arbitrari symmetr posit definit matrix gener earlier approach focu matric form aa 7 implement issu section discuss implement issu context updat downdat matrix form aa similar discuss appli gener symmetr posit definit matrix assum column matrix product aa chosen among column fix matrix b updat downdat algorithm use comput modif choleski factor correspond addit delet column choleski factor initi aa column ad delet often preced fill reduc permut p row column exampl could comput permut reduc fill bb sinc choleski factor aa least spars bb proposit 32 regardless column chosen column b base number nonzero column choleski factor bb could alloc static storag structur alway contain choleski factor aa hand could lead wast space number nonzero choleski factor aa far less number nonzero choleski factor bb altern could store choleski factor current aa smaller space realloc storag updat downdat base chang nonzero pattern time initi choleski factor aa given see 8 follow om 3 l dens updat downdat proce first find new symbol factor requir path pk updat pk downdat use algorithm 3 4 modifi skip constant time column j chang algorithm 5 6 appli column path lower triangular solv system algorithm 5 done time downdat ob updat 14 remaind algorithm 5 take time ojpkj downdat ojpkj updat spars form algorithm 6 discuss x53 comput product downdat ob updat sinc l j l j updat follow asymptot time entir downdat updat symbol numer equal asymptot time algorithm 6 much less om 2 algorithm 5 6 dens case 8 experiment result develop matlab code experi algorithm present paper includ algorithm x6 gener symmetr posit definit matrix section present result numer experi larg spars optim problem netlib 3 comput use experi model 170 ultrasparc equip 256mb memori matlab version 42c 81 experiment design select optim problem airlin schedul dfl001 constraint matrix b 6071by12230 35632 nonzero matrix bb 37923 nonzero strictli lower triangular part choleski factor lb 149 million nonzero fillminim permut pb row b describ requir 112 billion floatingpoint oper 115 second comput lp dual activ set algorithm requir matrix howev note earlier upper bound number nonzero occur execut lp dasa high level fillin lb result highli irregular nonzero pattern b basi matrix 0 correspond optim solut linear program problem 5446 column wrote set matlab script implement complet choleski updatedownd algorithm discuss x7 first found pb use 101 trial matlab column multipl minimum degre order algorithm colmmd 12 100 differ random permut row b took best permut found permut pb factor l 0 0 831 thousand nonzero took 481 million floatingpoint oper 51 second comput use matlab chol follow method use lp dasa ad gamma12 diagon ensur posit definit use permut pb entir experi initi symbol factor took 15 second algorithm 2 matrix factor requir lp dasa use matlab spars matrix data structur sinc matlab remov explicit zero chang nonzero pattern singl entri caus matlab make new copi entir matrix would defeat asymptot perform algorithm instead columnori data structur use l l l consist three array length jl b j array length contain indic first entri column array length hold number nonzero column column alloc column hold mani nonzero correspond column lb without realloc start optim basi 5446 column ad one column time basi includ 12230 column remov one time obtain optim basi total time work requir modifi factor 76598 second 615 billion float point oper divid 441 second bookkeep keep track basi set b 6051 second symbol updat downdat algorithm 3 4 c 21167 second solv 4977 second remaind algorithm 5 43962 second algorithm 6 algorithm 6 clearli domin modif algorithm symbol updat downdat took littl time even though algorithm 3 4 well suit implement matlab comparison use choleski factor solv linear system dens righthandsid b use column orient data structur l step took total 93418 second 677 billion float point oper solv take ojlj time note much higher time taken solv algorithm 5 v w spars time taken entir updatedownd comput would much smaller code written compil languag solv one system dens right hand side use factor optim basi take 553 second use columnori data structur 126 second use matlab spars matrix l 0215 second fortran 77 82 numer accuraci order measur error comput choleski factor evalu differ kaa comput choleski factor airlin schedul matrix x8 l 149 million nonzero impract comput product updat obtain quick accur estim kek 1 appli strategi present 16 see 17 p 139 symbol statement algorithm estim 1norm invers matrix use gradient accent approach comput local maximum follow problem l use multipl time follow algorithm copi data structur l matlab spars matrix algorithm 8 estim 1norm matrix e ae current estim kek end algorithm 8 improv accuraci 1norm estim use algorithm 8 three time second third trial differ start vector x use describ 16 observ algorithm 8 make use product matrix e vector featur import context spars matric sinc e contain term impract comput product practic multipli vector airlin schedul matrix x8 valu kek 1 initi step 6784 end 249 154theta10 gamma10 respect estim obtain use algorithm 8 ident three step hand time comput kek 1 initi step step 6784 1379 2795 second time three trial algorithm 8 87 147 second respect exclud time construct matlab spars matrix l method quit accur problem 6784 updat 6784 downdat 13568 chang 1norm e increas factor 618 figur 1 show estim valu kek 1 comput everi step use algorithm 8 1norm matrix aa increas 4580 initi 11070 iter 6784 return 4580 iter 13568 henc product comput choleski factor agre product aa 15 signific digit initi product agre 12 signific digit 13568 modif step norm estim algorithm figur 1 estim 1norm error choleski factor 83 altern permut method optim sens take time proport number nonzero entri l chang step howev optim respect fillin sinc assum singl initi permut subsequ permut fillreduc order bb might best order use basi matric simpl patholog exampl mbyn matrix b nonzero pattern column b uniqu pair integ set f1 2 mg case everi element bb nonzero nonzero pattern aa arbitrari matrix chang might advantag comput fillreduc order aa size factor grow larg refactor new permut would requir found fillreduc permut pa optim basi 0 best 101 trial colmmd result factor l 381 thousand nonzero requir 169 million float point oper comput significantli less number nonzero 831 thousand float point oper 481 million associ fill reduc permut bb also comput order aa step use colmmd comput number nonzero factor factor use permut although take 1 second comput order 12 symbol step nonzero l three differ permut figur 2 nonzero l use three differ permut factor 13 practic use 101 random trial step figur 2 depict nonzero count l three differ permut 13568 step fix permut pb result smooth curv start 831 thousand peak 149 million fix permut pa result number nonzero l start 381 thousand rise quickli leav figur step 1206 peak 74 million middl surpass pb step 267 use permut p comput step give errat line figur start 390 thousand peak 19 million middl result indic might advantag start fix permut pa use 267 step refactor permut p comput step 267 result new factor 463 thousand nonzero near center figur howev basi includ column b case pb permut use 9 summari present new method updat downdat factor spars symmetr posit definit matrix aa experiment result show method fast accur practic extens arbitrari spars symmetr posit definit matrix discuss mention addit extens work would use make use supernod form factor use relat compress pattern l 8 method use numer factor first basi matrix cours factor would copi simpl columnori data structur keep supernod form potenti reduc time taken symbol factor algorithm 2 symbol updat downdat algorithm 3 4 numer updat downdat dens matrix kernel could use algorithm 5 6 howev supernod would merg updat split downdat complic supernod form factor r approxim minimum degre order algorithm introduct algorithm distribut mathemat softwar via electron mail direct method spars matric yale spars matrix packag design user interfac spars matrix packag data structur spars qr lu factor predict structur spars matrix comput spars matric matlab design implement effici algorithm comput row column count spars choleski factor spars partial pivot time proport arithmet oper method modifi matrix factor activ set strategi lp dual activ set algorithm role elimin tree spars factor algorithm aspect vertex elimin graph new implement spars gaussian elimin effici solut spars system linear nonlinear equat new york tr ctr w hager dual activ set algorithm applic linear program comput optim applic v21 n3 p263275 march 2002 ove edlund softwar packag spars orthogon factor updat acm transact mathemat softwar tom v28 n4 p448482 decemb 2002 matin bergounioux karl kunisch primaldu strategi stateconstrain optim control problem comput optim applic v22 n2 p193224 juli 2002 frank dellaert michael kaess squar root sam simultan local map via squar root inform smooth intern journal robot research v25 n12 p11811203 decemb 2006 nichola gould jennif scott yifan hu numer evalu spars direct solver solut larg spars symmetr linear system equat acm transact mathemat softwar tom v33 n2 p10e june 2007 olga sorkin daniel cohenor dror ironi sivan toledo geometryawar base shape approxim ieee transact visual comput graphic v11 n2 p171180 march 2005