sequenti regular method simul mechan system mani close loop numer simul problem larg multibodi system often treat two separ stage forward dynam problem comput system acceler given forc function constraint ii numer integr problem advanc state time forward dynam problem algorithm given optim linear complex number bodi case system topolog contain mani close loopsbut interact two stage import use explicit time integr scheme propos sequenti regular method srm linear complex number bodi per time step even presenc mani close loop method also handl certain type constraint singular b introduct grow interest develop effici algorithm multibodi dynam simul increas size complex spacecraft robot system one motiv develop anoth physicallybas model comput graphic numer simul process institut appli mathemat depart comput scienc univers british aschercsubcca work author partial support nserc canada grant ogp0004306 institut appli mathemat univers british columbia vancouv bc canada v6t 1z2 new address program scientif comput comput math stanford univers durand 262 stanford ca 943054040 usa plinsccmstanfordedu typic treat two separ stage first stage consist forward dynam problem comput system acceler given variou constraint torqu forc function treestructur multibodi system algorithm propos optim complex n total number rigid bodi system see eg 10 13 18 6 21 also extend cope system small number close loop compar total number n link 10 18 system close loop n typic complex obtain use cutloop techniqu appear hard find algorithm chain larg number eg close loop second stage simul algorithm design address numer integr problem advanc state time obtain gener bodi posit veloc comput acceler explicit implicit time discret scheme gener use two stage usual treat separ situat specif treatment one affect global unifi view benefici eg 6 1 paper use global view simul process devis method requir oper per time step even presenc mani close loop specif propos use sequenti regular method srm 4 5 purpos combin explicit time integr scheme method produc iter get arbitrarili close solut discret differenti system also handl certain type constraint singular mathemat model constrain multibodi system yield differentialalgebra equat dae index 2 3 9 11 treestructur system ie close loop one formul model term minim set rel solut coordin obtain system ordinari differenti equat ode see eg 14 10 exist commerci softwar packag eg sdfast 1 util approach forward dynam algorithm complex interpret imbed ode dae given time elimin unknown local larger sparser system 6 work howev consid equat motion descriptor form see eg 9 14 formul nonminim redund set coordin yield often simpler albeit larger dae even treestructur case dae typic treat differenti constraint acceler level use one wellknown stabil techniqu see eg 2 3 forward dynam algorithm formul recal x2 follow 18 system close loop may consid compos treestructur system plu set loopclos constraint latter treat use srm techniqu method describ x3 prove number oper need per time step use explicit time discret scheme 1 sdfast trademark symbol dynam inc 561 bush street mountain view ca usa remain n method also handl certain type constraint singular final x4 demonstr algorithm two closedloop chain exampl algorithm optim comput complex treestructur problem 21 gener multibodi system consid ideal multibodi system consist rigid bodi point mass kinemat treestructur use redund world coordin p posit system ie describ posit orient individu bodi set feasibl posit correspond physic possibl geometr configur given holonom constraint differenti constraint respect time yield correspond constraint veloc acceler gp constraint jacobian matrix g 0 p eulerlagrang equat combin constraint equat acceler level 23 eulerlagrang equat form dae index 1 differenti variabl p v algebra variabl constraint posit level 21 veloc level defin invari manifold 25 wellknown simpli simul 25 numer may caus sever drift constraint manifold manifest mild instabl formul figur 21 exampl treestructur chain phenomenon prevent use stabil techniqu eg invari stabi lizat baumgart stabil project method 2 3 7 regular techniqu eg penalti sequenti regular method 17 19 12 15 16 4 5 20 numer integr paper assum stabil techniqu alreadi appli includ 25 concentr aspect solv system 22 algorithm treestructur problem consid case multibodi system kinemat tree structur 18 consid graph whose node correspond joint whose edg repres bodi system see eg figur 21 close loop graph consist tree tree one joint singl root everi joint uniqu father tree neighbor bodi path root introduc node 0 father root fix joint usual number 0 give one tree label node follow joint number 1 n label joint alway greater father bodi link number bodi connect father joint son joint number son exampl figur 21 joint father joint 7 two joint connect bodi 7 kind treestructur system mass matrix symmetr posit definit blockdiagn block symmetr posit definit constraint equat 23 bodi connect two joint k father k form see 18 assum full row rank k analyz mani articl see eg 10 13 18 21 recurs algorithm deriv obtain algorithm invert lefthand matrix 25b explain algorithm start termin joint ie one set obtain next consid equat joint j termin son k kson j father j son 29 hold substitut 210 yield kson j kson j system 211 form 28 recurs algorithm result algorithm step 1 climb tree toward root recurs repeatedli form f j 212 step 2 start root tree solv local system 211 u j climb tree recurs note step 1 replac origin problem n local problem 211 algorithm complex oper local one bodi climb tree work differ subtre done parallel well result forward dynam algorithm describ express v term p ode system must integr time note dimens u v p 3d 6n contrast treatment use minim coordin u v p may dimens small n howev save latter formul chiefli time advanc faster forward dynam algorithm small n forward dynam algorithm see 6 3 algorithm system mani close loop consid multibodi system loop problem seen treestructur system plu extra loopclos constraint form x k x j repres gener posit joint k j respect compon p repres number loop write 31 mthetan constant matrix full row rank closedloop case need invert matrix instead matrix 25b 0 block gaussian elimin give schur complement obtain use algorithm describ last section use usual techniqu invert result satisfactori small cf 18 problem larg number loop appear difficult extend algorithm cf 10 particular om algorithm invert schur complement avail also found discuss literatur perform method constraint jacobian matrix rank defici situat often happen closedloop chain exampl slidercrank problem 4 5 first exampl x4 sequenti regular method propos 4 5 provid possibl address two challeng 31 algorithm write eulerlagrang equat multibodi system loop constraint correspond tree structur 33c number row may larg assum g full rank assumpt gener true chain problem see exampl x4 alreadi algorithm treestructur problem ie system 33a 33b without 33c develop algorithm treestructur part problem keep structur 33a 33b 33c loopclos constraint one possibl penalti method penalti paramet howev well known use implicit integr scheme system like 34 sinc ffl small 34 stiff system therefor invert matrix like discret stepsiz h block diagon previou algorithm difficult appli 4 5 propos new sequenti regular method srm modif usual penalti method allow us use explicit scheme solv regular problem henc srm combin explicit time discret make possibl obtain algorithm problem mani loop appli srm problem 33 treat loopclos constraint obtain new algorithm given 0 appli stabil method eg baumgart stabil 7 first stage invari stabil 2 3 project method 2 first constraint 33c follow system must consid 36c becom even simpler algorithm suggest 5 gener multibodi system without singular 33 form form comput complex simpler form 36 sinc need invert block diagon matrix howev problem singular illcondit often appear closedloop chain form 310 recommend indic alreadi 5 x4 numer exampl show perform wors form 36 also indic 5 form 310 best choic ffl gener ch reason stabil explicit differ scheme h step size chosen differ scheme c constant depend eigenvalu matrix g g henc best choic ffl form chang time g gener depend time see exampl x4 ffl chosen quit larg henc srm iter need make explicit discret stabl whole time interv comput therefor still recommend form 36 sinc perform better shown x4 sinc best choic ffl form depend eigenvalu matrix dm constant constant matrix case mani chain problem includ exampl x4 best choic ffl often independ form 36 comparison usual stabil method addit advantag 36 never invert singular matrix even singular sinc g full rank assum summar algorithm consist appli explicit time discret scheme forward dynam algorithm underli treestructur system solv next discuss converg srm prove iter number method independ bodi count n henc per time step method algorithm even chain mani close loop 32 converg stabilizationsrm form want analyz converg iter procedur 312 method analysi base 5 differ appli srm part constraint ie loopclos constraint 31 problem consid may larg number unknown linear n indic 4 5 system 312 clearli singularli perturb ffl 1 start arbitrari 0 may therefor expect initi layer simplic converg analysi assum 4 5 assumpt 31 initi valu problem possibl obtain exact j 0 advanc 4 5 gener semiexplicit dae assumpt initi layer solut 312 lth deriv let us make assumpt bounded solut nbodi chain reason assum solut deriv bound linearli n case solut may bound independ n make correspond assumpt p v sinc regular nearbi problem origin system initi layer involv solut condit 313 let l 0 assumpt 32 solut p v 312 satisfi may depend n 312b 312c solv term ie write assum jacobian matrix respect p v satisfi also satisfi 314 314 316 impli repres maximum norm k gener posit constant independ n remark 31 give converg bound case assum note mass matrix posit definit blockdiagon closingloop constraint matrix blockspars exampl x4 see jacobian matrix g constraint 21 blockspars thu assum assumpt 33 matric g finit multipl ie number multipl independ n blockspars precis multipli matrix vector norm k product norm still k k posit number fact closingloop constraint matrix blockspars also block roworthogon concret one nonzero element column see eg 46 x4 combin properti thu obtain dm posit definit blockdiagon henc eigenvalu matrix dm union eigenvalu diagon block matrix thu eigenvalu posit independ n sinc size element diagon block dm independ n write lemma lemma 31 mass matrix closingloop constraint matrix properti eigenvalu matrix dm gamma1 posit independ n final assum follow perturb bound cf perturb index 11 correspond discuss 5 assumpt 34 let exist constant k independ n z solut 38 z satisfi perturb 38 although invert need oper see algorithm x2 oper involv perturb ffit believ bound k 318 independ n consid converg stabilizationsrm form 312 choos 0 0 0 let u drift equat initi condit u appli 321 use assumpt lemma 31 obtain u 321a yield compar 319 stabilizationsrm form need bound deriv appear 318 alreadi 321a obtain use condit 0 dm obtain 312b 312d 321b differenti 321b use obtain 312d w obtain 317 henc differenti 321a next impli thu use 318 obtain desir conclus subtract 312a 312b 38a 38b respect use 322 316 also differenti 312d conclud 1 first henc also estim 323 also hold 2 yield right hand side 321b offl 2 want get better estim differenti 321b obtain want show offl purpos must estim use condit 0 fact also exact 0 obtain henc differenti 324 obtain precis estim need use obtain differenti 312 applic 314 316 317 well estim obtain note thu previou estim allow conclus henc conclud repeat procedur final obtain theorem 31 let assumpt describ begin section hold solut stabilizationsrm form 312 0 follow error estim solut multibodi problem 33 remark 31 bound 314 assum p v may gener obtain jth deriv would j1 final yield follow error estim result obvious weaker 327 correspond weaker bounded assumpt 33 comput complex stabilizationsrm form consid algorithm 312 regular iter use algorithm describ x2 consid comput complex algorithm need studi number iter requir simpl show independ n given worst error estim 328 must choos ffl small enough srm iter reduc error viz differ solut 312 solut 33 least factor ff fix number iter independ n need reduc error given toler note though may grow n depend problem simul henc rang choic ffl ffl ff restrict depend n sinc time discret scheme explicit step size h must restrict absolut stabil requir satisfi appropri constant fl moder size number time step requir may therefor depend n cf 21 2 still number iter requir obtain given accuraci obvious remain independ n henc oper count per time step remain worst error estim 328 suppos fi given posit constant simplic let us appli rth order explicit differ scheme stabilizationsrm form sth iter worst combin error algorithm ffl see remark 31 tri roughli equat two sourc error set henc use 329 obtain rough upper bound number iter requir like aris also accuraci stabil consider remark 32 error estim 327 condit 329 weaken significantli read 0 arbitrari integ independ n case 330 replac 4 numer experi present coupl exampl demonstr algorithm propos analyz previou section first build system special kind nbodi chain see figur 21 includ two exampl use method describ 21 consid chain consist n bodi bodi model line segment length l j mass j uniform mass distribut choos cartesian coordin joint x j vector connect joint along link order describ posit p chain n 3d chain p j six compon 2d chain four compon label chain joint shown figur 21 explain x2 henc holonom constraint includ length condit connect condit father j therefor due uniform mass distribut center mass bodi coincid geometr center x moment inertia center mass total kinet energi given 3 figur 41 squar chain label let joint 0 fix potenti energi due graviti given ge e v unit vector along vertic axi 2d case e 3d case e note e height center mass bodi j zero level graviti constant give forc vector f b henc know mass matrix forc term f constraint g write system 25 kind treestructur chain problem chain loop need impos addit geometr constraint onto correspond treestructur formul see discuss begin x3 next consid two specif exampl exampl 41 consid 2d squar chain unit length mass link ie 1 label correspond tree structur shown figur 41 label henc write jacobian matrix gp treestructur constraint gp exampl gammai 2 theta 2 unit matrix extra loopclos constraint dp equal number squar thu form jacobian matrix exampl jacobian matrix gp constraint rank defici four link squar line let chain fall freeli posit shown figur 41 joint 0 fix mention srm iter algorithm 312 solv treestructur problem use algorithm x2 demonstr number srm iter independ n mean comput complex algorithm per time step choos step size regular paramet appli explicit secondord rungekutta method regular problem iter comput clearli see relat number iter n want avoid singular happen around whose error situat complic count number srm iter error constraint exhibit obviou improv tabl 41 list iter count constraint error variou n iter iter 3 3 3 3 3 3 3 tabl 41 relat number iter n squar chain theoret expect two srm iter suffici sinc differ scheme second order oh tabl see second third success iter maximum drift almost especi n 1h addit experi need two iter algorithm 312 achiev second order discret accuraci next compar perform algorithm 312 algi 310 al gii set comput result show first singular occur use simpl forward euler scheme take algorithm still take algorithm 312 algorithm 310 take 5h algorithm unstabl immedi first time step take 005 algorithm blow around take becom stabl take agre expect algorithm x31 sake stabil differ scheme smallest ffl choos depend often larger need algorithm 312 henc iter need simpler algorithm 310 algorithm iter ffl t4 t5 t6 t10 algi 1 005 7763e3 1289e2 1744e2 2959e2 algi 2 05 7763e3 1289e2 1744e2 3107e2 algii 2 05 1008e1 1640e1 2270e1 4794e1 algii 4 05 5869e2 8514e2 1129e1 1155e1 tabl 42 maximum drift two algorithm list tabl 42 maximum drift produc two algorithm variou time tabl see overal perform algi better algii also seem exampl error improv algii iter much slower motion squar chain 22 describ figur 42 exampl 42 exampl consid motion squar net veil start breez correspond tree structur net label shown figur 43 fix joint label determin father given joint jacobian matrix gp constraint extra loopclos constraint ae x squar net number bodi l set step size regular paramet 05h appli algorithm time step secondord rungekutta method regular problem srm iter 312 breez assum net move right largest angl verticl axi consid motion net whose initi posit locat angl respect vertic line list number iter variou n tabl 43 tabl see drift error improv second iter two iter need algorithm 312 independ n motion squar chain describ figur 44 figur 42 motion squar chain time increas increment deltat 2 left right top bottom 2l 4l 2l 3 2l 4 2l l3 2l l2 2l l 2l l l w1l l w2l figur 43 tree structur label squar net iter iter 3 3 3 3 3 3 3 tabl 43 relat number iter n squar net r recent advanc numer integr multibodi system stabil invari discret differenti system stabil dae invari manifold sequenti regular method higher index dae constraint singular linear index2 case sequenti regular method nonlinear higher index dae formul stiff robot simul stabil constraint integr motion dynam system numer solut initialvalu problem differentialalgebra equat robot dynam algorithm solv ordinari differenti equat ii regular differenti unifi formulaion dynam serial rigid multibodi system penalti function method simul mechan system subject constraint stabil comput procedur constrain dynam system numer solut differentialalgebra equat illcondit constraint fast recurs sqp method largescal optim control problem tr