parallel cluster identif multidimension lattic abstractth cluster identif problem variant connect compon label aris cluster algorithm spin model statist physic present multidimension version belkhal banerje quad algorithm connect compon label distribut memori parallel comput extens abstract away extran spatial connect inform two dimens simplifi implement higher dimension identifi two type local present cluster configur present optim exploit local better perform perform result 2d 3d 4d ise model simul swendsonwang dynam show optim improv perform 2080 percent b introduct cluster identif problem variant connect compon label aris cluster algorithm spin model statist mechan applic graph label ddimension hypercub lattic variabl call spin edg bond may exist nearestneighbor spin cluster spin set spin defin transit closur relat bond cluster algorithm requir lattic label two spin label belong cluster sinc cluster identif step often bottleneck cluster spin model applica tion candid parallel howev implement distribut memori parallel comput problemat sinc cluster may span entir spatial domain requir global inform propag furthermor cluster configur may highli irregular prevent priori analysi commun comput pattern parallel algorithm cluster identif must overcom difficulti achiev good perform develop multidimension extens belkhal banerje quad algorithm 1 2 2d connect compon label algorithm develop vlsi circuit extract hypercub multiprocessor paper present perform result appli algorithm ise model simul swendsonwang dynam 3 2d 3d 4d extens abstract away extran spatial inform distribut data structur manag dimensionindepend manner strategi consider simplifi implement two dimens knowledg implement first parallel cluster identif 4d improv perform identifi two type local present swendsonwang cluster configur present optim exploit type local optim work abstract represent spatial connect inform complic implement 2 dimens 2d perform result show optim effect exploit cluster local improv perform 2080 multidimension quad algorithm remaind paper proce follow section 2 discuss previou approach cluster identif problem parallel comput section 3 describ ise model swendsonwang dynam section 4 review belkhal banerje quad algorithm present extens two dimens section 5 present two optim exploit cluster local section 6 give perform result 2d 3d 4d relat work sever algorithm 2d cluster identif distribut memori mimd comput present recent year flanigan tamayo present relax algorithm block domain decomposit 4 method neighbor processor compar cluster label iter steadi state reach bailli coddington consid similar approach self label algorithm 5 relax method demonstr reason scaleup 2d problem critic cluster configur number relax iter grow distanc furthest two processor 2 p block decomposit p processor approach similar relax present strip decomposit 6 7 strip decomposit result two extern surfac per processor howev distanc two processor larg p increas number stage reach steadi state multigrid method acceler relax algorithm larg cluster present simd architectur 8 9 hostnod algorithm involv commun global connect inform singl processor host processor label global graph commun result processor hostnod algorithm 10 11 5 scale processor sinc serial host process becom bottleneck hierarch method connect compon label character spatial domain decomposit propag global inform log p stage approach base hierarch quad algorithm vlsi circuit extract hypercub multiprocessor 1 hierarch method distribut memori comput use imag compon label 12 13 bailli coddington consid mimd hierarch algorithm ise model achiev good parallel effici 5 mino present hierarch label algorithm vector architectur 14 compar littl work evalu mimd cluster identif algorithm two dimens bauernfeind et al consid relax host node approach 3d problem 15 introduc channel reduct net list optim reduc commun comput requir 3d conclud hostnod approach inappropri 3d due increas memori requir host node fink et al present 2d 3d result preliminari implement multidimension quad algorithm 2 paper includ 4d result introduc issu pertain dimensionindepend implement ise model mani physic system binari fluid liquid ga system magnet exhibit phase transit order understand critic phenomena simpl effect model construct statist mechan simplest model ise model give qualit insight properti phase transit sometim even provid quantit predict measur physic quantiti 16 ise model solv exactli 2d 17 two dimens exact solut known numer simul often use obtain approxim result exampl numer simul 3d ise model use determin properti phase transit system like binari liquid 18 4d ise model prototyp relativist field theori use learn nonperturb aspect particular phase transit theori 19 dimens ise model consist ddimension lattic variabl call spin take discret valu sigma1 neighbor spin coupl coupl strength invers proport temperatur mont carlo simul ise model gener sequenc spin configur tradit localupd mont carlo ise model simul spin valu may may chang depend valu neighbor random variabl 5 sinc spin updat depend sole local inform algorithm map natur onto distribut memori architectur interest physic aris spin configur critic region phase transit occur configur neighbor spin form larg cluster spin valu unfortun length spin correl correl length number iter requir reach statist independ configur grow z local updat scheme valu z dynam critic expon z 2 thu even correl length small 10 100 critic slowingdown sever limit effect localupd algorithm ise model 20 order avoid critic slowingdown swendson wang cluster algorithm updat whole region spin simultan 3 nonloc updat scheme gener independ configur fewer iter convent algorithm cluster algorithm much smaller valu z often approach 0 therefor elimin critic slowingdown complet swendsonwang cluster algorithm proce follow 1 comput bond spin bond exist probabl adjac spin valu 2 label cluster spin cluster defin transit closur relat bond 3 randomli assign spin cluster common spin valu sigma1 step repeat iter distribut memori comput larg spin lattic must partit spatial across processor block decomposit step 1 simpl parallel sinc comput bond neighbor spin processor must commun spin boundari neighbor processor work step 3 proport number cluster typic much less number lattic site step 2 bottleneck comput singl cluster may span entir lattic thu entir processor array label cluster requir global propag inform thu label step ideal match distribut memori architectur requir effici parallel algorithm 41 2d quad algorithm cluster identif method base belkhal banerje quad algorithm geometr connect compon label 1 develop label connect set rectangl repres vlsi circuit plane straightforward appli algorithm label cluster 2d lattic spin valu brief descript quad algorithm appli 2d lattic spin present complet descript quad algorithm see 1 cluster label algorithm consist local label phase global combin phase first global 2d lattic partit blockwis across processor array processor label cluster local partit plane sequenti label algorithm quad algorithm merg local label across processor assign correct global label spin site processor p processor quad algorithm take log p stage processor determin correct global label spin partit plane stage processor knowledg rectangular inform region span evergrow section plane intuit processor qs inform region repres portion global domain q alreadi collect inform necessari label qs local spin data associ inform region consist ffl list label cluster touch least one border inform region cluster call ccomp set ffl four border inform region list repres processor bond touch border bond border list connect spin site current inform region spin site outsid region bond associ ccomp set contain local spin site border list data structur list offset list ccomp set label offset repres one bond border indirect represent facilit unionfind cluster merger describ see figur 1 l 1 l l l l l ccomp label border bond list figur 1 field inform region data structur initi inform region processor consist ccomp set label border list local partit plane stage processor q 1 exchang messag processor q 2 q 1 q 2 inform region adjac messag contain ccomp set label border list current inform region processor merg ccomp set common border two inform region use unionfind data structur 21 border list two inform region concaten form inform region processor q 1 next stage manner size processor inform region doubl stage log p stage processor inform region span entir plane figur 2 illustr inform region grow span entir global domain planar topolog processor global combin complet inform region span entir plane global domain toroid topolog cluster opposit border last inform region merg postprocess step current inform region stage 1 stage 2 stage 4 stage 3 partner inform region done figur 2 inform region stage quad algorithm sixteen processor stage inform region processor top left corner current inform region partner processor inform region also shown stage two inform region merg form inform region subsequ stage 42 extend quad algorithm higher dimens straightforward extens quad algorithm two dimens result fairli complex multidimension inform region data structur simplifi implemen tation present multidimension extens use abstract dimensionindepend inform region represent divideandconqu quad algorithm strategi natur extend 2 dimens partit global domain ddimension block assign one processor processor perform sequenti label method local domain domain translat inform region global combin step inform region repres ddimension subset ddimension global domain ddimension inform region merg stage algorithm log p stage inform region span entir global domain two dimens list bond border 1d list correspond 1d border two 2d inform region sinc bond exist everi lattic site border list spars 3d lattic border list must repres spars 2d border gener border two ddimension inform region gamma 1 dimension hyperplan thu straightforward 3d 4d implement would much complex two dimens spars multidimension hyperplan must commun travers order merg cluster avoid complic note impos order bond touch inform region border actual spatial locat bond within border need merg set across processor long processor store border bond order store bond 1d list merg cluster differ processor travers correspond border list order figur 3 illustr 3d lattic concept first appli fink et al 3d quad algorithm 2 figur 3 2d border 3d inform region linear enumer border bond order processor similar optim appli 3d lattic bauernfeind et al15 defin order border bond consid gamma 1dimension border subset ddimension global lattic enumer bond touch dimension border columnmajor order rel ddimension global lattic sinc processor enumer site rel global indic processor store set border order without regard orient border space order linear gamma 1dimension border result abstract inform region whose border represent independ problem dimension two inform region merg order bond new border list consist differ processor therefor logic merg cluster border two inform region chang multidimension lattic spars hyperplan data structur requir 2d cluster implement extend 3d 4d modif 43 perform analysi belkhal banerje show 2d quad algorithm vlsi circuit extract run number processor ff invers ackerman function messag startup time b commun time per byte b number border rectangl along cross section global domain 1 number border rectangl vlsi circuit extract applic correspond number border bond cluster identif applic cluster identif lattic let n lattic size p probabl bond two adjac lattic point give run time olog p n ddimension problem defin n p assum global domain ddimension hypercub side n 1d partit onto ddimension logic hypercub processor side p 1d suppos stage processor inform region hypercub side length stage inform region hypercub side length 2a thu surfac area inform region increas factor 2 dgamma1 everi stage let bi surfac area inform region stage bi e 1 easi see total number bond border inform region proport surfac area sum log p stage find total number byte processor commun algorithm o2dpn log p messag start total time spent commun olog total number unionfind oper perform processor stage equal number bond border inform region use path compress union rank optim unionfind oper 21 total work spent merg cluster opdn ffpdn implement use path compress heurist unionbyrank ad togeth commun comput run time global combin olog ffpdn breadthfirst searchbf shown effici algorithm perform sequenti local label step 5 sinc bf run ojv jjej 21 local label phase run n thu dimens lattic time local phase domin time global phase long n larg howev increas global time increas rel local time fix problem size must therefor scale problem size along problem dimension order realiz equival parallel effici higher dimension lattic optim one limit quad algorithm surfac area inform region grow stage last stage processor must handl crosssect entir global domain mani processor larg problem size degrad algorithm perform 1 mitig effect develop optim exploit properti cluster configur better perform mont carlo ise model simul cluster configur structur depend heavili coupl constant recal probabl bond exist two adjac samevalu spin subcrit low bond rel spars cluster small supercrit high bond rel dens one larg cluster tend permeat entir lattic critic system transit two case cluster configur combin small larg cluster particular spin affect label spin depend cluster configur properti identifi follow two type local may exist cluster configur cluster affect cluster label limit area ffl type 2 adjac lattic point like belong cluster subcrit configur exhibit type 1 local supercrit configur exhibit type 2 local configur critic show aspect type belkhal banerje exploit type 1 local two dimens overlap quad algorithm 1 algorithm inform region overlap cluster span overlap region must merg intuit small cluster elimin earli stage algorithm leav larg cluster merg later stage overlap quad algorithm requir posit bond within border maintain preclud use abstract dimensionindepend inform region data structur instead present two simpler optim bubbl elimin border compress optim work abstract border represent complic implement 2 dimens 2d 51 bubbl elimin bubbl elimin exploit type 1 local elimin small cluster preprocess phase quad algorithm local cluster touch one border inform region call bubbl immedi initi inform region processor identifi bubbl along border inform exchang neighbor cluster mark bubbl side border merg delet border thu small cluster elimin inform region perform basic quad algorithm cours quad algorithm commun comput reduc sinc bubbl cluster consid bubbl elimin incur commun overhead 3 gamma1 messag ddimension problem commun manhattan neighbor commun overhead drop 2d messag although bubbl corner edg inform region elimin effect insignific granular problem suffici larg 52 border compress border compress exploit type 2 local chang represent border list compress represent list use runlength encod 22 border list set label replac sequenc pair l sl number time valu l appear success border list type 2 local preval border compress aid perform two way reduc length messag exploit compress represent reduc number unionfind oper perform two compress border merg decompress form two correspond list cluster label combin compress represent simpl determin two cluster merg togeth sever time success decompress simpl filter redund merger list reduc number unionfind merger perform thu border compress reduc commun volum comput cluster configur bubbl elimin increas effect border compress suppos global cluster configur resembl swiss chees mani small cluster interspers one larg cluster phenomenon occur ise model cluster configur critic bubbl elimin remov small cluster preprocess leav activ cluster belong one larg cluster case long run ident label along border inform region border compress collaps run leav small effect inform region border 6 perform result 61 implement implement cluster algorithm ise model simul 2d 3d 4d c global lattic toroid topolog direct use bubbl elimin manhattan neighbor consid local label method breadthfirst search 21 accord swendsonwang algorithm cluster must flip randomli cluster identif step spatial decompos parallel implement necessari processor obtain consist pseudorandom number gener new spin cluster span one processor implement gener new random spin local cluster prior global cluster merg store new spin highord bit cluster label thu cluster merg spin cluster guarante consist simplifi implement 2 dimens use lparx program librari version 11 23 lparx manag data distribut commun cartesian lattic greatli simplifi section code manag regular spin lattic kernel cluster algorithm written messagepass style use messagepass layer lparx24 gener messagepass system resembl messag pass interface25 sinc cluster algorithm larg dimensionindepend messagepass code almost ident problem dimension fact code gener 2d3d 4d version compiletim macro determin problem dimension code develop debug sun workstat use lparx mechan simul parallel process messagepass perform result obtain run intel paragon osf1 r12 32mbnode code compil gcc v257 optim level 2 62 perform total cluster identif time consist local stage perform local label sequenti algorithm global stage combin label across processor use multidimension quad algorithm time report wall clock time obtain paragon dclock system call accuraci 100 nanosecond intuit expect benefit bubbl elimin border compress vari coupl constant figur 4 5 6 show global stage run time vari valu problem size shown critic region occur c 0221 2d c 0111 3d c 008 4d sinc surfac areatovolum ratio larger 3d 4d 2d optim import problem expect figur 5 6 show bubbl elimin effect subcrit region border compress effect supercrit region critic region two optim togeth effect either optim alon presum due swiss chees effect discuss section 5 togeth optim improv perform 3585 depend 3d 4d kappa10305070 global combin time per 4d global combin time node 68x68x34x34 lattic bubbl elimin border compress 2d optim improv perform 2070 show intuit depend 3d 4d suspect due cach effect increas number global cluster decreas thu cluster merg unionfind data structur access cach hit higher sinc greater portion union find data structur fit cach 2d surfac areatovolum ratio low unionfind access becom domin factor algorithm perform 3d 4d inform region border much larger overflow cach caus mani cach miss travers border inform region sinc border larger unionfind data structur unionfind data structur memori access less critic figur 7 show rel cost local stage global stage without optim breakdown show 2d local label time domin global time benefit optim limit amdahl law 26 howev 3d 4d global stage bottleneck comput two optim signific impact perform time result instruct depend implement detail machin ar chitectur evalu optim object measur tabl 1 show total number byte transmit cours quad algorithm sinc amount work merg cluster directli proport length messag number give good indic success optim exploit variou cluster configu ration commun volum reduct vari depend cluster configur structur rang factor twenti one sinc physicist interest use parallel process capabl run larger problem possibl singl workstat appropri examin algorithm perform problem size number processor grow ideal linear parallel time per site ns normal label perfom local label global label optim optim subcrit critic supercrit figur 7 breakdown algorithm cost normal per spin site run 64 processor intel paragon lattic size 4680x4680 2d 280x280x280 3d 68x68x34x34 4d subcrit run 3d 004 4d critic run 2d 0111 3d 008 4d supercrit run 2d 02 3d 02 4d opt elim compress 2d 4680x4680 lattic 3d 280x280x280 lattic 4d 68x68x34x34 lattic tabl 1 total number byte transmit global combin run 64 processor algorithm problem size number processor scale togeth asymptot run time remain constant due global natur cluster identif problem basic quad algorithm achiev ideal scale speedup practic sinc quad algorithm take log p stage global work increas least log p difficulti dimens work last stage algorithm doubl everi stage howev bubbl elimin border compress optim vastli reduc work later stage algorithm thu optim get closer achiev ideal scale speedup tabl 2 show scale speedup result fix number spin site per processor critic cluster configur result show number processor problem size scale togeth perform benefit optim increas 2d scale speedup optim nearli ideal 3d especi 4d version scale well although figur 7 show better perform achiev away critic although optim develop multidimension quad algorithm mind conjectur would also effect cluster identif algorithm relax method 4 6 7 multidimension quad algorithm optim may also appropri variant connect compon label one open question whether border compress bubbl elimin optim would effect exploit graph structur applic imag compon label applic 7 conclus present effici multidimension extens belkhal banerje quad algorithm connect compon label sinc extens deal abstract spatial number optim optim processor 2d 3d 4d 2d 3d 4d tabl 2 global combin time second lattic size number processor scale togeth processor partit 585x585 2d 70x70x70 3d 17x17x17x17 4d run c connect inform distribut data structur manag dimensionindepend manner techniqu consider simplifi implement two dimen sion introduc two optim basic algorithm effect exploit local ise model cluster configur depend structur cluster configur optim improv perform 2080 intel paragon opti mizat larg lattic label mani processor good parallel effici optim especi import two dimens surfac areatovolum ratio high r parallel algorithm geometr connect compon label hypercub multiprocessor cluster identif distribut memori multiprocessor nonunivers critic dynam mont carlo simu lation parallel cluster label method mont carlo dy namic cluster identif algorithm spin model sequenti parallel parallel ise model perform evalu swendsonwang dynam larg 2d critic ise model multigrid cluster label scheme parallel multigrid algorithm percol cluster parallel simul ise model paralleliza tion 2d swendsonwang algorithm evalu connect compon label algorithm share distribut memori multiprocessor compon label algorithm intel ipsc2 hypercub vector algorithm cluster format swendsonwang dynam ic 3d ise model swendsonwang dynam parallel approach statist field theori crystal statist twodimension model orderdisord tran sition numer investig interfac tension threedimension ise model broken phase 4dimension ise model finit volum comput simul method theoret physic introduct algorithm robust parallel program model dynam nonuniform scientif comput lparx user guid v20 messag pass interfac forum comput architectur quantit approach tr ctr scott b baden softwar infrastructur nonuniform scientif comput parallel processor acm sigapp appli comput review v4 n1 p710 spring 1996