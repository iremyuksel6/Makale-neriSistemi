fast multigrid solut advect problem close characterist numer solut advectiondiffus problem inviscid limit close characterist studi prelud effici high reynoldsnumb flow solver demonstr heurist analysi numer calcul use upstream discret downstream relax order multigrid cycl appropri residu weight lead effici solut process upstream finitediffer approxim advect oper deriv whose truncat term approxim physic laplacian viscos thu avoid spuriou solut homogen problem artifici diffus domin physic viscos brandt yavneh j comput phi 93 1991 pp 128143 b introduct effici multigrid algorithm numer solut partial differenti problem normal requir good ellipt measur scale problem impli nonsmooth solut compon resolv local process 2 problem small ellipt measur mark either indefinit anisotropi latter case technionisrael institut technolog haifa israel univers twent ensched netherland z weizmann institut scienc rehovot israel exist socal characterist direct strong depend nonsmooth compon solut advect along char acterist henc resolv local 1 typic exampl steadi flow high reynold number small viscos appli problem small ellipt usual multigrid algorithm often exhibit sever degrad perform compar seen ellipt problem inde multigrid code use today solv steadi flow high reynold number although yield great improv previou singlegrid solver fall far short attain socal textbook multigrid effici gener even smooth flow regain effici multigrid algorithm requir modif take account anisotrop properti oper exampl shown 4 9 use upstream discret downstream relaxationord yield fulli effici multigrid solver flow whose characterist streamlin start part boundari end anoth without recircul enter flow obtain effici multigrid solver flow close characterist howev differ modif propos defectcorrect cycl residu overweight 5 main drawback latter approach like gener effici order accuraci higher one b requir w cycl may substanti expens simpl v cycl parallel comput c suggest differ treatment differ type flow viz recircul versu enter flow upshot present work obtain unifi approach type flow employ upstream discret downstream relax order recircul flow well section 2 formul simpl model problem advectiondiffus present first differenti approxim discret form section 3 present twolevel cycl use approxim section 2 heurist analysi priori predict perform algorithm section 4 new firstord upstream discret advect oper present whose first truncat term approxim isotrop diffus scheme shown elimin spuriou solut homogen ie unforc smallviscos advectiondiffus equat report 3 section 5 present numer calcul test accuraci discret effici multigrid algorithm compar predict section 3 section 6 summar main conclus research plan 2 scalar advectiondiffus equat studi scalar advectiondiffus equat close characterist prelud studi flow problem equat serv well preliminari problem sinc advect part ie momentum equat respons degrad perform observ solut incompressibleflow equat usual multigrid algorithm 5 also shown enter flow 4 solutionprocess advect part system effect decoupl ellipt part due continu equat henc effici solut advect problem necessari stage develop fulli effici flowequ solver 4 suggest result advectionproblem solver inde use design soughtaft flowsolv advectiondiffus equat two dimens ffl posit constant b f g given function x equat 1 discret uniform grid meshsiz h whose gridlin lie parallel x coordin characterist direct advect oper 1 given local oe local angl nonalign x coordin characterist direct focu attent particular case characterist defin b form close loop vortic one may coincid omega intern flow suppos 1 discret stabl finitediffer discret firstord accuraci main aspect problem analyz substitut discret oper first differenti approxim 8 also 1 2 9 advectiondiffus equat posit vanishingli small ffl need consid advect oper ator sinc tini diffus domin artifici diffus repres truncat term except stagnat point let l h denot firstord accur discret approxim advect opera tor taylor seri expans gener u h denot discret function h meshsiz uniform grid function x specif detail determin b discret fda approxim l h differenti oper remain 2 oh 2 term neglect henc appli suffici smooth u h sinc neglect term higher deriv assum simplic discuss equat normal 2 introduc conform local coordin system j denot local streamwis coordin parallel characterist direct j denot crossstream coordin perpendicular characterist thu fda l h local coordin system therefor 2 4 assum consist stabl discret requir artifici viscos oper repres first truncat term ellipt impli oh part oper 5 posit type special circumst consist align characterist grid h vanish properti margin violat case physic diffus term becom import matter small ffl may analysi appli accordingli assum h 1 larg compar h usual case 3 twolevel errorreduct analysi analyz error reduct attain twolevel cycl use upstream discret downstream relaxationord 31 twolevel cycl propos twolevel cycl given discret problem l h u defin follow ffl start approxim u h perform 1 small integ relax sweep ffl calcul residu r u h current approxim solut transfer twicecoars grid 2h multipli globallyuniform weight w ffl solv coarsegrid problem l 2h v correct r 2h restrict r h coars grid ffl interpol add correct v 2h finegrid approxim ffl perform 2 small integ finegrid relax sweep studi asymptot perform twolevel cycl number prerelax sweep 1 need distinguish number postrelax sweep 2 recal associ asymptot perform spectral radiu ae iter matrix aeab aeba pair squar matric b dimens denot total number sweep analyz twolevel cycl shall make mani simplifi assump tion degre assumpt justifi need judg degre numer result match predict analys 32 model problem analysi analyz twolevel converg discret approxim 1 limit vanish ffl problem close characterist consid follow model problem grid h l h discret advect oper domain solut boundari condit requir period order simul close characterist choos simplic discuss 2 0 1 boundari condit crossstream direct german present context simplic let main point approach use discret pure upstream relax equat downstream order start order mean relax variabl relax unknown particip equat correspond variabl except perforc thu full relax sweep result elimin residu except narrow band oh width stretch coincid due period neglect width band find residu function r h remain least one full relax sweep carri model r h finegrid error v h satisfi residu equat wherev residu vanish revert fda obtain defin 5 add simplifi assumpt 5 independ j henc may expand 8 fourier seri j error compon expij frequenc equat 5 8 yield oh term first neglect homogen equat sinc multipli deriv therefor small compar dv h solut 9 interv 0 1 therefor given z h ds h amplitud v h shall determin shortli superscript denot infinitesim posit neg incr ment particular 1 averag valu h 1 entir domain assumpt j gammaindepend recal domain length direct one import note dh approxim factor singl relax sweep amplifi reduc error compon oscil frequenc j direct due fact given upstream differenc downstream relax order yield numer integr dh factor integr domain reduc error equat 11 impli relax reduc error compon larg effici compon smooth along j need correct coars grid fda longer use instead jump v h proport fourier coeffici r h j correspond frequenc denot jump ffi h period impli 10 11 h follow twolevel algorithm attempt approxim weight residu equat coars grid 2h assum discret stencil use coars grid fine note import assumpt entir method hing also assum restrict oper jump condit approxim correctli coars grid practic hold provid proper averag use fullweight residu transfer analog 1011 12 respect obtain z 2h ds 2h w constant weight chosen sinc stencil l h l 2h also assum also sinc assum restrict oper transfer jump condit correctli ffi 2h equat 12 15 16 yield 2h h neglect effect intergrid transfer alias assum remain error ad coarsegrid correct henc finegrid error amplifi factor v h addit relax sweep perform fine grid amplifi error dh note twolevel erroramplif factor tl given absolut valu product term note howev determin valu coarsegrid correct term depend one begin relax fine grid immedi follow coarsegrid correct sinc finegrid valu end one sweep determin sole valu relax begin due upstream differenc downstream relax order fine grid relax begin shortli point residu nonzero 2h h howev finegrid relax begin small overlap region relax h 33 optim residu weight 11 order obtain hindepend analysi assum take valu interv 0 1 optim valu w minim supremum tl 1 fix w supremum evid obtain either 18 19 thu obtain dm function w calcul w opt valu w yield fastest converg either case 18 yield larger tediou calcul need carri numer w opt tend 2 case rather quickli expect sinc valu ratio green function coars fine grid compon smooth crosscharacterist direct compon reduc relax obtain 18 19 equat deriv 20 respect zero get relev root twolevel erroramplif factor obtain substitut 21 20 suffici small gamma2 may neglect term obtain fact 22 give excel approxim maxim tl 20 er less 2 2 curiou coincid asymptot twolevel erroramplif factor larg 2e gamma1 obtain poisson equat rectangl use gauss seidel relax redblack order 7 thu analysi lead us expect effici compar obtain poisson problem exampl 1 appli algorithm advectiondiffus problem close characterist use 10 origin 6 0 1 ux advect term use discret use finest grid 6 10 standard upstream su defin use valu stagnat point ad viscos elsewher maintain upstream discret sinc physic viscos domin artifici viscos elsewher anyway differ small altern could use much smaller ffl everywher level grid w 1 w 2 mgd9v tabl 1 number cycl necessari reduc l 2 residu norm factor 10 8 exampl 1 problem taken 10 mgd9v automat method de zeeuw use 10 initi guess u inomega zero cycl l 2 norm residu reduc 10 gamma8 time initi valu perform test 4 5 6 7 8 level coarsest grid alway 5 theta 5 includ boundari point 10 use v11 cycl throughout usual fullweight residu transfer bilinear terpol see section 5 detail implement relax tabl 1 compar result w1 2 report mgd9v automat method de zeeuw avail six level use socal sawtooth cycl one illu incomplet line lu relax sweep per level must stress effici robust method convincingli demonstr 10 result achiev ten problem includ nonrecircul advect diffus far better evid present method perform well effici compar ellipt equat simpl test problem clearli downstream relax order suffici recircul problem illu mgd9v present method residu overweight show clear deterior grid refin proper overweight converg rate remain excel even fine grid reiter residu overweight approach may appli mgd9v sinc differ stencil use differ grid requir differ overweight 34 sever band residu may alway easi obtain singl band residu per vortex happen relax carri piecewisedownstream order would case domaindecomposit set exampl analysi extend case sever band nonzero residu remain relax found one requir two coarsegrid correct optim weight 1 2 approxim seem impli w cycl requir situat also one must use upstream intergrid transfer avoid averag interfac subdomain may actual caus diverg 4 discret flow streamlin start end boundari constitut close curv requir special consider discret case even small viscos play import role determin main flow throughout domain solut limit vanish viscos depend strongli coeffici tend zero effect advect term determin behavior solut along streamlin wherea viscou term determin crossstream form sinc boundari often streamlin propag inform boundari domain govern viscou term matter small may effect discuss detail 3 9 shown advectiondiffus problem incompress navier stoke equat solut scheme numer viscos anisotrop differ viscos coeffici crossstream streamwis direct standard upstreamdiffer scheme may spuriou gener case shown even isotrop viscos suffici converg solut one must actual specifi uniform viscos know retain pure upstream structur see remark section 6 howev homogen advectiondiffus problem sever indic though proof isotropi suffic shown also 3 9 also shown numer exampl suffic incompress navier stoke equat consist fact vortic navier stoke equat satisfi homogen advectiondiffus equat obtain discret scheme exhibit appropri physic like behavior vanish viscos must thu either add suffici explicit isotrop viscos domin artifici viscos discret advect oper els deriv discret advect oper satisfi condit isotropi lowestord truncat term sinc want scheme remain pure upstream follow latter approach consid standard upstream scheme 23 assum simplic discuss b 0 2 taylor expans henc order obtain isotrop artifici viscos may either add approxim 05ha gamma bu xx els subtract approxim 05ha gamma bu yy order retain upstream scheme defin addit viscos point gamma gener b obtain first case isotropicviscos upstream scheme ivu1 defin ja ij j jb ij j otherwis second case obtain scheme ivu2 defin ja ij j jb ij j otherwis i1 j1 defin 23 similarli first truncat term scheme ivu1 thu gamma05 minja ij j jb ij jdeltau ivu2 gamma05 maxja ij j jb ij jdeltau scheme isotrop artifici viscos ivu1 smaller fact vanish upon align characterist direct grid discret stabl downstreamord gaussseidel relax ation former nonnegativeweight averag standard firstord secondord upstream scheme stabl relax latter produc mmatrix expect stabil problem mani numer calcul 5 numer experi first test numer discret deriv section 4 model problem standard upstream scheme shown yield spuriou solut 3 9 asymptot error reduct twolevel multilevel cycl investig sever problem 51 accuraci test accuraci differ discret test model problem b given coeffici exampl 2 pictur characterist appear figur 1a domain solut unit squar center origin squar diagon 05 whose side form 45 degre angl axe remov center outer boundari prescrib inner boundari solv problem three upstream schemessu ivu1 ivu2 also nonupstream isotropicviscos scheme use 3 denot iso viscos ad solut compar obtain standard secondord upstream scheme physic viscos coeffici 0001 latter solut obtain 257 theta 257 grid grid su ivu1 ivu2 iso 129 theta 129 00750 00057 00163 00098 tabl 2 l 1 differ norm solut obtain sever scheme differ resolut highaccuraci solut obtain grid 257 theta 257 see text detail three isotropicviscos scheme seen yield converg solut standard upstream su scheme tabl 2 present l 1 norm differ test solut variou resolut secondord accur solut restrict correspond grid inject sinc solut smooth physic viscos domin secondord truncat term high resolut latter solut assum accur evid three scheme isotrop artifici viscos produc converg solut su scheme despit fact averag viscos smaller ivu2 iso ivu1 least artifici viscos four scheme test produc smallest error 52 effici test remaind numer calcul aim test perform algorithm variou configur compar analyt predict section 3 test su scheme wide use firstord scheme ivu1 scheme accur ivu2 also employ fourpoint stencil test use firstord upstream residu restrict bilinear interpol correct restrict perform follow even j fine grid defin i1 j1 23 restrict correspond coarsegrid righthand side coarsegrid point i2 j2 averag finegrid residu point j i1 j j1 i1 j1 restrict give slightli better result standard full weight multivortex problem sinc residu less like transfer one vortex anoth finest grid test 129 129 six level employ except twolevel test includ physic viscos except stagnat point requir wellposed calcul converg factor follow boundari condit righthand side chosen zero choic immateri linear problem allow us normal solut constant factor everi cycl order avoid roundoff error initi solut field pseudo random 100 cycl perform calcul converg factor geometr averag errorconverg per cycl last 80 cycl averag use case converg histori smooth valu correspond particular cycl may carri much mean howev note case converg factor vicin optim w sensit exact choic w exampl 2 first test effici problem use test discret without inner island pure recircul everywher characterist problem form singl clockwiserot vortex plot figur 1a relax sweep implement sweep four time domain sweep relax roughli one quarter variabl follow first sweep variabl locat ax bx nonneg relax design first quadrant second sweep variabl correspond locat ax nonneg bx nonposit relax second quadrant third sweep variabl locat ax bx nonposit relax third quadrant fourth sweep variabl correspond locat ax nonposit bx nonneg relax fourth quadrant fi nalli stagnat point case one relax last entir process compris singl clockwis sweep cours quartersweep perform downstream order ie x increas first quarter increas decreas second etc effici store order relax entir sweep setupsweep cost littl full clockwis sweep cost nearli ordinari lexicograph gaussseidel sweep note specifi nonneg nonposit descrip tion ensur boundari quadrant includ quadrant import test clockwis sweep inde elimin residu except along narrow band extend center vortex boundari vortex rotat counterclockwis sever band would remain henc exampl 35 clockwis counterclockwis vortic exist would gener case perform analog counterclockwis sweep follow clockwis one quadrant counterclockwis sweep start bear perform experi use exactli revers order allow us save work perform counterclockwis sweep three quadrant sinc fourth quadrant ax nonposit bx nonneg relax clockwis sweep thu begin third quadrant b nonposit second final first quadrant note way differ usual symmetr gaussseidel sweep perform downstream order within quadrant quadrant scan symmetr problem 35 especi also sensit quadrant one choos start relax sweep somewhat differ converg rate optim overweight obtain one perform clockwis sweep one relax say second quadrant first third fourth final first henc test shift relax startingpoint one quadrant everi cycl obtain result repres averag typic case first perform twolevel test order compar numer result analysi use theoret optim w calcul 19 relev valu exampl sinc onelin overlap quadrant result given tabl 3 evid analysi captur main featur problem well despit numer simplif seen especi su result calcul also carri v10 v11 v21 cycl optim valu determin experiment numer result summar tabl 4 find experiment vcycl result also match twolevel predict fairli well tabl 3 comparison erroramplif factor obtain analyt predict twolevel numer calcul exampl 2 w opt optim valu w obtain 19 vicin optim residualweight factor optim w somewhat higher predict although show expect depend number relax sweep perform problem report optim valu vari alway fairli close 2 overal perform optim w use satisfactori note perform sensit moder chang w see also exampl 3 exampl featur flow four vortic rather one b given characterist plot figur 1b domain exampl except exampl 5 unit squar center origin numer result use v11 v21 cycl appear tabl 5 6 respect converg perform remain excel even though nonvanish residu remain relax part borderlin vortic flow lead away borderlin recal howev full relax sweep consist one clockwis sweep follow three quarter counterclockwis sweep see descript implement order allow opposit sign vortic cycl w su ivu1 v10 1 0795 0898 v11 1 0676 0831 v21 1 0536 0724 2 0280 0440 2 0143 0302 2 0069 0133 tabl 4 erroramplif factor obtain numer calcul exampl 2 optim valu w obtain experiment see text exampl 4 order test effect gridalign borderlin vortic solv problem borderlin align grid problem b given 1 respect repres superposit two oppositesign vortic characterist depict figur 1c numer perform shown tabl 5 6 see loss effici perform still satisfactori far better usual exhibit problem exampl 5 test mix problem flow enter leav boundari also exist larg recircul zone obtain redo exampl 2 extend domain exampl su ivu1 tabl 5 erroramplif factor obtain v11 cycl w opt latter found experiment exampl su ivu1 tabl obtain v21 cycl w opt latter found experiment mesh still uniform finest grid 193 129 characterist shown figur 1d numer perform given tabl 5 6 exampl virtual sensit order relax sweep perform clockwis first counterclockwis vice versa summari often one may wish search optim residu weight factor everi problem instead one simpli use nomin valu 2 realist exampl 35 one save 25 time spent relax use optim valu rather 2 usual much less would also case exampl 1 employ symmetr relax even nomin valu converg rate compar ellipt problem 6 conclus research experiment approach hope eventu lead fulli effici solver gener highreynold flow introduc analyz test advectiondiffus problem inviscid limit numer test mostli match predict well indic main caus slow converg usual multigrid algorithm recircul flow inde understood way elimin found multigrid vcycl use downstream relax upstream di cretiz shown yield effici solver test problem sever simpl situat close characterist mix en teringrecircul problem test perform classic standard firstord upstream discret scheme also novel firstord upstream discret shown preclud spuriou solut report 3 present approach cheaper implement develop 5 straightforwardli appli mix enteringrecircul flow import potenti success highord discret approach 5 yield inadequ compromis howev result obtain still preliminari effect intergrid transfer small band residu consequ term error reduct effici investig wide varieti case along studi deal avoid situat remain sever band nonvanish residu per vortex research direct toward higherord discret case effectivelyupstream discret need develop whose truncat error repres isotrop artifici diffus one approach use predictorcorrector type discret employ upstream scheme local driver possibl higherord necessarili upstream scheme local corrector final present approach test advect problem experi incompress navier stoke equat flow close streamlin need perform employ distribut gaussseidel relax shown 4 doubt rais question anticip techniqu investig carri three dimens although implement consider complic support fact simpl experi perform overweight method 5 three dimens exhibit expect perform obviou drawback entir approach inher sequen tial effici parallel implement hard envisag parallel might achiev perform downstream line gauss seidel relax also conceiv domain decomposit approach leav sever line residu per vortex anoth drawback present approach directli applic flow signific addit viscos sinc entail use discret pure upstream method deal flow well present investig acknowledg work support royal netherland academi art scienc feinberg graduat school unit statesisrael binat scienc foundat grant 9400250 unit state air forc grant f4962092j0439 carl f gauss minerva center scientif comput r multigrid solver nonellipt singular perturb steadi state problem 1984 multigrid guid applic fluid dynam ic inadequaci firstord upwind differ scheme recircul flow multigrid solut highreynold incompress enter flow acceler multigrid converg high reynold recircul flow effici solut finit differ finit element equat algebra multigrid fundament algo rithm correct first differenti approxim differ scheme multigrid techniqu incompress flow tr