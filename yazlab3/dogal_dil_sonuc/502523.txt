probabilist model transact data applic profil visual predict transact data ubiquit data mine applic exampl includ market basket data retail commerc telephon call record telecommun web log individu pagerequest web site profil consist use histor transact data individu construct model individu behavior simpl profil techniqu histogram gener well spars transact data paper investig applic probabilist mixtur model automat gener profil larg volum transact data effect mixtur model repres individu behavior linear combin basi transact evalu sever variat model larg retail transact data set show propos model provid improv predict power simpler histogrambas techniqu well rel scalabl interpret flexibl addit point applic outlier detect custom rank interact visual forth paper conclud compar relat propos framework transactiondata model techniqu associ rule b introduct larg transact data set common data mine ap plicat typic data set involv record transact multipl individu transact consist select visit among set item eg market basket item purchas list web page individu visit specic session transact data exampl store depart number transact figur 1 exampl transact sever dividu row correspond market basket column correspond particular categori item darker pixel item purchas white mean zero solid horizont gray line correspond transact data introduc plot indic boundari transact dierent individu interest problem make infer individu behavior given transact data larg set individu period time particular focu techniqu automat infer prole individu transact data paper prole consid descript model individu transact behavior specic likelihood individu purchas visit particular item find prole fundament problem increas interest data mine across rang transactionrel applica tion retail crosssel web person forecast forth figur 1 show set transact 5 dierent individu row correspond market basket transact column correspond categori item store depart exampl data set exampl taken involv 200000 transact 50000 custom twoyear period set retail store heterogen purchas behavior clear even simpl plot dierent custom purchas dierent number item dierent depart dierent amount goal paper investig parsimoni accur model individu purchas behavior ie individu prole paper begin dene gener problem prol ing spectrum spars individualspec inform broadli support global pattern dene gener notat problem introduc mixtur model framework model transact havior individu level describ model illustr exampl conduct number experi realworld transact data set demonstr propos approach feasibl realworld data provid perform interpret accur scalabl brie sketch model support sever data mine task exploratori data analysi rank custom novelti detect forecast ing forth conclud discuss relat work 2 profil problem prole essenti problem convert transact data gure 1 model individu use predict futur behav ior clearli human behavior highli unpredict thu uncertainti abound nonetheless like regular data leverag averag lead systemat method make predict facet mani transact data set fact data quit spars exampl mani transact data set includ particular data set correspond gure 1 histogram number transact peak 1 ie custom singl transact number transact decreas exponenti quickli thu mani custom transact base prole other larg number transact assum exampl model individu via simpl multinomi probabl model indic item chosen name vector probabl pc one c categori item assum combin histogram model mani item total purchas per visit rate paramet govern often individu conduct transact per unit time averag eg per month crux prole problem nd middleground two prole extrem one model extrem could construct gener model gener form describ whole popul assum individu homogen enough behavior singl model adequ unlik accur given heterogen human behavior eg see gure 1 extrem could construct uniqu model individu base past transact data individu eg multinomi histogram rate paramet estim raw count individu certainli provid individualspec prole model howev suer least two signic problem firstli individu small amount data one item one transact prole extrem spars contain littl inform secondli even individu signic amount data raw count contain notion gener unless purchas specic item past prole probabl item zero ie model predict never purchas limit wellknown motiv develop variou techniqu borrow strength ie make infer specic individu combin individu data know popul whole collabor ltere thought nonparametr nearestneighbor techniqu context associ rule algorithm also tri address problem identifi rule gener allow ident predict novel item seen individu histori eg brij et al 2000 lawrenc et al 2001 howev method support specic infer item individu like pur chase provid explicit model indi vidual behavior thu dicult combin approach tradit forecast predict techniqu exampl season model techniqu util inform annual season shop pattern similarli clear covari inform avail individu incom sex educ background etc could integr systemat coher manner associ rule framework exampl paper take modelbas approach prole problem allow inform individu integr within singl framework specic propos exibl probabilist mixtur model tran action model ecient manner mixtur model infer probabilist prole individ ual compar approach baselin model base raw adjust histogram techniqu illustr mixtur model allow accur gener limit amount data per individu 3 notat observ data set observ data ith custom 1 n individu data set consist one transact custom ie fy g ij jth transact custom n total number transact observ custom individu transact ij consist descript set product purchas time custom purpos experi describ individu transact ij repres vector count compon n ijc indic mani item type c transact ij 1 c c one straightforwardli gener represent includ exampl price product focu number item count equal well compon n ijc could indic time sinc last page request individu request web page c session j purpos paper ignor inform time sequenti order item purchas page visit within particular transact clear discuss straightforward gener approach sequenti order time inform avail assum transact key uniqu identi individu exampl key includ driver licens number credit card number retail purchas login cooki identi web visit practic problem associ ident data entri error miss identi fraudul deliber disguis id multipl individu use singl id ambigu ident web forth nonetheless increas number transact data applic reliabl ident possibl via methodolog frequent shopper card optin web servic forth rest paper assum ident problem issu ie either ident process inher reliabl rel accur techniqu discern iden titi fact realworld transact data set use illustr techniqu ambigu identica tion process problem 4 mixturebasismodelsfortran action propos simpl gener mixtur model tran action name transact ij gener one k compon kcompon mixtur model thu kth mixtur compon 1 k k specic model gener count think k model basi function describ prototyp tran action exampl one might mixtur compon act prototyp suitbuy behavior expect count item suit tie shirt etc probabl compon 3 probabl compon 4 compon 5 depart probabl compon 6 depart figur 2 exampl 6 basi mixtur compon transact data figur 1 given compon would rel higher item sever model choic compon transact model gener item count paper choos particularli simpl memoryless multinomi model oper follow condit n ij total number item basket individu item select memoryless fashion n ij draw multinomi distribut c possibl item model possibl exampl one could model data come c condit independ random variabl take nonneg integ valu gener involv paramet multinomi model allow exampl model purchas exactli one suit one pair shoe manner multinomi multipl trial model achiev paper howev investig multinomi model sinc simplest begin also model distribut typic number item purchas within given compon eg poisson model entir reason giftbuy compon model might much higher mean number item suitbuy model extens straightforward discuss paper figur 2 show exampl compon learn transact data gure 2 detail learn discuss window show particular set multinomi probabl model specic type transact compon show strike bimod pattern multinomi model appear involv depart either depart 25 littl probabl mass cross fact model captur fact depart number lower correspond men cloth 25 correspond women cloth see evid bimod data gure 1 note individu fact cross purchas item number item train purchas 5026number item depart test purchas figur 3 histogram indic product particular individu purchas train data test data side depend transact 41 individualspecif weight assum individu exist set k weight gener case weight individualspec denot repres probabl individu enter store transact gener compon k word ik govern individu propens engag shop numer possibl gener make ik depend time discuss ik eect prole coecient individu rel k compon model idea individualspec weight prole key compon propos approach mixtur compon model pk xed share across individu provid mechan borrow strength across individu data contrast individu weight principl allow freeli vari individu within kdimension simplex eect k weight thought basi coecient repres locat individu within space span k basi function compon pk multinomi approach quit similar spirit recent probabilist pca work hofmann 1999 mixtur model text document propos gener mixtur model framework repres document exist within kdimension simplex multinomi compon model given assumpt state far probabl particular transact ij assum gener compon k written kc 1 smooth histogram profil map figur 4 infer eectiv prole global weight smooth histogram individu specic weight individu whose data shown gure 3 kc probabl cth item purchas given compon k n ijc number item categori c purchas individu transact ij compon gener transact ij known mixtur model weight specic individu ik import point context probabl model multinomi model ie mixtur richer probabilist semant simpl multinomi exampl applic idea g ure 3 train data test data particular individu display note predict train test data although test data contain exampl purchas depart 14 seen train data figur 4 plot eectiv prole 1 particular individu estim three dier ent scheme model approach 1 global weight result everyon assign gener prole 2 smooth histogram maximum posterior map techniqu smooth individu train histogram populationbas histogram 3 individu weight tune individu specic behavior detail method provid later paper one see gure 4 global weight prole call eectiv prole sinc predict model mixtur assumpt multinomi plot bar chart howev approxim plot one approxim ect broad populationbas purchas pattern repres individu smooth histogram somewhat better smooth paramet blur individu focu depart 25 individualweight prole appear better represent individu behavior inde provid best predict score test data g ure 3 note individualweight prole gure 4 borrow strength purchas similar cu tomer ie allow small nonzero probabl individu make purchas depart 6 purchas past particular individu weight ik 000 047 038 000 000015 correspond 6 compon model shown gure 2 weight place compon 2 3 6 agre intuit given individu train data 42 learn model paramet unknown paramet model consist paramet k multinomi c individualspec prole weight learn paramet data two main choic either treat paramet unknown use em estim rst learn k multinomi use em determin weight n individu rel previouslylearn basi function disadvantag rst approach clearli may overt data sinc unless larg number transact item per custom end mani paramet observ model appendix outlin three dierent techniqu estim individualspec prole weight includ full em later experiment result section investig rel perform also includ gener baselin version model experi comparison name global weight individ ual weight set common set weight set k weight return em learn mixtur k multinomi intuit expect global weight tune particularli well individu behavior thu perform well individu weight nonetheless parsimoni global weight model may work favor make outofsampl predict guarante individualweight model beat particularli given rel sparsiti data per individu 43 individu histogrambas model also includ baselin comparison simpl smooth histogram model dene convex combin maximum likelihood rel frequenc histogram estim individu multinomi estim directli individu past purchas popul multinomi estim pool popul data idea smooth individu histogram avoid zero probabl item purchas past loos correspond maximum posteriori map strategi tune rel weight term maxim overal logp score test data set eect cheat method limit approach smooth appli individu irrespect much data avail probabl limit eectiv ness model sophist baselin histogram model obtain use fulli hierarch bay ap proach fact method describ paper formul within gener hierarch bayesian framework due space limit omit detail formul 5 experiment result 51 retail transact data evalu mixtur model use realworld transact data set consist approxim 200000 separ transact approxim 50000 dierent individu al individu identi match transact basket item pointofsal use card system data consist identi transact collect number retail store part chain analyz transact store depart level 50 depart categori item name individu depart replac number paper due proprietari natur data 52 experiment setup separ data two time period transact timestamp approxim 70 data rst time period train data remaind test period data train mixtur weight model rst period evalu model term abil predict transact occur subsequ outofsampl test period result report limit attent individu least transact entir timespan data somewhat arbitrari choic intend focu individu hope abl extract predict power train data contain data 4339 individu 58866 transact 164000 item purchas test data consist 4040 individu 25292 transact 69103 item purchas individu test data set appear train data set viceversa individu test data set train data assign global popul model score purpos evalu predict power model calcul logprob logp score transact predict model higher logp score mean model assign higher probabl event actual occur log probabl specic transact individu ie set count item purchas one basket individu mixtur model dene ik note mean neg logp score set tran action divid total number item interpret predict entropi term bit lower entropi term less uncertainti predict bound zero cours correspond zero uncertainti 29313335outofsampl individu 10 transact time split model complex k neg loglikelihood per item figur 5 predict entropi outofsampl transact three dierent individu weight tech niqu function k number mixtur compon 53 perform differ individu profil weight model figur 5 show predict entropi score three dierent individu weight techniqu describ appendix function k number compon mixtur model plot see gener mixtur k 1 perform better singl multinomi model order 20 reduct predict entropi furthermor simplest weight method wts1 accur two method worstperform weight method method allow individu prole weight learn paramet directli em method gave highest likelihood insampl data plot shown clearli overt led wors perform outofsampl wts1 method perform best varieti experi conduct remaind paper focu particular weight techniqu refer result obtain method simpl individ ual weight 54 comparison individu global weight model figur 6 compar outofsampl predict entropi score function number mixtur compon k individu weight global weight individu assign margin mixtur weight map histogram baselin method refer map method solid line better default leftmost point plot somewhat tune individu behavior mixtur model quickli overtak k increas perform individu global weight mixtur steadili improv somewhat atten provid 15 reduct predict uncertainti simpl map approach number mixtur compon k neg loglikelihood per item global weight individu weight map histogram figur plot neg log probabl score per item predict entropi outofsampl transact global individu weight function number mixtur compon k also shown refer score non mixtur map model individu weight systemat better global weight roughli 3 improv predict accuraci figur 7 show detail comparison dierenc individu global weight model contain scatter plot outofsampl total logp score spe cic individu xed valu global weight model systemat wors individu weight model ie point bisect line individu lowest likelihood lower left plot individu weight model consist better typic lower weight total likelihood individu transact item individu prole weight model systemat better individu data ie shop figur 7 contain quit bit overplot top left corner figur 8 show enlarg part region plot level detail clearli see rel low likelihood valu individu prole model systemat better ie individu get better predict individu weight global weight figur 9 show similar focus plot compar score individu weight yaxi map method xaxi stori quit similar individu weight systemat provid better predict note howev scatter plot rel small number individu get better predict smoother model conjectur may due lack sucient regular individu prole method eg may individu buy product never purchas individu weight model eect global weight model logp model figur 7 scatter plot log probabl score individu outofsampl transact plot individu weight versu global weight logp global weight logp individu weight figur 8 close portion plot figur 7 10logp map model logp individu weight figur 9 scatter plot log probabl score individu outofsampl transact plot log probabl score individu weight versu log probabl score map model commit histor data wherea other model hedg bet place probabl mass smoothli 50 depart 55 scalabl experi conduct simpl experi determin methodolog scale comput function model complex record cpu time em algorithm global individu weight function number compon k mixtur model experi carri pentium iii xeon 500mhz 512mb ram page given number iter em algorithm mixtur multinomi linear number compon k number total item n interest see increas model complex might caus algorithm take iter converg thu caus comput time increas rate faster linearli k figur show happen prac tice clear time taken train model scale roughli linearli model complex note also eectiv dierenc comput time global individu weight method ie extra comput comput individu weight neglig 6 applic rank outlier detect visual sever direct applic modelbas approach brie sketch due space lim itat particular use score rank predict custom custom rel high logp score per item predict infor 0model complex number compon k time global weight individu weight figur 10 plot cpu time global individu weight mixtur model function model complex number compon k linear popul multinomi train data purchas custom 2084 probabl test data purchas custom 2084 figur 11 exampl custom automat detect unusu purchas pattern popul pattern top train purchas middl test period purchas bottom mation may use market purpos prole use basi accur personaliza tion forecast futur purchas behavior made percustom basi also use logp score identifi interest unusu purchas behavior individu low per item logp score tend unusu purchas exam ple one lowest rank custom term score test period custom 2084 made sever purchas test period depart 45 interest sinc almost zero purchas individu depart train data figur 11 may well indic unusu behavior individu exampl data may unreli test period data may realli belong custom cluster segment transact data may also perform lower dimension weightspac may lead stabl estim perform cluster directli origin itemspac also develop interact modelbas transact data visual explor tool use mixtur model describ paper basic framework explor predict individu pattern transact data tool allow user visual raw transact data interact explor variou aspect individu past behavior predict futur havior user analyz data use number dierent model includ mixtur model describ paper result compon display compar simpl oper sort rank multinomi probabl possibl final prole form expect rel purchas behavior individu user gener visual ize tool also allow interact simul user prole allow data analyst add hypothet item user transact record eg ad sever simul purchas shoe depart tool updat user prole realtim show aect user probabl purchas item type modelbas interact explor larg transact data set view rststep allow data analyst gain insight understand larg transact data set particularli sinc data set quit dicult captur visual use convent multivari graphic method 7 relat work idea use mixtur model exibl framework model discret categor data known mani year statist literatur particularli social scienc rubric latent class analysi lazarsfeld henri 1968 bartholemew knott 1999 typic method appli rel small lowdimension data set recent resurg interest mixtur multinomi mixtur condit independ bernoulli model model highdimension documentterm data text analysi eg mccallum 1999 homan 1999 market literatur also numer rel sophist applic mixtur model retail data see wedel kamakura 1998 review typic howev focu problem brand choic one develop individu populationlevel model consum behavior term choos rel small number brand eg 10 specic product eg coee work brees heckerman kadi 1998 heckerman et al 2000 probabilist modelbas collabor ltere also similar spirit approach describ paper except focu explicitli treat problem individu prole ie explicit model individu framework work view extens broad famili probabilist model idea specic case transact data deal directli problem make infer specic individu handl multipl transact per individu approach also propos data mine literatur cluster exploratori analysi transact data typic nonprobabilist framework eg strehl ghosh 2000 transact data alway receiv consider attent data mine searcher go back origin work agraw imi lenski swami 1993 associ rule associ rule present dierent approach transact data analysi search pattern indic broad correl associ particular set item work complement associ rule develop explicit probabilist model full joint di tribut rather set disconnect joint condit probabl one way think associ rule inde forecast predict argu modelbas approach propos systemat framework principl integr timedepend factor eg season nonstationar covari measur custom eg knowledg custom age educationallevel infor mation rel systemat fashion note also associ rule algorithm depend fairli critic data rel spars contrast modelbas approach propos rel robust respect degre spars data hand point paper demonstr util approach rel lowdimension problem ie 50 depart descend product hierarchi depart class item way specic product socal sku level 50000 dierent item retail transact databas use paper remain seen whether type probabilist model propos paper comput scale level granular believ mixtur model propos inde extend model full product tree way leav sparsiti data hierarch natur problem tend suggest hierarch bayesian approach play natur role leav discuss topic futur work 8 conclus research describ paper view rst step direct probabilist model transact data among numer extens gener explor integr tempor aspect behavior build simpl stationari poisson model individu extend season nonstationari eect mathemat tempor aspect includ model rather easili exampl tradit model consum behavior rst approxim one model tempor rate process often individu shop independ choic model individu purchas eg see wedel kamakura 1998 factorstyl mixtur model allow singl transact gener multipl compon eg custom may buy shirtsti campingoutdoor cloth transact model product categori hierarchi depart level skulevel brie summar propos gener probabilist framework model transact data illustr feasibl util accuraci approach realworld transact data set experiment result indic propos probabilist mixtur model framework potenti power tool explor visual prole predict transact data paramet estim a1 learn individu weight consid log likelihood function set data point mixtur weight individualspec let denot mixtur model paramet k denot mixtur compon multinomi paramet log similar standard mixtur model use individualspec weight ik learn problem optim loglikelihood respect paramet consist mixtur compon paramet k individu weight ik subject set n constraint addit dene global weight model addit constraint individualspec weight equal global set weight particular loglikelihood optim use expectationmaxim em algorithm q function becom equat p ijk repres classposterior transact evalu use old set paramet q function similar q function standard mixtur model differ individu weight use place global weight addit constraint exist set individu weight optim q function respect mixtur compon paramet k depend weight ik depend old weight p ijk though therefor optim unchang optim respect ik set lagrang multipli lead follow intuit updat equat reduc standard equat global weight use sinc model individu weight larg number paramet may overt data consid sever dierent methodolog calcul weight 1 global weight standard mixtur model 2 wts1 model weight constrain equal em global set weight togeth mixtur compon paramet learn compon learn individualspec weight learnt singl em iter use q function individualspec weight 3 wts2 model similar wts1 model instead singl iter perform second em algorithm individu weight mixtur compon weight learn eectiv model consist two consecut em algorithm one learn mixtur compon paramet anoth learn individu weight 4 wts3 model full em algorithm use mixtur compon weight individu weight updat iter method describ repres valid em algorithm sinc updat equat alway deriv appropri q function therefor loglikelihood guarante increas iter consequ algorithm guarante converg within standard em limit a2 gener paramet run em algorithm em algorithm alway start 10 random initi random start point run highest likelihood solut chosen paramet initi sampl dirichlet distribut use singl cluster paramet hyperprior equival sampl size 100 em iter halt whenev rel chang log likelihood less 001 100 iter practic result paper algorithm typic converg 001 criterion within 20 40 iter never exceed 70 iter a3 acknowledg research describ paper support part nsf career award iri9703120 work ic support microsoft graduat research fellowship a4 r mine associ rule set item larg databas data mine framework optim product select retail supermarket data gener profset model latent variabl model factor analysi depend network ferenc journal machin learn research person supermarket product recommend latent structur analysi market segmen tation conceptu methodolog foundat tr mine associ rule set item larg databas probabilist latent semant index data mine framework optim product select retail supermarket data person supermarket product recommend depend network infer collabor filter data visual ctr chidanand apt bing liu edwin p pednault padhraic smyth busi applic data mine commun acm v45 n8 august 2002 ella bingham heikki mannila jouni k seppnen topic 01 data proceed eighth acm sigkdd intern confer knowledg discoveri data mine juli 2326 2002 edmonton alberta canada chunnan hsu haohsiang chung hanshen huang mine skew spars transact data person shop recommend machin learn v57 n12 p3559 octobernovemb 2004