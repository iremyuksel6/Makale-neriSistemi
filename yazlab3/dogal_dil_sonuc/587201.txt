solut equal constrain quadrat program problem aris optim consid applic conjug gradient method solut larg equal constrain quadrat program aris nonlinear optim approach base implicitli reduc linear system gener iter null space constraint instead comput basi null space choos work directli matrix constraint gradient comput project null space either normal equat augment system approach unfortun practic project result signific round error propos iter refin techniqu well adapt reformul quadrat problem greatli reduc error without incur high comput overhead numer result illustr efficaci propos approach present b introduct varieti algorithm nonlinearli constrain optim 7 8 12 29 31 use conjug gradient cg method 25 solv subproblem form minim x subject nonlinear optim nvector c usual repres gradient rf object function gradient lagrangian n theta n symmetr matrix h stand either hessian lagrangian approxim solut x repres search direct equal constraint 12 obtain linear constraint optim problem current iter assum theta n full row rank constraint 12 constitut linearli independ equat also assum conveni h posit definit null space constraint guarante 1112 uniqu solut posit definit assumpt need trust region method discuss also valid context trust region method normal termin cg iter soon neg curvatur encount see 36 38 contrast 23 use iter method cg attract larg scale optim number variabl larg cost effect solv 11 12 approxim increas accuraci solut iter optim algorithm approach minim addit properti cg method merg well requir global converg optim method see eg 36 paper studi appli precondit cg method 11 12 keep comput cost reason level ensur round error degrad perform optim algorithm quadrat program 1112 solv comput basi z null space use basi elimin constraint appli cg method reduc problem argu howev due form precondition use practic explicit use z caus iter expens signific save achiev mean approach bypass comput z altogeth price pay altern give rise excess roundoff error slow optim iter may even prevent converg shall see error caus constraint 12 satisfi desir accuraci describ iter refin techniqu improv accuraci solut highli illcondit problem also propos mechan redefin vector c adapt chang solut quadrat problem favor numer properti notat throughout paper k delta k stand 2 matrix vector norm gnorm vector x defin x gx g given positivedefinit matrix denot floatingpoint unit roundoff machin precis ffl let denot condit number ie nonzero singular valu 2 cg method linear constraint common approach solv linearli constrain problem elimin constraint solv reduc problem cf 17 20 specif suppos z n theta n gamma matrix span null space column togeth column z span r n solut x linear equat 12 written vector x constraint 12 yield determin vector x substitut 21 11 omit constant term constant see x z solv reduc problem minim x z2 assum reduc hessian h zz posit definit 23 equival linear system appli conjug gradient method comput approxim solut problem 23 equival system 24 substitut 21 obtain approxim solut quadrat program 1112 strategi comput normal compon x exactli tangenti compon zx z inexactli compat requir mani nonlinear optim algorithm need ensur linear constraint satisfi remain throughout remaind optim calcul cf 20 let us consid practic applic cg method reduc system 24 well known precondit improv rate converg cg iter cf 1 therefor assum precondition w zz given w zz symmetr posit definit matrix dimens might chosen reduc span cluster eigenvalu w gamma1 could result automat scale variabl 7 29 regardless w zz defin precondit conjug gradient method appli 24 follow see eg 20 algorithm precondit cg reduc system choos initi point x z comput r zz r z p gammag z repeat follow step termin test satisfi r z z zz r z gammag z z g z r z r z iter may termin exampl r z zz r z suffici small approxim solut obtain must multipli z substitut 21 give approxim solut quadrat program 1112 altern may rewrit algorithm multipl z addit term x perform explicitli cg iter introduc follow algorithm nvector x algorithm ii precondit cg expand form reduc system choos initi point x satisfi 12 comput gammag repeat follow step converg test satisfi x main algorithm studi paper sever type stop test use sinc choic depend requir optim method shall discuss numer test report paper use quantiti r zz r z termin cg iter note vector g call precondit residu explicitli defin rang z result exact arithmet search direct gener algorithm ii also lie rang z thu iter x satisfi 12 round error comput 217 may caus p compon outsid rang z compon normal small caus difficulti 3 implement project cg method algorithm ii constitut effect method comput solut 1112 success use variou algorithm larg scale optim cf 16 28 39 main drawback need nullspac basi matrix z whose comput manipul costli sometim give rise unnecessari illcondit 9 10 18 24 33 37 difficulti becom appar describ practic procedur comput z consid type precondition w zz use practic let us begin first issu 31 comput basi null space mani possibl choic nullspac matrix z possibl best strategi choos z orthonorm column provid well condit represent null space howev comput nullspac matrix expens number variabl larg essenti requir comput spars lq factor implicit explicit gener q alway believ rather expens compar altern describ 24 recent research 30 35 suggest fact possibl gener q product spars household matric cost may reason experi approach howev knowledg gener purpos softwar implement yet avail anoth possibl tri comput basi nullspac involv nonzero possibl although problem comput hard 9 suboptim heurist possibl still rather expens 10 18 33 37 econom altern base simpl elimin variabl 17 20 defin z first group compon x basic depend variabl simplic assum first variabl partit theta basi matrix b assum nonsingular defin gammab clearli satisfi linearli independ column practic z form explicitli instead comput store spars lu factor 13 b comput product form zv z v mean solv use lu factor ideal would like choos basi b spars possibl whose condit number significantli wors requir difficult achiev simpli ensur b well condit difficult task choos basi deleg spars lu factor algorithm ma48 15 recent code see eg 19 design comput wellcondit basi known us extent reach object 32 precondit potenti drawback nullspac basi 31 suffici seriou prevent effect use algorithm ii howev consid practic choic precondit matrix w zz one expos weak approach ideal one would like choos w zz w gamma1 thu zz perfect precondition howev unlik z hz invers spars matric even z hz small dimens form quit costli therefor oper ideal precondition normal question paper consid precondition form zz g symmetr matrix z gz posit definit suggest choos g made 32 two particularli simpl choic first choic appropri h domin diagon case exampl barrier method constrain optim handl bound constraint l x u ad term form gamma object function posit barrier paramet choic aris sever trust region method constrain optim 7 12 29 precondition deriv chang variabl thu given zz regardless choic g precondition 33 requir oper invers matrix z gz applic 16 39 z defin 31 simpl enough structur form factor n gamma theta n gamma matrix z gz expens g simpl form lu factor b spars number constraint larg form z gz may rather costli even requir solut 2m triangular system lu factor case prefer form z gz rather comput product form z solv z use cg method inner cg iter employ 29 effect problemsparticularli number degre freedom small fail z badli condit tend expens moreov sinc matrix z gz known explicitli difficult construct effect precondition acceler inner cg iter summari precondition form 33 z defin mean 31 comput 215 precondit residu g often expens domin cost optim algorithm goal paper consid altern implement algorithm ii whose comput cost moder predict approach avoid use nullspac basi z altogeth 33 comput project see bypass comput z let us begin consid simpl case precondition w zz given 34 p z denot orthogon project oper onto null space precondit residu 215 written project perform two altern way first replac p z equival formula thu replac 36 express solut note 310 normal equat follow v solut least squar problem minim desir project g correspond residu approach implement use choleski factor aa second possibl express project 36 solut augment system r system solv mean symmetr indefinit factor use 1 theta 1 2 theta 2 pivot 21 let us suppos precondition gener form 33 precondit residu 215 requir comput may express g nonsingular found solut g r whenev z gz nonsingular see eg 20 section 541 314 far appeal g gamma1 simpl form 315 use gener 312 clearli system 312 may obtain 315 set perfect precondition result choic g also possibl requir z gz posit definit idea use project 37 cg method date back least 34 altern 315 special case 312 propos 8 although 8 unnecessarili requir g posit definit recent studi precondit project cg method 11 hereaft shall write 215 p project oper mention note 38 312 315 make use null space matrix z requir factor matric involv unfortun give rise signific roundoff error particularli cg iter approach solut difficulti caus fact iter proceed project vector increasingli small r inde optim condit quadrat program 1112 state solut x satisfi lagrang multipli vector vector hx c denot r algorithm ii gener stay bound away zero indic 316 becom increasingli closer rang word r tend becom orthogon z henc 313 precondit residu g converg zero long smallest eigenvalu z gz bound away zero discrep magnitud caus numer difficulti appar 39 show signific cancel digit usual take place gener harm roundoff error also appar 312315 small remain compon v remain larg sinc magnitud error gener solut 312315 govern size larg compon v vector g contain larg rel error argument made precis next section exampl 1 appli algorithm ii solv problem cvxeqp3 cute collect 4 subsequ experi use simpl precondition 34 correspond choic use normal equat 38 augment system 312 approach comput project result given figur 1 plot residu r g function iter number case cg iter termin r g becam neg indic sever error occur sinc r must positivecontinu iter past point result oscil norm gradient without signific improv iter 50 run r order 10 5 wherea project g figur also plot cosin angl precondit residu g row precis defin ith row note cosin zero exact arithmet increas indic cg iter leav constraint manifold sever error uncommon optim calcul see x7 27 grave concern may caus underli optim algorithm behav errat fail paper propos sever remedi one base adapt redefinit r attempt minim differ magnitud also describ sever form iter refin project oper techniqu motiv roundoff error analysi given next 4 analysi error present error bound support argument made previou section particularli claim problemat situat occur latter stage pcg augment system iter resid co pcg normal equat iter resid co figur 1 conjug gradient method two option project iter g converg zero r simplic shall assum henceforth scale shall consid simplest possibl precondition oppos exact quantiti denot subscript c let us first consid normal equat approach given 39 310 solv mean choleski factor aa finit precis instead exact solut v normal equat obtain v error deltav recal ffl denot unit roundoff condit number studi total error project vector g simplifi analysi ignor error aris comput matrixvector product v subtract given 39 error domin error v whose magnitud estim 41 assumpt 39 comput project exact project 1 bound 41 assum error format aa ar backsolv use choleski factor reason assumpt context also note 41 sharpen replac term possibl diagon scale thu error project lie entir rang 41 rel error project satisfi error signific larg larg let us consid ratio 44 case kr much larger project 39 kr assumpt suppos inequ achiev 44 give simpler interpret 44 thu conclud error project 43 larg either ratio kr larg condit number moder contribut ratio 44 rel error 43 normal larg enough caus failur optim calcul condit number grow loss signific digit becom sever especi sinc appear squar 43 exampl 1 mention ratio 44 order o10 6 iter 50 bound 43 indic could correct digit g stage cg iter agreement test point cg iter could make progress let us consid augment system approach 315 focu choic precondit residu comput solv r use direct method number method strategi bunch kaufman 5 duff reid 14 best known exampl dens spars matric respect form ldl factor augment matrix ie matrix appear left hand side 45 l unit lower triangular block diagon 1 theta 1 2 theta 2 block approach usual alway stabl normal equat ap proach improv stabil method bjorck 2 suggest introduc paramet ff solv equival system r error analysi 3 show j depend n growth factor factor oe 1 nonzero singular valu import notic aand 2 aenter bound ff oe method give solut never much wors obtain tight perturb analysi therefor consid stabl practic purpos approxim oe difficult common simpli use case concern us kg converg zero kv term insid last squar bracket 47 approxim kv k obtain assum ff 1 interest compar bound 43 see ratio 44 play crucial role analysi augment system approach like give accur solut method normal equat case state categor howev sinc size factor j difficult predict residu updat strategi describ x6 aim minim contribut ratio 44 see highli benefici effect algorithm ii present discuss variou iter refin techniqu design improv accuraci project oper 5 iter refin iter refin known effect procedur improv accuraci solut obtain method backward stabl consid use context normal equat augment system approach 51 normal equat approach let us suppos choos comput project p r normal equat approach 39310 appeal idea tri improv accuraci comput appli project repeatedli therefor rather comput 215 let project appli mani time necessari keep error small motiv multipl project techniqu stem fact comput project small compon consist entir round error outsid null space describ 42 therefor appli project p first project c give improv estim ratio 44 much smaller repeat process may hope obtain improv accuraci multipl project techniqu may simpli describ set g perform follow step solv set l choleski factor aa note method appropri although simpl variant possibl g diagon exampl 2 solv problem given exampl 1 use multipl project everi cg iter measur cosin 317 angl g column cosin greater 10 gamma12 multipl project appli cosin less valu result given figur 2 show residu r g reduc much plane cg iter figur 1 inde ratio final initi valu r g 10 gamma16 satisfactori straightforward analyz multipl project strategi 5152 provid make simplifi assumpt round error make form l solv 51 obtain follow result prove induct 41 simpl consequ 5354 assumpt norm one thu error converg rlinearli zero rate cours rate sustain indefinit error ignor 5152 becom import nonetheless one would expect 55 reflect true behaviour kg small multipl unit roundoff ffl iter residu figur 2 cg method use multipl project normal equat approach stress howev approach still limit fact condit number appear squar 55 improv guarante also note multipl project almost ident form numer properti fix precis iter refin least squar problem 3 p125 fix precis iter refin appropri approach chosen comput project stabl see compar 43 perturb analysi least squar problem 3 theorem 146 give depend condit number linearnot quadrat moreov sinc multipli kg small effect condit number much smaller 57 43 mention two iter refin techniqu one might consid either effect practic context first use fixedprecis iter refin 3 section 29 attempt improv solut v normal equat 310 howev gener unsuccess fixedprecis iter refin improv measur backward stabil 21 p126 choleski factor alreadi backward stabl method perform numer test found improv strategi howev well known iter refin often succeed extendedprecis use evalu residu could therefor consid use extend precis iter refin improv solut v normal equat 310 long residu 310 smaller one norm expect error solut 310 decreas factor ffl 2 reach offl sinc optim algorithm normal use doubl precis arithmet comput extend precis may simpl effici strategi suitabl gener purpos softwar reason consid use extend precis 5152 iter refin least squar problem 52 augment system approach appli fix precis iter refin solut obtain augment system 315 give follow iter comput solv g deltag ae g ae v updat note method applic gener precondition g appropri valu ff hand incorpor iter describ 46 gener analysi higham 26 theorem 32 indic condit number larg expect high accuraci v good accuraci g case exampl 3 solv problem given exampl 1 use iter refin techniqu case multipl project discuss exampl 2 measur angl g column everi cg iter iter refin appli long cosin angl greater 10 gamma12 result given figur 3 observ residu r g decreas almost much multipl project approach attain accept small valu point howev residu increas reach valu 10 gamma10 cg iter continu hundr iter residu exhibit larg oscil return x61 experi 1 iter refin step normal enough provid good accu raci encount case 2 3 step benefici 6 residu updat strategi seen signific roundoff error occur comput project residu vector much smaller residu r describ procedur iter residu figur 3 cg method use iter refin augment system approach redefin r norm closer g dramat reduc roundoff error project oper begin note algorithm ii theoret unaffect immedi comput r 214 redefin equival due condit fact r use 215 216 follow redefin r mean 61 either normal equat approach 38313 augment system approach 312315 result would theori unaffect freedom redefin r seek valu minim g symmetr matrix z gz posit definit g gamma1 gener invers g vector solv 62 obtain give rise follow modif cg iter algorithm iii precondit cg residu updat choos initi point x satisfi 12 comput find vector minim krgammaa comput set gammag repeat follow step converg test satisfi x procedur work well practic improv ad iter refin project oper case 1 2 iter refin step use notic simpl interpret step 66 67 first obtain solv 62 indic requir valu 315 315 may rewritten g thu obtain g step 67 instead found solv 611 advantag use 611 compar 315 solut latter may domin larg compon v former g larg componentsof cours float point arithmet zero compon solut 611 instead tini round valu provid 611 solv stabl fashion view way see step 66 67 actual limit form iter refin comput v comput g discard use refin solut iter semirefin use context 6 22 anoth interest interpret reset r r gamma perform start algorithm iii parlanc optim c gradient object function 11 r gamma gradient lagrangian problem 1112 vector comput 62 call least squar lagrang multipli estim common alway case optim algorithm set 62 comput multipli thu algorithm iii propos initi residu set current valu gradient lagrangian oppos gradient object function one could ask whether suffici reset r begin algorithm iii omit step 66 subsequ iter comput experi show even though initi reset r reduc magnitud suffici avoid error first cg iter subsequ valu r grow round error may reappear strategi propos algorithm iii safe ensur r small everi iter one think variou altern one monitor norm r appli residu updat seem grow 61 case particularli effici implement residu updat strategi note 62 precis object least squar problem 311 occur comput via normal equat approach therefor desir valu noth vector v 310 312 furthermor first block equat 312 show r therefor case 66 replac r 67 word appli project oper twice special case multipl project approach describ previou section base observ propos follow variat algorithm iii requir one project per iter note 66 written rather perform project defin r g project residu comput previou iter result iter given algorithm iii follow two chang omit replac 610 g g r strategi perform well numer experi avoid extra storag comput requir algorithm iii show mathemat equival algorithm iii turn mathemat equival algorithm ii argument follow make use fact first iter clearli algorithm iii except valu store r last step r us consid effect next iter numer definit 63 ff becom g equal r p g thu formula ff theoret unchang advantag never neg case 63 round error domin project oper next step differ valu calcul algorithm iii step 66 omit new variant algorithm iii project residu calcul 67 p p r ffhp mathemat equival valu pp r ffhp calcul algorithm iii recal 66 written new strategi appli doubl project r final let us consid numer 68 new variant given wherea algorithm iii given expand express see formula fi mathemat equival case new variant project appli select exampl 4 solv problem given exampl 1 use residu updat strategi result given figur 4 show normal equat augment system approach equal effect case plot cosin 317 angl precondit residu column small approach tend grow iter progress normal equat approach cosin order 10 gamma14 throughout cg iter augment system approach order 10 gamma15 note obtain higher accuraci iter refin strategi describ previou section compar figur 2 3 augment system iter residu normal equat iter residu figur 4 conjug gradient method residu updat strategi obtain highli reliabl algorithm case combin residu updat strategi describ iter refin project oper give rise follow iter use numer test report x7 algorithm iv residu updat iter refin choos initi point x satisfi 12 comput project comput normal equat 38 augment system 312 approach set gammag choos toler max repeat follow step converg test satisfi x appli iter refin p r 317 less conclud discuss elabor point made exampl 4 concern comput steplength paramet ff note formula prefer 612 sinc give rise cancel similarli stop test base g g rather g r residu updat implement algorithm iv chang automat believ express recommend implement cg iter provid precondition base test repeat comput report exampl use augment system approach see figur 1 chang algorithm ii use new ff stop test cg iter abl continu past iter 70 abl reach valu also repeat calcul made exampl 3 residu reach level larg oscil residu mention exampl 3 longer took place thu case altern express ff stop test benefici 62 gener g also improv upon effici algorithm iii gener g use slightli outdat inform idea simpli use obtain comput g 67 suitabl rather wait follow step 65 obtain slightli uptod version result iter given algorithm iii follow two chang omit replac 610 g g r r obtain biproduct 67 notic howev gener g extra matrixvector product v requir sinc longer relationship exploit although experi idea prove benefici similar circumst 22 7 numer result test efficaci techniqu propos paper collect quadrat program form 1112 problem gener last iter interior point method nonlinear program describ 7 method appli set test problem cute 4 collect appli cg method precondition 34 ie solv quadrat program use augment system normal equat approach comput project compar standard cg iter stand iter refin ir techniqu describ x5 residu updat strategi combin iter refin updat given algorithm iv result given tabl 1 first column give problem name second dimens quadrat program test reliabl techniqu propos paper use demand stop test cg iter termin experi includ sever stop test cg iter typic use trust region method optim termin number iter exce 2n gamma denot dimens reduc system 24 superscript 1 tabl 1 indic limit reach cg iter also stop length solut vector greater trust region radiu set optim method see 7 us superscript 2 indic safeguard activ note problem excess round error trigger final termin p hp 0 indic 3 r g 0 indic 4 note standard cg iter abl meet stop test problem tabl 1 iter refin updat residu success case tabl 2 report cpu time problem tabl 1 note time standard cg approach stand interpret caution sinc problem termin prematur includ time standard cg iter show iter refin residu updat strategi greatli increas cost cg iter next report 3 problem stop test could met variant three problem tabl 3 provid least residu norm attain strategi final indirect test techniqu propos paper report result obtain interior point nonlinear optim code describ 7 29 nonlinear program problem cute collect code appli cg method solv quadrat program iter use augment system augment system normal equat problem dim stand ir updat stand ir updat corkscrw 147 coshfun optctrl6 tabl 1 number cg iter differ approach 1 indic iter limit reach 2 indic termin trust region bound 3 indic neg curvatur detect 4 indic r augment system normal equat problem dim stand ir updat stand ir updat coshfun optctrl6 tabl 2 cpu time second 1 indic iter limit reach 2 indic termin trust region bound 3 indic neg curvatur detect 4 indic r augment system normal equat problem dim stand ir updat stand ir updat obstcla 900 23d07 15d07 55d08 23d07 99d08 42d08 tabl 3 least residu norm r g attain option normal equat approach comput project strategi tri standard cg iter stand residu updat strategi updat iter refin describ algorithm iv result given tabl 4 feval denot total number evalu object function nonlinear problem project repres total number time project oper perform optim indic optim algorithm unabl locat solut note total number function evalu roughli strategi case differ cg iter caus algorithm follow differ path solut expect solv nonlinear problem note augment system approach residu updat strategi chang number project significantli problem improv substanti hand observ normal equat approach sensit condit number residu updat strategi give substanti reduct number project half problem interest residu updat perform augment system normal equat approach similar 8 conclus studi properti project cg method solv quadrat program problem form 1112 due form precondition use nonlinear program algorithm opt comput basi z null space constraint instead project cg iter use normal equat augment system approach given exampl show either case signific roundoff error occur present explan propos sever remedi one use iter refin augment system normal equat approach altern updat residu everi iter cg iter describ x6 latter implement particularli effici precondition given 33 numer experi indic updat residu almost alway suffic keep error toler level iter refin techniqu effect updat residu use conjunct numer result report paper indic combin strategi econom accur 9 acknowledg author would like thank andi conn philipp toint help input earli stage research augment system normal equat f eval project f eval project problem n stand updat stand updat stand updat stand updat corkscrw 456 350 64 61 458 422 coshfun gausselm 14 11 25 26 92 93 28 41 85 97 hager4 2001 1000 obstcla 1024 0 26 26 6233 6068 26 26 6236 6080 optcntrl optctrl6 122 tabl 4 number function evalu project requir optim method differ implement cg iter r iter solut method cute constrain unconstrain test environ stabl method calcul inertia solv symmetr linear equat linear least squar solut houshold transfor mation primal primaldu method nonlinear program linearli constrain optim project precondit conjug gradient null space problem complex null space problem ii algorithm precondit conjug gradient approach linear equal constrain minim global converg theori gener trustregion base algorithm equal constrain optim direct method spars matric multifront solut indefinit spars symmetr linear equat design ma48 practic method optim comput spars basi nullspac snopt sqp algorithm largescal constrain optim practic optim matrix comput iter method illcondit linear system optimiza tion solv trustregion subproblem use lanczo method spars orthogon scheme structur optim use forc method method conjug gradient solv linear system iter refin lapack implicit nullspac iter method constrain least squar problem implement algorithm largescal equal constrain optim multifront comput orthogon factor spars matric indefinit precondit inexact newton method larg spars equal constrain nonlinear program problem precondit reduc matric substructur method comput null space equilibrium matric conjug gradient method extrem problem qr factor larg spars overdetermin squar matric multifront method multiprocess environ conjug gradient method trust region larg scale optimiza tion nest dissect spars nullspac base toward effici sparsiti exploit newton method minim largescal nonlinear network optim tr ctr luca bergamaschi jacek gondzio manolo venturin giovanni zilli inexact constraint precondition linear system aris interior point method comput optim applic v36 n23 p137147 april 2007 h dollar n gould w h schilder j wathen use constraint precondition regular saddlepoint problem comput optim applic v36 n23 p249270 april 2007 luca bergamaschi jacek gondzio giovanni zilli precondit indefinit system interior point method optim comput optim applic v28 n2 p149171 juli 2004 bocanegra f f campo r oliveira use hybrid precondition solv largescal linear system aris interior point method comput optim applic v36 n23 p149164 april 2007 nichola gould dominiqu orban philipp l toint galahad librari threadsaf fortran 90 packag largescal nonlinear optim acm transact mathemat softwar tom v29 n4 p353372 decemb cafieri dapuzzo v simon serafino iter solut kkt system potenti reduct softwar largescal quadrat problem comput optim applic v38 n1 p2745 septemb 2007 nichola gould philipp l toint iter workingset method largescal nonconvex quadrat program appli numer mathemat v43 n12 p109128 octob 2002 meizhong dai david p schmidt adapt tetrahedr mesh freesurfac flow journal comput physic v208 n1 p228252 1 septemb 2005 silvia bonettini emanuel galligani valeria ruggiero inner solver interior point method larg scale nonlinear program comput optim applic v37 n1 p134 may 2007