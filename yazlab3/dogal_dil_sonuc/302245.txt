likelihood ratio deriv estim finitetim perform measur gener semimarkov process paper investig likelihood ratio method estim deriv finitetim perform measur gener semimarkov process gsmp develop readili verifi condit applic method condit mainli place restrict basic build block ie transit probabl distribut densiti function event lifetim initi distribut gsmp contrast structur condit need infinitesim perturb analysi explicitli show condit hold mani practic set particular larg class queue reliabl model one intermedi result obtain studi independ valu formal show random variabl repres number occur event gsmp finit time horizon finit exponenti moment neighborhood zero b introduct run simul one often interest estim deriv perform measur respect paramet input distribut eg rout probabl time distribut servic time distribut queue network lifetim distribut repair time distribut compon reliabl model one reason comput deriv estim use sensit analysi exampl reliabl context design system may want determin focu design effort improv overal system perform addit effici deriv estim play import role simulationbas optim algorithm eg see glynn 1986 1989a one approach estim deriv via simul likelihood ratio method also call score function method eg see aleksandrov sysoyev shemeneva 1968 arsham et al 1989 glynn 19861989a1990 reiman weiss 19861989 rubinstein 19861989 lecuy 19901995 nakayama goyal glynn 1994 nakayama 1995 overview techniqu may found bratley fox schrage 1987 glynn 1987 lecuy 1991 rubinstein shapiro 1993 valid techniqu establish explicitli certain perform measur class discret space discretetim markov chain glynn 1986 discretespac continuoustim markov chain reiman weiss 1989 nakayama goyal glynn 1994 generalst space markov chain regen structur also call harri chain glasserman glynn 1992 perform measur studi mainli transient one perform measur base behavior stochast process time interv begin length either fix random stoppingtim steadyst perform measur studi insofar express function stoppingtim base transient perform measur use regen structur main impedi verifi valid lie justifi interchang deriv expect requir method lecuy 19901995 reiman weiss 1989 rubinstein shapiro 1993 gener condit ensur interchang justifi howev condit difficult verifi mani specif context paper establish condit readili verifi mani context valid likelihood ratio method set gener semimarkov process gsmp gsmp gener mathemat framework model mani discreteev system consider amount work studi differ aspect class stochast process eg see shassberg 1976 whitt 1980 glynn 1989b haa shedler 1987 glasserman yao 1992a 1992b also dynam close follow eventdriven simul gsmp use model system analyz simul studi variou simul methodolog eg see glynn iglehart 1988 glasserman 1991a glasserman yao 1992c paper use gsmp framework studi likelihood ratio deriv estim method appli finitetim perform measur ie perform measur expect random variabl determin fix time gener gsmp framework enabl us verifi applic likelihood ratio deriv estim method larg class reliabl queue model fact whole project initi motiv need simulationbas deriv estim larg class reliabl model type heildelberg shahabuddin nicola 1994 nicola nakayama heildel beger goyal 1993 nicola shahabuddin heidelberg glynn 1993 nonmarkovian version model construct analyz save softwar packag blum et al 1993 altern method estim deriv use simul infinitesim perturb analysi ipa eg see ho cao 1983 heidelberg et al 1988 glasserman 1991a glasserman 1991a1991b1991c establish condit method give rise unbias estim deriv finitetim perform measur gsmp one main differ condit ipa condit likelihood ratio method impos restrict basic build block ie transit probabl distribut densiti function event lifetim initi distribut gsmp wherea ipa relat underli structur gsmp give exampl larg class stochast model one justifi valid likelihood ratio method ipa due limit pose structur condit hand ipa method admit larger class eventtim distribut likelihood ratio method also varianc likelihood ratio method deriv estim grow quit fast length observ increas eg see glynn 1987 result set discretetim markov chain thu larg time horizon likelihood ratio method statist ineffici estim deriv ipa deriv estim suffer drawback rest paper organ follow section 2 contain descript gsmp model work section 3 review basic idea likelihood ratio method estim deriv section also provid proof valid method gsmp set set technic condit one intermedi result deriv show random variabl repres number occur event gsmp 0 finit exponenti moment around neighborhood zero done bound gsmp agedepend branch process use result finit exponenti moment branch process section 4 give simpl suffici condit condit section 3 hold particular show condit hold mani set aris practic final section 5 explicitli demonstr condit section 3 hold certain class reliabl model queue network model mathemat model model evolut stochast system gener semimarkov process gsmp describ develop model close follow glasserman 1991a approach denot physic state space process assum either finit countabl infinit exampl context multiclass queue network state contain inform number custom type station along descript queue variou station let denot set event exampl multiclass queue network event complet servic extern custom arriv station make follow assumpt a1 set finit case assumpt satisfi infiniteserv queue state 2 defin es set activ event state ie event may occur system state queueingsystem exampl servicecomplet event particular queue possibl state server queue busi introduc scalar paramet respect deriv comput exampl might repres mean arriv time custom rout probabl queue network comput deriv want evalu deriv paramet valu theta open set easili extend set calcul deriv respect scalarvalu paramet work comput gradient respect vectorvalu paramet consid separ event e 2 let f denot distribut use gener event time e paramet valu assum distribut function f densiti f respect lebesgu measur f 0 initi state chosen use probabl mass function delta given state select initi state gener event time event e 2 es f 2 theta 2 e 2 let p delta e probabl mass function paramet valu system current state 2 event e 2 es occur system immedi move new state 0 2 probabl ps call transit probabl gener theori gsmp allow gener eg see glynn 1989b state 2 defin set possibl clock read identifi jajdimension vector write c system state clock ce activ event e 2 es run rate 0 e 1 assum e 0 e 2 es applic let e assum valu 1 allow greater model capabl exampl model preemptiv servic set servicecomplet event preempt state assum clock rate bound ie exist constant 1 clock rate e 2 e 2 applic a2 hold one exampl infinitecapac open queue system rate server process custom proport queue length assum state 2 least one activ event e 2 es given system current state clock vector c defin hold time current state also defin event trigger transit current state sinc clock time continu distribut two clock never equal probabl one paramet valu state 0 2 event e 2 let cs denot set event activ state cancel upon transit state 0 trigger event e defin set new event n set old event os respect transit state state 0 trigger event e new event e 0 new clock valu ce 0 gener distribut f also old event updat new clock valu ce immedi enter state 0 cancel event e 0 2 cs origin activ state may longer activ state 0 note allow possibl cancel event e 0 immedi reactiv ie e e case new clock valu immedi gener event e 0 defin discretetim markov process fy nth state visit c n vector clock read nth transit state space process s2 fsg theta cs transit probabl follow ae sigma form fix possibl infinit real number transit probabl c paramet valu c 1fbg indic function probabl event fbg defin continuoustim gsmp piecewiseconst process stay state n interv length precis let epoch nth transit notat simplic defin e number transit occur time 0 defin gsmp let p denot probabl measur govern gsmp paramet valu expect oper induc p space gsmp let f denot filtrat gsmp determinist loos speak histori process time eg see section 36 billingsley 1986 let fft perform measur v f measur random variabl interest estim deriv fft paramet probabl measur gsmp fix expect oper induc p 0 impos restrict random variabl v a3 exist constant h 0 v 0 j almost 2omega 2 h exist random variabl w w 0 probabl 1 2 show section 4 mani perform measur interest satisfi condit 3 likelihood ratio deriv method section review likelihood ratio method estim evalu paramet valu comput like bring deriv oper insid expect howev expect oper depend care must taken assum p absolut continu respect p 0 restrict filtrat f z z lt radonnykodym deriv p respect p 0 restrict filtrat f simpli likelihood ratio absolut continu respect anoth probabl measur q 2 set q 2 measur 0 also q 1 measur 0 eg see section 32 billingsley 1986 known chang measur glynn 1989 damerdji 1994 establish valid gsmp certain context thu express perform measur fft expect random quantiti taken respect probabl measur independ paramet key question remain whether bring deriv oper insid expect ie whether assumpt a1 lecuy 1990 assumpt a1 0 k lecuy 1995 see also rubinstein shapiro 1993 provid condit 2 hold gener probabl space howev specif context gsmp difficult verifi directli answer interchang question gsmp set let us first determin exact form likelihood ratio lt heurist likelihood ratio lt given see glynn iglehart 1989 detail howev version likelihood ratio use would need restrict condit distribut function f justifi interchang deriv expect exampl would chang a5 altern requir f uniformli 0 1 even satisfi f exponenti distribut mean 1 get around instead work slightli modifi gsmp lead differ likelihood ratio alter distribut v chang distribut clock time gener e 2 defin new distribut function recal time horizon note f x e mix continu discret distribut f x e x point mass probabl f e point one event occur time use rule want deal exampl order set event manner one event occur time take lowest event occur event determin next physic state visit etc case origin modifi gsmp ie process z defin previou section distribut sampl path 0 sinc v depend sampl path gsmp time 0 ie f measur use new distribut gener clock time chang distribut v appli approach requir mild condit distribut function f prove interchang new likelihood ratio given assum 2 hold see appli product rule differenti yield give deriv likelihood ratio express similar 3 case fix number transit contrast fix time horizon also glynn establish valid interchang deriv expect likelihood ratio deriv method appli gsmp develop condit basic build block gsmp 2 valid later give section 4 easili verifi suffici condit follow condit hold first impos regular condit densiti gener event lifetim a4 event e 2 exist h 0 set f e independ 2 a5 event e 2 f e 6 ffl 0 exist h 0 uniformli f e a6 event e 2 f e 6 exist h 0 f delta e differenti f e 2 delta uniformli bound f e theta note condit a4 permit support distribut lifetim event e depend thu exampl disallow event e uniform distribut support 0 present properti impli previou condit f proof lemma may found appendix let assum condit a4a6 hold exist h 0 f e independ 2 ii event e 2 uniformli 0 iii event e 2 0 iv event e 2 differenti 2 f e delta bound impos regular condit initi distribut a7 exist h 0 set independ a8 ffl 0 exist h 0 uniformli exist h 0 delta differenti 2 uniformli bound theta final impos regular condit transit probabl exist h 0 set 0g independ 2 a11 ffl 0 exist h 0 uniformli p exist h 0 p delta delta delta differenti p 2 delta uniformli bound p theta sens condit a4a12 ensur basic build block gsmp wellbehav function neighborhood 0 establish valid 2 theorem 1 condit a1a12 hold v lt differenti 2 valid show theorem 1 hold first need prove follow result independ valu condit a1 a2 a4 a5 hold exist constant z 0 0 proof observ nt distribut whether use f gener lifetim event e 2 henc work f case system event cancel show result use method employ proof corollari 33 glasserman 1991a theorem 21 page 155 prabhu 1965 use result renew theori system event cancel need new approach given use result theori branch process establish result first construct new process bound nt show new process distribut multityp agedepend branch process see eg athreya ney 1972 definit bound multityp agedepend branch process singletyp agedepend branch pro cess final use result nakayama shahabuddin sigman 1996 simplic assum clock rate 1 proof easili gener clock rate unequ bound condit a2 e 2 recal lifetim event e follow distribut f lifetim may expir gsmp event cancel follow frequent use follow multityp agedepend branch process simplifi notat let 1 branch process differ type object index e object type e lifetim distribut f branch process begin time 0 time one object type born ie total object born object live random time specifi correspond lifetim distribut die object die instantan give birth exactli one object type process thu continu construct sampl path first bound process follow begin gener sampl path origin gsmp 0 follow ffl samplepath gener origin gsmp transit point equival event expir point noncancel event also includ event may also nullset schedul new process transit point gsmp schedul event alreadi schedul transit point new event never cancel whenev expir start multityp branch process sort mention ffl origin gsmp event cancel new process let cancel event run expir whenev expir start multityp branch process kind mention let bt total number event schedul 0 construct process claim construct process sampl path multityp agedepend branch process first glanc claim may seem incorrect event expir time cancel event cancel depend event expir time event caus cancel expir independ lifetim assumpt branch process seem violat howev care argument reveal otherwis note differ construct process ordinarili gener multityp agedepend branch process order gener lifetim ordinari case lifetim may gener sequenti ie first gener lifetim object first gener 2 object second gener construct process order gener lifetim random random next lifetim one choos gener depend posit length lifetim alreadi gener howev lifetim independ anyth system henc order gener chang distribut branch process consid new branch process defin follow branch process begin time 0 time object born object die give birth exactli object lifetim object follow distribut h depend 0 defin follow first defin distribut function g gx x 0 0 otherwis note x e distribut f use condit a4 a5 partii lemma 1 easili show gx uniformli set 0 henc choos suffici small h 0 jgx note ffl 12m defin new distribut function h follow hx 0 otherwis observ distribut h stochast smaller see ross 1983 g impli h stochast smaller 2 assum f 0 note defin singletyp agedepend branch process let b 0 number object born includ time also sinc h stochast smaller g b 0 stochast larger bt 0 2 final sinc h0 0 1 use theorem 31 nakayama shahabuddin sigman 1996 show exist z 0 0 proof complet proof theorem 1 need show suffici small ffi absolut valu differ quotient domin uniformli p 0 integr random variabl mean valu theorem suffici small ffi exist finit sinc jaj 1 choos ffl 0 clearli lemma 2 possibl choos suffici small h 0 condit a3 a4 a6 a7 a9 a10 a12 part iv lemma 1 hold condit a5 a8 a11 part iii lemma 1 hold ffl 7 hold jffij h henc 7 js correspond ffi alway lie first consid term v jl 0 j 5 f e f e delta6 6 4 f e densiti function f express evalu point greater defin sup sup sup condit a1 a4a12 partiii iv lemma 1 2 h 4 h 6 h 8 h finit 1 h 3 h 5 h 7 h lie interv let oe 1 probabl 1 condit a3 repeat applic schwarz inequ yield addit use fact oe 1 impli moment nt exist p 0 henc henc oeh integr similarli show jv 0 jlt jj uniformli domin integr random variabl final appli domin converg theorem complet proof worthwhil compar condit similar one literatur first consid amiabl condit use theorem 3 reiman weiss 1989 one may use theorem 3 reiman weiss valid exchang deriv expect special case setup ie present one distribut never appear variabl perform measur howev even impos restrict set amiabl condit difficult verifi directli one show help lemma 2 mean valu theorem assumpt condit a3 replac weaker tractabl assumpt use proposit 1 impli amiabl condit secondli consid assumpt 1995 though set use differ still make comparison exampl condit a3 similar condit perform measur also sens type distribut condit impli distribut condit a3k lecuy ie type distribut condit hold one use constant close 1 bound random variabl gamma 1i constant bound random variabl gamma 2i use nt analogu discret stop time analog result lemma 2 given prove condit specifi a3k gamma 1i gamma 2i hold compar condit employ glasserman 1991a1991b show unbiased ipa deriv estim gsmp context first note condit mainli impos restrict basic build block gsmp hand condit ipa primarili structur gsmp particular glasserman requir commut condit place limit relationship activ event certain state transit probabl state possibl immedi successor state condit essenti ensur slightli alter valu paramet result chang order two event sampl path sampl path sens correct next event moreov glasserman permit initi distribut transit probabl depend paramet anoth differ type perform measur fft result restrict v f measur random variabl satisfi condit a3 determinist glasserman allow v addit function time allow either determinist time nth transit time nth occurr particular event suffici condit a1a12 hold show assumpt hold mani set aris practic section 5 explicitli demonstr follow suffici condit satisfi larg class reliabl queue model first consid condit a3 proposit 1 suppos condit a1 a2 a4 a5 hold also suppos fft f measur random variabl v 0 exist p 0 almost 2omega 2 satisfi follow exist finit constant probabl 1 2 ii exist finit constant k 3 probabl 1 2 condit a3 hold proof need show w j k 1 second moment paramet valu follow lemma 2 show directli mani perform measur aris practic satisfi condit a3 proposit 2 suppos perform measur fft one realvalu function gs delta continu differenti 2 either jsj 1 b g uniformli bound theta condit a3 hold note v 0 form ii proof first note v ii f measur condit hold trivial satisfi condit a3 consid form ii assum either condit iia iib hold sinc gs delta continu differenti suffici small h 0 satisfi condit a3 show two rich class distribut gamma distribut weibul distribut case scale paramet satisfi distribut condit given a4a6 gamma distribut wide use type stochast model weibul distribut one frequent employ distribut reliabl model proposit 3 suppos lifetim event e gamma densiti shape paramet 0 scale paramet 0 ie fx given e set fx independ 0 uniformli 0 uniformli bound 0 theta 0 2 3 0 2 proof part trivial part ii note fx e fx converg 1 uniformli 0 part iii note f 0 x 2a x 2 0 2 0 2 3 0 2 proposit 4 suppos lifetim event e weibul densiti shape paramet 0 scale paramet 0 ie fx given e set fx independ 0 uniformli 0 uniformli bound 0 theta 0 2 3 0 2 omit proof sinc similar proposit 3 note need consid distribut depend paramet check condit a4a6 satisfi true initi distribut condit a7a9 transit probabl p condit a10a12 follow result show state space finit converg bound condit a8 a9 a11 a12 hold automat uniform proof trivial therefor omit proposit 5 suppos jsj 1 condit a8 hold ii condit a9 hold 2 exist h 0 may depend 0 delta delta bound iii condit a11 hold iv condit a12 hold 0 e 2 p exist h 0 may depend p 0 bound 5 exampl give exampl system condit a1a12 hold first exampl deal larg class reliabl model second exampl consid larg class multiclass queue network 51 reliabl model consid class reliabl model studi heidelberg shahabuddin nicola 1994 nicola shahabuddin heidelberg glynn 1993 nicola nakayama heidelberg goyal 1993 system compos k compon compon fail get repair compon lifetim repair time gener distribut r class repairmen system consisit finit number repairmen repair compon assign one repairman class repair strategi use repairman class may preemptiv nonpreempt prioriti fcf random order servic use member prioriti class allow follow interpen denci among compon first oper oper compon may depend certain compon oper addit repair fail compon may depend certain compon oper also failur compon may caus compon fail instantan certain probabl call failur propag exampl cancel event aris system consid oper certain set compon oper physic state system nth transit given n 1 0 depend whether ith compon oper fail nth transit q j n repair queue jth repairman class note jsj 1 easi see process fz previous mention system consid oper certain set compon oper formal u set oper state f set fail state system consid oper time otherwis consid assum time system oper new ie compon age 0 thu initi distribut independ paramet condit a7a9 automat event system either compon failur compon repair clearli 1 maximum 2k event entir system sinc k compon failur repair event associ henc condit a2 satisfi sinc jsj 1 failur propag system outcom event e given system current state fix ie ps exactli one state 0 0 otherwis howev failur propag system may random final state reach given state event proposit 5 provid suffici condit condit a11 a12 hold transient perform measur one may interest unreli expect interv unavail unreli probabl system failur fix time henc case fft form proposit 2 event fz 2 f tg thu condit a3 hold interv unavail fraction time 0 system case fft form ii proposit 2 gz fgt note gz independ therefor v 0 probabl 1 condit a3 satisfi reliabl set one usual interest deriv perform measur respect paramet failur time distribut individu compo nent ii paramet repair time distribut individu compon iii failur propag probabl first two case likelihood ratio deriv estim method applic distribut depend paramet respect deriv taken satisfi condit a4a6 special case condit satisfi distribut paramet proposit 3 4 third case densiti function f independ paramet condit a4a6 automat satisfi also ps typic form constant clearli condit a10 satisfi 2 0 1 sinc jsj jaj finit check condit given proposit 5 particular form ps condit satisfi class reliabl system turn glasserman 1991a1991b condit unbiased ipa deriv typic satisfi particular glasserman assum event never cancel could occur set sinc allow failur propag also commut condit hold mani repair strategi exampl one repairman fix fail compon firstcom firstserv fashion condit violat moreov glasserman work cover perform measur unreli howev ipa admit mani eventtim distribut exampl one use repair time uniformli distribut 0 also paramet ipa allow result paper 52 queue network consid multiclass queue network servic time custom class station gener distribut random variabl assum finit number server station custom class use markovian rout ie custom type complet servic station j immedi goe station k probabl r j k consid open close network case open network assum arriv process class station renew process gener distribut interrenew time event system custom arriv one custom class station custom servic complet one custom class server station henc event set finit applic condit a2 satisfi mention earlier one situat open network servic rate custom station proport number custom system assum network close alway start custom configura tion initi distribut independ paramet condit a7a9 automat satisfi similarli assum network open alway start custom present initi distribut independ paramet condit a7a9 automat hold perform measur interest system expect timeaverag queue length 0 given station ii case open network expect timeaverag number custom 0 entir system iii case open network probabl total number custom system exce threshold time interv 0 network finit combin buffer probabl least one custom loss due buffer overflow 0 show condit a3 hold perform measur sinc case v independ v 0 show e 0 v 1 case iii obviou case close network also obviou case open network case ii custom initi system follow lemma 2 condit a2 a4 a5 hold say case ii let qs total number custom system time qsd nsd proposit 1 impli condit a3 hold condit a2 a4 a5 one may interest deriv perform measur respect paramet servic time distribut class particular station ii case open network paramet interarrivaltim distribut certain custom class particular station iii rout probabl certain custom class particular station case reliabl model first two case likelihood ratio deriv estim method applic distribut depend paramet respect deriv taken satisfi condit a4a6 wide use case condit satisfi distribut paramet type given proposit 3 proposit 4 third case case close network due finit state space appli proposit 5 case open network proposit 5 longer use state space longer finit howev sinc number station finit sinc markovian rout finit mani differ valu assum henc show condit a11 a12 hold make sure transit probabl continu 0 neighborhood 0 condit hold ps form c 1 constant multiclass queue system consid glasserman 1991a1991b condit unbiased ipa deriv typic satisfi specif com mute condit hold multiclass network gener exampl particular station visit one custom class fed one sourc condit violat also glasserman work cover perform measur probabl buffer overflow occur time final glasserman disallow rout probabl gener statedepend transit probabl depend paramet howev mention ipa admit mani eventtim distribut mention condit a1a12 hold gener queue network exampl shown typic valid statedepend rout 1 appendix proof lemma 1 1 work first author support part nsf career award dmi9624469 njit sbr grant 421180 work second author support part nsf grant dms9508709 nsf career award dmi9625291 author would like thank area editor associ editor two refere help detail comment obviou ii wish show ffl 0 exist ffi 0 satisfi condit a4 a5 ffl 0 exist h condit a4 satisfi x 2 f e condit a4 x 2 0 satisfi therefor 10 still hold choos henc 10 ffl 0 exist ffi 0 satisfi 2 0 subtract term use fact f get 9 iii follow immedi part ii lemma iv condit a4 a5 ffl 0 exist h condit a4 fx e fx x 2 f e defin dffi condit a4 a6 exist h 2 smaller h 1 2 exist jf 0 x fflkf constant k 0 partiii lemma 1 exist h 3 2 choos h part iv lemma 1 minh 2 mean valu theorem 2 shown previou paragraph f 0 x e exist suffici small ffi exist also z domin converg theorem 2 0 gammah 0 h r r r r r stochast optim sensit analysi probabl measur system avail estim save languag refer user manual guid simul 2nd maximum likelihood ratio estim gener semimarkov pro cess gradient estim via perturb analysi structur condit perturb analysi deriv estim finit time perform indic structur condit perturb analysi queu system gradient estim regen process wilson monoton gener semimarkov process gener semimarkov process antimatroid structur secondord properti guidelin guarante common random number stochast approxim mont carlo optim likelihood ratio gradient estim overview optim stochast system via simul ieee press gsmp formal discreteev system likelihood ratio deriv estim stochast system simul method queue overview import sampl stochast simul regen gener semimarkov process converg properti infinitesim perturb analysi estim bound rel error estim transient measur highli depend nonmarkovian system optim perturb analysi queue network note interchang deriv expect likelihood ratio deriv estim asymptot likelihood ratio deriv estim simul highli reliabl markovian system likelihood ratio sensit analysi markovian model highli depend system note exponenti moment fast simul highli depend system gener failur repair process fast simul steadi state avail nonmarkovian highli depend system sensit analysi via likelihood ratio ieee press sensit analysi simul via likelihood ratio new york score function approach sensit analysi comput simul model sensit analysi perform extrapol comput simul model discret event system sensit analysi stochast optim score function method equilibrium distribut class finitest gener semimarkov process continu gener semimarkov process tr ctr sigrn andradttir paul glasserman peter w glynn philip heidelberg sandeep juneja perwez shahabuddin 19622005 profession appreci acm transact model comput simul tomac v17 n2 p6e april 2007 pierr lecuy valri demer bruno tuffin rare event split quasimont carlo acm transact model comput simul tomac v17 n2 p9e april 2007