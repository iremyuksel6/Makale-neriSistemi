invers satisfi problem studi complex tell whether set bitvector repres set satisfi truth assign boolean express certain type show problem conpcomplet express requir conjunct normal form three liter per claus 3cnf also prove dichotomi theorem analog classic one schaefer state unless pnp problem solv polynomi time claus allow horn antihorn 2cnf equival equat modulo two b introduct logic deal logic formula particularli syntax semant formula well interplay two aspect ck90 domain boolean logic exampl boolean formula oe may come varieti syntact classesconjunct normal form cnf subclass 3cnf 2cnf horn etc semant captur model satisfi truth assign set oe truth assign satisfi formula see figur 1 exampl go back forth two represent formula therefor interest one direct studi extens standpoint comput complex go oe oe particular tell whether famou satisfi problem sat known npcomplet gener special case 3sat among other polynomialtim solvabl special case horn 2sat exclusiveor co71 sc78 pa94 direct muchstudi comput problem paper studi certain sens complet settl complex invers problem go oe back oe syntact class mention identifi complex tell given set model whether formula oe class 3sat horn etc call problem invers satisfi besid fundament natur mani factor make invers satisfi interest problem major motiv come ai fact call invers satisfi problem implicit much recent ai literatur ca93 dp92 kks95 kks93 kps93 set model figur 1b seen state knowledg may mean present know state threevari world one three state indic context formula oe kind knowledg represent ai mani sophist compet method knowledg represent receiv editor april 24 1995 accept public revis form novemb 20 1996 publish electron june 15 1998 work partial support esprit project alcom ii greek ministri research pienedelta program 91edelta648 httpwwwsiamorgjournalssicomp28128511html depart mathemat univers patra patra greec djkmathupatrasgr z depart comput scienc athen univers econom busi athen greec mssdiasauebgr b fig 1 boolean formula 3cnf correspond set model b boolean logic perhap primit see gn87 le86 mc80 mo84 re80 sk90 import understand express form invers satisfi problem invers satisfi problem also propos dp92 form discov structur data exampl establish complex binari relat set model simpl formula may inde uncov true structur natur heretofor meaningless tabl dp92 address problem certain fairli straightforward case problem learn formula afp92 seen gener invers satisfi problem recent trend ai approxim complex formula simpl one horn formula sk91 kps93 gps94 quantifi qualiti comput feasibl approxim also involv understand invers satisfi problem basic comput problem studi given set model cnf formula oe three liter per claus call problem invers 3sat first result invers 3sat conpcomplet theorem 1 note invers 3sat well problem consid paper solv polynomi time given theta n tabl exponenti mani model interest case problem therefor three wellknown tractabl case sat 2sat claus two liter hornsat claus horn one posit liter symmetr case antihorn formula claus one neg liter xorsat claus equat modulo two schaefer eleg dichotomi theorem sc78 state unless pnp certain sens precis tractabl case sat interestingli invers problem three case happen also tractabl tell polynomi time set model set model horn antihorn formula 2cnf formula exclusiveor formula interestingli latter two result fact point schaefer sc78 first left open sc78 dp92 kps93 question come mind tractabl case invers problem theorem 2 answer neg rather surprisingli strong dichotomi theorem similar schaefer hold invers satisfi problem well problem conpcomplet syntact class cnf formula except case horn antihorn 2cnf exclusiveor proof dichotomi theorem draw theorem 1 schaefer proof fact strengthen schaefer main express result theorem 30 sc78 154 dimitri kavvadia martha sideri 2 definit nonstandard terminolog use paper come sc78 set boolean variabl liter variabl negat model vector f0 1g n intuit truth assign boolean variabl denot logic respect also extend notat bitwis oper model model denot constant ie 0 1 ith posit kplace logic relat subset f0 1g k k integ use notat oe oe boolean formula denot relat defin oe variabl taken lexicograph order let r logic relat call r horn logic equival conjunct claus one posit liter call antihorn equival conjunct claus one neg liter call 2cnf equival 2cnf express final call affin solut system equat twoelement field set boolean relat sclaus ariti express form ra kari relat either boolean liter constant 0 1 given truth assign consid sclaus true combin constant valu assign variabl form tupl r defin sformula conjuct sclaus defin relat gener satisfi problem problem decid whether given sformula satisfi schaefer dichotomi theorem sc78 state satisfi sformula decid polynomi time follow case relat horn b relat antihorn c relat 2cnf relat affin case problem npcomplet schaefer result total character complex cnf satisfi problem addit claus allow arbitrari relat bound ariti interest note sever restrict form sat oneinthre 3sat notallequ 3sat etc follow special case gener satisfi see gj79 pa94 make point clear notic problem oneinthre 3sat consid set four 3ari relat g first relat correspond sclaus r 1 relat ff0 0 0g f1 1 0g f1 0 1gg correspond sclaus one negat liter eg r 2 boolean formula oe denot oe set model say set model 3cnf set kcnf gener formula oe 3cnf respect kcnf oe notic model set construct kcnf formula model set gener may requir extra existenti quantifi variabl base defin invers sat problem set relat follow given set f0 1g n conjunct sclaus n variabl set model main result state relat fall four case invers sat problem also polynomi otherwis conpcomplet notic exclud part instanc sinc want emphas invers sat actual collect infinit mani subproblem mean relat constant ariti otherwis relat non constant ariti could exponenti mani tupl problem becom trivial intract next section prove invers sat problem conpcomplet 3cnf formula proof includ main construct use proof main theorem last section last proof make use express result interest partial reli schaefer main theorem sever interest extens 3 conpcomplet invers 3sat begin section technic definit use throughout paper definit let n posit integ let f0 1g n set boolean vector k 1 say boolean vector 2 f0 1g n kcompat sequenc k posit vector agre k posit definit impli vector 2 f0 1g n kcompat set boolean vector exist sequenc k posit agre vector follow use character kcnf set lemma 1 let f0 1g n set model follow equival kcnf set proof let oe conjuct possibl kcnf claus defin n variabl satisfi model notic oe restrict kcnf formula term model set satisfi model henc hold satisfi least one claus oe concequ disagre model k posit correspond variabl claus kcompat convers assum model kcompat mean satisfi oe differ member k posit kclaus indic complement k posit satisfi oe kcnf set invers 3sat problem given set model 3cnf set state first complex result theorem 1 invers 3sat conpcomplet proof lemma 1 establish problem conp given set model order prove 3cnf set suffic produc model 3compat obvious 3compat check polynomi time altern given immedi candid 3cnf formula oe conjunct 3cnf claus satisfi model thu 3cnf set iff model satisfi oe prove conpcomplet shall reduc follow wellknown conpcomplet problem invers 3sat given 3cnf formula unsatisfi given 3cnf formula n 4 variabl c claus shall construct set model 3cnf iff unsatisfi set contain model one set w three variabl truth assign three variabl contradict claus sinc may assum consist claus exactli three liter let w set three variabl chosen among variabl fx formula let w 7 f0 1g truth assign variabl w contain claus satisfi consid total order among pair w say lexicograph one set contain model mwt w model everi boolean vector mwt concaten encod occur formula encod variabl x boolean vector length defin follow posit z w ith pair total order mention notic x 2 w valu x determin first two posit code 01 stand valu 1 code 10 stand x 0 two case call string w x valu pattern x 62 w code 00 first two posit denot absenc x w rest string uniqu determin pair w case call string w x pad pattern notic construct vector exactli occur uniqu pad pattern w remain three valu pattern henc length boolean vector mwt nk exponenti blowup construct set proof theorem 1 rest next claim claim model 3compat satisfi proof claim moment consid boolean vector length substr 2 obviou model 3compat 3compat posit restrict one substr take three arbitrari posit vector mwt agre three posit 3 compat also impli someth stronger vector contain substr see first assum valu 1 posit j 3 2 3compat forc valu 0 1 1 0 first second posit ie valu pattern valu 0 1 posit 2 valu tripl posit includ posit agre valu posit specif model name one pad pattern 0 posit 1 posit j therefor ident pad pattern case howev analog observ show whole 3compat model ident model pattern 3compat either consist valu pattern assum exist model 2 3compat alreadi prove model consist valu pattern model encod satisfi truth assign variabl suppos conflict claus c variabl fx g consid three valu pattern posit variabl c sinc 3compat valu pattern contain one 1 conclud exist model encod truth assign set variabl sinc construct contradict claus couldnt conflict claus therefor boolean vector encod satisfi assign variabl formula string encod truth valu assign variabl x formula satisfi sinc everi claus satisfi truth assign describ vector convers assum satisfi ie exist satisfi truth assign variabl fx g construct model concaten valu pattern everi string defin follow posit z obvious model includ set sinc everi model contain pad pattern suppos 3compat case contain three posit agre model sinc concaten valu pattern must contain three substr assign set variabl pair w encod model set variabl howev examin construct truth assign encod conflict claus sinc conflict clausebecaus restrict three variablesw conclud pair w encod model henc 3compat satisfi exist model 3compat specif model encod satisfi truth assign 4 dichotomi theorem main result follow gener theorem 1 theorem 2 invers sat problem ptime follow case relat horn b relat antihorn c relat 2cnf relat affin case invers sat problem conpcomplet sc78 prove surprisingli similar dichotomi theorem sat sat ptime four class npcomplet otherwis proof base interest extens schaefer main result explain definit let set boolean relat let r anoth boolean relat ariti r say faith repres r binari boolean function conjunct sclaus variabl logic equival formula sclaus express r help uniqu defin auxiliari variabl substanti restrict schaefer notion repres allow arbitrari existenti quantifi conjunct sclaus definit allow quantifi logic equival 9x henc main technic result extend main result sc78 theorem 30 independ creignou hermann ch96 defin concept quasiequival concept faith represent defin paper theorem 3 satisfi four condit theorem 2 faith repres boolean relat proof assum none four condit satisfi proof proce find elabor boolean relat faith repres notic sinc notion faith represent defin equival two sformula shall restrict proof construct appropri sclausesfaith represent correspond relat follow immedi process allow oper must preserv uniqu valu auxiliari variabl produc formula also conjuct form therefor c c 0 sformula allow oper c c 0 ie conjuct two sformula b cax ie substitut variabl symbol anoth symbol c c0x c1x ie substitut variabl constant actual select tupl agre specifi constant 9xcx ie existenti quantif bound variabl uniqu defin step provid schaefer proof new step 1 express x j shown sc78 lemma 32 corollari 321 follow exposit somewhat simpler base fact set f0 1g n model set horn formula iff close bitwis see appendix kps93 let r nonhorn relat say ariti k closur properti mention impli exist model 0 r base r may defin claus r set posit 0 0 resp 1 set x posit posit 1 easi see x actual appear r 0 one 0 coincid conjunct 01 10 model r 0 00 henc r 0 either addit contain relat antihorn symmetr argument rule tupl 11 result claus r 00 either notic sinc case shall henceforth feel free use neg liter express step 2 express x schaefer show lemma 33 sclaus involv variabl x z whose set model contain 000 101 011 110 proof follow known see appendix sclaus affin three model also model consid therefor sclaus affin assum x j repres observ step 1 may negat variabl claus posit 0 1 new sclaus call 0 satisfi allzero truth assign moreov assign 1 0 phi 1 construct new claus ra 1 ariti posit 1 0 1 0 1 final 0 0 sclaus r defin x z model 000 011 101 correspond allzero assign 1 0 0 respect 110 correspond 1 show r faith repres one four version observ least two x actual occur r exactli two variabl present r r repres version follow x present rx present present ry z three variabl present depend remain four possibl model also model set sclaus sixteen possibl relat strongest model ident set use defin xx true exactli one x z true follow xx case current step unnecessari fifteen case show exhaust analysi rclaus one constant repres version r0 rx 0 sinc also faith express w j x step 1 four version step 3 express xx z x formula satisfi exactli one three variabl valu 1 known see appendix claus 2cnf iff set three satisfi assign 0 1 2 assign satisfi assign use character prove relat set contain relat 2cnf also contain relat horn antihorn affin xx z faith repres consid sclaus 2cnf may therefor find three satisfi assign express satisfi assign previou step may negat variabl posit 0 valu 1 result new claus 0 satisfi allzero assign 1 1 equal 1 0 set 0 posit 1 0 x posit 1 1 1 0 1 final z 0 0 observ three variabl actual occur construct claus r x present 1 0 ident allzero assign contradict either z present 1 0 ident 1 contradict claus construct includ model 000 110 101 100 sclaus rx exactli model 100 010 001 ie xx step 4 express x j yz notic express xx yxx z xs u equival thu prove faith repres relat variabl logic equival two variabl notic auxiliari variabl u uniqu defin valu z step 5 use repeatedli x j z x j faith repres claus take conjunct arbitrari claus faith repres boolean relat complet proof theorem 3 proof theorem 2 let set relat satisfi one condit let r maximum ariti relat solv invers satisfi problem follow given set model first identifi time r jm sclaus satisfi model call conjunct sclaus oe clearli conjunct sclaus set model argument use lemma 1 precis oe tell whether set model oe inde show gener set model oe polynomi delay consecut output jpy88 provid gener possibl decid whether check gener model belong model gener repli otherwis set model gener exactli repli ye observ answer obtain jm overal polynomi time gener algorithm base gener observ also explain analog dichotomi theorem one schaefer call syntact form boolean formula hereditari substitut variabl constant result new formula syntact form observ four case claim invers satisfi problem polynomi inde hereditari coincid polynomi case satisfi sc78 theorem 4 follow two condit hold class boolean formula syntact form class hereditari b satisfi problem class ptime model formula class gener polynomi delay consecut output proof inform descript gener algorithm step substitut variabl constant first valu 1 0 sinc hold substitut result new formula syntact form ask polynomialtim oracl whether produc formula satisfi sinc b hold oracl exist produc formula satisfi proceed recurs substitut next variabl variabl assign valu case return model certain step valu 1 variabl either discov model reject valu produc formula unsatisfi tri valu 0 finish backtrack previou step easi see 2n queri oracl n number variabl either gener new model know model formula gener show conpcomplet case let set boolean relat satisfi condit ad clear invers sat problem conp let r 3 largest ariti relat given set model construct sclaus satisfi model mthi take time set model conjunct sclaus model fail satisfi least one sclaus show complet shall reduc unsatisfi problem tell whether 3cnf express unsatisfi invers sat suppos 3cnf express n 3r variabl set contain model 3rtupl variabl valu variabl dont contradict claus let k cardin quantiti bound function r number variabl claus notic sinc r constant number model exponenti construct gener theorem 1 consid total order among pair w w set 3r variabl truth assign variabl contradict claus everi boolean vector mwt concaten two string w string fi w concaten encod occur formula fi encod w x variabl x boolean vector length defin proof theorem 1 notic construct uniqu pad pattern w occur string fi w call length string fi w string ffl w construct follow consid 3cnf claus n variabl satisfi set string fi w set 3r variabl w assign variabl call oe conjuct claus express oe faith sclaus involv auxiliari variabl definit faith represent see xn j f howev auxiliari variabl depend three n variabl appear 3cnf claus follow fact repres 3cnf claus consequ express 3cnf claus separ sclaus take conjunct represent thu overal depend auxiliari variabl xn boolean function f string fi w valu posit correspond string ffl valu auxiliari variabl b note valu state explicitli ie encod valu pattern concept faith represent necessari string fi w uniqu string ffl w ordinari represent multipl way extend string fi w via auxiliari variabl would result exponenti increas model set let f0 1g ns construct set model claim set model conjunct sclaus iff origin 3cnf express unsatisfi satisfi set model rcnf express consid model correspond satisfi truth assign model concaten two part first n posit consist valu pattern encod valu variabl satisfi truth assign exactli proof theorem 1 second consist correspond valu auxiliari variabl model rcompat rtupl restrict first n posit certainli match correspond tupl model construct fact tupl restrict first part 3rtupl match precis rtupl restrict first n posit also rcompat depend auxiliari valu 3 first n compat itupl r second part hold 3icompat first part hold altern instead look posit second part look three correspond posit first part therefor whole model correspond satisfi truth assign rcompat follow lemma 1 rcnf result set model conjunct sclaus recal maximum ariti r suppos unsatisfi let 0 restrict first n posit 0 exactli set model oe conjuct 3cnf claus n variabl dont disagre 0 reason theorem 1 model 3compat 0 except 0 sinc 0 set model oe follow set model correspond conjunct sexpress faith repres oe appendix appendix contain proof closur properti horn antihorn 2cnf affin set model use proof theorem 3 follow f0 1g n denot set model set horn iff two model model 0 also proof base follow proposit kps93 0 bitvector use notat 0 denot proposit follow equival horn formula whose model set b either uniqu c proof impli c easi establish b c take 0 00 2 00 final properti b construct follow set horn claus model guarante b creat horn claus 1 easi see set horn claus compris desir oe antihorn set case symmetr replac 1 0 set 2cnf iff set three model model proof shown sc78 lemma 31b give differ proof simpler base lemma 1 2 first notic model follow properti valu posit equal valu major among three valu model posit eg valu model posit 1 1 0 respect valu posit 1 call outcom oper major model suppos 2cnf lemma 1 2compat model easi see major model three model 2compat three model suppos major model set three model also shall prove 2compat model prove induct show 2compat model fact ncompat consid model kcompat 1tupl posit model k distinct ktupl k 1tupl agre model take three necessarili distinct k model model less three notic one differ one posit 1tupl therefor k 1tupl agre major model three model henc 1compat therefor 2compat model lemma 1 2cnf set affin set affin iff three model also proof fact follow linear algebra especi theori diophantin linear equat state intuit observ convers everi convex polytop convex hull vertic see book schrijver sc86 acknowledg grate christo papadimitri help discuss suggest also indebt anonym refere detail comment suggest decis help us improv present make complet precis r learn conjunct horn claus semant comput consider horn approxim complex gener satisfi count prob lem model theori complex theoremprov procedur structur identif relat data comput intract logic foundat artifici intellig increment recompil knowl edg gener maxim independ set horn approxim empir data reason characterist model make believ comput comput complex logic default reason complex satisfi problem theori linear integ program model prefer default theori knowledg compil use horn approxim tr ctr jeanjacqu hbrard bruno zanuttini effici algorithm horn descript inform process letter v88 n4 p177182 novemb lane hemaspaandra sigact news complex theori column 34 acm sigact news v32 n4 decemb 2001 lefteri kirousi phokion g kolaiti complex minim satisfi problem inform comput v187 n1 p2039 novemb 25 lane hemaspaandra sigact news complex theori column 43 acm sigact news v35 n1 march 2004