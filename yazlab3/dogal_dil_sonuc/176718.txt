tight upper lower bound path length binari tree extern path length tree sum length path root extern node maxim path length differ delta differ length longest shortest path tight lower upper bound prove extern path length binari tree n extern node maxim path length differ delta prescrib particular upper bound given valu delta exactli achiev infinit mani valu n improv previous known upper bound could achiev factor proport n elementari proof known upper bound also present preliminari result moreov lower bound prove exactli achiev valu n deltaleq n2 b introduct binari tree constitut import wide use data structur storag retriev inform cost access inform store node proport distanc node root import measur effici often consid respect binari tree extern path length externalt sum distanc extern node root relat averag cost unsuccess search tree moreov extern path length relat intern path length sum distanc intern node root correspond averag cost success search tree well known extern path length binari tree n extern node thetan lg n best case worst case bad thetan 2 larg gap best worst case motiv studi import quantiti addit inform tree avail nievergelt wong 7 propos upper bound extern path length tree term number extern node maximum weight balanc subtre recent klein wood 5 obtain upper bound requir much less inform tree name deriv upper bound extern path length term n number extern node delta maximum differ length path root extern node case dipartimento di informatica ed applicazioni universita di salerno 84081 baronissi salerno itali part work done author visit ibm research divis j watson research ctr yorktown height ny 10598 aiken comput laboratori harvard univers cambridg 02138 partial support nsf grant nsfccr9007677 part work done author visit att bell laboratori new jersey usa n also construct tree whose extern path length within upper bound paper continu extend work 5 present upper bound extern path length binari tree n node maximum path length differ delta construct infinit class tree whose extern path length match bound exactli moreov present lower bound extern path length tree case delta n2 exist tree whose extern path length match exactli bound organ paper summari result paper studi path length n deltatre extend binari tree n extern node maximum path differ delta section 2 set notat recal elementari fact binari tree section 3 present upper bound preliminari result section 31 give simpl deriv upper bound present 5 section 32 improv result give better bound delta exactli achiev infinit mani n section 4 present lower bound exactli comput n extern path length tree shortest extern path length lower bound first lower bound improv banal lower bound obtain consid binari tree extern node two consecut level shortest extern path length among tree number extern node 2 background notat section set notat recal elementari fact binari tree denot set natur number n set posit natur number n set posit real number r write dxe denot least integ greater equal x throughout paper write lg x denot logarithm base 2 x tree consid paper extend binari tree extend binari tree obtain binari tree ad special node extern node everi node binari tree exactli two children originari node binari tree also call intern node say extern node e level l tree length uniqu path root e l let n extern node level l extern path length externalt defin intern path length tree internalt defin sum level intern node path length binari tree 3 maximum path length differ fringet defin also level l last one said dens one extern node last level dens two extern node n deltatre binari tree n extern node maximum path length differ delta delta follow n deltatre n deltatre paper give bound epln delta epln delta restrict attent case exist n deltatre case complet character see section 4 follow simpl wellknown result extend binari tree see exampl 4 extens use sequel fact 21 kraft equal let l l n sequenc posit integ exist extend binari tree n extern node level l shall say n deltatre configur l 0 1 2 extern node level l 3 two n deltatre configur said isomorph purpos tree follow omit l configur either clear context immateri 3 upper bound section present upper bound epln delta problem comput epln delta state follow find maximum l subject 1 l 2 3 constraint l find exact maximum appear easi task 31 simpl proof known upper bound recent klein wood 5 prove follow upper bound epln delta bound 1 e base natur logarithm 5 bound deriv first prove extern path length relat ratio geometr harmon mean certain integ appli theorem specht 8 section reder bound 1 use elementari calculu obtain upper bound epln delta allow l rang real number end maximum l sequenc l satisfi follow constraint 1 l 2 3 x l triplet n delta x exist sequenc l satisfi three constraint call admiss clear upper bound extern path length binari tree given epln delta maxfmn delta xjn delta x admiss x 1 follow lemma give use character maximum mn delta x lemma 31 let n delta x admiss triplet maximum mn delta x achiev sequenc l 1 l one equal either x x delta proof assum way contradict maximum reach l 0 x l 0 defin sequenc l 00 n follow way l 00 l 0 l 0 l 0 ffi chosen kraft equal hold 2 gammal 00 notic suffici small valu ffl ie path length binari tree 5 00are x x delta sinc function increas x equal 0 posit hold therefor ffl xg sequenc l 00 n satifi three constraint definit mn delta x contradict maxim l 0 n follow lemma provid upper bound maximum mn delta x lemma 32 let n delta x admiss triplet proof lemma 31 maximum achiev l l delta kraft equal get see uniqu specifi n delta x maximum mn delta x thu given gammay function function f delta henc lemma readi prove bound 1 theorem 33 e base natur logarithm proof combin lemma 32 1 get ae oe 2 function maxim concav function x easili seen use elementari calculu reach maximum fix valu n delta delta substitut 2 get bound 1 6 de santi persiano 32 improv upper bound achiev infinit mani valu previou section maxim carri real number show restrict x integ get better bound bound present section improv bound 1 two account first accur second valu delta exactli achiev infinit mani valu n bound 2 let moreov delta exist infinit subset n delta n n 2 n delta exist n deltatre ndelta proof analysi done section 31 clear upper bound extern path length binari tree given lemma 32 get integ phi ndelta x maximum ie phi ndelta x concav function x integ x satisfi 3 definit phi x obtain x satisfi 3 howev integ power 2 equal 2 z z would factor delta2 zgammadelta thu delta imposs henc inequ uniqu determin x prove bound path length binari tree 7 prove bound achiev let delta x posit integ h deltax function h deltax enjoy follow three properti h deltax x inde inequ equival 2 x satisfi x delta b h deltax x inde written satisfi x delta 2 c h deltax simpl algebra show equival hold 1 three properti delta 2 x delta exist 1g h deltax deltax deltax 1 actual sever deltax instanc delta 2 consid infinit set n delta 1y deltal g fix delta n 2 n delta consid extern node level l deltal 2 delta level l delta l first tree exist fact deltal kraft equal satisfi definit deltal obtain h deltal deltal deltal definit function h deltal lg l lg jm follow comput externalt turn exactli bound 2 fact one delta2 delta clear bound 2 accur bound 1 fact everi n delta 1 absolut maximum function phi 2 maximum function subject addit constraint x exampl 1 exampl consid case 5 binari tree satisfi bound 2 equal larger l exampl 2 plug bound 2 obtain actual prove bound tight valu n see 2 3 exampl 3 simpl applic bound 2 deriv upper bound intern path length redblack tree class redblack tree constitut import class balanc binari tree guarante worstcas search cost 1 bound obtain term lower order equal one present 1 prove asymptot tight bound obtain observ redblack tree fring logn 1 bound 2 increas delta bound 3 let redblack tree n intern node refer reader 3 proof bound 4 lower bound section present lower bound exactli achiev n 4 2 delta n2 deal gener case let us briefli discuss case see 6 complet treatment case easili settl exist n power 2 case n extern node locat level lg n tree uniqu hand n 1tree exist n power 2 case uniqu extern node uniqu n 1tree locat level dlg ne gamma 1 dlg ne extern path length ndlg ne follow properti n 1tree easili prove use kraft equal lemma 41 n 1tree exist c 0 extern node level dlg ne c power 2 due c n none integ n n power 2 let us consid case delta n2 n 4 start character n deltatre minimum extern path length prove theorem 45 tree belong class n deltatre particular structur comput extern path length tree structur obtain lower bound minim obtain extern path length lemma 42 let n deltatre minimum extern path length configur l 1 two dens level moreov two dens level two level consecut 2 level path length binari tree 9 proof prove 1 proof 2 similar assum way contradict tree two nonconsecut dens level minimum extern path length case one two dens level last one similar consid tree 0 configur l 0 0 0 still n deltatre extern path length thu minimum extern path length immedi two intermedi level one extern node even consecut fact suppos three level one extern node obvious least two must nonconsecut go let us introduc follow notat n deltatre type unspecifi greater equal b 0 extern node level l precis configur l 0 shall say n deltatre type l b 0 0 extern node first b 0 level 1 extern node follow b 1 level configur l time symbol b b denot respect b level extern node less extern node done configur omit l say tree type b 0 context immateri lemma 43 let tree type l 0 contain extern node level l exactli one extern node type l 0 proof consid grandpar e two extern node level l node two children one intern node parent two extern node level l b child e intern node would impli either level l 2 extern node success level extern node thu level l exactli one extern node prove induct case also prove lemma readi complet character configur n deltatre minimum extern path length fact theorem 45 prove tree must n delta atre defin follow definit 44 n 4 defin n delta atre follow way 1 n delta gamma1tre n deltatre type 2 let 0 2g n delta atre n deltatre type 3 remark notic definit consid case log fact tree type l contain least 2 extern node l 1 thu 2 a1 n lg n gamma 1 also notic use kraft equal easi see n delta atre exist uniqu see also discuss follow lemma 46 theorem 45 n 4 n deltatre minimum extern path length n delta atre gamma1 1g proof view lemma 42 n deltatre minimum extern path length two dens level level preceed dens level except first one empti consid first case two dens level dens level first two level lemma 43 tree type 2 2 1 deltagamma2 2 thu n delta gamma1tre instead last two level dens tree type thu n delta final two dens level intermedi lemma 43 tree type 1 0 thu n delta atre consid case exist one singl dens level level first tree n delta gamma1tre last level tree n delta otherwis tree n delta atre 0 2g lemma 46 0 x 1tree u configur l 0 1 exist exist configur l b x 1tree u configur l 0 1 exist exist configur l 0 c x 1tree u configur l exist exist proof prove part lemma proof part b c similar breviti denot configur l path length binari tree 11 b first c nonneg integ 0 2 a1 moreov 0 1 gamma2 l1 0 1 use kraft equal exist one two tree impli sum equal 1 thu tree exist lemma impli fix n delta exist uniqu delta atre fact lemma 46 natur defin invert map tree tree greater delta therefor n delta two nonisomorph n delta atre invert map would construct two nonisomorph tree number extern node possibl next lemma give necessari suffici condit exist n delta atre comput extern path length aim defin function f n delta follow dlg xa n deltae1 gamma2 dlg xandelta 2 a2 lemma 47 n 4 n delta atre exist interv xa n delta xa contain power 2 case extern path length f n delta proof prove lemma 0 1g case prove similar way suppos interv xa n delta xa contain power 2 lemma 41 sinc uniqu xa n delta 1tree least 2 a1 extern node first level therefor hypothesi part lemma 46 hold thu n delta atre exist implic prove similar way comput extern path length n delta atre use lemma 46 configur n delta atre thu extern path length complet determin configur correspond x 1tree express function l 0 1 turn depend valu x thu comput extern path length n delta atre tediou comput show exactli f n delta next studi behavior extern path length n delta atre fix n delta see extern path length n delta atre biton function nonincreas certain valu ffdelta nondecreas ffdelta integ part uniqu solut equat easili seen ffdelta equal either blg deltac gamma 2 blg deltac gamma 1 lemma 48 let n 4 1g n delta gamma 1tree exist f n delta proof differ f gamma delta equal hypothesi n delta gamma 1tree exist therefor lemma 47 interv contain power 2 delta 2 power 2 dlg definit xa gamma therefor lemma prove let us consid case xa power 2 case interv xa gamma contain power 2 therefor ffdelta delta hand ffdelta delta path length binari tree 13 lemma 49 let n 4 1g n delta gamma 1tree exist n delta atre n delta gamma 2tree exist f n delta proof proof lemma similar one previou lemma omit refer reader 3 complet proof lemma 410 let n 4 delta n2 ffdelta n delta fftree exist n delta ff gamma 1tree n delta ff exist proof n delta fftree exist lemma 47 interv contain power 2 previou power 2 interv interv contain power 2 thu n delta ff gamma 1tree exist sinc xff gamma first inequ follow definit xa n delta second equival inequ hold thu prove n delta ff gamma 1tree exist exist n delta ff 1tree establish similar way summar lemmata say n delta fftree exist interv xff n delta xff contain power 2 n delta fftree exist lemma 410 n delta ff gamma 1tree n delta ff exist minimum path length obtain either one thu prove follow bound 4 n 4 delta n2 contain power 2 14 de santi persiano ff integ part uniqu solut equat x dlg xa n deltae1 gamma2 dlg xandelta 2 a2 acknowledg second author would like thank prof harri lewi suggest also thank mario mavronicola care read manuscript r intern path length redblack tree stac 91 tight upper lower bound path length binari tree code inform theori path length binari tree art comput program upper bound total path length binari tree zur theori der elementaren mittel tr