unsymmetr multifront lu factor wellknown approach comput lu factor gener unsymmetr matrix build elimin tree associ pattern symmetr matrix use comput graph drive numer factor approach although effici larg rang unsymmetr matric captur unsymmetr structur matric introduc new algorithm detect exploit structur asymmetri submatric involv process elimin tree show new algorithm signific gain memori time perform factor obtain b introduct consid direct solut spars linear equat base multifront approach system form n n unsymmetr spars matrix multifront method develop du reid 11 12 comput solut indenit spars symmetr linear equat use gaussian elimin extend solv gener unsymmetr matric du reid 13 multifront method belong class method separ factor analysi phase numer factor analysi phase involv reorder step reduc llin numer factor symbol phase work support director oce scienc divis mathemat inform comput scienc us depart energi contract number deac0376sf00098 amestoyenseeihtfr enseeihtirit 2 rue camichel 31071 toulous franc pramestoylblgov nersc lawrenc berkeley nation laboratori 1 cyclotron rd berkeley ca 94720 z nersc lawrenc berkeley nation laboratori 1 cyclotron rd berkeley ca 94720 build comput tree call elimin tree 9 18 20 whose structur give depend graph multifront approach analysi phase gener concern numer valu base sparsiti pattern matrix far analysi phase concern approach introduc du reid symmetr unsymmetr matric almost ident matrix unsymmetr structur symmetr matrix summat perform symbol use place origin matrix elimin tree unsymmetr lu factor thu ident choleski factor symmetr matrix control growth factor lu factor partial threshold pivot use numer factor phase pivot order use analysi build elimin tree might respect numer pivot result increas estim size factor number oper improv numer behaviour multifront approach common involv step preprocess base numer valu fact matrix wellscal mean entri origin matrix order magnitud good prescal matrix signic impact accuraci perform spars solver case also beneci preced order perform unsymmetr permut place larg entri diagon du koster 10 design algorithm permut larg entri onto diagon shown signicantli improv behaviour multifront solver multifront approach du reid 13 use harwel subroutin librari code 3 distribut memori code mump develop context parasol project eu esprit iv ltr project 20160 4 5 anoth way repres symbol lu factor structur unsymmetr matrix use direct acycl graph see exampl 14 15 structur costli complic handl tree captur better asymmetri matrix davi du 6 implicitli use structur drive unsymmetricpattern multifront approach explain articl use simpl elimin tree structur symmetr matrix detect numer factor phase structur asymmetri factor show new factor phase signicantli reduc comput time size lu factor total memori requir respect standard multifront approach 13 section 2 rst recal main properti elimin tree describ standard multifront factor algorithm introduc new algorithm use simpl exampl show benet expect new approach section 3 set test matric introduc analys perform gain term size factor memori requir factor time new approach respect standard multifront code set test matric add conclud remark section 4 2 descript multifront factor algorithm let unsymmetr matrix let denot structur symmetr matrix aa elimin tree dene use structur choleski factor matrix reduc tree forest liu 18 dene elimin tree transit reduct direct graph choleski factor character elimin tree descript properti beyond scope articl context interest elimin tree comput graph multifront factor complet descript elimin tree reader multifront approach actual use amalgam elimin tree refer assembl tree 12 obtain classic elimin tree node assembl tree correspond gaussian elimin oper full submatrix call frontal matrix frontal matrix partit shown figur 1 fulli sum row partli sum row fulli sum column partli sum column figur 1 partit frontal matrix frontal matrix factor involv comput block column l term fulli sum column frontal matrix block row u term fulli sum row comput schur complement matrix f 22 f 21 f 1 call contribut block row column f 22 block refer partli sum row column origin nonzero new entri figur 2 exampl matrix unsymmetr matrix lefthand side figur 2 use illustr main properti assembl tree introduc new algorithm figur 2 3 x denot nonzero posit origin matrix correspond new entri introduc symmetr figur 3 indic structur lled matrix matrix choleski factor entri f correspond llin entri l factor f f f origin nonzero fillin wrt new entri figur 3 structur choleski factor matrix matrix f use dene assembl tree see figur 4 associ multifront lu factor matrix fact factor base assembl tree associ choleski factor f result struct denot matrix pattern let us denot structur zero numer zero result numer cancel typic due symmetr matrix might contain mani structur zero propag numer factor phase motiv work follow question possibl process assembl tree ecient detect remov structur zero appear matrix f direct indirect consequ symmetr although clear structur matrix f show block structur zero identi process assembl tree follow rst describ assembl tree exploit standard multifront algorithm report analys sparsiti structur frontal matric involv process assembl tree associ exampl matrix base observ introduc new factor algorithm assembl tree root node tree call root chosen give orient tree process leaf node root node two node adjac tree one nearer root parent node term child edg assembl tree indic data depend parent child involv send contribut block child parent parent node process start process associ children complet u u u u origin nonzero arrowhead var 3 contribut block root 2 1 figur 4 assembl tree associ test matrix exampl figur 4 node 3 must wait complet node 1 2 start comput subset variabl use pivot boldfac variabl figur 4 fulli sum variabl node k contribut block children entri origin matrix correspond fulli sum variabl node k use build frontal matrix node refer assembl process assembl process frontal matrix need fulli sum variabl j access nonzero element origin matrix rowscolumn indic greater j way ecient access origin matrix store arrowhead accord reorder matrix exampl assembl process node 3 arrowhead variabl 3 4 matrix togeth contribut block node 1 2 use assembl frontal matrix node 3 one note construct list indic partli sum row ident partli sum column row column indic block f 22 figur 1 therefor assembl process list row indic partli sum row built list obtain merg row column indic arrowhead matrix row indic contribut block son structur frontal matrix built numer valu arrowhead contribut block assembl right place frontal matrix oat point oper involv assembl process refer assembl oper addit wherea oatingpoint oper involv factor frontal matric refer elimin oper partial threshold pivot use control element growth factor note pivot chosen within block f 11 frontal matrix lu factor correspond fulli sum variabl comput new contribut block produc fulli sum variabl node k elimin node process numer consider correspond arrowhead frontal matrix ad contribut block fulli sum variabl includ fulli sum variabl parent node k process creat addit llin lu factor multifront algorithm provid space frontal matric contribut block reserv space store factor need work space store real integ inform refer total work space factor phase integ array use describ frontal matrix correspond lu factor contribut block manag integ work array thu done simpl ecient way uniprocessor environ possibl determin order assembl tree process furthermor process assembl tree depth rst search order use stack manag storag factor contribut block mechan ecient term total memori requir amount data movement see 12 stack mechan start begin real work array use store lu factor anoth stack mechan start end real work array use store contribut block assembl phase node work space use contribut block children freed assembl tree process depth rst search order contribut block alway top stack remaind paper maximum stack size contribut block refer maximum stack size standard new algorithm multifront factor multifront factor frontal matrix view minimum structur perform elimin fulli sum variabl carri contribut block son figur 5 closer look frontal matric involv process assembl tree figur 4 identifi structur zero report besid node structur factor frontal matrix assum pivot chosen diagon fulli sum block order ie numer pivot requir x correspond nonzero entri correspond structur zero one see exampl frontal matric mani structur zero two kind structur zero form complet zero column row isol zero entri nonzero column row exampl entri 43 47 e standard algorithm frontal matrix node 3 one know detect partli sum row column structur zero correspond row column suppress frontal matrix row column add contribut father node structur zero row column detect assembl process frontal matrix follow properti row column index appear row column indic arrowhead origin matrix contribut block son index correspond row column structur zero properti use deduc assembl process new algorithm note matrix structur decient fulli sum row column must least one nonzero entri therefor restrict search zero row column partli sum row column new assembl algorithm list indic partli sum row frontal matrix dene merg row indic arrowhead fulli sum variabl node row indic contribut block son column indic dene similarli illustr figur 6 new assembl process result signic modic process assembl tree exampl node 1 row 3 column 5 suppress frontal matrix node 2 partli sum row suppress node 3 row 7 column 5 suppress notic figur 6 frontal matric natur becom unsymmetr structur nalli indic figur 7 structur lu factor obtain new algorithm figur process assembl tree associ matrix figur 2 use new algorithm compar matrix f figur 3 show structur factor obtain standard algorithm seen nonzero entri correspond origin nonzero fillin wrt new entri figur 7 structur lu factor obtain new algorithm llin exampl 74 f introduc symmetr exampl f might suppress new algorithm hand new algorithm never suppress structur zero block fulli sum variabl exampl 43 node 3 figur 5 small exampl total number entri factor reduc 31 23 compar figur 5 6 one notic new algorithm might also lead signic reduct number oper involv assembl process maximum stack size latest combin reduct size factor result reduct total work space exampl number assembl oper drop 30 20 18 entri plu 2 contribut block maximum stack size reduc 8 1 obtain case stack contribut block node 1 2 3 result perform analysi describ tabl 1 set test matric order number nonzero entri structur symmetri origin dene structur symmetri percentag number nonzero match nonzero symmetr locat total number entri symmetr matrix valu 100 although perform analysi focu matric rel small structur symmetri class unsymmetr matric repres set select matric come forthcom rutherfordbo spars matrix collect 8 1 tim davi collect 2 sparsekit2 3 harwel subroutin librari 16 code ma41 use obtain result standard multifront method factor phase ma41 modi new algorithm ma41 code set paramet control ecienc use default valu target comput approxim minimum degre order 1 use reorder matrix mention introduct often quit beneci unsymmetr matric preced order perform unsymmetr permut place larg entri diagon scale matrix diagon entri modulu one odiagon modulu less equal one use harwel subroutin librari code mc64 10 perform preorder scale matric structur symmetri smaller 55 mc64 use matric alway row column scale rowcolumn divid maximum valu result present section obtain one processor r10000 mimp risc 64bit processor sgi cray origin 2000 parallab univers bergen norway processor run frequenc 195 mhertz peak perform 400 op per second web page httpwwwcseclrcacukactivitysparsematric web page httpwwwciseufledu davisspars 3 web page httpiftpcsumnedupubspars matrix name order entri strsym origin disciplin av4408 4408 95752 0 vavasi partial di eqn 21 bbmat 38744 1771722 54 rutherfordbo cfd cavity26 4562 138187 95 sparsekit2 cfd ex11 16614 1096948 100 sparsekit2 cfd goodwin 7320 324784 64 davi cfd lhr14c 14270 307858 1 davi chemic engin lhr17c 17576 381975 0 davi chemic engin lhr34c 35152 764014 0 davi chemic engin lhr71c 70304 1528092 0 davi chemic engin ln 3937 3937 25407 87 rutherfordbo cfd rutherfordbo econom rutherfordbo demographi raefsky6 3402 137845 2 davi structur engin rutherfordbo chemic engin rim 22560 1014951 sherman5 3312 20793 78 rutherfordbo oil reservoir simul shyy161 76480 329762 77 davi cfd twoton 120750 1224224 28 davi circuit simul wang4 26068 177196 100 rutherfordbo semiconductor tabl 1 test matric strsym denot structur symmetri follow graph report perform ratio new factor algorithm standard algorithm matric sort increas structur symmetri matrix factor ie applic column permut mc64 use use matrix order graph complet set result provid tabl 2 3 way one easili nd given point graph correspond entri tabl complet set test matric rst analys figur 8 probabl main concern user spars solver ie time factor matrix total work space dene previou section figur 8 divid matric three categori matric structur symmetri smaller 50 time reduct 20 80 matric whose structur symmetri 50 80 time reduct 3 20 nearli structur symmetr matric almost dierenc standard new version interest notic even symmetr matric ad work detect asymmetri aect much perform factor remaind paper report result almost structur symmetr matric symmetri greater 80 43 43 48 new standard version total work space figur 8 studi factor time total work space sy abscissa correspond structur symmetr matric figur 9 relat gain factor time reduct number elimin oper number assembl oper although number oper due assembl alway much smaller number oper involv factor see tabl 2 3 assembl process still repres import part time spent factor phase see exampl 2 illustr figur 9 see high reduct number assembl oper 50 signicantli contribut reduc factor time note rel larg matrix twoton symmetri 57 still signic gain time number assembl oper 40 obtain figur 10 relat total work space reduct size factor maximum stack size although reduct maximum size stack might alway introduc reduct total work space see practic often case extrem exampl reduct matrix orani678 symmetri 9 see tabl 2 maximum stack size reduc one order magnitud 5482454 457312 final notic larg reduct maximum stack size figur 10 gener correspond larg reduct number assembl oper figur 9 structur symmetri new standard version oper factor oper assem figur 9 impact reduct number oat point oper time 43 43 48 new standard version maximum size stack space lu factor total work space figur 10 correl factor size maximum stack size total work space matrix total oper facto strsym version lu stack space elimin assemb time raefsky6 stnd 1509016 606458 2017106 4795e08 4348e06 217 2 new 998064 145575 1119135 2313e08 1049e06 114 raefsky5 stnd 1757680 378792 2095082 3746e08 3874e06 183 av4408 stnd 551354 227787 677254 6872e07 1451e06 046 lhr14c stnd 2167304 415090 2439502 2092e08 7944e06 177 lhr34c stnd 5613656 755710 6249187 6282e08 2064e07 524 lhr17c stnd 2813418 639172 3204801 3089e08 1085e07 265 lhr71c stnd 11615170 729857 12711920 1402e09 4304e07 1316 twoton stnd 22086166 15899616 34489449 2933e10 2171e08 18384 onetone1 stnd 4713485 3348215 6212037 2282e09 2675e07 1454 rdist1 stnd 258096 53767 279999 8150e06 5054e05 013 tabl 2 comparison standard stnd new algorithm matric structur symmetri 50 matrix total oper facto strsym version lu stack space elimin assemb time bbmat stnd 44111480 8351266 48035816 3676e10 2283e08 18575 utm3060 stnd 324640 78679 806970 2683e07 6973e05 022 utm5940 stnd 701496 131839 2799224 6640e07 1529e06 051 onetone2 stnd 2253553 898540 385816 5085e08 7628e06 388 goodwin stnd 1264140 307777 1385604 1612e08 2841e06 105 rim stnd 4127204 833290 4371615 5648e08 9194e06 337 shyy161 stnd 7437816 377535 290589 9945e08 1178e07 656 shyy41 stnd 251336 28523 8137032 1036e07 6337e05 014 sherman5 stnd 167412 61227 217769 1284e07 4414e05 013 ln 3937 stnd 285517 89578 335285 1920e07 5482e05 020 cavity15 stnd 202629 33004 230111 1033e07 3453e05 010 cavity26 stnd 394164 58589 447293 2433e07 6877e05 022 ex11 stnd 11981558 3960507 13614400 6678e09 3836e07 2776 fidapm11 stnd 15997220 4863371 19069150 9599e09 4705e07 3978 olaf1 stnd 5880174 1506068 6794919 1965e09 1685e07 891 wang4 stnd 11561486 5063375 15900237 1048e10 4087e07 4619 tabl 3 comparison standard stnd new algorithm matric structur symmetri 50 conclud remark describ modic standard multifront lufactor algorithm lead signic reduct comput time total work space standard multifront algorithm 13 unsymmetr matric base assembl tree symmetr matrix involv frontal matric symmetr structur therefor produc lu factor matrix f lu symmetr structur approach current use context two public avail packag ma41 2 3 mump 5 4 advantag respect unsymmetr factor algorithm 6 7 17 lu factor base process assembl tree approach explicitli implicitli use complex handl graph structur demonstr base assembl tree one deriv new multifront algorithm introduc asymmetri frontal matric matrix factor f detect asymmetri base structur inform costli comput illustr structur symmetr matric algorithm behav similarli set unsymmetr matric shown new algorithm reduc factor size number oper signic factor also observ reduct number indirect memori access oper involv assembl process gener much higher reduct number elimin oper final notic gain maximum stack size also rel high compar gain number assembl oper space oper lu stack total elim assemb time mean 079 035 069 067 041 059 median 080 035 076 068 040 061 50 structur symmetri 80 mean 093 085 093 089 082 086 median 095 091 095 093 089 090 tabl 4 perform ratio new algorithm standard algorithm conclud report tabl 4 summari result mean median obtain test matric structur symmetri smaller 80 unsymmetr matric structur symmetri smaller 50 obtain averag reduct 31 total work space 41 factor time maximum stack size number assembl oper reduc respect 65 59 final interest observ even fairli symmetr matric 50 structur symmetri 80 still worth tri identifi exploit asymmetri process assembl tree acknowledg want thank horst simon esmond ng gave us opportun work nersc lbnl one year grate sherri li help comment earli version paper r exploit structur symmetri unsymmetr spars symbol factor elimin structur unsymmetr spars lu factor scalabl spars direct solver use static pivot role elimin tree spars factor multifront method spars matrix solut theori practic new implement spars gaussian elimin tr ctr gianmarco manzini mario putti mesh lock effect finit volum solut 2d anisotrop diffus equat journal comput physic v220 n2 p751771 januari 2007 abdou guermouch jeanyv lexcel construct memoryminim schedul multifront method acm transact mathemat softwar tom v32 n1 p1732 march 2006 xiaoy li jame w demmel superludist scalabl distributedmemori spars direct solver unsymmetr linear system acm transact mathemat softwar tom v29 n2 p110140 june timothi davi column preorder strategi unsymmetricpattern multifront method acm transact mathemat softwar tom v30 n2 p165195 june 2004 wook ryol hwang martien hulsen han e h meijer direct simul particl suspens slide biperiod frame journal comput physic v194 n2 p742772 march 2004 see jo kim wook ryol hwang direct numer simul droplet emuls slide biperiod frame use levelset method journal comput physic v225 n1 p615634 juli 2007