algorithm find largest approxim common substructur two tree abstractord label tree tree node label lefttoright order children fix tree mani applic vision pattern recognit molecular biolog natur languag process consid substructur order label tree connect subgraph given two order label tree integ largest approxim common substructur problem find substructur u1 t1 substructur u2 t2 u1 within edit distanc u2 exist substructur v1 t1 v2 t2 v1 v2 satisfi distanc constraint sum size v1 v2 greater sum size u1 u2 present dynam program algorithm solv problem run fast fastest known algorithm comput edit distanc two tree distanc allow common substructur constant independ input tree demonstr util algorithm discuss applic discov motif multipl rna secondari structur order label tree b introduct order label tree tree node label lefttoright order children fix 1 tree mani applic vision pattern recognit molecular biolog natur languag process includ represent imag 12 pattern 2 10 secondari structur rna 14 frequent use disciplin well larg amount work perform compar two tree base variou distanc measur recent gener one commonli use distanc measur name edit distanc root unroot unord tree work laid foundat use compar graph 15 24 paper extend previou work consid largest approxim common substructur problem order label tree variou biologist 5 14 repres rna secondari structur tree find common pattern also known motif secondari structur help predict rna fold 5 function studi rna process mechan 14 previou method detect motif rna molecul tree base one follow two approach 1 transform tree sequenc use sequenc algorithm 13 2 repres molecul use highli simplifi tree structur search common node tree 5 neither two approach satisfactorili take full tree structur account contrast util propos algorithm pair tree enabl one locat treestructur motif occur multipl rna secondari structur experiment result concern rna classif show signific motif 23 preliminari 21 edit distanc map use edit distanc 17 measur dissimilar two tree three type edit oper ie relabel delet insert node relabel node n mean chang label n delet node n mean make children n becom children parent n remov n insert invers delet insert node n child node n 0 make n parent consecut subsequ current children n 0 fig 1 illustr edit oper purpos work assum edit oper unit cost edit distanc simpli distanc tree 1 tree 2 denot cost minimum cost sequenc edit oper transform 2 17 notion edit distanc best illustr concept map map graphic specif edit oper appli node two tree exampl map fig 2 show way transform 1 2 transform includ delet two node label 1 insert 2 1 throughout paper shall refer order label tree simpli tree ambigu occur c r b r r r f c r r f e f f fig 1 relabel chang one node label anoth b ii delet delet node children delet node label b becom children parent label r iii insert insert node consecut sequenc sibl among children node label r f left g becom children newli insert node label b r b c e pt r b c e pt fig 2 map tree t1 tree t2 use postord number node tree let ti repres node whose posit lefttoright postord travers confus also use ti repres label node ti formal map 1 2 tripl simpli context clear set order pair integ ii pair onetoon left 1 left 2 preserv ancestor 1 ancestor 2 j 2 ancestor order preserv condit cost cost delet node 1 touch map line plu cost insert node 2 touch map line plu cost relabel node pair relat map line differ label prove 17 ffit 1 equal cost minimum cost map tree 1 tree 2 22 cut oper defin substructur u tree connect subgraph u root node n gener cut subtre subtre root n formal let repres subtre root ti oper cut node ti mean remov set node k said set consist subtre cut k ti 2 impli ti node k ii ti tj 2 impli neither ancestor k intuit set root remov subtre k use cutt repres tree subtre remov node let subtreest set possibl set consist subtre cut given two tree 1 2 integ size largest approxim common rootcontain substructur within distanc 2 j denot fit 1 j simpli fii j context clear maxfjcutt 1 jg subject fficutt 1 j find largest approxim common substructur lac within distanc 1 2 j amount calcul max 1ui1vj ffit 1 v dg locat cutt 1 v achiev maximum size size lac within distanc 1 2 dg shall focu comput maximum size memor size inform comput simpl backtrack techniqu one find maximum size one correspond substructur pair yield size time space complex 3 algorithm 31 notat use desci repres set postord number descend node ti li denot postord number leftmost leaf subtre leaf order forest tree induc node number j inclus see fig 3 j definit map order forest tree let f 1 f 2 two forest distanc f 1 f 2 denot deltaf 1 cost minimum cost map f 2 25 set node f said set consist subtre cut f tp 2 impli p j ii tp tq 2 impli neither ancestor f use cutf repres subforest f subtre remov node let subtreesf set possibl set consist subtre cut f defin size largest approxim common rootcontain substructur within distanc k f 1 f 2 denot psif 1 k subject deltac utf 1 li f 2 ljt also repres confus 10 3 5 6 8 6 3 fig 3 induc order forest 32 basic properti lemma 31 suppos 2 desci 2 descj proof immedi definit lemma 32 suppos 2 desci 2 descj k 1 k ae psit 1 ae psi 2 proof follow definit ii suppos li smallest set consist subtre cut maxim jcutt 1 j deltacutt 1 follow two case must hold 1 1 1 true psit 1 li 1 iii prove similarli ii lemma 33 suppos 2 desci 2 descj ls 6 li lt 6 lj proof suppos li 2 2 subtreest 2 ljt two smallest set consist subtre cut maxim jcutt 1 j deltac utt 1 least one follow case must hold case 1 1 ie subtre 1 remov psili ljt case 2 2 ie subtre 2 remov psili ljt case 3 1 2 ie neither 1 remov fig 4 let map cost 0 cutt 1 cutt 2 1 must map otherwis distanc zero cutt 1 therefor psili ljt sinc three case exhaust possibl map yield psili ljt 0 take maximum correspond size give formula assert lemma fig 4 illustr case one t1 li t2 ljt forest neither t2 remov lemma 34 suppos 2 desci 2 descj suppos 1 ljt tree ie proof sinc first consid case 1 two smallest set consist subtre cut maxim jcutt 1 j fficutt 1 map cost 0 cutt 1 fig 5 clearli 1 must map 2 furthermor largest common rootcontain substructur must largest common rootcontain substructur 1 2 mean psili ljt 2 2 obtain includ two node 1 next consid case 1 6 2 ie root two tree 1 2 differ order get distanc zero two tree appli cut oper remov tree entir thu psili ljt fig 5 illustr case t1 li t2 ljt tree t1 lemma 35 suppos 2 desci 2 descj ls 6 li lt 6 lj k 1 k proof suppos two smallest set consist subtre cut maxim jcutt 1 j deltac utt 1 k least one follow case must hold case 1 1 psili ljt case 2 case 3 1 2 let minimum cost map cutt 1 three subcas examin touch line psili ljt b 2 touch line psili ljt touch line exist h psili ljt h valu h rang 0 k therefor take maximum correspond size ie psili ljt hg lemma 36 suppos 2 desci 2 descj suppos 1 li 2 ljt tree ie ae proof sinc ljt tree 1 first show remov either 1 2 would yield maximum size three case consid case 1 1 remov psili ljt cut children 1 would caus psili ljt 2 therefor remov 1 2 yield maximum size case 2 1 remov psili ljt k assum without loss gener jt 2 k equat impli remov subtre 2 k node left 2 thu psili ljt hand cut children 1 leav 1 tree would map 1 2 would lead psili ljt 1 thu remov 1 alon yield maximum size case 3 2 remov proof similar case 2 argument lead conclus order obtain maximum size neither 1 remov suppos 2 2 subtreest 2 two smallest set consist subtre cut maxim jcutt 1 j fficutt 1 minimum cost map cutt 1 cutt 2 least one follow case must hold case 1 1 touch line psili ljt case 2 2 touch line psili ljt case 3 1 touch line ancestor order preserv sibl order preserv condit map cf section 21 must thu 1 psili ljt map 1 2 cost 1 psili ljt 2 33 algorithm lemma 34 lemma 36 observ path li path lj j need comput fi k 0 k separ sinc obtain comput fii j k thu consid node either root tree left sibl let keynodest contain node tree ie k g fig 6 comput fi procedur findlargest2 fig 6 comput fi main algorithm summar fig 6 calcul size largest approxim common substructur lacss within distanc 1 2 j build bottomup fashion anoth array fli use fii j follow let postord number children 1 leaf let postord number children 2 j rg size lacss within distanc 1 2 j fli j size lacss within distanc consid complex algorithm use array hold psi fi fl respect array requir od theta jt 1 j theta jt 2 space regard time complex given fii calcul fli j requir ojt 1 j theta jt 2 time fix j procedur findlargest total time bound ij theta jt 2 ij theta 25 theorem 2 last term bound od 2 theta jt 1 j theta jt 2 j theta minh 1 height l number leav constant complex best current algorithm tree match base edit distanc 11 25 even though problem hand appear harder tree match note calcul max 1ijt1 j1jjt2 j ffii j 0g one could use faster algorithm run time ojt 1 j theta jt 2 j howev reason consid keynod formula specifi lemma 33 34 prepar optim size forest forest store size valu array use calcul fi could incorpor faster algorithm findlargest algorithm overal time complex would chang calcul fi domin cost 4 implement discuss appli algorithm find motif multipl rna secondari structur experi examin three phylogenet relat famili mrna sequenc chosen genbank 1 pertain polioviru human rhinoviru coxsackieviru famili contain two sequenc shown tabl 1 algorithm findlargest input tree 1 integ output fii j 1 jkeynodest1j 1 jkeynodest2j begin run procedur findlargest1 input j 0 run procedur findlargest2 input j procedur findlargest1 input output fi li lj j li lj j ls 6 li lt 6 lj comput psili ljt 0 lemma 33 els begin comput psili ljt 0 lemma 34 fi procedur findlargest2 input output fi k 1 k 1 li comput psit 1 li k lemma 32 ii k 1 lj j comput psi t2 ljt k lemma 32 iii k 1 li lj j ls 6 li lt 6 lj comput psili ljt k lemma 35 els begin comput psili ljt k lemma 36 fi fig 6 algorithm comput fii j k famili sequenc tree file polioviru polio3 sabin strain 3026 file 1 pol3mut 3000 file 2 human rhinoviru rhino 2 3000 file 3 coxsackieviru cox5 3000 file 5 tabl 1 data use experi physiolog condit ie room temperatur rna molecul take singl structur may chang conform structur similar free energi trap local minima thu one consid optim structur structur within certain rang free energi hand loos rule thumb real structur rna molecul appear top 5 10 suboptim structur sequenc base rank energi minimum energi one ie optim one top therefor fold 5 noncod region select mrna sequenc collect roughli top 3000 suboptim structur sequenc transform suboptim structur tree use algorithm describ 13 14 fig 7 illustr rna secondari structur tree represent structur decompos five term stem hairpin bulg intern loop multibranch loop 14 tree h repres hairpin node repres intern loop b repres bulg loop repres multibranch loop r repres helic stem region shown connect arc n special node use make sure tree connect tree consid order one order impos base upon 5 3 natur molecul result tree mrna sequenc select genbank store separ file tree 70 180 node cf tabl 1 tree repres fulli parenthes notat root everi subtre preced node contain subtre thu exampl tree depict fig 7ii repres nrirmrbrmrhrhrh pair tree 1 file ran algorithm findlargest 1 find size largest approxim common substructur within distanc 1 subtre pair 1 2 j locat one correspond substructur pair yield size substructur constitut candid motif calcul occurr number 2 candid motif ad variabl length dont care vldc new root leav form vldc pattern v compar v tree file use pattern match techniqu develop 26 convent denot match cost path portion path techniqu calcul minimum distanc v implicitli comput optim substitut vldc v allow zero cut node see fig 8 way locat motif approxim occur major 2 occurr number motif respect distanc k refer number tree file approxim occur ie tree approxim contain within distanc k tree file 3u u u g c u u u u g u u u u g g g g g g g u u g u u g c c g u g u u gu u u u g c g u u c u u u c g c c u u gfig 7 illustr typic rna secondari structur tree represent normal polygon represent structur ii tree represent structur tabl 2 summar result motif occur within distanc 0 least 350 tree correspond file tabl show number motif discov sequenc number distinct motif found common sequenc famili minimum maximum size common motif tabl 3 show big motif found common three famili number sequenc secondari structur contain motif motif serv start point conduct studi common motif analysi 3 22 3 one speed method encod candid motif suffix tree use statist sampl optim techniqu describ 23 find motif r b fig 8 match vldc pattern v tree pattern tree hypothet one sole use illustr purpos root v would match node two leav v would match node respect node would cut distanc v would 1 repres cost chang c v famili sequenc motif found common motif min size max size polioviru polio3 sabin strain 836 347 3 101 pol3mut 793 rhinoviru rhino 2 287 coxsackieviru cox5 306 136 3 20 cvb305pr 391 tabl 2 statist concern motif discov secondari structur mrna sequenc use experi motif found polio3 pol3mut rhino 2 rhino 14 cox 5 cvb305pr rbrbrbr 2272 1822 3000 2252 2997 2979 tabl 3 motif found common secondari structur polioviru human rhinoviru coxsack ieviru sequenc motif repres fulli parenthes notat root everi subtre preced node contain subtre motif tabl also show number sequenc suboptim structur contain motif propos algorithm discov motif also appli rna classif success 23 experiment result show one get intersect motif sequenc famili indic close motif correspond close famili anoth applic algorithm appli tree calcul fii j allow one find repeatedli occur substructur repeat short find repeat secondari structur across differ rna sequenc may help understand structur rna reader interest obtain program may send written request one author work base edit distanc origin 17 metric permiss worthi metric eg 18 19 20 therefor help locat subtl motif exist rna secondari structur algorithm present assum unit cost edit oper practic refin nonunit cost function reflect subtl differ rna secondari structur 14 would interest score measur detect common substructur repeat tree anoth interest problem find largest consensu motif 3 two input tree 1 2 3 largest tree 1 2 substructur within given distanc 3 comparison differ type common substructur see also 6 7 8 probabl base differ metric eg 18 19 20 well applic remain explor acknowledg wish thank anonym review construct suggest pointer relev paper also thank wojcieok kasprzak nation cancer institut nat goodman whitehead institut mit chiayo chang use comment implement effort work support nation scienc foundat grant iri9224601 iri9224602 iri9531548 iri9531554 natur scienc engin research council canada grant ogp0046373 r nucleic acid research waveform correl tree match secondari structur comput predict polio viru 5 align tree altern tree edit rna secondari struc ture comparison determin frequent recur substructur consensu largest common similar substructur problem tree embed plane largest common similar substructur root unord tree largest common similar substructur problem tree system approach fingerprint pattern recognit unifi view tree metric distanc transform imag repres quadtre algorithm compar multipl rna secondari structur compar multipl rna secondari structur use tree comparison structur descript inexact match exact approxim algorithm unord tree match treetotre correct problem metric root order tree base strongli structur preserv map comput method metric unroot unord tree bottomup comput method metric tree comput method treetotre edit problem cardiovirul phenotyp coxsackieviru b3 determin singl site genom 5 autom discoveri activ motif multipl rna secondari structur algorithm graph optim monomorph simpl fast algorithm edit distanc tree relat problem approxim tree match presenc variabl length dont care edit distanc undirect acycl graph tr ctr roger keay andri rakotoniraini contextori program proceed 3rd acm intern workshop data engin wireless mobil access septemb 1919 2003 san diego ca usa vilar f j ribada j graa approxim common pattern sharedforest proceed tenth intern confer inform knowledg manag octob 0510 2001 atlanta georgia usa rolf backofen sven siebert fast detect common sequenc structur pattern rna journal discret algorithm v5 n2 p212228 june 2007 bhowmick wee keong ng sanjay madria constraintdriven join process web warehous data knowledg engin v45 n1 p3378 april c rei p b golgher silva f laender automat web news extract use tree edit distanc proceed 13th intern confer world wide web may 1720 2004 new york ny usa ada ouangraoua pascal ferraro laurent tichit serg dulucq local similar quotient order tree journal discret algorithm v5 n1 p2335 march 2007 thoma kmpke distanc pattern structur similar journal machin learn research 7 p20652086 1212006 n bourbaki p yuan makrogianni object recognit use wavelet lg graph synthesi region pattern recognit v40 n7 p20772096 juli 2007 bhowmick sanjay kumar madria wee keong ng detect repres relev web delta whoweda ieee transact knowledg data engin v15 n2 p423441 februari dmitriy bespalov ali shokoufandeh william c regli wei sun scalespac represent 3d model topolog match proceed eighth acm symposium solid model applic june 1620 2003 seattl washington usa jiang andrea munger horst bunk median graph properti algorithm applic ieee transact pattern analysi machin intellig v23 n10 p11441151 octob 2001 yanhong zhai bing liu web data extract base partial tree align proceed 14th intern confer world wide web may 1014 2005 chiba japan jun huan wei wang deepak bandyopadhyay jack snoeyink jan prin alexand tropsha mine protein famili specif residu pack pattern protein structur graph proceed eighth annual intern confer resaerch comput molecular biolog p308315 march 2731 2004 san diego california usa