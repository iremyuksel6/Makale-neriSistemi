fast finit volum simul 3d electromagnet problem highli discontinu coeffici consid solv threedimension electromagnet problem paramet regim quasistat approxim appli permeabl permitt conduct may vari significantli difficulti encount includ handl solut discontinu across interfac acceler converg tradit iter method solut linear system algebra equat aris discret maxwel equat frequenc domainth present articl extend method propos earlier constant permeabl e haber u ascher aruliah oldenburg j comput phi 163 2000 pp 150171 aruliah u ascher e haber oldenburg math model method appl sci appear handl also problem permeabl variabl may contain signific jump discontinu order address problem slow converg reformul maxwel equat term potenti appli helmholtz decomposit either electr field magnet field null space curl oper annihil ad stabil term use gaug condit thu obtain strongli ellipt differenti oper stagger grid finit volum discret subsequ appli reformul pde system scheme work well sourc variou type even presenc strong materi discontinu conduct permeabl result discret system amen fast converg iluprecondit krylov methodsw test method use sever numer exampl demonstr robust effici also compar classic yee method use similar iter techniqu result algebra system show method significantli faster especi electr sourc b introduct need calcul fast accur solut threedimension electromagnet equat aris mani import applic area includ among other geophys survey medic imag 29 32 2 cons quentli lot effort recent invest find appropri numer algorithm howev wide agre electromagnet phenomena gener govern maxwel equat choic numer techniqu solv equat depend paramet rang variou restrict assumpt signific degre applicationdepend 20 32 2 present articl motiv remot sens invers problem eg geophys one seek recov materi properti especi conduct isotrop heterogen bodi base measur electr magnet field near earth surfac forward model concentr consist maxwel equat frequenc domain frequenc rang exclud high frequenc assum timedepend e gammat equat written r r theta h gamma b r r magnet permeabl oe conduct ffl electr permitt j known sourc current densiti ae unknown volum densiti free charg work assum physic properti 0 vari posit ffl 2 l 2 1 l typic length scale electr field e magnet field h unknown charg densiti defin 1c note long redund view invari system obtain take rdelta 1a system 1 defin threedimension spatial domainomegagamma principl domainomega unbound ie practic bound subdomain ir 3 use numer approxim paper use boundari condit h theta n although boundari condit possibl number difficulti aris attempt find numer solut threedimension pde system difficulti includ handl region almost vanish conduct handl differ resolut differ part spatial domain handl multipl scale length physic properti vari handl region highli vari conduct magnet permeabl electr permitt jump solut properti across interfac may occur hand natur data eg measur electr andor magnet field surfac earth one hope recov fine detail structur conduct oe permeabl therefor envis accord invers problem interest possibl nonuniform tensor product grid cover domainomegagamma b oe assum smooth even constant insid grid cell may signific jump discontinu occur anywher inomega across cell interfac sourc j also assum jump across interfac rel geometr simplic result model assumpt key obtain highli effici solver forward problem denot quantiti differ side interfac subscript 1 2 easili shown 33 across interfac n theta condit impli neither e h continu normal direct b oe resp jump discontinu across cell face likewis b oee h necessarili continu tangenti di rection care must therefor exercis numer method employ util variabl defin doublevalu far popular discret maxwel equat yee method 37 see discuss extens 32 26 19 method employ stagger grid necessit short center first differ discret 1a 1b usual applic method electr field compon envis cell edg magnet field compon cell face see fig 1 possibl h z x z figur 1 stagger discret e h three dimens e compon edg hcompon face elimin compon magnet field discret equat obtain stagger discret second order pde e r theta gamma1 r theta e gamma relat method includ finit integr techniqu certain mix finit element method 35 5 25 although method often present context timedomain maxwel equat issu aris appli implicit timediscret suitabl techniqu model assumpt often similar one face popular yee method due part conserv properti way discret system mimic continu system 19 15 5 4 howev iter method solv discret system may converg slowli low frequenc due presenc rich nontrivi null space curl oper addit difficulti aris highli discontinu coeffici present 29 24 16 two major reason difficulti first conduct essenti vanish exampl air form part omegagamma analyt perspect specif subset maxwel equat use typic form almostsingular system region almostvanish b oe even region conduct close vanish result differenti oper strongli coupl strongli ellipt 6 1 second case larg jump discontinu care must taken handl h b care sinc locat fig 1 potenti discontinu 1 address often slow converg iter method use equat result discret 5 appli helmholtz decomposit first obtain potenti formul coulomb gaug condit chang variabl use also 3 12 22 28 among mani other split electr field compon activ null space curl oper reformul reminisc pressurepoisson equat incompress navierstok equat 14 31 yield system strongli ellipt weakli coupl pde standard precondit krylov space method directli applic 15 address possibl signific jump conduct assum constant employ finit volum discret stagger grid akin yee method locat e h compon exchang fig 2 normal compon e doublevalu taken care eleg way helmholtz decomposit e introduc gener current x z figur 2 stagger discret e h three dimens e compon face hcompon edg equat curl oper 5 replac vector laplacian accord vector ident r theta rtheta suffici smooth vector function e paper gener approach 1 15 case magnet permeabl may highli discontinu well realist case interest geophys applic although usual jump conduct domin jump permeabl role e h essenti dual possibl appli helmholtz decomposit either e h keep unknown vector function intact choos decompos electr field e refer fig 2 locat hunknown ensu discret major departur previou work fact ident 7 directli extend oper r theta gamma1 rtheta appear 5 howev stabil oper subtract r form basi propos method case constant magnet permeabl electr conduct formul reduc previou formul 15 variant thereof approach deal possibl discontinu view use flux continu cell face vortic continu cell edg introduct unknown strongli connect mix finit element use highli discontinu problem 7 8 16 paper laid follow section 2 reformul maxwel equat way enabl us extend method result system amen discret use finitevolum techniqu describ section 3 extens gener approach 1 15 present articl without price price ad complic sparsiti structur result discret system correspond ad cost iter solut system briefli describ applic krylov space method solv system algebra equat section 4 use bicgstab see eg 30 togeth one two precondition incomplet block ludecomposit power precondition case diagon domin linear system ssor system diagon domin direct consequ analyt formul present result numer experi section 5 compar result obtain use method obtain use tradit yee discret sourc divergencefre case electr magnet sourc method better two order magnitud method work well also case problem coeffici vari rapidli conclud short summari remark 2 reformul maxwel equat maxwel equat 1a 1b view flux balanc equat ie term describ flux aris differ physic con sider equat driven conserv flux fact origin develop 23 therefor 1a 1b flux term balanc 1b gener current densiti b j defin 6 balanc sourc flux aris magnet field 1a magnet flux balanc flux aris electr field context flux welldefin cell face may multivalu cell edg 1 furthermor lead differenti oper 5 say nontrivi null space rather devis iter method directli take account eg 2 16 transform equat discret decompos e compon activ space null space curl oper r could decompos h instead similar way would decompos chosen concentr decomposit e substitut equat obtain r theta gamma r theta h gamma b r furthermor 5 becom r theta gamma1 r theta r note across interfac distinct conduct media addit 4 n theta ae 12c electr surfac charg densiti condit differenti equat 1 impli b hcurlomegagamma4 see eg 13 moreov roe inherit discontinu e delta n continu r delta r theta bound cf 13 15 relat r theta r theta gammar 2 hold howev vari ident 7 extend directli must deal null space r theta differ way let us defin sobolev space equip usual norm see eg 13 kvk omegagamma4 l use right hand side 13b green formula yield u 2 r theta usual notat inner product l 2omegagamma l 2omegagamma2 3 use thu u 2 w r theta gamma1 r theta u u may therefor stabil 11a subtract vanish term r theta gamma1 r theta obtain strongli ellipt oper provid 2 w 0omegagamma4 latter condit guarante choic 17b similar stabil penalti approach studi mix success 10 20 howev experi thu recommend posit discret util elabor upon point next section use 10c write 10b r theta h gamma may advantag case discontinu similarli mix formul use simpl divgrad system r 7 27 8 11 elsewher final step reformul replac 15 gaug condit 10c indirect one obtain upon take rdelta 15a simplifi use 15b 10c achiev weak coupl result pde system note replac gaug condit 10c similar pressur poison equat cfd 31 14 complet system discret next section written r theta h gamma order complet specif system must add appropri boundari condit bc first note origin bc 3 written r theta theta n addit bc normal compon requir helmholtz decomposit 9 uniqu choos correspond 13c togeth 9 determin given e moreov sinc 16d obtain take rdelta 16a addit requir either oen oe note origin togeth pde 1b impli also latter relat 17c togeth 17b impli oe n 0 bound ari 23 condit determin oe constant pin constant arbitrarili eg requir z final note 17c togeth 16a 3 impli turn n 0 boundari sinc 16a 16d impli obtain j 0 thu retriev 10c pin 0 one addit point system 16 subject boundari condit 17 pin one point wellpos 3 deriv discret 15 employ finit volum techniqu stagger grid b locat cell face h cell edg oe locat cell center correspondingli discret 16d 16c center cell center 16e 16a center cell face 16b center cell edg variabl distribut grid cell summar tabl 1 approxim r delta u integr first cell use gauss diverg theoremj ijk j z e ijk r delta u z e ijk case origin bc differ 3 still use boundari condit asymptot valu infinit domain altern note possibl appli helmholtz decomposit h although gener good practic reason prefer decomposit 9 e 3 geophys applic j delta n vanish boundari x z j z j z h z tabl 1 summari discret grid function scalar field approxim grid function point slightli stagger cell e ijk grid use midpoint quadratur face evalu compon surfac integr appear righthand side thu defin express discret 16d 16c grid cell note assum uniform grid cell may differ width direct boundari condit use end point 19 next consid discret cell face follow 15 defin harmon averag boe neighbor cell xdirect h x 2 b oe assum constant cell integr evalu 2boe ijk 2boe i1jk result approxim xcompon 16e 15 x next discret 16a 37 write xcompon equat denot j discret center center cell xface result h z similar express 20c 21 deriv yand zdirect boundari condit 3 use close 21 use 20c elimin b j 19a obtain discret equat domin term involv oe result stencil oe 7 point also appli obviou quadratur singl condit 17d final discret edgecent 16b consid say xcompon 16b written integr equat surfac rectangl corner express left hand side integr use gauss curl theo rem right hand side averag direct obtain valu edg divid integr wish integr magnet flux potenti less smooth around edg magnet field yield z z k1 z k assum constant cell integr evalu h h z h z h z h z result approxim xcompon 16b ia h z z 22c use 19b well 22c similar express deriv zdirect substitut h 21 obtain discret system equat result stencil 19 point structur discret oper r theta gamma1 rtheta differ discret direct discret latter interfac natur defin arithmet averag harmon averag discret describ view care extens yee method suitabl discontinu coeffici amen fast iter solut method center conserv second order accu rate note throughout use consist compact discret oper rdelta rtheta r denot correspond discret oper r h r h immedi obtain follow ident cf 18 17 cours analogu vector calculu ident hold suffici differenti vector function boundari condit 17 discret use discret oper well next note upon appli r h delta 21 use 23b 19a obtain moreov 21 17c discret normal deriv vanish boundari well set 0 arbitrarili one point determin j 0 throughout domain grid function obtain anoth conserv properti scheme name discret divergencefre recal stabil term ad 14 exact solut term obvious vanish 24 assur us correspond discret term vanish well justifi use term stabil rather penalti case nodal finit element method consid 20 10 approxim solut satisfi 24 stabil term may grow size vari order magnitud els r h delta grow undesir attempt keep approxim constant across interfac 20 particular way averag across discontinu name arithmet averag cell edg harmon averag b oe cell face import averag view care approxim constitut relationship discontinu coeffici show look first relat across face whose normal direct x flux flow seri therefor approxim b oe repres bulk properti flow volum given harmon averag correspond arithmet averag resist next look relat edg variabl b x flux four cell share edg flow parallel impli need approxim edg arithmet averag note also use common implement yee method ie h cell face e cell edg role b oe interchang need averag harmon b oe arithmet 4 solut discret system elimin h b j discret equat obtain larg spars system grid function correspond oe oe b result discret oper r theta correspond discret oper rtheta likewis correspond discret oper diagon matrix result discret oper b oedelta c similarli aris cell edg cell center respect h repres discret r delta boerdelta region constant simplifi discret vector laplacian block weakli coupl interfac typic sparsiti structur h 1 variabl contrast constant display fig 3 structur obtain system similar 15 although main block diagon somewhat less pleasant note long frequenc low enough diffus number satisfi h maximum grid space matrix domin diagon block allow us develop block precondition good low frequenc base truncat ilu ilut decomposit major block 30 thu approxim k block diagon matrix use ilut obtain spars approxim decomposit k decomposit use precondition krylov solver note although k complex approxim k real therefor need appli ilu decomposit two real matric save memori note block approxim 26 make sens discret direct staggeredgrid discret 1 thu sparsiti structur constant sparsiti structur variabl figur 3 sparsiti structur matrix h 1 correspond variabl right constant left reformul subsequ discret maxwel equat allow us easili obtain good block precondition modular manner discret 1 5 numer exampl goal section demonstr efficaci propos method compar common discret system 1 util eg 24 29 use standard krylovtyp method precondition solv result discret system vari type sourc use size jump coeffici oe precondition grid size tabl iter denot number bicgstab iter need achiev rel accuraci number gigaflop requir ssor paramet use equal ilu threshold use equal 10 gamma2 latter threshold current matlab implement iter involv two precondition cost roughli 51 exampl set 1 deriv follow set experi let air permeabl permitt ffl assum cube constant conduct oe c permeabl c embed otherwis homogen earth conduct oe permeabl fig 4 typic geophys applic conduct may rang four order magnitud wherea permeabl rare chang one order magnitud therefor experi conduct oe c rang 10 gamma2 sm 10 3 sm permeabl c rang 0 1000 0 04 figur 4 set first numer experi cube conduct oe c permeabl c embed insid homogen earth conduct oe e permeabl e also air experi two differ sourc magnet sourc plane wave ii electr dipol sourc x direct center 0 0 0 fact first sourc magnet impli divergencefre sourc lie entir activ space curl oper contrast electr sourc divergencefre sourc assum oscil differ frequenc rang 1 10 6 hz solut obtain unless otherwis note nonuniform tensor grid see fig 4 consist cell 95232 unknown correspond grid 128000 complex unknown solv system use method describ previou section 511 exampl 1a order abl compar result linear algebra solver correspond yee method discret system r theta gamma1 r theta b use stagger grid depict fig 2 ie b j cell face similar discret 24 yield discret system unknown vector e correspond grid valu b jboe matric c defin section 4 b depend sourc order solv system well use bicgstab precondition comparison method case differ frequenc summar tabl 2 electr sourc magnet sourc iter oper iter oper 63 728 99 113 64 73 tabl 2 iter count comput effort method oe tradit implement yee method appli e b j exampl set 1 use electr sourc magnet sourc tabl 2 show method converg moder number iter sourc despit presenc signific jump oe hand tradit discret perform poorli electr sourc reason well magnet sourc slow converg direct stagger discret maxwel equat case electr sourc also report 29 e defin grid edg result clearli show advantag formul origin yee formul even simpl precondit especi electr sourc low frequenc circumst discret first term left hand side 27 strongli domin term residu cours bicgstab iter nontrivi compon null space oper henc reduct slow magnet sourc hand yield special situat long discret diverg roundoff error rel small residu compon null space lead term oper also small henc number iter use tradit method much larger use method 512 exampl 1b next test effect discontinu method use electr sourc record number bicgstab iter need method converg variou valu use blockilut precondit describ previou section result summar tabl 3 note larg jump discontinu oe significantli affect rate converg iter linear system solver method larg jump discontinu decis effect result similar spirit report 16 regard effect discontinu special multigrid method edgeel discret howev even larg discontinu number iter report tabl 3 remain rel small compar similar experi report 29 9 attribut increas number iter jump increas size correspond degrad condit number k 25 degrad howev depend strongli grid size verifi next tabl 3 iter count differ frequenc conduct permeabl exampl set 1 conductivityperm structur cube halfspac 513 exampl 1c next experi use cube model electr sourc evalu influenc grid number iter fix test method case modest coeffici jump case larg jump set uniform grid interv gamma1 1 3 consid grid record result number iter use ssor block ilu precondition result experi gather tabl 4 observ number iter increas number un grid size ilu ssor ilu ssor tabl 4 iter count differ grid two set problem coeffici use two precondition known increas increas appear roughli proport number unknown power 13 growth number iter function grid size also roughli similar precondition although block ilu requir fewer iter 14 grid howev ilu requir memori ssor may prohibit use larg problem increas rate also similar expect valu thu increas number iter function essenti depend grid size practic ever increas substanti may hard cope perhap unrealist larg valu use present techniqu 52 exampl 2 next experi consid complic earth structur employ random model use practition order simul stochast earth model 21 two distinct valu set oe probabl p assum conduct permeabl cell probabl valu oe probabl valu particularli difficult model work conduct permeabl may jump anywher one cell next necessarili across welldefin manifold crosssect model plot fig 5 carri experi frequenc rang 0 10 6 hz use random model differ conduct permeabl frequenc electr sourc domain gamma1 1 3 km employ uniform grid size 44 3 use block ilu ssor precondition result experi term conduct slice logsm figur 5 set exampl set 2 iter count summar tabl 5 result show solut method effect even highli vari conduct method deterior larg variat present also see tabl 5 block ilu precondition work well low frequenc effect high frequenc easi check case block ilu precondition fail achiev converg denot nc mean failur achiev residu gamma7 800 iter maximum grid space h satisfi oe h ae 1 case discret lead term differenti oper longer yield domin block matrix equat 25 therefor block ilu precondition fail thu high frequenc high conduct requir grid point order precondition effect also consist physic skin depth 36 decreas attenu wave simul fidel finer grid 6 summari remark paper develop fast finit volum algorithm solut maxwel equat discontinu conduct permeabl major compon approach follow ffl reformul maxwel equat helmholtz decomposit appli e stabil term ad result strongli ellipt system system written first order form allow flexibl ilu ssor ilu ssor ilu ssor tabl 5 iter count differ frequenc conduct permeabl exampl set 2 ensu discret final divergencefre coulomb gaug condit elimin use differenti substitut yield weakli coupl pde system enabl effici precondition larg spars algebra system result discret ffl discret use stagger grid respect continu condit care averag materi properti across discontinu discret stabil term vanish exact solut discret equat import case larg contrast ffl solut result linear system use fast precondit krylov method result algorithm test varieti problem shown dramat improv standard algorithm sourc electr good perform obtain even coeffici oe allow vari rapidli grid scale case prove challeng multigrid method project motiv us electromagnet invers problem geophys prospect 34 solv forward problem ie maxwel equat present articl major bottleneck data invers method inde may carri dozen hundr time data invers thu extrem fast solver problem discuss paper need base algorithm describ implement carri solv realist instanc forward problem less two minut singleprocessor pc enabl deriv realist algorithm low cost invers problem acknowledg wish thank dr doug oldenburg dave moulton fruit discuss anonym refere valuabl comment first two section exposit r method forward model 3d electromagnet quasistat problem adapt multilevel method edg element discret maxwel equat whitney form class finit element threedimension comput electromagnet multigrid solut ellipt flow problem mix hybrid finit element method finit element numer algorithm fditd fdfd simul slowli vari electromagnet feild theoret numer difficulti 3d vector potenti method finit element magnetostat compu tation black box multigrid geomagnet induct heterogen sphere azimuth symmetr test comput respons undul 660km discontinu finit element method navierstok equat pressur boundari condit incompress navierstok equat fast model 3d electromagnet use potenti multigrid method maxwel equat natur discret diverg gradient curl logic rectangular grid orthogon decomposit theorem mimet finit differ method mimet discret maxwel equat equat magnet diffus finit element method electromagnet electr conduct sandston exampl two dimension three dimension percol scalarvector potenti solut 3d em finitediffer model theoret concept physic three dimension magnetotellur model use differ equat theori comparison integr equat solut analysi finit volum converg analysi yee scheme nonuniform grid numer implement nodal method solut 3d eddi current problem finit element iterart method spars linear system multigrid solver steadi state navierstok equat use pressurepoisson formul comput electrodynam finitediffer timedomain method diadic green function electromagnet electromagnet theori geophys applic time domain electromagnet field comput finit differ method invers magnetotellur data one dimension conduct numer solut initi boundari valu problem involv maxwel equat isotrop media tr ctr eldad haber stefan heldmann octre multigrid method quasistat maxwel equat highli discontinu coeffici journal comput physic v223 n2 p783796 may 2007