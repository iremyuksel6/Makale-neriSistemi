improv graph color regist alloc describ two improv chaitinstyl graph color regist alloc first optimist color use stronger heurist find kcolor interfer graph second extend chaitin treatment remateri handl larger class valu techniqu complementari optimist color decreas number procedur requir spill code reduc amount spill code spill unavoid remateri lower cost spill valu paper describ techniqu experi build use regist alloc incorpor provid detail descript optimist color remateri present experiment data show perform sever version regist alloc suit fortran program discuss sever insight discov repeat implement alloc b introduct relationship runtim perform effect use machin regist set well understood compil process decid valu keep regist point gener code call regist alloc valu regist access quickli valu memori high perform microprocessorbas machin differ access time order magnitud thu regist alloc strong impact runtim perform code compil gener memori latenc rise regist latenc impact alloc perform increas addit featur like superscalar instruct issu increas program absolut demand regist machin issu two instruct singl cycl must two set operand readi place start cycl natur increas demand regist popular techniqu perform regist alloc base graph color paradigm alloc construct graph repres constraint alloc must preserv use graph color techniqu discov map valu procedur regist target machin map must observ constraint first graph color alloc built chaitin colleagu 8 anoth approach call prioritybas color describ chow hennessi 10 11 two techniqu form core around rich literatur emerg see section 7 techniqu use build graph color alloc improv recent year sever import extens chaitin basic techniqu appear 2 28 nevertheless problem remain practic problem appear either overspil poor spill choic former case alloc fail keep valu regist even though regist avail throughout lifetim latter case alloc choos wrong valu keep regist point code preliminari version result appear sigplan confer program languag design implement 1989 1992 research support ibm corpor darpa onr grant n0001491j1989 author address depart comput scienc rice univers houston paper present two improv exist techniqu regist alloc via graph color improv address specif problem observ use chaitinstyl chowstyl alloc notion abstract storag alloc problem graph color date earli 1960 26 see section 7 first implement graph color regist alloc done chaitin colleagu pl8 compil 8 6 chow hennessi later describ prioritybas scheme alloc base color paradigm 10 11 almost subsequ work coloringbas alloc follow one two paper work follow chaitin scheme discuss regist alloc contain sever implicit assumpt work assum alloc work lowlevel intermedi code assembl code code shape optim phase alloc code refer unlimit number regist call prealloc regist virtual regist alloc work virtual regist instead work distinct live rang procedur singl virtual regist sever distinct valu interest differ part program valu becom separ live rang alloc discov separ live rang alloc physic regist target machin model regist alloc graph color problem compil first construct interfer graph g node g correspond live rang edg repres interfer thu edg g node live rang l node j l interfer l j simultan live point occupi regist 1 live rang interfer particular live rang l call neighbor l graph number neighbor degre denot l ffi attract featur chaitin approach machinespecif constraint regist use repres directli graph 8 thu graph repres constraint embodi program present target architectur singl unifi structur one key underli insight graph color alloc interfer graph repres constraint find alloc g compil look kcolor g assign k color node g adjac node alway distinct color choos k match number machin regist map kcolor g feasibl regist assign underli code graph color npcomplet compil use heurist method search color guarante find kcolor kcolor graph kcolor discov valu spill valu kept memori rather regist spill one live rang creat new differ interfer graph compil proce iter spill live rang attempt color result new graph practic chaitin style alloc rare requir three trip loop figur 1 illustr chaitinstyl alloc proce seven phase 1 renumb systemat renam live rang creat new live rang definit point use point union togeth live rang reach use implement model exampl classic disjoint set unionfind problem paper pl8 compil type analysi call get right number names8 hewlettpackard precis architectur compil paper refer type analysi web analysis23 et al complet discuss interfer 8 renumb build coalesc spill cost simplifi select spill code oe figur alloc 2 build construct interfer graph implement close follow publish descript pl8 alloc 8 6 interfer graph simultan repres bitmatrix collect adjac list 3 coalesc attempt shrink number live rang two live rang l l j combin initi definit l j copi l otherwis interfer combin two live rang elimin copi instruct denot new live rang l ij alloc combin l l j construct imprecis conserv approxim set interfer l ij conserv updat let alloc batch togeth mani combin step perform coalesc possibl updat repeat build coalesc coalesc chang graph 4 spill cost estim live rang runtim cost instruct would ad item spill spill cost estim comput number load store would requir spill live rang oper weight c theta 10 c oper cost target architectur instruct loopnest depth 5 simplifi construct order node creat empti stack repeat follow two step graph empti exist node l l ffi edg graph place l stack color b otherwis choos node l spill remov l edg graph mark l spill node mark spill alloc insert spill code see 7 repeat alloc process spill requir proce select see 6 6 select assign color node graph order determin simplifi repeat follow step stack empti pop live rang stack b insert correspond node g c give color distinct neighbor 7 spill code invok simplifi decid spill node spill live rang convert collect tini live rang insert load use store definit requir understand work consid action simplifi select simplifi move l graph stack l ffi k live rang meet condit trivial color receiv color independ color assign neighbor thu simplifi remov node prove node get assign color live rang remov degre neighbor lower turn may prove assign color select assign color node revers order remov thu color node graph trivial color simplifi order stack must true one sens order color constrain node first l get color l j precis simplifi prove l j color independ specif color chosen l exampl consid find threecolor simpl graph shown figur 2 first simplifi remov node need spill one possibl sequenc remov c b e next select reinsert node graph assign color node e insert first given color say red next ad get color except red run entir stack might result assign e red blue b green c red blue decis spill live rang made simplifi alloc find node trivial color select node spill metric pick spill candid import chaitin suggest choos node smallest ratio spill cost divid current degre 6 chaitin heurist guarante find minim color guarante find kcolor exist graph color npcomplet exampl suppos want find twocolor diamond graph shown figur 2 clearli one exist exampl w red x blue blue z red appli simplifi diamond graph present immedi problem node degre less two thu node select spill spill cost equal alloc make arbitrari choic exampl x x remov graph mark spill simplifi remov remain three node without spill sinc node mark spill alloc must insert spill code rebuild interfer graph tri despit exist exampl like diamond graph chaitin techniqu produc good alloc practic sever factor contribut success alloc base global inform form precis interfer graph includ power mechan remov unneed copi coalesc final use spill cost guid gener spill code spill cost encod simpl inform controlflow graph improv chaitin work retain properti part parascop program environ built optim compil fortran run uniprocessor 12 initi implement includ regist alloc use chaitin techniqu describ section 2 alloc work well seem produc satisfactori alloc ffifl ffifl e c simpl graph z x diamond graph figur exampl graph mani long live rang subroutin mani deeplynest loop figur 3 structur svd requir modest amount time space compil time howev debug part compil discov sever case produc obvious flaw alloc 31 motiv problem particularli interest case aros code gener singular valu decomposit svd golub reinsch actual code softwar librari distribut forsyth malcolm moler book numer method 18 two hundr fourteen line code exclud comment code contain thirtyseven doloop organ five differ loop nest first loop nest simpl array copi four larger complex loop nest follow figur 3 show structur svd alloc spill mani short live rang defer larger longer live rang arraycopi loop spill loop indic limit even though sever regist unus loop studi understood regist alloc overspil badli situat provok behavior optim dozen long live rang extend initi portion code larg loop nest figur show long live rang span small arraycopi loop span much code high degre interfer graph addit larg spill cost referenc often insid deepli nest loop restrict graph much alloc must spill live rang initi alloc choos spill indic limit arraycopi loop choic correct valu smaller estim spill cost longer live rang alloc choos first unfortun spill help problem later loop nest allevi demand regist larg loop nest alloc must spill valu proce eventu spill longer live rang result unus regist arraycopi loop indic limit kept memori 32 improv know alloc overspil diamond graph svd reconsid alloc process exampl highlight differ problem 1 diamond graph twocolor see inspect alloc fail approxim use decid whether x get color weak look kcolor alloc approxim x get color x degre less k suffici condit x get color necessari condit exampl x may k neighbor two neighbor may get assign color precis happen diamond graph 2 svd alloc must spill live rang heurist pick spill candid select small live rang use shallow loop nest less expens spill unfortun spill product allevi regist pressur major loop nest time alloc make decis recogn spill help similarli alloc retract decis later spill live rang stay spill color heurist explor matula beck find twocolor diamond graph 27 algorithm differ slightli chaitin approach simplifi graph repeatedli remov node smallest current degre versu chaitin approach remov node n n k node remov select color revers order delet fashion chaitin diamond graph heurist gener twocolor chaitin heurist fail pessimist assum neighbor node get differ color matula beck heurist discov two color capit case two neighbor receiv color unfortun matula beck scheme simpli find color notion find kcolor particular k mechan produc spill code real program seriou problem mani procedur requir spill code interfer graph simpli kcolor exampl svd routin must spill live rang optim color would elimin spill want algorithm combin matula beck stronger color heurist chaitin mechan costguid spill select achiev effect made two modif chaitin origin algorithm 1 simplifi alloc remov node degre less k arbitrari order whenev discov remain node degre greater k choos spill candid node remov graph instead mark spill simplifi optimist push stack hope color avail spite high degre thu remov node order chaitin alloc spill candid includ stack possibl color 2 select alloc may discov color avail node case leav node uncolor continu next node uncolor node must node chaitin method would spill see consid graph node color method node n insert graph remov chaitin method guarante color avail n method guarante properti node except spill candid thu uncolor node must spill candid node chaitin would spill node receiv color alloc succeed node uncolor alloc insert spill code correspond live rang rebuild interfer graph tri result alloc shown figur 4 call optimist alloc decis insert spill code occur select rather simplifi rest alloc unchang chaitin scheme form alloc handl problem describ head section defer spill decis two power consequ first elimin nonproduct spill chaitin scheme spill decis made simplifi node assign color select node spill candid live rang spill scheme spill candid get place stack node select discov color avail live rang actual spill mechan effect allow alloc reconsid spill decis second late spill capit specif detail color assign provid stronger color heurist select color node x examin color xs current neighbor provid direct measur x get color rather estim answer x particular two xs neighbor receiv color x may receiv color even though x k optimist alloc find twocolor diamond graph recal svd live rang j n earli spill candid spill cost small howev spill allevi regist pressur insid major loop nest thu alloc must spill larg live rang happen small live rang select spill candid place stack small live rang come stack select larg live rang spill alloc easili determin color avail small live rang earli arraycopi loop optimist color simpl improv chaitin pessimist scheme assum two alloc one optimist one pessimist use spill metric exampl chaitin metric spill cost divid current degre optimist alloc stronger color heurist follow sens color graph pessimist alloc color graph pessimist alloc spill necessari optimist alloc spill subset live rang spill pessimist alloc optimist color help gener better alloc case elimin spill diamond graph one exampl mani case cost spill reduc procedur execut fewer cycl due regist spill section 5 present dynam measur improv implement techniqu backend ibm xl compil famili rs6000 architectur result decreas twenti percent estim spill cost spec benchmark suit 22 renumb build coalesc spill cost simplifi select spill code oe figur 4 optimist alloc even optimist color alloc must spill live rang happen alloc choos least expens mechan accomplish spill particular recogn case cheaper recomput valu store retriev memori consid code fragment shown figur 5 notat p mean content memori locat address p sourc note p constant first loop vari second loop regist alloc take advantag situat imagin high demand regist first loop forc p spill column show desir result upper loop p load need use loadimmedi instruct lower loop p load loop use loadimmedi chaitin column illustr code would produc chaitinstyl alloc entir live rang p spill memori load insert use store insert definit split final column show code would expect split alloc 11 25 21 5 actual code might wors fact work remateri motiv problem observ experi live rang split 3 unfortun exampl sort discuss literatur split alloc unclear best extend techniqu achiev ideal solut section divid two major subsect first present conceptu view approach remateri second discuss actual implement alloc sourc chaitin store p reload p reload p store p split store p reload p reload p figur 5 remateri versu spill 41 idea chaitin et al discuss sever idea improv qualiti spill code 8 point certain valu recomput singl instruct requir operand alway avail comput call except valu neverkil note valu recalcul instead spill reload note uncoalesc copi never kill valu elimin recomput directli desir regist 8 togeth techniqu term remateri practic opportun remateri includ immedi load integ constant machin floatingpoint constant ffl comput constant offset frame pointer static dataarea pointer ffl load known constant locat either frame static dataarea ffl load nonloc frame pointer display valu must cheapli comput operand avail throughout procedur import understand distinct live rang valu live rang may compris sever valu connect common use sourc column figur 5 p denot singl live rang compos three valu address label result express subtli merg two valu head second loop chaitin alloc correctli handl remateri spill live rang singl valu handl complex case like variabl p figur 5 extend chaitin work take advantag remateri opportun complex multivalu live rang method tag valu enough inform allow alloc handl correctli achiev 1 split live rang compon valu 2 tag valu remateri inform 3 form new live rang connect valu ident tag approach allow correct remateri multivalu live rang introduc new problem minim unnecessari split follow section describ find valu propag tag split live rang remov unproduct split discov valu find valu construct procedur static singl assign ssa graph represent transform code use valu refer exactli one definit 13 achiev goal construct techniqu insert special definit call oenod point controlflow path join differ valu merg actual use prune ssa graph dead oenod elimin 9 natur way view ssa graph procedur collect valu compos singl definit one use valu definit either singl instruct oenod merg two valu examin defin instruct valu recogn neverkil valu propag inform throughout ssa graph propag remateri tag propag tag use analog wegman zadeck spars simpl constant algorithm 31 2 modifi lattic slightli repres necessari remateri inform new lattic 2 power spars condit constant algorithm unnecessari earlier optim elimin controlflow path would detect nonexecut element may one three type top mean inform known valu defin copi instruct oenod initi tag inst valu defin appropri instruct neverkil remateri valu tag simpli pointer instruct bottom mean valu must spill restor valu defin inappropri instruct immedi tag addit meet oper u modifi correspondingli new definit u u inst u inst inst inst inst u inst inst 6 inst j note inst inst j compar instruct operandbyoperand basi sinc instruct 2 operand modif affect asymptot complex propag propag valu tag particular inst valu defin copi instruct tag lower inst depend valu flow copi tag valu defin oenod lower inst valu flow node equival inst tag otherwis lower process tag valu ssa graph either instruct valu tag spill valu requir normal heavyweight spill howev tag instruct remateri issu instruct specifi tag lightweight spill tag use two later phase alloc spill cost use tag comput accur spill cost spill code use tag emit desir code insert split propag oenod must remov valu renam recreat execut program consid exampl figur 6 sourc column simpli repeat exampl introduc figur 5 ssa column show effect insert oenod p renam differ valu compris ps live rang split column illustr copi necessari distinguish differ valu without oenod final column minim show singl copi requir isol neverkil valu p 0 valu compris p avoid extra copi note p 1 ident tag propag may treat togeth singl live rang p 12 similarli two connect valu inst tag would combin singl live rang purpos remateri copi place perfectli neverkil valu isol copi introduc algorithm remov oenod insert copi describ section 42 cours alloc could insert copi suggest split column form live rang split idea discuss elsewher 3 remov unproduct split approach insert minim number copi requir isol neverkil valu nevertheless color make copi superflu recal minim column figur 6 neither p 0 spill receiv color copi connect unnecessari real runtim cost copi elimin whenev possibl simpli use coalesc would remov copi lose desir separ valu differ tag therefor use pair limit coalesc mechan remov unproduct copi sourc ssa split minim figur 6 introduc split conserv coalesc straightforward modif chaitin coalesc phase conceptu add singl constraint coalesc combin two live rang result singl live rang spill bias color increas likelihood live rang connect copi get assign regist conceptu select tri assign color two live rang connect copi taken togeth two mechan remov unproduct copi 42 implement chaitinstyl alloc extend natur accommod approach highlevel structur depict figur 4 unchang sever lowlevel modif requir next section discuss enhanc requir renumb coalesc select renumb chaitin version renumb base defus chain 8 long interest remateri adopt implement strategi renumb base prune ssa graph conceptu implement four step 1 determin live basic block use spars dataflow evalu graph 9 2 insert oenod base domin frontier 13 avoid insert dead oenod 3 renumb operand everi instruct refer valu instead origin virtual regist time accumul avail inform block intersect live avail need block allow construct precis interfer graph 8 4 form live rang union togeth valu reach oenod use fast disjoint set union disjoint set structur maintain build interfer graph coalesc coalesc union oper implement step 3 4 perform singl walk domin tree use techniqu renumb complet avoid use bitvector flow analysi despit appar complex algorithm involv fast practic requir modest amount space renumb alreadi use ssa graph modest chang requir support remateri izat modifi renumb six step 1 determin live basic block use spars dataflow evalu graph 2 insert oenod base domin frontier still avoid insert dead oenod 3 renumb operand instruct refer valu time initi remateri tag valu 4 propag tag use spars simpl constant algorithm modifi section 41 5 examin copi instruct sourc destin valu ident inst tag union remov copi 6 examin operand oenod operand valu tag result valu union valu otherwis insert split distinguish copi instruct connect valu correspond predecessor block step 5 6 perform singl walk domin tree conserv coalesc prevent coalesc remov split care introduc renumb must limit power specif never coalesc split instruct result live rang may spill normal coalesc two live rang l l j combin l j defin copi l otherwis interfer conserv coalesc add addit constraint combin two live rang connect split l ij k neighbor signific degre signific degre mean degre k understand restrict safe inde conserv recal chaitin color heurist 6 spill node degre k remov graph node remov degre neighbor reduc perhap allow remov process repeat graph empti remain node degre k therefor node spill must least k neighbor degre k initi graph practic perform two round coalesc initi possibl copi coalesc split instruct graph rebuilt coalesc repeat copi remov begin conserv coalesc split instruct repeatedli build interfer graph attempt conserv coalesc split remov theori intermix conserv coalesc unrestrict coalesc sinc result unrestrict coalesc may spill exampl l l j might conserv coalesc later coalesc l ij l k provok spill l ijk sinc signific degre l ijk may quit high practic may prove problem measur effect intermix conserv coalesc unrestrict coalesc produc wors alloc would simplifi speed entir process conserv coalesc directli improv alloc coalesc remov instruct result code split instruct introduc alloc region littl competit regist conserv coalesc undo split howev undo nonproduct split bias color second mechan remov useless split involv chang order color consid assign renumb insert split mark pair valu connect split partner select assign color l first tri color alreadi assign one l partner care implement expens pick first avail color realli amount bias spectrum color previou assign l partner bias mechan combin live rang conserv coalesc exampl l might 2k neighbor signific degre neighbor might interfer thu might color ident conserv coalesc combin l partner result live rang would mani neighbor signific degre bias may abl combin l partner appli alloc shown live rang receiv color late point alloc combin matter choos right color virtu late applic bias mechan use detail level knowledg problem avail earlier process exampl coalesc perform increas likelihood bias match partner add limit lookahead pick color l uncolor partner l j alloc look color still avail l j averag l small number partner thu add limit lookahead bias color without increas asymptot complex select implement techniqu optim compil fortran compil experiment code gener rtpc sparc i860 rs6000 experi regist alloc built seri alloc independ particular architectur 3 experiment alloc work routin express iloc lowlevel intermedi languag design allow extens optim iloc routin assum infinit regist set rewritten term particular target regist set spill code ad necessari target regist set specifi small tabl may vari allow conveni experiment wide varieti regist set alloc iloc routin translat complet c routin c routin compil result object file link complet program sever advantag ffl insert appropri instrument translat c collect accur dynam measur ffl compil c allow us test singl routin context complet program run real data ffl perform test machineindepend fashion potenti use varieti regist set simpli time actual machin code inher machinedepend tend obscur effect alloc translat c add instrument count number time specif iloc instruct execut compar regist alloc interest number load store copi loadimmedi addimmedi figur 7 show small sampl iloc code correspond c translat usual onetoon map iloc statement c translat though addit c requir function header declar regist variabl eg r14 f15 also note simpl instrument appear immedi sever statement cours sampl simpl major iloc complex lle3 nop lla4 ldi r14 8 add r9 r15 r11 mvf f15 f0 bc l0023 l0023 lddrr f14 r14 r9 dab f14 f14 dadd f15 f15 f14 addi r14 r14 8 sub r7 r10 r14 br ge r7 n6 n7 lle3 goto l0023 r7 figur 7 iloc c 51 target machin test report target machin defin sixteen integ regist sixteen floatingpoint regist floatingpoint regist hold doubleprecis valu distinct made singleprecis doubleprecis valu held regist four integ regist may use pass argument recal argument pass refer fortran therefor argument regist hold pointer actual valu remain argument pass stack frame function result return integ floatingpoint regist appropri ten regist class design calleesav remain six includ argument regist preserv calle report cost assum load store requir two cycl instruct assum requir one cycl cours simpl approxim cost real machin 52 spill cost sinc instrument report dynam count load store etc need mechan isol instruct due alloc difficulti spill profit case alloc remov instruct eg copi instruct therefor test routin hypothet huge machin 128 regist assum would give nearli perfect alloc differ huge result result one alloc target standard machin equal number cycl ad alloc cope insuffici regist 53 result test suit collect seventi routin contain eleven program eleven routin forsyth malcolm moler book numer method 18 group seven program simpl driver remain fiftynin routin spec benchmark suit 30 four spec program use doduc 41 routin fpppp 12 routin matrix300 5 routin tomcatv routin two fortran program suit spice nasa7 requir languag extens yet suppli frontend result present sequenc comparison two tabl first two column give program subroutin name third fourth column give observ spill cost two alloc compar cost calcul dynam count instruct describ cycl spill code percentag contribut program routin origin optimist load store copi ldi addi total fmin fmin 551 370 seval spline 125 117 5 2 6 solv svd svd 2509 1977 doduc colbur deseco 5500 4957 inithx 714 579 11 4 4 19 lectur 257 221 prophi 1954 1531 13 9 0 21 repvid supp efil 173 94 21 sgemm tabl 1 effect optimist color earlier last column total give percentag improv spill cost old alloc new one larg posit number indic signific improv middl column show contribut instruct type total percentag round nearest integ insignific improv report 0 insignific loss report gamma0 case result zero simpli show blank sinc result round total entri may equal sum contribut entri tabl show routin differ observ 3 consid first row tabl 1 row present result routin fmin program fmin alloc use chaitin heurist gener alloc requir 551 cycl spill code optimist alloc requir 370 cycl 16 save came execut fewer load 16 aros fewer store insignific improv due execut fewer loadimmedi total improv 32 3 raw data tabl given appendix brigg thesi 3 optimist color tabl 1 show comparison test result alloc use two differ color heurist column label origin give data version use chaitin color heurist column label optimist give data version use optimist color heurist test suit 70 routin measur improv 26 case singl loss extra load store requir improv rang tini quit larg sometim reduc spill cost 40 singl loss disappoint sinc claim optimist color heurist never spill chaitin heurist howev must recal structur alloc attempt color spill code insert entir buildcoalescecolor process repeat optimist color heurist perform least well chaitin heurist graph spill two alloc face differ problem remateri tabl 2 summar effect new approach remateri compar two version optimist alloc differ handl neverkil valu column label optimist give data version use chaitin limit approach remateri column label remateri give data version incorpor new method entir suit 70 routin observ improv 28 case degrad case one loss small 2 load 2 store extra copi somewhat larger improv rang tini reason larg mani greater 20 cours adjust rel cost instruct especi load store chang amount improv expect see pattern fewer load instruct loadimmedi typic number store number copi also reduc reduc number copi instruct suggest heurist remov unhelp split adequ practic note reduct obtain spite extra copi introduc renumb 54 alloc cost improv alloc come cost compiletim case optimist alloc color phase expens due need attempt color even spill candid discov support remateri requir sever extra step extra pass code requir initi remateri tag propag time requir propag tag throughout routin final least one extra pass requir accomplish conserv coalesc hand buildcoalesc process may slightli faster sinc elimin copi renumb recal step 5 section 42 tabl 3 show compar time three alloc three routin spec suit time given second measur 100 hertz clock unload ibm rs6000 model 540 run repeat 10 time result averag first column show phase alloc cfa stand controlflow analysi includ time requir comput forward revers domin domin frontier build includ entir buildcoalesc loop color includ simplifi select note tomcatv requir extra round spill origin alloc optimist alloc routin orig column give time requir alloc chaitin origin color heurist opt column give time requir optimist alloc remat column give time requir optimist alloc improv remateri select three routin illustr perform rang size first routin repvid cycl spill code percentag contribut program routin optimist remateri load store copi ldi addi total seval spline solv zeroin zeroin 236 doduc bilan 1046 966 5 3 8 bilsla colbur 19 24 gamma11 gamma11 gamma5 gamma26 debico drigl heat 34 inideb 50 48 4 4 inisla 28 lectur orgpar pastem 289 prophi repvid main tabl 2 effect remateri program doduc 144 noncom line fortran compil text size 1284 byte use ibm xlf compil full optim second routin tomcatv 133 line text size 3064 byte largest routin twldrv program fpppp 881 line text size 15616 byte three routin appear tabl 1 obviou conclus draw data tabl 3 support remateri requir small amount addit compiletim hand optimist color heurist littl cost sometim faster chaitin pessimist heurist result tabl 3 also illumin number interest detail behavior three alloc ffl initi pass buildcoalesc loop domin overal cost alloc note chaitin comparison addit iter colorspil process quit inexpens ffl case cost renumb higher remat reflect cost propag remateri tag repvid tomcatv twldrv phase orig opt remat orig opt remat orig opt remat renum 04 03 04 06 06 07 56 56 62 build cost color spill renum build 06 06 06 09 09 12 62 61 81 cost color spill renum build cost color spill renum 02 02 03 build 06 05 09 cost color spill renum 02 build cost 01 color 02 total 40 39 47 97 85 113 1355 1365 1367 tabl alloc time second ffl case cost buildcoalesc loop higher remat due addit pass conserv coalesc ffl low cost controlflow analysi illustr speed practic algorithm calcul domin frontier 13 ffl higher cost color first pass aris cost choos node spill cost color linear size graph spill select os delta n number spill choic n number node larg number spill term domin cost color pleas overal speed alloc result appear slightli faster time report ibm xlf compil regist alloc compar time report optim extens comparison prioritybas color alloc appear much slower small routin much faster larg routin 3 cours speed competit fast local techniqu use nonoptim compil 19 20 howev believ global optim requir global regist alloc 6 implement insight perform experi describ section 5 implement sever version alloc natu ralli gain insight implement chaitinstyl graph color alloc section attempt convey idea concis form hope prove use implementor possibl label insight particular phase alloc affect constant valu remateri scheme suggest compil repres constant way make visibl alloc current compil integ constant obviou code load use integ load immedi instruct noninteg constant store static constant pool load use fix offset static data area pointer effect hide remateri chang intermedi represent make valu visibl would expos remateri improv qualiti final code build like chaitin advoc build two represent interfer bit matrix set adjac vector mani implement use singl represent claim space save howev form graph need effici execut alloc practic problem explos size interfer graph alloc run reason amount space exampl interfer graph tomcatv requir 146404 byte graph twldrv requir 3357640 byte 3 usual bit vector iter solut live variabl problem larg interfer graph actual fact led us spars evalu graph techniqu choi cytron ferrant 9 coalesc coalesc transit even though l l j interfer l l k interfer l ij interfer l k l j interfer l k thu order coalesc import coalesc proceed innermost loop outward insideout coalesc ensur copi deepli nest loop get remov copi outer loop practic make notic differ mani routin conserv coalesc bias color direct tradeoff strength conserv coalesc effect bias color practic experi sever differ restrict coalesc precis ie less conserv restrict coalesc increas set live rang combin decreas number live rang combin bias color unclear whether occur precis coalesc condit restrict freedom graph combin live rang bias color also catch case bias color complet elimin need conserv coalesc comput spill cost alloc spill cost alway execut chaitin alloc wait must choos first valu spill 7 approach merit live rang neg spill cost suggest less expens store reload keep regist alloc comput spill cost earli aggress remov live rang neg spill cost chaitin defer comput spill cost alloc recogn must spill speed alloc procedur color without spill addit alloc skip spillcost comput live rang alreadi remov graph simplifi remateri fundament chang alloc chaitinstyl alloc live rang unrel order remov trivial color node littl notic effect result alloc introduct split isol neverkil valu use bias color chang fact give new import rel remov order trivial color node face multipl node remov select first remov node partner forc node partner color first color less constrain graph practic increas effect bias color pick spill candid introduc split support remateri increas number node interfer graph advers effect run time simplifi increas time spent search spill candid describ section 2 search spill candid must examin node remain current graph naiv implement repeat process spill spill metric includ node current degre thu choos spill candid take ok number spill n number live rang origin graph undoubtedli care algorithm work improv situat practic refactor comparison note l l costl replac floatingpoint divis integ multipli improv constant factor limit backtrack select assign color node somewhat arbitrari manner bias color capit fact care choos order case matter nonetheless improv color choic avoid spill optimist alloc add limit form backtrack color avail node p select consid recolor one ps neighbor open color p backtrack must care constrain avoid combinatori explos examin ps neighbor determin avail color accumul number use color note neighbor use color color remain p one color use one ps neighbor select tri recolor neighbor succe color avail p limit backtrack easi implement take littl compil time rare lead degrad 4 hand rare lead signific improv 3 also fit bias color howev experi suggest limit lookahead see section 42 produc consist improv limit backtrack bias scheme npnois test often stumbl phenomenon label npnois measur output process involv heurist solut npcomplet problem answer often contain behavior seem anomal sometim heurist must pick set choic local cost differ choic lead differ answer alloc use lineartim heurist find color decis tree perspect pick path tree time proport height tree cours tree exponenti number node step pick base local inform histori previou choic remain node chang local choic lead differ global result thu simpl thing like order node tie broken actual color assign produc variat output variat make difficult compar two compet alloc exampl tabl 2 remateri scheme produc wors code optimist alloc chaitin scheme two routin colbur ddeflu doduc heurist gener better global behavior produc anomal result specif case effect may part account effect seen haifa group best three spill scheme 2 smooth npnois use three differ spill metric take best result 4 never seen produc wors alloc though situat conceiv often better save expens spill instead possibl save lessexpens spill futur relationship econom use memori graph color discuss long time first paper subject appear lavrov 1961 paper minim memori use 26 suggest build inconsist graph color propos practic method find color ershov colleagu built work alpha project solv storag alloc problem build interfer graph use pack algorithm 14 15 late sixti cock clearli talk appli insight directli regist alloc kennedi schwartz credit insight 24 29 earli work graph color regist alloc emphas color problem littl consider question spill choic placement algorithm cock ershov report schwartz 29 concern exclus minim number color requir discuss spill code flow graph ignor entir first complet regist alloc base upon graph color describ chaitin colleagu 8 spill handl varieti heurist base upon interv analysi flow graph unfortun ad hoc techniqu expens alway effect subsequ paper chaitin introduc simpler techniqu attempt solv spill problem base interfer graph spillcost estim live rang 6 section 2 describ alloc chow hennessi describ prioritybas color scheme 10 11 work valu initi resid memori divid regist set local global alloc build imprecis interfer graph color constrain live rang prioriti order prioriti function use spill cost normal live rang length constrain live rang color split smaller piec tri color independ fabri context work minim memori storag requir introduc renam transform analog chow live rang split 16 note case split improv result color mention applic regist alloc problem sever group refin chow approach laru hilfing make sever modif 25 work valu initi resid regist elimin local alloc limit basic block size use sophist live rang split techniqu gupta soffa steel describ approach partit interfer graph subgraph color individu later merg 21 hewlettpackard compil group describ anoth prioritybas alloc 23 assign color order decreas degre interfer graph must spill examin current live rang assign color spill valu minim cost spill metric metric combin chaitin notion spill cost term includ impact keep valu regist across loop live use implement version algorithm believ scheme avoid problem like one observ svd routin hand spill live rang chaitin prove trivial color bernstein colleagu describ collect techniqu 2 show bestofthre color scheme produc better result chaitin origin scheme 5 impos largest degre first order remov unconstrain node graph simplifi step 5a section 2 introduc clean heurist decreas amount spill code gener within singl basic block experi improv orthogon present paper callahan koblenz construct finegrain hierarch decomposit flow graph tile 5 color perform individu tile result merg two pass tree 5 see discuss npnois section 6 one possibl explan behavior algorithm explicitli parallel cours global alloc built graph color paradigm approach includ binpack alloc built digit equip corpor probabilist alloc fischer proebst 1 17 difficult compar techniqu implement work differ intermedi represent follow differ optim compil target differ machin optimist color simpl improv chaitin origin alloc produc alloc chaitin method except improv result result tabl 1 show happen regularli cost nearli ident occasion one method requir extra trip around main loop spill code insert anoth paper shown optimist alloc gener better alloc machin use regist pair valu 4 implement chaitinstyl alloc incorpor improv make signific differ alloc qualiti littl cost method remateri neverkil valu find maximum extent neverkil valu ensur alloc spill valu least expens way procedur never kill valu must spill result better code result tabl 2 show actual happen opportun remateri exist featur ad remateri hurt addit algorithm describ section 4 fast practic experi suggest asymptot fast algorithm produc good compiletim perform acknowledg ken kennedi particip earli discuss color encourag work start jorg point matula algorithm mark krentel suggest color heurist give easili encourag us tri aggress color heurist greg chaitin ben chase john cock marti hopkin bob hood ken kennedi chuck lin peter markstein tom murtagh randi scarborough rick simpson tom spillman matthew zaleski contribut work encourag enlighten discuss colleagu parascop project rice provid us excel testb idea peopl go heartfelt thank r spill code minim techniqu optim compil regist alloc via graph color color regist pair regist alloc via hierarch graph color regist alloc spill via graph color regist alloc spill via graph color automat construct spars data flow evalu graph regist alloc prioritybas color prioritybas color approach regist alloc parascop parallel program environ effici comput static singl assign form control depend graph automat storag optim probabilist regist alloc comput method mathemat comput retarget compil ansi c simpl regist spill retarget compil regist alloc via cliqu separ privat commun effect machinelevel global optim global flow analysi regist alloc simpl code structur regist alloc spur lisp compil store economi close oper scheme graph color regist alloc processor multiregist operand program interim report setl project releas 12 constant propag condit branch tr effect machinelevel global optim regist alloc spur lisp compil spill code minim techniqu optim complier regist alloc via cliqu separ prioritybas color approach regist alloc graph color regist alloc processor multiregist operand automat construct spars data flow evalu graph constant propag condit branch regist alloc via hierarch graph color effici comput static singl assign form control depend graph retarget compil ansi c color regist pair simpl regist spill retarget compil probabilist regist alloc regist alloc via graph color alphamyampersandmdashan automat program system high effici smallestlast order cluster graph color algorithm regist alloc prioritybas color engin compil comput intract comput method mathemat comput automat storag optim regist alloc myampersandamp spill via graph color global flow analysi regist alloc simpl code structur ctr christian wimmer hanspet mssenbck optim interv split linear scan regist alloc proceed 1st acmusenix intern confer virtual execut environ june 1112 2005 chicago il usa atsushi ohori regist alloc proof transform scienc comput program v50 n13 p161187 march 2004 yoonseo choi hwansoo han optim regist reassign regist stack overflow minim acm transact architectur code optim taco v3 n1 p90114 march 2006 suhyun kim soomook moon jinpyo park kemal ebciolu unrollbas regist coalesc proceed 14th intern confer supercomput p296305 may 0811 2000 santa fe new mexico unit state sriraman tallam rajiv gupta bitwidth awar global regist alloc acm sigplan notic v38 n1 p8596 januari john lu keith cooper regist promot c program acm sigplan notic v32 n5 p308319 may 1997 weijia li youtao zhang jun yang jiang zheng ucc updateconsci compil energi effici wireless sensor network acm sigplan notic v42 n6 june 2007 kun zhang tao zhang santosh pand binari translat improv energi effici postpass regist realloc proceed 4th acm intern confer embed softwar septemb 2729 2004 pisa itali sreeranga p rajan masahiro fujita ashok sudarsanam sharad malik develop optim compil fujitsu fixedpoint digit signal processor proceed seventh intern workshop hardwaresoftwar codesign p26 march 1999 rome itali bernhard scholz erik eckstein regist alloc irregular architectur acm sigplan notic v37 n7 juli 2002 omri traub glenn holloway michael smith qualiti speed linearscan regist alloc acm sigplan notic v33 n5 p142151 may 1998 xiaotong zhuang santosh pand parallel loadstor dualbank memori embed processor acm transact embed comput system tec v5 n3 p613657 august 2006 jame shuler henri r bauer iii lookahead alloc presenc branch proceed 1997 acm symposium appli comput p504508 april 1997 san jose california unit state michael paleczni christoph vick cliff click java hotspottm server compil proceed javatm virtual machin research technolog symposium javatm virtual machin research technolog symposium p11 april 2324 2001 monterey california ashok sudarsanam stan liao sriniva devada analysi evalu address arithmet capabl custom dsp architectur proceed 34th annual confer design autom p287292 june 0913 1997 anaheim california unit state daniel luna mikael pettersson konstantino sagona effici compil function languag amd64 hipe experi proceed 7th acm sigplan intern confer principl practic declar program p176186 juli 1113 2005 lisbon portug kameswari v garigipati cindi norri evalu use profil regionbas regist alloc proceed 2002 acm symposium appli comput march 1114 2002 madrid spain akira koseki hideaki komatsu toshio nakatani preferencedirect graph color acm sigplan notic v37 n5 may 2002 christian w probst andrea gal michael franz averag case vs worst case margin safeti system design proceed 2005 workshop new secur paradigm septemb 2023 2005 lake arrowhead california christoph lupo kent wilken post regist alloc spill code optim proceed intern symposium code gener optim p245255 march 2629 2006 andrew w appel lal georg optim spill cisc machin regist acm sigplan notic v36 n5 p243253 may 2001 ivan baev richard e hank david h gross premateri reduc regist pressur free proceed 15th intern confer parallel architectur compil techniqu septemb 1620 2006 seattl washington usa jinpyo park jehyung lee soomook moon regist alloc bank regist file acm sigplan notic v36 n8 p3947 aug 2001 lal georg andrew w appel iter regist coalesc acm transact program languag system topla v18 n3 p300324 may 1996 lal georg andrew w appel iter regist coalesc proceed 23rd acm sigplansigact symposium principl program languag p208218 januari 2124 1996 st petersburg beach florida unit state keith cooper philip j schielk devika subramanian optim reduc code space use genet algorithm acm sigplan notic v34 n7 p19 juli 1999 max hailperin compar conserv coalesc criteria acm transact program languag system topla v27 n3 p571582 may 2005 daniel luna mikael pettersson konstantino sagona hipe amd64 proceed 2004 acm sigplan workshop erlang p3847 septemb 2222 2004 snowbird utah usa yang sun chan g r gao roy ju gueiyuan lueh zhaoq zhang interprocedur stack regist alloc itanium like architectur proceed 17th annual intern confer supercomput june 2326 2003 san francisco ca usa ashok sudarsanam sharad malik masahiro fujita retarget compil methodolog embed digit signal processor use machinedepend code optimizaton librari read hardwaresoftwar codesign kluwer academ publish norwel 2001 thoma zeitlhof bernhard wess listcolor interv graph applic regist assign heterogen registerset architectur signal process v83 n7 p14111425 juli sathyanarayanan thammanur santosh pand fast memoryeffici regist alloc framework embed system acm transact program languag system topla v26 n6 p938974 novemb 2004 michael smith norman ramsey glenn holloway gener algorithm graphcolor regist alloc acm sigplan notic v39 n6 may 2004 jinpyo park soomook moon optimist regist coalesc acm transact program languag system topla v26 n4 p735765 juli 2004 massimiliano poletto vivek sarkar linear scan regist alloc acm transact program languag system topla v21 n5 p895913 sept 1999 changq fu kent wilken faster optim regist alloc proceed 35th annual acmiee intern symposium microarchitectur novemb 1822 2002 istanbul turkey kreahl cindi norri profil assist regist alloc proceed 2000 acm symposium appli comput p774781 march 2000 como itali johansson mikael pettersson konstantino sagona high perform erlang system proceed 2nd acm sigplan intern confer principl practic declar program p3243 septemb 2023 2000 montreal quebec canada jian wang andrea krall anton ertl christin eisenbei softwar pipelin regist alloc spill proceed 27th annual intern symposium microarchitectur p9599 novemb 30decemb 02 1994 san jose california unit state javier zalamea josep llosa eduard ayguad mateo valero regist constrain modulo schedul ieee transact parallel distribut system v15 n5 p417430 may 2004 josep llosa mateo valero eduard ayguad heurist registerconstrain softwar pipelin proceed 29th annual acmiee intern symposium microarchitectur p250261 decemb 0204 1996 pari franc martin farach vincenzo liberator local regist alloc proceed ninth annual acmsiam symposium discret algorithm p564573 januari 2527 1998 san francisco california unit state david koe seth copen goldstein progress regist alloc irregular architectur proceed intern symposium code gener optim p269280 march 2023 2005 florent bouchez alain dart fabric rastello complex regist coalesc proceed intern symposium code gener optim p102114 march 1114 2007 tao zhang xiaotong zhuang santosh pand compil optim reduc secur overhead proceed intern symposium code gener optim p346357 march 2629 2006 keith cooper anshuman dasgupta tailor graphcolor regist alloc runtim compil proceed intern symposium code gener optim p3949 march 2629 2006 javier zalamea josep llosa eduard ayguad mateo valero improv spill code gener softwar pipelin loop acm sigplan notic v35 n5 p134144 may 2000 r govindarajan hongbo yang jo nelson amar chihong zhang guang r gao minimum regist instruct sequenc reduc regist spill outoford issu superscalar architectur ieee transact comput v52 n1 p420 januari wentsong shiue retarget compil low power proceed ninth intern symposium hardwaresoftwar codesign p254259 april 2001 copenhagen denmark keith cooper l taylor simpson christoph vick oper strength reduct acm transact program languag system topla v23 n5 p603625 septemb 2001 keith farka paul chow norman p jouppi zvonko vranes multiclust architectur reduc processor cycl time partit intern journal parallel program v27 n5 p327356 oct 1999 matthia jacob keith h randal crossarchitectur perform portabl java virtual machin implement proceed 2nd java virtual machin research technolog symposium p7989 august 0102 2002 david ryan koe seth copen goldstein global progress regist alloc acm sigplan notic v41 n6 june 2006 keith farka paul chow norman p jouppi zvonko vranes multiclust architectur reduc cycl time partit proceed 30th annual acmiee intern symposium microarchitectur p149159 decemb 0103 1997 research triangl park north carolina unit state wolfram amm jefferi von ronn michael franz ssabas mobil code implement empir evalu acm transact architectur code optim taco v4 n2 p13e june 2007 jay bharadwaj william chen weihaw chuang gerolf hoflehn kishor menez kalyan muthukumar jim pierc intel ia64 compil code gener ieee micro v20 n5 p4453 septemb 2000 suhyun kim soomook moon jinpyo park kemal ebcioglu unrollbas copi elimin enhanc pipelin schedul ieee transact comput v51 n9 p977994 septemb 2002 tao zhang xiaotong zhuang santosh pand build intrusiontoler secur softwar proceed intern symposium code gener optim p255266 march 2023 2005 xavier leroy bytecod verif java smart card softwarepractic experi v32 n4 p319340 10 april 2002 suganuma ogasawara k kawachiya takeuchi k ishizaki koseki inagaki yasu kawahito onodera h komatsu nakatani evolut java justintim compil ia32 platform ibm journal research develop v48 n56 p767795 septembernovemb 2004