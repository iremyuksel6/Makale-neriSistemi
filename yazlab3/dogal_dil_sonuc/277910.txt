model set associ cach behavior irregular comput much work devot studi cach behavior execut code regular access pattern littl attent paid irregular code import portion code scientif applic handl compress spars matric work probabilist model predict number miss kway associ cach memori consid spars matric uniform band distribut present two differ irregular kernel consid spars matrixvector product transposit spars matrix model valid simul synthet uniform matric band matric harwellbo collect b introduct spars matric kernel mani numer appli cation compress storag permit oper memori save gener irregular access pattern fact reduc make hard predict perform memori hierarchi work probabilist model predict number miss kway associ cach memori consid spars matric uniform band distribut present want emphas import bodi model reusabl differ algebra kernel import approach studi cach behavior tradit use tracedriven simul whose main drawback larg amount time need process trace anoth possibl nowaday provid perform monitor tool modern microprocessor builtin hardwar counter make work support ministri educ scienc cicyt spain project tic961125c03 xunta de galicia project xuga20605b96 eu briteeuram project be951564 avail data number cach miss tool obvious restrict evalu specif cach architectur avail final analyt model present advantag reduc time obtain estim make parametr analysi cach flexibl weak point tradit limit precis although model use paramet extract address trace gener analyt model develop requir input trace previou work focus dens algebra code littl attent devot spars kernel due irregular natur access pattern exampl studi self interfer vector involv spars matrixvector product directmap cach without consid interfer data structur deriv gener framework model kind code nevertheless exampl potenti usabl type model model cach behavior common algebra kernel spars matrixvector product complex one transposit sparsematrix last code includ differ access pattern present import degre data reusabl certain vector remaind paper organ follow section present basic model paramet concept spars matrixvector product cach behavior model section section dedic model transposit spars matrix model extend band matric section section model verifi cach behavior depict studi final section conclud paper 2 probabilist model model consid three type miss intrins miss self cross interfer intrins miss take place first time memori block access self interfer miss line previous replac cach anoth line belong program vector cross interfer refer miss line replac two consecut refer line belong vector direct map cach memori line alway map cach line replac take place whenev access two memori line map cach line take place howev kway assso ciativ cach line map set k cach line case line replac select follow cach size word ls line size word nc number cach line csl nnz number non zero element spars matrix number row spars matrix n number column spars matrix fi averag non zero element per row nnzm k associ nk number cach set nck pn probabl posit spars matrix contain non zero element fin probabl least one entri group ls posit spars matrix r size integ size real tabl 1 notat use random lru criterium model orient kway associ cach lru replac order replac line cach kind k differ new line map set must access reus line consid behavior direct map cach replac probabl given line grow number line affect access two consecut refer way line distribut among differ set depend memori locat vector access determin set correspond given line handl area cover access given program vector v area vector ratio set receiv k line vector v ratio set receiv line v mean vi ratio cach set requir access new differ line replac line contain access v start besid k number line set number addit paramet model consid depict tabl word mean logic access unit say size real integ chosen size real model total scalabl uniform distribut theta n spars matrix nnz non zero element entri allow us state follow consider number entri group ls posit belong binomi bl pn pn probabl given posit matrix contain entri way probabl gener access given line vector time multipli spars matrix p calcul tabl show 21 area vector union essenti issu way obtain total area vector add area vector correspond access differ program vector given two area vector correspond access vector u v defin union area vector ratio set receiv line two vector u v 0 u u v00110011 u u figur 1 area vector correspond access vector u vector v cach n result total area vector l figur 2 area vector correspond sequenti access access line uniform refer probabl vector cover 11 line cach n 2 ratio set receiv k line figur illustr area vector union process symbol use denot vector union op erat method make assumpt rel posit program vector memori base addit independ probabl area ratio 22 sequenti access calcul area vector depend access pattern correspond program vector defin area vector function access pattern find code analyz exampl area vector access n consecut memori posit 2 averag number line fall set l k set receiv averag k line term ls ad n stand averag extra word brought cach first last line access 23 access line uniform refer probabl area vector access n word vector one cach line divid probabl p l access may calcul li n p l li n p l bnp binomi distribut 1 eg exampl access sequenti access present defin binomi distribut non integ number element figur 3 correspond locat non zero band matrix transpos group move vector defin output matrix figur case k access type area vector k l n p l 24 access group element uniform refer probabl transposit spars matrix find case vector n word divid group word probabl pg access group happen main loop algorithm access non zero input matrix per row sequenti move group correspond column belong vector defin output matrix group mani posit non zero associ column input matrix one line group access process row input matrix consecut access group address consecut memori posit area cover access type given sg n pg ae ls line vector uniform probabl access wherea ls probabl lstpg case l sg may extend order calcul area cover k access k n p due space limit show main express model found 25 access area displac success refer model may extend consid case area access probabl displac success refer let gb b pg area vector correspond access b consecut group element uniform probabl per group pg access one one element group valu given sg b delta pg defin k gb b pg area vector correspond k access type band spars matrix transposit case one k access correspond process new row spars matrix row column leav band left make probabl access group correspond null new one join band right thu ad group set group may access process row situat depict figur 5 process first row group 1 jri ri11 enddo enddo figur 4 spars matrixvector product 5 may access non zero associ column second row set 2 6 third set 37 may access access follow pattern cover three adjac area 1 set line grow access probabl area 1 figur 2 set line constant access probabl area 2 figur 3 last set symmetr first one size decreas access probabl area 3 figur averag access probabl line three consecut area known see remain combin obtain correspond area vector 26 number line vector compet cach set final calcul self interfer probabl function comput averag number line line vector compet cach set need function defin ae averag number line vector map cach set 3 model spars matrixvector product code spars matrix algebra kernel shown figur format use store spars matrix compress row storag cr contain spars matrix entri c store column entri r indic point c new row spars matrix start permit know number entri per row three vector destin vector product present pure sequenti access thu miss intrins self interfer miss due cross interfer special take account consid kway associ cach therefor number miss vector calcul number cach line cover intrins miss nevertheless vector x suffer seri indirect access depend locat entri spars trix address valu cj number miss access vector calcul multipli number line referenc per dot product number row spars matrix miss probabl one access first valu calcul p delta nl x cover nl line one probabl p access dot product time given row spars matrix state previou section miss probabl calcul opposit hit probabl hit take place whenev access line referenc previou dot product suffer self cross interfer cross interfer gener access remain vector present sequenti access cross interfer area given total area vector associ access vector c r area vector calcul way explain section ad individu area vector correspond access program vector period consid ere case interest calcul cross interfer area vector dot product cross area vector cover access vector v dot product four vector sequenti access express ss deriv section appli valu obtain consid one element r fi compon c access per dot product scale factor r appli integ vector order take account integ data often store use less byte real one factor quotient number byte requir real datum one requir integ self interfer probabl line x compet averag cn line vector see definit cn cach set probabl p access dot product time row spars matrix result number differ candid line x replac given line access dot product belong binomi hit probabl first access line x dot product jth row spars matrix time vector x p1gammap igamma1 probabl last access line taken place dot product ago int x interfer area vector gener access produc dot product calcul cross interf area vector obtain ad self interfer area vector given access uniform access probabl per line 1gamma1gamma p line vector x gener self interfer anoth line calcul use final averag hit probabl calcul end jci2 end end kri ri11 ctpi end end figur 5 transposit spars matrix must point model take account first access line x dot product nnz gammapdeltam deltanl access low probabl result miss refer line access previou iter inner loop 4 model transposit spars matrix section model extend oper greater degre complex spars matrix transposi tion previou section assum spars matrix transpos store cr format figur show transposit algorithm describ matric repres vectorsa c r ct rt respect observ loop 4 multipl indirect level left right side sentenc follow employ similar approxim one develop previou section estim number miss vector ct rt remain vector sequenti access alreadi consid previou algorithm 41 vector ct two vector follow exactli access pattern may observ loop 4 figur thu explain estim number miss one ct ident take account integ vector access pattern one model sg describ section pattern similar one explain section vector x access probabl uniformli distribut along vector differ vector x probabl constant line vec tor vector ct correspond set mani element column origin spars matrix hold result gener form hit probabl process jth row spars matrix similar one follow differ ffl probabl access consid line vector process row p ffl probabl access anoth line map cach set process previou row 1gamma1gammap 1gamma ffl vector nnz element number line compet set line consid cnnz equat calcul interfer area vector ffl calcul cross interfer probabl scheme ad area vector correspond access remain vector use r c calcul accord remain area vector l n delta nnz delta 42 vector rt vector referenc four loop algorithm first loop total sequenti access produc miss second loop access rt follow similar pattern vector x spars matrixvector product differ consist one possibl sourc cross interfer vector c rt integ vector real valu vector number miss loop 2 first hit rt2 p hit rt2 calcul follow express introduc modif mention vector rt complet access sequenti manner previou loop reason must add probabl first hit rt2 get hit due exist portion rt cach initi loop final express found loop 3 vector rt sequenti access without access vector estim number miss p first hit rt3 may estim p first hit rt2 delta pr delta final loop 4 access rt similar spars matrixvector product describ section loop must also consid hit probabl p first hit rt4 due previou load rt gener loop 3 5 extens band matric larg number real numer problem engin lead matric spars band distribut entri section present modif model requir order describ cach behavior matric type model paramet pn see tabl calcul fi w w bandwidth consequ p take valu 51 spars matrixvector product number miss vector x one affect band distribut entri model behavior vector ident one describ section number access differ line dot product vector x involv multipli miss probabl calcul calcul p hit x express must replac w one line x may access product maximum w row addit number line x compet anoth cach set cw instead cn influenc p hit x j express entri row distribut among w posit instead n 52 transposit spars matrix calcul number miss modifi similar way vector x spars matrixvector product line vector spread access probabl process w row spars matrix instead thu reduc limit sum calcul hit probabl reason number line given line vector compet cach set access period cnnz cnnzn delta w besid access follow pattern describ area vector funcion gb section probabl access process previou row given line map cach set line consid 1gamma also cross interfer probabl calcul need modifi accord new access pattern similar chang need estim number miss vector ct take account made integ valu predict number miss vector rt loop 2 4 base model vector x spars matrixvector product calcul p hit rt2 p hit rt4 requir modif explain previou section number differ line access dot product longer n delta rl w delta rl chang need also calcul probabl hit due reus p first hit rt2 p first hit rt4 final valu p first hit rt3 p first hit rt2 delta pr delta w 6 result model valid simul synthet matric uniform distribut non zero element band matric harwellbo collect trace simul obtain run algorithm replac origin access call function calcul posit access write disk trace fed dineroiii cach sim ulat belong wart tool tabl show model accuraci spars matrixvector product combin input paramet uniform band spars matric respec tive tabl display result spars matrix transposit model without loss gener consid squar matric anali si r 1 cs express kword ls word maximum error obtain trial set 515 synthet matric 2812 harwellbo matric reason last result entri distribut real matric complet uniform produc high deviat spars matrix transposit model see tabl nevertheless consid amount deviat still accept analysi purpos besid small size matric collect favor converg probabilist model also want point averag error predict measur tabl 2 predict measur miss deviat model spars matrixvector product uniform entri distribut nnz number miss thousand name n w nnz ff cs ls k predict measur tabl 3 predict measur miss deviat model spars matrixvector product harwellbo matric predict measur tabl 4 predict measur miss deviat model transposit spars matrix uniform entri distribut nnz number miss thousand name n w nnz ff cs ls k predict measur tabl 5 predict measur miss deviat model transposit spars matrix harwellbo matric pn log ls figur number miss 4way associ cach 2kw spars matrixvector product 10k theta10k matrix function ls pn k2 k4 log ls figur 7 number miss spars matrixvector product 10k theta 10k matrix function line size 2kw cach differ associ synthet matric 065 5 real matric figur present relationship number miss differ paramet introduc model case cs ls display base 2 logarithm number cach kword line word respect figur show relationship number miss ls pn spars matrixvector product evolut approxim linear respect pn number access directli proport nnz follow sequenti pattern may observ number miss significantli decreas ls increas access vector except x sequenti see figur larger line exploit spatial local obtain nevertheless ls larg 64 word matrix lower degre sparsiti pn 01 increas self cross interfer probabl vector x begin unbal advantag obtain effici use spatial local exhibit remain vector effect shown figur increas valu pn relationship w cs band spars matrixvector product shown figur graph0515x figur 8 number miss spars matrixvector product spars matrix 20ktheta20k tri function w cs k2 k4 log figur 9 number miss spars matrixvector product 20k theta 20k matrix 2m entri 8000 function cach size ls 8 differ associ consid broad band order illustr effect self interfer access vector x bandwidth reduct larg influenc number miss reduc self interfer probabl increas reus probabl line vector x non zero spread narrow row spatial local improv column tempor local improv ment number miss near minimum reach increas cs beyond size littl use intuit good miss rate reach cs w size line cach line band current process row extra room need avoid combin effect self cross interfer shall demostr analysi fix bandwidth differ degre associ cach size figur number miss matrix display relat cach size differ associ observ improv reach 8kw cach due elimin self interfer cach size increment size help gradual reduc cross interfer hand cach k 1 log figur 10 number miss transposit spars matrix 20ktheta20k function w cs differ behavior miss reduct gradient high cs 16kw reason 8kw cach k differ line x map cach set line usual access order cach use lru replac cross interfer may gener miss line x map cach set result cross interfer affect mani line set hold thu gener miss fact see 4way associ cach perform littl wors 2way cach cach size cach cs 16kw cach set enough line left absorb access vector compris spars matrix destin vector without increas interfer x due combin line vector resid cach set small cach size associ perform similarli due larg number interfer conclus associ cach help reduc interfer effect number line compet given cach line smaller equal k otherwis perform quit similar direct map cach moreov case line map cach set usual access order high associ may perform wors spars matrix transposit figur repres data algorithm figur spars matrixvector product respect first one show decreas number miss bandwidth reduct notic point cs becom greater w reason explain previou algorithm anyway reduct much softer spars matrixvector product access vector rt loop 2 4 directli favour bandwidth reduct stand small portion miss hand number miss vector ct account vast major miss decreas slowli cs increas w decreas although also heavili depend bandwidth reason case shown figur data belong vector process column insid band origin matrix fit cach nnzn delta w entri case set fit see number miss becom stabl area k2 k4 log figur 11 number miss transposit spars matrix 20ktheta20k matrix 2m entri 8000 function cach size ls 8 differ associ graph miss c r remain almost complet constant due sequenti access obtain benefit bandwidth reduct somewhat lower cross interfer probabl figur show gener behavior algorithm respect k associ degre although similar spars matrixvector product depend w determin cach size hit rate obtain reason valu explain reason none cach size consid contain consider portion data algorithm access w iter process whole band loop 4 one caus miss access rt mainli loop 2 benefit increas cs valu larger w special notic spars matrixvector product anoth similar wors behavior cach k 1 cach size close w due ad effect cross interfer self interfer cach line usual access order penal lru replac algorithm cach size notic larger bandwidth higher associ perform better figur order get hint valu cach paramet algorithm stabil miss figur show data smaller matrix use 4 process band matrix work set vector ct account miss compris 25w element averag 25 element per column hit rate obtain valu near maximum figur cach size exce valu increas cs beyond limit provid littl perform improv improv notic cach size increas high due strong reduct cross interfer must take account graph construct 4way associ cach somewhat greater cach size would need obtain good cross interfer reduct direct map cach see figur associ cach help reduc miss rate small cach size figur averag alway less 2 line compet set process row 200 line vector log figur 12 number miss transposit spars matrix 5ktheta5k 125k entri function w cs k2 k4 log figur 13 number miss transposit spars matrix 5ktheta5k matrix 125k entri 200 function cach size ls 4 differ associ non null access probabl 200 line belong vector ct line belong vector smallest cach consid 512 line expect increas cach size reduc hit ratio differ direct map cach set associ cach cs 8kw cach size increas help reduc cross interfer final relationship line size matrix densiti number miss last algorithm prove spars matrixvector product differ gradient increas miss relat pn three time larger normal number access per non zero origin matrix eight spars matrixvector product algorithm three 7 conclus futur work present fullyparametriz model estim number miss gener kway associ cach lru replac appli spars matrixvector product transposit spars matrix model deal possibl type dineroiii time model time 100 1000 1 1000 100 1000 10 100 100 1000 1 1000 100 1000 10 100 100 1000 1 1000 100 1000 10 100 tabl simul model user time calcul number miss transposit band spars matrix 200 mhz pentium n nnz thousand time second miss demonstr high level accuraci predict consid uniform distribut entri whole matrix given band tabl show besid provid inform model much faster simul even time requir gener trace take almost much time execut simul includ tabl illustr model may use studi cach behavior code shown import bandwidth reduct case band matri ce even high degre associ model also appli studi possibl architectur cach paramet modif order improv cach perform futur work includ extens model consid prefetch subblock placement hand work model non uniform distribut entri spars matric focus common pattern appear real matric suit final order obtain accur estima tion studi inclus data structur base address paramet model r analysi cach perform oper system multiprogram templat solut linear system build block iter method user guid harwellbo spars matrix collect cach miss predict spars matrix comput cach miss equat analyt represent cach miss cach profil spec benchmark case studi spars matrix technolog spars matrix comput implic cach design character behaviour spars algorithm cach cach interfer phenomena tracedriven memori simul survey tr analysi cach perform oper system multiprogram character behavior spars algorithm cach spars matrix comput cach interfer phenomena block algorithm spars matrix comput high perform workstat tracedriven memori simul cach miss equat cach profil spec benchmark ctr gerardo bandera manuel ujaldn emilio l zapata compil runtim support parallel spars matrix updat algorithm journal supercomput v17 n3 p263276 nov 2000 basilio b fraguela ramn doallo emilio l zapata probabilist miss equat evalu memori hierarchi perform ieee transact comput v52 n3 p321336 march chunyuan lin jenshiuh liu yehch chung effici represent scheme multidimension array oper ieee transact comput v51 n3 p327345 march 2002 b b fraguela r doallo j tourio e l zapata compil tool predict memori hierarchi perform scientif code parallel comput v30 n2 p225248 februari 2004 jingl xue xavier vera effici accur analyt model wholeprogram data cach behavior ieee transact comput v53 n5 p547566 may 2004 chunyuan lin yehch chung jenshiuh liu effici data parallel algorithm multidimension array oper base ekmr scheme distribut memori multicomput ieee transact parallel distribut system v14 n7 p625639 juli