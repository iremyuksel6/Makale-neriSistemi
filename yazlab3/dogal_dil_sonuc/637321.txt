monad theori morphic infinit word gener present new exampl infinit word decid monad theori formal consid structur n p expand order n natur number unari predic p correspond infinit word characterist 01sequenc xp p show morphic predic p associ monad secondord theori mthn p decid thu extend result elgot rabin 1966 mae 1999 solut obtain framework semigroup theori connect known automata theoret approach elgot rabin final larg class predic p exhibit monad theori mthn p decid unifi extend previous known exampl b introduct paper studi follow decis problem xed word x given buchi automaton accept x problem acc x decid mean intuit one use x extern oracl inform nontermin nitest system still keep decid result behaviour solv problem larg class word socal morphic word gener complement extend result elgot rabin 11 mae 15 problem acc x motiv logic decis problem regard monad theori start fundament work buchi 8 equival monad secondord theori mthhni linear order hn automata precis buchi automata buchi use reduct formula automata show mthhni decid decid proof base fact sentenc monad secondord languag hn convert inputfre buchi automaton hold hn admit success run latter easili check soon observ buchi theorem applic also gener situat regard expans hn p structur hn xed predic p n one start formula x one free set variabl consid equival buchi automaton input alphabet true hn p interpret x accept characterist word xp b associ p ith letter xp 1 word theori mthhn p decid one determin given buchi automaton whether accept xp elgot rabin 11 follow approach via decis problem acc xp found sever interest predic p mthhn p decid among set factori number n set kth power n k xed k set kpower k n xed k elgot rabin later also siefk 18 use automata theoret anal ysi call contract method solut decis problem acc xp idea reduc decis problem case ultim period word easili solvabl given p one predic mention elgot rabin show buchi automaton 0section xp contract way ultim period word obtain accept xp accept ultim period word one easili decid whether accept recent mae 15 studi morphic predic obtain iter applic morphism word see section 2 deni tion morphic predic includ exampl instanc predic fibonacci number seem access elgotrabin method mae prove morphic predic p rstorder theori decid also introduc appropri although spe cial version morphic predic higher ariti remain open whether morphic predic p monad theori mthhn p decid present paper answer question posit base new quit simpl semigroup approach decis problem acc xp section 2 show morphic predic p problem acc xp decid consequ nd new exampl predic p decid monad theori mthhn p promin one fibonacci predic consist fibonacci number thuemors word predic consist number whose binari expans even number 1s second part paper emb approach framework contract method method shown applic predic call residu ultim period prove two result mor phic predic residu ultim period certain class residu ultim period predic share strong closur properti among sum product exponenti allow obtain mani exampl predic p monad theori mthhn p decid note certain concret applic fibonacci predic semigroup approach much conveni explicit applic contract method analysi retrospect reveal latter possibl also morphic predic like thuemors word predic approach directli contract method long section 0s 1s let us nalli comment exampl predic p correspond buchi accept problem acc xp henc mthhn p undecid give comment unsettl case relat work first recal simpl recurs predic p mthhn p undecid consid nonrecurs recurs enumer set q posit number say recurs enumer recurs even rstorder theori fthhn p undecid element x p element x next element x p condit express rstorder sentenc k hn p buchi landweb 9 thoma 19 determin recurs theoret complex theori mthhn p recurs p turn exampl recurs p theori mthhn p truthtablereduc complet set bound improv situat chang recurs predic countabl ordin consid see 22 20 shown predic p full monad theori mthhn p decid weak monad theori wmthhn p set quantier assum rang nite set howev exampl p rstorder theori fthhn p decid wmthhn p undecid 19 present paper restrict expans hn unari predic expans hn fi unari function f undecid mthhn fi aris alreadi simpl case like doubl function 2n survey theori see 16 hand seem hard provid mathemat natur recurs predic p mthhn p undecid promin exampl natur predic p decid mthhn p unsettl prime number predic remark alreadi buchi landweb 9 decid proof dicult would principl answer unsolv number theoret problem like twin prime hypothesi state innit mani pair prime exist known result mthhn p decid linear case schinzel hypothesi 4 part result present paper present confer mfcs2000 10 automata morphic predic morphism applic imag word concaten imag letter morphism complet dene imag letter sequel describ morphism specifi respect imag letter follow exampl let nite alphabet let morphism integ n denot n composit n copi let sequenc nite word dene integ n rst letter word xn prex xn1 furthermor sequenc length jx n j bound sequenc converg innit word x denot word x xed point morphism sinc satis exampl 1 let consid morphism given word respect equal easili prove induct n n1 therefor xed point equal innit word abc 2 bc 4 bc 6 bc innit word x b said morphic morphism morphism b sequel alphabet b often alphabet morphism letter letter characterist word predic p set n nonneg integ innit word alphabet b dene b predic said morphic characterist word morphic denit illustr follow two exampl exampl 2 consid morphism introduc preced exampl morphism given morphic word actual characterist word predic ng easili prove use equal 1 squar predic therefor morphic prove sequel class morphic predic contain predic form fn k jn 2 ng fk n jn 2 ng xed integ k exampl 3 consid morphism b b dene xed point characterist word predic p binari expans n contain even number 1 xed point 1 wellknown thuemors word refer reader 5 interest survey sequenc relat work thue recal buchi automaton automaton nite set state e q q set transit f set initi nal state path success start initi state goe innit often nal state innit word accept label success path refer reader 21 complet introduct state main result corollari formul context monad theori theorem 4 let xed morphic word morphism buchi automaton decid whether x accept explain introduct theorem transfer logic decid result invok buchi theorem 8 equival monad formula hn buchi automata corollari 5 unari morphic predic p monad secondord theori hn p decid proof theorem automaton dene equival relat f f mean path p q label u p u f mean path p q label u hit nal state equival relat captur two nite word behavior automaton respect buchi accept condit alreadi introduc buchi 8 denot project map word equival class equival relat congruenc nite index inde word u v u 0 v 0 follow implic hold properti allow us dene product class endow set structur nite semigroup project morphism onto furthermor xed state p q three possibl word u either path p q nal state path p q nal state path p q label u prove number class bound 3 n 2 n number state automaton follow observ give main properti congruenc suppos two innit word x x 0 factor x k k 0 x accept accept inde suppos x label success path path factor q 0 initi nite path q k nal state innit mani k sinc u k u 0 k k 0 anoth path nite path q k nal state whenev q k prove x 0 also label success path accept particular innit word x factor u 1 u 2 x accept u 1 also accept sinc rst letter word equal au nonempti nite word u may easili veri induct n integ n one word factor claim two posit integ n p k n relat u k u kp hold relat equival u k morphism semigroup complet determin imag letter therefor nite mani morphism nite semigroup impli two posit integ n p impli k greater n thu u k u kp note two integ n p eectiv comput suce check n b np b letter b alphabet dene sequenc v k k0 nite word v 1 word x factor relat v 1 v 2 v 3 hold prove word x accept automaton word v 1 accept obvious decid 3 larg class morphic predic purpos section give uniform represent larg class morphic predic show predic k 0 polynomi qn nonneg integ valu morphic suppli larg class predic p decis problem acc xp henc monad theori hn p decid particular classic exampl fk xed k n 11 cover prepar shall develop sucient condit sequenc dene morphic predic involv notion nration sequenc consider also show fibonacci predic ffn refer reader 17 complet introduct 3 survey although recal denit definit 6 sequenc un n0 integ nration graph g allow multipl edg set f vertic un number path length n vertex vertex f graph g said recogn sequenc un n0 equival denit obtain consid nonneg matric sequenc un n0 nration matrix n kk two vector l b 1k c b k1 un lm n c suce inde consid adjac matrix graph two characterist vector set f vertic also possibl assum two vector l respect belong n 1k n k1 instead b 1k b k1 sinc class nration sequenc obvious close addit triplet l mc un lm n c call matrix represent sequenc integ k call dimens represent follow exampl illustr notion exampl 7 number success path length n graph pictur figur 1 fibonacci number fn f show sequenc fn n0 nration sequenc follow matrix represent dimens 2 deduc graph figur 1 figur 1 graph fibonacci sequenc state main result section theorem 8 let un sequenc nonneg integ let un sequenc dierenc integ l dn 1 n l sequenc n nl nration predic rst illustr theorem reconsid predic fibonacci dierenc equal fn 1 obvious satis dn 1 n 1 sequenc fn n0 nration shown exampl 7 fibonacci predic morphic follow corollari obtain larg collect morphic pred icat includ predic form fn k consid 11 corollari 9 let q polynomi qn integ integ n let k posit integ predic 0g morphic proof corollari entir base follow lemma polynomi posit lead coecient qn integ integ n let k posit integ let un dene un qnk n nonneg integ l sequenc note polynomi may noninteg coecient polynomi proof let degre q claim nonneg integ l posit integ n let q l n polynomi qn l sinc q l n integ integ n polynomi q l n equal linear combin binomi integ coecient see 12 p 189 uniqu sequenc integ integ n li sinc binomi satisfi wellknown relat n1 follow coecient li satisfi follow relat integ l one l1d ld li1 sinc lead coecient q l posit coecient ld also posit l use relat coecient li prove induct dierenc integ l li posit l l integ l dene requir properti dene matrix vector l c follow vector l vector dimens matrix squar matrix dimens dene vector c vector dimens pure routin prove induct n lm n vector ln given l 0 therefor unl equal lm n c sequenc unl n0 nration proof theorem 8 need preliminari result state lemma make easier proof certain predic morphic essenti state properti morphic preserv shift chang nite number valu particular two predic p p 0 coincid almost everi n p morphic p 0 morphic lemma 11 let p predic let r nite set integ let k nonneg integ let p 0 predic r morphic p 0 morphic proof let p morphic predic assum characterist word xp p equal respect morphism b let x xed point let u nite word au innit word x factor rst prove predic p also morphic let 0 alphabet 0 1 two new symbol dene morphism 0 0 0 b clear xed point dene morphism 0 0 b 0 1 b 0 0 set 0 word characterist word p 0 0 0 set 1 word characterist word p 00 prove posit integ k predic alphabet 0 new symbol dene morphism 0 0 b clear xed point let k length u dene morphism 0 0 b b word 0 characterist word p 0 claim result follow easili two previou result follow two result use proof theorem 8 rst result due schutzenberg refer reader 17 thm ii86 6 thm v21 complet proof theorem 12 sch utzenberg 1970 let un n0 nration sequenc un 1 n sequenc un 1 n0 also nration next result need notion d0lsequenc nration sequenc un n0 integ said d0lsequenc recogn graph whose state nal equival nration sequenc un n0 d0lsequenc matrix represent l mc compon l either 0 1 compon c equal 1 follow result 17 lem iii74 everi nration sequenc u n n0 decompos d0l sequenc mean two integ k p sequenc u knp n0 k k d0lsequenc nalli come proof theorem 8 proof suppos un satis dn 1 n l sequenc n n l nration lemma 11 may assum without loss gener l 0 theorem 12 sequenc v n n0 dene sequenc decompos d0lsequenc two two integ k p sequenc v knp n0 k k d0lsequenc lemma 11 may assum without loss gener u sequenc v sequenc v k matrix represent compon l k either 0 1 compon c k equal 1 let k dimens represent dene alphabet dene morphism 7 ac l01 c ki 7 c mki1 easili prove induct n w ki word alphabet fc kj j 1 j k g length v ki actual number occurr letter c kj word w ki jth compon vector l k k dene morphism b complement corollari 9 predic fqnk n j n 2 ng morphic formul necessari condit predic p morphic turn factori predic fn j n 2 ng fall condit show morphic subsequ section shall develop framework predic handl togeth morphic one thu unifi contract method elgot rabin result proposit 14 let un n0 strictli increas sequenc integ predic fun integ k proof suppos characterist word predic fun j n 2 ng equal respect morphism b let x xed point let u nite word au innit word x factor let k integ dene bj easili shown induct n j n bj k n letter b let b set letter b b contain least one 1 g claim xed letter b integ n n b contain letter b smallest integ satisfi properti smaller cardin follow fact letter c appear n b sequenc letter b appear b 0 n integ n word n contain therefor letter b result follow easili residu ultim period predic section develop framework merg contract method elgot rabin semigroup approach use morphic predic common gener two approach captur notion residu ultim period innit word introduc word show morphic word belong class applic contract method develop subsequ section definit 15 sequenc un n0 word alphabet said residu ultim period morphism nite semigroup sequenc un ultim period properti said eectiv morphism nite semigroup two integ n p k n eectiv comput innit word x call residu ultim period factor sequenc u n n0 eectiv residu ultim period follow proposit show properti use decid problem acc x proposit 16 innit word x residu ultim period problem acc x decid proof let q e f buchi automaton dene equival relat relat congruenc nite index applic map nite word class therefor morphism nite semigroup congruenc follow main properti suppos two innit word x x 0 factor u k u 0 k k 0 x accept x 0 accept sinc sequenc u n n0 residu ultim period two integ n p k greater n therefor x accept word v 1 accept v illustr notion follow exampl exampl 17 sequenc word n n0 residu ultim period sequenc actual residu ultim constant inde wellknown element nite semigroup integ n greater cardin n equal xed element usual denot literatur 2 p 72 sequenc word residu ultim constant consider studi call implicit oper literatur 2 slight variant previou exampl show sequenc u n n0 dene un residu ultim constant sinc n equal nn 1 word u 0 u 1 characterist word factori predic ng monad theori hn p p factori predic therefor decid previou proposit follow proposit connect residu ultim period sequenc innit word obtain iter morphism proposit morphism let u word sequenc un n u residu ultim period properti eectiv proof let morphism nite semigroup sinc nite nite mani morphism therefor two integ n p impli k greater n one note two integ n p eectiv comput suce nd n p n letter follow proposit morphic word factor whose factor form residu ultim period sequenc let x morphic word morphism let u nite word au word x factor un n u n 1 proposit sequenc n u n0 residu ultim period sequenc u n n0 therefor also residu ultim period 5 predic class k decid decis problem acc x innit word x involv good factor word x case morphic word factor natur provid gener x via morphism anoth approach consid canon factor word x induc block form word x repres distanc success element predic contract method develop elgot rabin 11 siefk 18 reduc sequenc nite word 0 1 ultim period sequenc section emb method framework develop strictli increas sequenc integ characterist word xp predic canon factor un word 0 kn1 kn 1 1 alphabet b sequenc word residu ultim period furthermor properti eectiv decid whether word xp accept buchi automaton monad theori hn p therefor decid prove class sequenc properti hold contain interest sequenc like n k also close sever natur oper like sum product exponenti follow lemma essenti state suce consid sequenc un kn1 kn onelett alphabet lemma 19 let un n0 sequenc word let letter sequenc un n0 residu ultim period sequenc u n n0 residu ultim period moreov properti eectiv eectiv un n0 proof clear sequenc u n n0 residu ultim period sequenc un n0 also residu ultim period inde morphism nite semigroup relat impli sequenc un n0 ultim period sequenc una also ultim period convers let morphism nite semigroup let semigroup 1 product dene ts morphism dene may easili veri induct length word w therefor sequenc un n0 residu ultim period sequenc una un ultim period sequenc u n n0 residu ultim period onelett alphabet fag semigroup isomorph set n integ identifi word n integ n therefor sequenc integ said residu ultim period sequenc kn residu ultim period k class increas sequenc k n n0 integ sequenc k n1 kn n0 residu ultim period lemma 19 proposit 16 conclud theorem k let xp characterist word predic ng decis problem acc xp decid monad theori mthhn p also decid give two comment rst one relat class k residu ultim periodic sequenc second one similar class predic introduc siefk 18 state corollari 28 sequenc k residu ultim period convers true follow exampl show let innit word alphabet b b consid sequenc dene word x innit mani occurr 1 sequenc k n n0 residu ultim period cf exampl 17 howev word x ultim period sequenc residu ultim period 18 siefk studi predic gener sequenc two condit eectiv ultim reduc correspond eectiv residu ultim period essenti increas sequenc dierenc kn1 kn ie 0 eectiv comput second assumpt ensur sequenc k n1 kn n0 residu ultim period sens although natur predic class k also treat siefk approach except instanc let dene even odd sequenc k n n0 class k siefk second assumpt appli follow theorem show class k contain interest sequenc close sever natur oper theorem 22 sequenc k n n0 sequenc k n1 kn n0 nration belong k sequenc belong k follow sequenc also belong k sum product kn exponenti k l n xed integ k k l n gener sum product lemma 10 class k contain sequenc form k n qn k posit integ q polynomi qn integ integ n appli gener product sequenc sequenc n n0 belong k closur dierenc show k contain ration sequenc integ lim n1 k n1 kn ration sequenc integ dierenc two nration sequenc 17 cor ii82 class k also close oper instanc prove sequenc belong k sequenc dene belong k class k close sum dierenc product exponenti follow exampl show close quotient exampl 23 consid sequenc sequenc residu ultim period sinc sequenc k n mod 4 ultim period turn k n mod p ultim period unless 1 easili seen greatest integ l 2 l divid kn number 1 binari expans n therefor k n mod 4 equal 2 n power 2 0 otherwis two integ p dene equival relat tp n follow integ k k 0 one integ p respect call threshold period relat tp note relat k tp k 0 alway impli mod p equival relat tp nite index compat sum product inde k tp k 0 l tp l 0 hold relat relat tp p captur properti residu ultim period sequenc integ lemma 24 sequenc k n n0 integ residu ultim period integ p two integ 0 p 0 n greater 0 one kn tp knp 0 proof inde condit sucient sinc element nite semigroup two integ p convers condit also necessari set n tp equip addit nite semigroup canon project n n tp morphism follow result almost trivial often use lemma l l relat associ xed integ residu ultim period sequenc integ two integ r q k jn p 1 l 1 j n greater r proof sinc sequenc k n0 residu ultim period two integ r ij q ij k jn p n greater ij two integ r q dene requir properti follow lemma state class residu ultim period sequenc integ close sum product result follow gener result state class residu ultim period sequenc word close substitut precis sequenc morphism b sequenc n n0 residu ultim period sequenc u n n0 word also residu ultim period sequenc n un residu ultim period word un instanc equal xed word ab morphism n map vn b wn word n u equal vn wn class residu ultim period sequenc word close concaten un equal kn n equal l n n un equal kn l n give direct proof result reli compat relat tp sum product lemma 26 let k n n0 l n n0 two residu ultim period sequenc integ sequenc also residu ultim period lim n1 k n l n sequenc k n l n n0 also residu ultim period follow exampl show assumpt limit sequenc kn l n realli necessari let innit word alphabet b consid sequenc k n n0 l n n0 dene two sequenc obvious residu ultim period cf exampl 17 howev dierenc kn l n equal n word x ultim period sequenc k n l n n0 residu ultim period proof lemma 25 r q kn tp knq l n tp l nq n greater r yield kn kn l n tp knq l nq n greater r sequenc residu ultim period relat kn tp knq l n tp l nq impli l yield kn l dierenc kn l n greater n greater r 0 n greater r r 0 one kn l n tp knq l nq n greater r 0 sequenc k n l n n0 residu ultim period follow lemma state class residu ultim period sequenc integ close gener sum product l use prove gener case lemma residu ultim period sequenc int ger sequenc kn n0 ln n0 dene also residu ultim period proof let tp relat associ two xed integ p two integ r q kn tp knq n grater r let k sum note integ l two integ r 0 q 0 r 0 k tp r kn tp knqq 0 hold n greater r inde one r tp r tp r tp r proof ln similar suce replac sum product instanc constant k dene two integ r 0 q 0 chosen k r 0 previou lemma follow corollari corollari 28 sequenc k n n0 k residu ultim period follow lemma need prove class k close gener sum product residu ultim period sequenc integ sequenc kn n0 ln n0 dene residu ultim period proof let tp relat associ two xed integ p two integ r q kn tp knq n grater r let k sum note integ n greater r two integ r 0 q 0 r 0 k tp r lemma 25 also two integ r 00 q 00 l n rq l nq 00 dn rr 0 qqq 0 dnq 00 n greater r 00 claim kn tp knq 00 n greater r 00 rst claim knq 00 tp result obvious hold otherwis one l n r l nq 00 r sinc l k tp k il l l nq 00 l n l n prove claim prove iln tp kn result hold obvious otherwis one dn r may assum dnq 00 dn sinc dnq suppos dnq 00 l one tp l ndnlqq 0 tp l ndn r 0 q tp l ndn r 0 q tp l ndn x proof ln similar suce replac sum product nalli come proof theorem 22 proof prove sequenc k n n0 sequenc k n1 kn n0 nration belong k follow theorem 8 proposit also provid direct proof sequenc n n0 dene nration matrix represent l mc relat tp matric set tp 0 relat kl tp 0 kl hold k lentri matric two integ r q r tp rq impli n tp nq n greater r thu one dn tp dnq n greater r sequenc belong k lemma 26 appli sequenc k n1 kn n0 l n1 l n n0 show sequenc belong k furthermor assumpt limit fulll also show sequenc k n l n n0 belong k dierenc kn1 l n1 kn l n equal kn1 l n1 l n kn1 kn l n lemma 27 sequenc k n n0 l n n0 residu ultim period lemma 26 sequenc dierenc residu ultim period sequenc k n l n n0 belong k dierenc k l n1 k l n equal k l n k l n1 l n 1 lemma 27 sequenc k l n k l n1 l n residu ultim period lemma 26 sequenc dierenc residu ultim period sequenc belong k let kn sum dierenc kn1 kn equal sum lemma 27 sequenc l n n0 residu ultim period lemma 29 sequenc dierenc residu ultim period let kn product dierenc kn1 kn equal l n l n1 lemma 29 sequenc ln n0 dene residu ultim period lemma 27 appli sequenc ln n0 sequenc dene l 0 residu ultim period lemma 26 sequenc dierenc residu ultim period sequenc kn n0 belong k let dn dierenc kn1 kn let 0 n dierenc k l n1 n assum sequenc k n n0 strictli increas also assum l n 2 n greater constant eectiv comput prove sequenc 0 residu ultim period let tp relat associ two xed integ p rst claim greater inde follow inequ sinc sequenc k n n0 assum strictli increas dn nonzero kn greater n greater lemma 25 two integ k n tp k nm integ k integ n greater note n k tp l k n tp l n tp l nm lemma 25 two integ r q kn tp knq dn tp dnq 0 l n sm l nq integ n greater r claim 0 integ n greater r nq suce prove 0 nq mod p relat kn tp knq l n sm l nq 0 impli k l n nq relat kn1 tp knq1 l n1 rq l nq1 impli k l n1 nq1 two relat impli 0 nq mod p conclus introduc larg class unari predic p n correspond buchi accept problem acc xp henc monad theori decid class contain morphic predic solv problem mae 14 15 connect work elgot rabin 11 siefk 18 establish extend class morphic predic class residu ultim period predic final strong closur properti sum product exponenti shown certain residu ultim period predic sequenc differ success element residu ultim period altogeth obtain larg collect concret exampl p mthhn p de cidabl contain kth power kpower k valu set polynomi integ factori predic fibonacci predic well predic deriv morphic word like thuemors word fibonacci word let us mention open problem result cover expans hn tupl predic rather singl predic dissert hosch 13 solv problem special case predic p ng know whether mthhn decid p known residu ultim period predic p buchi accept problem acc xp henc theori mthhn p decid possibl next step consid sturmian word natur gener morphic word see 7 final recal intrigu question alreadi ask buchi landweb 9 problem 1 interest recurs predic p mthhn p undecid p prime number predic acknowledg author would like thank jorg almeida jeanpaul allouch jean berstel jacqu desarmenien interest suggest comment r linear cellular automata finit semigroup univers algebra decid undecid theori predic prime axel thue work repetit word ration seri languag monad theori morphic decid undecid extens second concret math matic decis problem b decid automata theoret decid proof open question around b decid extens monad second order successor arith metic theori successor extra predic bound monad theori wellord structur automata ehrenfeucht game tr ration seri languag automata infinit object linear cellular automata finit automata pascal triangl open question around bumyampersandumlchi presburg arithmet automota theoret decid proof firstord theori inlineequ f fen lpangblkbdnblkbdmyampersandltprp postangfenf inlineequ morphic predic p concret mathemat automata monad theori morphic infinit word gener ehrenfeucht game composit method monad theori ordin word decis problem buechi sequenti calculu ctr alexand rabinovich decid monad logic order natur extend monad predic inform comput v205 n6 p870889 june 2007 jean berstel luc boasson olivi carton bruno petazzoni jeaner pin oper preserv regular languag theoret comput scienc v354 n3 p405420 4 april 2006 erich grdel wolfgang thoma thoma wilk literatur automata logic infinit game guid current research springerverlag new york inc new york ny 2002