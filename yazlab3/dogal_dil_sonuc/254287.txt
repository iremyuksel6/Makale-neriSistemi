ray shoot amidst sphere three dimens relat problem consid problem ray shoot amidst sphere 3space given n arbitrari possibl intersect sphere 3space epsilon 0 show preprocess sphere time on3epsilon data structur size on3epsilon rayshoot queri answer time onepsilon result improv previou techniqu see p k aggarw l guiba pellegrini sharir ray shoot amidst sphere unpublish note p k aggarw j matousek discret comput geom 11 1994 pp 393418 roughli on4 storag requir support fast queri result show ray shoot amidst sphere complex compar ray shoot amidst plane 3space techniqu appli gener convex object 3space also discuss extens b introduct ray shoot problem defin follow given collect n object ir preprocess data structur one quickli determin first object intersect queri ray ray shoot problem receiv consider attent past year applic comput graphic geometr problem 1 4 5 6 10 11 13 16 21 work date studi planar case collect line segment ir 2 chazel guiba propos optim algorithm special case boundari simpl polygon 16 algorithm answer ray shoot queri olog n time use space simpler algorithm asymptot perform bound recent develop 13 24 collect arbitrari segment plane best known algorithm answer ray shoot queri time work paper support nsf grant ccr9122103 grant us isra binat scienc foundat gif germanisra foundat scientif research develop fund basic research administ isra academi scienc paper part first author msc thesi prepar supervis second author school mathemat scienc tel aviv univers z school mathemat scienc tel aviv univers courant institut mathemat scienc new york univers log o1 n use os 1 space preprocess 1 1 6 10 paramet vari n n 2 although lower bound known case conjectur bound close optim spite recent develop threedimension ray shoot problem seem much harder still far fulli solv gener threedimension ray shoot problem preprocess collect n convex object first object hit queri ray comput effici studi problem consid case collect triangl triangl face convex polyhedron optim algorithm ologn queri time linear space obtain use hierarch decomposit scheme dobkin kirkpatrick 19 triangl form polyhedr terrain piecewiselinear surfac intersect everi vertic line exactli one point techniqu chazel et al 15 yield algorithm requir 2 space answer ray shoot queri olog n time nontrivi solut gener problem involv triangl obtain recent see 4 6 11 result best known algorithm ray shoot among triangl three dimens due agarw matousek 5 answer ray shoot queri time n 1 14 os 1 space preprocess paramet rang n n 4 assum maximum valu queri answer olog 2 n time see 5 6 detail variant techniqu given recent 7 case ray shoot amidst collect convex polyhedra remark nontrivi lower bound known 3dimension problem triangl well although bound known relat simplex rang search problem 12 use subprocedur solut mention bound close omegagamma n 14 thu might suggest known ray shoot algorithm triangl ir 3 close optim hand certain special case 3dimension ray shoot problem solv effici exampl object plane halfplan ray shoot amidst perform time n 1 space preprocess see 4 detail therefor interest identifi addit class object ray shoot also perform effici paper consid case sphere problem recent studi 5 also yet unpublish work 3 algorithm present 5 queri time n 1 14 os 1 space preprocess perform case triangl algorithm 3 achiev similar perform present improv solut case larg storag allow specif achiev queri time 3 space preprocess thu show sens case sphere essenti harder case plane might sound somewhat surpris given sphere complex object requir 4 real paramet specifi oppos 3 plane solut fairli generalth sphere may arbitrari radii may also intersect one anoth 1 throughout paper bound kind mean given arbitrarili small posit constant algorithm finetun perform satisfi bound multipl constant bound usual depend tend 1 0 techniqu adapt idea 3 roughli speak approach reduc rayshoot problem follow problem although certain part reduct simpler 3 given collect n arbitrari sphere 3space want preprocess answer follow queri effici given line sphere either intersect els contain point lie vertic point want determin whether intersect sphere reduct ray shoot problem problem fairli routin use mostli standard machineri solv main subproblem care manner 3 subproblem map onto 4dimension parametr space repres line 3space reduc problem point locat region 4space lie upper envelop certain lowdegre algebra surfac patch repres upper tangenc line one sphere almost year origin submiss paper shown aronov et al 2 point locat envelop perform fast polylogarithm time use 3 storag 3 random expect time give altern solut roughli asymptot perform solut howev algorithm 2 random wherea solut determinist b solut analyz exploit geometr structur problem much explicitli hope analysi find addit applic although approach geometr natur exploit special properti sphere thu much gener matter fact techniqu view explicit solut problem point locat envelop 4space special type surfac aris context ray shoot section 3 inde present gener techniqu ray shoot among gener convex object 3space exemplifi case axi parallel ellipsoid 2 algorithm overview use gener approach ray shoot due agarw matousek 4 approach base parametr search techniqu megiddo 27 reduc ray shoot problem segment empti problem name need preprocess sphere given segment e 3space quickli determin whether e intersect sphere shown 4 time actual ray shoot queri within logarithm factor queri time segment empti problem first describ preprocess scheme construct multilevel data structur level structur filter sphere satisfi differ geometr relationship respect queri segment sphere satisfi conjunct relationship must intersect queri segment see 26 detail discuss multilevel data structur kind level data structur consist e figur 1 illustr condit ii segment intersect detect treelik structur node correspond canon subset sphere root toplevel structur repres entir collect sphere first brief overview approach fairli easi show segment e intersect sphere one follow two condit hold one endpoint e lie insid lie outsid ii endpoint e lie outsid center lie insid slab sigma e bound two plane pass endpoint e perpendicular e line contain e intersect see figur 1 illustr consequ construct two data structur one test whether condit hold sphere test condit ii first data structur start describ first simpler data structur first level 1 use find sphere contain queri point root 1 associ entir set fix suffici larg constant paramet r construct 1rnet e log r sphere certain rang subset defin moment e 1rnet rang contain jsjr element must contain element see 23 detail e construct determinist techniqu matousek 25 simpli choos random sampl log r sphere next construct arrang ae sphere appli vertic decomposit techniqu 18 see also 14 arrang decompos 3space 3 cell constant descript complex interior cell cross sphere see 18 detail rang respect e 1rnet set sphere consist sphere intersect region shape cell vertic decomposit arrang sphere easi see result rang space socal finit vcdimens thu impli exist 1rnet e log r sphere refer reader 23 detail cell c decompos arrang creat child root 1 associ set sc sphere intersect c sinc e 1rnet none set sc contain nr sphere also store cell c set 0 c sphere complet contain c interior continu preprocess recurs child root associ set sc secondlevel structur built node first level set sphere associ root secondlevel structur node correspond cell c firstlevel decomposit set 0 c defin purpos secondlevel structur test whether given sphere contain queri point achiev use almost preprocess first level except defin set 0 c set sphere whose enclos ball disjoint cell c given queri segment first search p firstlevel structur obtain set sphere contain p disjoint union set 0 c set search q correspond secondlevel structur find node whose set 0 c nonempti stop conclud e intersect sphere otherwis repeat procedur search q firstlevel structur p secondlevel structur either detect intersect e sphere els conclud intersect type occur move search second data structur second data structur first two level second data structur similar first data structur purpos filter sphere contain endpoint queri segment e level construct much way except set 0 c level set sphere whose enclos ball disjoint correspond cell c search e two level describ search result collect canon set 0 c sphere whose disjoint union subset sphere whose enclos ball contain endpoint e next two level structur aim find sphere whose center lie slab sigma e defin condit ii level take set center relev sphere preprocess halfspac rang search 3 dimens use eg method 17 sinc sigma e intersect two halfspac h 1 h 2 search h 1 thirdlevel structur h 2 fourthlevel structur wind collect canon set sphere whose disjoint union set sphere satisfi first two part condit ii henc result set figur 2 plane v relationship sphere sphere need determin whether line contain queri segment e intersect sphere set fifth level structur also halfspac rang search structur center relev sphere search level two halfspac bound plane pass orthogon vertic plane v pass let denot halfspac lie let gamma denot halfspac lie let sphere whose center lie intersect v disc center lie either intersect els pass sens disjoint point lie vertic point see figur 2 illustr symmetr properti hold center lie descript data structur handl latter situat sinc handl former case fulli symmetr recap reduc problem follow subproblem given collect arbitrari sphere 3space canon set sphere output fifth level structur want preprocess answer follow queri effici given line sphere collect either intersect els point lie vertic want determin whether intersect given sphere breviti notat call given collect assum size n detect intersect line upper hull vertic planar cross section begin describ construct use techniqu point denot vertic plane pass line figur 3 two bridg connect disc two larger disc denot ae z coordin within v ae horizont coordin along line z vertic coordin let subset sphere let denot possibl empti 2dimension disc form intersect correspond sphere consid upper convex hull disc hull consist bridg name common tangent pair disc form edg hull circular arc portion boundari disc lie two adjac bridg see figur 3 suppos disc part upper convex hull disc within v consid set bridg connect disc whose radiu greater equal easili check two bridg one connect disc j follow posit aedirect one connect disc k preced see figur 3 claim trivial disc pairwis disjoint also hold allow intersect bridg b denot b halfplan lie line contain circular arc fl hull denot fl region erect vertic ray upward point fl take union ray see figur 4 quick overview approach fix suffici larg constant paramet r construct set e size log r serv 1rnet properti explain moment consid queri line vertic pass build data structur e abl determin quickli set bridg upper convex hull intersect disc sphere e v check intersect hull done intersect sphere otherwis find two bridg b b 0 whose slope nearest slope lie complet union region b circular arc b b 0 see figur 4 continu queri recurs set sphere intersect 3 region approach effici need region b intersect small number sphere nr sphere actual defin two rang space rang space defin term constant number sphere rang space finit vcdimens first rang space deal rang relat region second rang space deal rang relat region fl build 1rnet e 1 size log r first rang space anoth 1rnet e 2 size log r second rang space union 1rnet rang space size figur 4 line pass upper convex hull three region whose union contain planar map sigma describ techniqu detail build data structur given vertic plane repres point bridg circular arc upper convex hull disc within v found quickli sphere construct follow two planar map 1 2 coordin system 1 slope 2 intercept xyproject line 3space contibut upper convex hull uniqu larger disc follow along hull posit aedirect j label index j similarli contibut upper convex hull uniqu larger disc follow along hull neg aedirect k label gamma point index k otherwis label respect map altern label appli also case empti appear along upper hull face maxim connect region whose point label edg vertic map defin accordingli edg two adjac cell map label j k respect consist point disc follow preced along hull chang j k radiu j becom equal radiu get hull boundari anoth disc thu edg e map consist point upper hull disc plane bridg tangent three disc two adjac disc equal radiu disc degener singl point see detail analysi map show overal complex map roughli cubic r next construct vertic decomposit planar map erect vertic segment vertex point 2 vertic tangenc edg extend upward downward hit anoth edg map note set label point map provid complet inform structur upper convex hull intersect disc vertic plane let c cell say vertic decomposit map suppos ijk ik ijl figur 5 cell c label j 0 map label j 0 cell label 0 ignor process point c consid plane defin know contribut upper convex hull disc intersect sphere e plane uniqu next larger disc along hull posit aedirect j let b denot bridg connect two disc upper convex hull denot b halfplan v line contain b halfplan support disc j consid 3dimension region subset origin sphere intersect rc defin similar region rc cell c map sigma k note region rc union halfplan b bridg determin fix pair sphere e rang cell c one map sigma region constant complex actual suppos c label defin term 6 sphere three sphere anoth sphere k defin top edg c three sphere j anoth l defin bottom edg one sphere need defin left vertic edg c one sphere need defin right edg see figur 5 illustr follow c defin 6 sphere e moreov two sphere form bridg b belong collect 6 sphere rc also defin term 6 sphere thu region constant complex rang respect e 1 henc e 1rnet subset form sc defin region rc defin term 6 sphere outlin easi verifi result rang space finit vcdimens sinc construct none sphere e intersect region rc follow definit maximum cardin set sc cell c 2t map sigma nr construct set sc use bruteforc method take time sinc figur possibl xyproject portion project smooth boundari drawn nonsmooth boundari illustr fact compos two differ arc assum r constant creat cell c map child root node associ set sc sphere child continu construct data structur recurs child correspond set sphere howev second set children root obtain second decomposit scheme proceed describ spatial map ns defin second rang space respect e 2 henc e 1rnet let n denot 3dimension parametr space coordin give dual represent line xyplan ae measur distanc along point actual repres manytoon manner point xyplan name point oe along line reason 3dimension represent xyplan becom clearer later sphere form n spatial subdivis ns consist roughli ot 2 cell constant complex follow sphere j denot portion j lie let j denot xyproject obtain collect planar region intersect q xyproject either disc ellips convex region smooth boundari union circular arc ellipt arc see figur 6 figur 7 let k denot complement within q union map k follow set parametr space word k preimag k figur 7 arrang xyproject portion map oe n onto xyplan defin note point ae vertic line actual 3space pass point coordin ae meet sphere e highest intersect next decompos cell appli standard vertic decomposit ae vertic coordin 14 18 yield spatial observ paper cite easili seen complex number result cell ns proport number vertic visibl pair edg includ among edg also loci point vertic tangenc along boundari pair edg vertic visibl exist point vertic line n pass point intersect e e 0 segment point intersect lie fulli edg e ae line k tangent boundari k ae coordin vertex point tangenc along thu verticallyvis pair e e 0 edg line two point either vertex k point tangenc boundari k interv two point fulli contain k word number verticallyvis pair e e 0 proport f sum extend face f k c f complex f face face planar arrang ot circular ellipt arc pair arc intersect 4 point henc shown 20 nearlylinear maximum length sequenc 8 thu shown number cell constant complex subdivis ns ot 2 6 thu nearli cubic r recal next associ set sc sphere cell c ns point denot vertic line actual 3space pass point coordin ae line denot portion highest intersect point let rc denot union c set sc consist sphere intersect rc note rc region constant complex defin term constant number sphere e rang respect e 2 henc e 1rnet subset sc consist sphere intersect region form rc defin cell c n structur cell vertic decomposit construct easili seen result rang space finit vcdimens intuit due fact region rc constant descript complex see eg 29 detail next observ none sphere e intersect rc inde one sphere j intersect rc would exist point k vertic line point lie definit line xyplan point belong definit k ae belong k belong thu conclud maximum cardin set sc cell c ns sphere e nr construct set sc bruteforc method linear time r assum constant creat new set addit children root tree one child cell c subdivis ns associ node correspond set sc sphere continu construct data structur recurs child correspond set sphere conclud descript sixth last level data structur answer queri next describ queri process let e pq queri segment 3space alreadi describ search e first data structur search e first five level second data structur let canon set sphere output search first five level second structur let line contain e assum loss gener sphere els point lie vertic goal determin whether intersect sphere suppos repres two equat start root sixthlevel tree locat point 2t map root let c denot cell map contain whose label 0 note label cell provid complet descript upper convex hull intersect disc net sphere plane v 1 2 comput slope k bridg hull compar slope queri line within v easili verifi 1 one bridg say b slope simpli check whether queri line pass b case intersect sphere return posit answer queri otherwis pass line contain figur 8 origin sphere intersect v disc meet small region extens two bridg b recurs subtre correspond cell c defin b sphere sc meet gener though obtain two adjac bridg b b 0 tangent sphere e say b b 0 case origin sphere intersect either meet one two halfplan b meet small region r enclos two line contain b b 0 see figur 8 illustr let fl denot upper arc two point tangenc b b 0 clear sphere e intersect region consist point lie fl impli xyproject fl fl fulli contain singl connect compon region k defin thu follow set fl consist point ae coordin along point fl fulli contain fact fulli contain within singl cell subdivis ns vertic segment contain segment must fulli contain singl cell vertic decomposit thu continu search recurs two node associ cell correspond bridg b b 0 node correspond cell c ns contain arc fl conclud descript queri process complex analysi next analyz complex algorithm term space preprocess time queri time first five level second structur well two level first structur involv halfspac rang search structur point locat among sphere ir 3 level size structur set sphere exclud substructur deeper level om 3 0 inde halfspac rang search follow 17 point locat among sphere follow note maximum storag sm preprocess cost p structur sphere satisfi follow recurr appropri constant c 1 c 2 c 0 2 depend solut recurr easili seen om 3 0 constant proportion depend observ 26 easi verifi overal size preprocess cost multilevel data structur type consid deduc maximum size preprocess fix level particular show sixth level structur also requir om 3 storag preprocess set sphere follow overal storag preprocess cost full multilevel structur also 3 larger constant proportion see 26 detail thu turn consid cost sixth level structur involv upper convex hull structur intersect disc first claim total complex 2t planar map roughli 3 see ignor ad complex caus vertic segment form vertic decomposit map increas complex small constant factor fix sphere 2 e let c cell say label j edg e boundari c consist point either sphere j follow upper hull chang disappear upper hull size two intersect disc j becom equal first two case either shrink point disappear v line contain bridg connect j plane becom tangent third disc k also possibl j becom tangent first case k j j second case k preced vertex v c form intersect two boundari edg e e 0 suppos first e e 0 repres event tripl tangenc v must one follow three type ffl edg e e 0 repres chang sphere follow denot two correspond new sphere replac j next sphere k l sinc v lie e disc j k common tangent appear bridg upper convex hull similarli sinc v also lie e 0 true j l henc v four disc j k l common tangent bridg see figur 9a illustr ffl one edg say e repres chang sphere follow say k edg e 0 repres situat displac upper convex hull anoth sphere l preced along hull easili verifi case four correspond disc j k l must common tangent bridg v see figur 9b illustr ffl edg e e 0 repres situat displac upper convex hull two respect sphere k l preced along hull case four correspond disc j k l must common tangent bridg v see figur 9c illustr l l b c figur 9 three possibl configur occur vertex map thu shown vertex type point plane contain line tangent four intersect disc pass sphere similar argument impli also hold map sigma k note assum gener posit sphere vertex present eight 2t map twice four sphere defin effect label cell map similarli edg one map defin term three sphere thu appear map three sphere note two edg e e 0 repres situat size becom equal follow disc upper hull meet point v v also lie edg tripl tangenc easili seen next case consid thu vertic form intersect two edg e consist point upper hull intersect disc contain bridg tangent two disc j k e 0 consist point size becom equal size one disc say easili seen number vertic ot 3 entir collect map sigma vertex defin 3 sphere e tripl sphere give rise constant number vertic final consid case disc shrink point becom tangent adjac disc along upper hull easili verifi vertex v sigma occur defin term 3 sphere plu two sphere defin edg tripl tangenc v lie j anoth sphere becom tangent common tangent line j thu total number vertic map ot 3 thu need bound number point upper convex hull intersect disc sphere vertic plane v 1 2 bridg tangent four disc appli follow transform problem sphere intersect disc defin f valu 4 line tangent note f partial well defin graph algebra surfac patch low constant degre follow definit upper envelop function f repres locu line tangent upper convex hull vertic planar cross section sphere e moreov vertex upper envelop repres line tangent upper convex hull touch four correspond intersect disc critic line inde vertex envelop recent result 22 28 complex upper envelop n algebra surfac patch constant maximum degre dspace dgamma1 0 henc follow complex upper envelop log r function f 3 0 impli number vertic type consid 2t map sigma 3 thu also bound overal complex vertic decomposit map alreadi argu bound also domin overal complex spatial subdivis ns impli number children node sixthlevel tree structur 3 final complet analysi perform algorithm assum r suffici larg constant construct 1rnet e done time 25 construct 2t map sigma done constant time precis first need construct upper envelop function f shown 2 done time 3 0 featur envelop distribut among map sigma addit edg vertic map construct straightforward manner map vertic decompos within asymptot run time construct spatial subdivis ns also perform constant time fix sphere first comput top portion j sphere e project onto xyplan comput complement k union construct vertic ns examin everi pair vertic andor edg face k manner describ complet subdivis easi construct cell c map comput set sc sphere intersect associ region rc done time sinc region constant complex number region also constant precis canon set sc comput onr 3 time alreadi note maximum size set sc nr respect expect space complex preprocess time queri time sixth level data structur canon set n sphere follow reccur relat appropri constant c 1 c 2 c 0 2 depend solut recurr easili seen 3 0 constant proportion depend queri time q 6 n follow recurr factor 3 appear sinc search recurs 3 children node visit queri process solut recurr easili seen constant proportion depend combin sixth level structur preced five level appli observ 26 concern multilevel structur mention also take account overhead parametr search easili conclud follow main result theorem 21 given collect n arbitrari sphere 3space 0 one preprocess time 3 data structur size 3 support ray shoot queri among sphere time per queri extens section extend algorithm appli gener class object matter fact present gener approach ray shoot 3 dimens amidst collect n possibl intersect convex object constant descript com plexiti approach modular consist sever stage stage filter object satisfi certain geometr constraint respect queri ray queri ray intersect object satisfi conjunct constraint use properti actual ray shoot easi perform thu obtain ray shoot algorithm specif class object need provid appropri effici filter mechan class level separ mechan effici depend class question exemplifi two class object triangl ellipsoid consid case want obtain fast queri per queri will use larg storag follow gener approach 4 reduc ray shoot problem segment empti problem proceed follow stage 1 begin reduc segment empti problem line empti problem accomplish first two stage let e pq queri segment let line contain e first stage want partit object three categori object contain exactli one endpoint e interior object stop queri immedi posit answer comput subset object also two subset ii iii use techniqu use sphere sinc exploit special properti sphere main tool use exist vertic decomposit arrang object 3space slightli supercub number cell constant complex done eg collect object whose boundari defin term constant number algebra equal inequ constant maximum degre 14 thu gener stage perform use 3 storag preprocess olog n queri time ii object contain endpoint e interior sinc object assum convex ignor object e intersect iii object contain endpoint e object requir treatment pass subsequ stage 2 let object third type respect queri segment e suppos e intersect sinc p lie outsid exist plane p avoid clear q lie side plane matter fact hold plane pass p avoid symmetr properti hold q convers exist pair plane easili seen e intersect intersect thu stage want sift object exist pair plane properti way perhap alway effici suppos object 2 defin polynomi inequ qx lie outsid 1 p plane p p tangent surfac plane contain fulli one side equat halfspac bound p contain coordin p sinc q also lie halfspac obtain constraint coordin q symmetr condit hold q name inequ linear coeffici q thu repres 2 point ir k k number distinct monomi appear partial deriv correspond polynomi q test present condit amount two halfspac rang search queri ir k figur 10 disc appear along upper convex hull cours method ideal k larg nevertheless fairli gener techniqu work well sphere inde equat sphere 2 two constraint becom interestingli enough ident test condit center lie insid slab sigma e use previou algorithm 3 stage reduc problem detect intersect queri line object precis canon subset next need reduc problem detect intersect planar upper convex hull cross section object vertic plane pass sphere wish partit two subset none object first subset intersect v cross section lie fulli none object second subset intersect v cross section lie fulli shown step perform sphere use appropri halfspac rang search set center sphere 4 last stage need decid whether queri line pass upper convex hull cross section object canon subset vertic pass howev solut stage fairli gener adapt appli object sphere inde close inspect techniqu show place use specif geometr properti sphere definit map sigma map record sphere adjac sphere along upper hull provid intersect sphere v larger intersect v done order overcom technic difficulti sphere follow preced along hull need uniqu sinc one intersect disc may appear along hull see figur 10 way overcom difficulti assum object pairwis disjoint case cross section vertic plane pairwis disjoint convex region say one region wider anoth region j length project xaxi larger j defin map sigma complet analog definit case sphere proviso bridg connect cross section cross section j record appropri map narrow two region easili verifi one bridg connect wider j follow upper hull one bridg connect wider region preced j along hull henc map well defin proceed exactli manner sphere object intersect need devis altern method record bridg upper hull welldefin manner assum inde possibl remaind algorithm appli gener class object obviou simpl modif need requir object constant descript complex suffic show overal complex map sigma vertic impli stage algorithm perform set n object 3 preprocess storag queri time interest complex stage algorithm case sphere gener stage appli compar effici gener class object combin stage multilevel data structur sphere preprocess time storag overal structur roughli domin expens stage alreadi mention illustr next illustr variou stage algorithm perform two specif class object triangl ellipsoid 31 case triangl stage algorithm easi perform case triangl first stage void assum nondegener posit queri segment second stage suffic find set triangl two endpoint queri segment separ plane contain triangl easi use halfspac rang search 3 dimens fourth stage appli full gener note technic difficulti concern rel size intersect object line segment case easi handl leav detail reader expens stage case triangl third one want find triangl pass resp queri line intersect triangl delta find edg suffic determin whether queri line pass resp line contain turn done map problem halfspac rangesearch problem plucker 5space done use 4 preprocess storag see 15 detail thu third stage bottleneck obtain effici ray shoot method triangl approach seem yield case better solut alreadi known 5 32 case ellipsoid next consid case object ellipsoid whose axe parallel coordin axe ellipsoid 2 repres equat posit note first stage appli gener set includ case ellipsoid second stage call test inequ homogen linear inequ six paramet perform project 5space use 5 storag preprocess logarithm queri time remark sinc stage bottleneck case ellipsoid use observ make stage effici ellipsoid satisfi addit properti exampl ellipsoid revolut vertic axi inequ becom homogen linear inequ project 4space done olog n time use 4 storag preprocess third stage carri follow suppos queri line repres equat take ellipsoid project onto xyplan obtain ellips 1 intersect project lead equat midpoint two intersect point exist thu satisfi 2 suffic compar z crosssect lie fulli z crosssect lie fulli yield classif ellipsoid seek requir comparison equival test sign express linear homogen express six coeffici thu test stage reduc halfspac rang search project 5space moreov sinc look solut use larg storag small queri time problem becom dual set point locat among arrang hyperplan 5space sinc queri point lie 4dimension lowdegre algebra surfac parametr 4 paramet exploit zone theorem aronov et al 9 solv problem use 4 storag preprocess logarithm queri time see 5 detail fourth stage applic gener set technic difficulti concern multipl bridg crosssect overcom pairwis disjoint ellipsoid describ henc put togeth obtain theorem 31 ray shoot amidst n axisparallel pairwis disjoint ellipsoid 3space perform time use 5 preprocess time storag reduc 4 ellipsoid revolut paper develop new improv techniqu ray shoot amidst sphere 3 dimens method requir 3 preprocess time storag perform ray shoot queri time 0 improv previou solut roughli order magnitud term preprocess storag cost also shown techniqu extend obtain gener algorithm ray shoot amidst convex object constant descript complex 3space demonstr extens case triangl result algorithm wors known solut case axisparallel ellipsoid obtain algorithm appear new yield fast queri use 5 preprocess storag weak algorithm seem yield good tradeoff storag queri time contrast less effici solut 4 tradeoff cours combin solut 4 obtain tradeoff reader familiar techniqu easili check result algorithm yield queri time 98 38 use os 1 storag preprocess would interest pose open problem design algorithm rayshoot amidst sphere take close linear storag answer ray shoot queri time close 23 anoth set open problem appli gener techniqu variou specif class object attempt find solut stage effici possibl particular algorithm improv case ellipsoid requir 4 storag final lower bound known ray shoot problem solut case sphere close optim worst case r comput envelop four dimens applic comput 22 rang search semialgebra set applic new space partit techniqu sharp upper lower bound length gener davenportschinzel sequenc zone surfac hyperplan arrang good splitter applic ray shoot algorithmica 12 lower bound complex polytop rang search singli exponenti stratif scheme real semialgebra varieti applic line space combinator algorithm visibl intersect problem plane geometri combinatori complex bound arrang curv sphere determin separ preprocess polyhedra unifi approach arrang curv plane topolog relat queri arrang segment new bound lower envelop three dimens applic visibl terrain pedestrian approach ray shoot shoot ray approxim optim geometr divideandconqu rang search effici hierarch cut appli parallel comput algorithm design serial algo rithm almost tight upper bound lower envelop higher dimens tr ctr bori aronov mark de berg chri gray ray shoot intersect search amidst fat convex polyhedra 3space proceed twentysecond annual symposium comput geometri june 0507 2006 sedona arizona usa micha sharir hayim shaul ray shoot amid ball farthest point line rang empti search proceed sixteenth annual acmsiam symposium discret algorithm januari 2325 2005 vancouv british columbia micha sharir hayim shaul ray shoot stone throw nearlinear storag comput geometri theori applic v30 n3 p239252 march 2005 pankaj k agarw bori aronov vladlen koltun micha sharir line avoid unit ball three dimens proceed twentieth annual symposium comput geometri june 0811 2004 brooklyn new york usa vladlen koltun almost tight upper bound vertic decomposit four dimens journal acm jacm v51 n5 p699730 septemb 2004 pankaj k agarw micha sharir effici algorithm geometr optim acm comput survey csur v30 n4 p412458 dec 1998