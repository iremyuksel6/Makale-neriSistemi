deepest regress method deepest regress dr method linear regress introduc p j rousseeuw hubert 1999 j amer stati assoc 94 388402 dr method defin fit largest regress depth rel data paper show dr robust method breakdown valu converg almost sure 13 dimens construct approxim algorithm fast comput dr two dimens distribut regress depth deriv test true unknown paramet linear regress model moreov construct simultan confid region base bootstrap estim also use maxim regress depth construct test linear versu convexityconcav extend regress depth deepest regress gener model appli dr polynomi regress show deepest polynomi regress breakdown valu 13 final dr appli michaelismenten model enzym kinet resolv longstand ambigu b introduct consid dataset z ng ae ir p linear regress want fit hyperplan form denot xpart data point z x residu z n rel fit denot r measur qualiti fit rousseeuw hubert 16 introduc notion regress depth research assist fwo belgium postdoctor fellow fwo belgium definit 1 regress depth candid fit 2 ir p rel dataset z n ae ir p given rdepth z n minimum unit vector regress depth fit ae ir p rel dataset z n ae ir p thu smallest number observ need pass tilt becom vertic therefor alway 0 rdepth z n n special case xvalu z n univari dataset 2 ir rdepth z n rank rank outsid inward p 1 regress depth measur balanc dataset z n linear fit determin easili verifi regress depth scale invari regress invari affin invari accord definit rousseeuw leroy 17 page 116 base notion regress depth rousseeuw hubert 16 introduc deepest regress estim dr robust linear regress section 2 give definit dr basic properti show dr robust method breakdown valu converg almost sure 13 dimens good data come larg semiparametr model section 3 propos fast approxim algorithm medsweep comput dr higher dimens p 3 base distribut regress depth function infer paramet deriv section 4 test confid region true unknown paramet construct also propos test linear versu convex dataset z n base maxim depth z n applic deepest regress specif model given section 5 first consid polynomi regress updat definit regress depth comput deepest regress accordingli show deepest polynomi regress alway breakdown valu least 13 also appli deepest regress michaelismenten model provid solut problem ambigu result obtain two commonli use parametr 2 definit properti deepest regress definit 2 p dimens deepest regress estim drz n defin fit maxim rdepth z n rdepth z n see rousseeuw hubert 16 sinc regress depth fit increas slightli tilt fit pass p observ pass observ suffic consid fit p data point definit 2 sever fit maxim regress depth take averag note distribut assumpt made defin deepest regress estim dataset dr regress scale affin equivari estim univari dataset deepest regress median dr thu gener univari median linear regress popul case let random pdimension variabl distribut h ir p rdepth h defin smallest amount probabl mass need pass tilt way vertic deepest regress drh fit maxim depth natur set deepest regress larg semiparametr model h function form parametr error distribut nonparametr formal h consist distribut h ir p satisfi follow condit h strictli posit densiti exist med h j h note model allow skew error distribut heteroscedast van aelst rousseeuw 22 shown dr fisherconsist estim medyjx good data come natur semiparametr model h asymptot distribut deepest regress obtain portnoy 9 simpl regress bai 2 multipl regress figur 1 show educ spend data obtain dasl librari httplibstatcmuedudasl dataset list expenditur per pupil versu averag salari paid teacher region us fit 1 regress depth 2 deepest regress drz n averag salari expenditur drz n 2 figur 1 educ spend data observ dimens line depth 2 deepest regress drz n averag fit depth 23 017 gamma051 averag fit depth 23 figur 1 illustr line high regress depth fit data better line low depth regress depth thu measur qualiti fit motiv interest deepest regress drz n defin finitesampl breakdown valu n estim n smallest fraction contamin ad dataset z n n explod see also donoho gasko 6 let us consid actual dataset z n denot z nm dataset form ad observ z n breakdown valu defin znm breakdown valu deepest regress alway posit low origin data peculiar rouseeuw hubert 16 fortun turn origin data drawn model breakdown valu converg almost sure 13 dimens p theorem 1 let z sampl distribut h ir p p gammagammagamma proof given appendix theorem 1 say deepest regress break least 67 data gener semiparametr model h remain data ie 33 point may anyth result hold dimens dr thu robust leverag point well vertic outlier moreov theorem 1 illustr deepest regress differ l 1 regress defin l 1 z n j note l 1 anoth gener univari median regress zero breakdown valu due vulner leverag point simpl regress van aelst rousseeuw 22 deriv influenc function dr ellipt distribut comput correspond sensit function influenc function dr slope intercept piecewis smooth bound mean outlier affect dr much correspond sensit function show alreadi hold small sampl size deepest regress also inherit monoton equivari properti univari median hold l 1 estim least squar least trim squar rousseeuw 14 sestim rousseeuw yohai 20 definit regress depth depend x sign residu allow monoton transform respons assum function model g strictli monoton link function typic exampl g includ logarithm exponenti squar root squar reciproc transform regress depth nonlinear fit 4 defin 1 r due monoton equivari deepest regress fit obtain follow first put determin deepest linear regress transform data backtransform deepest linear regress yield deepest nonlinear regress fit origin data comput dimens regress depth comput log n time algorithm describ rousseeuw hubert 16 comput regress depth fit construct exact algorithm time complex pgamma1 log n dataset larg n andor p also give approxim algorithm comput regress depth fit omp 3 mn log n time number p gamma 1subset xspace use algorithm algorithm exact delta subset consid naiv exact algorithm deepest regress comput regress depth observ keep one maxim depth yield total time complex log n slow larg n andor high p even use approxim algorithm rousseeuw struyf 18 comput depth fit time complex remain high simpl regresss collabor work sever specialist comput geometri yield exact algorithm complex log 2 n ie littl linear time van kreveld et al 24 speed comput higher dimens construct fast algorithm medsweep approxim deepest regress medsweep algorithm base regress origin regress origin rousseeuw hubert 16 defin regress depth denot rdepth 0 requir definit 1 therefor rdepth 0 fit ae ir p rel dataset z n ae ir p1 smallest number observ need pass tilt way becom vertic rousseeuw hubert 16 shown special case regress line origin p 1 deepest regress dr dataset z given slope med observ x use estim minimax bia martin yohai zamar 11 comput time propos sweep method base estim 5 approxim deepest regress higher dimens suppos dataset z ng arrang n observ row n theta p matrix x ndimension column vector step 1 first step construct sweep variabl x start obtain x j 1 success sweep x origin variabl x j gener sweep x k x l k l comput med med x il med ik j collect indic denomin differ zero replac x l sweep next variabl x new x l thu obtain sweep variabl step 2 second step success sweep x put med med med ik j replac origin k thu obtain proce 78 iter converg reach iter step coeffici fi updat maxim number iter set 100 experi shown even converg slow 100 iter step alreadi close optimum iter proce take median intercept step 3 backtransform obtain regress coeffici correspond origin variabl obtain fit slightli adjust pass p observ know improv depth fit start make smallest absolut residu zero direct tilt fit direct pass observ chang sign residu yield fit step 4 last step approxim depth final fit let u direct correspond variabl x comput minimum instead unit vector right hand side express 1 sinc comput median take time first step algorithm need op 2 n time second step take ohpn time h number iter adjust step 3 also take op 2 n time comput approxim depth last step done opn log n time time complex medsweep algorithm thu becom op log n low measur perform algorithm carri follow simul differ valu p n gener ng standard gaussian distribut sampl comput deepest regress medsweep algorithm measur total time need 10 000 estim n p also comput bia intercept averag 10 000 intercept bia vector slope measur ave ave also give mean squar error vector slope given true valu mean squar error intercept given 1 tabl 1 list bia mean squar error vector slope bia mean squar error intercept given tabl 2 note bia mean squar error slope vector intercept low decreas increas n tabl 1 2 also see mean squar error seem increas p tabl 1 bia 9 mean squar error 10 dr slope vector obtain gener standard gaussian sampl n p dr fit obtain medsweep algorithm result bia multipli 10 gamma4 result mse 10 gamma3 50 bia 1801 1827 2853 2247 2142 mse 5455 5232 5223 5254 5865 100 bia 756 841 1116 898 1268 mse 2459 2532 2599 2615 2717 300 bia 811 598 629 739 1089 mse 811 827 826 841 842 500 bia 044 168 291 910 549 mse 493 489 502 493 497 1000 bia 634 358 677 354 398 mse 247 251 246 246 250 tabl 3 list averag time medsweep algorithm need comput dr sun sparcstat 20514 see algorithm fast illustr medsweep algorithm gener 50 point 5 dimens accord model e come standard gaussian distribut dr fit obtain medsweep 21 algorithm need 14 iter till converg second exampl gener 50 point accord model iter medsweep algorithm yield fit approxim depth 21 note case coeffici obtain algorithm approxim true paramet model well medsweep algorithm avail websit httpwinwwwuiaacbeustati use explain tabl 2 bia mean squar error dr intercept obtain gener 10 000 standard gaussian sampl n p dr fit obtain medsweep algorithm result bia multipli 10 gamma4 result mse 10 gamma3 50 bia 304 4870 1438 1323 1964 mse 100 bia 575 332 1221 992 170 mse 1578 1601 1692 1677 1814 300 bia 271 799 237 349 454 mse 525 531 522 523 547 500 bia 135 553 433 426 239 mse 309 315 321 321 318 1000 bia 376 340 510 075 001 mse 156 156 155 158 162 infer 41 test paramet simpl regress semiparametr model assumpt condit h state error e independ p possibl comput f n k n fx actual dataset z n invari properti e iid say standard gaussian thu comput f n k simul 11 tie among x even comput f n k explicitli formula 44 daniel 1954 yield tabl 3 comput time second medsweep algorithm sampl size n p dimens time averag 10 000 sampl 1000 k n gamma 12 f n term probabl binomi distribut bn 12 stem number e particular sign increas n approxim bn 12 gaussian distribut due central limit theorem 12 easili extend larg n distribut regress depth allow us test one sever regress coeffici test combin null hypothesi correspond pvalu equal f n k comput 12 consid dataset figur 2 speci anim van den bergh 23 plot show logarithm weight newborn versu logarithm weight mother deepest regress line depth 19 dataset yield pvalu f 41 highli signific test signific slope easi comput rdepth horizont line pass observ anim dataset maxim rdepth0 equal 5 therefor correspond pvalu p rdepth h 0 reject pvalu 000002 interpret way pvalu associ r 2 ftest ls regress analog test consid line origin observ yield pvalu f 41 also highli signific gener test hypothesi h comput maxim regress depth line pass observ logweight mother logweight newborn dr figur 2 logarithm weight newborn versu logarithm weight mother speci anim dr line depth 19 exampl test hypothesi h anim data ie hypothesi weight newborn proport weight mother comput correspond pvalu f 41 signific 5 level 1 level test gener easili higher dimens situat tie among x longer use exact formula 12 restrict bivari case without tie fx g therefor case comput f n k simul 11 let us consid stock return dataset benderli zwick 3 shown figur 3 28 observ dimens regressor output growth inflat percentag respons real return stock deepest regress obtain medsweep algorithm equal depth 11 test null hypothesi slope zero would done r 2 ls regress comput maxim rdepth0 0 3 3 ie dataset comput exact rdepth 28 horizont plane fast algorithm rousseeuw struyf 18 obtain valu 6 simul yield correspond pvalu f 28 signific test signific intercept comput depth plane two observ ori gin exampl yield max correspond pvalu f 28 11 1 signific 42 confid region order construct confid region unknown true paramet vector use bootstrap method start dataset z ng 2 ir p construct bootstrap sampl randomli draw n observ replac bootstrap sampl z j comput deepest regress note usual outli estim set natur sinc bootstrap sampl contain disproport mani outlier therefor dont construct confid ellipsoid base classic mean covari matrix f use robust minimum covari determin estim mcd propos rousseeuw 1415 mcd look h n2 observ empir covari matrix smallest possibl determin center dataset defin averag h point covari matrix sigma dataset certain multipl covari matrix obtain confid ellipsoid level ff comput mcd set bootstrap estim ffme confid ellipsoid e 1gammaff given statist robust distanc robust distanc rousseeuw leroy 17 bootstrap estim given confid ellipsoid e 1gammaff fit space also deriv correspond regress confid region defin theorem 2 region r 1gammaff equal set let us consid educ spend data figur 1 figur 4a show deepest regress estim 1000 bootstrap sampl drawn replac origin data use fast mcd algorithm rousseeuw van driessen 19 find center figur 4a 019 gamma095 correspond well dr fit origin data confid region take 95 toler ellips e 095 base mcd center scatter matrix yield correspond confid region r 095 shown figur 4b note intersect confid region vertic line 95 probabl interv observ x 0 interv span fit valu 95 confid region exampl confid region higher dimens shown figur 3 show 3dimension stock return dataset deepest regress plane obtain medsweep algorithm 95 confid region shown figur 3 base sampl 43 test linear simpl regress observ bivari dataset z n lie exactli straight line highest possibl valu hand z n lie exactli strictli convex strictli concav curv n3 lowest rousseeuw hubert 16 theorem 2 therefor seen measur linear dataset z n note lower bound depend amount curvatur lie exactli curv howev soon nois ie nearli alway rel size error scale curvatur come play null hypothesi assum dataset z n follow linear model independ error e distribut zero median determin correspond pvalu gener dr output growth inflat stock return figur 3 stock return dataset deepest regress plane upper lower surfac 95 confid region r 095 base sampl tabl 4 windmil data maxim rdepth k correspond pvalu pk obtain simul ng xvalu dataset z n standard gaussian e j comput maxim regress depth dataset z j valu k approxim pvalu pmaxrdepth kjh 0 exampl let us consid windmil dataset hand et al 8 consist 25 measur wind veloc correspond direct current output shown figur 5 pvalu tabl 4 obtain 17 actual reject linear 5 level b averag salari expenditur dr r 095 figur 4 dr estim 1 000 bootstrap sampl educ spend data 95 confid ellips e 095 b plot data dr line 95 confid region r 095 fit valu 5 specif model 51 polynomi regress consid dataset z ng ae ir 2 polynomi regress model want fit data call degre polynomi residu z n rel fit denot could consid multipl regress problem regressor determin depth fit definit 1 know joint distribut degener ie densiti mani properti deepest regress theorem 1 breakdown valu would hold case fact set possibl x form socal moment curv ir k inher onedimension better way defin depth polynomi fit denot rdepth k updat definit regress depth simpl regress x also univari polynomi fit comput residu r defin regress depth rdepth k note definit depend x valu sign residu definit depth defin deepest polynomi degre k 2 denot dr k z n theorem 3 dataset z ng 2 ir 2 distinct x deepest polynomi regress degre k breakdown valu theorem 3 show definit depth polynomi fit given 18 deepest polynomi regress posit breakdown valu approxim 13 robust vertic outlier well leverag point section 43 reject linear windmil data therefor consid model quadrat compon data ie figur 5 show windmil data deepest quadrat fit depth 12 wind veloc direct current output figur 5 windmil data deepest quadrat fit regress depth 12 52 michaelismenten model field enzym kinet steadyst kinet great major enzym catalyz reaction studi adequ describ hyperbol relationship concentr substrat steadyst veloc v relationship express michaelismenten equat constant v max maximum veloc km micha constant michaelismenten equat linear rewrit follow three way km gammakm known scatchard equat scatchard 21 doubl reciproc equat lineweav burk 10 woolf equat haldan 7 three relat 21 22 23 use estim constant v max km gener three relat yield differ estim constant v max km error term also transform nonlinear way cressi keightley 5 compar three linear michaelismenten relat context hormonereceptor assay conclud wellbehav data woolf equat 23 work best data contain outlier doubl reciproc equat 22 robust regress give better result theorem 4 show appli deepest regress woolf equat 23 yield estim v max km deepest regress appli doubl reciproc equat 22 resolv ambigu theorem 4 let z ng denot dr fit doubl reciproc equat drf 1 dr fit woolf equat satisfi case obtain v exampl assay hormon receptor michaelismenten equat describ relationship amount b hormon bound receptor amount f hormon bound receptor assay use eg determin cancer treatment method see cressi keightley 5 equat 20 becom paramet interest concentr b max bind site dissoci constant kd hormonereceptor interact figur 6a show woolf plot data estrogen receptor assay obtain cressi keightley 4 note dataset clearli contain one outlier plot ad deepest regress line figur 6b also show doubl reciproc plot deepest regress line drf 1 case obtain estim valu compar least squar estim obtain woolf equat base data except outlier hand least squar appli full data give base woolf 50 100 150 200 250 300246f dr b dr figur woolf plot cressi keightli data deepest regress line least squar fit doubl reciproc plot data deepest regress line least squar equat base doubl reciproc equat estim quit differ least squar case estim kd highli influenc outli observ kd come high may lead wrong conclus eg determin cancer treatment method appendix proof theorem 1 prove theorem 1 need follow lemma lemma 1 x gener posit f rdepth z n pg bound proof j ae ng denot fit pass p observ sinc x gener posit fit j nonvert j therefor convf j j ae stand convex hull 2 lemma 2 dataset z n 2 ir p x gener posit ie x lie p gamma 2dimension affin subspac ir pgamma1 deepest regress breakdown valu proof lemma 1 know f rdepth z n pg bound therefor break estim must add least observ rdepthdrz nm z n hold rdepthdrz n z n dnp amenta et al 1 obtain follow ngammap 2 1 final hold lemma 3 z n ae z nm proof sinc z n ae z nm hold rdepth z n rdepth z nm thu hold rdepth z n max lemma 4 condit theorem 1 gammagammagamma proof let us consid dual space ie pdimension space possibl fit dualiz transform hyperplan h point observ z map set dz pass z dz hyperplan h given dual space regress depth fit correspond minim number hyperplan h intersect halflin unit vector u dual space thu correspond affin hyperplan v xspace direct tilt vertic unit vector u therefor defin wedgeshap region u primal space form tilt around v direct u fit becom vertic denot h n empir distribut observ data z n defin metric j z n sampl h hold gammagammagamma 0 follow gener glivenkocantelli theorem formul pollard 13 theorem 14 prove pollard 13 lemma 18 fact u construct take finit number union intersect halfspac defin empir version pi n clear 1 moreov jpi n henc gammagammagamma final hold latter inequ use theorem 7 rousseeuw hubert 16 valid sinc z n almost sure gener posit take limit 27 use 26 finish proof 2 proof theorem 1 first show lim inf 1almost sure lemma 1 know f rdepth z n pg bound z n ae ir p sampl h therefor break estim must add least observ impli first inequ due lemma 3 thu final appli lemma 4 conclud lim inf next prove lim sup 1almost sure sinc regress depth affin invari may assum none jjx jj dataset zero denot hyperplan equat two compon fi ff correspond slope intercept fix two strictli posit real number fi 0 ff 0 consid point hyperplan pass data point hold 1 assum none jjx jj equal 0 alway find point x would unbound dataset z nm obtain enlarg dataset z n point equal know deepest fit drz nm must pass least p differ observ z nm denot j candid deepest fit j pass clear rdepth j z nm hand j pass p data point z n rdepth j z nm seen follow first consid dataset z n1 consist n origin observ one copi point theorem 7 rousseeuw hubert 16 follow theta n1p alway exist unit vector x n number observ pass tilt j around u v definit 1 plu number observ pass tilt j around gammau gammav equal fit j pass exactli observ therefor suppos number observ pass tilt j around u v n1p replac u v gammau gammav note residu r pass first suppos residu r strictli posit data gener posit therefor alway find valu 0 hold x number observ pass tilt j around u tilt around u v final ad replic chang valu therefor rdepth j z nm residu r strictli neg replac v similar way obtain result reason show deepest fit must pass origin data point sinc shown fit arbitrarili larg slope intercept hold gammagammagamma thu lim sup 28 29 final conclud 3 2 proof theorem 2 consid x 2 ir pgamma1 prove upper lower bound express 16 valu dual plot hyperplan tangent ellipsoid first consid special case yield unit sphere tangent hyperplan arbitrari point sphere given therefor hyperplan becom tangent hyperplan sphere togeth yield give lower bound upper bound correspond express 16 case consid gener case ellipsoid diagon matrix eigenvalu matrix eigenvector sigma transform previou case transform hyperplan transform cx 1p 12 becom tangent hyperplan yield lower bound upper bound express 16 2 proof theorem 3 definit rdepth k 18 follow data set ng distinct x lemma 1 f rdepth k z n bound bivari linear fit correspond polynomi fit hold deepest regress line dr 1 rdepthdr 1 rousseeuw hubert 16 follow deepest polynomi regress dr k degre k rdepth k dr must add least observ rdepth k dr k z nm z n k break estim obtain follow n gamma 3k2 yield proof theorem 4 show hold everi follow v switch xvalu 1 revers order therefor accord definit 1 depth 2 r regress depth center point asymptot distribut maxim depth estim regress multivari locat underli structur direct linear plot applic analysi hormonereceptor interact analys data hormonereceptor assay breakdown properti locat estim base halfspac depth project outlying graphic method enzym chemistri handbook small data set appli statist scienc iii nonparametr statist relat topic determin enzym dissoci constant depth deep point calculu converg stochast process least median squar regress mathemat statist applic vol b new york wileyintersci comput locat depth regress depth higher dimens fast algorithm minimum covari determin estim robust nonlinear time seri analysi attract protein small molecul ion robust deepest regress proceed 15th symposium comput geometri tr robust regress outlier detect effici algorithm maximum regress depth fast algorithm minimum covari determin estim optim algorithm hyperplan depth plane robust deepest regress comput locat depth regress depth higher dimens ctr r wellmann katina ch h mller calcul simplici depth estim polynomi regress applic comput statist data analysi v51 n10 p50255040 june 2007 christin h mller depth estim test base likelihood principl applic regress journal multivari analysi v95 n1 p153181 juli 2005