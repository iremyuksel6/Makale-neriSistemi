practic construct modifi hamiltonian one fruit way analyz effect discret error numer solut system differenti equat examin modifi equat equat exactli satisfi approxim discret solut actual exist gener rather defin asymptot expans power discret paramet nonetheless expans suitabl truncat result modifi equat solut remark close discret solut case hamiltonian system ordinari differenti equat modifi equat also hamiltonian integr symplect evid exist hamiltonian particular calcul obtain calcul modifi hamiltonian monitor well conserv also energi drift caus numer instabl better reveal evalu modifi hamiltonian calcul would normal complic highli depend detail method even differ use approxim deriv rel simpl procedur present nearli independ intern structur integr obtain highli accur estim modifi hamiltonian bonu method construct modifi hamiltonian exactli conserv numer solut case quadrat hamiltonian b introduct one fruit way analyz effect discret error numer solut differenti equat examin modifi equat equat exactli satisfi approxim discret solut actual exist gener rather defin asymptot expans power discret paramet nonetheless expans suitabl truncat result modifi equat solut remark close discret solut 9 case hamiltonian system work r skeel support part nsf grant dms9971830 dbi9974555 nih grant p41rr05969 complet visit mathemat depart univers california san diego z ordinari differenti equat modifi equat also hamiltonian integr symplect exist modifi shadow 4 hamiltonian indic valid statist estim calcul long time integr chaotic hamiltonian system 18 addit modifi hamiltonian sensit indic origin hamiltonian drift energi caus instabl evid exist hamiltonian particular calcul obtain calcul modifi hamiltonian monitor well conserv calcul would normal complic highli depend detail method even differ use approxim higher deriv present rel simpl procedur nearli independ intern structur integr obtain highli accur estim modifi hamiltonian consid step step numer integr x evolv approxim solut x n xnh system ordinari differenti equat fx discret solut exist modifi equat defin asymptot expans formal numer solut x nh modifi righthandsid function f h defin uniqu postul asymptot expans f power h substitut equat numer solut expand power h equat coeffici 26 6 22 asymptot expans gener converg except reason integr appli linear differenti equat hamiltonian system form hamiltonian hx modifi equat integr phi h appli system hamiltonian ie f modifi hamiltonian h h x integr symplect 23 20 integr symplect phi hx xj phi hx x j j theoret 2 8 18 empir evid small error long time x h solut suitabl truncat hamiltonian h h follow assum h h hamiltonian neglect small error plot total energi function time numer integr leapfrogstorm verlet appli molecular dynam simul get graph like fig 3 observ larg fluctuat origin hamiltonian trajectori move hypersurfac constant modifi hamiltonian small drift jump energi would obscur fluctuat plot modifi hamiltonian might reveal exampl plot modifi hamiltonian fig 4 show clear rise energi alreadi 400step simul indic plot suitabl modifi hamiltonian make easier test integr algorithm instabl program bug detail numer test given section 2 continu worth emphas concern paper stabil monitoringnot monitor enhanc accuraci 4 15 goal construct approxim modifi hamiltonian conveni assembl quantiti forc energi alreadi avail numer integr consid special separ hamiltonian hq system form brute forc approach would determin asymptot expans h h quantiti avail make approxim form suitabl linear combin latter match asymptot expans one could deriv follow modifi hamiltonian leapfrog method superscript n denot evalu q n center differ oper defin ffi w averag oper defin w defin term q n p n leapfrog method easier eleg construct present sec 35 techniqu develop split method like similar construct also possibl symplect implicit rungekutta method idea add new posit conjug momentum variabl get extend hamiltonian h h homogen order 2 hamiltonian jy h thu problem reduc form approxim use numer solut extend hamiltonian system plausibl construct might use theoret due exist robust approxim techniqu eq 1 h 2 contain h 2 term need achiev 2nd order accuraci present truncat h 2k design exactli conserv energi numer solut h quadrat see sec 41 51 use properti typic applic includ molecular dynam domin harmon motion exist modifi hamiltonian exactli conserv quadrat hamiltonian note 17 eq 47b search similar method properti central result paper quadrat hamiltonian modifi hamiltonian h h actual exist h larg h 2k 6 h h simpl deriv h h onedimension case given 22 also note hamiltonian h 2k detect numer instabl case quadrat hamiltonian h modifi hamiltonian h 2k x defin eq 15 8 14 7 comput plot function time numer solut gener leapfrog method given energi time fs 8th order 6th order 4th order energi 2nd order figur 1 energi variou truncat modifi hamiltonian decalanin 9 unmodifi hamiltonian classic molecular dynam test done molecular dynam program written second author compat namd 11 16 limit featur facilit algorithm test first coupl experi demonstr qualiti modifi hamiltonian test problem 66atom peptid decalanin vacuum 1 forc field paramet charmm 22 protein 13 14 without cutoff nonbond forc figur 1 show plot hamiltonian 2nd 4th 6th 8th order modifi hamiltonian approxim vs time 100000 fs femtosecond step size energi sampl everi 8th step level graph top 8th order truncat one bare beneath 6th order one 4th order greatli fluctuat graph energi undul one well 2nd order truncat note well asymptot theori hold higher order truncationson could obtain flat plot simpli smooth origin hamiltonian figur 2 expand vertic scale show fluctuat 8th 6th 4th order truncat modifi hamiltonian explan order concern initi drop energi symplect method preserv volum phase space less phase space volum lower energi infer first part trajectori simpli second half unusu fluctuat word initi condit atyp ie properli equilibr respect origin hamiltonian particularli well reveal plot 2nd order truncat remain experi demonstr abil modifi hamiltonian detect instabil iti test problem set 125 water molecul harmon restrain 10 aradiu sphere water base tip3p model 25 without cutoff flexibl incorpor ad bond stretch angl bend harmon term cf ref 12 energi time fs 8th order 6th order 4th order figur 2 closer look higher order truncat decalanin energi time fs energi figur 3 energi flexibl water step size 25 fs figur 3 show plot energi vs time 1 000 fs step size energi sampl everi step note larg fluctuat make difficult determin whether energi drift figur 4 show plot 6th 8th order modifi hamiltonian step size energi time fs 8th order 6th order figur 4 6th 8th order truncat step size 25 fs fs upward energi drift obviou 2nd 4th order approxim shown neither flat normal mode analysi system 10 show 250 fastest frequenc period rang 98102 fs use formula 22 p 131 show 25 fs step size 30 effect period discret leapfrog dynam remark 8th order approxim flattest even larg step size figur 5 show plot 6th 8th order modifi hamiltonian step size appar upward drift energi theoret instabl due 41 reson 21 occur leapfrog method h delta angular frequenc 2 rang 2223 fs flexibl water 3 augment integr assum one step size h given method appli system hamiltonian h composit exact hflow hamiltonian system hamiltonian h 1 h 2 hl h l x assum suffici smooth domain contain infinit time trajectori exampl 1 leapfrog method separ hamiltonian system hq 2 rowland method 19 special separ hamiltonian system use h 1 3 doubl timestep 7 24 use 4 u fast q h 2 fast q energi time fs 8th order 6th order figur 5 6th 8th order truncat step size 215 fs 4 molli 5 doubl timestep except substitut u slow aq u slow q aq local tempor averag q vibrat motion defin homogen extens hamiltonian h quadrat h homogen order 2 extend hamiltonian yield augment system initi condit system simplifi puq extend hamiltonian simplifi augment system remark associ ff q rather fi practic import want get valu p calcul follow proposit show valu extend hamiltonian calcul know solut hy homogen extens given hamiltonian hx let yt solut extend hamiltonian system ff initi 1 j matrix augment dimens proof differenti eq 4 respect oe give h homogen extens h solut h includ h cours goal calcul origin hamiltonian know formula solut rather calcul modifi hamiltonian know solut grid point formula therefor must augment integr solut grid point homogen extens modifi hamiltonian integr composit hamiltonian flow accomplish use homogen extens constitu hamiltonian specif defin augment method h composit exact flow system hamiltonian hl h l q ff lemma 1 commut method psi h defin modifi hamiltonian h h q p modifi hamiltonian origin method phi h ie follow diagram commut homogen extens discret discret homogen extens proof modifi hamiltonian h h method psi h express asymptot expans use bakercampbellhausdorf formula 20 formula combin hamiltonian use oper scalar multipl addit poisson bracket fh x jn x thu suffici show three commut oper form homogen extens show last homogen extens poisson bracket exactli extend poisson bracket ff remark aim discret extend hamiltonian commut properti hold extens techniqu implicit rungekutta method would requir augment method commut hold follow corollari allow valu hamiltonian approxim known valu h grid point proposit 2 let x h h solut modifi hamiltonian h h tive jy h proof similar prop 1 2 4 use full step valu section present construct h 2k even valu k let h solut modifi extend hamiltonian system initi condit valu h degre k polynomi interpol valu larg k may prefer instead use trigonometr interpol suitabl modifi 3 prop 2 1 jh z jh2 gammaj h22 interpol k error bracket denot 1th divid differ note jh z jh2 gammaj h22 jetdt gammajh z jh2 gammaj h22 h z jh2 gammaj h22 jetdt oh 2k2 z jh2 gammaj h2 second equat obtain integr part flt def jy k1 express expans form suitabl linear combin valu h kj expect one get h h first k2 gamma 1 lead error term elimin linear combin h note valu contain lead term oh k use elimin error term case 4th order accur formula case gammah z 2h gamma2h henc given formula h 8 h 4 term valu h grid point let j jth center differ h center differ oper defin ffi averag oper defin 4th degre interpol divid differ form henc 6 3 ss 6 4 ss have2 power averag averag gamma2 2 yield 90 14 gamma 107 therefor 2nd degre interpol follow eq 5 implement formula might calcul h 2k consecut valu n term quantiti n defin term center differ n obtain x n 1st higher differ fi n need exampl 1 make concret calcul h 4 x leapfrog method given eq 2 leapfrog method advanc one step suppress n superscript whenc needed7 7 therefor 41 case quadrat hamiltonian follow result impli case hx quadrat numer solut exactli conserv approxim modifi hamiltonian linear function 1 linear combin numer solut valu proposit 3 assum phi h composit flow system quadrat hamiltonian psi h construct proposit 1 quantiti ij psi sum taken finit set pair integ exactli conserv method psi h proof map psi h composit flow system homogen quadrat hamiltonian ij sy ij psi y5 use intermedi valu section present construct h 2k odd valu k numer integr one defin sensibl midstep valu use instead full step valu get estim accur oh 2k assum psi gammah2 psi h2 composit exact flow homogen extend hamiltonian remark necessari midstep valu approxim yt midpoint psi h time symmetr psi gamma1 need psi psi 1h psi 2h composit exact flow homogen extend hamiltonian exampl leapfrog method separ half step gammah2 psi h2 psi h2 follow remark leapfrog method estim interv ngamma 1 2 kh n 1 k odd actual use valu energi forc shorter interv n gamma 1k n midstep valu valu midpoint function z h use construct hamiltonian proposit 4 let z h z h jz h proof real defin psi shflow h symplect z h hamiltonian system hamiltonian also h composit flow hamiltonian 2nd order homogen henc homogen order 2 z h degre k polynomi interpol valu z h let jh z jh2 gammaj h22 interpol k error h z k1 similar get z jh2 gammaj h2 z h jz k1 h express expans expect suitabl linear combin differ valu h kj yield h h first k lead error term elimin linear combin h note seem possibl combin valu obtain full step half step increas order accuraci error expans two kind averag term common cancel 2nd order formula z h2 gammah2 z 3h2 gamma3h2 e let b j jth center differ z h use midstep valu 3rd degre interpol henc power averag averag gamma 3 yield therefor 1st degre interpol follow eq 13 exampl 2 calcul h 2 x leapfrog method given eq 1 jy n suppress n superscript e therefor exampl 3 calcul h 6 x leapfrog method given eq 3 eq 16 hffif eq 11b ffi 2 q f given eq 12 therefor 51 case quadrat hamiltonian proposit 5 assum phi h composit flow system quadrat hamiltoni an psi h construct proposit 1 psi h2 assum begin section quantiti ij sum taken finit set pair integ exactli conserv method psi h proof composit flow system homogen quadrat hamiltonian map ij acknowledg author grate assist justin wozniak preliminari test second order truncat henonheil hamiltonian decalanin r httpwww hamiltonian interpol near ident symplect map applic symplect integr algorithm residu acceler measur accuraci molecular dynam simul shadow mass relationship veloc momentum symplect numer integr scope method modifi equat gener verlet algorithm effici molecular dynam simul longrang interact lifespan backward error analysi numer integr asymptot expans backward analysi numer int grator longer time step molecular dynam namd2 greater scalabl parallel molecular dynam molecular model principl applic common molecular dynam algorithm revisit accuraci optim time step stormerleapfrog analysi accuraci langevin molecular dynam algorithm backward error analysi numer integr numer algorithm hamiltonian system numer hamiltonian problem nonlinear reson artifact molecular dynam simul integr scheme molecular dynam relat applic geometr numer method perturb integr system revers multipl time scale molecular dynam modifi equat approach stabil accuraci analysi finit differ method tr ctr robert engl robert skeel matthew dree monitor energi drift shadow hamiltonian journal comput physic v206 n2 p432452 1 juli 2005 jess izaguirr scott hampton shadow hybrid mont carlo effici propag phase space macromolecul journal comput physic v200 n2 p581604 novemb 2004