demonstr scalabl molecular dynam applic petaflop comput ibm blue gene project endeavor develop cellular architectur comput million concurr thread execut one major challeng project demonstr applic success exploit massiv amount parallel start sequenti version well known molecular dynam code develop new applic exploit multipl level parallel blue gene cellular architectur perform analyt simul studi behavior applic execut larg number thread result demonstr class applic execut effici larg cellular machin b introduct sever teraflopscal machin deploy variou industri government academ site high perform comput commun start look next big step petaflopscal machin least two differ approach advoc develop first gener machin one hand project like htmt 10 propos use thousand high speed processor hun dred gigahertz hand project like ibm blue gene 2 advanc idea use larg number million modest speed processor hundr megahertz two approach seen extrem wide spectrum choic particularli interest analyz feasibl latter blue gene style approach massiv parallel machin built today rel straightforward way adopt cellular architectur basic buildingblock contain processor memori interconnect support prefer implement singl silicon chip replic mani time follow regular pattern combin logic memori microelectron process soon deliv chip hundr million transistor sever research group advanc processorinmemori design reli technol ogi use build block cellular machin exampl includ illinoi flexram 5 12 berkeley project nevertheless sheer size build cellular machin deliv petaflop 10 15 floatingpoint oper per second quit challeng enterpris justifi demonstr applic execut effici machin paper report result analyt simulationbas studi behavior comput molecular dynam applic analyz behavior applic cellular architectur million concurr thread ex ecut design ibm blue gene project one exampl class applic inde exploit multipl level massiv parallel offer petaflopscal cellular machin discuss 11 parallel applic deriv serial version molecular dynam code develop univers pennsylvania 6 applic rewritten new partit techniqu take advantag multipl level parallel develop analyt model perform applic compar direct simul measur quantit result molecular dynam code demonstr class applic success exploit petaflop scale cellular machin term absolut perform simul indic achiev 014 petaflop 014 10 15 floatingpoint oper per second 087 petaop 087 oper per second sustain perform term speed molecular dynam comput integr equat motion typic problem 32000 atom rate one timestep everi 375 problem use sequenti version code solv power 3 workstat peak perform 800 mflop 140 second per time step thu machin 1250000 time total peak floatingpoint perform uniprocessor achiev speedup 368000 rest paper organ follow section 2 give brief overview cellular machin consid level necessari understand molecular dynam applic parallel effici execut section 3 introduc parallel molecular dynam algorithm use also present analyt perform model execut algorithm cellular architectur section 4 describ simul experiment infrastructur use infrastructur deriv experiment perform result present togeth result analyt model section 5 section 6 discuss chang blue gene architectur motiv work final section 7 present conclus 2 petaflop cellular machin interest investig machin like ibm blue gene would perform class molecular dynam applica tion fundament premis architectur blue gene perform obtain exploit massiv amount parallel rather fast execut particular thread control premis signific technolog architectur impact first individu processor kept simpl facilit design larg scale replic singl silicon chip instead spend transistor watt enhanc singlethread perform real estat power budget use add processor architectur also character memori centric enough thread execut provid order fulli consum memori bandwidth toler latenc individu loadstor oper singl silicon chip consist mani replic unit natur fault toler ant replic approach also improv yield fabrica tion even larg chip use thu reduc cost moreov allow machin grace degrad continu oper individu unit fail build block cellular architectur node node implement singl silicon chip contain memori process element interconnect element node view singlechip sharedmemori multiprocessor de sign node contain 16 mb share memori 256 instruct unit instruct unit associ one thread exe cution give 256 simultan thread execut one node execut instruct strictli order group 8 thread share one data cach one floatingpoint unit data cach configur blue gene 16 kb 8way set associ call group thread floatingpoint unit cach proce sor simplif necessari keep instruct unit simpl result larg number die floatingpoint unit 32 node pipelin complet multipli add everi cycl 500 mhz clock cycl translat 1 gflop peak perform per floatingpoint unit gflop peak perform per node node also six channel commun direct interconnect six node 16bit wide channel oper 500 mhz commun bandwidth 1 gb per channel direct achiev node commun stream data channel larger system built interconnect multipl node regular pattern system design use six commun channel node interconnect threedimension mesh configur node connect two neighbor along axi x z node face along edg mesh fewer connect use mesh topolog regular built without addit hardwar directli connect commun channel node commun channel neighbor threedimension mesh node build system 32768 node sinc node attain peak comput rate gflop entir system deliv peak comput rate approxim 1 petaflop see figur 1 applic run petaflop machin must exploit inter intranod parallel first applic decompos multipl task task assign particular node discuss previous task commun messag second task decompos multipl thread thread oper subset problem assign task thread task interact sharedmemori 3 molecular dynam algorith goal molecular dynam algorithm determin state molecular system evolv time given molecular system set n atom state atom time describ mass charg q posit x veloc v evolut system govern equat motion subject initi condit x atom f forc act atom x 0 initi posit veloc respect atom notat repres set posit atom time equat 1 integr numer particular choic time step posit atom fx j tg time use comput forc f time forc use comput acceler time veloc acceler time final use comput new posit veloc time respect particular molecular dynam approach chose system simul shape form box replic indefinit three dimen sion give rise period system illustr two dimens figur 2 r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r r figur 2 molecular system simul period structur principl need consid interact among infinit number atom thread 500 mhz 32 chip 4 board 256 rack 32 processor system rack processor 1 petaflop gigaflop board chip figur 1 blue gene cellular architectur hierarchi entir system consist 32768 node 1 million processor connect threedimension mesh 31 molecular dynam algorithm forc appli atom time vector sum pairwis interact atom atom system pairwis interact take sever form describ 1 divid two main group intramolecular forc intermolecular forc intramolecular forc occur adjac closebi atom molecul model use three differ type intramolecular forc bond bend torsion intermolecular forc occur pair atom take two form lennardjon van der wall forc electrostat coulomb forc lennardjon forc decay rapidli distanc therefor given atom enough consid lennardjon interact atom insid sphere center atom radiu sphere call cutoff radiu note sphere atom may includ atom neighbor replic box comput electrostat forc one take account period natur molecular system one commonli use approach ewald summat 4 method comput electrostat forc divid two fast converg sum real space part reciproc space also call kspace part f r real space part f r interact comput atom atom insid sphere center atom lennardjon forc although cutoff radiu could dif ferent pair atom whose distanc within cutoff commonli store link list also known verlet list gener list usual perform everi sever timestep atom move slowli frequenc gener optim problem sinc comput cost amort sever timestep discuss gener verlet list paper comput reciproc space first set k reciproc space vector comput k 2 k comput k fourier transform point charg distribut structur factor particular valu k n number atom q x charg posit atom respect k term also call kfactor paper contribut reciproc space part electrostat forc act atom comput summat valu k also call kforc paper exact formula function f k import structur paral leliz precis express specifi 1 note atom need perform summat k 2 k valu k depend posit atom system 311 internod parallel effici parallel molecular dynam algorithm requir variou forc distribut evenli among comput node molecular dynam applic use extens decomposit intermolecular forc describ 8 new parallel formul kspace decomposit although cellular machin threedimension mesh node view p 3 node logic twodimension mesh c column r row particular use c two threedimension mesh embed use describ later consid twodimension logic mesh partit set atom two way target partit r set ft0 1g size l jaj r sourc partit c set fs0 l jaj c replic target set across row twodimension everi node row contain copi atom target set ti similarli replic sourc set across column everi node column j contain copi atom sourc set sj configur node nij row column j logic mesh assign sourc set sj target set ti shown figur 3 k0 k1 k0 k1 k0 k1 figur 3 forc decomposit adopt molecular dynam applicationeach target set ti replic along node row sourc set sj reciproc space vector set kj replic along node column j use decomposit describ node nij comput local commun lennardjon real space electrostat forc exert atom sourc set sj atom target set ti previous mention interact atom closer certain cutoff radiu actual comput word let f lj lm lennardjon forc atom l let f r lm real part electrostat forc atom l node nij comput f lj lm f r distanc atom l less cutoff radiu lennardjon electrostat forc respect node nij also comput partial vector sum lennardjon real part electrostat forc act upon atom target set f lj 8m2 j f lj f r 8m2 j f r comput reciproc space electrostat forc set k reciproc space vector partit c set g size l jkj c replic set kj along node column j logic mesh also shown figur 3 actual comput perform three phase kfactor phase everi node nij comput contribut atom ti k k 2 kj node nij comput 8l2t comput sum contribut along column twodimension mesh constitut second phase sum comput allreduc oper everi node obtain valu sum contribut reduct everi node nij valu k k number item kfactor reduct comput along column j equal size reciproc space vector set kj third final phase also call kforc phase k valu use node comput contribut describ equat 4 atom set ti node nij comput intermolecular forc comput perform reduct forc along row twodimension logic mesh node nij row obtain valu f r f lj result everi node row obtain result forc atom ti note number item forc vector reduct comput along row equal size number atom target set ti comput intramolecular forc bond bend torsion replic everi column logic mesh note everi column entir set atom form union set partit atom among ti set adjac atom molecul assign adjac target set commun requir comput intramolecular forc updat posit atom molecul split adjac row twodimension logic mesh comput forc atom ti comput new posit veloc final updat posit atom sj atom ti perform broadcast oper along column twodimension mesh broadcast phase node nij send posit atom ti sj node column j correspondingli receiv posit atom sj ti sj node column interact atom close togeth need evalu often interact atom far apart reason use multitimestep algorithm similar respa 13 14 reduc frequenc intermolecular forc comput illustr concept figur 4 comput time step divid sequenc short intermedi long step precis configur comput time step consist ten compon four short step follow intermedi step follow four short step follow long step short step intramolecular bond bend forc comput intermedi step intramolecular forc bond bend torsion comput togeth lennardjon real space electrostat forc within short cutoff radiu comput intermolecular forc requir reduct along row final long step intra intermolecular forc includ kspace electrostat comput long step requir reduct along column kfactor along row intermolecular forc within step comput thread node wait barrier indic b figur 4 posit atom receiv node updat thread comput forc requir step parallel synchron updat share vector forc use critic region thread wait second barrier forc step comput updat posit veloc atom figur 4 also present summari perform number discuss section 5 focu embed twodimension logic mesh threedimension mesh consid twodimension mesh 128 row 256 column column logic mesh 128 node map onto one physic plane threedimension cellular machin shown figur 5 note 8 logic column embed one physic plane broadcast posit reduct kfactor reciproc space column logic mesh interfer broadcast reduct logic column use x dimens threedimension mesh reduct forc along row twodimension mesh perform adjac plane threedimension physic mesh use disjoint wire z dimens node logic row assign plane also need perform reduct one wire need row along x dimens 312 intranod parallel intranod parallel molecular dynam code exploit multithread simplic set forc bond bend torsion lennardjon electrostat comput node static partit among thread node n forc forc certain type comput n thread comput thread node thread comput l n forc thread forc movement atom partit way natom atom target set node thread respons move l n atom thread atom forc act atom target set node comput ad forc accumul atom lennardjon real electrostat forc comput act one target atom bond bend torsion intramolecular forc comput howev act 2 3 4 atom target set respec tive updat forc accumul perform thread thread need acquir lock accumula tor therefor lennardjon real electrostat forc comput thread acquir one lock bond bend torsion comput thread need acquir 2 3 4 lock respect parallel kspace comput differ perform four step insid node start first comput contribut atom target set kfactor assign node comput static schedul thread perform l n atom thread comput evalu kfactor sum contribut atom done binari reduct tree third step complet comput kfactor within node prepar reduct across column final column reduct perform kforc atom comput comput static schedul thread comput l n atom thread forc form 32 perform model molecular dynam comput base previou discuss molecular dynam algo rithm section deriv analyt perform model behavior algorithm cellular architectur like ibm blue gene section 5 compar result perform model direct measur simul also use model evalu impact certain architectur featur let ts execut time short step let execut time intermedi step let l execut time long step total execut time one comput time step shown figur 4 comput number short step one comput time step decompos time step two part comput time expos commun time sil expos commun time part commun time overlap comput 321 comput time model let n bond n bend total number bond bend spectiv need comput node short step let n thread number comput thread avail node let bond bend time take comput one bond one bend respect let tmove time need updat atom posit veloc let natom number target atom assign node final let barrier n time take perform barrier oper n thread time short step express p shown equat 12 figur 6 let n torsion number torsion need comput node intermedi step let n ljshort n esshort number lennardjon real part electrostat forc within short cutoff respect need comput node intermedi step let lj es time take comput one lennardjon one real part electrostat forc respect time intermedi step express shown equat 13 figur 6 let n ljlong n eslong number lennardjon real part electrostat forc within long cutoff respect need comput node long step let n kfactor number k term node size k set node let eta n kfactor time take comput one atom contribut k term node let redux n kfactor broadcast posit put adjac bond bend move atom 4 time put adjac bond bend move atom 4 time broadcast posit move atom move atom byte transmit bond bend real elect short cutoff lennardjon short cutoff torsion forc reduct bend bond lennardjon long cutoff long cutoff real elect forc reduct kspace forc torsion kfactor reduc kfactor 250 comput thread comput instthread comput instthread 19000 long step short step short step repeat done intermedi step figur 4 flowchart molecular dynam comput complet long time step comput perform molecular dynam application4128 z threedimension physic mesh0000000000000000000000000000000011111111111111111111111111111111110000000000000000111111111111111111 2d logic mesh 128 row x 256 col vertic broadcast horizont reduct figur 5 map column logic mesh physic machin left commun pattern vertic broadcast posit horizont reduct forc right time take add two set contribut k term let kfactor n kfactor time take final comput k term node final let kforc time take comput kforc one atom time long step express l shown equat 14 figur 6 322 commun time model domin commun oper molecular dynam code forc reduct along row kfactor reduct posit broadcast along column twodimension logic mesh reduct broadcast implement cellular machin organ node within logic row logic column accord span binari tree shown figur 7 figur root tree mark black circl refer figur 5 7 b note 128node column logic mesh consist four adjac strand 32node physic mesh refer figur 5 7 c note 256node row logic mesh consist eight strand 32node physic mesh strand 4 node apart commun atom posit evalu intramolecular forc make small contribut total commun alway perform neighbor node along column logic mesh want comput time four commun oper oper vector element let posit time broadcast posit along column kfactor redux time reduc kfactor along column forc time reduc forc along row put time put new posit neighbor row time oper decompos latenc time transfer time latenc time time complet oper first element vector transfer time rate element process time thread thread natom thread thread thread natom thread tmove thread thread thread thread thread natom thread tmove thread n ljlong thread n eslong thread natom thread thread natom thread kforc n kfactor figur analyt express comput time short intermedi long step r node r node 4 node r node r node 8 node column fanin tree b column fanout tree c row fanin tree row fanout tree figur 7 fanin fanout tree reduct broadcast oper along column b reduct oper along row c number element vector equat form latenc posit kfactor latenc kfactor redux latenc latenc n sourc n kfactor number sourc atom kfactor assign column respect n target number target atom assign row n put number put neighbor node perform triplet complex time transfer one triplet forc posit one complex number kfactor respect posit forc byte long three doubleprecis floatingpoint number kfactor long two doubleprecis floatingpoint hop c number hop node node column root fanin fanout tree intracolumn oper let hop time go hop node cellular machin interconnect latenc posit hop c hop 19 factor two account round trip let n add c number addit need perform reduc item origin node column get root fanin tree let add time add one item latenc kfactor hop c hop add c add 20 analysi forc reduct along row similar let hop r number hop node row root fanin fanout tree intrarow oper let n add r number addit need perform reduc item origin node row get root fanin tree latenc hop r hop add r add 21 deriv worst case estim expos commun time si case overlap comput commun upper bound expos commun time factor 8 come 8 short step within comput time step 4 simul environ complement analyt model describ execut molecular dynam applic instructionlevel simul blue gene machin proprietari instruct set typic risc loadstor architectur three regist instruct model applic code c compil gcc version 2952 compil properli modifi gener code instruct set thread creation manag insid node perform applic level use call pthreadcompat librari internod commun accomplish proprietari commun librari implement put onesid commun broadcast reduc oper node machin run resid system kernel execut supervisor privileg purpos kernel twofold first protect machin resourc thread memori commun channel accident corrupt misbehav applic program resourc use reliabl error detect debug perform monitor second isol applic librari detail underli hardwar commun protocol minim impact evolutionari chang area actual applic run user privileg invok kernel servic inputoutput internod commun instructionlevel simul architectur accur execut kernel applic code model featur node commun node instanc pro cess simul model one node multipl instanc use simul system multipl node intern multipl simul instanc commun mpi result execut applic instructionlevel simul produc detail trace instruct execut also produc histogram instruct mix one trace one histogram produc everi node simul instructionlevel simul time inform therefor directli produc perform estim instead use trace produc simul feed two perform tool one tool cach simul event visual provid measur cach behavior tool trace analyz detect depend conflict instruct trace produc estim actual machin cycl necessari execut code trace analyz execut instruct model resourc usag instruct trace analyz instruct predefin execut latenc instruct compet share resourc thread node execut instruct program order thu resourc instruct avail thread tri issu instruct issu delay thread stall resourc becom avail memori oper trace analyz use probabilist cach model 90 hit rate valu valid run trace cach simul perform paramet simul architectur shown tabl 1 paramet earli estim may chang lowlevel logic design complet tabl interpret follow delay instruct decompos two part execut cycl latenc cycl execut unit kept busi number execut cycl issu anoth instruct result avail number executionlat cycl resourc util instruct latenc period exampl float point add execut 1 cycl latenc 5 cycl mean fpu busi 1 cycl execut instruct instruct may alreadi pipelin next cycl execut anoth instruct howev result addit avail 6 15 cycl anoth exampl integ divis take 33 execut cycl 0 latenc cycl mean occupi exclus integ unit 33 cycl result avail immedi execut period complet thread issu instruct everi cycl unless stall depend result previou instruct memori oper latenc oper depend deep memori hierarchi go fetch result memori distribut within chip access local memori faster access memori across chip memori share thread within chip address other local memori latenc oper depend physic locat memori memori access determin local global base effect address howev blue gene processor use scrambl global access may local memori model scrambl probabili tical 1p probabl global access local memori p number processor chip configur simul petaflop machin easi task straightforward simul entir machin would requir 32768 simul process one simul node howev molecular dynam applic structur allow us simul complet one node entir machin extrapol perform result machin present previous molecular dynam code run twodimension logic mesh node node simul atom interact two set atom target set sourc set particular decomposit method use commun node occur intrarow intracolumn thu simul one row provid inform behavior row logic twodimension mesh similarli simul one column provid inform behavior column logic twodimension mesh reduc number node need simul 383 256 one row j plu 128 one column minu one instanc node j illustr figur 8 still need provid correct valu incom messag boundari subsystem simul modifi commun layer fake commun except node row j column balanc work distribut node j perform set oper similar perform node system therefor perform node j extrapol tabl 1 estim instruct perform paramet blue gene isa type instruct character number cycl keep execut unit busi column execut latenc complet column latenc instruct type execut latenc branch integ multipli divid 33 0 float point add multipli convers 1 5 float point divid squar root 54 0 float point prefetch memori oper cach hit 1 2 memori oper share local 1 20 memori oper share remot 1 27 oper 1 0 obtain perform entir system use instruct level simul simul node column row j collect analyz trace inform node j011001111 j nodes256 node chip simul inform detail figur 8 strategi perform estim simul one row column logic mesh 5 experiment result test case code assembl molecular system human carbon anhydras hca enzym 9 play import role diseas glaucoma hca enzym solvat 9000 water molecul total 32000 atom system use molecular dynam code run simul describ comput evolut system start experiment coordin taken nmr structur carbon anhydras describ 9 molecular system prepar take crystallograph configur hca enzym protein data bank identif label 1am6 httpwwwrcsborgpdb solvat box water size 70 charmm22 3 forc field use treat interact atom proteinwat system newtonian dynam gener standard condit room temperatur 1 atm pressur use standard verlet algorithm solver 15 tabl 2 list valu variou paramet use analyt perform model section 3 tabl show number forc comput per comput time step serial version code also show number forc comput singl node particip parallel execut 256 128 mesh scale factor column show ratio two valu tabl 3 list number instruct requir forc comput forc requir use lock discuss section 312 number instruct acquir releas lock shown tabl 3 number instruct treebas multithread barrier function number thread particip barrier shown figur 9 data tabl 2 3 figur 9 provid inform need estim perform analyt perform model section 3 tabl 4a summar valu variou primit commun paramet obtain intrins characterist architectur applic tabl 4b contain result valu deriv paramet obtain equat 30050150250number comput thread instruct cycl barrier time figur 9 cost barrier function number thread particip tabl 5 summar total instruct count per node variou thread configur obtain architectur simul configur differ number thread alloc perform comput number floatingpoint unit alloc comput l n threadm addit thread includ number alloc perform commun system servic tabl list total number load store branch integ instruct logic instruct system call floatingpoint instruct execut thread node case floatingpoint instruct detail number multiplyadd fmad multipli tabl 2 number forc comput node one time step simul hca protein 14 long real cutoff 7 short cutoff show result singl node execut 256 column 128 row logic mesh singl node one node 256 128 mesh item item scale factor target atom 31747 249 128 electrostat forc real part long cutoff 36157720 1297 27878 lennardjon forc long cutoff 36241834 1313 27602 electrostat forc real part short cutoff 4430701 127 34887 lennardjon forc short cutoff 4440206 127 34962 kfactor 8139 23 354 sine cosin kspace 12652290 494 25612 bond 22592 259 87 bend 16753 456 37 torsion 11835 748 tabl 3 measur paramet comput variou forc paramet instruct descript forc lock total tmove 50 50 comput new posit veloc atom comput bond forc 2 atom bend 250 90 340 comput bend forc 3 atom comput torsion forc 4 atom comput lennardjon forc comput realpart electrostat forc eta 2000 2000 comput one atom contribut kfactor redux 500 500 comput one reduct step kfactor kfactor 1000 1000 final stage comput kfactor kforc 3000 3000 comput fourierspac electrostat forc subtract instruct instruct perform two floatingpoint oper total number floatingpoint oper shown row flop total number instruct row total note expect number floatingpoint instruct chang significantli number thread hand number load branch increas significantli number thread thread spend time wait barrier lock tabl 6 identifi major sourc overhead note addit instruct execut multithread belong two oper barrier lock addit lock instruct repres content lock increas larger number thread increas number instruct spent barrier two sourc first number thread increas total time barrier increas illustr figur 9 addit larger number thread typic make load balanc difficult faster thread wait time barrier slower thread total overhead row tabl 6 equal differ number instruct multithread singlethread execut effect overal perform achiev barrier overhead andor lock overhead avoid discuss section 6 tabl 7 summar addit perform result configur differ number comput thread test configur list number instructionsthread short step intermedi step long step see figur 4 show number instructionsthread kfactor k forc compon long step also show total number instructionsthread comput cycl per time step determin architectur simul trace analyz cpi clock per instruct comput ratio two last number cpf clock per floatingpoint instruct measur averag number clock per floatingpoint instruct perspect floatingpoint unit comput cycl dn thread 8e n float total number floatingpoint instruct n cycl number comput cycl dn thread 8e number floatingpoint unit util 8 thread share one floatingpoint unit number machin cycl internod commun tabl 7 obtain equat 25 independ number thread total number cycl per time step obtain ad comput commun cycl comput multithread speedup ratio total cycl singl multithread execut final effici comput ratio speedup rel singlethread exe cution number thread low cpihigh cpf number one thread indic good thread unit util low floatingpoint unit util configur eight activ thread per floatingpoint unit perform roughli two time work per floatingpoint unit singl thread tabl 4 summari commun cost paramet primit paramet paramet valu descript sourc 125 number sourc atom assign column target 249 number target atom assign row kfactor 23 number kfactor assign column number put nearest neighbor machin cycl transfer 24 byte interconnect machin cycl transfer 16 byte interconnect hop 6 machin cycl cross one node cellular interconnect machin cycl complet one floatingpoint addit hop c 20 maximum number hop insid column add c 28 maximum number add insid column hop r 48 maximum number hop insid row add r 38 maximum number add insid row b deriv paramet paramet machin cycl descript latenc posit 240 latenc broadcast first posit latenc kfactor redux 464 latenc reduc first kfactor latenc forc 880 latenc reduc first forc latenc put latenc memori nearest neighbor posit 1740 total time broadcast posit kfactor redux 648 total time reduc kfactor forc 3838 total time reduc forc put 186 total time put posit nearest neighbor l 6256 commun time long step 186 commun time short step upper bound expos commun time per time step curv figur 10 11 indic number instruc tionsthread deriv analyt perform model execut differ compon molecular dynam ap plicat marker figur indic measur made simul valu plot accumul valu compon ad previou compon therefor top curv figur 10 also repres total number instruct cycl comput time step top curv figur 11 repres total number instruct cycl kspace comput figur 10 show contribut short intermedi reciproc space kspace final long rang real part electrostat lennardjon forc total comput time step figur 11 show contribut kfactor kforc compon total kspace comput good fit analysi simul indic analyt model inde captur behavior applic time chart bottom figur 4 summar comput perform molecular dynam applic first two time line show number instructionsthread 250thread execut entir comput time step take approxim 39000 instructionsthread short step take 1700 instruct intermedi step take 5000 instruct long step take 19000 instruct next time line summar commun behavior obtain simul show total number byte transmit simul node along axe physic threedimension mesh note much data transmit along x z axe along axi result particular embed twodimension logic mesh threedimension physic mesh bottom line show total number cycl estim time one iter step result cach simul shown figur 12 plot averag cach miss rate differ cach size set associ valu configur 250 comput thread result show probabilist model 90 data cach hit rate valid 4 8way setassoci cach size 8 kb associ 16 kb larger cach result section indic molecular dynam simul 32000 atom run full petaflop cellular machin good perform possibl exploit 32768 node 250 thread run full comput time step figur 4 375 187000 cycl 2 nscycl code run 087 petaop 014 petaflop howev state result present approxim simul detail cycl level simul feasibl slow perform simul lack detail logic design machin rather trace analyz use estim inform depth variou pipelin use queu model congest key share resourc expect chang softwar algorithm mathemat tabl 5 instruct count sampl node j instruct class 1 thread 50 thread 100 thread 150 thread 180 thread 200 thread 250 thread load 932617 1380652 2013751 2367753 3000583 3253284 3277406 store 314545 350290 386740 423190 445060 459640 495778 branch 392998 810678 1412827 1735879 2350139 2590460 2584124 integ op 779227 815525 852525 889452 911562 926302 962535 logic op 910489 1006189 1080147 1164083 1208168 1247712 1334017 system 46835 51686 56636 61586 64556 66536 71486 floatingpoint op 1206253 1211545 1216945 1222345 1225585 1227745 1232891 fmad 288217 288805 289405 290005 290365 290605 291169 flop 1537291 1543171 1549171 1555171 1558771 1561171 1566881 total 4582964 5626565 7019571 7864288 9205653 9771679 9958237 instruct 26 22 17 15 13 13 12 tabl instruct sampl node j function 1 thread 50 thread 100 thread 150 thread 180 thread 200 thread 250 thread barrier lock 52874 190280 274926 347642 363564 391848 446194 barrierlock 52874 715610 1755842 2251036 3391990 3800344 3657628 total overhead 0 1043601 2436607 3281324 4622689 5188715 5375273 50 100 150 200 250 3001030507090110number comput thread instruct cycl thousand node perform 32000 atom problem 256x128 mesh short intermedi kspace long total figur 10 perform compon molecular dynam code solid line repres valu analyt model marker measur simul method significantli improv perform code simul hand also expect mani surpris challeng proceed simul actual system 6 architectur impact sinc complet work describ paper blue gene architectur evolv chang motiv silicon real estat constraint exampl number thread per floatingpoint unit reduc 8 4 total 128 threadsnod memori also reduc 16 mb 8 mbnode import chang howev motiv 100 150 200 250 30039152127number comput thread instruct cycl thousand node perform 32000 atom problem 256x128 mesh kfactor kforc kspace total figur 11 perform compon kspace computa tion solid line repres valu analyt model marker measur simul result perform evalu work discuss chang tabl 3 figur 9 show direct cost lock barrier respect evalu impact final perform molecular dynam code measur would perform code free lock barrier ob viousli code would execut correctli result shown figur 13 show larg number thread 250 instruct count could reduc 10000 25 lock barrier result blue gene architectur includ fast hardwar barrier atom mem tabl 7 instruct cycl count one comput thread sampl node j cpi averag number machin cycl per instruct cpf number machin cycl per floatingpoint instruct thread 50 thread 100 thread 150 thread 180 thread 200 thread 250 thread short intermedi 656383 15191 9226 6533 6409 5683 4703 long 2460789 56954 34867 26061 25221 23713 18791 kfactor 332654 11704 9368 9002 8625 8608 7826 kforc 661631 14024 8491 5738 5738 5738 2987 instructionsthread 4582740 111975 69585 51790 50502 48228 39162 comput cycl 10847196 cpi 237 541 499 480 453 444 444 internod commun cycl 13352 13352 13352 13352 13352 13352 13352 total cycl 10860548 620882 360149 262354 242020 227505 187248 effici 100 035 cach size byte miss rate cach miss rate x cach size associ 32 byteslin figur 12 data cach simul result trace collect execut molecular dynam code ori updat hardwar barrier allow synchron thread node less 10 machin cycl anoth architectur enhanc motiv work bswitch shown tabl 7 overal impact commun cycl small less 10 total howev achiev goal necessari perform reduct broadcast minim softwar overhead motiv develop bswitch microprogram data stream switch oper doubl word 64bit level cycl b switch rout data input combin output also perform floatingpoint oper stream direct stream data tofrom memori node diagram bswitch shown figur 14 7 conclus estim execut molecular dynam code system 32000 atom full petaflop cellular system 50 100 150 200 250 3001030507090110number comput thread instruct cycl thousand node perform 32000 atom problem 256x128 mesh lock barrier lock barrier lock barrier lock barrier figur 13 impact barrier lock perform molecular dynam code differ line repres differ configur lock barrier scale envis ibm blue gene project sequenti version applic execut 140 stime step 800 mflop workstat parallel version execut 375stime step petaflop machin correspond parallel speedup 368000 machin 1250000 time faster effici 30 result agreement estim deriv 11 exercis demonstr class molecular dynam applic exhibit enough parallel exploit million concurr thread execut reason effici demon strate broad line valid massiv parallel cellular system design one approach achiev one petaflop comput power also provid us clear understand repres molecular dynam applic code accur perform model still much work refin improv result fpu input fifo 4 input fifo 5 output fifo 0 output fifo 1 output fifo 2 output fifo 3 output fifo 4 output fifo 5 memori fifo memori fifo control input fifo 0 input fifo 1 input fifo 2 input fifo 3 regist file bswitch figur 14 bswitch devic stream data input port memori output port memori bswitch incorpor fpu perform arithmet logic oper directli data stream present simul upgrad repres detail hardwar design perform model need upgrad valid cycl faith simul commun analysi need reflect overlap comput commun node failur machin scale address algorithm method continu improv 8 r comput simul liquid blue gene project program macromolecular energi minim die berechnung optisch und elektrostatisch gitterpotential flexram toward advanc intellig memori system cm3d cmm md code case intellig ram iram fast parallel algorithm shortrang molecular dynam novel bind mode hydroxam inhibitor human carbon anhydras ii hybrid technolog multithread parallel molecular dynam implic massiv parallel machin toward costeffect dsm organ exploit processormemori integr molecular dynam system multipl time scale revers multipl time scale molecular dynam comput experi classic fluid tr comput simul liquid fast parallel algorithm shortrang molecular dynam parallel molecular dynam ctr jeffrey vetter frank mueller commun characterist largescal scientif applic contemporari cluster architectur journal parallel distribut comput v63 n9 p853865 septemb jeffrey vetter dynam statist profil commun activ distribut applic acm sigmetr perform evalu review v30 n1 june 2002 chingtien ho larri stockmey new approach faulttoler wormhol rout meshconnect parallel comput ieee transact comput v53 n4 p427439 april 2004 georg almsi clin cacav jo g castao monti denneau derek lieber jo e moreira henri warren jr dissect cyclop detail analysi multithread architectur acm sigarch comput architectur news v31 n1 march kumar c huang g zheng e bohm bhatel j c phillip h yu l v kal scalabl molecular dynam namd ibm blue genel system ibm journal research develop v52 n1 p177188 januari 2008