effici protocol authent key agreement paper propos effici twopass protocol authent key agreement asymmetr publickey set protocol base diffiehellman key agreement modifi work arbitrari finit group particular ellipt curv group two modif protocol also present onepass authent key agreement protocol suitabl environ one entiti onlin threepass protocol key confirm addit provid variant protocol standard ieee p1363 17 ansi x942 2 ansi x963 4 iso 154963 18 current consider standard us govern nation institut standard technolog 30 b introduct key establish process two entiti establish share secret key key subsequ use achiev cryptograph goal confidenti data integr broadli speak two kind key establish protocol key transport protocol key creat one entiti secur transmit second entiti key agreement protocol parti contribut inform jointli establish share secret key paper shall consid key agreement protocol asymmetr publickey twoentiti set let b two honest entiti ie legitim entiti execut step protocol correctli inform speak key agreement protocol said provid implicit key authent b entiti assur entiti asid specif identifi second entiti b possibl learn valu particular secret key note properti implicit key authent necessarili mean assur b actual possess key key agreement protocol provid implicit key authent particip entiti call authent key agreement ak protocol inform speak key agreement protocol said provid key confirm b assur second entiti b actual possess particular secret key implicit key authent key confirm b provid key establish protocol said provid explicit key authent b key agreement protocol provid explicit key authent particip entiti call authent key agreement key confirm akc protocol extens survey key establish see chapter 12 menez van oorschot vanston 27 extrem care must exercis separ key confirm implicit key authen ticat ak protocol offer key confirm use point 10 desir agre key confirm prior cryptograph use done varieti way exampl key subsequ use achiev confiden tialiti encrypt key begin care chosen known data system may provid key confirm realtim telephon convers separ key confirm implicit key authent sometim desir permit flexibl particular implement choos achiev key confirm thu move burden key confirm establish mechan applic paper propos new effici twopass ak protocol protocol base diffiehellman key agreement 14 mani desir secur perform attribut discuss 10 see x2 two modif protocol also present onepass ak protocol suitabl environ one entiti onlin threepass protocol key confirm addit provid protocol describ paper establish share secret k two entiti deriv function use deriv secret key share secret necessari k may weak bit bit inform k predict correctli nonneglig advantag one way deriv secret key k appli oneway hash function sha1 28 k except protocol 3 x62 paper includ key deriv function protocol descript protocol describ paper describ set group point ellipt curv defin finit field howev easili modifi work finit group discret logarithm problem appear intract suitabl choic includ multipl group finit field subgroup z n n composit integ subgroup z p prime order q ellipt curv group advantag offer equival secur group smaller key size faster comput time remaind paper organ follow x2 discuss desir attribut ak akc protocol x3 describ ellipt curv paramet common entiti involv protocol public key method valid x4 review mti protocol describ activ attack attack influenc design new twopass ak protocol present x5 x6 present onepass variant protocol threepass variant provid explicit key authent final x7 make conclud remark desir attribut ak akc protocol numer diffiehellmanbas ak akc protocol propos year ever mani subsequ found secur flaw main problem appropri threat model goal secur ak akc protocol lack formal defini tion blakewilson johnson menez 10 adapt earlier work bellar rogaway 9 symmetr set provid formal model distribut comput rigor definit goal secur ak akc protocol within model concret ak akc protocol propos proven secur within framework random oracl model 8 paper follow definit goal secur ak akc protocol describ inform x1 classif threat secur protocol abl withstand passiv attack adversari attempt prevent protocol achiev goal mere observ honest entiti carri protocol activ attack adversari addit subvert commun inject delet alter replay messag addit implicit authent key confirm number desir secur attribut ak akc protocol identifi see 10 discuss 1 knownkey secur run key agreement protocol two entiti b produc uniqu secret key key call session key protocol still achiev goal face adversari learn session key 2 perfect forward secreci longterm privat key one entiti compromis secreci previou session key establish honest entiti affect 3 keycompromis imperson suppos longterm privat key disclos clearli adversari know valu imperson sinc precis valu identifi howev may desir loss enabl adversari imperson entiti 4 unknown keyshar entiti coerc share key entiti b without knowledg ie believ key share entiti c 6 b b correctli believ key share 5 key control neither entiti abl forc session key preselect valu desir perform attribut ak akc protocol includ minim number number messag exchang run protocol low commun overhead total number bit transmit low comput overhead attribut may desir circumst includ rolesymmetri messag transmit entiti structur noninteract messag transmit two entiti independ nonreli encrypt meet export requir hash function sinc notori hard design timestamp sinc difficult implement secur practic 3 domain paramet key pair gener section describ ellipt curv paramet common entiti involv protocol ie domain paramet key pair entiti 31 domain paramet domain paramet protocol describ paper consist suitabl chosen ellipt curv e defin finit field f q characterist p base point remaind subsect elabor suitabl paramet outlin procedur verifi given set paramet meet requir order avoid pollardrho 32 pohlighellman 31 algorithm ellipt curv discret logarithm problem ecdlp necessari number f q ration point e denot ef q divis suffici larg prime n write commonli recommend n 2 160 see 3 4 fix underli field f q n select larg possibl ie one n q ef q almost prime remaind paper shall assum n 2 160 n 4 p q hass theorem henc impli n 2 divid ef q thu ef q uniqu subgroup order n also sinc uniqu integ h name guard potenti small subgroup attack see x41 point p order n precaut exercis select ellipt curv avoid reduct algorithm menez okamoto vanston 24 frey ruck 16 curv nonsupersingular ie p divid q gener one verifi n divid q larg enough comput infeas find discret logarithm f q c suffic practic 3 avoid attack semaev 34 smart 35 satoh araki 33 f q anomal curv curv f q anomal ie ef q 6 q prudent way guard attack similar attack special class curv may discov futur select ellipt curv e random subject condit ef q divis larg prime probabl random curv succumb specialpurpos attack neglig curv select verifi random choos coeffici defin ellipt curv equat output oneway function sha1 accord prespecifi procedur procedur accomplish similar spirit method given fip 186 29 select dsa prime verifi random describ ansi x962 3 summar domain paramet compris 1 field size q q prime power practic either odd prime 2 indic fr field represent represent use element f q 3 two field element b f q defin equat ellipt curv e f q ie case p 3 case 4 two field element x p p f q defin finit point prime order ef q sinc p describ two field element impli p 6 denot point infin 5 order n point p 6 cofactor domain paramet valid set domain paramet q fr b verifi meet requir follow process call domain paramet valid 1 verifi q prime power 2 verifi fr valid field represent 3 verifi b x p p element f q ie verifi proper format element f q 4 verifi b defin nonsingular ellipt curv f q ie 4a 3 case p 3 b 6 0 case 5 verifi p satisfi defin equat e p 6 6 verifi n 4 p q n prime n suffici larg eg n 2 160 7 verifi 8 comput verifi 9 ensur protect known attack special class ellipt curv verifi n divid q 20 n 6 q 32 key pair gener given valid set domain paramet q fr b h entiti privat key integ select random interv 1 n gamma 1 public key ellipt curv point key pair q run key agreement protocol two entiti b produc uniqu share secret key henc protocol describ paper entiti two public key static longterm public key ephemer shortterm public key static public key bound entiti certain period time typic use certif new ephemer public key gener run protocol static key pair denot wa wa ephemer key pair denot remaind paper assum static public key exchang via certif cert denot publickey certif contain string inform uniqu identifi name address static public key wa certifi author ca signatur inform avoid potenti unknown keyshar attack see x42 ca verifi possess privat key wa correspond static public key wa inform may includ data portion certif includ domain paramet known context entiti b use authent copi ca public key verifi certif therebi obtain authent copi static public key publickey valid use entiti purport public key q prudent verifi possess arithmet properti suppos name q finit point subgroup gener p process call publickey valid 19 given valid set domain paramet q fr b purport public key valid verifi 1 q equal 2 xq q element field f q ie proper format element 3 q satisfi defin equat e 4 embed publickey valid comput expens oper publickey valid scalar multipl step 4 static public key valid could done ca howev sinc new ephemer key gener run protocol valid ephemer key place signific burden entiti perform valid reduc burden step 4 omit key valid instead protocol propos x5 x6 ensur share secret k gener finit point subgroup gener p summar given valid set domain paramet embed publickey valid purport public key accomplish verifi 1 q equal 2 xq q element field f q ie proper format element f q 3 q satisfi defin equat e 4 mti key agreement protocol mtia0 mtic0 key agreement protocol describ special case three infinit famili key agreement protocol propos matsumoto takashima imai 23 1986 design provid implicit key authent provid key confirm close relat protocol kea 30 propos goss 17 yacobi 37 latter oper ring integ modulo composit integ yacobi prove protocol secur certain type knownkey attack passiv adversari provid composit modulu diffiehellman problem intract howev desmedt burmest 13 point secur heurist knownkey attack activ adversari section illustr mtia0 mtic0 famili protocol vulner sever activ attack small subgroup attack present x41 illustr mtic0 protocol origin describ provid implicit key authent unknown attack present x42 illustr mtia0 protocol possess unknown keyshar attribut circumst activ attack ak protocol discuss diffi van oorschot wiener 15 burmest 11 vaudenay 20 lim lee 22 41 small subgroup attack small subgroup attack first point vanston 26 see also van oorschot wiener 36 anderson vaudenay 1 lim lee 22 attack illustr authent valid static ephemer key prudent sometim essenti measur take diffiehellman ak protocol illustr small subgroup attack mtic0 protocol protocol assum b priori possess authent copi other static public key mtic0 ak protocol 1 gener random integ r comput point send b 2 b gener random integ r comput point send tb 3 comput r 4 b comput 5 share secret point k small subgroup attack launch order n base point p prime say attack forc share secret one small known subset point small subgroup attack mtic0 protocol 1 e intercept messag replac 2 e intercept bs messag tb replac mtb 3 comput r mtb 4 b comput k lie subgroup order group gener p henc take one possibl valu sinc valu k correctli guess e high probabl show mtic0 protocol provid implicit key authent effect especi drastic subsequ key confirm phase may fail detect attack e may abl correctli comput messag requir key confirm exampl e may abl comput behalf messag authent code mac k messag consist ident b ephemer point purportedli sent point sent b small subgroup attack mtic0 prevent exampl mandat use base point p prime order requir b perform key valid ephemer public key receiv 1 case static privat key w select subject condit 42 unknown keyshar attack activ attack mtia0 protocol describ subsect first point menez qu vanston 25 attack mani variant illustr prudent requir entiti prove possess privat key correspond static public key ca ca certifi public key belong proof possess accomplish zeroknowledg techniqu exampl see chaum everts van de graaf 12 mtia0 ak protocol 1 gener random integ r comput point send ra cert b 2 b gener random integ r comput point send rb cert b 3 comput 4 b comput 5 share secret point k one variant unknown keyshar attack adversari e wish messag sent b identifi origin e accomplish e select integ e 1 e get certifi public key notic e know logic privat key correspond public key assum cours discret logarithm problem ef q intract although know e unknown keyshar attack mtia0 protocol 1 e intercept messag ra cert replac ra cert e 2 b send rb cert b e forward erb cert b 3 comput 4 b comput b share secret k even though b believ share secret e note learn valu k henc attack illustr mtia0 protocol possess unknown keyshar attribut hypothet scenario attack may launch success follow scenario first describ diffi van oorschot wiener 15 suppos b bank branch account holder certif issu bank headquart within certif account inform holder suppos protocol electron deposit fund exchang key bank branch via mutual authent key agreement b authent transmit entiti encrypt fund deposit account number certif suppos authent done encrypt deposit messag might case save bandwidth attack mention success launch deposit made es account instead account 5 new authent key agreement protocol section twopass ak protocol describ follow notat use x5 x6 f denot bitlength n prime order base point q finit ellipt curv point q defin follow let x xcoordin q let x integ obtain binari represent x valu x depend represent chosen element field f q q defin integ observ q mod n 6 0 51 protocol descript describ twopass ak protocol protocol 1 optim refin protocol first describ menez qu vanston 25 depict figur 1 subsequ figur w awa denot static privat key static public key wa wa respect domain paramet static key set valid describ x3 b priori possess authent copi other static public certif includ flow ra figur 1 twopass ak protocol protocol 1 protocol 1 1 gener random integ r comput point send b 2 b gener random integ r comput point send 3 embed key valid rb see x32 valid fail termin protocol run failur otherwis comput termin protocol run failur 4 b embed key valid ra valid fail b termin protocol run failur otherwis b comput termin protocol run failur 5 share secret point k 52 secur note rational although secur protocol 1 formal proven model distribut comput heurist argument suggest protocol 1 provid mutual implicit key authenti cation addit protocol 1 appear secur attribut knownkey secur forward secreci keycompromis imperson key control list x2 anoth secur attribut protocol 1 compromis ephemer privat key r r b reveal neither static privat key wa wb share secret k kaliski 21 recent observ protocol 1 possess unknown keyshar attribut demonstr follow onlin attack adversari e intercept ephemer public key ra intend b comput certifi static public key note e know correspond privat key transmit b b respond send rb e e forward b comput secret k howev b mistakenli believ share k e emphas lack unknown keyshar attribut contradict fundament goal mutual implicit key authent definit provis implicit key authent consid case b engag protocol honest entiti e isnt applic use protocol 1 concern lack unknown keyshar attribut onlin attack appropri confirm ad exampl specifi protocol 3 protocol 1 view direct extens ordinari unauthent diffiehellman agreement protocol quantiti b serv implicit signatur ephemer public key ra bs ephemer public key rb respect share secret rather r r bp would case ordinari diffiehellman express ra use half bit xcoordin ra done order increas effici comput k scalar multipl rawa 4 done half time full scalar multipl modif appear affect secur protocol definit ra impli ra 6 0 ensur contribut static privat key wa cancel format 1 multipl h 2 4 ensur share secret k see equat 5 point subgroup order n ef q check ensur k finit point protocol 1 use agre upon kbit key subsequ use symmetrickey block cipher recommend ellipt curv chosen n 2 2k protocol 1 desir perform attribut list x2 point view domin comput step run protocol 1 scalar multipl r ap rbwb hsa rb rbwb henc work requir entiti 25 full scalar mul tiplic sinc r ap comput offlin onlin work requir entiti 15 scalar multipl addit protocol low commun overhead rolesymmetr noninteract use encrypt timestamp hash function may use key deriv function deriv session key share secret k secur protocol 1 appear less reliant cryptograph strength hash function ak protocol protocol 3 10 particular requir key deriv function preimag resist appear unnecessari non relianc hash function advantag histori shown secur hash function difficult design 6 relat protocol section present two relat protocol onepass ak protocol protocol 2 threepass akc protocol protocol 3 61 onepass authent key agreement protocol purpos onepass ak protocol protocol 2 entiti b establish share secret transmit one messag b use applic one entiti onlin secur email storeandforward protocol 2 depict figur 2 assum priori authent copi bs static public key domain paramet static key set valid describ x3 ra figur 2 onepass ak protocol protocol 2 protocol 2 1 gener random integ r comput point send b 2 comput termin protocol run failur 3 b embed key valid ra see x32 valid fail b termin protocol run failur otherwis b comput n termin protocol run failur 4 share secret point k heurist argument suggest protocol 2 offer mutual implicit key authent main secur drawback protocol 2 knownkey secur forward secreci sinc entiti b contribut random permessag compon cours case onepass key agreement protocol 62 authent key agreement key confirm protocol describ akc variant protocol 1 depict figur 3 domain paramet static key set valid describ x3 mac messag authent code algorithm use provid key confirm exampl provabl secur practic mac algorithm see bellar canetti krawczyk 5 bellar guerin rogaway 6 bellar kilian rogaway 7 h 1 independ key deriv function practic instanti h 1 includ h 1 protocol 3 1 gener random integ r comput point send b 2 21 b embed key valid ra see x32 valid fail b termin protocol run failur 22 otherwis b gener random integ r comput point ra figur 3 threepass akc protocol protocol 23 b termin protocol run failur share secret k 24 b use xcoordin z point k comput two share z z send togeth rb 3 31 embed key valid rb valid fail termin protocol run failur 32 otherwis comput termin protocol run failur 33 use xcoordin z point k comput two share z z 34 comput mac 0 verifi equal sent b 35 comput mac 0 send b 4 b comput mac 0 verifi equal sent 5 session key akc protocol 3 deriv ak protocol 1 ad key confirm latter done exactli way akc protocol 2 10 deriv ak protocol 3 10 protocol 2 10 formal proven secur akc protocol heurist argument suggest protocol 3 paper secur akc protocol addit desir secur attribut list x2 7 conclud remark paper present new ak akc protocol possess mani desir secur attribut extrem effici appear place less burden secur key deriv function propos neither protocol propos formal proven possess claim level secur heurist argument suggest case hope protocol appropri modif plausibl assumpt proven secur model distribut comput introduc 10 acknowledg author would like thank simon blakewilson johnson comment earlier draft paper ms law dr solina would like acknowledg contribut colleagu nation secur agenc r mind ps qs key hash function messag authenti cation xor mac new method messag authent use finit pseudorandom function secur cipher block chain random oracl practic paradigm design effici protocol entiti authent key distribut key agreement protocol secur analysi risk open distribut key improv protocol demonstr possess discret logarithm gener toward practic proven secur authent key distri bution new direct cryptographi authent authent key ex chang remark concern mdivis discret logarithm divisor class group curv cryptograph method apparatu public key exchang authenti cation contribut ansi x9f1 work group authent multiparti key agreement contribut ansi x9f1 ieee p1363 work group key recoveri attack discret logbas scheme use prime order subgroup seek smart publickey distribut sy tem reduc ellipt curv logarithm logarithm finit field new key agreement protocol provid mutual implicit authent key agreement need authent handbook appli cryptographi secur hash standard sh digit signatur standard skipjack kea algorithm specif improv algorithm comput logarithm gf p cryptograph signific mont carlo method index comput mod p fermat quotient polynomi time discret log algorithm anomal ellipt curv evalu discret logarithm group ptorsion point ellipt curv characterist p discret logarithm problem ellipt curv trace one diffiehellman key agreement short expo nent key distribut paradox tr ctr johann groschdl alexand szeke stefan tillich energi cost cryptograph key establish wireless sensor network proceed 2nd acm symposium inform comput commun secur march 2022 2007 singapor kyungah shim sung sik woo cryptanalysi tripartit multiparti authent key agreement protocol inform scienc intern journal v177 n4 p11431151 februari 2007 kyungah shim vulner gener mqv key agreement protocol without use oneway hash function comput standard interfac v29 n4 p467470 may 2007 maurizio adriano strangio effici diffiehellmann twoparti key agreement protocol base ellipt curv proceed 2005 acm symposium appli comput march 1317 2005 santa fe new mexico mario di raimondo rosario gennaro hugo krawczyk secur offtherecord messag proceed 2005 acm workshop privaci electron societi novemb 0707 2005 alexandria va usa