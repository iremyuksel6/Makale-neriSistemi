model bgp rout network engin perform ip network depend wide varieti dynam condit traffic shift equip failur plan mainten topolog chang part internet degrad perform maintain good perform network oper must continu reconfigur rout protocol oper configur bgp control traffic flow neighbor autonom system ase well traffic travers network howev bgp rout select distribut indirectli control configur polici influenc complex interact intradomain rout protocol oper predict particular bgp configur would behav practic avoid inadvert degrad network perform oper need evalu effect configur chang deploy live network propos algorithm comput outcom bgp rout select process router singl given static snapshot network state without simul complex detail bgp messag pass describ bgp emul base algorithm emul exploit uniqu characterist rout data reduc comput overhead use data larg isp show emul correctli comput bgp rout decis run time accept mani task traffic engin capac plan b introduct deliveri ip packet internet depend larg collect router comput endtoend path di permiss make digit hard copi part work person classroom use grant without fee provid copi made distribut profit commerci advantag copi bear notic full citat first page copi otherwis republish post server redistribut list requir prior specif permiss andor fee tribut fashion use standard rout protocol provid low latenc high throughput high reliabl requir network oper adjust rout protocol configur perform problem aris network condit chang exampl oper might adjust configur respond network congest equip failur prepar plan mainten howev complex protocol larg number tunabl paramet size network make extrem difficult oper reason effect action common approach tweak pray longer accept environ user high expect perform reliabl 1 avoid costli debug time catastroph mistak oper must abl make predict quickli base accur model rout protocol previou work area focus interior gateway protocol igp open shortest path first ospf intermedi systemintermedi system isi oper within singl autonom system protocol link configur integ cost use comput shortest path smallest cost path network tune link weight give oper way modifi path insid satisfi network user perform goal 2 sever exist tool 3 4 5 captur chang link weight would affect flow offer traffic new path also propos good candid set link weight although tool extrem valuabl network oper flow traffic larg servic provid backbon ultim depend interdomain rout protocol well provid use border gateway protocol bgp exchang reachabl inform neighbor domain propag rout within network un fortun sever subtleti make model bgp rout select much challeng emul igp bgp distribut path vector oper mean everi router may differ view network state contrast link state protocol flood complet inform throughout network bgpspeak router send increment reachabl inform immedi neighbor bgp router send advertis notifi neighbor new rout destin prefix withdraw revok rout longer avail bgpspeak router local comput best bgp rout best rout announc neigh bor chang best path one router affect select best rout anoth router singl router complet view avail bgp rout bgp rout select complex process depend combin rout attribut igp advertis singl integ metric link select rout base shortest r b router neighbor rout ebgp rout ebgp router ingress egress figur 1 network engin terminolog path bgp rout advertis includ variou attribut list ase path path ip address router respons rout next hop bgp rout select base complex multistag decis process 6 bgp allow oper specifi complex polici indirect effect select best path bgp rout select depend interact intradomain rout protocol wherea igp model isol select best bgp rout router also depend igp path cost bgp next hop announc rout hot potato rout router prefer rout shortest igp path closest exit point introduc complex coupl bgp underli igp hierarch ibgp configur affect rout choic avail router intern bgp ibgp use distribut bgplearn rout throughout rather ibgp session pair router full mesh ibgp larg provid network typic distribut rout hierarch fashion make choic avail one router depend decis made router may prevent protocol converg paper present model accur determin network configur rout learn via extern bgp ebgp affect flow traffic exist tool simul bgp behavior 7 first paper develop model determin outcom bgp path select process router without simul dynam protocol type model import sever reason first network oper need know path router ultim select perform engin task eg traffic engin mainten need comput expens simul rout dynam present emul base model facilit task provid fast accur answer question effect chang network second accur model bgp rout select use improv valid exist simul highlight subtleti protocol situat bgp might converg uniqu solut simul may comput one possibl outcom may accur reflect outcom real network model framework present determin whether bgp configur would converg uniqu outcom predict configur chang would affect flow traffic first requir way determin rout ingress router would select destin prefix given network configur ebgp rout learn egress router shown figur 1 paper solv precis problem model bgp rout present essenti abstract conceal protocol detail irrelev outcom bgp decis process model comput bgp rout decis network configur correctli check separ test certain suffici con dition model also combin prefixlevel traffic measur form basi traffic engin tool rest paper organ follow section 2 present sever exampl network engin task motiv need accur predict model bgp path select section 3 describ practic constraint network configur rout advertis must satisfi make model bgp rout select possibl appli constraint novel way decompos rout predict problem three distinct phase section 4 describ phase rout predict algorithm detail section 5 describ prototyp implement bgp emul section 6 7 present evalu valid prototyp rout configur data larg tier1 isp experi show rout predict algorithm accur predict bgp rout decis effici enough practic mani network engin task section 8 provid overview relat work conclud section 9 2 network engin section discuss network engin problem oper commonli face exampl demonstr need systemat model bgp rout select process move beyond today tweak pray techniqu discuss practic model bgp use particular discuss advantag model simul live test 21 network engin problem network oper must adjust rout protocol configur respond follow common chang network condit chang traffic load traffic dynam amount traffic destin may suddenli chang caus chang traffic distribut across network link exampl web site sometim experi traffic surg due flash crowd ie slashdot effect network rout traffic destin neighbor could experi congest outbound link destin network oper must reconfigur rout polici allevi congest chang link capac network link frequent upgrad higher capac respons network oper may wish adjust configur rout addit traffic recent upgrad link exampl link figur 1 upgrad oc12 oc48 network oper would want shift traffic b longterm connect chang longer timescal point network connect neighbor ase well ase connect chang link ase appear disappear network oper must move larg amount traf fic shown figur 1 ad third link neighbor oper would shift portion traffic b new link chang avail rout due protocol dynam chang commerci agreement might suddenli receiv altern rout destin could caus traffic flow shift dramat altern exist rout could suddenli disappear event may requir network oper rebal flow traffic plan mainten network oper commonli perform routin mainten portion network adjust interior rout link weight divert traffic away part network undergo mainten router r undergo upgrad network oper could adjust igp link weight bgp configur divert traffic away r without overload link border neighbor domain failur disast plan oper may wish evalu robust network examin effect failur rout traffic flow studi effect compon link failur even seriou catastroph eg fiber cut tunnel fire terrorist attack help network oper planner make design decis tool exist help network oper adjust interior rout protocol paramet rebal traffic within 3 4 5 oper must also rebal traffic across extern link network reconfigur bgp network oper want shift traffic link b figur 1 typic would adjust import polici set rout router commonli decreas local prefer attribut router assign rout 8 would caus rout learn router b destin appear attract caus traffic destin exit via b 22 network engin requir motiv practic network engin exampl present sever requir network engin tool predict outcom bgp rout select throughout paper use term predict describ process determin outcom bgp rout select offlin oper need abl predict effect configur chang deploy live network oper typic handl network engin task tune exist configur live network wit effect chang revert previou configur desir effect achiev method time consum lead unnecessari perform degrad complex interdomain rout make essenti imposs comput backof theenvelop estim effect configur chang network engin involv explor larg search space oper need predict effect candid configur chang quickli possibl oper usual need experi mani possibl configur chang arriv accept solut requir techniqu quickli evalu effect propos configur chang prac tice candid configur chang typic small modif exist configur less like caus signific unexpect chang rout offer traffic load use rout predict tool fast evalu increment chang network engin task requir accur predict outcom bgp path select process requir detail simul protocol dynam network simul eg ssfnet 7 help oper understand dynam rout protocol behavior simul repres network behavior term messag pass protocol dynam certain period time contrast network engin usual need know outcom pathselect process lowlevel time detail furthermor exist simul captur relev protocol interact affect outcom decis process simul everi detail interact hard without higher level model bgp first place summari bgp path select massiv highli tunabl distribut comput maintain good endtoend perform oper need way predict outcom comput variou configur 1 effici 2 way facilit evalu increment chang 3 without deploy configur chang live network follow section describ way model bgp decis process across everi router algorithm correctli effici comput outcom bgp decis process router 3 model framework glanc model rout decis seem simpl appli bgp decis process router ever bgp rout system insid guarante converg uniqu solut router make consist deci sion even system converg decis made one router affect option avail router appli theoret result previou work impos three practic constraint rout system make model bgp rout select possibl show rout select model three distinct phase constraint satisfi 31 constraint rout system given ebgplearn rout destin prefix would like determin rout router would ultim select unfortun certain network configur lend effici rout predict fundament problem underli bgpsome configur converg determin whether system converg uniqu solut comput intract 9 make model bgp rout select feasibl impos three constraint explain constraint reason assum practic ebgplearn rout chang frequent intern rout system time propag effect one ebgp advertis next one arriv assum constraint 1 ebgplearn rout chang slowli respect timescal network engin decis practic bgp rout stabl day week time 10 vast major traffic associ stabl rout 11 allow emul oper static snapshot ebgp rout ebgp rout chang treat separ problem instanc network oper signific flexibl decid propag ebgplearn rout throughout simplest case router configur full mesh ibgp se sion gener though router may form complic signal graph ibgp session shown figur 2 edg correspond ibgp session pair router router normal forward ibgplearn rout ibgp neighbor howev router configur rout reflector rr forward rout learn one routereflector client client follow terminolog previou work 12 use term ibgp session router rr convent ibgp session two router ibgp session rr client valid signal path consist zero edg follow one edg follow zero edg alter nativ router within also group one confeder confeder use much less frequent rout reflector focu model rout reflector model effect confeder everi ebgplearn rout propag signal graph everi router exampl consid figur 2 exampl ibgp signal graph figur 2 edg rr1 rr2 session wherea edg z rr2 session ebgp rout learn z reach via rr2 rr1 ass signal graph violat properti even router connect via igp exampl session rr1 session instead session would way receiv ebgp rout learn z type partit make model difficult therefor assum constraint 2 router valid ibgp signal path everi router 1 oper network violat constraint sinc could creat network partit even though connect ip level full mesh ibgp session satisfi constraint full ibgp mesh among toplevel rr turn ibgp session rr client common configur scenario ensur ebgplearn rout ibgp path everi router still guarante router converg uniqu solut router learn rout advertis immedi ibgp ebgp neighbor exampl figur 2 w z ebgplearn rout router learn singl rout rout reflector rr1 suppos rr1 select ebgp rout advertis z would pick zs rout well even would prefer w rout zs rout note make differ rout decis would could select best rout ebgp rout ie w z situat differ router local rank bgp rout caus persist oscil even forward loop make difficult model outcom bgp decis process fortun problem avoid network configur satisfi follow suffici condit 12 constraint 3 router prefer rout learn neighbor rout learn neighbor b signal graph cycl edg c shortest igp path pair router valid signal path part satisfi router chang attribut ibgplearn rout router lower igp path cost client router common practic appli import polici ebgp session place rr client pointofpres ie pop ensur condit hold part b state rr b b rr c c rr consist common practic construct routereflector hierarchi rather arbitrari signal graph part c ensur router along shortest path egress point select egress point 1 properti check breadthfirst walk edg signal graph mark node visit graph walk edg follow edg 1 highest local prefer 2 lowest path length 3 lowest origin type 4 lowest med nexthop 5 ebgplearn ibgplearn 6 lowest igp path cost exit point 7 lowest router id bgp speaker 2 tabl 1 step bgp decis process prevent deflect part c difficult ensur practic consist approach assign client rr along shortest path egress point impos three constraint make model bgp rout select possibl router appli multistag decis process 6 select singl best rout summar tabl 1 decis process consid set avail rout destin proce stepbystep elimin candid rout exampl decis process first elimin rout highest local prefer valu forth singl best rout remain sinc rout select one router affect rout avail anoth router simpli appli bgp decis process independ router although must model distribut rout within constraint 1 3 ensur system converg uniqu solut allow us appli follow intuit result theorem 1 rout system guarante converg uniqu solut solut independ order router exchang rout appli decis process prove slightli differ version theorem previou work theorem 41 13 practic router may receiv numer rout advertis select propag best rout multipl time settl final choic fortun care select particular order event predict algorithm predict outcom without simul protocol dynam 32 phase rout predict algorithm although constraint discuss previous present condit stabl rout constraint also necessari model bgp rout select construct appli constraint propos novel way decompos rout predict theorem 1 give us flexibl defin messag order without affect correct specif algorithm select messag order decompos problem three distinct phase shown figur 3 rest section explain decomposit defer detail discuss phase section 4 receiv ebgp rout appli import polici first phase assum router receiv ebgplearn rout appli import polici exchang ibgp updat messag ebgplearn rout attribut destin prefix path associ ebgp session import polici may filter rout set certain attribut local prefer origin type multipleexit discrimin med accord attribut advertis rout eg base ase path appli import polici local oper ebgplearn rout 2 router vendor allow tiebreak base oldest rout ie rout learn first featur often disabl avoid introduc nondetermin bgp pathselect process ebgp modifi ebgp rout rout rout per prefix ebgp rout per prefix ibgp signal graph per prefix ingress best egress point best bgp rout best best ebgp igp path cost per ingressegress pair comput comput import polici per ebgp session router id per session appli import polici per prefix figur 3 decompos networkwid bgp rout select three independ phase router first phase emul exactli oper real router would perform upon receiv ebgp rout rout modifi attribut form input second phase comput best ebgplearn rout mani rout first phase would never select router best bgp rout exampl ebgplearn rout local prefer 90 would never select anoth rout local prefer 100 long everi ebgplearn rout reach everi router constraint 2 router would ever make less attract decis router word corollari 1 constraint 2 impli everi router select best bgp rout equal good first four step decis process exampl router east coast unit state might select rout learn new york wherea router west coast might select rout learn san francisco still two rout would local prefer path length origin type two rout nexthop would also med valu properti allow second phase algorithm focu select best ebgp rout across ebgpspeak router without model detail distribut rout throughout model influenc ibgp igp within third phase router select singl rout set best ebgp rout border router contribut set best rout select best ebgplearn rout everi router select one rout propag via ibgp behavior consist step 5 bgp decis process decis router depend rout select ibgp neighbor cost igp path exit point rout learn router id ibgp session introduc depend ibgp igp fortun algorithm need consid total igp path cost shortest igp path pair router rather hopbyhop cost make simplif constraint 3c impli router along igp path router chosen egress point select best bgp rout router along path egress point would deflect data packet toward differ egress point ingress router select although diagram figur 3 show three phase envis network oper could incorpor modul addit function exampl modul could combin predict bgp rout traffic data predict load link network use emul traffic engin assum traffic volum rel stabl remain stabl respons configur chang previou work found prefix respons larg amount traffic rel stabl traffic volum long timescal 8 oper could use emul test configur chang reason slow timescal affect prefix stabl traffic volum network oper could also combin measur estim traffic arriv ingress point destin prefix 14 linklevel path predict load link network anoth modul might evalu optim linklevel path term propag delay link util could search good configur chang appli live network 4 rout predict algorithm draw model framework section 3 section propos algorithm comput best rout router sinc path select process independ prefix focu predict problem singl destin prefix ensur algorithm effici best rout algorithm predict router chang predict made earlier router word design algorithm emul bgp messag order requir backtrack satisfi constraint first phase algorithm straightforward appli import polici pure local oper router howev second third phase algorithm complic subtl interact bgp decis process interact med router id prevent second phase algorithm simpli select local best rout router complic aris bgp decis process compar med valu rout nexthop med valu ebgp rout learn one router may affect local rank ebgplearn rout anoth router interact ibgp igp prevent third phase algorithm visit router arbitrari order complic aris best bgp rout one router chosen base igp path cost router id vantag point affect option avail ibgp neighbor remaind section describ second third phase algorithm arriv correct predict without backtrack 41 comput set best ebgp rout second phase algorithm begin complet set ebgp rout modif import polici produc set candid best ebgp rout best rout router select element set thu second phase algorithm must follow properti must elimin ebgplearn rout could best rout router impos constraint simplifi later stage algorithm c ibgp 3 figur 4 interact med router id bgp decis process small number router id complet second phase ebgpspeak router must contribut one candid rout properti must hold bgp protocol specif requir router select propag singl best rout second phase algorithm determin best rout destin everi ebgpspeak router start complet set ebgplearn rout systemat elimin rout set candid rout first algorithm elimin everi rout set would elimin base first three step bgp decis process ie local prefer valu path length origin type algorithm effect appli first three step bgp decis process global across set candid ebgp rout might seem appeal either continu appli step bgp decis process global appli remain step decis process local router ie elimin rout set candid rout base med router id etc howev interact med router id attribut preclud consist rank rout router figur 4 present simpl exampl illustr two approach incorrect global rout elimin correct consid exampl figur 4 assum 3 learn ebgp rout b c equal good step 3 bgp decis process rout b learn 1 rout c learn 2 global comparison rout c first elimin base med router x pick rout sinc prefer b base router id comparison appli router howev conclus incorrect would alway prefer rout rout sinc learn via ebgp step 5 equal good step 4 recal router compar med rout differ nexthop ase local rout elimin correct might also seem natur simpli select best rout local router subsequ elimin rout set compar rout within set local best rout work either consid figur 4 appli decis process local router router select rout c router id lower sim ilarli router select rout suggest router x would ultim select best rout sinc better c due med comparison howev conclus also incorrect x alway prefer rout rout correctli handl interact med router id attribut algorithm determin effect step 48 bgp decis process emul effect particular messag order correctli propag effect med router best rout without backtrack figur 5 summar ebgpspeak router candid ebgplearn rout either elimin mark best rout 1 select ebgpspeak router least one candid rout consid rout best local router among remain candid rout 2 elimin rout higher med valu nexthop locallybest rout anoth router otherwis elimin rout router well rout nexthop larger med valu mark remain rout router best rout figur 5 appli step 48 bgp decis process determin set best ebgp rout part algorithm network figur 4 start c locallybest rout x respect base router id algorithm appli follow step 1 consid x locallybest rout c higher med valu nexthop elimin c candid router x 2 consid locallybest rout router locallybest rout smaller med valu nexthop mark best rout elimin b 3 consid x locallybest rout among remain candid router rout left mark best rout algorithm comput correct rout decis router router x router router better step 5 b step 7 c step 4 router x better step 5 better b matter router select b better c matter sinc c alway wors step 4 theorem 2 ebgpspeak router network second phase rout predict algorithm select best rout router best rout router ebgp learn rout best rout ibgplearn rout second phase elimin rout router proof theorem follow two proof previou work 13 work first show second phase rout predict algorithm never elimin candid rout ebgpspeak router would select best rout theorem a4 algorithm alway elimin everi candid rout bgp elimin theorem a4 addit second phase algorithm correctli predict set best ebgp rout without backtrack 42 comput best rout router third phase algorithm determin best bgp rout router given igp path cost ebgp speak router ibgp signal graph surfac problem rel simpl solut router take set best ebgplearn rout select closest egress point break tie base router id approach would work ebgp speak router readvertis everi ebgplearn rout everi router fullmesh ibgp configur howev use rout reflector rr typic violat assumpt rout altern avail particular router depend posit rout reflector hierarchi exampl consid a3ebgp figur interact ibgp igp decis process small number igp path cost solid line ibgp session dash line igp path 1 consid router partial order defin edg signal graph start router neighbor router select best rout among avail candid rout neighbor alreadi select rout candid rout exist assign best rout yet 2 consid router partial order defin edg signal graph start router neighbor router select rout previou step select best rout among rout select immedi neighbor figur 7 effici comput best rout router network shown figur 6 router x ebgp rout b respect equal good first four step decis process network rr1 prefer rout smaller igp path cost x howev would prefer b shortest igp path cost 3 via router z shortest path x cost 5 howev advertis best rout rr2 rr2 never learn rout b account depend algorithm emul particular ibgp messag order make decis router propag effect decis router visit router without backtrack theorem 1 allow algorithm select ibgp messag order constraint 3 satisfi algorithm consid rout decis router order specifi figur 7 appli algorithm exampl figur 6 shade router select best rout first step sinc router direct path ibgp hierarchi ebgpspeak router first x select best ebgp rout b respect sinc router level hierarchi algorithm visit der rr1 appli bgp decis process b select smaller igp path cost bgp decis process appli rest router start top hierarchi proceed downward rr2 receiv best rout destin similarli z receiv rr2 w receiv rr1 algorithm oper defin two partial order router base edg edg respect possibl constraint 3b requir signal graph cycl edg visit router direct ensur router select rout possibl requir constraint 3a visit remain router direct ensur router rout avail make deci sion consid router particular order guarante router make decis chang later router make decis result know theorem 3 constraint 2 3 satisfi third phase algorithm correctli predict egress router ingress router would choos use bgp without backtrack theorem restat theorem earlier work 15 suffici condit stabl bgp rout level previou result use construct proof show specif set export polici prefer relat ase guarante bgp arriv stabl path assign proof show exist stabl rout first assign path neighbor neighbor previou work observ condit bgp stabil aslevel ibgp rout reflect within 12 theorem 3 follow directli appli construct proof stabl global rout ibgp rout reflect proof 5 emul design demonstr algorithm section 4 accur practic implement bgp emul comput outcom bgp decis process router section discuss input data emul requir network oper obtain data practic describ basic design emul defer discuss perform optim section 63 51 input data shown figur 8 emul use three input bgp rout tabl bgp tabl ebgpspeak router provid first phase algorithm snapshot rout advertis neighbor ase ignor router current view best rout current set local prefer attribut sinc relat exist network configur rather scenario might want emul router configur file configur file use 1 determin import polici ie rout map ebgp session 2 determin ibgp signal graph 3 comput igp path cost pair router import polici use manipul attribut ebgp rout first phase algorithm ibgp igp inform need third phase bgp neighbor inform bgp decis process depend router id associ bgp session announc rout algorithm requir know router id associ bgp session second phase use router id ebgp session third phase use router id ibgp session emphas sever point regard input data first network oper captur necessari data telnet ssh access router second mani aspect input data eg router id data rout prefix stabl traffic volum etc chang often emul use even input data collect infrequ eg day final certain input approxim eg router id typic loopback ip address router often affect decis process emul effect even limit input bgp tabl known rout rout map import modifi rout bgp neighbor info router id egress point ibgp topolog rr client igp configur igp path cost predict rout appli import polici comput best ebgp rout comput best rout figur 8 data flow emul font specifi raw input input tabl deriv tabl practic oper might collect raw input day 52 emul design overview emul use databas backend design provid effici access small subset configur data rout also store intermedi result allow us valid part algorithm separ figur 8 summar emul use input intermedi result gener tabl predict rout emul perform rout predict three distinct databas oper correspond three phase describ section 32 comput modifi rout emul load bgp tabl rout map databas first oper appli import polici ebgp rout row import tabl specifi particular set row known rout tabl modifi emul perform actual modif modifi rout tabl specif row import tabl specifi router name ip address bgp neighbor path regular express row known rout tabl contain rout tabl entri includ ip prefix router rout learn nexthop ip address ie bgp neighbor path rout among attribut row import tabl first oper appli polici 1 find appropri rout select set rout learn correspond router bgp session match specifi path regular express 2 set attribut eg local prefer accord valu specifi row import tabl primari challeng associ oper result potenti larg number ie order million ebgp learn rout address challeng section 63 comput egress point second oper appli techniqu section 41 gener set best ebgplearn rout serv input third modul part algorithm perform select statement modifi rout tabl success refin set candid rout router id tabl contain router id everi bgp session router need step 7 decis process method section 41 mark best rout rout insert egress point tabl use third oper comput predict rout third oper use ibgp signal graph igp path cost techniqu section 42 determin best bgp rout prefix router modul use ibgp signal graph determin rout advertis router igp path cost pair router determin closest ebgpspeak router ingress router use step 6 decis pro cess router id ibgp session step 7 determin egress router ingress router select rr client tabl repres ibgp signal graph igp path cost repres shortest igp path pair router row rr client specifi rout reflector client particular cluster provid partial order need algorithm appli igp tiebreak step ingress router igp path cost use determin egress router shortest igp path 6 perform evalu section evalu perform implement bgp emul attempt perform complet perform analysi prototyp rather conduct experi demonstr practic predict algorithm evalu preliminari perform test demonstr emul oper timescal could allow oper use bgp emul base algorithm practic set evalu demonstr follow point emul comput best rout one prefix throughout larg tier1 isp network one second although predict best rout prefix router network take sever hour type comput need perform frequent practic exploit common among rout advertis elimin redund comput reduc run time emul approxim 50 use emul evalu effect increment chang router configur typic take sec ond thu believ emul practic task interdomain traffic engin briefli discuss evalu framework examin emul perform first discuss emul perform comput rout everi prefix rout tabl scratch without perform optim examin insight bgp decis process previou measur studi improv perform final describ emul quickli predict effect increment configur chang 61 evalu framework ran emul sun fire 15000 192 gb ram 48 900 mhz ultrasparciii copper processor timeshar machin ran experi sever time ensur accuraci measur except note prototyp use two 900 mhz processor one databas process one emul combin memori footprint databas process emul never exceed 50 mb emul use resourc standard pc result evalu reason reflect emul perform commod hardwar emul run time depend mani interdepend factorsinclud number neighbor ase number ebgp session number prefix number routersrun independ benchmark factor realist rout configur data extrem difficult exampl difficult run experi control everi factor affect run time vari number ebgp session similarli determin precis run time emul process increment configur chang difficult run time depend mani rout must recomput result chang rather isol individu factor affect perform difficult may accur reflect realist network condit evalu bgp emul run time use actual rout tabl configur data larg tier1 isp sever hundr router present absolut perform number well appropri averag give rough estim emul run time arbitrarys network also use averag estim run time comput effect increment rout chang network fewer prefix rout tabl fewer router fewer bgp session per router therefor run time report consid conserv emul shorter run time network 62 rout predict scratch get baselin perform estim algorithm first ran emul without perform optim emul begin execut rout predict algorithm must load input data databas load configur data three separ step 1 pars load rout tabl 2 pars load import polici 3 build databas index first two step parallel router sinc tabl configur router pars load independ load rout tabl sequenc prototyp pars load 1620061 ebgp learn rout larg tier1 isp 90 minut rate 280 rout per second load 20 tabl parallel emul finish load rout tabl 520 second speed oper critic sinc like perform per day time pars load import polici router id inform neglig emul pars load inform 1 second data pars load databas emul appli 486 import polici oper ebgp learn rout total 1576 second 031 oper per second make sens give perprefix perform number modul sinc one import polici appli mani prefix second modul comput set best ebgp rout rate 3 prefix per second third modul comput best rout prefix ingress router approxim 73 millisecond per prefix per router although emul take total 5 hour comput rout router larg isp network run emul like much faster case first depend task network oper may need perform rout predict everi prefix exampl well known major network traffic destin rel small fraction total prefix 8 thu network oper would like abl perform effect traffic engin emul rout select small number prefix similarli network oper debug reachabl problem singl prefix small group prefix need run emul prefix second sever perform optim significantli improv effici emul discuss next subsect 63 perform optim ensur emul oper reason timescal even larg number rout ebgp session design emul around inher structur input data particular make three observ inspir aspect design 1 mani bgp rout path attribut 2 neighbor ase often advertis larg group prefix attribut across ebgp session often advertis larg group prefix set ebgpspeak router 3 increment router configur chang typic affect rel small number rout observ allow bgp emul scale larg number prefix ebgp session divid emul run time half store manipul uniqu path modifi ebgplearn rout accord import polici potenti involv sequenti scan router bgp rout tabl rout whose path match given regular express perform oper per import polici would involv mani tabl scan fortun mani ebgplearn rout path bgp rout tabl uniqu path appear twenti ebgplearn rout averag exploit observ known rout modifi rout tabl store pointer ie foreign key separ tabl contain distinct path level indirect significantli reduc overhead first modul repeatedli modifi attribut set rout match certain path regular express first modul 1 search rel small path tabl find path pointer associ regular express 2 select subset tabl entri must modifi select entri path pointer tabl index oper tabl 45000 path instead 1 million ebgplearn rout first modul appli 102 import polici oper per secondmor factor 3 improv 031 oper per second report section 62 group prefix ebgp rout choic emul must comput set best ebgplearn rout prefix internet rout tabl often 100000 prefix perform predict per prefix could comput expens fortun neighbor typic advertis larg group prefix set peer session mani prefix advertis exactli fashion across ebgp session neighbor ase 8 typic happen singl institut announc sever prefix singl locat singl peer advertis variou prefix path length process comput set best rout exactli larg group prefix exampl two prefix ident set modifi rout ie attribut rout ebgp neighbor second modul emul would produc egress set fact true long two prefix rout path length neighbor sinc bgp decis process consid length path exploit observ known rout modifi rout tabl store length path along pointer tabl uniqu path group prefix rout path length local prefer origin type med reduc total number predict 91554 ie one per prefix 8291 ie one per group prefix identifi group prefix requir 1420 second time proport total number ebgplearn rout group prefix comput second modul requir 15753 second rather 30212 second need perform comput separ prefix speedup exceed factor two overhead check databas determin whether new comput avoid group prefix egress set best rout emul predict particular ingress router ultim depend set router egress set prefix theori number distinct set egress router exponenti number router fortun mani prefix advertis exactli fashion usual appli local polici manipul select rout mani prefix exactli set egress router emul thu select best rout group prefix egress set rather prefix rout data 91554 prefix 290 distinct egress set exploit observ appli algorithm section 42 per ingress router set egress router rather ingress router prefix determin whether predict alreadi comput ingress router set egress router requir addit databas queri despit addit overhead optim reduc run time third modul 73 43 millisecond per prefix per ingress router comput small differ increment chang envis network oper would use bgp emul traffic engin tool order predict configur chang would affect flow traffic kind configur chang typic affect small subset total number rout thu case increment configur chang emul avoid unnecessari recomput determin prefix affect polici chang recomput best rout prefix first phase algorithm reappli import polici rout learn associ ebgp session first phase keep track prefix affect polici chang allow second phase reevalu bgp decis process prefix third phase evalu select egress point destin prefix fact prefix might set egress point third phase evalu allow emul reus result earlier comput togeth optim allow emul return quick answer question increment chang network configur find recomput best rout singl import polici chang take less one second averag 7 valid verifi emul produc correct answer perform valid use complet rout protocol implement product router larg oper network network simul captur full detail standard rout proto col use compar emul result simul addit may unawar vendorspecif variat could affect accuraci result sinc make arbitrari chang network run emul individu snapshot deriv daili dump router configur file bgp rout tabl bgp neighbor inform compar emul rout predict seen practic phase algorithm compar result actual bgp tabl present breakdown mismatch encount isol sourc inaccuraci evalu modul independ assum perfect input previou modul also perform endtoend valid emul gener correct result 99 prefix mismatch attribut fact data set collect slightli differ time analysi focus snapshot network state earli morn est februari 4 2003 valid predict algorithm 91554 prefix whose ebgp rout learn peer point larg provid sinc rout tabl lo number attribut mismatch unusu configur total error path 43434 3 9 12 0028 rout 1620061 36 277 313 0019 tabl 2 summari error appli import polici number differ miss total error path 43434 66 187 253 0582 tabl 3 mispredict set best ebgp rout cation exclud prefix learn router recal predict algorithm reli know potenti egress router rout prefix learn initi bgp rout data consist 1620061 ebgplearn rout 43434 distinct path appli tool input check whether emul produc answer oper router select addit collect bgp rout tabl peer router ebgp rout learn also collect bgp tabl sever rout reflector access router verifi result 71 appli import polici verifi first phase correctli emul applic import polici need compar rout attribut ie local prefer med etc modifi rout tabl actual bgp rout tabl modifi rout tabl contain rout attribut modifi appli import polici specifi import tabl initi known rout tabl prototyp use rout tabl approxim actual rout receiv router determin rout discard import polici thu emul emul filter polici specifi import polici still determin effect import polici configur set manipul rout attribut eg traffic engin compar rout attribut known rout modifi rout tabl 1620061 ebgp rout 43434 distinct path tabl 2 summar result valid emul result match rout attribut seen bgp tabl 313 ebgplearn rout 12 distinct path observ 36 attribut mismatch 3 path like attribut actual polici chang sinc rout tabl configur file captur slightli differ time day verifi conclus inspect configur data next day remain mismatch involv 9 uniqu path prototyp handl complex configur scenario permit cisco router account 277 313 rout mismatch overal first phase produc success result 9997 case 72 comput set best ebgp rout verifi second phase correctli comput set best ebgp rout check best rout ebgpspeak router specifi egress point tabl correspond rout appear rout tabl router rout reflec tor rout match vast major time howev case two router differ rout ie differ path even though one router appar learn rout directli result summar dif ferent column tabl 3 miss column highlight case rr rout prefix time incon router predict case 1 case 2 case 3 total error tabl 4 error predict best egress router prefix predict incorrectli second phase right answer peer router exclud sistenc explain scenario togeth account 05 case verifi emul incorrectli exclud rout set best ebgp rout check prefix best rout rr appear set best ebgp rout comput emul 3 word consid case rr best rout would direct traffic toward egress router contain egress point tabl 111 best rout rr 2 prefix fell categori rout dynam explain inconsist manual inspect found mani case best rout rr clearli wors rout set best ebgp rout eg rr best rout local prefer higher path length 73 comput best rout router verifi emul correctli predict best egress router examin best rout bgp tabl sever router compar destin prefix nexthop pair rout tabl result predict rout tabl entri router perform comparison two access router connect directli custom differ geograph locat verifi emul make correct predict ingress router also analyz emul predict two rout reflector verifi algorithm make correct rout predict travers signal graph best rout match predict 995997 case summar tabl 4 router exclud prefix best egress router one peer router includ known rout tabl recal exclud router rout tabl case evalu whether algorithm would made correct predict didnt rout egress router first place classifi error among remain prefix term three case case 1 rout ingress router appear modifi rout tabl appear egress set case 2 rout ingress router appear modifi rout tabl appear egress point tabl case 3 mispredict obviou explan case 1 error like result time inconsist best rout ingress router exist egress router rout tabl dump time inconsist also explain case 2 error exampl ingress router rout reflector could rout longer one best ebgp learn rout could happen better rout arriv ebgpspeak router yet propag router unabl explain 005 error 74 endtoend valid perform endtoend valid studi effect error propag best rout ultim predict em 3 revers necessarili true egress point may larger igp path cost toplevel rr certain set ebgp rout router predict case 1 case 2 case 3 total error tabl 5 summari error endtoend valid ulat compar emul predict four rout tabl use valid third modul except input includ error first two mod ule four router emul predict correct rout 99 prefix summar tabl 5 hypothes major mispredict rout could explain dynam input data exampl best rout ebgpspeak router temporarili withdrawn time rout reflector tabl captur inconsist rout tabl could aris 4 result suggest algorithm propos ac curat predict error infrequ result mainli dynam input sinc prefix whose rout chang frequent receiv much traffic 11 inconsist would certainli prevent emul use traffic engin task 8 relat work previou work present igp emul help network oper optim link weight intradomain traffic engin 3 emul model chang bgp rout polici effect ibgp path select also much focu model bgp converg 9 15 first paper model bgp rout select recent work propos effici techniqu largescal paramet optim variou network protocol includ tune local prefer attribut bgp 16 work complementari oursth propos search techniqu could use emul inner loop techniqu current use simul ssfnet 7 depend outcom bgp path select dynam would like benefit effici accur emul inner loop bgp model paper appli sever previou theoret result new way constraint ibgp configur present section 3 motiv previouslyderiv suffici condit ibgp guarante rout protocol converg stabl deflectionfre path assign 12 17 work specifi condit ensur correct rout behavior constraint also requir model bgp rout third phase rout predict algorithm also use result previou work appli construct proof regard stabl intera polici configur 15 ibgp configur use proof basi third phase algorithm recent work explor practic traffic engin techniqu bgp assum exist bgp emul test traffic engin techniqu offlin 8 previous propos highlevel architectur bgp emul includ decomposit figur 3 second phase algorithm 13 paper present complet design phase algorithm includ detail analysi second phase 4 evalu hypothesi analyz feed ibgp updat messag collect day 45 prefix incorrect predict bgp rout chang data collect period router appar mismatch occur 83 prefix experienc updat router period argu decomposit model rout select process correctli also describ design implement emul base three phase algorithm present evalu valid 9 conclus perform everyday network engin task effect effi cientli minim unnecessari chang live network oper need way model rout protocol configur behav deploy configur paper present model accur effici predict outcom bgp rout select process singl use snapshot network configur ebgp learn rout neighbor domain algorithm present first model outcom bgp decis process across everi router without simul protocol dynam implement emul base model demonstr algorithm accur effici enough use practic mani network engin task model present necessari step advanc state art network engin believ model bgp emul tool present sever immedi possibl futur work first networkwid bgp rout predict could combin traffic measur help network oper select bgp configur chang achiev variou traffic engin task second emul could combin higherlevel mechan spot misconfigur check constraint robust satisfi 18 final note model bgp rout much difficult futur hope rout protocol design consid eas model design goal rout protocol easi model reason make everyday network engin task tractabl acknowledg thank joel gottlieb tim griffin carsten lund help router configur data glenn fowler rout tabl parser also thank magdalena balazinska greg harfst carsten lund stan rost aman shaikh renata teixeira comment draft paper 10 r overview principl internet traffic engin traffic engin tradit ip rout protocol netscop traffic engin ip network cariden mainstat border gateway protocol 4 bgp4 ssfnet guidelin interdomain traffic engin stabl path problem interdomain rout experiment studi internet stabil widearea network failur bgp rout stabil popular destin correct ibgp configur networkwid bgp rout predict traffic engin deriv traffic demand oper ip network methodolog experi stabl internet rout without global coordin recurs random search algorithm largescal network paramet configur analysi med oscil problem bgp practic verif techniqu widearea rout tr deriv traffic demand oper ip network stabl internet rout without global coordin stabl path problem interdomain rout correct ibgp configur bgp rout stabil popular destin analysi med oscil problem bgp recurs random search algorithm largescal network paramet configur experiment studi internet stabil backbon failur guidelin interdomain traffic engin ctr michael liljenstam david nicol ondemand comput polici base rout largescal network simul proceed 36th confer winter simul decemb 0508 2004 washington dc wolfgang mhlbauer anja feldmann olaf maennel matthew roughan steve uhlig build astopolog model captur rout divers acm sigcomm comput commun review v36 n4 octob 2006 jaideep chandrashekar zhili zhang hal peterson fix bgp one time proceed acm sigcomm workshop network troubleshoot research theori oper practic meet malfunct realiti septemb 0303 2004 portland oregon usa renata teixeira aman shaikh tim griffin geoffrey voelker network sensit hotpotato disrupt acm sigcomm comput commun review v34 n4 octob 2004 renata teixeira timothi g griffin mauricio g c resend jennif rexford tie break tunabl interdomain egress select ieeeacm transact network ton v15 n4 p761774 august 2007 renata teixeira timothi g griffin mauricio g c resend jennif rexford tie break tunabl interdomain egress select proceed 2005 acm confer emerg network experi technolog octob 2427 2005 toulous franc nick feamster jennif rexford networkwid predict bgp rout ieeeacm transact network ton v15 n2 p253266 april 2007 patrick verkaik dan pei tom scholl aman shaikh alex c snoeren jacobu e van der merw wrest control bgp scalabl finegrain rout control 2007 usenix annual technic confer proceed usenix annual technic confer p114 june 1722 2007 santa clara ca renata teixeira sharad agarw jennif rexford bgp rout chang merg view two isp acm sigcomm comput commun review v35 n5 octob 2005 nick feamster hari balakrishnan jennif rexford aman shaikh jacobu van der merw case separ rout router proceed acm sigcomm workshop futur direct network architectur august 3030 2004 portland oregon usa renata teixeira jennif rexford measur framework pinpoint rout chang proceed acm sigcomm workshop network troubleshoot research theori oper practic meet malfunct realiti septemb 0303 2004 portland oregon usa hao wang haiyong xie lili qiu yang richard yang yin zhang albert greenberg cope traffic engin dynam network acm sigcomm comput commun review v36 n4 octob 2006 steve uhlig olivi bonaventur design bgpbase outbound traffic engin techniqu stub ase acm sigcomm comput commun review v34 n5 p89106 octob 2004 gerhard kramer ivana mari roy yate cooper commun foundat trend network v1 n3 p271425 august 2006