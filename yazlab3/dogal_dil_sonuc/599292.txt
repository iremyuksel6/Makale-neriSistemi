bayesian mar bayesian approach multivari adapt regress spline mar fit friedman 1991 propos take form probabl distribut space possibl mar model explor use revers jump markov chain mont carlo method green 1995 gener sampl mar model produc shown good predict power averag allow easi interpret rel import predictor overal fit b introduct common problem statist disciplin approxim adequ function sever variabl statist set known multipl regress task perform either parametr global model eg linear regress nonparametr see exampl method aim model depend respons variabl one predictor variabl data given data assum come relationship describ f unknown regress function wish estim ffl zeromean error distribut commonli assum gau sian domain interest usual taken convex hull defin predictor variabl regress function f give predict relationship x ie condit expect given x thu may use f predict futur valu previous unseen point domain aim regress analysi use data construct estim b f x true regress function serv reason approxim domain interest mani method exist model function interest f eg addit model hasti tibshirani 1990 cart breiman et al 1984 project pursuit regress friedman stuetzl 1981 altern condit expect breiman friedman 1985 howev concentr multivari adapt regress spline mar methodolog propos friedman 1991 method seem highli flexibl easili interpret motiv recurs partit approach regress morgan sonquist 1963 breiman et al 1984 produc continu model made continu deriv greater flexibl model relationship nearli addit involv variabl model repres way addit contribut predictor variabl interact variabl easili identifi help identifi variabl import model highlight progress recurs partit regress mar start give partit regress model suitabl chosen coeffici basi function b k number basi function model basi function b indic function one argument true zero elsewher r partit usual mar model given 1 except basi function differ instead b given 2 degre interact basi b ji shall call sign indic equal sigma1 vj give index predictor variabl split ji known knot point give posit split vj delta j constrain distinct predictor appear interact term see section 3 friedman 1991 comprehens illustr model illustr initi confus notat present exampl suppos mar model contain basi function b given immedi see two factor interact term 2 sign indictor knot point given gamma37 label predictor split mar model continu made continu first deriv replac truncat linear basi function b truncat cubic basi function effect round basi function split point mar algorithm proce follow forward stepwis search basi function take place constant basi function one present initi step split minimis lackoffit criterion possibl split basi function chosen split permiss margin predictor valu split predictor x correspond two new basi func tion henceforth refer note unlik recurs partit algorithm basi function split made remov continu model reach predetermin maximum number basi function twice number expect model aid subsequ backward stepwis delet basi function involv remov basi function one time lackoffit criterion minimum basi improv fit degrad least remov step final result model made continu first deriv round split point mention lackoffit measur use friedman 1991 generalis crossvalid criterion origin propos craven wahba 1979 aim paper provid bayesian algorithm mimic mar procedur done consid number basi function along type see section 21 coeffici form posit split point sign indic random treat addit paramet problem make infer use data problem routin calcul posterior distribut model address design suitabl markov chain mont carlo mcmc revers jump simul algorithm set green 1995 simul sampl contain mani differ mar model correspond posterior weight estim f high predict power requir pointwis averag model sampl suggest work extens bayesian approach curv fit one dimens given denison et al 1998b relat bayesian cart algorithm propos denison et al 1998a chipman et al 1998 section 2 outlin bayesian mar method show exampl use method simul data section 3 real data section 4 section 5 contain discuss propos methodolog 2 bayesian mar method 21 basic idea must first defin mean type basi function use notat 1 2 consid basi function type ident permut henc predictor variabl n differ type basi function n given note sum includ constant basi function term would equal 0 3 basi b 1 alway sole constant basi function model chosen candid basi frequent maximum order interact assign model j case sum 3 run 1 let type basi function b thu effect tell us predictor variabl split ie valu v1 exampl suppos problem two predictor 2 type basi function could model includ constant one sigmax say type 2 sigmax say type 3 basi function split predictor x 2 type equal 2 propos model use set probabl distribut space possibl mar structur mar model uniqu defin number basi function present coeffici type basi function togeth knot point sign indic associ interact term mean make k random j uniqu defin via chang dimens model chang k bayesian comput use revers jump mcmc approach green 1995 richardson green 1997 consid chang number basi function model infer carri assum true model unknown come class model denot model exactli k basi function overal paramet space theta written countabl union subspac subspac euclidean space r nk r nk denot dimension paramet space correspond model k b 21j dimension vector correspond basi function b natur hierarch structur setup denot gener element theta k k data vector formalis model joint distribut k product model probabl paramet prior likelihood bayesian infer k k base joint posterior shall explor summaris regard target distribut tailor mcmc comput often use consid factoris form gener sampl joint posterior k k use class revers jump metropolishast algorithm green 1995 full detail method found refer cite focu essenc methodolog particular form algorithm current context 22 bayesian model assum ffl 1 follow n0 oe 2 distribut oe 2 unknown result extend paramet vector includ new unknown lead loglikelihood model l k jy given l k gamman log oe gamma2o 2 f form given 1 2 use vagu proper prior varianc error distribut ie oe gamma2 assum uniformli distribut ng sign indic ji knot point ji also assum uniform set fgamma1 1g ng respect use anoth vagu proper prior coeffici basi function assum n0 2 take varianc prior may chosen differ formul use let data dictat form model lead proper posterior distribut prior proper particular prior type basi function could chosen care priori main effect favour interact term could use interpret model rather predict import refin use mallick et al 1997 1998 concentr situat interpret model great interest poisson distribut paramet use specifi prior probabl number basi function give practic poisson distribut truncat k k max suitabl choic k max adopt howev help sampler mix better limit prior influenc put gamma hyperprior paramet equal 10 reflect knowledg expect basi function fit data well control overfit 23 comput strategi aim simul sampl joint posterior distribut p sinc analyt numer analys total intract situat purpos design revers jump algorithm gener type discuss green 1995 reader refer detail context problem multipl paramet subspac differ dimension necessari devis differ type move subspac combin form tierney 1994 call hybrid sampler make random choic avail move transit order travers freeli around combin paramet space use follow move type chang knot locat b addit basi function c delet basi function note step b c chang dimens model add basi function pair standard mar forwardstepwis procedur fact depart complet sort recurs partit approach found ad basi function singli make procedur flexibl revers condit easier satisfi chang mar structur describ coeffici basi function new model littl relationship current model infer difficult lead label problem richardson green 1997 instead choos integr coeffici error varianc oe 2 paramet vector k contain model param eter straightforward chose use conjug prior coeffici error varianc howev make predict use gener sampl model draw coeffici model sampl full condit distribut given model paramet given current model step straightforward first pick basi uniformli random pick one factor alter current knot locat ji probabl 1revers sign indic choos new knot locat margin predictor valu variabl x vji set new ji move type undertaken use metropoli step metropoli et al 1953 hast 1970 accept reject propos new state addit basi function birth step b carri choos uniformli type basi function say add model uniformli choos knot locat sign indic factor new basi step c death delet basi function construct way make jump step revers easili done choos basi function uniformli present except constant basi remov end iter move step perform use gibb step gelfand smith 1990 gener new straightforward full condit simpl calcul given full cycl algorithm obtain sampl k k 24 algorithm revers jump algorithm use three move type describ write set move refer chang knot locat refer increas number termin node m1 decreas m1 independ move type randomli chosen probabl ae k k k problem took b constant c paramet sampler taken 04 find marginalis coeffici error varianc accept probabl given green 1995 simplifi denot current model paramet 0 propos model pa ramet probabl propos move 0 data thu accept probabl bay factor kass multipli prior propos odd term approach common mani fix dimension paramet infer problem recent use context unknown number paramet chipman et al 1998 holm mallick 1997 use conjug prior distribut allow simpl evalu integr bay factor term demonstr ohagan 1994 lead bay factor given 0 refer propos model ident matrix note x refer usual design data matric current regress b bayesian least squar regress estim coeffici constant paramet gamma prior distribut oe gamma2 section 22 taken 001 note ordinari least squar approach estim regress coeffici undertaken denison et al 1998ab equival method use refer prior coeffici error varianc show prior propos odd term calcul use birth step exampl birth step b add basi b k1 current k basi function model prior odd given prior function k1 prior k basi function k term numer 6 given prior number basi function prior type basi function prior knot posit sign indic similarli denomin prior probabl set base k model thought probabl choos item set n order matter constant basi function fix need chosen prior model paramet product probabl factor certain sign indic ie2 certain knot point power number factor term model correspond propos odd given ppropos death ppropos birth k1 k propos death randomli choos one basi function includ constant one birth randomli choos type basi function probabl 1n togeth sign indic knot point factor new basi fn2ng gammaj k1 henc use equat 45 78 find accept probabl birth step accept probabl death step work similarli algorithm use straightforward work quickli birth step describ detail appendix step similar algorithm 1 start constant basi function present 2 set k equal number basi function current structur 3 gener u uniformli 01 4 goto move type determin u ffl els b ffl els goto chang step 5 draw use gibb step 6 repeat 2 suitabl number iter evid converg 3 simul exampl 31 bivari predictor first test methodolog exampl given hwang et al 1994 studi roosen hasti 1994 follow approach gener 225 pair predictor uniformli unit squar respons fx true valu test function ffl drawn n0 025 2 distribut test function ffl simpl interact function ffl radial function f 2 ffl harmon function ffl addit function ffl complic interact function function scale translat standard deviat one nonneg rang use fraction varianc unexplain test fit model data given fx true valu function b fit valu f mean true valu use fvu help compar fit model differ gener dataset evalu fvu fit replac expect averag test set 10000 point bivari exampl simpli 100 100 grid unit squar ie 1200 199200 higher dimension exampl follow test set compos 10000 random uniform valu domain interest train set calcul fvu train sampl treat observ valu fx took result last 30000 iter sampler initi burnin period long enough converg occur end converg assum mean squar error fit settl time similar curv fit algorithm denison et al 1998b tabl 1 display fvu train set data test set standard mar algorithm togeth number basi function found bmar model give averag fvu posterior mean model obtain pointwis averag 10 run algorithm display averag number basi function sampl produc 10 repetit algorithm standard mar model refer lmar piecewiselinear mar cmar piecewis cubic mar give result mar model tabl 1 show bmar model give compar often better result lmar cmar wide varieti exampl also averag number basi function found bmar commonli less number found use standard mar true surfac exampl shown fig 1 correspond bmar estim given fig 2 fig 1 2 tabl 32 high dimension predictor take exampl friedman et al 1983 basic function follow friedman et al gener 200 random uniform predictor sixdimension unit hypercub take respons fx ffl independ ident distribut n0 1 random variabl extra predictor spuriou affect respons friedman 1991 also use function paper tendimension predictor use five spuriou sampl size reduc 100 commonli case friedman 1991 allow twoway interact mar model use higherord interact term gener improv fit make model unnecessarili complex even though could incorpor requir tabl 2 display fvu train test set exampl use standard mar bmar method took result last 30000 iter 10 run algorithm initi burnin period result shown demonstr bmar model parsimoni fit data compar standard mar fit tabl 4 real data exampl illustr methodolgi use real dataset use data studi bruntz et al 1974 depend ozon meteorolog variabl 111 day may septemb 1973 site new york metropolitan area cleveland et al 1988 work cube root ozon dataset known air avail splu becker et al 1988 three predictor variabl radiat temperatur wind speed vastli differ rang respons predictor standardis data beforehand ie linearli transform variabl zero mean unit varianc allow maineffect twoway interact term mar model mar fit 6 basi function residu sum squar rss given 1841 linear approxim 2019 cubic one final model form fwindftemperaturefwind temperatur fradiat temperatur one basi function term except final one two basi function exist 5 run algorithm use prior previou section averag rss given bmar model 1832 406 basi function lower rsss given mar model fewer basi function shown fig 3 bmar estim temperatur wind plane smooth wherea piecewiselinear estim use mar fig 4 bmar estim also smaller rss less degre freedom tabl 3 display estim posterior probabl possibl term model rss averag number basi function 5 run immedi seen produc similar result suggest converg occur end burnin period also appear import basi function fit main effect term radiat temperatur windtemperatur interact term born fact model includ term refer easili largest posterior probabl made well 50 gener sampl use bmar tool perform stochast search variabl select come free perform analysi predict variabl select difficult problem one receiv much attent literatur bmar method could use similar way gibb samplingbas method outlin georg mcculloch 1993 shown identifi good model use stochast search procedur fig 3 4 tabl 3 present bayesian approach find regress surfac use truncat linear basi function build surfac use data find knot point main effect andor interact term number basi function requir adequ approxim requir surfac simul random sampl model use revers jump mcmc approach green 1995 bayesian approach multipl regress produc model high predict power due posterior averag model lead good overal fit data also help combat overfit problem howev choos singl model estim pick singl model sampl variou criteria model less predict power interpret easili produc anova decomposit produc expect number posterior probabl basi function posterior mean estim use identifi variabl import fit applic may wish draw coeffici use mean sampl distribut instead identifi good model predict main aim draw coeffici slightli quicker produc model smaller squar error may use relat bmar algorithm analys financi time seri denison 1997 failur time data mallick et al 1997 approach denison et al 1998a undertak find good cart model via stochast search exampl predict use posterior mean help structur algorithm allow sampler move fluidli probabl space mean bayesian mar inherit problem bayesian cart algorithm denison et al 1998a chipman et al 1998 search restrict portion entir space greatli help split current basi function thu induc hierarch structur form base point demonstr full chapter 5 denison 1997 space predictor variabl substanti 50 say converg sampler would seem unlik still bmar approach yield good model bmar algorithm use paper written ansi c avail togeth dataset world wide wed address httpmaicacukdgtd algorithm take around 5 minut run dec alpha workstat 200 datapoint acknowledg work first author support epsrc research stu dentship acknowledg help comment made anonym refere associ editor mr cc holm appendix move type chang birth death given algorithm section 23 undertaken similarli describ birth step pseudocodeth notat follow section 2 1 uniformli choos type basi function add n possibl one 2 uniformli choos knot posit predictor split sign indic new basi rememb predictor may occur basi function 3 gener u uniformli 01 4 work accept probabl ff 5 accept propos model els keep current model 6 return main algorithm r new languag estim optim transform multipl regress correl discuss classif regress tree depend ambient ozon solar radiat bayesian cart model search discuss smooth noisi data spline func tion simul base bayesian nonparametr regress method multivari adapt regress spline di cussion multidimension addit spline approxim project pursuit regress variabl select via gibb sam pling revers jump markov chain mont carlo comput bayesian model determin gener addit model mont carlo sampl method use markov chain applic bayesian wavelet network nonparametr regress regress model backpropag project pursuit learn ing bay factor gener linear model bayesian perpect equat state calcul fast comput machin problem analysi survey data propos bayesian analysi mixtur unknown number compon discuss automat smooth spline project pursuit markov chain explor posterior distribut discuss figur 2 hwang figur 4 linearpiecewis left cubicpiecewis right mar estim temperatur tr ctr c c holm b k mallick bayesian radial basi function variabl dimens neural comput v10 n5 p12171233 juli 1 1998 david j nott anthoni kuk hiep duc effici sampl scheme bayesian mar model mani predictor statist comput v15 n2 p93101 april 2005 christoph andrieu nando de freita arnaud doucet robust full bayesian learn radial basi network neural comput v13 n10 p23592407 octob 2001