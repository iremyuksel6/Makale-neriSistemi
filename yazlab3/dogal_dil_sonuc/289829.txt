stochast integr rule infinit region stochast integr rule deriv infinit integr interv gener rule develop siegel obrien siam j sci statist comput 6 1985 pp 169181 finit interv random orthogon transform rule integr surfac unit msphere use produc stochast rule integr two type rule combin produc stochast rule multidimension integr infinit region normal studentt weight exampl result present illustr effect new rule b introduct common problem appli scienc statist numer comput integr form statist applic function p may unnorm unimod posterior densiti function g function approxim expect valu need interest problem p approxim multivari normal nm sigma multivari studentt sigma case standard transform form determin possibl use numer optim point logp maxim sigma invers neg hessian matrix logp c lower triangular choleski factor sigma transform integr take form wjjxjjfxdx studentt approxim p good fx accept public siam journal scientif comput partial support nsf grant dms9211640 accur approxim low degre polynomi x motiv construct stochast multidimension polynomi integr rule integr type integr problem tradit handl use montecarlo algorithm see book davi rabinowitz 1984 recent paper evan swartz 1992 simpl montecarlo algorithm estim might use point x randomli chosen probabl densiti proport wjjxjj montecarlo algorithm import sampl algorithm origin problem estim eg often effect case result fx approxim constant algorithm low accuraci slow converg howev import featur simpl montecarlo algorithm avail practic robust error estim let oe e denot standard error sampl ff r gammaff dt new method describ consid refin montecarlo import sampl algorithm simpl montecarlo import sampl result exact whenev import modifi integrand constant method exact whenev import modifi integrand low degre polynomi method also provid robust error estim sampl standard error new onedimension integr rule develop gener rule deriv interv 11 weight siegel obrien 1985 work extend earlier work hammersley handscomb 1964 also consid construct stochast integr rule finit interv work also partli base work haber 1969 introduc word stochast gener montecarlo rule develop stochast multidimension integr rule requir addit chang variabl radialspher coordin system let z z z1 z 1wrr z z1 wrjrj numer approxim propos use product stochast integr rule radial interv gamma1 1 weight wrjrj mgamma1 stochast rule polynomi degre surfac unit msphere averag properli chosen sampl rule provid unbias estim standard error sampl use provid robust error estim estim develop partial motiv work deak 1990 use transform spheric coordin system combin random orthogon transform develop method comput multivari normal probabl consid use higher degre rule basic radial integr rule use combin symmetr sum hgammaae2 radial rule rh take form given point fae g weight fw g determin r polynomi degre 2n 1 point fae g randomli chosen r unbias estim fix point fae g select weight standard integr rule construct problem want degre rule suffici k odd integ equat automat satisfi r integr oper symmetr defin p h r p h r even degre lagrang interpol polynomi h follow standard interpol theori p h r weight fw g need make r degre integr even degre lagrang basi function follow theorem theorem 1 point fae g distinct nonneg real number weight fw g defin degre 2n describ choos point fae g r unbias estim h order accomplish need find joint probabl densiti function pae z 1z 1 integr h explicitli show conjectur gener form p n 3 let use fact thatz 1r case randomli densiti 2ae z 1cae2a z 1ae degre three rule h choos ae 0 randomli densiti 2ae m1 wae z 1r 3 ae 2ae m1 wae dae z 1ae z 1ae z 1ae m1 wae z 1ae degre five rule h choos ae 0 randomli joint densiti k determin condit 1 need show efr 5 h three term r 5 consid start first one find z 1z 1aeffi 0 second term find z 1z 1ae z 1z 1ae z 1ae z 1ae z 1z 1ae z 1z 1ae r 5 symmetr ae ffi last term r 5 also expect valu h2 shown efr 5 result section proposit 1 proposit 1 point fae g rule r 2n1 given 1 weight given 2 chosen probabl densiti proport ae m1 r unbias degre 2n prove 2 form probabl densiti n 2 conjectur natur gener siegel obrien theorem 51 1985 practic problem associ gener random ae densiti n 2 focu case 3 stochast spheric integr rule spheric surfac integr approxim averag random rotat appropri chosen rule spheric surfac let z integr rule approxim integr function sz surfac um unit msphere defin z z 1 q theta orthogon matrix also integr rule um furthermor polynomi degre sq sqz degre sz q chosen uniformli see stewart 1980 polynomi degre sq unbias random degre rule um mani choic could use consid rule given book stroud 1971 page 294296 review paper mysovskikh 1980 page 236237 rule combin radial rule degre 1 3 5 list simpl degre 1 rule surfac content um z point um simpl degre 3 rule 1 j th posit rule use 2m valu sz differ degre 3 rule mysovskikh 1980 j th vertex regular msimplex vertic um degre 3 rule 3 slightli expens use 3 lead effici gener degre 5 rule mysovskikh 1980 sgammay point j determin take midpoint edg msimplex vertic project midpoint onto surfac um valu sz degre five rule extend 3 stroud 1971 page 294 u j one point fulli symmetr set determin possibl permut sign chang coordin point r 2 4 stochast sphericalradi integr rule section combin stochast radial rule stochast spheric rule produc random rule mani way could done natur approach form stochast product rule sr qae f spheric surfac rule radial rule r rule take form r degre sr qae f also degre stroud 1971 theorem 231 q uniformli random orthogon matrix ae random chosen correct densiti r sr qae f unbias estim follow theorem theorem 2 ae random densiti given proposit 1 degre 2n1 q theta uniform random orthogon matrix wjjxjjfxdx whenev f degre 2n wjjxjjfxdx integr f give three exampl sr rule degre one rule construct 1 r 1 ae q unnecessari uniform random vector z um give unbias rule degre three rule construct 3 r 3 degre five rule construct 5 r 5 w w ae f sr 3 qae respect sampl one rule gener sampl averag use estim standard error sampl use provid error estim comparison purpos exampl section 6 use sr 0 f denot one point rule fz compon z chosen normal01 sr 0 f simpl montecarlo rule multivari normal weight 5 implement detail algorithm section focu integr form wjjxjjfxdx integr type determin explicit formula radial rule weight along explicit method gener random radial rule point also discuss multivari studentt weight first consid rule sr 1 ae case 2 therefor ae probabl densiti ae proport ae degre freedom standard statist procedur gener random ae densiti monahan 1987 standard procedur gener uniformli random vector z um consist first gener x compon x random normal01 set z xjjxjj howev combin procedur gener random vector aez must equival gener random z wjjzjj therefor need gener compon z random normal01 simpler procedur propos follow algorithm random degre one rule degre one sphericalradi rule integr algorithm 1 input ffl f nmax 2 3 repeat b gener random x x normal01 c 4 output oe v n input ffl error toler input nmax provid limit time algorithm output oe e standard error integr estim algorithm comput v use modifi version stabl onepass algorithm chan lewi 1979 unscal sampl standard error oe e usual error bound approxim 68 certainti user algorithm desir higher degre confid scale oe e appropri exampl scale factor 2 increas certainti level approxim 95 error estim obtain scale oe e algorithm algorithm section use caution low n valu error estim base use central limit theorem infer sampl averag sr approxim normal care implement algorithm section could includ nmin paramet andor use larger scale factor oe e small n valu larg n scale oe e provid robust statist sound error estim long multivari normal model adequ repres tail posterior densiti posterior densiti thicker tail often effici reliabl handl use multivari studentt model one techniqu monitor discuss monahan genz 1996 consid studentt weight see densiti ae proport r chang variabl show proport beta see devroy 1986 gener method random ae uniformli random vector z um need sr 1 easili gener also show ju jt formula formula multivari normal case make appropri chang line 3b 3c previou algorithm modifi algorithm could produc next consid rule sr 3 qae integr part therefor probabl densiti ae proport ae m1 e gammaa 2 2 chi densiti m2 degre freedom propos follow algorithm stochast degre three rule degre three sphericalradi rule integr algorithm 1 input ffl f nmax 2 3 repeat b gener uniformli random orthogon theta matrix q c gener random ae chim 4 output oe v n random orthogon matric q gener use product appropri chosen random reflect see stewart 1980 method discuss devroy 1986 p 607 consid studentt weight case integr part show therefor requir 2 case sr 3 becom analysi show r m1 proport beta m2 densiti random ae sr 3 easili gener make appropri chang line 3c 3e previou algorithm modifi algorithm could produc final consid rule qae weight littl algebra show order develop algorithm qae need set regular msimplex unit vertic g use set given stroud 1971 page 345 correct minor misprint v joint probabl densiti ae ffi proport aeffi m1 e gammaa 2 standard probabl densiti transform standard densiti consid integr make chang variabl r 2 final let sin sin z 1p function q m1 proport standard betam densiti first inner integr result ae ffi second ae ffi case equal like sr 5 symmetr ae ffi loss gener alway use ae ffi therefor choos r chi2m q betam densiti distribut joint probabl densiti proport aeffi m1 e gammaa 2 note chang variabl could also use provid practic method gener correspond ae ffi siegel obrien 1985 finit interv rule question address paper propos follow algorithm stochast degre five rule degre five sphericalradi rule integr algorithm 1 input ffl f nmax 2 comput msimplex vertic fv j g 3 repeat b gener uniformli random orthogon theta matrix q set fv j g c gener random r chi2m set ffl 4 output oe v n consid studentt weight shown gamma2 gamma4 0 must 4 case could also produc formula sr 5 howev found easi method gener random ae ffi need r 5 consid anyway larg gamma rule alreadi develop multivari normal weight effect possibl signific overhead cost sr 3 sr 5 rule gener random orthogon matric use algorithm given stewart 1980 shown cost gener one matrix q approxim 4m 3 3 float point oper flop plu cost gener 2 2 normal01 random number sr 3 rule column q use evalu point 2m integrand valu overhead cost per integrand valu 2m 2 3 flop plu cost gener m4 normal01 random number integrand evalu point avail expect cost evalu integrand least om compon input variabl integrand howev applic problem statist posterior densiti often complic express made combin standard elementari function evalu use input variabl compon combin problem data see second exampl next section therefor om integrand evalu cost measur flop expect constant om larg 2m 2 3 flop gener evalu point integrand evalu signific unless larg sr 5 rule q overhead cost per evalu point drop approxim 2m3 flop plu cost m4 normal variat signific compar integrand evalu cost typic statist integr problem also note need m2 respect rule sr 1 sr 0 per integrand evalu normal variat overhead higher two lowest degre rule overal except simpl integrand larg valu expect overhead cost four rule signific compar integrand evalu cost 6 exampl begin simpl exampl follow tabl result obtain use sr rule tabl test result sr rule valu oe e oe e oe e oe e 1000 result expect much smaller standard error higher degre rule second exampl use seven dimension proport hazard model problem discuss dellaporta wright 1991 1992 posterior densiti given aet first transform ae use x loga model p multivari normal approxim use comput mode c loga logp ad scale constant e 20719 prevent problem underflow follow tabl show result use sr rule approxim 2 expect vale integr variabl constant tabl normal constant respect sr rule use comput valu tabl 2 test result sr rule 120000 f 2 valu integrand oe e oe e oe e oe e exampl sr 3 sr 5 rule result standard error smaller sr 0 sr 1 rule standard error factor averag one half decreas standard error invers proport squar root number sampl approxim four time much integrand evalu work would need problem use sr 0 sr 1 rule obtain error compar error sr 3 sr 5 rule result good previou problem higher degre sr rule still approxim four time effici lower degre rule degre five rule better degre three rule problem standard transform problem appar close enough multivari normal rule degre higher three produc better result find signific differ run time need four algorithm result tabl 2 support analysi rel import overhead cost differ rule two exampl section meant illustr use algorithm given paper much extens test need order care compar algorithm method avail numer integr problem appli statist test work recent done method refer interest reader paper monahan genz 1996 test work still progress 7 conclud remark shown deriv low degre stochast integr rule radial integr normal studentt weight function also shown new rule combin stochast rule surfac sphere provid stochast rule infinit multivari region multivari normal studentt weight function result exampl suggest averag sampl rule provid accur integr estim simpler montecarlo import sampl method standard error sampl provid robust error estim new rule r comput standard deviat accuraci method numer integr posit imbed integr bayesian analysi numer integr strategi bayesian analysi numer quadratur cubatur integr strategi problem statist infer comput scienc statist 24 mont carlo method stochast quadratur formula continu univari distributionsi algorithm gener chi random variabl comparison omnibu method bayesian comput approxim multipl integr use interpolatori cubatur formula unbias mont carlo integr method exact low order polynomi effici gener random orthogon matric applic condit estim approxim calcul multipl integr tr