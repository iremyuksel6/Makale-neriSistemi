constraint precondit indefinit linear system problem find good precondition numer solut indefinit linear system consid special emphasi put precondition 2 2 block structur incorpor 12 21 block origin matrix result concern spectrum form eigenvector precondit matrix minimum polynomi given consequ result consid varieti krylov subspac method numer experi valid conclus b introduct paper concern investig new class precondition indefinit system linear equat sort aris constrain optim well leastsquar saddlepoint stoke problem attempt solv indefinit linear system 2 ir nthetan symmetr b 2 ir mthetan throughout paper shall assum n nonsingular case b must full rank exampl 1 consid problem minim function n variabl subject linear equal constraint variabl ie minim subject finit solut 12 stationari point lagrangian function refer lagrangian multipli differenti l respect x solut 12 readili seen satisfi linear equat form 11 x applic known karushkuhntuck kkt condit 2 exampl 2 stoke problem stoke equat compact form defin div discretis equat 13 togeth boundari condit defin linear system equat form 11 b carsten keller nick gould andi wathen among import iter method current avail krylov subspac method appli techniqu involv orthogon project onto subspac form common scheme use idea method conjug gradient cg symmetr posit definit matric method minimum residu minr symmetr possibl indefinit matric generalis minimum residu method gmre unsymmetr matric although mani method availablese exampl greenbaum 12 one common featur method solut linear system 11 found within n iter exact arithmeticse joubert manteuffel 14 p 152 larg possibl spars linear system upper limit number iter often practic idea precondit attempt improv spectral properti ie cluster eigenvalu total number iter requir solv system within toler decreas substanti paper specif concern nonsingular precondition form nthetan approxim inclus exact represent 1 2 2 1 matrix block precondition often associ constraint see exampl 1 lead one hope favour distribut eigenvalu leftprecondit linear system sinc block unchang origin system shall call g constraint precondition precondition form g recent use luksan vlcek 16 context constrain nonlinear program problemsse also coleman 4 polyak 18 gould et al 11 deriv argument confirm extend result 16 highlight favour featur precondition form g note golub wathen 10 recent consid symmetr precondition form 14 problem form 11 nonsymmetr section 2 determin eigensolut distribut precondit system give lower upper bound eigenvalu g gamma1 constraint precondit 3 case submatrix g posit definit section 3 describ converg behaviour krylov subspac method gmre section 4 investig possibl implement strategi section 5 give numer result support theori develop paper precondit symmetr gener normal matrix system converg applic iter method determin distribut eigenvalu coeffici matrix particular desir number distinct eigenvalu least number cluster small case converg rapid precis distinct eigenvalu optim method like cg minr gmre termin exact arithmet small precis defin number step prove result type nonnorm system converg oppos termin readili describedse greenbaum 12 p 5 21 eigenvalu distribut eigenvalu precondit coeffici matrix g gamma1 may deriv consid gener eigenvalu problem x x z orthogon factoris b nthetam z 2 ir nthetangammam basi nullspac b premultipli 26 nonsingular squar matrix6 6 4 postmultipli transpos gives6 6 4 x z x x z x made use equal perform simultan sequenc row column inter 4 carsten keller nick gould andi wathen chang matric 27 reveal two lower blocktriangular matric thu precondit coeffici matrix g gamma1 similar theta z gz precis form theta upsilon gamma irrelev argument gener nonzero prove follow theorem theorem 21 let 2 ir nmthetanm symmetr indefinit matrix form 2 ir nthetan symmetr b 2 ir mthetan full rank assum z n theta n gamma basi nullspac b precondit matrix form nthetan symmetr g 6 b 2 ir mthetan impli matrix g gamma1 1 eigenvalu 1 multipl 2m eigenvalu defin generalis eigenvalu problem z azx note indefinit constrain precondition appli indefinit linear system 11 yield precondit matrix p real eigenvalu remark 1 argument assum b full row rank consequ appli orthogon factoris b result constraint precondit 5 upper triangular matrix r 2 ir mthetam b full row rank ie row column delet matric 27 thu give reduc system dimens remov redund inform impos restrict propos precondition sinc mathemat argument equival appli reduc system equat 22 eigenvector distribut mention termin krylov subspac method relat locat eigenvalu number correspond linearli independ eigenvector order establish associ eigenvector eigenvalu expand gener eigenvalu problem 27 yield 211 may deduc either former case equat 29 210 simplifi consequ written z z sinc q orthogon gener eigenvalu problem 212 equival consid w 6 0 oe 1 linearli independ eigenvector correspond linearli independ eigenvector correspond eigenvalu suppos 6 1 case x equat 29 210 yield 6 carsten keller nick gould andi wathen gener eigenvalu problem 214 defin equal 1 two case distinguish x z 6 0 must satisfi follow correspond eigenvector defin x deduc 215 henc z x 0 case extra eigenvector aris summaris evid p show realist assumpt eigenvector fact linearli independ theorem 22 let 2 ir nmthetanm symmetr indefinit matrix form 2 ir nthetan symmetr b 2 ir mthetan full rank assum precondition g defin matrix form nthetan symmetr g 6 b 2 ir mthetan let z denot n theta n gamma basi nullspac b suppos z gz posit definit precondit matrix g gamma1 nm eigenvalu defin theorem 21 linearli independ eigenvector eigenvector form correspond case constraint precondit 7 eigenvector form z x aris z linearli independ eigenvector form correspond case 6 1 proof prove eigenvector p linearli independ need show 1 1a 1 x z 2 2 x 2 2 2 2a 2 x z 3 3a 3 impli vector zero vector multipli g gamma1 recal previou equat first matrix aris case second matrix case last matrix aris k 1 1a 1 x z 2 2 x 2 2 2 2a 2 x z 3 3a 3 subtract equat 216 217 obtain6 6 4 x z 3 3a 3 8 carsten keller nick gould andi wathen simplifi to6 6 4 x z 3 3a 3 sinc k assumpt z gz posit definit impli x z 218 linearli independ thu 3 similarli 2 follow linear independ x z 2 x 2 thu 216 simplifi to6 6 4 1 1a 1 1 linearli independ thu 1 remark 2 note result theorem 22 remain true z fla posit definit scalar fl oese parlett 17 p 343 detail show eigenvector bound theorem 22 fact attain consid follow two exampl exampl 3 minimum bound consid matric 2 precondit matrix p eigenvalu 1 multipl 3 one eigenvector aris case 1 theorem 22 eigenvector may taken 2 exampl 4 maximum bound let 2 ir 3theta3 defin exampl 3 assum precondit matrix p eigenvalu 1 multipl 3 clearli complet set eigenvector may taken constraint precondit 9 23 eigenvalu bound appar calcul previou section eigenvalu 1 multipl 2m independ choic g precondition contrari eigenvalu defin 214 highli sensit choic g g close approxim expect favour distribut eigenvalu consequ may expect faster converg appropri iter method order determin good factoris help find interv locat g posit definit matrix one possibl approach provid cauchi interlac theorem theorem 23 cauchi interlac theorem see 17 theorem 1011 suppos nthetan symmetr label eigenpair h proof see parlett 17 p 203 2 applic theorem 23 verifi recal definit q z given previou section consid generalis eigenvalu problem carsten keller nick gould andi wathen sinc g posit definit q gq may therefor write rr rewrit 220 give sinc matrix gamma1 q aqm gammat similar g defin eigenvalu ff may therefor appli theorem 23 directli result particular bound extrem eigenvalu g gamma1 necessarili cluster g good approxim furthermor good precondition g impli z gz least good precondition z az show precondition z gz fact much better consid follow exampl taken cute collect 3 exampl 5 consid convex quadrat program problem bloweyc may formul subject z select size paramet 500 discretis interv defin set linear equat form 11 let g diagon may deduc theori extrem eigenvalu g gamma1 give lower upper bound defin gener eigenvalu problem 214 figur 21 1002 eigenvalu g gamma1 drawn vertic line wherea figur 21 b display 500 eigenvalu z gz spectrum figur 21 equival graph entir spectrum p eigenvalu 1 multipl 502 remov round two decim place numer valu two extrem eigenvalu g gamma1 constraint precondit 11 04 size eigenvalu eigenvalu g gamma1 04 size eigenvalu b eigenvalu z gz figur 21 continu vertic line repres eigenvalu g gamma1 002 198 wherea extrem eigenvalu z gz given 071 1 note exampl larg number eigenvalu cluster approxim interv 002 038 165 197 eigenvalu distribut figur 21 b reveal one eigenvalu near 071 group eigenvalu near 1 follow appropri iter method solv 15 expect converg small number step verifi numer result present section 5it readili seen exampl 5 case bound provid theorem 23 descript significantli cluster eigenvalu impli theorem converg context paper converg iter method precondit influenc spectral properti coeffici matrix also relationship dimens n par ticular follow theorem 21 special case precondit linear system 15 one eigenvalu 1 multipl 2n give eigenvalu 1 multipl 2m gener distinct eigenvalu whose valu may may equal 1 examin result determin upper bound number 12 carsten keller nick gould andi wathen iter appropri krylov subspac method recal definit minimum polynomi matrix definit 1 let 2 ir nmthetanm monic polynomi f minimum degre call minimum polynomi import definit becom appar consid subsequ result recal similar matric minimum polynomi krylov subspac theori state iter method optim properti gmre termin degre minimum polynomi attainedse axelsson 1 p 463 precis number may less special case b combin eigenvector affect grade respect b particular degre minimum polynomi equal dimens correspond krylov subspac gener b follow theorem relev theorem 31 let 2 ir nmthetanm symmetr indefinit matrix form 2 ir nthetan symmetr b 2 ir mthetan full rank let precondit matrix form g 2 ir nthetan g 6 b 2 ir mthetan krylov subspac kp b dimens 2 b proof write precondit system 28 explicit form observ p fact given 0 upsilon upsilon nonzero 6 g show dimens correspond krylov subspac 2 need determin minimum polynomi system evid 323 constraint precondit 13 eigenvalu p 1 minimum polynomi order 2 2 remark 3 cours possibl case solv squar constrain equat bx obtain x give motiv result theorem 31 independ g remark 4 import consequ theorem 31 termin iter method gmre occur 2 step choic b even though precondit matrix diagonalis unless theorem 32 let 2 ir nmthetanm symmetr indefinit matrix form 2 ir nthetan symmetr b 2 ir mthetan full rank assum n nonsingular furthermor assum precondit matrix form nthetan symmetr g 6 b 2 ir mthetan z gz posit definit z n theta n gamma basi nullspac b dimens krylov subspac kp b n gamma 2 proof eigenvalu deriv section 21 evid characterist polynomi precondit linear system 15 prove upper bound dimens krylov subspac need show order minimum polynomi less equal 2 14 carsten keller nick gould andi wathen expand polynomi obtain matrix form6 6 4 psi ngammam defin recurs formula theta base case psi note 2 1 2 2 3 2 entri matrix 324 fact zero sinc eigenvalu similar symmetr matrix thu diagonalis thu 324 may written 2 remain distinguish two differ case valu phi ngammam phi former case order minimum polynomi p less equal thu dimens krylov subspac kp b order latter case dimens kp b less equal n gamma 2 sinc multipl 325 anoth factor p gamma give zero matrix upper bound dimens krylov subspac state theorem 32 reduc special case z repeat eigenvalu result state theorem 33 follow ran domli gener exampl show bound theorem 32 attain exampl 6 let 2 ir 6theta6 b 2 ir 6theta2 given 269 162 116 160 081 gamma197 162 623 gamma190 189 090 005 081 090 gamma016 001 194 038 constraint precondit 15 assum diaga matric 3 1 entri 325 gamma022 gamma002 follow minimum polynomi order 6 thu bound given theorem 32 sharp 2 theorem 33 let 2 ir nmthetanm symmetr indefinit matrix form 2 ir nthetan symmetr b 2 ir mthetan full rank assum nonsingular precondit matrix nthetan symmetr g 6 b 2 ir mthetan furthermor let z n theta n gamma basi nullspac b assum z gz distinct eigenvalu respect multipl dimens krylov subspac kp b k 2 proof proof similar one theorem 32 case z distinct eigenvalu multipl may without loss gener write characterist polynomi p expand obtain matrix6 6 4 carsten keller nick gould andi wathen psi k given recurs formula theta base case psi note 2 1 2 2 3 2 block matrix 326 fact zero follow phi k 6 0 multipl 326 zero matrix thu dimens krylov subspac kp b less equal k 2 2 verifi bound theorem 33 attain consid follow exampl exampl 7 let 2 ir 4theta4 g 2 ir 4theta4 b 2 ir 4theta1 given two eigenvalu defin generalis eigenvalu problem 214 distinct given 2 4 follow 3 1 entri 326 nonzero minimum polynomi order 4 2 implement variou strategi use implement propos pre condition two use numer result section 5 first strategi appli standard precondit gmre algorithm 20 precondition step implement mean symmetr indefinit factoris 14 factoris precondition may much less demand factoris initi coeffici matrix g consider simpler matrix second approach discuss next section base algorithm solv reduc linear system constraint precondit 17 41 conjug gradient reduc linear system 11 gould et al propos conjug gradient like algorithm solv equal constrain quadrat program problem one describ exampl 1 algorithm base idea comput implicit basi z span nullspac b nullspac basi use remov constraint system equat thu allow applic conjug gradient method posit definit reduc system assum w gz symmetr posit definit precondition matrix dimens n gamma theta n gamma z n theta n gamma matrix algorithm state follow algorithm 41 precondit cg reduc system 1 choos initi point x satisfi 2 comput gammag 3 repeat follow step x comput precondit residu 429 often expens comput factor algorithm gould et al suggest avoid explicit use nullspac z instead comput g appli carsten keller nick gould andi wathen symmetr indefinit factoris r practic 430 often factor effici use ma27 packag harwel subroutin librari g simpl matrix block wherea direct applic ma27 origin system 11 limit space requir well time larg enough system 6 context factoris consist three separ routin first two analys factoris matrix 430 need execut step 1 algorithm 41 repeat call third routin within ma27 appli forward backwardsubstitut find initi point x step 1 solv g 427 also find g 429 remark 5 comput project residu g often accompani signific roundoff error vector much smaller residu iter refin use 428 redefin r norm closer g result dramat reduct roundoff error project operationse gould et al 11 5 numer result present result numer experi reinforc analysi given previou section test problem use partli randomis spars matric tabl 51 partli matric aris linear nonlinear optim tabl 52see bongartz et al 3 indic matric form 2 ir nthetan symmetr b 2 ir mthetan full rank n four differ approach find solut 11 comparedthre iter algorithm base krylov subspac direct solver ma27 appli spars variant gaussian eliminationse duff reid 6 investig possibl favour aspect precondit make sens compar unprecondit precondit solut strategi indefinit natur matrix 531 suggest use minr unprecondit case outlin section 4 employ two slightli differ strategi order implement precondition g first method appli standard full gmresa code pgmre tabl 51 52 constraint precondit 19 mathemat equival minresa symmetr matric wherea second approach implement algorithm 41 rcg tabl 51 52 low choic precondition made pgmre rcg random random ii random iii random iv nonzero entri 2316 9740 39948 39948 nonzero entri b 427 1871 3600 686 minr iter 174 387 639 515 time second 04 31 175 131 pgmre iter 46 87 228 242 time second 02 39 960 1089 rcg iter 36 67 197 216 time second 01 10 59 59 time second 01 09 54 29 tabl 51 random test problem test perform sun ultra sparcii300mhz ultra30 workstat 245 mb physic ram run suno releas 551 program written standard fortran 77 use sun workshop f77 compil version 42 0 optim flag set order deal larg spars matric implement index storag format store nonzero matrix elementsse press et al 19 termin criterion iter method taken residu vector order less 10 gamma6 2norm part analysi procedur ma27 accept pattern coeffici matrix choos pivot factoris solut phase subsequ routin amount pivot control special paramet modifi u within posit rang influenc accuraci result solut wherea neg valu prevent pivotingse duff reid 6 context earli construct test exampl default valu accompani difficulti form memori limit met tradeoff less use memori solut high enough accuraci choos paramet valu tabl 51 52 time measur eight test exampl indic itera carsten keller nick gould andi wathen nonzero entri 3004 672 1020 13525 nonzero entri b 2503 295 148 50284 minr iter 363 converg 51 180 time second 18 converg 01 142 pmgrem iter time second 06 01 02 132 rcg iter time second 06 01 02 162 time second 05 01 01 156 tabl 52 cute test problem tion count three propos iter method compar far oper count ie work concern numer result suggest inclus 1 2 2 1 block precondition togeth result consider reduct iter appropri bound theorem 31 32 33 attain case specif theorem 31 appli context problem cvxqp1 test problem random iii random iv tabl 51 emphasis storag problem associ use long recurr pgmre algorithm time requir find solut random iii random iv via pgmre algorithm compar method due increas storag requir data traffick involv solut memori problem restart pgmre prescrib number iter iter count restart would compar full pgmre relev time measur ma27 comment next section 6 conclus paper investig new class precondition indefinit linear system incorpor 2 1 2 2 block origin matrix block often associ constraint numer result use simpl diagon matrix g approxim 1 1 block constraint precondit 21 even though approxim incomplet factoris possibl first show inclus constraint precondition cluster least 2m eigenvalu 1 regardless structur g howev unless g repres exactli p complet set linearli independ eigenvector thu standard converg theori krylov subspac method readili applic find upper bound number iter requir solv linear system form 11 mean appropri subspac method use minimum polynomi argument theorem 31 consid special condit case termin guarante two iter theorem 32 give gener sharp upper bound dimens krylov subspac wherea theorem 33 defin consider stronger result defin z gz repeat special case g posit definit matrix block abl appli cauchi interlac theorem order give upper lower bound eigenvalu defin 2 2 block matrix 28 confirm analyt result paper use three differ subspac method minr paig saunder unprecondit matrix system rcg gould et al also pgmre saad schultz precondit case overal result show number iter decreas substanti precondit appli krylov subspac built execut two preconditon implement theori equal dimens eight test exampl thu pgmre rcg expect termin number step howev converg prescrib toler may occur differ number step sinc pgmre rcg minim differ quantiti seen exampl nevertheless note converg method attain much earlier suggest bound theorem 31 32 33 time measur ma27 last section suggest precondit conjug gradient algorithm discuss section 41 suitabl altern direct solver wherea minr especi pgm re consider slower ma27 time rcg virtual case compar problem larg enough dimens bandwidth resourc requir ma27 must becom prohibit case rcg becom even competit 22 carsten keller nick gould andi wathen acknowledg author would like thank gene h golub insight comment process work r cambridg univers press cute constrain unconstrain test environ linearli constrain optim project precondit conjug gradient direct method spars matric multifront solut indefinit spars symmetr linear equat perturb eigenvalu precondit navierstok oper polynomi base iter method symmetr linear system matrix comput iter indefinit system applic navierstok equat solut equal constrain quadrat program problem aris optimiza tion iter method solv linear system iter method nonsymmetr linear system iter method linear nonlinear equat symmetr eigenvalu problem numer recip fortran art scientif comput gmre generalis minim residu algorithm solv nonsymmetr linear system tr ctr joosiong chai kimchuan toh precondit iter solut symmetr indefinit linear system aris interior point method linear program comput optim applic v36 n23 p221247 april 2007 luca bergamaschi jacek gondzio manolo venturin giovanni zilli inexact constraint precondition linear system aris interior point method comput optim applic v36 n23 p137147 april 2007 z dostl optim algorithm class equal constrain quadrat program problem bound spectrum comput optim applic v38 n1 p4759 septemb 2007 h dollar n gould w h schilder j wathen use constraint precondition regular saddlepoint problem comput optim applic v36 n23 p249270 april 2007 luca bergamaschi jacek gondzio giovanni zilli precondit indefinit system interior point method optim comput optim applic v28 n2 p149171 juli 2004 cafieri dapuzzo v simon serafino stop criteria inner iter inexact potenti reduct method comput studi comput optim applic v36 n23 p165193 april 2007 bocanegra f f campo r oliveira use hybrid precondition solv largescal linear system aris interior point method comput optim applic v36 n23 p149164 april 2007 cafieri dapuzzo v simon serafino iter solut kkt system potenti reduct softwar largescal quadrat problem comput optim applic v38 n1 p2745 septemb 2007 silvia bonettini emanuel galligani valeria ruggiero inner solver interior point method larg scale nonlinear program comput optim applic v37 n1 p134 may 2007