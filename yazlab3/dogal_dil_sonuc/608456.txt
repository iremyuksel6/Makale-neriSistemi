statist approach case base reason applic breast cancer data given larg set problem individu solut case base reason seek solv new problem refer solut problem similar new problem crucial case base reason decis problem close match given new problem new method propos decid question basic idea defin famili distanc function use distanc function paramet local averag regress estim final result distanc function chosen result estim optim respect certain error measur use regress estim method illustr simul appli breast cancer data b introduct assum one interest solut problem latter describ number observ variabl necessari variabl determin solut complet assum correl observ variabl solut furthermor assum list problem type avail valu observ variabl solut known instead categori problemsolut one may also think premiseconclus causeeffect current statefin result concret health conditionobserv surviv time case base reason seek solv new problem refer solut problem similar new problem basic assumpt solut problem data base similar new problem close unknown solut new problem differ rule base reason knowledg repres rule rather data base built previou experi phrase case base reason rule base reason coin field artifici intellig see eg menachem kolodn 1992 crucial case base reason decis case close match given new case articl propos new method decid question basic idea defin famili distanc function use distanc function paramet local averag regress estim final outcom choos distanc function result estim optim respect certain error measur use regress estim articl appli case base reason context predict surviv time breast cancer patient treat differ therapi therapi list case given includ observ surviv time variabl describ case exampl latter size primari tumor number affect lymph node menopaus statu categori variabl part tumor classif system tnm list one select case similar given new case physician tri gain inform appropri therapi new patient consid therapi final result statist approach case base reason 3 case naiv approach decid case close match new case use case valu variabl new case unfortun number observ variabl larg usual none case therefor naiv approach gener use anoth approach use context predict surviv time breast cancer patient mariuzzi et al 1997 rang observ variabl divid four quartil valu variabl code 1 2 3 4 accord quartil belong distanc observ variabl x 1 code l defin l case chosen respect distanc function close new case main drawback distanc reflect possibl differ influenc individu variabl final result instanc valu x 1 might influenc surviv time much valu x 2 articl propos new method determin case data base close match new case section 2 give short introduct nonparametr regress propos method describ detail section 3 illustr simul data section 4 appli breast cancer data section 5 2 nonparametr regress independ ident distribut random variabl x r valu realvalu ey 2 1 regress analysi one want predict observ x ie one want find function r r x close close measur mean squar error one interest function 4 j dippon et al minim socal l 2 risk efjm introduc regress function xg arbitrari measur function r one z denot distribut x therefor l 2 risk arbitrari function f close optim valu squar l 2 error optim predictor depend distribut x applic distribut usual unknown thu unknown often possibl observ independ copi base data nonparametr regress problem ask estim mn l 2 error r jmn 21 local averag estim respons variabl rewritten 0 henc one consid sum function evalu x random error zero mean motiv construct estim mx averag x close x hope mx close mx averag ffl close zero local averag estim repres nonneg weight sum one statist approach case base reason 5 popular local averag estim nadarayawatson kernel estim nadaraya 1964 watson 1964 weight hn hn r socal kernel function socal bandwidth hn often one use spheric symmetr kernel k satisfi univari kernel function r r denot k jxj euclidean norm x kernel function one get hn hn usual kernel function chosen k0 0 socal naiv kernel use mx estim averag x ball radiu h 1 center x gener k r r eg gaussian kernel one use weight averag estim mx weight given close x 22 choic bandwidth choic bandwidth hn crucial kernel estim compon hn small weight close zero estim determin induc high varianc estim hand compon hn big far away x big weight x far away x even smooth mx might far away mx induc larg error estim 6 j dippon et al qualiti estim import appli method choos hn close optim valu depend usual unknown distribut x use data dn well known method tri crossvalid describ sequel inform see hardl 1990 eg recal aim nonparametr regress construct mn l 2 risk small bandwidth kernel estim chosen 2 minim compar choic bandwidth applic possibl 2 depend unknown distribut x propos estim l 2 risk 2 choos bandwidth minim estim l 2 risk fix function f r r l 2 risk estim socal empir use 3 depend dn estim 2 socal resubstitut estim optimist estim l 2 risk minim lead estim well adapt dn suitabl predict new data independ dn avoid split data dn two part learn test data comput kernel estim learn data choos bandwidth empir risk test data minim result bandwidth depend way data split drawback one want use bandwidth kernel estim use whole data dn thu noth way data split avoid repeat procedur sever eg randomli chosen split sampl choos bandwidth averag empir l 2 risk test data minim kfold crossvalid split chosen special determinist way let 1 k n notat simplic assum n k integ divid data k group equal statist approach case base reason 7 size n k denot set consist group except lth one nl data set nl bandwidth h 2 r construct kernel estim mngamma n h x nl k l1ng k k l1ng k choos bandwidth thatk l1n l minim use bandwidth h bandwidth hn kernel estim 1 nfold crossvalid denot crossvalid case nl whole sampl minim respect h 23 curs dimension larg estim regress function especi difficult reason case gener possibl dens pack space x finit mani sampl point even sampl size n larg fact often refer curs dimension phrase due bellman 1961 illustr exampl exampl found friedman 1994 independ ident distribut r valu random variabl x uniformli distribut hypercub 0 1 consid expect supremum norm distanc x closest neighbor x 1 ae min oe kx ae min oe 8 j dippon et al thu z 1p ae min oe instanc d1 10 1000 022 d1 20 10000 028 thu larg even larg sampl size n supremum norm distanc x closest neighbor sampl close zero observ supremum norm distanc two point sampl alway less equal one 3 basic idea section appli concept nonparametr regress introduc previou section case base reason consid predict final result case base reason regress estim problem henc assum final result real valu random variabl observ variabl compon r valu random variabl applic often observ variabl categor random variabl handl variabl describ section 5 recal aim case base reason determin case given list close match new case done defin distanc function determin distanc dx x two case observ variabl x x given distanc function one defin k similar case new case k case among whose distanc new case x belong k smallest occur distanc basic idea determin distanc function defin regress estim depend distanc function choos distanc function minim estim l 2 risk result regress estim regress estim use kernel estim introduc previou section defin distanc function dh r theta r r dh statist approach case base reason 9 kernel estim written famili distanc function psi correspond famili regres estim kernel function simul section 4 applic section 5 use gaussian kernel aim choos distanc function correspond regress estim minim l 2 risk alreadi explain previou section possibl l 2 risk depend unknown distribut x instead estim l 2 risk crossvalid choos distanc function dh h 2 r estim l 2 risk nh minim method summar follow estim l 2 risk kernel estim nh crossvalid determin h 2 r estim l 2 risk minim compar choic h 2 r use correspond distanc function dh 31 subset select seen previou section estim regress function difficult dimens x larg problem occur everi estim henc kernel estim use paper well way handl problem make assumpt underli distibut eg assum regress function addit cf stone 1985 stone 1994 paper assum even larg say 20 regress function mainli depend say 3 6 compon x assumpt hold distanc function determin appli method small subset observ variabl lead regress estim problem small dimens x cours applic know observ variabl regress function mainli depend order check consid big small subset observ variabl appli method subset choos subset via crossvalid estim l 2 risk optim estim minim j dippon et al 32 simplif comput subset observ variabl variabl subset method describ requir comput vector scale factor lead multivari minim problem order avoid solv mani minim problem use follow simplif first step determin observ variabl univari scale n comput describ optim bandwidth univari kernel estim fit data x yield scale factor h 1 second step choos subset fi g dg distanc function h r via crossvalid estim l 2 risk minim respect h 2 r final choos subset fi g via crossvalid estim l 2 risk correspond optim kernel estim minim observ minim estim l 2 risk nh h 2 r univari minim problem 33 robustif bandwidth estim well known bandwidth select crossvalid often highli variabl see simonoff 1996 author suggest altern plugin method claim superior ordinari crossvalid loader argu theoret result support claim plugin method depend sensit pilot estim bandwidth see ch 10 loader 1999 let nh kernel estim bandwith h order robustifi crossvalid bandwidth select given statist approach case base reason 11 cv function cvh defin 4 suggest follow heurist rule specifi idea behind rule follow often graph cv function resembl valley possibl sever local minima bottom flat bottom posit global minimum seem accident estim middl valley appear less variabl measur choos two paramet defin level r pq depend regress estim equal mean respons fy coincid empir varianc 1 yng simul first use choic might happen r pq sup hh0 cvh order avoid set r pq cvh valu p q use paper robustif impli possibl dispens explain fraction empir varianc fy g doesnt seem harm sinc interest find similar neighborhood predict j dippon et al 4 applic simul data 41 simul model let us consid defin 2 0 1 fix constant model independ random variabl x u 0 1 appar third compon x 3 influenc small first compon x 1 random vector x larger influenc respons second compon x 2 word small constant regress function almost constant respect x 2 case constant respect x 3 figur 1 simul realiz x independ copi x describ subsect 32 33 2 f1 2 3g robustifi estim e h 0 optim bandwidth h 0 univari kernel estim base sampl comput crossvalid significantli less 1 expect relat 1 furthermor correspond estim l 2 risk ascend order figur 2 model select procedur defin differ distanc function 0 1 3 given 5 distanc function comput minim estim l 2 risk multivari kernel estim 6 respect h 0 consid distanc function best estim l 2 risk minim inclus compon reduc estim l 2 risk slightli distanc function smaller set compon slightli larger correspond estim l 2 risk prefer use result distanc function defin neighborhood statist approach case base reason 1302061 compon 1 x02061 compon 2 x fig 1 graph regress function consid function first two compon predictor variabl x scatter plot simul realiz x ffi 0 consid everi point n x ffi similar x everi point outsid n x ffi sens realiz x k similar one x whose distanc belong k smallest among 42 result simul pair n paramet 2 f03 05 1g n 2 f100 200g simul repeat 20 time differ seed gener produc pseudo random number discuss result simul perform paramet set n 05 100 detail suggest section 3 comput bandwidth e h 1 0 one twenti run procedur found 0 case cv curv univari regress estim correspond minim valu cv curv look 14 j dippon et al figur 2 furthermor optim valu h iand robustifi valu e h idiff slightli howev case situat appear figur 3 smooth relat e h iseem appropri one twenti run method fail detect first compon stronger influenc function valu second compon see figur 4 compar multivari kernel estim 6 distanc function select differ subset predict variabl comput minimum cvh 0 estim cvh given 4 l 2 risk 6 compar ratio cvh 0 cv1 tabl 1 show run subset select procedur favor fx 1 x 2 g fx 1 g case prefer gain small signific henc 20 run choos subset fx 1 x 2 g relat e h 1 determin geometri neighborhood use character similar case paramet pair n 05 100 ratio comput bandwidth e h 1 turn 2 016 054 045 060 050 023 057 034 076 second row tabl 2 one extract minimum maximum median interquartil rang ratio visual variabl result distanc function neighborhood project first two compon plot around center 05 paramet chosen way area set equal 110 see figur 5 compar result sampl size indic larger sampl size lead less variabl neighborhood statist approach case base reason 15 compon 2 fig 2 determin univari bandwidth e h 1 e h 2 e h 3for 6th simul run left column crossvalid l2 risk regress estim ey jx depend bandwidth h optim bandwidth h jand robustifi bandwidth e h jare indic tick mark within rang x axi right column univari kernel estim ey jx use optim bandwidth h idot robustifi bandwidth e h isolid 2 f1 2 3g find curv relat h iand e h ican hardli distinguish true simul sampl j dippon et al compon 1 compon 2 compon 3 fig 3 determin univari bandwidth e h 1 e h 2 e h 3for 3th simul run left column crossvalid l2 risk regress estim ey jx depend bandwidth h optim bandwidth h jand robustifi bandwidth e h jare indic tick mark within rang x axi right column univari kernel estim ey jx use optim bandwidth h idot robustifi bandwidth e h isolid 2 f1 2 3g despit fact bandwidth h iminim cv error criterion bandwidth use compar depend random variabl sampl robustifi bandwidth e h iseem appropri statist approach case base reason 17 compon 1 compon 2 fig 4 determin univari bandwidth e h 1 e h 2 e h 3for 11th simul run left column crossvalid l2 risk regress estim ey jx depend bandwidth h optim bandwidth h jand robustifi bandwidth e h jare indic tick mark within rang xaxi right column univari kernel estim ey jx use optim bandwidth h idot robustifi bandwidth e h isolid 2 f1 2 3g 20 sampl suggest method fail detect first compon stronger influenc function valu second compon j dippon et al tabl 1 ratio cvh0cv1 estim l2 risk multivari kernel estim specifi set compon paramet simul model run select subset 9 040 097 100 019 043 098 023 statist approach case base reason 19 tabl 2 statist ratio e h 1 e h 2each comput 20 simul run paramet statist e h 1 e h 2a n min 1st quart median mean 3rd quart max 10 200 014 093 110 102 116 143 compon 1 x componentof compon 1 x componentof compon 1 x componentof compon 1 x componentof compon 1 x componentof compon 1 x componentof fig 5 plot show level line regress function paramet 2 f03 05 1g cut ellipsoid neighborhood around point 05 05 neighborhood set comput one simul sampl size contain 110th unit squar j dippon et al 5 applic breast cancer data comput distanc function space covari suggest section 3 determin given new breast cancer patient unknown surviv time similar case among patient databas known censor surviv time data made avail robert boschkrankenhau stuttgart germani collect year 1987 1991 followup 80 month case describ 10dimension paramet vector consid nine first paramet predictor variabl includ age diagnosi age year menopaus statu ms equal 1 2 pre post menopaus respect histolog type breast cancer ht valu number affect lymph node pn group four class valu size pt group four class occur metastas pm valu 0 1 ye respect grade tumor gr valu f1 2 3g estrogen statu es valu 1 2 posit neg resp progesteron statu ps valu 1 2 posit neg resp last compon paramet vector describ observ censor surviv time ost year consid repons variabl mani case actual surviv time cant observ sinc patient still aliv end studi patient withdraw studi henc observ surviv time understood minimum actual surviv time time elaps date diagnosi date death censor time c time date diagnosi date patient known aliv approach estim censor surviv time instead complic often unknown uncensor surviv time order simplifi problem hope simplif doesnt affect result much use estim construct similar neighborhood rather estim surviv time function covari vector latter compar carbonez et al 1995 age ost continu distribut rv pt pn gr order categor rv ms ht pm es ps nomin rv valu predictor variabl allow statist approach case base reason 21 tabl 3 robustifi bandwidth e h jfor univari regress problem product 1 e h jtime spread compon j allow compar maxim influenc compon j distanc function compon age ms ht pt pn pm gr es ps miss assum covari vector new patient z z covari patient databas fz relat continu order categor rv defin distanc function j h j z j miss k z j l missingg otherwis relat nomin rv defin distanc function j j z j x j z j miss z j x j z j miss describ section 3 j 2 comput crossvalid optim 0 univari regress estim nh realiz respons variabl figur 6 7 show cv function cv regress estim relat robustifi estim e h j 0 display tabl 3 rang x covari variabl x defin l 2 22 j dippon et al 50 100 150 2001182age observ surviv time observ surviv time 10 12 14 16 18 202610 126 observ surviv time observ surviv time pn observ surviv time statist approach case base reason 23 observ surviv time observ surviv time observ surviv time 10 12 14 16 18 202610h ps observ surviv time j dippon et al tabl 4 number l 2 covari subset display possess smallest estim l2 risk l best subset cvh l 6 age pt pn pm es ps 07894 7 age ht pt pn pm es ps 07894 8 age ms ht pt pn pm es ps 07932 9 age ms ht pt pn pm gr es ps 08281 subset dg distanc function h fix posit number obtain multivari regress estim comput cv function cv function h 0 determin subset j l smallest global minimum cvh l relat cv function tabl 4 show result model select step togeth tabl 4 scree plot figur 8 suggest choos distanc function includ variabl pn pm es ad fourth compon rel improv ratio cvh 4 cv1 compar cvh 3 cv1 less 005 henc propos use distanc defin pn 071 pm 142 es 079 given new case covari x comput r dx z z 0 accord increas valu r 0 fz g fix k 2 statist approach case base reason 25 number compon fig 8 scree plot l cvh l 9g subset fz databas consist k case similar new case respect distanc histori log may help physician choos appropri therapi new patient 6 discuss often case nonparametr estim multivari set suggest method defici limit instanc assum random vector 26 j dippon et al take valu 0 0 1 0 0 1 1 1 probabl 14 let defin 0 x 2 f0 0 1 1g 1 otherwis ey jx 1 far constant henc case propos method fail adjust socal resubstitut estim l 2 risk penal function lead variou bandwidth select procedur gener crossvalid shibata model selector akaik inform criterion akaik finit predict error rice see eg hardl 1990 hardl 1991 may use instead least squar crossvalid criterion research improv regress estim instanc dimens reduct handl project pursuit regress adapt find structur linear subspac covari space addit fact censor observ time taken account applic concern surviv time breast cancer patient influenc chosen therapi ignor might lead underestim influenc known predictor variabl reason choic therapi usual depend predictor variabl therapi influenc surviv time isnt problem one data choic therapi independ predictor variabl data exist predictor use requir fulfil new predictor unknown past consid unimport therefor use choos therapi distanc function addit base new predictor allow judg import new predictor 7 acknowledg research partli support robert bosch foundat stuttgart grate prof h walk stuttgart stimul discuss reader wish obtain breast cancer data splu code algorithm contact author statist approach case base reason 27 r adapt control process overview predict learn function approxim theori pattern recognit applic appli nonparametr regress smooth techniqu implement local regress likelihood estim regress smooth method statist addit regress nonparametr model use polynomi spline tensor product multivari function estim smooth regress analysi tr random approxim measur accuraci nonparametr curv estim