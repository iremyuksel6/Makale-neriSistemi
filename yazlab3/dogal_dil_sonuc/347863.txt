automat sampl ratioofuniform method appli ratioofuniform method gener random variat result effici fast easytoimpl algorithm howev paramet everi particular type densiti must precalcul analyt articl show ratioofuniform method also use design blackbox algorithm suitabl larg class distribut includ logconcav densiti use polygon envelop squeez result algorithm extrem fast opposit ratioofuniform algorithm expect number uniform random number less two furthermor show method sens equival transform densiti reject b introduct exist larg literatur gener method standard continu distribut see exampl devroy 1986 algorithm often especi design particular distribut tailor featur densiti howev mani situat applic standard distribut adequ montecarlo simul besid sheer brute forc invers tabul distribut function mani point sever univers method larg class distribut develop avoid design special algorithm case method either slow eg devroy 1984 need slow setup step larg tabl eg ahren kohrt 1981 marsaglia tsang 1984 devroy 1986 chap vii recent two effici method propos transform densiti reject gilk wild 1992 hormann 1995 accep tancereject techniqu use concav transform densiti gener hat function automat user need provid probabl densiti function perhap approxim locat mode tabl method ahren 1995 also acceptancereject method use piecewis constant hat area piec region immedi accept make algorithm fast larg number constant piec use tail region distribut treat separ ratioofuniform method introduc kinderman monahan 1977 anoth flexibl method adjust larg varieti distribut becom popular transform method gener nonuniform random variat sinc result exact effici fast easi implement algorithm typic algorithm line code eg barabesi 1993 give survey exampl fortran code sever standard distribut base follow theorem 1991 mathemat subject classif primari 65c10 random number gener sec ondari 65u05 numer method probabl statist 11k45 pseudorandom number mont carlo method key word phrase nonuniform random variat ratioofuniform univers method adapt method patchwork reject continu distribut logconcav distribut concav distribut transform densiti reject theorem 1 kinderman monahan 1977 let x random variabl densiti function r gxdx gx posit integr function support necessarili finit v u uniformli distribut sampl random point uniformli distribut g reject conveni envelop region r g use basic form ratioofuniform method given algorithm rou algorithm rou requir densiti fx envelop region r 1 repeat 2 gener random point v u uniformli distribut r 3 x vu 4 u 2 fx 5 return x usual input rou prepar design algorithm particular distribut reduc number evalu densiti function step 4 squeez use obviou perform simpl algorithm depend reject constant ie ration jrjjaj jrj denot area region r kinderman monahan 1977 other use reject minim bound rectangl ie smallest possibl rectangl g basic algorithm improv sever fit enclos region decreas reject constant possibl choic parallelogram eg cheng feast 1979 quadrat bound curv eg leva 1992 often conveni decompos countabl set nonoverlap subregion composit ratioofuniform method robertson wall 1980 give simpl exampl dagpunar 1988 p 65 consid possibl enclos polygon paper develop new algorithm use polygon envelop squeez random variat insid squeez gener mere invers therefor opposit ratioofuniform method less two uniform random number requir larg class distribut includ logconcav distribut possibl construct envelop squeez automat moreov show new algorithm sens equival transform densiti reject new method sever advantag ffl envelop squeez construct automat probabl densiti function necessari random number necessari 0 made arbitrarili small ffl small method close invers thu result random variat use varianc reduct techniqu moreov structur result random variat similar underli random uniform random number gener henc nonuniform random variat inherit qualiti properti 1 moreov method extend wakefield gelfand smith 1991 replac function gener strictli increas differenti function qu stadlob 1989 1990 give modif discret distribut jone lunn 1996 emb method gener random variat gener framework wakefield et al 1991 stefanescu vaduva 1987 appli method gener multivari distribut ffl avoid possibl defect qualiti result pseudorandom variat report ratioofuniform method see hormann 1994a hormann 1994b ffl first ratioofuniform method first implement transform densiti reject requir less two random number section 2 give outlin new approach section 4 discuss problem get proper envelop region r section 5 describ algorithm detail section 3 show algorithm applic concav densiti x remark qualiti random number gener new algorithm given section 6 2 method envelop polygon given distribut probabl densiti function r gxdx convex set g notic g must continu bound sinc otherwis g convex simplifi develop method first assum unbound support g restrict drop later distribut easi make envelop polygon select coupl point c boundari use tangent point edg enclos polygon p e see figur 1 denot vertic p e simpli intersect point tangent obvious choic construct point tangent result bound polygon p e procedur even work tangent uniqu point v u ie gx differenti furthermor simpl construct squeez take insid polygon p vertic c construct point tangent figur 1 polygon envelop squeez convex set g sampl envelop polygon notic origin 0 0 alway contain polygon p e moreov everi straight line origin correspond thu intersect alway connect therefor use c first construct point vaxi tangent sampl uniformli enclos polygon triangul p e make segment illustr situat segment vertic c 0 c last segment segment divid triangl insid squeez dark sn figur 2 triangul envelop polygon shade triangl outsid light shade notic segment 0 sn three vertic triangl 0 n gener random point uniformli distribut p e first sampl discret distribut probabl vector proport js 0 j js 1 j select segment triangl done algorithm get segment requir list segment 1 gener r u0 1 2 find smallest k ik 3 p 4 return triangl k 5 els return triangl k step 2 index search guid tabl appropri method chen asau 1974 see also devroy 1986 xiii24 uniformli distribut point triangl v gener follow simpl algorithm devroy 1986 p 570 algorithm triangl requir triangl v 1 gener r 1 2 r 1 3 return 1 sampl algorithm much improv everi point triangl immedi accept without evalu probabl densiti function thu interest ratio compon sinc vertex c arriv r r c ij jth compon vertex c r 0 1 uniform random variat rationofuniform theorem sinc 0 r 2 kinderman monahan 1977 notic save one uniform random number domain p method furthermor reus random number r routin get segment r risk find ik ik sampl p seen invers cumul distribut function defin boundari squeez polygon thu ratio jp jjp e j close 1 almost invers gener random variat invers method two advantag thu favor simul commun see bratley fox schrage 1983 1 structur gener simpl easili investig see section 6 2 random variat use varianc reduct techniqu expect number uniform random number let j need 1 gener one ratio vu sinc reject ratio v u 62 find expect number uniform random number per gener nonuniform notic proper choic construct point made arbitrarili small bound domain g x situat nearli distinguish two case exist limit point x use x construct point respect triangular segment 0 sn necessari 2 otherwis restrict triangular segment 0 sn ie use tangent line instead vaxi notic differ tangent line c 0 0 sn ad construct point add new point given ratio need c outer boundari tangent line point given posit root u total differenti tangent 3 ratioofuniform transform densiti reject transform densiti reject one effici univers method transform densiti reject introduc devroy 1986 differ name gilk wild 1992 gener hormann 1995 accep tancereject techniqu use concav transform densiti gener hat function squeez automat mean tangent secant user need provid densiti function perhap approxim locat mode util densiti f strictli increas differenti transform exist fx concav see hormann 1995 detail densiti call logconcav densiti exampl logx figur 3 illustr situat standard normal distribut transform logx left hand side show transform densiti three tangent right hand side show densiti function result hat squeez drawn dash line evan swartz 1998 shown techniqu even suitabl arbitrari densiti provid inflect point transform densiti known 6 josef leydold figur 3 construct hat function normal densiti util transform densiti reject densiti convex region stadlob 1989 dieter 1989 clarifi relationship ratioofuniform method ordinari accep tancereject method also deeper connect transform densiti reject give us use character densiti convex region g first provid proof theorem 1 proof theorem 1 consid transform r theta 0 1 sinc jacobian transform 2 joint densiti probabl function x given wx otherwis thu x margin densiti w 1 r gx consequ r gxdx w 1 probabl densiti function fx transform 5 map g onetoon onto b ie set point graph gx xaxi moreov outer boundari g fv u map onto graph gx theorem 2 g convex gx concav transform x proof sinc x strictli monoton increas transform onetoon onto c ie region transform densiti henc r theta 0 1 map g onetoon onto c g notic g concav c g con vex thu remain show g convex c g convex consequ straight line remain straight line transform 6 let xb straight line c g ie straight line g analog find straight line line x remark 3 theorem 2 new univers ratioofuniform method sens equival transform densiti reject differ method gener point uniformli distribut region hat function opposit new method transform densiti reject alway need two uniform random number similar approach transform densiti jection ie decompos hat function squeez region immedi accept region squeez hat work well sampl second part awkward prone numer error hormann 1999 sinc everi logconcav densiti concav x hormann 1995 algorithm appli larg class distribut exampl given tabl 1 given condit paramet impli concav support densiti howev densiti concav wider rang paramet subset support eg densiti gamma distribut concav 0 x distribut densiti support concav normal e gammax 2 2 r lognorm 1x expgamma pexponenti e gamma x 0 beta x weibul x perk 1e x gen inv gaussian x pearson vi x planck x e burr x snedecor f x tabl 1 concav densiti normal constant omit 4 construct point perform new algorithm depend small ratio thu choic construct point tangent envelop polygon three possibl solut 1 simpli choos equidistribut point 2 use adapt method 3 use optim point obviou setup time increas margin gener time decreas 1 3 given number construct point equidistribut point simplest method choos point x equidistribut angl densiti function bound domain 7 modifi tan l tan r left right boundari domain see also section 2 numer simul sever densiti function shown accept good choic construct point sever distribut ratio length width minim bound rectangl far one adapt reject sampl gilk wild 1992 introduc ingeni concept adapt reject sampl problem find appropri construct point tangent transform densiti reject method adopt situat work follow way start least two point side mode sampl point envelop polygon p e add new construct point stop criterion fulfil eg maxim number construct point aim ratio jp jjp e j reach ensur start polygon p e bound construct point least close mode use third start point sampl point domain p e n p much expens sampl squeez region firstli gener random point requir random number multipl secondli evalu densiti check accept condit thu minim ratio done perfectli well adapt reject sampl sinc method region automat approxim envelop squeez polygon probabl ad new point segment depend ratio js ie probabl fall henc adapt algorithm tend insert new construct point necessari obvious ratio n random variabl converg 0 almost sure number construct point n tend infin simpl consider leydold hormann 1998 figur 4 show result simul standard normal distribut non optim start point sampl n plot number n construct point rang n given light shade area 90 50percentil given dark shade area median solid line 10 figur 4 converg ratio standard normal distribut start point 50 000 sampl run simul distribut start valu made observ converg even faster nonnorm di tribut howev analyt investig interest upper bound expect valu n open problem optim construct point theorem 2 area hat squeez transform densiti reject method map onetoon onto automat sampl ratioofuniform method 9 thu use method comput optim construct point transform densiti reject find optim envelop new algorithm three construct point use see hormann 1995 point requir derfling hormann 1998 describ effici method howev modif necessari improv adapt reject sampl rather small seen figur 4 lower boundari rang give good estim optim choic construct point 5 algorithm algorithm arou consist three main part 1 construct start envelop polygon p e squeez polygon p routin arou start take care possibl bound domain two case describ section 2 start point must provid eg use equidistribut point describ section 4 2 sampl given distribut routin arou sampl 3 add new construct point routin arou add whenev fall store envelop list segment object 1 use algorithm first initi gener call arou start sampl done call arou sampl object 1 segment paramet variabl definit remark left construct point c right construct point c i1 pointer store next segment tangent left point tangent right point i1 pointer store next segment intersect point area insideoutsid squeez accumul area cum fast invers algorithm arou start requir densiti fx deriv f 0 x domain 2 0 cosarctanx tangent line 3 k1 cosarctanx k tangent line k 4 5 fx 7 iv gammaf 0 8 add list segment use construct point 9 segment 10 insert c i1 i1 alreadi store next segment list 12 comput cum 13 check polygon p e bound 14 return list segment algorithm arou sampl requir densiti fx list segment 1 loop 2 gener r u0 1 3 find smallest cum use guid tabl 4 r cum 5 r return 7 9 gener r 2 u0 1 10 r 1 14 number segment maximum 15 call arou add x 17 return x algorithm arou add requir densiti fx deriv f 0 x new construct point xn segment r 1 fxn add point 2 return 3 c n2 4 nv gammaf 0 5 insert sn list segment take care c i1 remov old segment r list 7 comput mn 8 comput 9 segment 10 comput cum 11 return new list segment implement algorithm link list segment necessari whenev cum recalcul guid tabl made use linear search might good method find random variat sampl special care necessari comput arou start arou add three possibl case numer problem solv correspond linear equat 1 vertic c c i1 close consequ js j small simpli reject c i1 new construct point close c small 3 boundari c c i1 almost straight line almost 0 case set possibl way defin small compar number smallest posit use program languag denot magnitud maximum densiti function ansi c defin macro dbl epsilon import check whether outer side secant c c i1 condit violat arou start polygon p e unbound may violat arou start arou add convex c implement test version algorithm arou code c avail anonym ftp leydold 1999 email request author 6 note qualiti random number new algorithm composit method similar acceptancecompl method see devroy 1986 x ii5 x distribut defin squeez region g theorem 1 algorithm exact ie gener random variat requir distribut howev defect underli uniform random number gener may result poor qualiti nonuniform random variat moreov transform nonuniform random variat may caus defici although littl literatur topic ratioofuniform method combin linear congruent gener lcg report defect hormann 1994a hormann 1994b due lattic structur random pair gener lcg alway hole without point probabl order 1 modulu lcg random variat gener invers inherit structur underli uniform random number consequ qualiti consid great advantag method sinc gener whose structur properti well understood precis describ may look less random complic less understood necessarili better may hide strong correl import defect avoid gener without convinc theoret support statement lecuy 1998 build uniform random number gener also valid nonuniform distribu tion method may hidden infer make predict qualiti result nonuniform random number imposs leydold leeb hormann 1999 notic random variat densiti g x gener invers thu ratio tend 0 random variat gener invers new algorithm immedi consequ small new gener avoid defect basic ratioofuniform method figur 5 show scatter plot overlap tupl use babi gener show underli gener bf show tupl phiu 0 differ number construct point use equidistribut method phi denot cumul distribut function standard normal distribut made empir investig use mtupel test good 1953 marsaglia 1985 setup leydold leeb hormann 1999 standard normal distribut variou number construct point use linear congruenti gener fish fishman moor 1986 explicit invers congruenti gener eichenauerherrmann 1993 twist gfsr gener tt800 matsumoto kurita 1994 last infam randu lcg exampl gener bad lattic structur see park miller 1988 test demonstr small ratio qualiti normal gener strongli correl qualiti underli uniform random number gener especi use randu result normal gener bad qualiti notic howev correl exist close 0 inde use 2 4 construct point result normal gener might better eg fish test wors eg randu underli gener uniform b c r figur 5 scatter plot babi gener mod 1024 normal variat use algorithm arou 2 4 6 29 75 equidistribut construct point bf 7 possibl variant nonconvex region algorithm modifi work nonconvex region f adapt idea evan swartz 1998 partit f segment use inflect point transform densiti transform x segment f fx concav use secant boundari envelop polygon p e tangent squeez p notic squeez region segment quadrangl triangul multivari distribut wakefield gelfand smith 1991 stefanescu vaduva 1987 gener ratioofuniform method multivari distribut use reject enclos multidimension rectangl howev accept probabl decreas fast higher dimens multivari normal distribut four dimens 1 use polyhedr envelop similar leydold hormann 1998 leydold 1998 possibl increas accept probabl howev requir addit research acknowledg author wish thank hann leeb help discuss qualiti random number gener r comput method effici sampl larg arbitrari statist distribut random variat gener use ratioofuniform method guid simul gener random variat empir distribut simpl gamma variat gener principl random variat gener optim select hat function reject algorithm simpl algorithm gener random variat logconcav densiti mathemat aspect variou method sampl classic distribut statist independ new class invers congruenti pseudorandom number random variabl gener use concav properti transform densiti see erratum adapt reject sampl gibb sampl appli statist serial test sampl number test random reject techniqu sampl tconcav distri bution privat commun transform random variat gen erat generalis ratioofuniform method comput gener random variabl use ratio uniform deviat random number gener fast normal random number gener reject techniqu sampl logconcav multivari distribut arou user manual sweepplan algorithm gener random tupl simpl polytop higher dimension properti nonuniform pseudorandom variat current view random number gener twist gfsr gener ii random number gener good one hard find random number gener normal gamma distribut use ratio uniform method ratio uniform approach gener discret random variat comput gener random vector transform uniformli distribut vector effici gener random variat via ratioofuniform method univers econom busi administr tr exhaust analysi multipl congruenti random number gener modulu 2supscrpt311 guid simul 2nd ed comput gener random vector transform uniformli distribut vector random number gener good one hard find mathemat aspect variou method sampl classic distribut ratio uniform approach gener discret random variat fast normal random number gener note qualiti random variat gener ratio uniform method twist gfsr gener ii reject techniqu sampl italictitalicconcav distribut reject techniqu sampl logconcav multivari distribut sweepplan algorithm gener random tupl simpl polytop comput gener random variabl use ratio uniform deviat ctr leydold gerhard derfling gnter tirler wolfgang hrmann automat code gener nonuniform random variat gener mathemat comput simul v62 n36 p405412 3 march john kent patrick l constabl fikret er simul complex bingham distribut statist comput v14 n1 p5357 januari 2004 josef leydold short univers gener via gener ratioofuniform method mathemat comput v72 n243 p14531471 juli josef leydold simpl univers gener continu discret univari tconcav distribut acm transact mathemat softwar tom v27 n1 p6682 march 2001 wolfgang hrmann josef leydold continu random variat gener fast numer invers acm transact model comput simul tomac v13 n4 p347362 octob w hrmann j leydold randomnumb randomvari gener automat random variat gener simul input proceed 32nd confer winter simul decemb 1013 2000 orlando florida dongu lee wayn luk john villasenor peter k cheung gaussian nois gener hardwarebas simul ieee transact comput v53 n12 p15231534 decemb 2004