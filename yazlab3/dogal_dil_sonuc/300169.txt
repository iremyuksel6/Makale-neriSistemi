exponenti integr larg system differenti equat studi numer integr larg stiff system differenti equat method use matrixvector product exponenti relat function jacobian larg problem approxim krylov subspac method typic converg faster solut linear system aris standard stiff integr exponenti method also offer favor properti integr differenti equat whose jacobian larg imaginari eigenvalu deriv method order 4 exact linear constantcoeffici equat implement method discuss numer experi reactiondiffus problem timedepend schrdinger equat includ b introduct idea use exponenti function jacobian numer integr mean new mostli regard rather impract sinc mideighti krylov subspac approxim action matrix exponenti oper howev found use chemic physic 16 20 22 subsequ also field 6 8 9 21 24 29 numer analysi side converg krylov approxim studi 4 5 13 26 shown 13 previous 4 symmetr case krylov approxim expav converg substanti faster solut linear system v least unless good precondition avail linear system aris numer integr stiff differenti equat standard integr larg problem solut often domin comput work nonlinear differenti equat exponenti jacobian combin krylov approxim previous use gener adam type multistep method 8 hand use matrix exponenti long time promin exponenti fit literatur see eg 7 17 1 2 recent exampl paper studi new numer method integr larg stiff system nonlinear initi valu problem method propos use matrixvector multipl av jacobian f relat step size choic allow us obtain method exact constantcoeffici linear problem mathematisch institut universitt tubingen auf der morgenstel 10 d72076 tubingen germani email marlisnaunituebingend lubichnaunituebingend hubertnaunituebingend remark krylov subspac approxim av converg fast expav see 13 potenti advantag exponenti integr thu origin two differ sourc comput av less expens solv exponenti integr method may behav favor standard integr latter case occur particular mildli nonlinear differenti equat whose jacobian larg imaginari eigenvalu eg wave equat schroding equat flexibl mechan system oscillatori electr circuit standard stiff integr either damp high frequenc map one frequenc nearli discret neither may desir section 2 give simpl method order 2 exact 12 linear secondord differenti equat includ new symmetr method appear use longtim integr conserv timerevers problem section 3 consid class method would reduc explicit rungekutta method replac z j 1 rosenbrock wanner method give order condit exact inexact jacobian deriv suffici necessari condit ensur 12 solv exactli section 4 extend method differentialalgebra system deriv order condit order 3 problem singularli perturb system section 5 construct method classic order 4 exact 12 favor properti appli stiff problem particular use reformul reduc comput work krylov process section 6 deal implement issu import topic take account comput work storag requir krylov process step size control stop krylov process base consider section 5 6 written code exp4 obtain via anonym ftp naunituebingend directori pubcodesexp4 section 7 describ numer experi code reactiondiffus problem schroding equat timedepend hamiltonian show scope limit use krylov approxim exponenti integr final section discuss conclus perspect method propos articl describ method autonom differenti equat 11 nonautonom problem method appli extend formal autonom system obtain ad trivial differenti equat method exact linear differenti equat whose inhomogen linear 2 simpl method order 2 21 exponenti fit euler method prototyp exponenti method seem appear repeatedli literatur variou disguis 2 h step size method order 2 exact linear differenti equat 12 22 symmetr exponenti method longtim integr conserv time revers import properti symmetr method order 2 given twostep formula given 22 method exact linear problem 12 provid start valu 0 1 exact method view gener explicit midpoint rule reduc characterist root method appli e h gamma1 show method astabl oscillatori error compon gamma1 n elimin take averag two success valu n approxim 23 cosin method secondord differenti equat consid linear problem exact solut satisfi entir function motiv scheme symmetr method order 2 24 26 scheme exact linear problem 25 deriv approxim exact 25 obtain via gammaz gammaz 3 higherord exponenti onestep method order condit stabil section studi gener class exponenti integr method introduc 13 start 0 approxim yt 0 approxim comput via coeffici determin method intern stage comput one one multipl flha function evalu stage scheme would becom explicit rungekutta method z j 1 rosenbrockwann method choic exponenti euler method 21 choos instead function 22 31 order condit use exact jacobian aim construct higherord method order condit exponenti method deriv similarli rosenbrockwann method see eg 12 section iv7 therefor state condit abbrevi defin theorem 31 exponenti method 3133 order p iff elementari differenti order p phi j polynomi p fl list tabl 31 p 5 differ order condit rosenbrockwann method polynomi p fl theorem 32 method 3133 exact linear differenti equat 12 iff condit fulfil fl reciproc integ finit number condit need other satisfi automat suffici larg n side 35 vanish proof linear problem 12 exact numer solut depend analyt h sinc elementari differenti f f nonvanish 12 thu suffic show order condit given 35 like rosenbrock method one obtain form 3 elementari differenti kl ff jk ff jl 13 f 000 f f f klm ff jk ff jl ff jm 14 f 4 f f f f f 000 f 0 f f f tabl order condit exponenti method order 5 p ngamma1 polynomi degre n gamma 1 depend choic method coeffici remain show p ngamma1 fl given righthand side 35 method appli 12 rungekutta method coeffici fi jk weight b order condit rungekutta method thu exponenti euler method 21 onestag method 3133 b obvious method sinc alreadi know exponenti euler method exact 12 conclud 36 similarli two consecut step exponenti euler method step size h2 view one step twostag method 3133 12 method 37 valid n 2 conclud 36 continu argument 3 step exponenti euler method step size elementari differenti af kl ff jk ff jl 13 kl ff jk ff kl 16 kl ff jk fl kl gammafl 4 kl aaf kl tabl order condit exponenti wmethod order 3 follow p ngamma1 fl given righthand side 35 32 order condit inexact jacobian one may also want use method approxim jacobian requir restrict method paramet order 3 condit given tabl 32 wmethod see 12 p 124 except differ polynomi fl first five condit tabl 32 satisfi method order 3 analog situat wmethod 33 stabil method exact linear differenti equat trivial astabl much fact shown stabil includ practic situat flhav comput approxim consid perturb method 3133 appli linear problem 12 ffi perturb ith stage e 0 perturb start valu subtract unperturb scheme yield error easi see polynomi degre k p k whose coeffici product particular numer rang contain left half plane stabl error recurr stabil analysi could extend nonlinear problem lipschitzbound g singularli perturb problem nonlinear parabol problem similar way done rosenbrock method cf 10 18 30 4 exponenti method differentialalgebra singularli perturb problem rosenbrockwann method 12 section vi3 method 3133 extend differentialalgebra equat z invert appli formal singularli perturb differenti equat let ffl 0 scheme give us follow method l 0 gammag z g gammaf z g gamma1 z g z l z g jacobian evalu v defin z 0 l j final set z 0 l deriv use auxiliari assumpt eigenvalu g z neg real part jacobian 42 block diagon offl fflf z g gamma1 z gammag z g offl offl viz ffl g z o1 sinc flh z method 3133 appli 42 read l z l note 0 0 ffl gammaf z g gamma1 z lead method 43 remark matrix b need comput one use krylov method approxim flhbu matrix vector multipl b cheap action g gamma1 z inexpens comput exampl case constrain mechan system cf 12 p 542 q v posit veloc variabl respect acceler repres lagrang multipli system g z correspond suitabl multibodi formul linear equat matrix solv amount work proport dimens exponenti method exact linear differenti equat constant inhomogen method 4345 exact linear differentialalgebra equat constant matric f f z g g z g z invert constant vector b c apart direct calcul may seen follow eigenvalu g z neg real part exact obtain let ffl 0 singularli perturb problem solv exactli method case exact gener situat invert g z follow analyt continu gener applic scheme differentialalgebra equat result order reduct order 2 unless method coeffici satisfi addit condit theorem 41 method 4345 converg order 3 differentialalgebra equat 41 satisfi order condit tabl 31 order 3 35 addit jk addit order condit rosenbrock method appli 41 12 p 446 instead give cumbersom formal proof theorem make reappear condit 46 exponenti method plausibl follow like order condit section 3 also differentialalgebra order condit form rosenbrock method possibl differ righthand side involv fl know theorem valid z appear jk relat term flhg z gamma1 43 independ term ff jk also unrel flhb therefor condit remain rosenbrock method differentialalgebra order condit 46 import differentialalgebra system also stiff differenti equat exampl thirdord error bound rosenbrock method singularli perturb problem 42 theorem 10 shown valid also exponenti method 5 construct fourthord method 51 reduc method recal one step exponenti method evalu form 3133 contain multipl flha vector sinc vector differ step approxim krylov subspac method requir construct base krylov space respect matrix differ vector turn prohibit expens one may think exploit techniqu solv linear system multipl righthand side 25 27 experi save achiev minor therefor present altern formul method key point construct effici method one comput recurs z comput flha thu comput jflhav integ j 1 expens matrix vector multipl recurr 51 equal use interest case jflhav approxim krylov method krylov subspac approxim matrix contain arnoldi lanczo basi mth krylov subspac respect v hm orthogon obliqu project mth krylov subspac theta upper hessenberg block tridiagon respect matrix e 1 first mdimension unit vector iter number typic small compar dimens matrix matrix flhh comput quit cheapli see x6 detail recurr 51 use comput jflhh e 1 perform matrix vector multipl small matric hm flhh denot ident matrix dimens exploit recurr 51 reformul method introduc auxiliari vector note correspond firstdegre taylor expans f around 0 henc vector usual small norm would vanish linear f 34 53 51 choos fi kl coeffici fi kl uniqu determin 54 order appli recurr formula 51 54 choos give reduc number fevalu evalu flha factor n compar gener scheme 3133 particularli import reduc method combin krylov process approxim flhav sinc case need comput basi new krylov space everi nth intermedi step moreov sinc vector usual small norm krylov approxim iflhad nj1 j 1 typic take iter achiev requir accuraci cost build krylov space respect vector fy 0 thu domin comput cost note final reorgan comput 54 use valu k l 32 33 appropri modifi weight 52 method order 4 next show reduc scheme propos still allow construct higherord method concentr start 3stage method use 2 function evalu per step paramet fi kl satisfi 54 given fulfil condit order 4 remain two free paramet ff 31 ff 32 weight 4 order condit tabl 31 uniqu solut yield scheme k 3 omit tild correspond 55 method order 4 exact linear differenti equat 12 howev first order use inexact jacobian second order appli dae moreov imposs construct embed method order 3 make hard perform reliabl estim local error step size control cheap variant use exponenti euler method 21 order 2 thu tend overestim local error method 57 embed 21 howev interest econom method situat time step restrict accuraci converg krylov process comput hafi 0 note k 3 usual well approxim low dimension krylov space 3 often much smaller norm fy 0 sophist method construct use 3 function evalu per step paramet 54 given paramet fi kl order condit 35 linear problem satisfi automat method choos evalu function f end point middl time interv iex solut obtain first solv order condit order 4 tabl 31 equat f 00 f f f 0 f immedi yield b condit f f 46 result linear system four equat unknown b j 7 system uniqu solut also satisfi second order wcondit equat f obtain b remain fulfil equat satisfi thirdord wcondit f 0 f 0 f order obtain order 3 approxim jacobian oh close true ja cobian yield ff 2 still freedom solv fifthord condit f 000 f 0 f f f f 00 f 0 f 0 f f give ff fifthord condit satisfi minimizex 7j yield ff construct give us follow method omit tild k use 55 summar properti method theorem theorem 51 scheme 58 order 4 differenti equat 11 exact linear differenti equat 12 converg order 3 differentialalgebra equat 41 smooth solut singularli perturb problem 42 uniformli ffl h 2 differenti equat 11 second order use inexact jacobian order 3 approxim jacobian oh close true jacobian method satisfi three order5 condit residu condit appear rather small largest one 01 although scheme 58 7stage method requir three function evalu use krylov approxim comput cost domin comput k 1 discuss reason k 2 k 3 k 5 k 6 comput recurs 51 stabl recurr 62 k 4 k 7 typic well approxim low dimension krylov subspac 4 7 usual much smaller norm fy 0 reason superior theoret properti prefer 58 standard 3stage fourthord scheme type 3133 53 embed method construct two embed method differ properti scheme 58 first one order 3 differenti equat 11 differentialalgebra equat 41 exact linear equat 12 solv thirdord condit tabl 31 condit 46 choos give embed scheme method satisfi fourthord condit except f 0 f 0 f 0 f howev order 1 wmethod ie use inexact jacobian second embed method order two wmethod exact linear differenti equat 12 satisfi thirdord condit tabl 31 read e 54 dens output like rungekutta rosenbrock method continu numer solut defin via polynomi b satisfi b approxim order iff elementari differenti order ae p see 12 p 452 3stage method 57 continu numer solut order 3 given 7stage method 58 continu numer solut order 3 also order 3 differentialalgebra equat order 2 use inexact jacobian given actual comput use defin 56 k k 58 6 implement issu 61 step size control step size control scheme 58 use two embed method propos section 53 estim local error choos minimum local error estim two method step size select strategi due gustafsson see 12 p 3135 radau5 code 12 p 550ff yield new step size propos h err howev krylov subspac method use approxim matrix exponenti oper addit local error estim necessari take work storag requir krylov process account propos follow strategi first choos suitabl window number krylov step requir approxim k recal reduc method overal work krylov process domin first krylov process window choos desir number krylov step opt preserv actual step size h integr method whenev 2 new krylov step size reduc requir accuraci achiev 2 two consecut step set found 13 reason valu numer experi also turn drastic enlarg step size possibl small two consecut step exampl use last j time step final choos new step size 62 save previou step scheme may reus jacobian previou time step approxim actual jacobian done local error embed method 510 accept addit h kri h err ie step size determin krylov process save achiev jacobian step size h previou time step write fy n close fy ngamma1 initi vector krylov process small norm thu krylov process becom less expens 63 stop criterion krylov method need decid krylov approxim 52 consid suffici accur sinc exact error inaccess stop criterion iter solut linear system usual base residu instead error mth iter galerkintyp method like fom bicg residu vector comput hm1m m1m entri hm1 delta m1 denot 1entri matrix use cauchi integr formula error mth krylov approxim av written z gamma contour enclos eigenvalu hm cf 13 thu interpret linear combin error e linear system replac e r formula get gener residu z comput addit cost suggest use ae instead unknown error ffl stop criterion use ae also propos saad 26 use differ deriv plausibl small kak scheme 58 krylov approxim k j multipli step size h therefor reason stop iter tol weight norm use integr given absolut rel error toler numer experi found 61 safe side sometim rather pessimist may pay appli idea attribut shampin 12 p 134 consist use smooth residu instead true residu sinc solv linear system coeffici matrix prohibit expens larg one perform smooth mdimension subspac use instead 61 5 say smaller criterion may overli optimist larg norm 64 comput hm reduc comput cost evalu figur index sequenc eg 2 f1 2 3 4 6 8 11 15 20 48g sequenc chosen comput hm expens total previous comput h j sinc comput hermitian hm hermitian tridiagon case one simpli diagon hm nonhermitian case suggest use pade approxim similarli third method describ 19 comput matrix exponenti matrix first scale factor 2 gammak k2 gammak hm k 12 evalu approxim z scale matrix 26 z next hm comput recurs 2 gammak hm appli follow coupl recurr recurr stabl z left halfplan wherea 51 becom unstabl larg jzj multipl z altern nonhermitian case one use formula due saad 26 section 23 exp exphm appear favor dimens small 7 numer experi implement method 58 approxim matlab code exp4 program written format use matlab ode suit 28 avail via anonym ftp ftpmathworkscom pubmathworkstoolboxmatlabfunfun directori code exp4 obtain naunituebingend pubcodesexp4 directori c version exp4 also avail ftp site 71 reactiondiffus equat nonstiff chemic reaction brussel illustr behavior exponenti integr krylov approxim flhav transit nonstiff stiff problem chosen twodimension brussel 11 pp 248ff togeth neumann boundari condit n n initi condit laplacian discret uniform 100 theta 100 grid central differ dimens result ode problem 20 000 eigenvalu discret laplacian lie gamma80 000 zero present numer experi three differ valu diffus coeffici mark transit nonstiff stiff problem solut problem shown movi pp 250ff 11 fig 7173 show workprecis diagram exponenti integr exp4 explicit rungekutta integr ode45 matlab ode suit 28 base fifthord method dormand princ 3 vertic axi show error end point horizont axi give exp4 error flop fig 71 brussel flop error exp4 fig 72 brussel exp4 error flop fig 73 brussel number flop marker theta exp4 ffi ode45 correspond error comput work nonstiff integr increas drastic grow ff perform exp4 consider less affect 72 reactiondiffus equat stiff chemistri robertson exampl follow exampl show behavior exponenti integr stiff problem consid robertson reaction 12 pp 3f onedimension diffus togeth neumann boundari condit u diffus coeffici chosen second spatial deriv discret uniform grid point problem stiff origin reaction term chosen small problem intend illustr influenc krylov approxim procedur perform integr fig 74 show step size function time doubl logarithm scale without krylov approxim flhav exampl dimens 90 flha comput diagon comparison also show step size explicit integr ode45 stiff integr ode15 matlab ode suit 28 use variant method method run toler atolrtol gamma6 seen exampl step size alway limit krylov process step size restrict appear sever consid time interv similar step size sequenc obtain krylovapproxim exponenti method higherdimension version problem howev limit krylov approach show integr continu long time step size remain essenti level seen rightmost part fig 74 observ behavior larg due roundoff error effect 73 schroding equat timedepend potenti exampl problem whose jacobian larg imaginari eigenvalu consid follow 23 onedimension schroding equat hamiltonian equat model atommolecul interact high intens cw laser paramet valu use 100 initi valu x exp4 without krylov exp4 krylov step size time fig 74 step size versu time robertson exampl correspond eigenst unforc harmon oscil lowest energi level semidiscret space done pseudospectr method fourier mode space interv x 2 gammaa period boundari condit lead nonautonom linear system differenti equat diag j approxim x n fn discret fouriertransform oper diag0 jacobian full matrixvector multipl obtain log n flop use fft fig 75 show workprecis diagram standard nonstiff stiff solver ode45 ode15 matlab ode suit matlab implement hairer wanner 12 radau5 implicit rungekutta code code use toler atolrtol surprisingli good behavior stiff integr ode15 radau5 due follow matrixfre implement simplifi newton iter jacobian approxim i2f linear system could solv log n oper use fft therefor comput cost per time step essenti explicit method use full jacobian would make implicit method complet ineffici problem note howev perform version simplifi jacobian deterior paramet increas exponenti code exp4 clearli superior explicit integr ode45 accuraci requir stringent 10 gamma4 fig 75 show advantag exp4 error flop fig 75 workprecis diagram schroding equat exp4 also respect implicit method optim version discuss stem fact exp4 abl take much larger time step integr comput schroding equat timeindepend hamiltonian use chebyshev approxim matrix exponenti oper popular 16 therefor also implement version exp4 arnoldi process replac chebyshev approxim numer experi chebyshev version need twice mani flop arnoldibas implement thank gray point refer 16 23 8 conclus perspect paper introduc new integr method use matrixvector multipl exponenti jacobian particular studi rosenbrocklik exponenti method sinc straightforward implement method comput expens identifi subclass reduc method reformul allow effici implement two promis fourthord method exact linear constantcoeffici problem given formula 57 58 method 58 offer superior properti slightli higher cost per time step implement krylov subspac approxim matrix exponenti oper code exp4 implement requir function evalu matrixvector multipl jacobian numer experi theoret consider indic exponenti integr highli competit follow problem class larg system initialvalu problem mildli stiff problem eg reactionconvectiondiffus problem nonstiff reaction term effici tradit method explicit integr use despit stabil restrict step size special case eigenvalu jacobian neg real axi highstag rungekutta chebyshev method van der houwen sommeij 14 31 known success theori 5 13 31 tell us number necessari matrixvector multipl jacobian krylov iter exponenti method number function evalu rungekuttachebyshev method need attain stabil magnitud hkak howev krylov method take advantag cluster eigenvalu vector small compon eigendirect restrict problem eigenvalu near real axi exponenti method krylov approxim much larger time step standard explicit rungekutta method dormand princ method taken stiff problem eg reactiondiffus problem stiff reaction term highdimension system standard approach use implicit method bdf radau linear system solv iter help hope good cheap precondition effici precondition avail method clearli favor exponenti method propos sinc known precondit iter comput matrix exponenti oper due superlinear error reduct krylov approxim matrix exponenti exponenti method often competit even without precondition hope futur develop allow effect use idea precondit comput exponenti henc enlarg rang stiff problem exponenti method effici applic highli oscillatori problem eg wave equat schroding equat elasto dynam oscillatori electr circuit propos exponenti method abl resolv high frequenc requir error toler without sever time step restrict standard scheme time step restrict often milder type still occur nonlinear effect limit iter number krylov process latter less sever eigenvalu jacobian cluster good resolut high frequenc exponenti method contrast usual implicit integr use larg time step either damp high frequenc map one frequenc nearli discret interest see new method perform reallif scientif problem r suffici condit uniformli secondord converg scheme stiff initialvalu problem new effici numer integr scheme highli oscillatori electr circuit famili embed rungekutta bound simpl lanczo procedur comput function symmetr matric eigenvalu krylov subspac approxim eigenpair matrix function exact comput arithmet krylov method incompress navierstok equat verallgemeinert rungekutta verfahren zur losung steifer differentialgleichungen method exponenti propag larg system stiff nonlinear differenti equat effici solut parabol equat krylov approxim method rosenbrock method stiff problem studi via differenti algebra equat solv ordinari differenti equat solv ordinari differenti equat ii krylov subspac approxim matrix exponenti oper intern stabil explicit mstage rungekutta method larg valu rosenbrock method use ludecomposit propag method quantum molecular dynam gener rungekutta process stabl system larg lipschitz con stant linearli implicit time discret nonlinear parabol equat nineteen dubiou way comput exponenti matrix new approach manyst quantum dynam recurs residuegener method applic lanczo algorithm unitari quantum time evolut iter lanczo reduct solut time depend schroding equat lanczo method solv symmetr system sever right hand side analysi krylov subspac approxim matrix exponenti oper matlab ode suit expokit softwar packag comput matrix exponenti explicit rungekutta method parabol partial differenti equat tr ctr xinyuan wu jianlin xia new vector form element function taylor seri appli mathemat comput v141 n23 p307312 5 septemb koikari error analysi modifi scale squar method comput mathemat applic v53 n8 p12931305 april 2007 r weiner b schmitt h podhaiski parallel peer twostep wmethod applic molsystem appli numer mathemat v48 n34 p425439 march 2004 philip w livermor implement exponenti time differenc scheme magnetohydrodynam equat spheric shell journal comput physic v220 n2 p824838 januari 2007 schmitt r weiner design analysi test parallel twostep wmethod stiff system appli numer mathemat v42 n1 p381395 august 2002 xy wu jl xia f yang dynam method weight linear least squar problem comput v68 n4 p375386 septemb 2002 ya yan lu comput matrix function exponenti integr journal comput appli mathemat v161 n1 p203216 1 decemb jrg wensch krylovrow method dae index 1 applic viscoelast appli numer mathemat v53 n2 p527541 may 2005 marli hochbruck alexand ostermann exponenti rungekutta method parabol problem appli numer mathemat v53 n2 p323339 may 2005 z jackiewicz h podhaiski r weiner construct highli stabl twostep wmethod ordinari differenti equat journal comput appli mathemat v167 n2 p389403 1 june 2004 jrg wensch fernando casa extrapol lie group approxim bchformula appli numer mathemat v42 n1 p465472 august 2002 tobin driscol composit rungekutta method spectral solut semilinear pde journal comput physic v182 n2 p357367 novemb 2002 lintner eigenvalu problem 2d laplacian hmatrix arithmet applic heat wave equat comput v72 n34 p293323 may 2004 krogstad gener integr factor method stiff pde journal comput physic v203 n1 p7288 10 februari 2005 caliari vianello l bergamaschi interpol discret advectiondiffus propag leja sequenc journal comput appli mathemat v172 n1 p7999 1 novemb 2004 f carbonel j c jimenez r biscay numer method comput lyapunov expon nonlinear ordinari differenti equat appli mathemat comput v131 n1 p2137 10 septemb 2002 roger b sidj expokit softwar packag comput matrix exponenti acm transact mathemat softwar tom v24 n1 p130156 march 1998 hvard berland brd skaflestad wright expinta matlab packag exponenti integr acm transact mathemat softwar tom v33 n1 p4e march 2007 botchev harutyunyan j j w van der vegt gautschi time step scheme edg finit element discret maxwel equat journal comput physic v216 august 2006 elena celledoni arieh iserl syvert p nrsett bojan orel complex theori liegroup solver journal complex v18 n1 p242286 march 2002 tokman effici integr larg stiff system ode exponenti propag iter epi method journal comput physic v213