residu replac strategi krylov subspac iter method converg true residu paper strategi propos altern comput residu vector krylov subspac method improv agreement comput residu true residu level ou x build earlier idea residu replac insight finit precis behavior krylov subspac method comput error bound deriv iter involv occasion replac comput residu true residu use monitor deviat two residu henc select residu replac step recurr relat comput residu control converg method perturb within safe bound numer exampl present demonstr effect new residu replac scheme b introduct krylov subspac iter method solv larg linear system typic consist iter recurs updat approxim solut x n correspond residu vector written gener form follow algorithm 1 templat krylov subspac method input initi approxim x converg gener correct vector q n method vector x n occur statement end depart mathemat utrecht univers po box 80010 nl3508 utrecht netherland email vorstmathuunl depart mathemat univers manitoba winnipeg manitoba canada r3t 2n2 email yegaussamathumanitobaca research support grant univers manitoba research develop fund natur scienc engin research council canada krylov subspac iter method includ conjug gradient method cg 12 biconjug gradient method bicg 4 13 cg 19 bicgstab 22 fit framework see 2 11 16 method exact arithmet recurs defin r n algorithm 1 exactli residu approxim solut x float point arithmet howev roundoff pattern x n r n differ import note error made comput x n reflect correspond error r n word comput error x n forc method correct sinc x n influenc iter process lead well known situat b gamma ax n r n may differ significantli phenomenon extens discuss literatur see 10 11 18 refer cite inde denot comput result x respect still use q n denot comput updat vector algorithm f lz denot comput result z finit arithmet absolut valu inequ vector componentwis u machin roundoff unit vector n round error term bound straightforward error analysi see section 3 detail particular relat 1 2 show n j n depend iter vector r n q n call b gamma ax n true residu approxim x n call r n obtain recurr formula 2 comput residu updat residu differ two satisfi use finit precis recurr 1 2 assum b gamma ax henc differ true updat residu result accumul round error particular signific deviat r n may expect r larg norm iter uncommon situat bicg cg hand even j small common cg take rel larg number iter converg sheer accumul j could also lead nontrivi deviat make import finit precis implement sequenc r n satisfi almost machin precis u defin recurr relat observ mani krylov subspac method drive forc behind converg r n 10 15 18 20 inde residu bound obtain 20 cg bicg show even significantli perturb recurr relat perturb much larger machin precis usual still lead eventu converg comput residu theoret insight motiv justif residu replac scheme present section 21 hand true residu b gamma ax n selfcorrect mechan converg mainli perturb made x n effect iter paramet wherea error immedi lead iter paramet thu typic converg iter process r n converg level much smaller u eventu true residu b gamma ax n converg level dictat sigma n sinc usual r n still bigger accumul error sigma n agre well r n magnitud r n converg level smaller accumul error accumul error agreement r n summari straightforward implement would reduc true residu best bound obtain 10 call attain accuraci note term could signific even one j larg n larg problem becom seriou method cg bicg intermedi x n r n larg norm may result larg n j n sever popular method bicgstab 22 bicgstab 17 qmr 7 tfqmr 5 composit step bicg 1 develop reduc norm r n see 6 detail note control size kr n k solv deviat problem situat instanc accumul tini error long iter may still result nontrivi deviat simpl approach solv deviat problem replac comput residu true residu iter step restor agreement deviat subsequ step error accumul iter includ complet replac strategi simpli comput r n b gamma ax n everi iter period replac strategi updat r n b gamma ax n interv iter count strategi maintain agreement two kind residu turn converg r n may deterior see may result unaccept larg perturb lanczo recurr relat residu vector steer converg see section 23 recent sleijpen van der vorst 18 motiv suggest made neumaier see 11 18 introduc sophist replac scheme includ socal flyingrestart procedur demonstr new residu replac strategi effect sens improv converg true residu sever order magnitud practic implement strategi use lead meaning residu import stop iter process right point cours one could termin classic process simpli test true residu risk true residu stagnat alreadi long termin much work done vain present paper follow idea replac comput residu true residu select step order maintain close agreement two residu propos simpler strategi replac done necessari phase iter harmless converg mechan r n destroy specif shall present rigor error analysi iter residu replac propos comput bound deviat comput true residu use select replac phase iter way lanczo recurr among r n suffici well maintain result strategi shown provid comput residu converg true residu converg level oukakkxk smallest level one expect approxim paper organ follow section 2 develop refin residu replac strategi discuss strategi report other give error analysi section 3 deriv bound deviat use replac condit present complet implement section 4 turn residu replac strategi easili incorpor exist code numer exampl report section 5 finish remark section 6 vector norm use paper one 1 2 1norm residu replac strategi section develop replac strategi maintain converg true residu formal analysi postpon next section specif iter method fit gener framework algorithm 1 throughout paper shall consid iter process comput residu r n converg suffici small level mention section 1 follow basic idea replac comput residu r true residu f select step refer iter step one residu replac occur henc residu gener arbitrari step n could either usual updat residu r true residu depend whether replac taken place step n order distinguish two possibl formul denot r n residu obtain step n process replac strategi residu replac step residu deviat immedi reduc shown see lemma 1 section 22 subsequ iter n next replac step clearli therefor accumul deviat step effect deviat updat n howev order strategi succeed two condit must met name ffl comput residu r n preserv converg mechan origin process steer ffl last updat step termin step k accumul error sigma k small rel ujr upperbound j j discuss next two subsect satisfi two object 21 maintain converg comput residu order r n maintain converg mechan origin updat residu preserv properti give rise converg origin r n therefor need identifi properti lead converg iter method finit precis arithmet may differ individu method observ sever krylov subspac method includ cg 10 20 bicg 20 cg bicgstab bicgstab 18 recurr r similar one q n satisfi almost machin precis small local error one properti behind converg comput residu furthermor analysi 20 suggest converg well maintain even recurr equat perturb perturb significantli greater machin precis latter properti basi residu replac strategi therefor briefli discuss perturb phenomenon bicg cg present 20 consid bicg iter contain r finit denot comput result r n p n respect satisfi perturb recurr round error term bound term u combin two equat obtain follow perturb matrix equat normal form r n1 n invert tridiagon matrix 1 ff 0 ff note 4 equat satisfi exact bicg iter perturb f n particular detail bound n j n mild assumpt lead f n ou main result 20 state sequenc r n satisfi 4 z n1 full rank n case f reduc known theoret bound exact bicg residu 1 therefor even r n exact counterpart complet differ norm bound similar quantiti usual compar cours case bound depend qualiti construct basi importantli closer examin bound reveal even perturb f n magnitud much larger u quantiti bound thu kr n1 k may significantli affect inde 20 numer experi present rel larg artifici random perturb inject recurr r n yet significantli affect converg mechan implic analysi regardless r n gener long satisfi 4 norm bound 6 henc replac r n r assum breakdown iter process occur larg rel kr n k kr see 5 may still expect converg similar fashion inde criterion explain residu replac strategi like r work alway see section 23 use determin safe replac r n r note discuss bicg phenomenon reveal seem valid mani method especi method base bicg cg bicgstab other consid case residu replac carri step r follow definit ffi r updat residu r satisfi thu depend magnitud kj 0 k rel kr k kr mgamma1 k use r may result larg perturb recurr relat therefor residu replac strategi ensur replac done kj 0 kg larg typic iter iter proce kffi n k henc kj 0 increas kr n k decreas replac reduc ffi n order maintain recurr relat carri kj 0 becom larg rel kr n k reason propos set threshold ffl carri replac kj 0 reach threshold precis replac residu step n r note principl residu replac carri step reach certain point howev stabil point view prefer gener residu recurr much possibl sinc kj 0 n k gener bigger recurr round error kj n k order u 22 groupwis solut updat reduc error accumul discuss section 21 learn residu replac carri certain point subsect discuss maintain last replac deviat order ujajjx n j case x n backward stabl solut note x n ukakkx n k lowest valu one expect residu simpli even exact solut x last updat step mena final phase iter process 3 deviat step n updat condit kr n k kj 0 chosen close u kr n k small discuss three differ part ffi n discuss motiv groupwis updat strategi rigor analysi given next section sigma n ffl part j mukakkxk larg accumul error step signific note type error accumul evalu sum small number direct recurs addit fortun correct appropri group arithmet oper term similar order magnitud group delta way round error associ larg number addit insid group magnitud us much smaller us techniqu adopt comput x n specif recurr x n carri follow equival form groupwis solut updat converg end groupwis updat scheme suggest neumaier work sleijpen van der vorst see 18 refer error local recurr reduc inde instead ujx j henc sigma n summari groupwis updat approxim solut three part ffi n maintain level ujajjxj mention groupwis updat also use obtain better perform code modern architectur allow level3 bla oper suggest 21 page 52 note 5 23 residu replac strategi briefli comment residu replac strategi naiv strategi replac alway residu comput alway bgammaax n period replac updat period everi step replac carri throughout iter even kr n k small know may result larg perturb recurr equat rel kr n k sinc jj 0 j least j n j ujajjx n j see 7 case kr n k decreas recurr relat may perturb much henc converg properti deterior typic behaviour observ implement note n made decreas kr n k replac carri later stage iter lead strategi flyingrestart sleijpen van der vorst 18 significantli reduc n henc j 0 n replac step flyingrestart strategi b replac f residu replac step say addit residu replac r advantag flyingrestart step n i1 residu updat r n i1 note b r n decreas r n decreas term determin perturb recurr kept small rel r n howev deviat satisfi assum x n i1 name deviat flyingrestart step carri forward later step therefor flyingrestart use care select step howev easi identifi condit monitor also necessari two differ condit residu replac flyingrestart fortun discuss last two subsect show carri replac care select step combin groupwis updat usual suffici shall pursu flyingrestart idea paper analysi residu replac scheme section formal analyz residu replac strategi develop section 21 present algorithm 2 particular develop comput bound kffi n k n k use implement residu replac condit first summar residu replac strategi follow algorithm written form identifi relev round error later theoret analysi algorithm 2 iter method residu replac given initi approxim float point vector set converg gener correct vector q n method residu replac condit 8 hold els denot comput x end note x n ffi n theoret quantiti defin formula comput vector due finit precis arithmet step n iter method q n comput finit precis arithmet algorithm howev round error involv comput q n irrelev deviat two residu sole depend differ treatment q n recurr r n x n throughout paper assum float point matrix error analysi base follow standard model roundoff error basic matrix comput 8 p66 inequ componentwis float point vector n constant associ matrixvector multipl instanc maxim number nonzero entri per row easi show use follow lemma includ 1 2 obtain lemma 1 error term comput recurr algorithm 2 bound follow step residu replac carri proof 9 j n j ujx lead bound j n j residu replac step updat z x n definit x therefor bound j n n follow similarli number step residu replac carri let later step still next replac step proof first bound follow directli lemma 1 q note similarli consid deviat two residu number iter step residu replac carri let n denot later iter step still next replac step proof step definit xm algorithm 2 z z updat zvector therefor henc rang n next residu replac step lemma 2 obtain follow comput bound ffi n lemma number iter step residu replac carri let n denot later iter step still next replac step proof bound kffi k follow see 14 lemma 2 lemma 3 follow lead bound ffi n term norm note possibl obtain sharper bound accumul vector bound jffi n j experi show signific advantag approach next consid perturb recurr theorem 1 consid step n iter let n last step n residu replac carri replac also done step n let x 0 comput approxim solut r 0 residu residu r 0 n satisfi follow approxim recurr proof first notat alg 2 x 0 use b gamma ax furthermor lemma 3 also kai combin three use r 0 ou bound kj 0 n k obtain lemma 4 note bound 16 comput iter step therefor implement residu replac criterion 8 bound instead kj 0 k note factor 2 bound come bound q lemma 2 pessimist sinc q x therefor use follow n estim kj 0 henc shall use follow residu replac criterion residu replac done strategi replac residu vector r n satisfi recurr equat 15 k properti consid situat r n converg discuss converg true residu theorem 2 consid algorithm 2 residu replac criterion 18 assum algorithm termin step number last residu replac iter step termin proof 17 dk k furthermor termin step kr last updat step n n fflkr n k otherwis would anoth residu replac impli kr upper bound kffi n k lemma 4 impli thu bound follow add two remark respect theorem remark 1 main condit 19 satisfi deviat henc true residu remain level unkakkxk k termin approxim solut backward stabl best one expect condit suggest ffl chosen small otherwis replac strategi termin earli accumul last replac might becom signific expect howev theoret condit restrict practic necessari numer experi suggest ffl much smaller 19 dictat without destroy conclus theorem remark 2 hand section 21 seen ffl control perturb recurr r n reason desir choos small possibl experi larg rang ffl around p u balanc two need reliabl implement iter method section summar main result previou section complet implemen tation also address implement issu easi see definit n see 17 increas except residu replac step reset unkakkxm k residu replac strategi reduc n whenev necessari determin replac criterion keep level unkakkxk k termin use criterion 18 howev situat residu replac carri consecut step n remain virtual unchang name kr n k stay around n ffl unkakkx n kffl stabil point view prefer replac residu situat avoid unnecessari replac case impos addit condit residu replac carri n nontrivi increas dm previou replac step therefor propos n 11d condit addit 18 residu replac follow scheme sketch complet implement algorithm 3 reliabl implement algorithm 1 input initi approxim residu replac threshold ffl estim nkak converg gener correct vector q n iter method end remark reliabl implement need estim n maxim number nonzero entri per row kak experi spars matric simpl choic still lead practic estim n kffi n k case note precis estim essenti replac threshold ffl adjust also need choos ffl extens numer test see section 5 suggest ffl p u practic criterion howev exampl choic lead stagnat residu unaccept level case choos smaller ffl regain converg ou present implement requir one extra matrixvector multipl replac carri sinc step replac requir extra cost margin rel cost howev save made select slightli smaller ffl carri residu replac step next one residu replac criterion satisfi cf 18 also requir one extra vector storag groupwis solut updat z comput vector norm kx n k updat n kr n k usual comput algorithm stop criteria 5 numer exampl section present numer exampl show algorithm 3 work demonstr effect present test result cg bicg cg test carri matlab sun sparc20 workstat exampl unless otherwis specifi replac threshold ffl chosen 10 gamma8 kak1 explicitli comput n set 1 exampl 1 2 also compar n deviat kffi n k exampl 1 matrix finitediffer discret 64 theta 64 grid homogen dirichlet boundari condit ax appli cg reliabl cg ie alg 3 solv linear system converg result given figur 1 figur similarli figur 2 3 next exampl give converg histori normal comput residu cg solid line normal true residu cg dash line reliabl cg dot line b also give normal deviat two residu kffi dashdot line reliabl cg dot line bound n reliabl cg xmark exampl 2 matrix finitediffer discret 64 theta 64 grid follow convect diffus equat homogen dirichlet boundari condit function f constant consid bi cg cg solv linear system result shown figur 2 bicg figur 3 cg exampl observ follow typic converg behaviour origin implement deviat increas final stagnat level exactli true residu stagnat comput residu continu converg reliabl implement deviat increas certain level rel r n residu replac carri reduc error level eventu deviat henc true residu arriv level ukakkxk also note bound n captur behaviour kffi n k close although may overestim ffi n order magnitud three case final residu norm reliabl implement smaller one obtain matlab function anb exampl 3 case test algorithm bicg cg symmetr definit cg harwellbo collect spars matric 3 compar origin impl mentat reliabl implement implement sleijpen van der vorst 18 base replac criteria 16 18 tabl 1 give result matric comput residu converg level smaller ukakkxk deviat two residu case b given choos figur 1 exampl 1 cg solid comput residu cg dash true residu cg dot true residu reliabl cg b dashdot cg dot nk reliabl cg x dn reliabl cg converg histori iter number normal residu norm b residu deviat bound iter number deviat given random vector solut note matric may take 10n iter achiev practic howev includ result order show even excess number iter still arriv small true residu eventu list normal residu re attain three implement gaussian elimin partial pivot matlab anb also list number residu replac n r reliabl implement number flyingrestart n f number residu replac n r implement sleijpen van der vorst svdv two case comput residu converg oukbk choic 8 case slightli smaller ffl recov stabil result list last row tabl see case reliabl implement reduc normal residu ou res2 smallest among three implement even smaller matlab anb improv true residu appar cg bicg cg except case reliabl implement present implement sleijpen van der vorst work well compar main advantag new approach simplic occasion improv accuraci figur 2 exampl 2 bicg solid comput residu bicg dash true residu bi cg dot true residu reliabl bicg b dash bicg dot reliabl bicg x dn reliabl bicg converg histori iter number normal residu norm b residu deviat bound iter number deviat 6 conclud remark present new residu replac scheme improv converg true residu finit precis implement krylog subspac iter method care monitor deviat comput residu true residu incorpor earlier idea residu replac obtain reliabl implement preserv converg mechan comput residu well suffici small deviat error analysi show approach work certain condit numer test demonstr effect comparison earlier approach show new scheme simpler easier implement addon exist implement iter method point basi present work understand converg behaviour comput residu finit precis arithmet preserv small perturb recurr relat support analysi avail bicg cg still empir observ krylov subspac method would interest deriv theoret analysi confirm phenomenon method well acknowledg would like thank ms lorrita mcknight assist carri test harwellbo matric figur 3 exampl 2 cg solid comput residu cg dash true residu cg dot true residu reliabl cg b dash cg dot nk reliabl cg x dn reliabl cg converg histori iter number normal residu norm b residu deviat bound iter number deviat r analysi composit step biconjug gradient algorithm solv nonsymmetr system templat solut linear system build block iter method spars matrix test problem conjug gradient method indefinit system transposefre quasiminim residu algorithm nonhermitian linear system siam j iter solut linear system acta numerica matrix comput behavior slightli perturb lanczo conjugategradi recurr estim attain accuraci recurs comput residu method method conjug gradient solv linear system solut system linear equat minim iter converg rate conjug gradient presenc round error accuraci effect lanczo algorithm symmetr eigenproblem iter method spars linear system pw publish bicgstabl linear equat involv unsymmetr matric complex spectrum electron tran reliabl updat residu hybrid bicg method comput volume56volumepages144163pag year1996year analysi finit precis biconjug gradient algorithm nonsymmetr linear system perform fortran implement precondit conjug gradient vector comput tr ctr stefan rllin martin h gutknecht variat zhang lanczostyp product method appli numer mathemat v41 n1 p119133 april 2002