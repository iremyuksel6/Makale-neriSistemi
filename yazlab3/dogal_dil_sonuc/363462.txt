accuraci decoupl implicit integr formula dynam system often decompos loos coupl subsystem system ordinari differenti equat ode model problem partit correspond subsystem loos coupl exploit special integr method solv problem use parallel comput solv problem effici standard methodsthi paper present accuraci analysi method numer integr stiff partit system ode discret formula base implicit euler formula second order implicit backward differenti formula bdf2 subsystem partit problem discret independ coupl subsystem base solut valu previou time step appli way discret formula call decoupledth stabil properti decoupl implicit euler formula well understood paper present error bound asymptot error expans use control step size relax subsystem valid partit decoupl bdf2 formula analyz within frameworkfin analysi use design decoupl numer integr algorithm variabl step size control local error adapt select partit two version algorithm decoupl implicit euler bdf2 respect use exampl realist problem solv exampl compar result decoupl implicit euler bdf2 formula compar result correspond classic formula b introduct numer solut stiff system ordinari differenti equat ode requir implicit discret formula implicit algebra problem usual solv newtontyp iter method involv solut system linear equat often turn spars attempt parallel standard algorithm one outlin often lead disappoint effici parallel algorithm finegrain larg sequenti fraction waveform relax method 1 although develop parallel comput mind lead effici parallel algorithm class problem work well multir integr consid integr featur waveform relax method relax part method potenti sourc comput ineffici one relax iter fairli expens converg may slow decoupl integr method paper develop respons problem encount parallel standard integr method problem waveform relax decoupl integr method like waveform relax method exploit partit system ode loos coupl subsystem decoupl integr method employ one occasion two relax iter multir integr quit natur waveform relax method although still possibl parallel implement decoupl integr method finer grain parallel waveform relax method decoupl integr method may depart comput scienc univers copenhagen universitetsparken 1 dk2100 copenhagen denmark email stigdikudk effici sequenti comput standard integr method like waveform relax method previou paper introduc decoupl implicit euler method 2 exist global error expans prove gener choic step size thu permit use richardson extrapol suffici condit stabil discret given 3 condit call monoton maxnorm stabil guarante contract partit system ode qualit term character monoton maxnorm stabl subsystem stabl coupl one subsystem other weak paper organ follow section 2 partit system ode decoupl discret formula give preliminari definit includ definit monoton maxnorm stabil present decoupl implicit euler decoupl implicit second order backward differenti formula bdf2 section 3 error bound give error bound classic decoupl implicit euler formula bound close tie monoton maxnorm stabil condit appli euler formula bound readili gener bdf2 formula section 4 asymptot error formula error estim includ four subsect treat explicit formula classic implicit formula decoupl implicit euler final decoupl bdf2 formula explicit formula use error estim predict decoupl formula asymptot error classic formula smallest achiev decoupl formula therefor interest asymptot error decoupl formula given variou mode oper error estim techniqu present section 5 integr algorithm first present gener principl decoupl integr algorithm deriv previou analysi detail implement decoupl implicit euler formula given follow minor modif requir replac euler formula bdf2 formula implement employ variabl step size control local error adapt select partit among two predetermin altern integr algorithm use section 6 exampl chemic reaction kinet real problem solv use decoupl classic version implicit euler bdf2 exampl show excel perform decoupl formula 2 partit system ode decoupl discret formula defin system ode continu stabl system differenti equat consid stiff step size discret explicit integr method limit stabil discret accuraci effici numer integr stiff system therefor requir implicit integr method let origin problem 21 partit 0y 0y 0 10 20 necessari partit state explicitli f r 21 monoton maxnorm stabil follow stabil condit introduc 3 play crucial role stabil decoupl implicit integr method stabil partit system 22 said monoton maxnorm stabl exist norm k delta k r function rj u v rj u v ku follow condit hold logarithm maxnorm 1 delta q theta q matrix rj condit 24 state matrix rj diagon domin nonposit diagon element linear problem rj matrix chosen theorem 3 3 includ result monoton maxnorm stabil includ possibl choic rj monoton maxnorm stabil admit arbitrarili stiff problem 22 decoupl implicit euler stabil converg decoupl implicit euler method defin follow discret subsystem implicit euler formula 2 qn variabl convex combin valu fy ik r convex combin gener depend subsystem index r order simplifi notat depend specifi explicitli method call decoupl algebra system result discret 21 euler implicit formula decoupl number independ algebra problem decoupl implicit euler formula use basi parallel method 25 solv independ parallel differ rvalu method use multir mode h rn 6 h jn r 6 j multir formul use parallel waveform relax method 1 sequenti solut 25 singl processor gener comput cheaper solv complet system therefor decoupl implicit euler method may also attract altern classic euler formula sequenti processor even multir opportun theorem 4 5 3 assur stabil discret 25 monoton maxnorm stabl problem converg waveform relax stabil condit pose restrict choic step size h rn convex rn necessari stabil theorem decoupl implicit euler method convex combin would typic zeroord interpol multir organ linear interpol option multir aspect discuss extens 2 3 result techniqu paper readili extend multir algorithm ever present result multir algorithm would add substanti notat complex furthermor algorithm exampl present section 5 6 respect exploit multir formul therefor multir aspect explor 23 organ jacobi gaussseidel relax definit decoupl implicit euler formula 25 suggest jacobityp organ comput well suit parallel comput defin function g j partit f given 22 jr q assum step size hn subsystem decoupl implicit euler formula express compact form yn definit g j given correspond jacobi organ comput similar gggamma defin gaussseidel organ ggammasr q decoupl implicit euler formula base gaussseidel organ gener accur 27 gaussseidel organ although inher sequenti may still use parallel partit 22 admit redblack reorder similar reorder base color see eg 4 follow gener function g mean either g j gggamma use decoupl implicit euler formula use relax iter m1 yn comput cost iter 29 approxim cost comput yn 27 relax carri converg result discret classic implicit euler discret numer solut n comput accept usual use comput next step denot yn yn n relax 29 subsystem r solv sweep usual newtontyp iter carri converg relax iter base new ton method jacobi gaussseidel organ shown may converg fast substanti less comput per iter rn qn rn potenti parallelis less gaussseidel organ jacobi organ 24 decoupl bdf2 bdf2 also use decoupl mode stabil result formula known linear problem constant step size 5 decoupl bdf2 cours relax euler formula 29 210 m1 3 error bound 31 decoupl implicit euler error decoupl implicit euler formula bound follow consid local truncat error subsystem r decoupl implicit euler formula use jacobi organ r r qn assum monoton maxnorm stabil condit 23 24 fulfil n r introduc simplifi notat n r subtract lead r n bound local error r decoupl implicit euler formula cf lemma 22 section iii2 6 rr n sinc rr 24 r 32 classic implicit euler similar local error bound establish classic implicit euler formula express follow notat analog 25 use monoton maxnorm stabil condit obtain r m1 defin bound local error r classic implicit euler formula analog 32 valid valu step size may interest use valu lt n main differ 32 33 last term 32 local truncat error norm lt n oh 2 order last term 32 oh 2 sinc offdiagon element ij small last term 31 may neglig local error bound decoupl implicit euler formula almost equal local error bound classic implicit euler formula 4 asymptot error formula error estim 41 explicit formula numer solut stiff system ode requir implicit discret formula numer integr algorithm typic also includ explicit formula use error estim comput initi valu iter newtontyp method use solv implicit discret problem decoupl implicit euler bdf2 formula furthermor requir comput yn use explicit formula option explicit euler formula e obviou choic connect implicit euler formula implicit decoupl euler formula howev explicit formula includ f gener avoid connect stiff problem hkfi k ae 1 bound ky e may approach yngamma1 smooth solut case solv approxim yngamma1 therefor polynomi interpol formula prefer predictor 7 linear interpol formula local error expans second order polynomi predictor formula p2 local error expans formula assum 42 classic implicit euler bdf2 classic implicit euler local error express partial deriv rest section 4 comput n eterm obtain substitut expans yn 44 euler formula 43 taylor expand point final identifi eterm equal power hn princip local error term h 2 estim divid differ valu yngamma2 classic bdf2 formula cf 211 local error expans assum princip local error term bdf2 estim error estim 45 47 base divid differ asymptot correct 8 step size vari accord oet suffici smooth essenti step size variat attempt algorithm section 52 43 decoupl implicit euler local error decoupl implicit euler formula 27 depend definit yn number relax iter perform cf 29 two differ mode correspond differ choic yn consid differ number relax iter partit system 22 monoton maxnorm stabl mode 1 discret stabl mode 2 discret guarante stabl 431 mode 1 local error express follow e r term 48 found analog e r term 44 27 1 e 1 e 1 relat gy exploit express e 1 3 element vector 2 g evalu 0 princip local error term h 2 estim use p cf k inequ may fulfil subsystem loos coupl mean guarante monoton maxnorm condit error estim base p use qualiti estim somehow monitor continu e 2 r term 48 found 2 like analog term e 2 e 2 relat gy exploit express e 2 3 classic implicit euler formula therefor princip local error term h 2 2 estim use 45 substitut yn e 1 e 2 term unchang relax iter 3 e ident e 3 classic implicit euler formula 432 mode 2 local error express follow e e e e 1 term 1 1 ident e 1 e 2 classic implicit euler respect e 1 comput cost p n gener much less cost 1 n mode 1 although lead differ e 3 express e 1 3 one valu smaller gener howev use n instead may compromis stabil decoupl implicit euler formula cf section 22 mode 1 e unchang relax iter 2 e 2 develop error term e 3 e 3 given illustr influenc increasingli accur valu decoupl origin problem subsystem effici mode 1 2 decoupl implicit euler formula give result close classic implicit euler formula 2 decoupl poor differ higher order e r e r term signific ky k error expans includ multir integr deriv error expans analog cover multir integr could done use basic definit 25 would notat complic result essenti 44 decoupl bdf2 decoupl bdf2 211 admit natur choic yn decoupl implicit euler formula three mode use increasingli accur yn present mode 1 expect possess best stabil properti among three differ mode although theoret result avail 5 mode 3 second order predictor valu yn expect weakest term stabil properti mode 2 somewher 441 mode 1 error decoupl bdf2 consid 1 subsequ relax iter 212 local error express follow constant step size e r term 411 found analog e r term 44 e 1 e 1 full order accuraci bdf2 reach anoth relax iter perform 2 error term e 2 e 2 ky 3 n k ae k2g princip local error term estim use formula 47 inequ may fulfil subsystem loos coupl guarante monoton maxnorm stabil condit sinc error result 410 oh 2 step might replac decoupl implicit euler formula mode 1 result denot e11 n subsect bdf2 relax 412 replac 2 2 local error expans constant step size 2 9 h 3 decoupl eulerbdf2 combin expect oh 3 error decoupl formula best stabil properti expect base fact decoupl implicit euler formula mode 1 stabl partit system 22 monoton maxnorm stabl result exist decoupl bdf2 formula 410 yet anoth relax iter 2 n 2 3 lead local error expans princip local error term classic bdf2 46 includ case variabl step size princip local error term thu estim use formula 47 comput cost use mode 1 rather high therefor follow mode practic interest 442 mode 2 anoth possibl choic yn comput 41 correspond local error expans constant step size 1 9 h 3 assum princip local error term estim use formula 47 subsystem loos coupl anoth relax iter would lead princip local error classic bdf2 princip local error term estim use 47 443 mode 3 use mode obtain princip local error term classic bdf2 therefor also possibl estim error use formula 47 use n decoupl bdf2 may give rise concern stabil discret 444 summari decoupl bdf2 formula follow tabl summaris local error result decoupl bdf2 formula combin mode number relax error oh 3 princip local error c 3 h 3 one addit relax yn relaxn 5 integr algorithm 51 gener principl previou section present decoupl section 22 variou iter techniqu approach classic implicit euler formula section 23 asymptot local error expans given differ mode employ correspond local error estim techniqu section 43 final similar result present decoupl bdf2 section 24 44 compon use construct numer integr algorithm design decis may guid properti problem solv main object integr algorithm solv problem specifi accuraci use arithmet oper possibl follow discuss deal decoupl implicit euler formula sinc stabil result error bound appli formula bdf2 formula expect analog properti implement decoupl bdf2 formula similar implement decoupl euler formula 511 mode local error bound 31 show accur valu yn reduc influenc partit local error accord section 43 mode 2 prefer mode 1 accuraci comput littl addit cost although ky p 0 revers may true larger valu hn mode 1 therefor prefer altern approach improv accuraci yn relax 29 one relax iter yn consid valu relax increas mode attract respect howev relax comput expens use strictli necessari 512 partit error error due partit describ matrix rj aggress partit small subsystem otherwis scalar equat may lead rj matrix rel larg offdiagon element may diagon domin 24 accord 31 error term includ ky n may therefor contribut significantli conserv partit typic larger subsystem accommod strong coupl assur numer small offdiagon element rj error bound 31 clearli show may lead decoupl euler formula essenti error properti classic formula gaussseidel organ 28 take advantag nonsymmetr structur rj assum partit system 22 reorder symmetr equat number variabl number make rj close lower triangular possibl ka rj rj k ae ka rj rj k 31 modifi follow jr n jr n larger lower triangular n rj valu multipli smaller error smaller upper triangular n rj valu multipli larger error 513 stabil stabil assur matrix rj diagon domin 24 yn convex combin previou solut valu mode 1 latter condit fulfil diagon domin condit may fulfil suffici conserv partit howev monoton maxnorm stabil condit section 21 suffici condit necessari condit therefor mode 2 may use without encount stabil problem also use diagon domin condit 24 fulfil conserv partit 24 fulfil closer fulfil improv stabil like also accuraci cf previou section partit error howev conserv partit lead comput expens discret aggress partit relax iter mode 1 compromis stabil furthermor monoton maxnorm stabil guarante converg process 52 implement detail algorithm use decoupl implicit euler formula bdf2 variabl step size choos two differ partit aggress partit conserv partit aggress partit use smallest subsystem possibl order comput cost conserv partit use somewhat larger subsystem order maintain accuraci transient solut phase decoupl implicit euler formula use mode 2 relax iter n 1 use two relax iter n 2 qualiti partit monitor use 49 classic euler solut comput incur cost mode 1 yn partit criterion therefor replac 2 oe 1 mode 2 1 replac 1 2 mode 1 use two relax iter 2 n alway avail cost involv monitor partit neglig mode 2 use one relax iter therefor cost step partit monitor doubl cost ordinari mode 2 step sinc 2 n requir 2 n avail mode 2 seem obviou return 2 n result step yn 2 n sinc 2 n supposedli accur 1 n howev yn 2 n return occasion yn 1 n common result follow exampl gener oscil local error estim fail improv accuraci therefor yn 1 n alway return mode 2 integr algorithm outlin follow initialis step 1 ffl choos conserv partit n ffl error estim step n n 41 comput 1 n decoupl backward euler formula use mode 2 2 comput mode 1 use predict solut p n inaccur explain monitor monitor partit ffl estim princip local error term use 45 est ffl new step size tol est aggress partit step size formula averag 1 tol est reduc tendenc oscil step size select step size decreas solut may enter transient phase requir conserv partit aggress partit use number step next monitor partit reduc decreas n monitor partit chosen use follow condit monitor partit ffl mode 2 relax decoupl implicit euler formula extra time comput 2 n mode 1 use 1 n follow test 1 2 1 choos aggress partit els choos conserv partit shift conserv aggress partit switch aggress conserv partit reflect aggress partit satisfactori switch opposit direct tent sinc known conserv partit satisfactori aggress partit may also satisfactori therefor first step switch direct monitor algorithm develop present decoupl implicit euler mula modif beyond obviou accommod decoupl bdf2 small euler formula replac decoupl bdf2 211 mode 3 first order predictor replac second order predictor 42 except first integr step still taken euler formula second step use decoupl bdf2 mode 2 princip local error estim use 47 normal fi local error estim introduc 6 section iii2 est fik step size select scheme modifi slightli averag use increas step size est step size averag use increas step size reduc risk instabl prevent rapid reduct step size transient 6 exampl chemic reaction kinet exampl problem mathemat model chemic reaction includ threedimension tran portchemistri model air pollut air pollut model system partial differenti equat equat model transport deposit emiss chemic reaction pollut use oper split number submodel obtain includ follow system nonlinear ode nonlinear mainli product ie p l typic sum term form c ilm ty l ym il ty l respect l 6 chemistri model replic node spatial discret transport part numer solut system 32 ode challeng replic result hundr thousand million equat effici numer solut crucial problem select solut techniqu employ far describ 9 10 system ode stiff real part eigenvalu jacobian along solut rang 0 gamma8 step size rang 100 1000 therefor implicit integr scheme requir result nonlinear algebra problem main comput task involv advanc numer solut one time step method base partit system call euler backward iter method describ 9 character discret implicit euler formula block gaussseidel iter solut algebra equat discret ideal partit would involv subsystem size one ie cf 22 chemic reaction kinet problem would particularli advantag sinc includ l equat never p definit therefor l gener linear solut scalar equat implicit integr formula perform without iter partit scalar equat viabl problem howev paper 9 identifi total 12 equat solv block 4 4 2 2 equat number chemic speci use tabl b1 9 block gaussseidel iter proce follow parenthes denot block equat f1 2 3 12 4 5 19 21 6 7 8 9 10 14 15 remain scalar equationsg partit 9 specifi use basi partit use result 11 9 euler backward iter formula relax converg obtain equival classic implicit euler formula result 11 obtain decoupl implicit euler formula mode 2 one relax time result 11 show good effici approach aggress partit order use exampl decoupl implicit euler bdf2 describ f12 4 5 20 scalar equat 1 2 15 16 remain scalar equationsg subsystem two four equat enclos parenthes rest equat treat scalar equat conserv partit order specifi f12 1 2 15 16 4 5 remain scalar equationsg except block 10 equat partit scalar equat partit consid aggress anoth one fewer equat appear block andor block smaller concern two partit present obviou partit aggress sinc f4 5 1 2 15 16g ae f1 2 15 16 4 5 8 10 29 30g parenthes retain facilit refer partit order specif aggress partit clearli aggress partit present 9 sinc f4 5 1 2 15 16g ae f1 2 3 12 4 5 19 21 8 9 15 16g relat conserv partit obviou sinc one larger block equat appear smaller block partit use 9 presum base knowledg chemic action partit use obtain semiautomat method describ paper 12 none partit monoton maxnorm stabl although come close despit fact instabl problem en counter surpris sinc monoton maxnorm stabil suffici necessari condit stabil decoupl implicit euler formula exampl use paper differ slightli exampl 9 differ appear equat treat scalar consid partit 61 decoupl implicit euler figur 61 show error obtain use classic implicit euler formula solid line decoupl implicit euler formula dashdot line implement describ section 5 two differ partit mention use adapt step size chosen decoupl global integr error time fig 61 integr error classic implicit euler solid line decoupl implicit euler dashdot line implicit euler algorithm obtain local error estim 10 gamma3 minimum step size 90 classic implicit euler formula appli step size select discrep error seen insignific refer solut comput use variabl step size variabl order max imum implement backward differenti formula 13 bound rel local error estim 10 gamma6 error present figur maximum rel deviat refer solut measur componentwis valu compon vari wide magnitud time axi second initi time correspond 6 model includ influenc sun chemic reaction lead distinct transient solut sunris sunset minimum integr time step 90 second larg step integr transient accur larg spike global integr error seen around 7 pm 5 t105000 next day 7 pm t155000 transient behaviour sunris sunset extent consid model artifact sinc larg local contribut global error influenc global error larg essenti ignor introduc minimum time step observ behaviour global error uncommon stiff system ode figur 62 show estim princip local error step size adjust keep estim 10 gamma3 algorithm quit success except transient minimum step size 90 use figur 63 show result step size select upper graph select partit lower graph low valu indic aggress partit high valu indic conserv partit valu ordin axi pertain step size total number step 737 182 25 step use conserv partit e estim local error fig 62 estim princip local error decoupl implicit euler time step size partit fig 63 integr step size select decoupl implicit euler formula upper graph select partit lower graph integr use conserv partit singl step use aggress partit observ first step switch aggress partit qualiti monitor satisfactori monitor partit algorithm immedi return conserv partit exampl demonstr applic implement decoupl euler formula solv nontrivi practic problem comput cost substanti less classic implicit euler formula trace instabl solut comput decoupl implement e global integr error fig 64 integr error classic bdf2 solid line decoupl bdf2 dashdot line time step size partit fig 65 integr step size select decoupl bdf2 upper graph select partit lower graph 62 decoupl bdf2 numer integr previou section repeat use decoupl bdf2 step size control keep estim local normal error est 10 gamma3 result global integr error shown figur 64 dashdot line togeth correspond error classic bdf2 use step size select solid curv deviat notic error decoupl bdf2 compar error classic bdf2 formula compar figur 61 seen global error decoupl bdf2 formula significantli smaller global error decoupl implicit euler formula differ origin mainli transient includ initi transient minimum stepsiz 90 second use final figur 65 show step size partit select similar figur 63 maximum step size decoupl bdf2 greater 1700 three time maximum step size euler formula necessari number integr step 311 42 number step need euler formula conserv partit use 73 step 311 23 substanti payoff use decoupl bdf2 instead decoupl euler formula sinc amount work per step essenti two decoupl formula perform decoupl bdf2 algorithm mode 3 convinc trace instabl although use second order polynomi predictor comput yn somewhat riski stabil point view acknowledg comment editor anonym refere help choos asymptot correct error estim improv present r waveform relax method timedomain analysi larg scale integr circuit method parallel integr stiff system ode stabil backward euler multir method converg waveform relax connect converg properti waveform relax astabl multir integr method solv ordinari differenti equat control order steplength backward differenti method estim error deriv ordinari differenti equat photochem kinet mechan urban region comput model exploit natur partit numer solut ode system aris atmospher chemistri partit techniqu stabil decoupl integr formula ode intgr integr stiff system ordinari differenti equat tr