improv converg radau iia method appli index 2 dae paper present simpl new techniqu improv order behavior rungekutta method appli index 2 differentialalgebra equat shown incorpor effici version code sc radau5 develop e hairer g wanner b introduct recent year differenti algebra equat dae studi variou author see hw91 hlr89 bcp91 import acknowledg develop specif solver dassl pet86 radau5 hw91 especi import class dae aris practic semiexplicit system form g f z assum bound invers neighbourhood solut interest obtain numer approxim accur differenti algebra compon although idea present paper also appli gener rungekutta method focu radau iia method given use build code radau5 construct well properti briefli recal section 11 appli sstage radau iia method order converg respect ycompon zcompon see hlr89 situat get accur valu z may import mechan instanc one led use differ approach gener speak order reduct phenomenon may overcom follow techniqu first possibl consist appli radau iia method index one formul sinc radau iia method appli index one dae exhibit full order converg z see theorem 31 hlr89 order converg 2s gamma 1 also z howev solv consider costli matter fact requir evalu jacobian function f step whenev converg rate newton iter get small instead function f anoth drawback numer solut forc longer lie constraint manifold ii second idea consist comput zcompon solv addit equat g yfi z ie project numer solut socal hidden constraint correspond numer scheme read order converg ycompon still 2s gamma 1 shown also zcompon use implicit function theorem howev techniqu comput demand origin one solv new implicit part n requir accur evalu g step previous mention whenev converg rate newton iter becom small nevertheless note parallel environ addit cost would shadow use second processor paper present third approach requir analyt form g whose comput cost basic equal standard formul base pi n976 4 aubri p chartier observ error zcompon essenti local natur least order converg ycompon consequ make z accur matter recov signific term appear socal bseri error made possibl consid composit basic method sever step note similar idea use rpk chan deal order reduct gauss method appli certain stiff problem see bc93 new order condit determin section 2 deriv straightforward manner work e hairer c lubich roch hlr89 still rel unknown sinc satisfi classic rungekutta method see also bc93 cc95 shown condit actual redund may omit crucial aspect method sinc allow construct formula manag level complex section 3 impli modif code radau5 list final numer result present illustr advantag new techniqu 11 basic properti radau iia method radau iia method defin particular method r character tripl b c ij ij1deltadeltadelta theta matrix sdimension vector sdimension vector sequel furthermor use notat 111 construct radau iia method coeffici uniqu determin follow condit 1 order zero radau right polynomi dx x 2 3 coeffici ij matrix satisfi cs c distinct nonsingular 112 use properti refer addit simplifi assumpt introduc bp cj previou subsect jc butcher see hw91 page 75 irisa improv converg radau iia method appli index 2 dae 5 1 due condit cs bs c method stiffli accur ie vector b solut cramer system 2 colloc method theorem 78 hnw91 page 212 3 4 ds gamma 1 satisfi lemma 54 hw91 page 78 optim converg result obtain method jc butcher one hand theorem 53 hw91 e hairer c lubich roch hand theorem 31 44 46 hlr89 collect tabl 1 tabl 1 optim global error estim sstage method radau iia 12 increas order converg zcompon appli sstage radau iia method c system obtain z coeffici matrix gamma1 4 z n vanish us replac vector b adjust vector 4 defin new method rw easili seen order converg ycompon remain unchang zcompon lack accumul make error pure local converg behaviour zcompon thu entir determin follow order condit theorem 86 88 hw91 proposit 1 let ffi ffi z local error respect z compon rungekutta method dat2 dat2 z set tree phi vectori function fl ae scalar one associ tree 1 nevertheless w enough compon allow order converg greater optim vector henc get suffici freedom need consid composit r oe r oe step variabl step h consid also introduc ratio r character tripl b c ffl blockmatrix block form 1 see hw91 definit notion pi n976 6 aubri p chartier ffl b blockvector b i1deltadeltadeltao block form b ffl c blockvector c i1deltadeltadeltao block form c e replac adjust vector w offer oe theta degre freedom ie hope enough oe 1 increas order converg zcompon aim show construct w implement new method r oew 2 construct vector w section effect construct w describ emphas compon depend r forc one evalu per step howev addit comput becom neglig soon dimens system larg enough 21 order condit condit order k enumer togeth associ tree requir z requir z z let u ac s1 c s1 satisfi c s1 equival requir 2 z z z z z let u s1 ac equival 2 dot stand componentwis product irisa improv converg radau iia method appli index 2 dae 7 requir z z z z z z z z z z z z z let u s2 ac s3 c s3 7 satisfi c s3 equival condit obtain proposit 1 use simplifi assumpt import note composit method r oe satisfi b2 gamma 1 cs ds gamma 1 22 preliminari calculu order later simplifi equat w state basic result eb f proof definit eb gamma1 method c stiffli accur eb theta block matrix gamma1 pi n976 8 aubri p chartier proof definit aa lemma 2 easili prove induct 2 oen oe theta dimension vector ac n1 c n1 u n dimension vector given ks r k1 proof let n less equal 2s gamma 2 expand follow r k1 r k1 e owe cs ks r k1 e similarli expand l r l impli n 2s gamma 2 obtain r l1 e e e improv converg radau iia method appli index 2 dae 9 lemma 4 n less proof follow b2 gamma 1 2 lemma 5 let oen vector gamma1 u n integ n ks proof definit x gamma1 u use lemma 3 obtain ks r k1 ks use lemma 4 complet proof 2 lemma 6 n less 2s proof follow straightforwardli order condit tree z z 1 let oen vector ca ks r k1 2 let oen vector gamma1 cu n ks r k1 proof definit first part result obtain appli lemma 5 let oen denot vector cu n lemma 3 write ks r k2 furthermor z lemma 2 lead ks ngammak n1gammak ks r k1 pi n976 aubri p chartier result becom consequ lemma 4 6 2 lemma 8 n less 2s proof follow order condit tree z z z proof result follow order condit tree z z z z z 23 result 2stage method order get thirdord method w satisfi follow linear system l2 take lead system 4 equat 4 unknown conveni recal coeffici 2stage radau iia method r 312 matrix correspond l2 form henc r 1 2 0 1 nonsingular l2 follow uniqu solut irisa improv converg radau iia method appli index 2 dae 11 24 result 3stage method order get fifthord method w must satisfi follow linear system l3 take lead system ten equat nine unknown howev show section one equat ident satisfi collect result section 22 get r 4 r 4 r 4 3 r 4 r 4 r 4 r 4 r 4 r 4 r 4 r 4 r 4 found r 4 r 4 r 4 r 4 r 4 r 4 system l3 equival theorem linearli depend proof enough show v 1 v 2 u 3 linearli depend sinc c order 5 differenti compon b u impli result2 vector gamma1 u 3 u 3 v 1 exampl becom linearli depend prove suffici show gamma1 u 3 u 3 v 1 depend b gamma1 u pi n976 aubri p chartier 0 conclud theorem 1 case w depend one paramet chosen minim quantiti dat2 z 5g seem natur goal achiev sinc attempt minim local error conveni tabl 2 collect tree dat2 z 5 valu associ function ff fl phi comput ff refer hig93 tree u ffu flu phiu tabl 2 tree dat2 z 5 associ function 25 sketch case achiev order 7 algebra compon solv system l4 compos c 4 section 21 say 24 equat compar number equat number unknown could consequ think take fact shown suffici sinc 5 equat ident satisfi see section 61 howev seem reason consid practic implement correspond method owe complex formula variabl stepsiz remark 2 stepsiz constant ie r equat ident satisfi see section 61 oe chosen equal 4 3 modif code radau5 3stage radau iia method implement e hairer g wanner order solv problem form dae index less equal three solv code call radau5 precis descript given section iv8 hw91 adopt notat use implement method requir slight modif subroutin radcor solout actual replac respect radcorz soloutz irisa improv converg radau iia method appli index 2 dae 13 31 modif radcor comput algebra compon z modifi index 2 dae solv n th step accept two case consid 1 less three step comput keep intern stage z n1 z n2 z n3 step size h n valu 2 three step comput keep intern stage z n1 z n2 z n3 step size h n r 1 r 2 comput formula r w subroutin vectw2 n1 z n1 put z remark 3 continu output need also keep intern stage two step differenti compon see section 322 32 new subroutin 321 vectw2 order comput formal express w creat associ fortran subroutin manipul packag mapl use call vectw2 use format vectw2icasvwr1r2 input one five case describ ica paramet r 1 r 2 r1r2 output vector w vw five case consid 1 1 case seen w depend one paramet optim explain remark 1 2 r 3 r 4 r 5 r 1 allow us reduc cost comput elimin comput problem use gener express w case 5 divis zero would occur case 1 4 322 continu output code radau5 subroutin solout provid user approxim equidist outputpoint correspond interpol formula implement subroutin contr5 contr5ix give approxim u x th compon solut point x lie interv x n x n1 u colloc polynomi degre 3 defin 3 pi n976 14 aubri p chartier index 2 dae polynomi degre 3 satisfi 3 theorem 78 hw91 aim increas order converg algebra compon seem natur search approxim p approxim zx let x form x ngamma2 defin q follow vector satisfi linear system use notat section 24 proposit 2 2 0 1 z l3 possess solut proof theorem 85 86 hw91 accord analysi section 21 lead system z l3 theorem 1 possess solut 2 subroutin vectwz comput w vector w five case consid h depend one paramet case 1 adjust remark 1 case valu defin continu w choosen call vectwz use format vectwzicasvwzr1r2t input one five case describ ica paramet r 1 r 2 respect r1r2t output vector w vwz approxim yx let x form x irisa improv converg radau iia method appli index 2 dae 15 vector satisfi linear system c rungekutta method r 2 obtain composit 3stage radau iia method c two step e vector z proposit 3 proof let us introduc vector follow polynomi u theorem 85 86 hw91 use point intern stage follow p equival system subroutin vectwi comput bj call vectwi use format vectwyvwyrt input paramet r j respect rt output vector bj vwi subroutin soloutz provid user approxim px equidist outputpoint i1deltadeltadeltan differenti compon x form x choosen satisfi x x n1 algebra one x form x ngamma2 choosen satisfi x x n call soloutz use format input number accept step nr x n xold x n1 x n1 z n1 system dimens neq one five case describ comput w ica paramet r1 r2 r1r2 stepsiz h ngamma2 variabl last indic last comput step reach pi n976 aubri p chartier signific digit modifi radau5 figur 1 precis versu comput time algebra compon test problem 4 numer experi 41 test problem consid index two problem psi follow infinit smooth function consist initi valu exact solut code set work4 paramet stop criterion newton method work4 work5 paramet c 1 c 2 stepsiz control see hw91 page 130134 figur 1 plot cpu time number signific digit gammalog 10 absolut error algebra compon code use continu output output requir comput global error take maximum valu figur 2 plot cpu time number signific figur differenti compon code follow problem modifi paramet shown irisa improv converg radau iia method appli index 2 dae 17261014 signific digit modifi radau5 figur 2 precis versu comput time differenti compon test problem 42 pendulum simplest constrain mechan system pendulum whose equat motion describ hw91 page 483485 appli code radau5 modifi code ggl gear gupta leimkuhl formul consist initi valu simplic took figur 3 respect 4 plot cpu time number signific digit algebra resp differenti compon code 43 multibodi mechan seven bodi mechan describ hw91 page 531545 appli code radau5 modifi code index 2 formul consist initi valu figur 5 respect 6 plot cpu time number signific digit algebra differenti compon code output requir 44 discharg pressur control simplifi model dynam simul problem petrochim engin describ hlr89 page 116118 appli code radau5 modifi code follow pi n976 aubri p chartier246810 signific digit modifi radau5 figur 3 precis versu comput time algebra compon signific digit modifi radau5 figur 4 precis versu comput time differenti compon pendulum irisa improv converg radau iia method appli index 2 dae 19 signific digit modifi radau5 figur 5 precis versu comput time algebra compon seven bodi mechan signific digit modifi radau5 figur versu comput time differenti compon seven bodi mechan pi n976 aubri p chartier13579 signific digit modifi radau5 figur 7 precis versu comput time algebra compon discharg pressur control2610001 signific digit modifi radau5 figur 8 precis versu comput time differenti compon discharg pressur control consist initi valu initi step size h equal 10 gamma5 figur 7 respect 8 plot cpu time number signific digit algebra resp differenti compon code output requir irisa improv converg radau iia method appli index 2 dae 21 5 conclus new simpl techniqu overcom order reduct phenomenon appear algebra compon radau iia method appli index two dae propos increas order converg z made possibl consid composit basic method oe step z n1 defin basic method linear combin intern stage good choic oe provid enough freedom order condit associ composit method satisfi determin order condit deriv straightforwardli work e hairer c lubich roch section 21 shown condit redund might omit sstage radau iia method 4 section 23 25 could interest gener simplif radau iia method gener question determin mani composit sstage radau iia method consid obtain order converg equal 2s gamma 1 algebra compon howev seem reason consid practic implement correspond method 4 owe complex formula variabl stepsiz formula incorpor code radau5 develop e hairer g wanner slight modif requir section 3 comput algebra compon modifi new procedur order continu output creat use techniqu compon algebra differenti comput approxim order five equidist outputpoint accord numer experi result differenti compon disappoint howev use techniqu code radau5 lead increas accuraci algebra compon toler suffici small 6 appendix 61 construct vector w case section explain calculu linear algebra use show compos five time sstage radau iia method suffici case expand follow vector c 6 use lemma follow vector c 7 use lemma pi n976 22 aubri p chartier r 6 r 6 r 6 r 6 r 6 r 6 let introduc follow vector idem vector r 6 r 6 r 6 r 6 r 6 r 6 r 6 system l4 equival irisa improv converg radau iia method appli index 2 dae 23 proposit 4 1 linearli depend 2 linearli depend 3 linearli depend 4 linearli depend 5 linearli depend proof express vector suffici show linearli depend idem part 2 5 proposit method c local order 8 differenti compon thu order condit associ tree dat2 7 satisfi particular final obtain b 6 0 henc proposit shown 2 remark 4 step size constant ie r 1 linearli depend 2 linearli depend 3 linearli depend 4 linearli depend henc nine equat ident satisfi p choosen equal four pi n976 aubri p chartier r smooth order reduct effect implicit rungekutta formula numer solut initi valu problem differentialalgebra equat composit law rungekutta method appli index2 differentialalgebra equat coeffici taylor expans solut differentialalgebra system numer solut differenti algebra system rungekutta method solv ordinari differenti equat vol stiff problem differenti algebra problem vol descript dassl differentialalgebra system solver tr ctr frank cameron mikko palmroth robert pich quasi stage order condit sdirk method appli numer mathemat v42 n1 p6175 august 2002 frank cameron matlab packag automat gener rungekutta tree order condit truncat error coeffici acm transact mathemat softwar tom v32 n2 p274298 june 2006