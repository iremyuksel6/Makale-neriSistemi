fast simpl charact class bound gap pattern match applic protein search problem fast search pattern contain class charact bound size gap cbg text wide rang applic among import one protein pattern match instanc one prosit protein site associ cbg rk x2 bracket match letter insid x2 3 gap length 2 3 current way search cbg text convert full regular express howev sophist cbg search pattern match algorithm complic search make slow reason design articl two new practic cbg match algorithm much simpler faster search techniqu first one look exactli text charact second one need consid text charact henc usual faster first one bad case may read text charact propos criterion base form cbg choos apriori fastest perform mani practic experi use prosit databas show algorithm fastest virtual case b introduct paper deal problem fast search pattern contain class charact bound size gap cbg text problem occur variou eld like inform retriev data mine comput biolog particularli interest latter one comput biolog problem mani applic among import protein match last year huge protein site pattern databas develop like prosit 7 11 databas collect protein site descript protein site databas contain divers inform notabl pattern express form class charact bound size gap amino acid alphabet size 20 pattern use search possibl occurr protein longer one exampl protein site number ps00007 pattern express rk x2 bracket mean posit match letter insid x2 mean gap length 2 3 dept comput scienc univers chile blanco encalada 2120 santiago chile gnavarrodccuchilecl work develop author postdoctor stay institut gaspard mong univ de marnelavalle franc partial support fundacion and ecosconicyt equip genom cellul et informatiqu universit de versail 45 avenu de etatsuni 78035 versail cedex email raffinotmongeunivmlvfr work done author institut gaspardmong cite descart champssurmarn 77454 marnelavalle cedex 2 franc current pattern consid full regular express re xed alphabet ie gener pattern compos basic charact alphabet ad empti word also special symbol x match letter ii concaten denot closur latter oper l set word l mean accept word made concaten word l instanc previou pattern consid regular express rjk x x xj dje x x xj note jrej length number symbol search done classic algorithm search howev quit complic need convert automaton search text convert determinist automaton dfa worst case time o2 jrej search linear size n text give total complex o2 jrej n also convert nondeterminist automaton nfa linear time ojrej search text jrej time give total jrej time give review method section 3 major match softwar use techniqu 13 22 none present techniqu fulli adequ cbg first algorithm intrin sequ complic understand implement second techniqu perform poorli certain type re dicult re gener whose dfa larg common case translat cbg re third especi regard size dfa simplic cbg translat correspond re least resort re impli solv simpl problem convert complic one inde experiment time result appli cbg express far reason regard simplic cbg compar search express contain class charact 18 motiv paper present two new simpl algorithm search cbg text also experiment much faster previou one algorithm make plenti use bitparallel consist use intrins parallel bit manipul insid comput word perform mani oper parallel competit algorithm obtain use bit parallel exact string match 2 26 approxim string match 2 26 27 3 17 re match 15 25 20 although algorithm gener work well pattern moder length simpler exibl eg easili handl class charact low memori requir perform two dierent type time experi compar algorithm fastest known search algorithm use cbg pattern prosit databas rst compar pure pattern match ie search cbg compil 6 megabyt protein sequenc tigr microbi databas compar librari match search larg set prosit pattern protein sequenc 300 amino acid algorithm far fastest case moreov second case search time improv dramat algorithm 100 time faster best match algorithm two algorithm present patent french centr nation de la recherch scientiqu cnr 1 use follow denit throughout paper alphabet word nite sequenc charact mean set word build word x 2 factor substr p 2 p written factor x p call sux p prex p 1 patent number 00 11093 depos cnr 083000 inform pleas contact sbastien chiri sebastienchiriestfr fist 135 boulevard saint michel 75005 pari franc note bracket subset element art mean subset fa r tg singl letter express way add special symbol x denot subset correspond whole alphabet also add symbol xa b b bound size gap minim length maxim b cbg formal nite sequenc symbol bracket ii x iii bound size gap xa b dene total number symbol cbg use notat text n charact search cbg cbg match posit j align cbg consid bracket match text letter appear insid bracket ii x match text letter iii bound gap xa b match minimum maximum b arbitrari charact denot minimum size possibl align l size maximum one exampl rk x2 match text posit 11 3 dierent align see figur 1 l 7 r 2y figur 1 three dierent align cbg rk x2 text ahlrkdedati end posit search cbg text consist nding posit j align cbg sux paper organ follow begin section 2 summar two main bitparallel approach lead fast ecient match algorithm simpl string also pattern contain class charact section 3 explain detail approach search full re present section 4 new algorithm call forward algorithm read charact text exactli base new automaton represent simul present section 5 anoth algorithm call backward algorithm despit process text basic left right allow us skip charact text gener faster howev use type cbg sometim slower forward one consequ give next section 6 good experiment criterion enabl us choos apriori fastest depend form cbg section 7 devot experiment result algorithm compar fastest search algorithm 2 bitparallel simpl pattern match 2 new approach text search propos base bitparallel 1 techniqu consist take advantag intrins parallel bit oper insid comput word use cleverli fact number oper algorithm perform cut factor w w number bit comput word sinc current architectur w 32 64 speedup signic practic figur 2 show nondeterminist automaton search pattern text classic pattern match algorithm kmp 14 convert automaton determinist form achiev worst case search time shiftor algorithm 2 hand use bitparallel simul automaton nondeterminist form achiev omnw worstcas time ie optim speedup classic omn simul w shiftor twice fast kmp better use comput regist moreov easili extend handl class charact use notat describ bitparallel algorithm use exponenti denot bit repetit eg denot bit mask length store somewher insid comput word length w use clike syntax oper bit comput word ie j bitwiseor bitwiseand complement bit move bit left enter zero right eg b b also perform arithmet oper bit addit subtract oper bit form number instanc explain basic algorithm later improv b b b figur 2 nondeterminist automaton search pattern text 21 forward scan present shiftand algorithm easiertoexplain though littl less ecient variant shiftor given pattern algorithm build rst tabl b charact store bit mask mask bc ith bit set c state search kept machin word match end text read anoth way see consid tell whether state number figur 2 activ therefor report match whenev dm set set origin new text charact j updat use formula formula correct ith bit set 1th bit set previou text charact new text charact match pattern posit word possibl relat formula movement occur nondeterminist automaton new text charact state get valu previou state happen text charact match correspond arrow final j shift allow match begin current text posit oper save shiftor bit complement correspond selfloop initi state automaton cost algorithm pattern longer comput word ie w algorithm use dmwe comput word simul activ time worstcas cost omnw still averag case cost 22 class charact extend pattern shiftor algorithm simpl also advantag immedi one easi extend handl class charact pattern posit may match singl charact set charact c set charact match posit pattern set ith bit bc c 2 c necessari algorithm 2 show also allow limit number k mismatch occurr onm logkw cost paradigm later enhanc support extend pattern 26 allow wild card regular express approxim search nonuniform cost combin develop bitparallel approach approxim string match lead fastest algorithm short pattern 3 17 case key idea simul nondeterminist nite automaton bitparallel becam gener way simul simpl nondeterminist automata instead convert determinist use paper new type extend pattern focus 23 backward scan main disadvantag shiftor inabl skip charact make slower algorithm boyermoor 5 bdm 10 9 famili describ section bndm pattern match algorithm 18 algorithm combin shiftor bdm advantag bitparallel forward scan algorithm addit abl skip text charact bndm base sux automaton sux automaton pattern automaton recogn sux p nondeterminist version automaton regular structur shown figur 3 origin algorithm bdm 10 9 automaton made determinist bndm instead simul automaton use bitparallel shiftand keep state search use bit comput word b b b figur 3 nondeterminist sux automaton pattern line repres transit ie occur without consum input import fact automaton use recogn sux p also factor p note path label x initi state x factor p nondeterminist automaton run activ state long read factor p sux automaton use design simpl pattern match algorithm algorithm time worst case optim averag log mm time complex variat turbobdm 10 multibdm 9 21 achiev linear time worst case search pattern text sux automaton p ie pattern read backward built window length slid along text left right algorithm search backward insid window factor pattern p use sux automaton ie sux automaton revers pattern fed charact text window read backward backward search end two possibl form 1 fail recogn factor ie reach window letter make automaton run activ state mean sux window read anymor factor p figur 4 illustr case shift window right start posit correspond posit follow letter miss occurr case sux automaton would found factor window new search window search factor dawg fail recogn factor new window secur shift figur 4 basic search sux automaton 2 reach begin window therefor recogn pattern p sinc lengthm window factor p inde equal p report occurr shift window 1 bitparallel simul work follow time posit window text initi scan window backward new text charact read window updat run 1s match suspend scan shift window perform iter report match use mask b charact c store bit mask mask set bit correspond posit revers pattern charact c shift algorithm formula updat bndm faster shiftor bdm 5 100 accommod extens mention particular interest work easili deal class charact alter preprocess far fastest algorithm search type pattern 18 19 note type search call backward scan text charact insid window read backward howev search progress left right text window shift 3 regular express search usual way deal express charact class bound gap actual search full regular express 13 22 gap form xa b convert letter x follow b subexpress form xj tradit techniqu 23 search length om text length n convert express nondeterminist nite automaton nfa om node possibl search text use automaton omn worst case time convert nfa determinist nite automaton dfa worst case time o2 scan text time techniqu propos obtain good tradeo extrem 1992 myer 15 present fourrussian approach obtain omn log n worstcas time extra space simul techniqu aim good tradeo base combin dfa bitparallel simul nfa given 26 20 exist current mani dierent techniqu build nfa regular express r classic one thompson construct 23 build nfa 2m state count number letter second one glushkov construct popular berri sethi 4 nfa result construct advantag 1 state count number letter lot research gluskov construct pursu like 6 shown result nfa quadrat number edg worst case 12 long time open question minim number edg nfa without transit linear number state answer show construct om state omlog 2 edg well lower bound om log edg henc glushkov construct spaceoptim research done also tri construct directli dfa regular express without construct nfa 8 show figur 5 thompson gluskov automata exampl cbg b c e translat regular express b c x xj xj e thompson gluskov automata present particular properti algorithm like 15 26 make use thompson automaton properti other like 20 make use gluskov one final work pursu skip charact search simpl heurist variabl success implement gnu grep tri nd plain substr insid use search substr lter search complet 24 propos reduc search multipattern search possibl string length match use multipattern boyermoor like algorithm 20 propos use automaton recogn revers factor string accept fact manipul origin automaton use bndmlike scheme search factor see section 2 howev none present techniqu seem fulli adequ cbg first algorithm intrinsequ complic understand implement second techniqu perform poorli certain type re dicult re gener whose dfa larg common case translat cbg re third especi regard size dfa simplic cbg translat correspond re exampl cbg rk x2 consid introduct yield dfa need 600 pointer repres least resort re impli solv simpl problem convert x e e e x e e e e14 15 1611785a thompson construct b c x x x e b gluskov construct figur 5 two classic nfa construct exampl b c x xj xj e recal x match whole alphabet gluskov automaton free present diculti perform ecient bitparallel complic one inde experiment time result appli cbg express far reason regard simplic cbg seen section 7 show section cbg search much faster design specic algorithm next section 4 forward search algorithm cbg pattern express search problem pattern class charact gap use nondeterminist automaton compar simpl automaton section 2 one permit exist gap consecut posit gap minimum maximum length automaton use correspond present section 3 although function figur 6 show exampl pattern b c x1 e letter c insert three transit follow letter correspond maximum length gap two transit leav state abc recogn skip one two subsequ edg respect allow skip one three text charact nding cd end pattern initi selfloop allow match begin text posit build nfa start initi state 0 read pattern symbol symbol class charact gap 2 add new automaton edg state new symbol read creat state next pattern symbol class charact c creat state i1 add edg label c state state i1 hand new pattern symbol gap form xa b creat b state label 2 note x singl letter also seen class charact b c x x x e e e figur nondeterminist automaton pattern b c x1 link state j j1 addit creat b transit state state last state creat whole process nal state interest ecient simul automaton despit particular case regular express simplic permit ecient simul particular fast bitparallel simul possibl repres automaton state bit comput word initi state repres alway activ normal shiftand shift bit left use tabl mask b index current text charact account arrow go state j j1 remain problem repres transit sake chose 3 repres activ state 1 inact state 0 call gapiniti state state transit leav gapiniti state correspond gap xa b dene gapnal state ib a1 ie one follow last state reach transit leav exampl figur 6 one gapiniti state 3 one gapnal state 6 creat bit mask 1 gapiniti state anoth mask f 1 gapnal state keep state search bit mask perform normal shiftand step simul move oper rational follow first isol activ gapiniti state subtract f two possibl result gapiniti state first activ result 1 state ib success propag activ state desir target state second inact result 1 ib a1 undesir 1 remov oper result f propag done result alreadi activ state note propag dierent gap interf sinc subtract local eect let us consid exampl figur 6 correspond f mask 00000100 00100000 respect recal bit mask read righttoleft let us also consid read text abc henc mask 00000100 point transit take eect inde f state 3 4 5 activ hand propag formula yield 00100000 00000000 noth chang figur 7 show complet algorithm simplic code assum gap begin end pattern meaningless anyway valu maximum length match obtain om time simpl pass pattern p sum maximum gap length individu class recal number symbol p preprocess take oljj time scan need time 3 possibl devis formula opposit case unlik shiftor faster howev need sever machin word simul thu take ondlw time search p 1m 1n preprocess maximum length match c 2 bc 0 l 0 l f 0 l p j form xa b gap j 1 1 els p j class charact final state scan report match end figur 7 forward scan algorithm 5 backward search algorithm cbg pattern search pattern contain class charact backward bitparallel approach see section 2 lead fastest algorithm bndm 18 19 search done slide text forward direct window size minimum possibl align read window backward tri recogn factor pattern reach begin window found align els shift window begin longest factor found extend bndm deal cbg recogn revers factor cbg use quit automaton built section 4 revers pattern without initi selfloop consid state activ begin creat initi state transit state automaton figur 8 show automaton pattern b c x1 read automaton factor cbg long exist least one activ state b c x x x e e e e e e e e ee e figur 8 nondeterminist automaton built backward algorithm recogn revers factor cbg b c x1 bitparallel simul automaton quit forward automaton see section 4 modic build iton p r revers pattern b bit mask regist state search initi perform initi transit c 0 l 1 1 shift initi loop backward cbg match algorithm shift window size along text insid window travers backward text tri recogn factor cbg automaton recogn factor built revers pattern p r backward search insid window fail ie activ state backward automaton reach begin window search window shift begin longest factor recogn exactli like rst case classic bndm see section 2 begin window reach automaton still hold activ state factor length cbg recogn window unlik case exact string match occurr length pattern automat impli recogn whole pattern need way verifi possibl align much longer start begin window read charact begin window forward automaton section 4 without initi selfloop forward veric end 1 automaton reach nal state case found pattern 2 activ state automaton case pattern occurr start window initi loop forward veric sure nish read l charact text shift search window one charact right resum search figur 9 show complet algorithm optim shown clariti exampl mani test avoid break loop insid variabl reus etc worst case complex backward scan algorithm onl quit bad theori particular let us consid maximum gap length g cbg g everi text window length factor cbg sure travers window backward scan alway shift 1 complex n least consequ backward approach present must restrict least cbg g backward search p 1m 1n maximum length match preprocess minimum length match p j form xa b gap f f j 1 1 b b j 1 l els p j class charact final state forward scan po 0 scan po n b 6 0 l j 0 f 6 0 l po report match begin po b 1 figur 9 backward scan algorithm howev averag backward algorithm expect faster forward one next section give good experiment criterion know case backward algorithm faster forward one experiment search result see section 7 databas show backward algorithm almost alway fastest 6 algorithm use two dierent algorithm forward backward one natur question one chosen particular problem seek simpl criterion enabl us choos best algorithm note end previou section backward algorithm ecient appli length g maximum gap pattern exce minimum length string match pattern backward travers window never nish travers whole window string length g factor possibl pattern occurr carri time posit window text know least g 1 charact window inspect shift moreov window shift g posit henc total number charact inspect across search least g larger n number charact inspect forward scan whenev 2g 1 henc dene g 1 simpl paramet govern perform backward scan algorithm predict 05 point backward scan wors forward scan cours measur perfect disregard eect gap class charact cost forward check backward scan full analysi extrem complic see next section simpl criterion give good result accord criterion design optim version backward scan algorithm idea choos best prex pattern ie prex 1 backward scan done use prex forward veric potenti match done full pattern could extend select best factor pattern code would complic veric phase would scan direct buer would complic see next section dierenc larg 7 experiment result test algorithm exampl 1168 prosit pattern 13 11 6 megabyt mb text contain concaten protein sequenc taken tigr microbi databas set origin 1316 pattern select 1230 whose l maximum length match exceed w number bit comput word machin leav us 93 pattern exclud 62 5 g explain reason search backward scan leav us 1168 pattern use intel pentium iii machin 500 mhz run linux show user time averag 10 trial three dierent algorithm test fwd forwardscan algorithm describ section 4 bwd backwardscan algorithm section 5 opt bwd select backward search best prex pattern accord criterion previou section rst experi aim measur ecienc algorithm respect criterion previou section figur 10 show result pattern classi along x axi g predict 05 valu bwd start wors fwd except except dierenc big anyway also clear opt avoid mani worst case bwd final plot show time fwd stabl forward scan run alway around 5 mbsec backward scan fast 20 mbsec g1ell secsmb bwd g1ell secsmb opt figur 10 search time second per mb pattern classi g 1 valu figur fail show fact prosit pattern low g 1 valu figur 11 plot number pattern achiev given search time remov outlier 12 took 04 second bwd fwd larg peak stabl time backward scan algorithm wider histogram whose main bodi well peak fwd inde 956 pattern search faster bwd fwd percentag rais 976 consid opt plot also show littl statist dierenc bwd opt rather opt use remov bad case bwd third experi aim compar search method convert pattern regular express resort gener regular express search exist algorithm search regular express select follow dfa build determinist nite automaton use search text nfa build nondeterminist nite automaton use search text updat state text posit myer intermedi dfa nfa 15 nondeterminist automaton form block 4 experi block determinist automaton subset state xj express syntax softwar agrep exist softwar 26 25 implement anoth intermedi dfa nfa transit handl use bitparallel transit determinist tabl xj express syntax softwar secsmb frequenc bwd opt figur 11 histogram search time dierent algorithm grep gnu grep option e make accept regular express softwar use heurist addit lazi determinist automaton search look long enough liter pattern substr use fast lter search gap xa b convert fabg permit special treatment grep bndm use backward approach extend cbg adapt gener re instead 20 need build determinist automata one backward search anoth forward veric multipattern reduc problem multipattern boyermoor search string length match 24 use agrep f multipattern search algorithm ad fwd opt algorithm figur 12 show result forward scan algorithm ie fwd dfa nfa myer unabl skip text charact fastest fwd algorithm thank simplic agrep mean much varianc dfa suer high preprocess time larg gener automata nfa need updat mani state one one text charact read myer suer combin show two peak come special code deal small automata backward scan algorithm opt grep abl skip text charact faster previou one almost case among opt faster averag less varianc time grep extend rang surpass time fwd algorithm nonneglig portion pattern grep alway nd suitabl ltere substr case resort forward scan note bndm multipattern exclud plot due poor perform set pattern apart faster text scan algorithm also benet lower preprocess time compar algorithm resort regular express search bare notic previou experi import common scenario protein search problem pattern set search insid new short protein case preprocess time pattern much import scan time normal rather short protein secsmb frequenc opt dfa nfa myer agrep grep figur 12 histogram search time best algorithm regular express search algorithm simul scenario select 100 random substr length 300 text run previou algorithm 1168 pattern tabl 1 show time averag 100 substr accumul 1168 pattern dierenc favor new algorithm drastic note also problem interest eld research multipattern cbg search algorithm algorithm fwd bwd opt dfa nfa myer agrep grep time tabl 1 search time second 1168 pattern random protein length 300 conclus present two new search algorithm cbg ie express form sequenc class charact bound gap cbg special interest comput biolog applic current approach reli convert cbg regular express much complex therefor search cost much higher necessari cbg algorithm specic design cbg base bndm combin bitparallel backward search sux automata combin recent prove eectiv pattern form simpl letter class charact 18 19 extend bndm allow limit gap present experi show new algorithm much faster predict algorithm base regular express search addit present criterion select best among two experiment shown reliabl make algorithm special interest practic applic protein search plan extend present work design algorithm abl skip charact time ensur linear worst case time extend scope present optim algorithm select best factor best prex search challeng type search allow neg gap error match see eg 16 algorithm especi easi extend permit error pursu direct r text retriev theori practic new approach text search faster approxim string match regular express determinist automata fast string search algorithm gener pro regular express dfa use nfa algorithm speed two stringmatch algorithm databas juraj hromkovi fast pattern match string approxim match network express spacer fast bitvector algorithm approxim pattern match base dynam progam fast exibl string match combin bitparallel sux automata fast regular express match multi backward dawg match algorithm multibdm screen protein nucleic acid sequenc librari pattern regular express search algorithm taxonomi toolkit regular languag algorithm fast text search allow error tr regular express determinist automata four russian algorithm regular express pattern match new approach text search fast text search regular express finit automata text algorithm fast bitvector algorithm approxim string match base dynam program program techniqu regular express search algorithm fast flexibl string match combin bitparallel suffix automata textretriev translat regular express small epsilonfre nondeterminist finit automata fast regular express search bitparallel approach suffix automata ctr alberto policr nicola vitacolonna michel morgant andrea zuccolo structur motif search proceed eighth annual intern confer resaerch comput molecular biolog p133139 march 2731 2004 san diego california usa gonzalo navarro mathieu raffinot fast flexibl string match combin bitparallel suffix automata journal experiment algorithm jea 5 p4e 2000