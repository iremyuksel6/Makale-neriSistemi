effici dosresist secur key exchang internet protocol describ jfk new key exchang protocol primarili design use ip secur architectur simpl effici secur sketch proof latter properti jfk also number novel engin paramet permit varieti tradeoff notabl abil balanc need perfect forward secreci suscept denialofservic attack b simplic result protocol must simpl possibl within constraint requir secur requir obviou enough use secur model 7 8 rest howev requir discuss pf properti perhap controversi pf attribut encrypt commun allow longterm key compromis without affect secur past session rather assert must perfect forward secreci cost treat amount forward secreci engin paramet trade necessari function efcienc resist denialofservic attack fact correspond quit nice realiti day internet system compromis exist secur associ reveal plaintext ongo transmiss protocol forward secreci interv secur associ protect compromis occur outsid interv specic allow parti reus secret difehellman expon multipl exchang within time period may save larg number costli modular exponenti privaci properti mean protocol must reveal ident particip unauthor parti includ activ attack attempt act peer clearli possibl protocol protect init respond activ attack one particip must alway go rst gener believ appropri choic protect init sinc init typic rel anonym client respond ident may alreadi known convers protect respond privaci may much valu except perhap peertop commun mani case respond server xed address characterist eg wellknown web server one approach allow protocol allow two parti negoti need ident protect jfk decid unclear metric use determin parti receiv ident protect furthermor negoti could act loophol make initi reveal ident rst instead propos two altern protocol one protect init activ attack anoth protect respond memorydo computationdo properti becom import context recent internet denialofservic attack photuris24 rst publish key manag protocol dosresist design consider suggest properti least import today efcienc properti worth discuss mani proto col key setup must perform frequent enough becom bottleneck commun key exchang protocol must minim comput well total bandwidth round trip round trip especi import factor commun unreli media use protocol two roundtrip need set work secur associ consider save comparison exist proto col ike nonnegoti properti necessari sever reason negoti creat complex round trip henc avoid denial servic resist also relev partiallynegoti secur associ consum resourc simplic properti motiv sever factor ef cienci one increas likelihood correct anoth motiv especi color experi ike even protocol dene correctli must implement correctli protocol becom complex implement interoper error occur often hinder secur interoper design follow tradit design paradigm success internetwork protocol keep individu build block simpl possibl avoid larg complex monolith protocol conscious chosen omit support certain featur felt ad support would caus increas complex disproport benet gain protocol design extent engin activ need provid tradeoff differ type secu riti tradeoff made protocol design other forward secreci comput effort left implement user eg select paramet congur session negoti 2 protocol definit present two variant jfk protocol variant take two roundtrip ie four messag provid level do protect rst variant denot jfki provid ident protect initi even activ attack ident respond protect type protect appropri clientserv scenario initi client may wish protect ident wherea ident respond server public discuss section 4 protocol use basic design iso 97983 key exchang protocol 20 7 modic guarante properti discuss introduct second variant jfkr provid ident protect respond activ adversari furthermor protect side ident passiv eavesdropp type protect appropri peertop scenario respond may wish protect ident note consider easier mount activ identityprob attack respond initi furthermor jfkr provid repudi key exchang sinc neither side prove third parti peer fact particip protocol exchang contrast jfki authent nonrepudi sinc parti sign other ident along sessionspec inform nonc protocol use basic design signandmac sigma protocol 28 appropri modic 21 notat first notat hkm key hash eg hmac29 messag use key k assum h pseudorandom function also impli h secur messag authent place make somewhat stronger assumpt relat h discret logarithm see detail within fmgkea encrypt use symmetr key ke follow mac authent symmetr key ka messag mac comput ciphertext prex liter ascii string r depend messag sender initi respond digit signatur messag privat key belong princip x initi respond assum nonmessagerecov signatur messag compon use jfk ipi initi network address gx difehellman dh exponenti also identifi groupid initi current exponenti mod p gr respond current exponenti mod p ni initi nonc random bitstr nr respond nonc random bitstr idi initi certic publickey identifi inform idr respond certic publickey identifi inform idr0 indic initi respond authent inform eg certic latter use hkr transient hash key privat respond sa cryptograph servic properti secur associ sa initi want establish contain domainofinterpret jfk stand applicationspec bitstr sa0 sa inform respond may need give initi eg respond spi ipsec kir share key deriv gir ni nr use protect applic eg ipsec sa keka share key deriv gir ni nr use encrypt authent messag 3 4 protocol grpinfo group support respond symmetr r algorithm use protect messag 3 4 hash function use key gener parti must pick fresh nonc invoc jfk protocol nonc use sessionkey comput provid key independ one parti reus dh exponenti session key differ independ run protocol long one nonc exponenti chang hkr global paramet respond stay protocol run chang period 22 jfki protocol jfki protocol consist four messag two round trip hhkr grnrni ipi key use protect messag 3 4 ke ka comput hgir ni nr 1 hgir ni nr 2 respec tive session key pass ipsec applic kirishgir ni nr 0 note may differ number bit hmac number produc raw difehellman exchang 512 leastsignic bit gir use key case key use ipsec longer output hmac key extens method ike use gener key materi messag 1 straightforward note assum initi alreadi know group gener accept respond initi reus gi valu multipl instanc protocol respond respond accept group long wish forward secreci interv discuss initi discov group use later section messag also contain indic id initi would like respond use authent idr0 sent clear howev respond id messag 2 also sent clear loss privaci messag 2 complex assum respond accept difehellman group initi messag reject discuss section 25 repli sign copi exponenti group also mod p inform secret key algorithm accept next messag random nonc ident certic string identifi public key authent calcul secret hkr known respond authent comput sponder exponenti two nonc initi network address respond exponenti may also reus regener accord respond forward secreci inter val signatur exponenti need calcul rate respond forward secreci interv exponenti chang final note respond need gener state point cryptograph oper mac calcul respond heavi load pf deem import respond may gener new exponenti correspond signatur use ex chang cours would requir keep state secret part respond difehellman comput messag 3 echo back data sent respond includ authent authent use respond verifi authent return data authent also conrm sender messag 3 use address messag 1 use detect counter cooki jar do attack1 valid authent indic respond roundtrip complet messag 1 2 3 messag also includ initi ident servic request signatur comput nonc respond ident two exponenti latter inform encrypt authent key ke ka alreadi describ encrypt authent use algorithm speci grpinfo respond keep copi r recentlyreceiv messag 3 correspond messag 4 receiv duplic replay messag 3 caus respond simpli retransmit correspond messag 4 without creat new state invok ipsec cach messag reset soon hkr chang respond exponenti gr resent initi respond may gener new gr everi new jfk protocol run eg arriv rate request threshold import respond deal repeat messag 3 describ respond creat new state repeat messag 3 open door attack protocol andor underli applic ipsec note signatur protect encrypt necessari ident protect sinc everyth sign public except sa often guessabl attack could verifi guess ident signatur encrypt messag 4 contain applicationspec inform respond ipsec spi signatur nonc exponenti initi ident everyth encrypt authent ke ka use messag 3 deriv ni nr gir encrypt authent algorithm speci grpinfo r 23 discuss design follow requir respect commun efcienc observ protocol requir two round trip protocol optim protect respond denial servic attack state comput initia 1the cooki jar do attack involv attack will reveal address one subvert host acquir valid cooki number cooki use larg number subvert host launch ddo attack use valid cooki tor bear initi comput burden must establish roundtrip commun respond latter requir perform expens oper time protocol design limit privat inform reveal initia reveal ident sure respond retriev activ attack replay old messag 2 respons initi initi messag retriev initi ident messag 3 complet difehellman comput initi rst messag messag 1 straightforward difehellman exponenti note assum encod selfidentifi manner ie contain tag indic modulu base use nonc ni serv two purpos rst allow initi reus exponenti across differ session differ respond within initi forward secreci interv ensur result session key differ secondli use differenti differ parallel session case assum underli transport protocol ie udp handl demultiplex use differ port initi messag 2 must requir minim work respond sinc point idea whether initi legitim correspond eg forg messag denial servic tack round trip yet occur initi therefor import respond requir point perform expens calcul creat state respond cost singl authent oper cost hmac domin two invoc cryptograph hash function plu gener random nonc nr respond may comput new exponenti gb mod p interact expens option howev time high load attack would inadvis nonc prevent two success session key even initi respond reus exponenti one case side may reus exponenti initi lowpow devic eg cellphon respond busi server simpl way address do period eg everi second gener r grhhkr grsrgr tupl place fifo queue request arriv particular valid messag 3 process rst entri fifo move thu long valid request arriv gener rate pf provid exchang rate valid protocol request exce gener rate jfk implement reus last tupl fifo notic scheme gr may reus differ session session inter leav violat pf secur properti protocol respond will accept group identi initi messag exponenti must group oth erwis may respond exponenti group choos eld grpinfo list group respond r nd accept initi wish restart proto col provid simpl mechan initi discov group current allow respond eld also list encrypt mac algorithm accept next two messag negoti respond right decid strength encrypt necessari use servic note respond creat state send me sage fraudul initi nonexist intent perpetr denialofservic attack respond commit storag resourc messag 3 initi echo content respond messag includ authent authent allow respond verifi roundtrip commun legitim potenti correspond initi also use key deriv two exponenti two nonc encrypt ident servic request initi nonc use ensur session key uniqu even initi respond reus exponenti respond forgotten chang nonc initi valid respond ident send identifi inform ignor public key signatur sent encrypt privaci protect passiv activ attack activ attack replay old messag 2 respons initi initi me sage retriev initi ident messag 3 complet difehellman comput servic request encrypt sinc disclosur might identifi request respond may wish requir certain strength cryptograph algorithm select servic upon success receipt veric messag respond share key parti known initi respond know servic initi request point may accept reject request respond process receipt messag 3 requir verifi authent success perform sever public key oper verifi initi signatur cer ticat chain authent requir two hash opera tion sufcient defens forgeri replay howev could caus consider comput defens cach correspond messag 4 duplic messag 3 seen cach respons retransmit respond creat new state notifi applic eg ipsec key look messag 3 cach authent prevent do attack attack randomli modi encrypt block valid messag caus cach miss thu process done respond authent veri problem messag eg certic verifi respond cach authent along indic failur actual reject messag avoid unnecessari process may part do attack cach messag 3 authent purg soon hkr chang sinc authent longer pass veric cach messag 3 refrain creat new state replay instanc messag 3 also serv anoth secur pur pose respond creat new state send new messag 4 new sa0 replay messag 3 attack compromis initi could replay recent session respond replay messag 3 recent exchang initi respond attack could establish session respond sessionkey would ident key previou session took place initi yet compromis could compromis forward secur initi risk howev keep messag cach long respond machin compromis pe riod perfect forward secreci compromis tune chang mac key hkr frequent cach reset new hkr chosen messag 4 respond send initi respond specic applic data eg respond ipsec spi along signatur nonc exponenti ini tiator ident inform encrypt authent use key deriv two nonc ni nr difehellman result initi verifi respond present particip session decrypt messag verifi enclos signatur 24 jfkr protocol use notat jfki jfkr protocol jfki key use protect messag 3 4 ke ka respect comput hgir ni nr 1 hgir ni nr 2 session key pass ipsec applic kirishgir ni nr 0 parti send ident encrypt authent ke ka respect provid parti ident protect passiv eavesdropp addit parti rst reveal ident initi way respond requir reveal ident veri ident initi guarante activ ident protect respond remark essenti imposs current technolog assumpt tworoundtrip protocol provid do protect respond passiv ident protect parti activ ident protect initi inform argument proce follow do protect place respond must abl send rst messag comput share key sinc comput share key rel costli oper current technolog mean respond send ident second messag without compromis ident protect passiv eavesdropp mean respond ident must sent fourth last messag protocol cons quentli initi ident must sent respond ident sent 25 reject messag instead send messag 2 4 respond send reject instead messag 2 reject ground accept group initi use exponenti accordingli repli indic group accept sinc messag 2 alreadi contain eld grpinfo indic group accept explicit reject messag need efcienc sake group inform could also respond longliv certic initi may alreadi messag 4 reject sever reason includ lack author servic request could also caus initi request cryptograph algorithm respond regard inappropri given request initia tor servic request possibl inform avail respond time day initi locat indic network case respond repli list accept cryptograph algorithm initi would send new messag 3 respond would accept anew respond creat state success messag 3 receipt 3 jfk avoid intent jfk certain thing worth enumer stimul discuss whether certain protocol featur ever appropri jfk miss featur omit design interest simplic 31 multipl authent option obviou omiss form authent certic chain trust parti make provis share secret tokenbas authent certi cate discoveri explicit crosscert pki view best accomplish outboard protocol initi wish reli form legaci authent use protocol dene ipsra41 sacred1 14 ietf work group mechan add extra round trip expens amort across mani jfk negoti sim ilarli certic chain discoveri beyond minim capabl implicit idi idr accomplish protocol de ned purpos exclud protocol jfk exclud secur analysi interfac two certic chain denit standalon secur object also elimin negoti gener favor ukas issu respond respond provid servic entitl set requir servic cryptograph primit mention respond accept initi choos wish thu elimin complex rule select best choic two differ set also elimin need state kept respond initi either accept respond desir restart protocol 32 phase ii lack thereof jfk reject notion two differ phase discuss section 5 practic benet quick mode limit furthermor agre frequent rekey necessari underli block cipher sufcient limit bar longterm use one key proper solut replac cipher exampl 3de inadequ protect high speed transmiss probabl collis cbc mode becom high encrypt 232 plaintext block use ae instead 3de solv problem without complic exchang phase ii ike use sever thing regard necessari one gener actual key materi use secur associ expect done sever time amort expens phase negoti second reason permit frequent rekey final permit sever separ secur associ set differ paramet think appli first modern cipher ae need frequent key chang ae key long enough brute forc attack infeas longer block size protect cbc limit encrypt mani block also feel jfk efcient enough avoid overhead full key exchang requir rather ad new sa exist phase sa suggest full jfk exchang initi instead note initi also choos reus exponenti wish trade perfect forward secreci comput time state alreadi exist initi respond simpli check difehellman exponenti result previou exponenti reus long one two parti use fresh nonc new protocol exchang result cryptograph key fresh subject relat key similar attack discuss section 33 similar perform optim use certicatechain valid second major reason phase ii deadpeer detect ipsec gateway often need know end secur associ dead free resourc avoid black hole jfk done note time last packet receiv peer wish elicit packet may send ping host may declin propos secur associ permit ping packet third reason phase ii gener secur associ control particular sa delet desir wrong prefer burden basic key exchang mechan extra complex number possibl approach requir jfk endpoint implement follow rule new negoti speci spd ident spd exist sa overwrit extent remov need delet sa black hole avoid concern simpli negoti new sa delet sa without replac negoti new sa null ciphersuit 33 rekey negoti sa expir shortli jfk protocol run applic select appropri sa use among mani valid one case ipsec implement switch use new sa outgo trafc would still accept trafc old sa long sa expir address perform consider point properli implement rekey requir one signatur one veric oper direct parti use difehellman exponenti case cach result reus certic receiv id payload compar hash cach id payload receiv peer implement detail natur locat cach past id payload along alreadi establish sa conveni fact rekey like occur exist sa allow expir id inform readili avail match found result expir yet need revalid certic chain previous veri certic chain consid valid shortest crl revalid time certic expir time ocsp result valid time etc certic chain one valu associ time one compon becom invalid need check notic implement need cach actual id payload need hash expir time said reason fast rekey need applic domain done separ protocol 4 toward proof secur section briey overview secur analysi jfk protocol full detail defer full analysi paper current two main approach analyz secur protocol one formalmethod approach cryptograph compon protocol model ideal box automat theoremver tool use verifi valid highlevel design assum ideal cryptographi cryptograph approach account fact cryptograph compon imperfect may potenti interact badli secur protocol proven base underli comput intract assumpt hard factor larg number comput discret logarithm modulo larg prime invert cryptograph hash function formalmethod approach autom advantag less suscept human error oversight analysi hand cryptograph approach provid better sound sinc consid overal secur protocol particular account imperfect cryptograph compon analysi follow cryptograph approach welcom addit analysi particular analysi base formal method would use complement analysi describ separ analysi core secur protocol rather tricki analysi ad secur featur do protect ident protect much straightforward rest section concentr core secur protocol do ident protect discuss previou section 41 core secur use model treatment 7 turn base 6 see refer comparison analyt work roughli core secur key exchang protocol boil two requir 1 parti gener key ka associ session identi peer ident b parti b gener key kb associ session identi peer 2 attack distinguish key exchang session two unbroken parti truli random valu hold even attack total control commun invok multipl session told key gener session stress rough sketch requir full detail see 7 8 show jfki jfkr satisfi requir protocol run perfect forward secreci secur base standard intract assumpt dh problem plu secur signatur scheme secur mac pseudorandom function parti reus dh valu secur base stronger intract assumpt involv dh hmac pseudorandom function rst analyz protocol restrict case parti reus privat dh expon multipl session bulk work techniqu demonstr secur two protocol quit differ 411 jfki basic cryptograph core protocol iso 97983 protocol analyz proven secur 7 protocol briey summar follow salient point protocol parti sign addit nonc two public dh expon ident peer peer ident sign protocol complet broken jfki inherit basic core secur addit jfki add preliminari cooki mechan do protect result ad one ow protocol respond jfki play role encrypt last two messag order provid ident protect initi final note jfki enjoy follow addit prop erti whenev parti p complet jfki exchang peer q guarante q initi exchang p awar ps exist properti essenti context ipsec inde jfkr enjoy properti nonetheless may use context 412 jfkr basic cryptograph core protocol follow design sigma protocol 28 also serv basi signatur mode ike sigma analyz proven secur 8 basic protocol briey summar follow hka nanbb neither parti sign ident peer instead parti includ mac key key deriv gab appli ident concaten na nb jfkr enjoy basic core secur protocol addit jfkr add preliminari cooki mechan do protect result ad one ow protocol respond jfkr play role encrypt last two messag order provid ident protect ident protect passiv adversari cover parti sinc ident sent last two messag next step analysi gener case privat dh expon reus across session done make stronger still reason comput intract assumpt involv dh problem hmac pseudorandom function defer detail full analysi paper 5 relat work basi key agreement protocol base publickey signatur station station sts11 protocol simplest form shown figur 1 consist difehellman exchang follow public key signatur authent step typic use rsa algorithm conjunct certi cate scheme x509 implement second messag use piggyback respond authent infor mation result 3messag protocol shown figur 2 form authent may use instead public key signatur eg kerberos37 ticket preshar secret typic applic constrain environ short version protocol proven efcient13 term messag comput suffer obviou do vulner 51 internet key exchang ike internet key exchang protocol ike15 current ietf standard key establish sa paramet negoti initi respond initi diffiehellman public valu respond diffiehel public valu initi rsa signatur certif respond rsa signatur certif figur 1 4messag station station key agreement protocol ike base isakmp 33 framework provid encod process rule set payload commonli use secur protocol oakley protocol describ adapt st protocol use ipsec2 publickey encrypt mode ike base skeme 27 ike twophas protocol rst phase secur channel two key manag daemon establish paramet authent method encryptionhash al gorithm difehellman group negoti point set paramet call phase sa use infor mation peer authent comput key materi use difehellman algorithm authent base public key signatur public key encrypt preshar passphras effort extend support kerbero tickets37 handheld authent also note ike support key establish mechan besid difehellman although none propos yet3 furthermor two variat phase messag ex chang call main mode aggress mode main mode provid ident protect transmit ident peer encrypt cost three messag roundtrip see figur 3 aggress mode provid somewhat weaker guarante requir three messag see figur 4 result aggress mode suscept untraceable4 denial servic do attack comput memori main mode also suscept untrac memori exhaust do attack must compens implement use heurist detect avoid wit 2we remark howev actual cryptograph core ike signatur mode somewhat differ oakley oakley peer authent guarante parti explicitli sign peer ident contrast ike guarante peer authent parti mac ident use key deriv agre difehellman secret method peer authent base signandmac design 28 3there ongo work still earli stage ietf use ike transport mechan kerbero ticket use protect ipsec trafc 4the attack use forg address send rst messag exchang initi respond initi diffiehellman public valu respond diffiehel anadn cpeurbtilficicvataelus respond rsa signatur initi rsa signatur certif figur 2 3messag station station key agreement protocol respond creat state upon receiv rst messag initi sinc phase sa inform exchang point allow do attack respond memori use random sourceip address send ood request counter respond could employ mechan similar employ counter maintain state receiv rst messag initi will go rst messag roundtrip thu identifi address caus respond difehellman exponenti gener well secret key comput recept third messag protocol initi could fth messag protocol includ larg number bogu certic respond blindli veri signatur jfk mitig effect attack reus exponenti across differ session second phase ike protocol commonli call quick mode result ipsec sa establish two negoti parti threemessag exchang paramet ip secur protocol use espah secur algo rithm type trafc protect etc negoti stage sinc two parti authent establish share key phase quick mode messag encrypt authent use inform possibl deriv ipsec sa key materi share key establish phase difehellman ex chang extent multipl ipsec sa two host need twophas approach result faster lightweight negoti sinc authent inform key materi reus unfortun two host typic establish sa protect trafc limit benet twophas protocol lightweight rekey pf desir benet dilut anoth problem twophas natur ike manifest ipsec use negrain access control network servic mode credenti exchang ike protocol use author user connect specic ser vice complet phase ii exchang done connect gener trafc class pro initi respond initi cooki propos phase1 sa respond cooki accept phase1 sa initi diffiehellman valu nonc respond diffiehellman valu nonc initi signatur cert ident respond signatur cert ident figur 3 ike main mode exchang certic tect sinc credenti public key certic exchang phase ike protect ident initi respond eavesdroppers5 ident includ public key certic inform would allow eavesdropp determin princip tri commun ident independ ip address ike daemon negoti eg temporari address acquir via dhcp public workstat smartcard dongl etc howev sinc initi ident rst messag 5 main mode attack pose respond point protocol attack complet protocol sinc possess respond privat key determin initia tor ident attack possibl respond sinc verifi ident initi reveal ident messag 6 main mode howev sinc respond would correspond server rewal web server etc ident protect provid seem use protect initi identity6 fix protocol provid ident protect initi would involv reduc 5 messag respond send content messag 6 messag 4 posit sideeffect reduc number messag break messag symmetri protocol modular final thank desir support multipl authent mechan differ mode oper aggress vs main mode phase ii distinct protocol specic implement tend bulki fairli complic undesir properti critic compon ipsec architectur sever work includ 12 26 25 point mani decien cie ike protocol specic common implemen 5ident protect provid main mode also known protect mode aggress mode provid ident protect initi 6one case protect respond ident use peertop scenario initi respond initi cooki propos phase 1 sa diffiehel valu respond cooki accept phaisde1nstiati respond diffiehel anavnadluceertif respond signatur initi signatur certif figur 4 ike aggress mode exchang certic tation suggest remov sever featur protocol eg aggress mode public key encrypt mode etc restor idea stateless cooki protect initi instead respond ident activ attack also suggest featur oneway authent similar common practic use ssltls10 web major modic would bring ike protocol closer jfk although would complet address do issu measur complex ike found analys done 34 36 less 13 differ subprotocol iden tie ike make understand implement analysi ike challeng analysi reveal attack would compromis secur protocol identifi variou potenti attack do otherwis possibl valid interpret specic implement decis work done toward address least ex amin do problem found ike31 32 gener alli public key authent protocols30 21 variou recommend protocol design includ use client puzzles23 3 stateless cookies39 forc client store server state rearrang order comput protocol18 use formal method framework analyz properti protocol respect do attacks35 advantag state less least begin protocol run recogn secur protocol context 22 2 latter present 3messag version ike similar jfk provid level do protect jfk ident protect 52 ikev2 ikev216 anoth propos replac origin ike protocol cryptograph core protocol shown figur 5 similar jfkr main differ ikev2 jfkr ikev2 implement do protect option allow respond respond messag 1 cooki sender includ new messag 1 normal condit exchang would consist 4 messag shown howev respond detect do attack start requir extra roundtrip one claim benet extra roundtrip abil avoid memorybas initi respond initi kcoeoykinieg ateri phase sa ateri phase 1 sa respond key respond cooki initi authent phase ii sa traffic selaencdtocresrtiidfiecnatietiess respond authent andracfefrictifsicealetectsor accept phase ii sa figur 5 ikev2 protocol exchang do attack fragmentationreassembl part network stack briey idea behind attack attack send mani incomplet fragment reassembl queue respond deni servic legitim initi ikev2 larg messag last two exchang possibl implement instruct oper system place fragment receiv peer complet roundtrip separ reserv reassembl queue ikev2 support phase ii exchang similar phase iphas ii separ origin ike protocol support creat subsequ ipsec sa singl roundtrip well sateardown use phase ii ikev2 propos contain multipl option combin arbitrari way jfk contrast take approach use ciphersuit similar ssltl protocols10 ikev2 support legaci authent mechan par ticular preshar key jfk design support authent mechan discuss section 3 easi variant jfkr without loss secur feel ad valu compar incur complex justifi inclus featur jfk apart main differ number super cial one eg wire format matter tast differ protocol design philosophi author two propos help creat joint draft19 submit ietf ipsec work group draft set design option reect differ two protocol present work group concurr write paper base draft uni propos written uni propos combin properti jfk ikev2 adopt approach set secur associ within two round trip provid do protect respond particular allow respond almost complet stateless send messag 2 receipt messag 53 protocol predecessor ike photuris24 rst introduc concept cooki counter blind denial servic attack protocol 6messag variat station station protocol similar ike messag layout purpos except sa inform move third me sage rekey twomessag exchang use request unidirect spi thu complet rekey 4 messag need photuri vulner computationbas do attack ike mention nonetheless one variant protocol 4 messag provid do protect via stateless cooki skeme27 share mani requir jfk mani aspect design adopt ike serv set protocol build block rather specic protocol instanc depend specic requir key manag protocol block could combin sever way interest aspect skeme avoid digit signatur public key encrypt use instead provid authent suranc reason behind allow parti protocol abl repudi exchang skip5 earli propos ipsec key manag mechan use longterm difehellman public key deriv longterm share key parti use distribut session key two parti distribut session occur inband ie session key encrypt longterm key inject encrypt packet header scheme good synchron properti term key base version lack provis pf later provid via extens 4 howev author admit extens detract origin properti skip ident protect provid sinc certic use verifi difehellman public key design publicli avail sourcedestin master ident contain packet receiv retriev sender difehellman certic latter use mount do attack receiv forc retriev verifi dife hellman certic comput difehellman share secret host use cryptograph public key host identi introduc set protocol establish sa use ipsec hip protocol fourpacket exchang use client puzzl limit number session attack initi hip also allow reus dife hellman valu period time handl high rate se sion rekey hip packet protect exist ipsec session use hip provid ident protect depend exist outofband mechan distribut certic extra hip messag exchang inform thu messag count effect 6 even 8 common usag scenario 6 conclus year mani differ key exchang protocol propos secur aw other met certain requir jfk address rst issu simplic proof correct full detail defer analysi paper submit proof techniqu advanc enough new protocol deploy without anal ysi also note detail jfk protocol chang order accommod proof toss protocol wall theoretician recip success even proof correct substitut simplic design apart chanc error formal analysi complex protocol impli complex implement attend issu buggi code interoper problem requir issu less tractabl possibl forese threat model oper need chang time thu st suitabl environ denial servic attack concern anoth comparativelyrec requir ident protect precis need whose ident protect threat model still unclear henc need jfki jfkr final perhap import show attribut often tout necess fact suscept costbenet analysi everyon understand cryptograph primit arbitrarili strong cost consider often use decid algorithm key length block size etc show dosresist perfect forward secreci similar charact istic possibl improv aspect protocol notabl number round trip requir treat other paramet system rather absolut 7 acknowledg ran atkinson matt crawford paul hoffman eric rescorla provid use comment discuss hugo krawczyk prove use dan harkin suggest inclus ipi authent david wagner made use suggest format messag 2 jfki design jfkr protocol inuenc sigma ikev2 protocol 8 r tl protocol version 10 cryptograph evalu secur avail credenti credenti server framework internet key exchang ike propos ikev2 protocol attack class address spoo enhanc resist featur propos successor ike proof work bread pud protocol scalabl client puzzl cryptograph countermeasur connect deplet attack analysi ike skeme versatil secur key exchang mechan internet ikesigma protocol httpwww comment 2104 toward network denial servic resist protocol intern inform secur confer ifipsec resolut isakmpoakley modi aggress mode internet secur associ key manag protocol analysi internet key exchang protocol use nrl protocol analyz ieee symposium secur privaci formal framework evalu method network denial servic comput secur foundat workshop open issu formal method cryptograph protocol analysi inform surviv confer exposit kerbero authent author system host protect key exchang manag protocol resourc clog attack ifip tc6 tc11 joint work confer commun multimedia secur cm analysi denial servic attack tcp ieee secur privaci confer ikeisakmp consid harm tr authent authent key exchang entiti authent key distribut stateless connect enhanc resist provabl secur key agreement protocol denialofservic attack secur analysi ike signaturebas keyexchang protocol analysi keyexchang protocol use build secur channel toward network denial servic resist protocol dosresist authent client puzzl protect key exchang manag protocol resourc clog attack proof work bread pud protocol formal framework evalu method network denial servic scalabl flexibl authent servic analysi denial servic attack tcp ctr steven bellovin matt blaze ran canetti john ioannidi angelo keromyti omer reingold fast key key agreement hostil internet acm transact inform system secur tissec v7 n2 p242273 may 2004 suratos tritilanunt colin boyd ernest foo juan manuel gonzlez nieto costbas timebas analysi dosresist hip proceed thirtieth australasian confer comput scienc p191200 januari 30februari 02 2007 ballarat victoria australia kui ren wenj lou kai zeng feng bao jiani zhou robert h deng rout optim secur mobil ipv6 comput network intern journal comput telecommun network v50 n13 p24012419 15 septemb 2006 theodor diament homin k lee angelo keromyti moti yung dual receiv cryptosystem applic proceed 11th acm confer comput commun secur octob 2529 2004 washington dc usa changhua john c mitchel analysi 80211i 4way handshak proceed 2004 acm workshop wireless secur octob 0101 2004 philadelphia pa usa kanonym secret handshak reusabl credenti proceed 11th acm confer comput commun secur octob 2529 2004 washington dc usa zhiguo wan robert h deng feng bao akkihebb l ananda access control protocol twolay architectur wireless network comput network intern journal comput telecommun network v51 n3 p655670 februari 2007 martn abadi bruno blanchet cdric fournet fast key pi calculu acm transact inform system secur tissec v10 n3 p9e juli 2007 heng yin hain wang build applicationawar ipsec polici system proceed 14th confer usenix secur symposium p2121 juli 31august 05 2005 baltimor md martn abadi cdric fournet privat authent theoret comput scienc v322 n3 p427476 6 septemb 2004 martn abadi bruno blanchet analyz secur protocol secreci type logic program journal acm jacm v52 n1 p102146 januari 2005 angelo keromyti janak parekh philip n gross gail kaiser vishal misra jason nieh dan rubenstein sal stolfo holist approach servic surviv proceed acm workshop surviv selfregen system associ 10th acm confer comput commun secur p1122 octob 3131 2003 fairfax va heng yin hain wang build applicationawar ipsec polici system ieeeacm transact network ton v15 n6 p15021513 decemb 2007 robert c chalmer kevin c almeroth secur architectur mobilityrel servic wireless person commun intern journal v29 n34 p247261 june 2004