effici gener share rsa key describ effici techniqu number parti jointli gener rsa key end protocol rsa modulu publicli known none parti know factor n addit public encrypt expon publicli known parti hold share privat expon enabl threshold decrypt protocol effici comput commun result present honest curiou scenario passiv adversari b introduct present ecient protocol number parti jointli gener rsa modulu p q prime end comput parti convinc n inde product two larg prime howev none parti know factor n show parti proceed comput public expon e share correspond privat expon techniqu requir number step includ new distribut primal test test enabl two parti test random integ n product two larg prime without reveal prime sever cryptograph protocol requir rsa modulu none particip know factor good exampl origin fiatshamir authent protocol 19 parti use modulu n none know factor exampl see 18 23 28 30 31 usual modulu n unknown factor obtain ask dealer gener dealer must trust reveal factor n result elimin need trust dealer sinc parti gener modulu n threshold cryptographi concret exampl share gener rsa key use give brief motiv discuss refer 24 survey let pq rsa modulu e sign veric expon respect ie de threshold rsa signatur scheme involv k parti enabl subset gener rsa signatur given messag subset 1 parti gener signatur unlik standard secret share 35 signatur gener without reconstruct privat decrypt expon simpl approach obtain koutofk threshold signatur scheme follow 20 pick random satisfi give parti abstractli sign messag parti comput send combin hold secret combin multipli obtain signatur way parti support darpa contract f3060297c0326 abl gener standard rsa signatur without reconstruct privat key singl locat clearli advantag secur sensit privat rsa key one use certic author construct provid toutofk rsa threshold signatur scheme found 16 13 21 34 import issu left discuss initi gener rsa modulu n share tradit modulu n share privat key assum gener trust dealer clearli dealer anyon compromis dealer forg signatur result elimin need trust dealer sinc k parti gener n privat share result previous known elgam public key system 32 rsa paper organ follow give high level descript protocol section 2 section 35 explain variou stage gener modulu unknown factor section 6 describ protocol given public expon e gener share correspond privat key achiev fault toler one often share use toutofk scheme subset user appli privat key explain toutofk share obtain section 63 discuss variou practic improv protocol section 7 note gener secur circuit evalu techniqu eg 38 26 3 9 also use gener share rsa key primal test repres boolean circuit howev gener techniqu ineci 11 commun privaci model commun privaci model assum protocol follow full connect parti commun parti privat authent channel messag sent parti parti b privat tamper en rout achiev b share secret use encrypt integr authent honest parti assum parti honestli follow protocol end protocol threshold parti enough inform factor gener modulu often call honest curiou scenario section 8 discuss result show assumpt relax recent frankel mackenzi yung 22 show protocol made robust b k 1 malici parti collus protocol b k 1c privat coalit size b k 1c learn inform factor pq howev coalit b k 1c recov factor reason bound relianc bgw 3 protocol one step algorithm bgw protocol provid inform theoret secur henc limit achiev b k 1c privaci honest parti model note possibl achiev k 1 privaci replac bgw step heurist protocol due cock 10 unfortun cock protocol far slower bgw method furthermor secur base heurist argument prove secur properti ie privaci satis protocol provid simul argument compon overview section give high level overview protocol k parti wish gener share rsa key wish gener rsa modulu publicpriv pair expon factor p q least n bit end comput n e public share k parti way enabl threshold decrypt parti convinc n inde product two prime coalit inform factor n high level protocol work follow 1 pick candid follow two step repeat twice secret choic parti pick secret nbit integ p keep secret b trial divis use privat distribut comput k parti determin k divis prime less bound b 1 detail given section 5 step fail repeat step denot secret valu pick rst iter second iter 2 use privat distribut comput k parti comput valu n step reveal inform secret valu detail given section 4 n public k parti perform trial divis test n divis small prime rang b 3 primal test k parti engag privat distribut comput test n inde product two prime test fail protocol restart step 1 note primal test protocol k 1 privat appli whenev two parti involv detail section 3 given public encrypt expon e parti engag privat distribut comput gener share secret decrypt expon detail section 6 notat throughout paper adher follow notat rsa modulu denot n product two n bit prime p q denot p share possess parti similarli q p share among parti denot p ij share p sent parti j perform issu protocol gener two random number test product two prime prime number theorem probabl p q prime asymptot 1n 2 therefor naiv one perform n 2 probe averag suitabl n found somewhat wors expect 2n probe need tradit gener rsa modulu one rst gener one prime use n probe second prime use anoth n probe n2 degrad perform usual unaccept typic fortun thank trial divis thing arent bad trial divis step 1b test prime individu therefor analyz protocol must analyz eectiv trial divis suppos random nbit number p pass trial divis test prime less test take like p prime use classic result due merten debruijn 12 show asymptot prp prime j trial divis henc bit probabl p prime approxim 122 consequ tradit rsa modulu gener requir 44 probe protocol requir 484 probe eleven fold degrad perform unfortun manag discuss method avoid slowdown section 7 gener share step 1 protocol parti uniformli pick random n bit integ p secret share prime p taken sum share sinc sum uniform independ random variabl uniformli distribut p pick distribut slightli less entropi uniform show problem sum n log k bit number one easili show p chosen distribut least n bit entropi sinc n least signic bit p uniformli chosen n bit string log k bit lost entropi help adversari sinc easili guess number parti k small certainli k n formal state next lemma second issu fact share p leak inform factor n instanc parti know p p argu inform help adversari either two issu rais dealt follow lemma let z 2 n set rsa output protocol k parti involv assum k log n lemma 21 suppos exist polynomi time algorithm given random n 2 z 2 chosen distribut share hp least 1n exist expect polynomi time algorithm b factor 14k 3 n integ z 2 n assum hard factor lemma show even adversari given n privat share k 1 parti factor modulu n gener protocol proof lemma somewhat tediou given appendix b distract reader main thrust paper 3 distribut primal test begin detail discuss protocol distribut primal test step 3 parti two secret nbit integ parti know n determin n product two prime without reveal inform factor n refer test distribut primal test primal test probabilist test 36 33 carri z n quadrat extens z n throughout section assum henc result blum integ arrang ahead time parti 1 pick share parti pick share describ test brie discuss structur quadrat extens z n use work twist group n suppos prime factor n 3 mod 4 case x irreduc zn x zn quadrat extens zn linear polynomi gcd follow element tn view linear polynomi linear polynomi f g 2 zn x repres element tn ag 2 z n note element tn also view point project line zn distribut primal test 1 parti agre random g 2 z n valu g known k parti step 2 parti 1 comput jacobi symbol g n g protocol restart step 1 new random g chosen step 3 otherwis parti 1 comput parti comput parti exchang v valu verifi test fail parti declar n product two prime step 4 parti perform fermat test twist group n carri fermat test tn parti pick random h 2 tn parti 1 comput parti exchang u valu verifi test fail n reject otherwis declar success expon comput v step guarante integ divis 4 correct privaci protocol prove next two lemma lemma 31 let pq integ p q 3 mod 4 n product two distinct prime success declar invoc protocol otherwis parti declar n product two prime probabl least 1 2 random choic g h proof observ step 3 protocol test v amount test g n p q14 1 mod n suppos p q distinct prime step 2 verifi g 1 impli also sinc q 1and p 1are odd q 1 mod p mod q sinc follow g n4 1 mod n sinc prime follow test step 3 alway succe similarli show p q distinct prime test step 4 succe sinc root f p f q therefor f p xx f q quadrat extens f p f q respect follow group p order p 1 similarli jt q 1 chines remaind theorem 1 conclud h 2 tn satisfi 1 consequ test step 4 alway succe prove convers suppos least one p q prime ds nontrivi factor n expon use step 3 note e odd sinc p q 3 mod 4 dene follow two subgroup z prove lemma show jhj 1jgj sinc h subgroup g suce prove proper contain h g ie prove exist g 2 g n h four case consid case 1 suppos 3 let r 2 r 3 distinct prime factor n must exist pigeonhol principl let r 1 prime factor n distinct r 2 r 3 let quadrat nonresidu modulo r 3 dene g 2 zn element satisfi mod r 3 3 observ g 2 g sinc e odd consequ g e 6 1 mod n ie g 62 h case 2 suppos gcdp q 1 exist odd prime r r divid p q r 2 divid n impli r divid n follow z exist element g order r sinc r odd g g sinc r divid p q know r divid n consequ impli g e 6 1 mod n henc g 62 h case 3 way fall case 1 distinct prime least one 1 2 bigger 1 case 2 handl n prime power symmetri may assum 1 1 sinc z p cyclic group order r 1 1 contain element order r 1 1 1 follow z n also contain element g order r 1 1 1 g g q 1 divis r 1 1 1 consequ g 4e 6 1 mod n ie g 62 h case 4 left case q 1 sinc know r 4 case may inde happen g show case step 4 primal test fail probabl least half choic h 2 tn dene group h 1g show jh 0 j 1jt n j sinc h 0 subgroup tn suce prove proper contain ie must exhibit element 1 group p order r 1 1 1 therefor contain element h order r 1 follow exist element w 2 tn order r 1 sinc assumpt q 1 mod r 1 know r 1 divid q 1 henc r 1 divid npq1 therefor w complet proof lemma note step 4 protocol need lter integ fall case 4 inde integ pass step 13 exampl consid integ prime integ dene bodi proof consequ integ alway pass step 13 even though product two distinct prime howev fail step 4 section 31 give altern approach ltere integ fall case 4 follow lemma show n product two distinct prime primal test protocol reveal inform privat share particip lemma 32 suppos p q prime coalit k 1 parti simul view primal test protocol consequ protocol k 1 privat proof sinc p q prime know v v dene step 3 protocol also u dene step 4 let u coalit k 1 parti say parti member coalit coalit view consist construct simul coalit view follow simul given coalit input protocol start simul coalit view simul rst pick random g 2 z n g comput u use valu given input next simul must gener um gener um trivial sinc um i6m gener v bit harder proof lemma 31 follow sign v quadrat residu modulo n simul v simul comput ip unbias coin set v accordingli result distribut v comput indistinguish true distribut assum hard quadrat residuos modulo blum integ conclud given n product two distinct prime set valu hu produc simul comput indistinguish real transcript consequ coalit learn inform begin protocol note step 2 protocol crucial without condit step 3 might fail reveal factor even p q prime also note practic probabl non rsa modulu pass even one iter test actual far less half 31 altern step 4 step 4 distribut primal protocol necessari lter integ fall case 4 proof lemma 31 describ altern simpler approach lter integ requir less comput although commun parti observ n fall case 4 1 altern step 4 directli test condit test condit inform leakag parti follow parti pick random r 2 zn keep secret use protocol next section comput mod n without leak inform privat share final parti check gcdz n 1 n reject use bgw method section 41 approach b k 1c privat n fall case 4 reject product two distinct prime pass test overwhelm probabl note altern test elimin valid rsa moduli ie moduli prime 4 distribut comput n next describ comput n parti secret wish make product reveal inform privat share beyond reveal knowledg n 41 bgw method benor goldwass wigderson 3 describ eleg protocol privat evalu gener function three parti full techniqu overkil simpl function mind adapt protocol comput hand minim amount comput commun parti let p n prime unless otherwis state arithmet oper done modulo p protocol work follow c pick two random degre l polynomi word constant term f set p q coecient chosen random z p similarli parti pick random degre 2l polynomi h step 2 comput 3k valu parti privat send tripl hp ij q ij h ij parti j j 6 note standard loutofk shamir secret share p hold step 3 point parti hp parti broadcast n parti step 4 point parti valu n polynomi observ denit f furthermor x polynomi degre 2l note l dene k 2l 1 consequ sinc parti least 2l 1 point x interpol discov coecient final parti evalu 0 obtain n mod p sinc n p parti learn correct valu n descript protocol clear parti learn valu n note protocol requir least three parti involv case exactli three parti linear polynomi use protocol 1privat follow lemma show coalit b k 1 parti learn inform privat share statement hold inform theoret sens complex assumpt need complet sketch proof lemma refer 3 complet detail lemma 41 given n coalit b k 1c parti simul transcript protocol consequ protocol b k 1c privat proof sketch set 1c symmetri may assum coalit made follow consist let index vari l index j vari index r vari k coalit view consist simul coalit view simul given input rst pick random j pick p ri q ri h ri random independ element z p comput pick random degre 2l polynomi x 2 z p x satisfi complet simul set n r r valu perfect simul coalit view protocol consist one phase full bgw method dier bgw protocol need truncat step also combin addit multipl stage one phase result comput surprisingli ecient essenti one multiprecis multipl perform parti one step 3 note commun parti reduc factor two use variant protocol describ 6 section 4 42 bgw modulo non prime descript bgw protocol arithmet oper carri modulo prime come section use run bgw protocol work modulo non prime p k parti wish comput necessarili prime one easili show prime divisor smaller k protocol use inde lagrang coecient use interpol step 4 exist lemma 41 remain correct run protocol modulo contain small factor requir slight modic write prime factor smaller k 2 prime factor smaller k mention protocol immedi work modulo 1 problem work modulo 2 shamir secret share basi bgw possibl instanc consid case 3 possibl use shamir secret share f 3 among k 3 parti sinc f 3 contain enough point shamir secret share parti must given uniqu point simpl solut run entir protocol algebra extens f 3 contain k point simul argument immedi extend case gener one factor 2 prime factor run protocol larg enough extens factor use chines remaind theorem one recov valu n mod 43 share nal outcom case section 62 wish parti evalu function howev result addit share among parti rather becom publicli avail end comput parti inform reveal privat share nal result modic bgw order achiev goal immedi parti perform step 4 protocol perform broadcast describ end step 3 consequ end point polynomi x degre 2l evalu n use lagrang interpol know appropri lagrang coecient therefor rather broadcast n end step 3 parti simpli set result addit share n requir simpl simul argument show minor parti obtain inform protocol 5 trial divis section consid trial divis step step 1b section 2 let integ share among k parti let p small prime test p divid q parti pick random r 2 z p use bgw protocol describ section 41 comput divid q furthermor sinc r unknown minor parti qr provid inform q note approach bad candid q alway reject unfortun good candid might also reject inde even p divid q still possibl allevi problem one repeat test twice small prime p probabl good candid reject 1 one caveat approach bgw protocol describ section 41 appli test divis q small p name p k reason small p eld f p contain enough point shamir secret share among k parti small p one must run bgw protocol extens eld f p contain least k 1 element explain section 42 6 share gener publicpriv key parti success construct rsa modulu may wish comput share given encrypt expon e two approach comput share rst work small e say e 1000 ecient requir littl commun parti second work e still ecient requir commun throughout section set recal public modulu k local comput comput share parti must invert e modulo expos unfortun tradit invers algorithm eg extend gcd involv comput modulo know ecient perform modular arithmet modulu share among particip fortun trick comput e 1 mod modulo reduct singl user involv invers done three step 1 comput 1 observ 0 mod e 3 set inde sinc e 1 mod need modulo reduct sinc e 1 mod immedi deduc 1 mod e method reli observ 61 small public expon begin describ ecient techniqu gener share public expon e small method leak valu n mod e henc appli e small plu side k 1 privat 1 parti jointli determin valu possibl comput l without reveal inform privat share use simpl protocol due benaloh 4 k 1 privat step 2 let parti local comput e result step 3 share enabl share decrypt 20 use equal c c r n parti 1 determin valu r tri possibl valu 0 r k trial decrypt approach leak n mod e r total log e bit 62 arbitrari public expon unlik previou techniqu second method gener share work arbitrari public expon e leak less 2 log k bit inform help oppon sinc easili guess rather expos mod e invert show invert mod e share among parti result inform reveal protocol k 1privat step 1 parti pick random r 2 z e step 2 use protocol section 42 e end comput known parti invert modulo e protocol restart step 1 step 3 parti local comput henc parti abl share invers mod e without reveal inform step 4 next parti agre prime p 2ne view share 0 e element z p use modi bgw protocol section 43 comput addit share parti minor parti learn inform step 5 regard integ 0 p object ensur integ know end step 4 therefor given candid valu 2 0 given correct 0 equal hold integ determin correct protocol proce step 6 possibl valu trial decrypt step 6 succe step 6 assum equal 1 hold integ know e divid see observ therefor parti set result determin valu r tri possibl valu 0 r k trial decrypt protocol leak valu r henc total 2 log k bit expos valu r found use one trial decrypt gateway rst pick random messag ask parti decrypt c parti comput send result gateway perform k multipl gateway nd r 2 0 relat valu r back parti x share accordingli determin procedur repeat k candid valu recal k typic small eg less 10 note 61 observ step 5 protocol need due fact bgw method carri modulo p howev possibl carri bgw protocol step 4 directli integ avoid step 5 altogeth done use variant shamir secret share integ see 21 22 let pick two polynomi follow constant term set f coecient chosen random f0 g interact parti parti comput point polynomi integ point multipli appropri lagrang coecient becom addit share integ unfortun approach result share privat key order n 2 rather n protocol result factor two slowdown threshold signatur gener posit side need leak valu comput 1 mod e step 13 base techniqu due beaver 2 63 toutofk share previou two subsect explain one obtain koutofk share howev provid faulttoler often desir toutofk share enabl subset parti appli privat key simplest solut due rabin 34 make use gener techniqu convert koutofk share privat rsa key toutofk share scheme rabin approach immedi appli koutofk share obtain optim describ sever practic techniqu improv perform distribut protocol optim incorpor implement protocol 29 siev step 1 protocol section 2 parti repeatedli pick random share integ nd one divis small prime engag interact trial divis protocol brie outlin ecient approach let product odd prime less bound b 1 suppos k parti could gener addit share random integ z parti could set share p random number appropri length make p nbit integ result candid prime random nbit integ rel prime need run trial divis protocol p prime less question remain parti gener addit share random integ 2 z parti gener random element b 2 z random element z parti use bgw method section 43 convert multipl share addit share one caveat work bgw method must made work zm eld done explain section 42 load balanc step 3 primal test parti 1 comput parti comput v notic n 1 roughli 2n bit bit consequ parti 1 work twice hard parti even thing make sens test k candid n parallel test role parti 1 play dierent parti way g n1 mod n comput dierent parti n result better load balanc improv perform factor two parallel trial divis recal n comput parti perform trial divis invok distribut primal test step 2 section 2 k parti perform trial divis parallel parti charg verifi n divis set small prime ecient done hardcod prime rang b list parti charg test n divis prime p j j mod k factor k speedup enabl us use larg bound b 2 increas eectiv trial divis fermat lter need run full primal test section 3 everi candid modulu n instead one fermat test rst proceed perform full test fermat test succe refer test fermat test equal hold n product two prime carri test zeroknowledg k parti comput v verifi protocol easili shown k 1 privat save comput jacobi symbol g integ n avoid quadrat slowdown section 2 note protocol suer quadrat slowdown comparison singl user gener rsa key main reason prime p q gener brie outlin potenti solut consid case three parti alic bob carol could gener n alic p r p nbit prime bob q b r b q b nbit prime carol r c number probe r found prime singl user gener n henc abl avoid quadrat slowdown furthermor singl parti know complet factor result n unfortun approach doesnt scale well enabl tprivaci n must product prime also note exampl parti must perform distribut primal test verifi n product three prime techniqu paper easili gener enabl test note one use recent result 7 test share modulu product three prime without reveal factor 8 robust throughout paper use model parti honestli follow protocol ne parti honestli tri gener share rsa key applic desir make protocol robust activ adversari cheat protocol sinc rsa function veriabl parti simpli check correctli decrypt encrypt messag activ adversari limit amount damag caus howev may still possibl parti cheat protocol consequ abl factor result n similarli parti cheat caus nonrsa modulu incorrectli accept recent frankel mackenzi yung 22 show protocol made withstand malici parti protocol enabl parti detect exclud malici parti practic one could run nonrobust protocol modulu n found believ product two prime robust frankelmackenzieyung protocol use determin major parti cheat nonrobust phase result robust gener share rsa key see 5 describ simpl method make nonrobust protocol robust number particip small eg less ten consid case four parti one malici one run nonrobust protocol candid modulu n found point protocol run four time triplet user rst run three parti write 4 random integ rang 0 n parti 1 send p 0 parti valu nonrobust protocol among three ignor parti 1 result n match n comput four parti involv n turn rsa modulu n reject parti announc one misbehav experi repeat four triplet time exactli one parti exclud comput assum one parti malici result n must product two larg prime furthermor malici parti know factor n sinc point protocol honest parti reveal inform share anoth singl parti note approach enabl parti detect cheat help detect malici parti gener k parti engag nonrobust protocol c malici protocol made robust cost k c extra invoc result comput privat clearli approach appli long k c small 9 summari open problem present techniqu allow three parti gener rsa modulu parti convinc n inde product two prime howev none factor n method achiev b k 1c privaci also show show parti gener share privat decrypt expon allow threshold decrypt test n product two prime present distribut doubleprim test note test recent extend tripleprim test 7 enabl k parti test n product three prime without reveal inform factor demonstr eectiv protocol implement gener 1024 bit share rsa key among three 300mhz pentium machin take 90 second see 29 descript implement well detail time measur import open problem gener share key special form exampl modulu product safe prime ie p 1and q 1are prime consid secur purpos 27 well technic reason relat threshold cryptographi 16 25 current techniqu enabl share gener moduli special form progress direct would help acknowledg thank beaver help discuss result r univers class hash function number uncancel element siev eratosthen foc 1986 pp 162167 cock multipl method bgw protocol describ section 41 achiev b k 1 2 c privaci inform theoret secur cock 10 describ multipl protocol heurist appear provid k 1 privaci unfortun cock protocol far slower bgw method furthermor seem possibl prove secur use natur tr strong prime easi find play mental game prove practic solut identif signatur problem share homomorph keep share secret secret practic zeroknowledg protocol fit secur microprocessor minim transmiss memori zeroknowledg proof ident complet theorem noncryptograph faulttoler distribut comput multiparti uncondit secur protocol knowledg complex interact proof system noncryptograph faulttoler comput constant number round interact modif fiatshamir scheme practic protocol larg group orient network fast signatur gener fiat shamirmyampersandmdashlik scheme share function secur robust effici distribut rsakey gener share secret two parti rsa key gener secur comput abstract share gener authent signatur extend abstract robust effici share rsa function simplifi approach threshold proactiv rsa gener share rsa key two parti effici dynamicreshar verifi secret share mobil adversari knowledg gener rsa paramet gener product three prime unknown factor optimalresili proactiv publickey cryptosystem secur fault toler commun complex distribut system ctr jaime brown juan gonzalez nieto colin boyd effici secur selfescrow publickey infrastructur proceed 2nd acm symposium inform comput commun secur march 2022 2007 singapor dan boneh xuhua ding gene tsudik finegrain control secur capabl acm transact internet technolog toit v4 n1 p6082 februari 2004