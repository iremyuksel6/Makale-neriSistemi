new multivari product densiti estim let x rdvalu random variabl unknown densiti f let x1 xn iid random variabl drawn f object estim fx studi pointwis converg two new densiti estim hilbert product kernel estim dn i1nj1d12log nxjxij hilbert knearest neighbor estim kd12dnlogd1nkd1 j1dxjxkj xk kth nearest neighbor x point order increas valu product j1d xjxkj auxiliari result need permit us formul univers consist result pointwis l1 product kernel estim differ window width coordin rectangular partit tree estim particular show local adapt smooth factor product kernel estim may make kernel estim inconsist even standard condit bandwidth b introduct object note studi two new multivari densiti estim avoid messi problem smooth factor select one case least invari ane transform coordin provid easi mean jointli estim 2 margin densiti densiti f ir byproduct abl studi univers consist product kernel estim rectangular partit estim independ observ ir valu random vector x unknown densiti f classic kernel estim f h 0 smooth factor depend upon n k absolut integr function kernel k h 1956 observ kernel smooth factor h cancel obtain one may wonder happen situat smooth factor absent problem dealt devroy krzi zak 1998 show follow theorem 1 hilbert estim fn x v n log n v volum unit ball ir weakli consist almost x probabl almost x use name hilbert estim relat hilbert integr similar ker nel hilbert estim invari ane transform coordin transpar notat fn x denot densiti estim x ir given data ir bay denot sampl size n ith coordin observ transform kernel densiti estim invari may obtain one use product kernel howev caus addit problem compon kernel requir smooth factor appli principl hilbert estim obtain product hilbert estim log nx x ji estim smooth factor invari mention follow readili howev weak pointwis consist hold ir 1 densiti counterexampl provid fact product kernel estim posit smooth paramet known h h h 0 nh fn f probabl almost x k bound compact support densiti devroy gyorfi 1985 r f almost sure k r howev less known allow individu smooth factor tend zero dierent rate allow depend upon x univers lost natur condit h would seem lim lim within condit k uniform densiti 1 1 exist densiti f almost everywher probabl turn sucient condit f almost everywher pointwis converg r f log d1 f proof counterexampl follow section 3 paper explor sucient condit variou type converg estim discuss context jessenmarcienkiewiczzygmund condit consist prove multivari hilbert product estim product nearest neighbor estim hasa nearest neighbor rank invari scale axe desir featur highdimension data collect ordinari product kernel estim final treebas rectangular partit estim 2 sum product invers uniform product iid uniform 0 1 random variabl densiti given log d1 1z 1 let z 1 zn iid distribut z lemma s1n log n probabl proof result follow theorem 2 rogozin 1971 theorem 881 bingham goldi teugel 1987 stabil sum iid random variabl function f snan 1 probabl r x slowli vari function chosen la n n 1n take r x log xd take log xd nlog nd inde nlog ndd n log 3 sak rariti theorem implic understand reason defin condit f help understand reason go back theori dierenti de guzman 1981 good refer consid function f ir togeth collect b bound measur set properti everi x ir exist sequenc b diamet written diam decreas zero x collect call basi collect set b contain x denot bx defin upper lower deriv f respect de guzman 1981 p 105 say dierenti f f almost everywher x exampl known b collect ball hypercub dierenti integr function f form celebr lebesgu densiti theorem basi pointwis converg properti kernel estim inde densiti estim let b 2 denot interv basi collect product finit interv contain least two point collect bound rectangl posit measur align axe requir follow result lemma a1 jessenmarcinkiewiczzygmund theorem 1935 b 2 dierenti l1log function f ir includ densiti f inde except good account chapter 7 de guzman 1981 p 167 first accord sak rariti theorem sak 1935 exist nonneg function f ir 2 f almost everywher x respect b 2 later marstrand 1977 found f properti work orient axe orient axe dierent collect b 2 el helou 1978 found f latter properti addit z f log 1 0 1 thu respect b 2 logarithm condit f nearli necessari consid standard kernel estim ir 2 product kernel 4 x1 1 x2 1 dierent smooth factor coordin form x1 x j1 h1 x2 x j2 h2 easi see result mention exist densiti f 0a1 l1 almost x exist h efn x note result impli h 1 h 2 allow depend upon x varianc fn oefn xnh 1 h 2 easi see nh 1 h 2 fn xefn x 1 probabl almost x thu fn x probabl almost x therefor one adapt smooth factor x true longer kernel estim pointwis consist densiti turn final basi b 3 rectangl ir 2 rotat respect possibl orient situat extrem volatil de guzman 1981 p 224 b 3 even dierenti characterist function bound measur set counterexampl dierenti fail includ densiti bound measur set area 1c special select subset nikodym set n 0 1 2 n measur one x n exist line lx x lx x take f implic exist inconsist kernel estim rotat kind almost everi x exist smooth factor standard condit smooth orthonorm rotat matric x kernel estim kan xx x j almost x 4 x1 1 x2 1 thu adapt x allow adapt rotat make kernel estim potenti inconsist even bound densiti compact support remaind paper rectangl set b 2 b 3 4 weak pointwis consist multivari hilbert product kernel estim section prove main consist theorem theorem 2 assum f densiti r f log d1 1f r g log s1 margin densiti g denot dimens domain g multivari hilbert product kernel estim weakli pointwis consist almost everywher almost x probabl proof let denot space diagon matric diagon element 1 1 clearli vector ir fix x ir defin flip densiti x mean x observ particular f f bona fide densiti support posit quadrant origin x jessenmarcinkiewiczzygmund theorem lemma a1 b 2 denot interv basi ir almost x lim impli almost x lim x z dz x x x denot rectangl q see note follow let b form x diamb 0 vari x mm z mb x dz littl excurs allow us studi behavior f x instead f interestingli see flip appli estim fn leav fn unalt thu show fn f almost x equival show fn x f x x2 almost x remaind proof requir introduct margin densiti fs f xs thu fs margin densiti f respect compon whose index similarli f xs margin densiti f x respect compon whose index call x jmz point jessen marcinkiewicz zygmund lim xs sdimension vector compos compon x whose index b collect rectangl sdimension space lemma a1 almost point jmz point fix x remaind proof 0 thu find 0 simultan ys xs r xs ys xs z dz xs xs also recal f xs lemma b1 let jmz point f fx 0 let let random vector densiti f let 1 nonempti set indic let event x condit exist iid uniform 0 1 random variabl u denot stochast domin proof assum without loss gener f x f instead f xs condit x densiti f p note 0 furthermor f multivari distribut function condit x x jmz point therefor wellknown f x 1 seen appli probabl integr transform condit distribut function condit decomposit f see return proof theorem remain defin earlier enlarg data consid infinit iid sequenc 1 2 distribut x let collect indic ji ji x point let let collect first n indic j lemma b1 u 1 u lemma b1 lemma s1 righthandsid probabl asymptot thu contribut j j asymptot neglig assum first f take longer aord artifici increas data size thu let j n j note binomi n p independ u lemma b1 easi see righthandsid probabl asymptot np x x log similar weak lower bound obtain let 0 obtain sought result contribut term densiti estim log n seen last chain inequ well size less thu proof theorem 2 complet 5 lack strong converg f true almost x fx 0 hilbert product kernel estim possibl converg f strong sens rather prove fullblown univers theorem restrict uniform densiti real line recal follow result devroy krzi zak 1998 applic hilbert product kernel estim coincid standard hilbert kernel estim theorem 3 let f uniform densiti 0 1 x 0 1 pfn x log log n strong converg point support poor rate converg estim best seen consid point outsid support f x least distanc away support f fn x cs log n constant c depend upon k 6 product nearest neighbor estim knearest neighbor densiti estim fix hodg 1951 loftsgaarden que senberri 1965 x kx kth nearest neighbor x among properti wellunderstood moor yackel 1977 devroy wagner 1977 mack 1980 bhattacharya mack 1987 mack rosenblatt 1979 exampl almost x g kn x fx n k knearest neighbor densiti scaleinvari rel order distanc coordin linearli scale remedi introduc product knearest neighbor densiti estim log d1 nkd 12 permut x 1 x accord increas valu permut invari linear transform coordin axe rotat interestingli product estim consid except trivial case obtain standard univari kth nearest neighbor estim choic scale perpetu caus concern estim product kth nearest neighbor estim particularli use prove weak consist theorem 4 k k k log n 0 r f log d1 f 1 r g log d1 g lowerdimension margin f almost x jmz point f lowerdimension margin f g kn x fx probabl proof theorem 4 sketch rough outlin mimick proof theorem 2 note first may wish consid flip densiti x 2 fy x coordin least equal x consid small squar size coordin bottom lower vertex x show kth nearest neighbor x probabl tend one squar inde 1 densiti f x jmz point q approxim distribut u iid uniform 0 1 random variabl f u densiti log d1 1zd 1 z 0 distribut function z log d1 1zd 1 z 0 see order statist sampl size n drawn q approxim distribut f inv 1nf x f inv 2nf x forth f inv invers distribut function good approxim f inv u ud 1log d1 1ud 1 thu kth nearest neighbor valu concentr probabl 1kn concentr follow k need show probabl kth nearest neighbor squar tend one end show nearest neighbor among point coordin outsid squar coordin squar distanc alway measur q asymptot much larger without loss gener fix first 1 coordin x also jmz point margin densiti last coordin given first coordin outsid squar remain one insid assum small enough nearest neighbor distanc asymptot order 1n log dm1 n thu improb kth nearest neighbor point coordin outsid small squar conclud sketch proof 7 product kernel estim section consid product kernel estim defin univari kernel r k 1 smooth factor h ni determinist sequenc product kernel estim interest oer scale invari h ni proport scale eg make h ni proport weight sum n may introduc big dierenc h ni fact dierenc may desir situat like one let f product two univari densiti smooth one jag one densiti one may want pick dierent smooth factor even dierent order kernel case h n1 h n2 may tend zero dierent rate densiti local product densiti resembl uniform densiti realli import consid product kernel individu pick smooth paramet interest literatur oer littl help respect univers consist properti estim respect pointwis l 1 converg natur condit h ni would appear lim lim section prove two basic consist result abl find vast literatur theorem 5 let fn product kernel estim let compon kernel k absolut integr natur condit 1 2 lim f theorem 6 let fn product kernel estim let kernel k bound compact support riemann approxim l sens k closur space function finit weight sum indic finit interv natur condit 1 2 lim almost x provid r f log d1 1 note condit kernel satisfi kernel k continu bound compact support bit eort extend theorem 6 includ kernel k k o1x x perhap easiest proof theorem 5 transpar one use embed devic devroy 1985 embed use handl l 1 consist variabl kernel estim may summar follow lemma lemma b2 let f g two densiti ir let densiti estim base iid sampl size n drawn f assum sup constant c g n densiti estim base upon iid sampl size n drawn g proof consid uniform poisson point process ir 0 2 let u v typic point process keep point v fu v gu almost sure finit number point poisson 2t distribut may order point accord increas valu obtain u 1 first n valu u j yn first n valu u j v j gu j throw away poisson point process need coupl two sampl interestingli x 1 iid drawn f 1 yn iid drawn g also everi r maxf g dx r maxf g one tripl u gener common point sampl thu number common point stochast greater binomi n p random variabl number point one sampl seen sampl binomi n 1 p random variabl expect valu exceed n1 may assum fn gn base coupl x j j sampl respect r f n gn cnn n appli triangl inequ n n time proof theorem 5 first verifi lemma b2 appli kernel estim kernel k inde n z z n lemma b2 appli kernel k nonneg simpli 2 lemma 2 suce prove theorem 5 continu densiti g compact support densiti dens l 1 space densiti inde pick g continu compact support r f g let fn g n denot product kernel estim base sampl drawn densiti f g respect appli lemma b2 arbitrari suce therefor prove theorem 5 g sinc k measur absolut integr may approxim l 1 sens sum indic function interv thu 0 find finit number interv ij coecient k ij l even pick r l also r l r k r k 1 1 defin constant fn g n two product kernel estim data dierent product kernel k i3 i2 i3 arbitrari natur suce consid kernel product finit sum weight indic function interv let n bound number indic compon kernel easi see form cartesian grid interv estim equival kernel estim kernel shorthand notat rectangl ir vertic j b j j real number also r denot volum j b j introduc notat note j bona fide kernel integr one let fn denot kernel estim kernel l f continu densiti compact support f nj kernel estim kernel j upper bound tend zero mean individu term tend zero thu suce prove theorem kernel indic function rectangl theorem 6 ef nj f 0 bound f almost x domin converg conclud proof theorem 5 proof theorem 6 let x jmz point f let kernel proport indic bound rectangl necessarili contain origin vertic r vari coordin turn see z point ir denot volum 0 z p let mn denot diagon matrix element h n1 h nd diagon lemma a1 condit 1 thu r k 1 conclud efn fx rn q therefor r xmnr f rn x jmz point lemma a1 2 turn gener kernel take work gener result reason big class kernel easi verifi last chain inequ condit 2 bound kernel varfn x 0 point x efn x fx thu theorem 6 valid bound kernel 1 impli efn x fx almost x find 0 finit collect rectangl r constant sup x 0 larg posit integ integr note efn last step use 1 first part proof kernel indic rectangl sinc arbitrari proof complet 8 treebas rectangular partit densiti estim let 1 2 sequenc partit ir rectangl open close x let x denot rectangl x belong partit estim f given lebesgu measur denot number data point fall set assum sequenc partit pick data collect present estim contain standard histogram estim inde treebas densiti estim purpos section discuss univers consist pointwis l 1 l 1 consist rather gener theorem aboujaoud 1976a 1976c theorem 7 special case howev includ proof short use new tool l converg dealt aboujaoud 1976b irrelev gener consist theorem partit estim estim partit space via order statist hanna abou jaoud 1981 via multivari rectangular partit gessaman 1970 dicult problem univers converg point view pointwis converg give theorem theorem 7 let fn partit densiti estim assum diaman x 0 almost x nan x almost x lim condit f theorem 8 let fn partit densiti estim assum diaman x 0 almost x nan x almost x r f log d1 1 f almost x proof let x jmz point f r fx 0 thu lemma a1 theorem prove almost point fx 0 x jmz point lemma a1 proof theorem 7 simpli use result theorem 8 bound converg inde f almost x fn bona fide determinist densiti r f 1974 see also devroy gyorfi 1985 shown may add phrase probabl almost sure side case fn datadepend sequenc estim note condit lemma b2 satisfi partit estim partit depend upon data 2 inde consid two determist sampl dier ith point let correspond partit estim call fn gn let x x denot cardin x sampl aan z aan n n let fn gn denot partit estim base sampl drawn densiti f g respect g densiti pick later appli lemma b2 point pick pick larg r f g theorem 8 almost x egn xgx 0 g bound e r g bound converg thu arbitrari proof complet 9 acknowledg author thank attent refere point shortcut proof 10 r condit necessair et susant de converg l 1 en probabilit de lhistogramm pour une densit approxim densiti function l 1 error histogram densiti estim multidimension case cambridg univers press real variabl method fourier analysi equival weak strong complet converg l1 kernel densiti esti mate note l1 consist variabl kernel estim hilbert kernel regress estim hilbert densiti estim strong uniform consist nearest neighbor densiti estim recouvr du tore q par de ouvert aleatoir discriminatori analysi consist nonparametr multivari densiti estim base statist equival block consist condit probabl estim integr densiti estim note dierenti multipl integr nonparametr estim multivari densiti function asymptot normal multivari knn densiti estim multivari knearest neighbor densiti estim counterexampl theori strong dierenti consist properti nearest neighbor densiti function esti mator estim probabl densiti function mode distribut first ladder moment height fluctuat random walk remark nonparametr estim densiti function strong deriv function interv use converg theorem probabl distribut empir process applic statist measur integr tr hilbert kernal regress estim