combin unifrontalmultifront method unsymmetr spars matric discuss organ frontal matric multifront method solut larg spars set unsymmetr linear equat multifront method work frontal matrix suspend frontal matrix store later reus new frontal matrix gener thu sever frontal matric store factor one assembl sum creat new frontal matrix although mean arbitrari sparsiti pattern handl effici extra work requir sum frontal matric togeth costli indirect address requr unifront method avoid extra work factor matrix singl frontal matrix row column ad frontal matrix pivot row column remov data movement simpler higher fillin result matrix permut variableband form small profil consid combin unifrontalmultifront algorithm enabl gener fillin reduct order appli without data movement previou multifront approach discuss techniqu context code design solut spars system unsymmetr pattern b introduct consid direct solut set linear equat coeffici matrix spars unsymmetr gener nonzero pattern direct approach permut matrix factor lu factor permut matric chosen preserv sparsiti maintain numer accuraci mani recent algorithm softwar direct solut spars system base multifront approach 17 2 10 27 paper examin frontal matrix strategi use within multifront approach frontal multifront method comput lu factor use data structur permit regular access memori use dens matrix kernel innermost loop supercomput highperform workstat lead signific increas perform method irregular memori access use dens matrix kernel discuss frontal method section 2 multifront techniqu section 3 discuss combin two method section 4 consid influenc principl paramet approach section 5 perform comput inform scienc engin depart univers florida gainesvil florida usa 904 3921481 email daviscisufledu technic report matric avail via world wide web httpwwwcisufledudavi anonym ftp ftpcisufleducistechreport rutherford appleton laboratori chilton didcot oxon 0x11 0qx england european center research advanc train scientif comput cerfac toulous franc email isdletterboxrlacuk technic report inform hsl matric avail via world wide web httpwwwcisrlacukstructarcdnumhtml anonym ftp seamusccrlacukpub davi duff l l l l l l l fig 21 frontal method exampl new approach section 6 conclud remark inform avail code section 7 2 frontal method frontal scheme 15 26 31 32 factor proce sequenc partial factor elimin full submatric call frontal matric although frontal scheme origin design solut finit element problem 26 use assembl system 15 version studi paper gener system frontal matric written row fulli sum contribut come row 21 first two block column fulli sum mean pivot chosen anywher fulli sum block compris first two block column within column numer pivot arbitrari row interchang accommod sinc row frontal matrix fulli sum assum without loss gener pivot chosen squar matrix f 11 21 f 11 factor multipli store f 21 schur complement use full matrix kernel submatrix consist row column frontal matrix pivot yet select call contribut block next stage entri origin matrix assembl schur complement form anoth frontal matrix overhead low sinc equat assembl never assembl two frontal matric exampl shown figur 21 two pivot step alreadi perform 5by7 frontal matrix comput first two row column u l respect nonzero entri l u shown lower case row 6 assembl current 4by7 frontal matrix shown solid box column 3 4 fullysum elimin step row 7 8 must assembl column 5 6 elimin dash box 4by6 frontal matrix contain row 5 8 column 5 6 7 8 9 12 activ submatrix frontal matric cours store column combin unifrontalmultifront method 3 pack togeth zero column held frontal matrix delin dash box dot box show state frontal matrix next five pivot elimin factor 12by12 spars matrix figur 21 work array size 5by7 requir hold frontal matrix note figur 21 column pivot order one import advantag method frontal matrix need resid memori entri read sequenti disk frontal matrix one row time entri l u written sequenti disk order comput method work well matric small profil profil matrix measur close nonzero entri diagon given express ji 60 assum diagon nonzero term summat non neg numer pivot requir fillin increas profil u profil reduc profil frontal method typic preced order method revers cuthillmcke rcm 5 7 29 typic faster sparsitypreserv order requir gener techniqu like multifront method nest dissect 24 minimum degre 1 25 degre updat phase typic costli part minimum degre algorithm requir rcm algorithm howev matric larg profil frontal matrix larg unaccept level fillin occur 3 multifront method multifront scheme symmetr matrix 2 8 9 10 17 18 28 normal use order minimum degre reduc fillin order tend reduc fillin much profil reduct order order combin symbol analysi gener assembl comput tree node repres assembl elimin oper frontal matrix edg transfer data child parent node use tree drive numer factor assembl elimin node proceed soon child node complet give ad flexibl issu exploit parallel frontal scheme complet frontal matrix 21 normal factor step gaussian elimin possibl remain reduc matrix schur complement need sum assembl data parent node unsymmetricpattern multifront method tree replac direct acycl graph dag 9 contribut block may assembl one subsequ frontal matrix 4 combin two method let us consid approach combin best featur two method assum chosen pivot determin frontal matrix normal multifront method stage normal multifront method select mani pivot fulli sum part frontal matrix perform elimin correspond pivot store contribut factor store remain frontal matrix later assembl parent node assembl tree strategi use 4 davi duff combin method form frontal matrix hold submatrix larger work array allow pivot chosen anywher within frontal matrix potenti pivot lie non sum part frontal matrix necessari sum row column could use pivot possibl long fulli sum row column accommod within larger work array way avoid data movement assembl multifront method although motiv differ idea continu frontal matrix step move anoth frontal matrix similar recent work implement frontal scheme within domain decomposit environ exampl 23 sever front use within unifront context howev case 23 order done priori attempt made use minimum degre order anoth case one continu frontal matrix sever assembl relax supernod amalgam use 17 howev techniqu delay select pivot normal caus fillin oper techniqu inde use combin unifrontalmultifront approach preclud implement relax supernod amalgam well comparison unifront method pivot determin entir order assembl combin method requir select pivot start new frontal matrix impli either priori symbol order pivot search numer factor pivot search heurist requir degre row column thu degre updat phase cost degre updat clearli penalti pay avoid poor fillin properti convent unifront order describ new frontal matrix strategi appli umfpack version 11 8 10 order obtain new combin method howev new frontal strategi appli multifront algorithm umfpack use actual degre keep track upper bound degre row column symmetr analogu approxim degre updat umfpack incorpor approxim minimum degre algorithm amd discuss 1 accuraci degre bound demonstr new algorithm consist sever major step compris sever pivot select elimin oper start major step choos pivot use degre upper bound numer threshold test defin work array use pivot elimin oper long perform within longer possibl work array store anoth major step commenc start major step new algorithm select default column minimum upper bound degre comput pattern true degre pivot row select basi upper bound row degre row nonzero entri select column suppos pivot row column degre r c respect kbyl work array alloc typic valu 2 3 fix entir factor activ frontal matrix cbyr store kbyl work array pivot row column fulli assembl work array defin submatrix activ frontal matrix approxim degre updat phase comput bound degre row column activ frontal matrix assembl previou contribut block activ frontal matrix row previou contribut block assembl activ frontal matrix combin unifrontalmultifront method 5 1 row index nonzero pattern current pivot column 2 column indic remain entri row present nonzero pattern current pivot row column previou contribut block assembl analog manner major step continu sequenc minor step anoth pivot sought minor step repeat factor longer continu within current work array point new major step start pivot chosen minor step row column fulli assembl work array redefin activ frontal matrix approxim degre updat phase comput bound row column activ frontal matrix assembl previou contribut block activ frontal matrix correspond row column u l comput updat pivot necessarili perform immedi effici use level 3 bla better accumul updat typic 16 32 possibl perform time find pivot minor step singl candid column contribut block first select choos one least valu upper bound column degre pend updat appli column column assembl separ work vector pivot row select basi upper bound row degre numer threshold test suppos candid pivot row column degre r 0 c 0 respect three condit appli 1 r 0 l c 0 k factor longer continu within activ frontal matrix pend updat appli lu factor store activ contribut block save later assembl subsequ frontal matrix major step complet 2 r candid pivot fit activ frontal matrix without remov p pivot alreadi store factor continu within activ frontal matrix commenc anoth minor step 3 otherwis l candid pivot fit previou p pivot shift current frontal matrix pend updat appli lu factor correspond pivot row column remov front store activ contribut block left place set p 1 factor continu within activ frontal matrix commenc anoth minor step know previou multifront method consid case 3 particular umfpack version 11 case 1 occur frontal method given work array larg enough hold largest frontal matrix unless numer pivot caus frontal matrix grow unexpectedli take simultan advantag case 1 3 significantli reduc memori requir number assembl oper still allow use order reduc fillin figur 41 illustr work array use umfpack version 11 combin method matric l 1 l 2 u 1 u 2 figur column row lu factor correspond pivot elimin within frontal matrix matrix contribut block matrix u 2 u 2 row revers order column revers order arrow denot matric grow new pivot ad pivot remov work array figur 41b case 4 contribut block 6 davi duff umfpack work array b combin method work array empti empti u u ld u 121fig 41 data structur activ frontal matrix tabl test matric name n jaj sym disciplin comment gre 1107 1107 5664 0000 discret simul comput system gemat11 4929 33185 0001 electr power linear program basi migrat ln 3937 3937 25407 0850 fluid flow linear navierstok shyy161 76480 329762 0726 fluid flow viscou fullycoupl navierstok hydr1 5308 23752 0004 chemic eng dynam simul rdist1 4134 94408 0059 chemic eng reactiv distil lhr04 4101 82682 0015 chemic eng light hydrocarbon recoveri chemic eng light hydrocarbon recoveri need reposit similar data organ employ ma42 22 5 numer experi discuss experi select valu g section compar perform code spars matrix code next section show tabl 51 test matric use experi section next tabl list name order number entri jaj symmetri disciplin matrix come addit comment symmetri correctli structur symmetri number match offdiagon entri total number offdiagon entri entri ij j 6 match ji also entri perform experi effect valu g sun sparcstat 20 model 41 use fortran compil f77 version 14 o4 libmil option bla 11 show result tabl 52 tabl list matrix name growth factor g number frontal matric major step numer factor time second total time second number nonzero lu factor memori use floatingpoint oper count number frontal matric highest decreas g increas although effect local decreas may monoton although fillin oper count typic lowest minimum amount memori alloc frontal matrix 1 factor time often high addit data movement requir assembl contribut block fact dens matrix kernel effici larger frontal matric result show strategi alloc space necessari frontal matrix choos pivot initi fulli sum combin unifrontalmultifront method 7 tabl effect g perform combin method matrix g front factor total jl memori op count gre 1107 10 926 051 089 0048 0160 26 20 406 043 074 0079 0196 67 25 323 070 101 0100 0224 90 70 122 075 085 0121 0235 95 20 988 037 070 0067 0287 08 25 873 039 069 0077 0299 10 30 776 033 066 0087 0312 13 50 586 041 070 0119 0353 20 70 538 041 077 0148 0381 28 20 2324 141 379 0122 0959 72 25 2326 137 396 0122 0883 72 30 2322 141 397 0123 0886 81 70 2280 282 587 0153 0852 160 ln 3937 10 3208 1282 1716 0474 1161 955 20 2011 568 902 0494 1170 841 25 30 1717 701 929 0551 1425 900 50 1446 626 930 0591 1750 964 70 1454 1176 1514 0697 2005 1341 20 3947 052 157 0112 0384 27 25 3726 067 146 0122 0398 33 20 306 112 185 0278 0668 106 25 316 121 185 0304 0694 115 30 295 123 169 0333 0702 104 50 160 215 221 0493 0890 146 70 160 317 204 0620 1038 147 20 2223 190 403 0313 0824 164 25 2185 309 512 0457 1051 324 50 2153 251 410 0444 0995 264 70 2180 370 455 0497 1195 289 block give substanti gain execut time sometim small penalti storag although occasion storag less well 6 perform section compar perform combin unifrontalmultifront method ma38 unsymmetricpattern multifront 8 davi duff method umfpack version 11 8 10 gener spars matrix factor algorithm base frontal matric ma48 19 20 frontal method ma42 15 22 symmetricpattern multifront method mup 2 method factor gener unsymmetr matric use dens matrix kernel extent 12 test method singl processor cray c98 although mup parallel code version 6041 fortran compil cf77 use method except ma42 discuss later given 95 mw memori factor matric list tabl 51 method set input paramet control behavior use recommend default except indic default three five method ma38 umfpack v11 ma48 preorder matrix block triangular form alway preced find maximum transvers 14 factor block diagon 16 reduc work unsymmetr matric perform preorder sinc ma42 mup provid option one matrix lhr71 illcondit requir scale prior factor scale factor comput harwel subroutin librari routin mc19a 6 row subsequ divid maximum absolut valu row column depend method implement threshold partial pivot scale perform matric default mup preorder matrix maxim modulu smallest entri diagon use maximum transvers algorithm follow minimum degre order nonzero pattern ma42 first preorder matrix reduc profil use version sloan algorithm 30 21 ma42 abl oper incor outof core use direct access file finiteel entri option primarili design use equat entri mode matric although matric obtain finiteel calcul test ma42 incor outofcor cpu time outofcor factor slightli higher incor factor memori usag much less thu report outofcor result note cpu time includ addit system io devic time requir read write direct access file reliabl way measur dedic system cpubound multius system time spent wait io would littl effect total system throughput symbol analysi phase ma42 determin minimum front size kbyl assum increas due numer pivot minimum size integ real buffer total size b say gave numer factor phase work array size 2kby2l buffer size 2b allow numer pivot tabl show much space actual use disk space taken ma42 includ memori usag result shown tabl 61 matrix tabl list numer factor time total factor time number nonzero lu million amount memori use million word floatingpoint oper count million oper method total time includ preorder symbol analysi factor numer factor time comput scale factor lhr71 matrix includ sinc use scale algorithm method matrix lowest time memori usag oper count shown bold compar solut vector x method found combin unifrontalmultifront method 9 five method comput solut compar accuraci term norm residu give residu tabl 61 five code factorizeonli option often much faster combin analysisfactor phase inde design criterion code exampl ma48 minim factor time even caus increas initi analys time ma42 howev analysi particularli simpl normal overhead much smaller code mup shown fail twice shyy161 lhr71 nearli singular case numer pivot caus increas storag requir 95 mw alloc ma42 fail factor shyy161 matrix numer problem ran disk space numer factor lhr71 matrix 58 gbyte requir matrix report estim number entri lu factor memori usag report symbol analysi phase ma42 sinc code compar offer quit differ capabl design differ environ result interpret direct comparison howev would like highlight improv new techniqu bring umfpack code new code least compar perform spars matrix code peak perform ma38 607 mflop numer factor psmigr 1 matrix compar theoret peak 1 gflop one c90 processor new code requir less storag origin umfpack code sometim requir less half storag execut time analysefactor gener faster sometim nearli factor two slower origin umfpack code 13 hydr1 matrix code ma38 fastest analysefactor time five ten matric except one matrix ln 3937 never take twice time fastest method memori usag compar incor method ma42 typic factor matric least amount core memori ma42 origin design finiteel entri optim equat entri experi run one comput strongli favor direct address may thu disadvantag ma48 make heavi use level 3 bla 7 summari demonstr advantag frontal multifront method combin result algorithm perform well matric wide rang disciplin shown combin unifrontalmultifront method gain earlier code avoid indirect address gener perform elimin larger frontal matric differ umfpack version 11 new code ma38 umfpack version 20 includ option overwrit matrix lu factor print input output paramet remov extra copi numer valu iter refin spars backward error analysi 4 use level 3 bla within numer factor routin simpler call interfac featur improv robust code result modest decreas memori usag combin unifrontalmultifront method avail fortran 77 code umfpack version 20 netlib 13 1 ma38 releas 12 harwel 1 umfpack version 20 netlib may use research educ benchmark davi duff subroutin librari 3 2 8 acknowledg would like thank nick gould john reid jennif scott rutherford appleton laboratori help comment draft report r approxim minimum degre order algorithm vector multiprocessor multifront code solv spars linear system spars backward error linear time implement revers cuthillmcke algorithm automat scale matric gaussian elimin reduc bandwidth spars symmetr matric user guid unsymmetricpattern multifront packag umfpack distribut mathemat softwar via electron mail algorithm obtain maximum transvers implement tarjan algorithm block triangular matrix design ma48 use profil reduct algorithm frontal code use multipl front gaussian elimin comput solut larg spars posit definit system frontal solut program finit element analysi multifront method spars matrix solut theori practic multifront method spars matrix solut theori practic compar analysi cuthillmcke revers cuthillmcke order algorithm spars matric algorithm profil wavefront reduct spars matric frontal techniqu chemic process simul supercomput supercomput strategi design analysi complex separ system tr distribut mathemat softwar via electron mail spars matrix test problem evolut minimum degre order algorithm set level 3 basic linear algebra subprogram multifront method spars matrix solut spars matrix method chemic process separ calcul supercomput design new frontal code solv spars unsymmetr system design ma48 stabl finit element problem wild coeffici approxim minimum degre order algorithm unsymmetricpattern multifront method spars lu factor multifront solut indefinit spars symmetr linear comput solut larg spars posit definit reduc bandwidth spars symmetr matric supernod approach spars partial pivot ctr eero vainikko ivan g graham parallel solver pde system applic incompress navierstok equat appli numer mathemat v49 n1 p97116 april 2004 jr de dreuzi j erhel effici algorithm determin connect fractur network solut steadyst flow equat fractur network comput geoscienc v29 n1 p107111 februari kai shen parallel spars lu factor differ messag pass platform journal parallel distribut comput v66 n11 p13871403 novemb 2006 timothi davi john r gilbert stefan larimor esmond g ng column approxim minimum degre order algorithm acm transact mathemat softwar tom v30 n3 p353376 septemb 2004 anshul gupta recent advanc direct method solv unsymmetr spars system linear equat acm transact mathemat softwar tom v28 n3 p301324 septemb 2002 xiaoy li jame w demmel superludist scalabl distributedmemori spars direct solver unsymmetr linear system acm transact mathemat softwar tom v29 n2 p110140 june timothi davi column preorder strategi unsymmetricpattern multifront method acm transact mathemat softwar tom v30 n2 p165195 june 2004 j candi r e waltz eulerian gyrokineticmaxwel solver journal comput physic v186 guardon l vigevano finit elementvolum solut axisymmetr conserv law journal comput physic v224 n2 p489518 june 2007