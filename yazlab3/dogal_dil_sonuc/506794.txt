anomali detect embed system employ fault toler embed system withstand intent unintent fault mani faulttoler mechan invok fault detect whatev faultdetect mechan use henc process fault detect must depend system expect fault toler mani fault detect indirectli result perform disord manifest anomali monitor system sensor data anomali detect therefor often primari mean provid earli indic fault kind detector one seek full coverag detect space anomali detector use even coverag particular anomali detector fall short 100 percent detector compos effect broader coverag respect sweet spot blind region known paper provid framework faultinject methodolog map anomali detector effect oper space show two detector design detect phenomenon may perform similarli even event detect unequivoc anomal detect either detector synthet realworld data use b introduct comput system becom miniatur pervas embed everyday devic increas frequenc even point domest industri consum may awar presenc truck tire exampl soon processor pressur sensortranspond embed rubber cheaper fit inhub pressur sensor wheel old trailer big rig laptopcomput batteri contain embed comput track charg remain therebi ensur batteri memori travel batteri even move anoth laptop comput disk drive may contain one two embed comput one control one dsp chip even oper system like unix embed televis settop box enabl paus live televis broadcast vend machin internet applianc intern space station control vibrat damp 1 mani devic embed comput intrins safetycrit missioncrit therefor requir higher level depend usual automobil aircraft engin control one exampl presum fault toler one way achiev high depend employ devic sever method fault toler requir fault detect bring faulttoler measur bear one salient exampl recoveri block 2 3 fault detect therefor essenti first step achiev depend detector reliabl faulttoler mechan effect activ fault detect either explicitli implicitli fault detect explicitli typic pattern recognit wherein signatur detect directli link particular fault fault detect implicitli usual due detect indirect indi cator anomali may caus fault system perform anomali often indic problem fault stabl explicit signatur theyr indic unusu behavior one exampl fault condit known ethernet broadcast storm indic indirectli anomalouslyhigh packet traffic network 4 anoth exampl increas error rate report softwar sensor observ system event log disk surfac failur indic way 5 6 ethernet exampl measur packet traffic serv sensor system event log mani differ measur avail 7 note 4 mani sensor measur state network system process sensor hardwar softwar although recent trend mainli toward softwar sensor 8 data produc sensor refer sensor data sensordata stream data sensordata stream numer categor numer data usual continu ratio scale uniqu zero point mathemat order properti eg take differ ratio measur make sens categor data sometim refer nomin data discret usual consist seri uniqu label categori mathemat order properti eg appl twice orang 9 seem like comput power increas sensor data form categor data 8 10 henc anomali detector requir oper primarili categor data present real challeng develop user sensor categor data much difficult handl statist numer data paper focus detect anomali categor data anomali occur sensor data often indirect implicit manifest fault condit somewher monitor system process detect anomali therefor import aspect maintain integr reliabl safeti secur gener depend system process sinc anomali detect front line mani faulttoler depend mechan essenti reliabl one way gaug reliabl coverag coverag figur merit gaug effect detect test process histor system coverag said proport fault system recov automat fault class said cover recoveri strategi 11 coverag also view probabl particular class condit event detect system suffer consequ miss fals detect anoth definit coverag one use paper specif enumer type condit particular detect scheme guard 12 succinctli coverag anomali detector extent detect correctli event particular anomali class motiv concern coverag one need know one anomali detect system experi type error true null hypothesi incorrectli reject type ii error fals null hypothesi fail reject one take precautionari measur compens error anomali detector achiev complet coverag suitabl use scrutin care anomali class discuss section 6 paper address issu assess coverag anomali detector acquir groundtruth test data aid sessment inject anomal event test data map coverag detector term sweet spot region adequ detect blind region region inadequ detect de tector coverag map ascertain use judg suitabl detector variou situat exampl environ detector deploy never experi condit detector blind region detector use without advers consequ problem object critic problem littl clariti literatur regard condit anomali detect work well work poorli gain clariti necessari understand detail precis anomali detector work ie detector see phenomena affect perform stream sensor data pass detec tor rang percept similarli one would want know sort algorithm view data sort well characterist data eg presorted imping algorithm efficaci object present work 1 understand detail anomali detector work stream sensor data pass detector purview 2 use understand guid faultinject experi anomali inject normal background data outcom map illustr detector region sensit andor blind anomali result address question ffl coverag anomali detector ffl one assess coverag ffl anomali detector coverag given set anomali embed background data ffl anomali detector compos attain greater coverag achiev singl anomali detector use alon issu address use fault inject wellknown techniqu evalu detect system 13 14 synthet data use address usual problem determin ground truth facilit simplic clariti basic type anomali detect use name slidingwindow detector move univari stream categor data anomal sequenc consid contigu tempor anomali address treat similarli aggreg use appropri featureextract mechan 3 anomali accord webster dictionari anomali someth differ abnorm peculiar deviat common rule pattern trait taken atyp behavior phenomenon scrutini definit fit may everyday purpos vagu scientif use apt definit anomali event object differ standard refer event excess threshold accord similar distanc metric event refer event character normal behavior similar metric measur distanc normal abnorm threshold establish minimum distanc encompass variat normalci event exceed distanc consid anomal specif establish refer event metric threshold often situationspecif beyond scope paper although address peripher section 71 determin constitut anomal element stream numer data intuit data element exce say mean plu three standard deviat may consid anomal determin constitut anomali categor data specif problem address less intuit sinc make sens comput mean standard deviat numericallybas measur categor valu cat blue even categori translat number categor data anomal event typic defin probabl encount particular juxtaposit symbol subsequ data stream ie symbol subsequ anomali juxtapos unexpect way categor data set compris sequenc symbol collect uniqu symbol data set call alphabet typic data set character term constitut normal behavior environ data drawn data set character call train data train data may obtain appli cation eg processcontrol applic provid monitor data consumpt variou analysi program train data obtain process period time process judg run normal within normal data juxtaposit symbol subsequ would consid normal provid fault unusu condit prevail collect period train data character term train phase character new data monitor process unknown state either normal anomal compar expect gener train data suffici unexpect juxtaposit new data would judg anomal possibl manifest fault anomali caus manifest caus anomali anomali look like exampl semiconductor fabric process illustr one attach sensor environ plasma chamber reactiv ion etcher sensor data compris seri normal categor valu given normal oper etcher fault occur fabric process fault manifest event seri sensor valu embed otherwis normal sensor data event contain one data valu relat normal data valu one two way 1 embed event could contain symbol commonli found commonli juxtapos normal data 2 embed event could contain symbol symbol juxtaposit anomal respect found normal data thu fault could manifest event inject normal stream data event could regard normal could regard anomal three phenomena could make event anomal foreign symbol foreign symbol symbol includ trainingset alphabet exampl symbol q trainingset alphabet compris b c e f would consid foreign symbol detect event contain foreign symbol call foreign symbolsequ anomali straightforward foreign ngramssequ ngram set n order element found train dataset also contain foreign symbol consid foreign ngram foreign sequenc foreign train dataset foreign ngram event contain ngram present train data exampl given alphabet b c e f set bigram would contain aa ab ac ff total 6 gener alphabet ff symbol total possibl train data contain bigram except cc cc would foreign ngram note foreign symbol essenti foreign unigram appear ngram would foreignsymbol event foreign ngram event realworld computerbas data quit common possibl ngram contain train data partli due rel high regular comput oper partli due larg alphabet exampl kernelcal stream rare ngramssequ rare ngram event also call rare sequenc contain ngram infrequ train data exampl bigram aa constitut 96 bigram sequenc bigram bb cc constitut 2 bb cc would rare bigram ngram whose exact duplic found rare train dataset call rare ngram concept rare determin userspecifi threshold typic threshold might 05 mean rare ngram would frequenc occurr train data 5 select threshold arbitrari low enough rare meaning 5 ken anomali detector anomali detector determin similar distanc standard event possiblyanomal event purview cant make decis thing cant see purview slidingwindow detector length window sinc anomali size detector window size differenti affect background whole intern encompass boundari condit boundari condit figur 1 ken anomali detector differ view anomali depict aaaaaa embed sensordata stream depict ddddd perspect slidingwindow anomali detector arrow indic direct data flow detector detect use pursu idea detector ken rang word ken mean extent rang one recognit comprehen sion percept understand one horizon purview thu seem appropri ask ken anomali detector univari case shown figur 1 depict stream sensor data ddddd anomal event aaaaaa inject right direct arrow indic data move right respect detector window time event pass width window detector apprehend anomali take valu typic base constraint environ situat detector use extent detector window overlap anomali thought detector view anomali natur focu case window size anomali entir anomali captur exactli within window call whole view howev number case illustr figur size detector window less length anomali detector call intern view case detector window larger anomali anomal normal background data seen encompass view irrespect width window time pass anomal event move window event present detector differ perspect particular interest situat term extern boundari condit use interchang term boundari condit aris end inject sequenc embed normal data lead trail element anomali abut normal data boundari condit occur independ rel size detector window anomali except degener case size one boundari condit detector see part anomali part background data background view see background data anomali shown later detector view condit discuss import determin precis anomali detector capabl detect well may caus anomali detector rais alarm even note condit depend size inject event rel size detector window tabl 1 summar condit condit intern x boundari x x x encompass x tabl 1 condit interest ensu respect detectorwindow size dw anomali size 6 anomali space import note anomali compos subsequ variou type three identifi section iv foreign symbol foreign ngram rare ngram fourth type common ngram ngram appear commonli rare normal data henceforth term ngram sequenc use interchang ie foreign ngram foreign sequenc refer thing anomal sequenc compos sever differ kind subsequ along concept intern sequenc boundari sequenc give rise idea creat map anomali space slidingwindow detector given map possibl determin extent map cover particular anomali detector goal paper rather show two detector unexpectedli differ coverag even encount event embed data differ detect capabl aris use differ metric differ detector anomalyspac map shown figur 2 map describ figur caption paragraph follow window size detector rel size anomali shown three column figur detector window size less anomali size detector window size equal anomali size detector window size greater anomali size condit figur address three kind anomali foreignsymbolsequ anomali sequenc compris foreign symbol foreignsequ anomali sequenc compris foreign sequenc raresequ anomali sequenc compris rare sequenc follow materi expand descript cell select exampl anomali type ff ai ab depict upper left figur sequenc foreign symbol ff compos alien intern sequenc ai alien extern boundari ab term alien umbrella term use refer sequenc exist normal train data irrespect characterist make foreign unlik closelydefin term foreign symbol foreign sequenc ff foreignsymbolsequ anomali compos foreign sym bol specif case anomal sequenc ff ai ab slide past detector window whose size less size anomali detector first encount lead edg anomali lead edg alien ie sequenc contain first element anomali normal element immedi preced sequenc exist normal train data therefor anomal anomali move detector window intern detector windows subsequ anomali alien anomali foreignsymbolsequ anomali ff ai ab ff ab ff ae ab foreignsequ anomali fs ai ab fs ae ab fs ri ab fs ab fs ab fs ci ab fs ce ab fs ai rb fs ae rb fs ri rb fs rb fs rb fs ci rb fs ce rb fs ai cb fs ae cb fs ri cb fs cb fs cb fs ci cb fs ce cb raresequ anomali rs ai ab rs ae ab rs ri ab rs ab rs ab rs ci ab rs ce ab rs ai rb rs ae rb rs ri rb rs rb rs rb rs ci rb rs ce rb rs ai cb rs ae cb rs ri cb rs cb rs cb rs ci cb rs ce cb figur 2 anomali space first two letter cell identifi type anomal sequenc fs foreignsequ anomali rs raresequ foreignsymbolsequ anomali next two letter identifi type condit intern alien rare common encompass alien rare common last two letter refer boundari condit alien rare common dw indic detector window smaller anomali analog indic window larger intern encompass condit indic dash replac middl two letter imposs condit struck element compris anomal sequenc length anomal sequenc slide size 6 detectortecto size detector window 6 mark element 26556 3 data incorpor inject anomali sequenc compris extern boundari condit mark element thee 26310 anomal sequenc size foreignsymbol sequenc inject 6 element compris extern boundari condit figur 3 foreignsymbolsequ anomali inject background data extern boundari condit shown detector window size 6 anomali size pass window trail edg form anoth alien boundari figur 3 illustr slidingwindow detector move anomali inject synthet data stream detector window anomali size 6 shade box depict inject ff anomali rais alarm detector window posit exactli ten sequenc result interact background inject anomali ten sequenc compris boundari condit may affect respons detector window slide inject anomali depend whether addit anomali caus anomalybackground boundari interac tion composit inject anomali well posit inject background data must care control avoid creation addit anomali boundari inject section 74 provid detail note anomali depict figur 2 reflect restrict need experiment regim express condit might encount realworld environ fsrirb anomali exampl subsequ compris intern condit rare subsequ make extern condit rare real world subsequ compris condit might mixtur rare foreign common anomali space construct order effect experiment control reduc confound detector respons attribut singl phenomenon rather due interact sever phenomena 7 map detect region differ detector may cover differ part anomali space depict figur 2 section describ experi show well select portion anomali space cover two differ detector markov stide whose detect mechan explain select portion space foreignsequ anomali shown fifth row foreignsequ section figur fs ri rb fs rb fs rb last possibl focu limit first two cell chosen contain event would unequivoc term anomal detector use experi anomali foreign sequenc rare boundari condit case detector window size less anomali size subsequ make intern condit rare henc fs ri rb case detector window size equal anomali size intern condit extant henc fs rb sequenc fs rb possibl sequenc make encompass condit contain foreign sequenc fs sequenc contain foreign subsequ foreign sequenc consequ possibl rare sequenc contain foreign subsequ follow subsect describ detector use coverag map experi method gener data use test detector coverag background data anomali data anomalyinject test data regim run detector experi 71 detector illustr differ detector may cover differ part anomali space two detector test markov stide describ 711 markov detector engin process includ one use driven com puter consist seri event state process run state process chang time time typic orderli fashion dictat aspect process certain kind orderli behavior plausibl approxim problem realworld anomali detect moreov facilit rigor statist treatment conclus anomalydetect work paper focus kind orderli behavior correspond markov model markov anomali detector determin whether state event sequenti data stream taken monitor process normal anomal calcul probabl transit event train set use probabl assess transit event test set state probabl describ markov model key aspect markov model futur state model process depend current state previou state 15 16 markov model consist collect possibl state set probabl associ transit one state anoth graphic depict markov model four state shown figur 4 state label letter b c although arc explicitli label figur thought label probabl transit one state anoth eg state state b transit probabl written transit matrix shown figur 5 letter indic state number indic transit probabl probabl transit exampl 1 state 0 transit probabl base key properti call markov assumpt written formal follow x state system time figur 4 fourstat markov model alphabetcomprisedoffoursymbol letter indic state arrow indic transit probabl transit made state state given probabl henc probabl state x t1 time t1 depend immedi preced state x x time previou state lead state time therefor transit probabl p xy denot progress system state x state defin reader interest detail encourag consult larg literatur markov model eg 15 weather predict provid nice illustr markov process gener one usual predict tomorrow weather base weather today short time period tomorrow noontim temperatur depend today noontim temperatur previou day temperatur correl provid addit inform beyond contain today measur reason high probabl tomorrow like today tomorrow weather like today one expect would violat one would feel surpris degre surpris use anomali detect surpris one observ certain event outcom anomal event draw one attent 000 100 000 000 transit sequenc abcdabcd figur 5 transit matrix fourstat markov model alphabet compris four symbol b c letter indic state number indic probabl transit one state anoth exampl probabl transit 1 probabl transit state 0 base anomali detector discret markov process requir three step first state transit matrix construct use train data train data repres condit consid normal exampl sensor data collect aircraft turbin run normal oper condit data would use train data data would construct state transit matrix repres normal turbin behavior second step establish metric surpris gener distanc similar measur determin dissimilar normal process remain within bound consid normal oper behavior threshold dissimilar exceed observ behavior reflect sensor data judg abnorm anomal case markovmodel approach transit judg highli probabl eg probabl 09 surpris factor 01 exampl threshold set 09 surpris factor 01 would anomal surpris factor 098 exampl transit would consid anomal surpris factor exce surpris threshold anomal event seem given threshold 09 surpris factor 091 would deem anomal surpris factor 099 would regard fraction anomal third step examin test data see fall within expect establish train data state transit test data observ probabl occur normal data retriev transit matrix deriv train data transit scrutini surpris factor exce surpris threshold event test data consid anomal markovbas anomali detector use paper base idea present section state model necessarili need correspond singl event unigram state compos seri event case multipl event compris state collect state markov model span combin unigram specifi length present train data consid exampl sequenc b c e f 3element window move sequenc one event time first window posit would contain b c second window posit would contain b c forth use markov model assess surpris factor transit first second window state would compris seri three event unigram ie equival window size notic transit first window second window event elimin event ad sinc event b c common window addit event drive surpris factor therefor result surpris factor reflect event follow seri event b c formal descript train test process use conjunct markov model given next markov train stage primit similar describ 17 defin facilit descript train procedur let sigma denot set uniqu element ie alphabet symbol set state sequenti stream data state markov model denot associ sequenc window length n set sigma transit pair state 0 denot transit state state 0 primit oper shifto z shift sequenc oe left one append element z z 2 sigma end instanc sequenc equal new sequenc bcz primit oper nexto return first symbol sequenc oe left shift oe one next symbol function analog pop first element top stack top stack begin sequenc exampl given sequenc abcd nextabcd return updat sequenc bcde construct markov model normal behavior base train data describ follow initi ffl current state first n element train data trainingdata stream minu first n element sequenc size n scan train data 1 let nexto 2 set next state shiftcurr state c 3 increment counter state current state transit current state next state 4 set current state next state entir stream train data process probabl transit comput f counter associ transit 0 respect markov test stage let 000 indic normal let 100 indic anomal surpris factor sometim call anomali signal calcul test data follow initi ffl current state first n element train data trainingdata stream minu first n element sequenc size n scan test data 1 let nexto 2 surpris minu transit probabl current state next state 3 set current state next state 712 stide detector stide sequenc timedelay embed anomali detector inspir natur immun system distinguish self normal nonself anomal 18 19 refer time recogn timeseri natur categor data detector typic deploy stide appli stream system kernelcal data manifest malici alter code regard anomali 20 stide mimic natur immun system construct templat self match instanc nonself achiev sever stage stide train stage databas consist templat self construct stream data consid normal self train data stream broken contigu nelement overlap subsequ ngram valu n typic determin empir 21 duplic ngram remov collect leav uniqu one uniqu ngram store futur fast access complet train stage stide test stage stide compar ngram unknown dataset test data uniqu self ngram unknown ngram match self ngram term mismatch final score calcul basi number ngram comparison made within tempor local region term local frame 21 comparison step two test receiv score either zero one comparison exact match score zero comparison match score one score sum within local region obtain anomali signal exampl illustr within local region 20 comparison made self unknown 20 mismatch score 20 particular region 8 mismatch score 8 region mani overlap region 20 given data stream stide calcul 20 element region highest score conclud region locu anomali stide algorithm describ formal follow let n length sequenc similar sequenc sequenc defin function express state function simxi return 0 two sequenc length elementbyel ident otherwis function return 1 sequenc size n test data compar everi sequenc size n normal databas let norm number sequenc size n normal databas given set sequenc normal databas order set sequenc fx test data x z number element data sampl final similar measur assign sequenc x express state sequenc x test data compar sequenc normal databas function sim f x return 1 ident sequenc found ie mismatch otherwis function return 0 indic presenc ident sequenc match normal databas local frame count lfc size n sequenc test data describ follow let l size local frame let z number element data sampl order set sequenc lfc describ 72 construct synthet train data train data serv normal data anomal event inject requir train data larg proport data compris common sequenc contain small proport rare sequenc rel high predict one symbol anoth common sequenc requir facilit creation background test data contain nois form naturallyoccur rare foreign sequenc necessari detector respons inject anomali observ without confound phenomena rare sequenc train data need anomal event compos rare sequenc drawn normal train data inject test data see section 73 detail final modicum predict conveni emul certain class realworld data eg system kernel call detector like stide said well suit 22 alphabet eight symbol b c e f g h larger alphabet could use would demonstr anyth 8symbol alphabet could demonstr increas alphabet size would chang outcom moreov substanti comput time requir alphabet size goe note alphabet size realworld data typic much larger 8 exampl number uniqu kernelcal command bsm 23 audit data exce 200 howev current goal evalu detector term abil detect anomali higherlevel abstract concept alphabet size influenc size set foreign sequenc set possibl sequenc popul normal dataset foreign sequenc rare sequenc retain charact irrespect alphabet size maintain rel small alphabet size facilit manag experi yet permit direct studi detector respons accommod requir predict data content train data gener eightbyeight state transit matrix probabl 09672 one cell row 0004686 everi cell result sequenc condit entropi 01 see 24 detail one million data element symbol gener would suffici varieti rare sequenc sampl use construct anomal sequenc test data ninetyeight percent train data consist repetit sequenc b c e f g h seed data set common sequenc data set use train two detector use studi ie establish model normalci unknown data compar 73 construct synthet test data test data contain inject anomali use determin well detector captur anomal event correctli reject event anomal test data consist two compon background anomali inject anomali gener separ anomali inject background strict experiment control background consist repeat sequenc b c e f g h common sequenc train data done test data would conflict train data ie would contain spuriou rare foreign sequenc 74 construct anomal inject background data avail anomal event must inject final test data anomali must chosen care inject test data introduc unintend anomal perturb extern boundari condit happen detector could react condit confound outcom interest henc scrupul control necessari goal map detect capabl stide markov anomali detector show detect capabl may vari respect ident unequivoc anomal phenomena given object singl anomali type detector must abl detect select anomali space figur 2 experi anomali type select foreign sequenc length subsequ length less make intern sequenc boundari sequenc rare rare defin sequenc detectorwindow length occur train data less one percent time within scope studi map one region type anomali space order illustr learn gain effort anomali type determin eg fs ri rb describ section 7 next step inject foreign sequenc compos rare sequenc test data catalog rare ngram obtain train data rare ngram drawn catalog compos form foreign sequenc appropri size exampl bigram ba af fh ec cc cf occur less 006 time train data consequ rare bigram combin seven bigram produc one octagram bafheccf whose intern sequenc made rare sequenc size two octagram inject background data compos foreign sequenc inject background data boundari condit must check ensur rare caus rare boundari condit consist anomali class examin boundari condit satisfi procedur finish attempt made handcraft boundari condit help semiautom tool handcraft fail differ set rare sequenc select catalog new foreign sequenc com pose new foreign sequenc inject background data boundari condit check entir procedur repeat success inject obtain note size detector window greater size inject encompass condit ensu intern condit howev care still requir ensur extern boundari condit remain pertin even though focu move intern condit encompass condit eight inject size fourteen detectorwindow size test procedur outlin creat anomal event inject repeat combin inject size window size result 112 total data set 75 score detector perform anomali detector capabl two kind decis ye anomali exist anomali exist detector usual judg term hit miss fals alarm hit occur detector determin anomali present anomali actual present miss occur detector determin anomali present actual one present fals alarm occur detector determin anomali present fact anomali present perfect detector would 100 hit rate miss fals alarm effect proper score ground truth statement undisput fact regard test data must known must determin exactli anomali inject test data detector issu decis correct decis alway assur injector creat key indic exact locat everi inject use key one determin whether detector decis correct usual procedur detector creat output file contain decis 0 1 ye file compar key contain similar set zero one two file match perfectli detector perform perfect 100 otherwis percent hit miss fals alarm calcul easili use inject key file howev straightforward might first appear due interact detectorwindow size particular composit inject event detector respons may alway align perfectli one zero key file exampl key file contain one lead edg inject event seem sensibl detector respons might match fact detector might make varieti respons multipl inject event key file must construct facilit correct score set respons detector might make exampl detector might decid incorrectli anomali exist leadingedg boundari inject event fact boundari anomali detector decis would wrong anoth exampl detector depend window size rel size inject event may respond subsequ intern inject event event toto danger detector respond sever time singl inject event may encount sever differ view event therebi judg mistakenli falsealarm decid ye error problem match detector decis groundtruth key address varieti way present work primari concern determin whether detector complet blind inject event worrisom respons would respons miss detector decid ye part inject event whether intern whole encompass boundari blind event altern detector respond need way mitig problem key mismatch describ problem address requir detector respond posit least within span inject event element compris boundari condit collect call incid span order judg event hit 76 procedur two detector markov stide provid set train data train data detector learn model normal behavior detector test use 112 test data set describ section 74 size detector window vari two fifteen size inject event vari two nine restrict dimens due resourc limit sinc comput time memori increas increas either dimens moreov noth new would learn rais either paramet detector test session produc decis file compar key file test data set comparison reveal detector blind detect inject anomal event chart note stide localityframecount featur ignor oper amplifi detect anomali stide repres mismatch foreignsequ anomali detect mismatch appli local frame count make anomali visibl sinc task hand determin whether inject anomali detect amplif view postdetect process relev mismatchanomali detect present experiment condit consequ stide maximum anomal respons 1 detect blind region markov stide detector depict figur 6 7 respect decis map illustr detect capabl markov stide detector respect inject foreign sequenc compos rare sequenc xaxi map mark increas size foreign sequenc inject test data yaxi mark size detector window requir detect foreign sequenc specifi size star indic success detect foreignsequ anomali whose size indic xaxi use detector window whose size mark xaxi detect specif mean least one posit respons occur incid span posit connot mostanomal valu possibl detector rang respons detector anomal respons 1 area bereft star indic either detect blind undefin region detect blind mean detector unabl detect inject foreign sequenc whose correspond size mark xaxi ie maximum anomal respons record along entir incid span 0 detector anomali appear complet normal note fals alarm occur background data construct common sequenc rais alarm size foreignsequ anomali size detector window3579111315undefin region detect region figur markov sweet blind region undefin region artifact markov detector anomali type sinc markov detector base markov assumpt ie next state depend upon current state smallest possibl window size 2 bigram mean next expect singl categor element depend current singl categor el ement result yaxi mark detector window size figur 6 begin 2 although possibl run stide window size 1 would produc result includ sequenti order size foreignsequ anomali size detector window3579111315blind region undefin region detect region figur 7 stide sweet blind region event properti come play window size larger 1 togeth fact equival window size 1 side markov detector argu run stide window 1 yaxi also begin 2 type anomal event detector evalu requir foreign sequenc compos rare sequenc foreign sequenc size one event contain singl element must foreign rare time possibl result figur 6 7 show undefin region correspond detector window size two anomali size one chart perform space stide markovbas detector respect foreign sequenc compos rare sequenc one abl observ natur gain achiev employ condit probabl markov detector absent stide signific gain detect capabl endow use condit probabl illustr blind region depict figur 7 interest note exact dataset use detector window length 9 stide detect coverag 56 markov detector window size decreas 2 stide coverag decreas 125 markov detector window size howev markov detector still 100 coverag space tremend differ result show although markov stide detector use concept slide window expect abl detect foreign sequenc differ similar metric significantli impact detect capabl case stide even though foreign sequenc present data stream visibl size detector window least larg foreign sequenc compos rare subsequ requir markov detector therefor even fault manifest foreign sequenc data doesnt necessarili mean stide claim abl detect unusu sequenc detect manifest note therefor select similar metric critic effect perform detector choic made care understand metric 9 realworld data result shown previou section base synthet data gener specif test differ anomali detector describ section provid link realworld data show manifest live anomali system kernelcal data consist anomali space map figur 2 live experi consist cyberattack redhat 62 linux system attack exploit vulner glibc standard c librari su program program switch user one account anoth given user provid appropri credenti librari allow user write arbitrari format string exploit program write care craft string interrupt execut su allow user run script program root privileg exploit permit user switch account without provid credenti run su without exploit produc kernelcal data without anomali due exploit kernelcal data victim machin log use immsec kernel patch provid comput immun system research group univers new mexico attack script could repeat reliabl auto matic follow procedur run three time use standard su normal user interact provid credenti switch user root obtain normal train data run three time use su exploit obtain anomal test data 1 start session regular user 2 turn syscal log su program 3 run exploit regular user verifi success give user shell root privileg 4 turn syscal log su program move log file perman locat 5 clean environ log monitor kernelcal data examin experienc system programm set autom tool find minim foreign sequenc appear attack data normal data minim foreign sequenc foreign sequenc shorter foreign sequenc embed programm tool result compar found mutual consist system programm confirm systemat analysi foreign sequenc direct manifest attack seventeen foreignsequ anomali discov su exploit foreign symbol found variabl kernelcal data three attack foreignsequ anomali rang length 2 5 one anomali length 5 five anomali length 3 eleven anomali length 2 anomali uniqu other repeat data detail shown figur 8 use detector window size 2 smallest possibl size cover anomali length two realworld foreignsequ anomali figur 8 composit characterist like one shown anomali space figur 2 anomali descript one describ anomali space except second one eight charact instead six four like rest anomali fs ri rb fb shown figur live data composit reflect anomali size anomali content anomali descript figur 8 foreignsequ anomali discov realworld inform warfar attack data show size 17 anomali event compris anomali anomali descript accord anomali space figur 2 anomali content numer encod kernel call broader set condit pertain uncontrol realworld data oppos compact formul anomali space wellbehav anomali like one found synthet data fs usual indic base type anomali foreign sequenc ri indic intern condit rare rb indic sequenc compris left boundari rare ab indic sequenc compris rightboundari alien discuss conclus paper address fundament issu anomali detect result applic domain anomali detect categor data conduct paper shown assess coverag anomali detec tor also illustr mani subtleti involv myriad factor consid care process straightfor ward meticul attent need paid interact anomal event normal environ embed ie extern boundari condit intern condit encompass condit common rare foreign sequenc compos anomal event unless factor account error may biggest enemi correct map coverag map two differ anomali detector shown strikingli differ might come surpris someon believ appli anomali detector stream sensor data would satisfactori either two detector would detect event one detector stide specif design detect foreign sequenc shown blind half region purport cover use origin role detector informationwarfar intrus stide oper region detect space six six term window size vs anomali size interest region stide blind 36 space wherea markov detector cover 100 region necessarili bad anomali detector less perfect coverag long user know limit detector detector suboptim coverag may possibl deploy detector situat doesnt need oper part space blind never possibl assur howev detector coverag map multipl anomali detector compos attain greater coverag achiev singl anomali detector use alon seem clear two map produc one detector deploy compens defici anoth present case may appear markov detector simpli replac stide altogeth detector differ oper overhead may straightforward determin best mix composit detect sy tem also one remind present work one cell anomali space depict figur 2 examin determin overal coverag await examin rest cell well deploy anomali detector embed missioncrit system essenti understand precis capabl detector well characterist space oper although realworld experi live system data limit scope still illustr two import thing first anomali type depict figur 2 demonstr exist realworld data mere artifact contriv environ second respons detector specifi type anomali chang whether anomali found synthet data realworld data consequ result obtain evalu anomali detector synthet data preserv faith appli real data predict made synthet data sustain transfer realworld environ import lesson learn blind region anomali space map alway grow foreign sequenc grow mean longer foreign sequenc may constitut vulner detect algorithm consid nevertheless undoubtedli better know perform boundari detector compens made whatev weak may synthet data effect map anomali space synthet data may avenu creat map permit run experi confound condit control allow absolut calibr ground truth although realworld data appeal test detect system realworld ground truth alway difficult obtain desir condit test occur real data time way final importantli anomalyspac framework provid mechan bridg gap synthet real world allow evalu result transfer domain anomali space abstract acknowledg work herein support us defens advanc research project agenc darpa contract f306029920537 f30602 0020528 mani peopl contribut variou way author grate kevin killourhi pat lore bob olszewski sami saydjari tahlia townsend help paper draw kymi tan forthcom dissert 25 r littl linux principl prac tice system structur softwar fault toler case studi ethernet anomali distribut comput environ trend analysi fault predict symptom base diagnosi comput event monitor analysi survey intrusiondetect techniqu theori scale measur onlin monitor tutori concept coverag effect reliabl model repair system reliabl comput system fault inject techniqu tool fault inject method valid computersystem depend theori stochast process time seri analysi markov chain classifi intrus detect comput immunolog sens self unix process intrus detect use sequenc system call de tect intrus use system call altern data model selfnonself discrimin comput sunshield basic secur modul guid benchmark anomalybas detect system defin oper limit anomalybas intrus detector tr reliabl comput system 2nd ed comput event monitor analysi survey intrus detect techniqu comput immunolog littl linux fault toler fault inject onlin monitor fault inject techniqu tool benchmark anomalybas detect system markov chain classifi intrus detect selfnonself discrimin comput sens self unix process ctr rodrigo santo jorg santo javier orozco least upper bound fault toler realtim system journal system softwar v78 n1 p4755 octob 2005 tom goldr scatter plot visual user profil data network traffic proceed 2004 acm workshop visual data mine comput secur octob 2929 2004 washington dc usa wengkeen wong andrew moor gregori cooper michael wagner what strang recent event wsare algorithm earli detect diseas outbreak journal machin learn research 6 p19611998 1212005 daniel p siewiorek ram chillareg zbigniew kalbarczyk reflect industri trend experiment research depend ieee transact depend secur comput v1 n2 p109127 april 2004