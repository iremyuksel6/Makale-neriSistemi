framework symmetr band reduct develop algorithm framework reduc bandwidth symmetr matric via orthogon similar transform framework includ reduct full matric band tridiagon form reduct band matric narrow band tridiagon form possibl multipl step framework lead algorithm requir fewer floatingpoint oper standard algorithm eigenvalu requir addit allow spacetim tradeoff enabl increas use block transform b introduct reduct tridiagon form major step eigenvalu comput symmetr matric matrix full convent household tridiagon izat approach eg golub van loan 1989 block variant thereof dongarra et al 1989 usual consid method choic hovev band matric approach optim semibandwidth b number outmost nonzero offdiagon small compar matrix dimens n sinc matrix reduc complet fill step well known algorithm rutishaus 1963 schwarz work support advanc research project agenc contract dm28e04120 p95006 bischof also receiv support mathemat inform comput scienc divis subprogram offic comput technolog research us depart energi contract w31109eng38 lang also receiv support deutsch forschungsgemeinschaft geschaftszeichen fr 75561 la 73421 work partli perform x sun postdoctor associ mathemat comput scienc divis argonn nation laboratori argonn preprint anlmcsp5860496 submit acm tran math softwar x figur 1 rutishaus tridiagon household transform 1968 call rsalgorithm rest paper econom standard approach b n algorithm element annihil one time given rotat rutishaus algorithm annihil element diagon wherea schwarz algorithm proce column given rotat gener fillin element outsid current band fillin chase sequenc given rotat fillin introduc rutishaus 1963 also suggest anoth band reduct scheme base household transform annihil element current column instead one rutishaus use analog scheme chase triangular bulg gener reduct sequenc qr factor shown figur 1 howev signific work involv chase triangular bulg algorithm competit rotationbas rsalgorithm schwarz algorithm basi band reduct implement eispack smith et al 1976 garbow et al 1977 vector along diagon kaufman 1984 variant basi band reduct algorithm lapack anderson et al 1995 rsalgorithm requir storag one extra subdiagon rutishaus household approach requir storag subdiagon assess storag requir variou algorithm introduc concept work semibandwidth work semibandwidth algorithm symmetr band matrix number subsuperdiagon access reduct instanc work semibandwidth rsalgorithm rutishaus second algorithm household transform algorithm approach reduct step two part annihil one sever element bulg chase restor band form either way bulk comput spent bulg chase tridiagonaliza tion algorithm describ murata horikoshi 1975 parallel comput er lang 1993 call mhlalgorithm follow improv bulg chase strategi employ household transform elimin subdiagon entri current column instead chase whole triangular bulg reappear next step chase first column bulg column remov would increas work semibandwidth next step work semibandwidth algorithm also 2b gamma 1 leav rest bulg place algorithm requir roughli number floatingpoint oper flop rsalgorithm latter implement given rotat 50 flop rsalgorithm base fast given rotat use household transform consider improv data local compar rota tionbas algorithm hand rsalgorithm requir less storag may still prefer storag tight paper gener idea behind rsalgorithm mhl algorithm develop band reduct algorithm elimin subdiagon symmetr band matrix semibandwidth b b fashion akin mhl tridiagon algorithm like rutishaus algorithm band reduct algorithm repeatedli use reduc matrix tridiagon mhlalgorithm use reduct step result rutishaus algorithm howev need chosen way deed exploit freedom choos lead class algorithm band reduct tridiagon favor comput properti particular deriv algorithm 1 minimum algorithm complex 2 minimum algorithm complex subject limit storag 3 enhanc scope employ level 3 bla kernel block orthogon reduct set result nonblock household tridiago naliz full matric altern first reduc matrix band form tridiagon result band matrix latter approach significantli improv data local almost comput done level 3 bla contrast block tridiagon garra et al 1989 half comput spent matrixvector product paper extend work bischof sun 1992 paper organ follow next section introduc framework band reduct symmetr matric section 3 show sever known tridiagon algorithm interpret instanc frame work deriv new algorithm optim respect either comput cost space complex section 4 discuss sever techniqu block updat orthogon matrix u requir eigenvector comput section 5 present experiment result section 6 sum find 2 framework band reduct section describ framework band reduct symmetr matric basic idea repeatedli remov set offdiagon therefor first present algorithm peel diagon band matrix suppos nbyn symmetr band matrix semibandwidth b n reduc band matrix semibandwidth b want elimin outermost b nonzero subsuperdiagon pre sym post post pre sym pre post sym figur 2 annihil chase first sweep band reduct algorithm qr stand perform qr decomposit pre post denot pre postmultipl q q resp sym indic symmetr updat pre post last pictur show block partit second sweep symmetri suffic access either upper lower triangl matrix focu latter case algorithm base annihil chase strategi similar rs mhlalgorithm tridiagon mhlalgorithm household transform use annihil unwant element case b 1 abl aggreg n b b transform wy compact wy represent bischof van loan 1987 schreiber van loan 1989 thu data local improv first outmost subdiagon annihil first n b column step done qr decomposit h theta n b upper trapezoid block shown first pictur figur 2 wy represent transform matrix gener complet similar transform must appli block transform left right requir appli q left h theta gamma n b block pre side h theta h lower triangular block sym right b theta h block post post transform gener fillin diagon band first n b column fillin remov anoth qr decomposit second pictur figur 2 pre sym post complet similar transform process repeat newli gener fillin step amount chase n b column fillin along diagon b diagon element push matrix start second annihil chase sweep sweep start matrix follow properti remaind matrix ie current trail matrix block tridiag onal diagon block last one order b last one order b see last pictur figur 2 everi subdiagon block upper triangular first matrix band semibandwidth b everi similar transform within sweep maintain work semibandwidth b involv number h row column restor form describ one subdiagon block destroy next subdiagon block arriv follow algorithm algorithm 1 onestep band reduct bandr1n b n b input n theta n symmetr matrix semibandwidth b n number subdiagon elimin block size n b 1 output n theta n symmetr matrix semibandwidth b gamma qr perform qr decomposit block b replac b pre replac block b sym replac block b post replac block b end work semibandwidth algorithm bd given onestep band reduct algorithm deriv framework band reduct straightforward fashion peel subdiagon chunk algorithm 2 multistep band reduct bandrn b fd input n theta n symmetr matrix semibandwidth b sequenc posit integ fd g k b sequenc fn block size n output n theta n symmetr matrix semibandwidth b gamma call bandr1 n end work semibandwidth multistep algorithm b j b 1 satisfi also class systol array algorithm use given rotat remov sever outer diagon time bojanczyk brent 1987 ipsen 1984 schreiber 1990 chosen larg b 2 bojanczyk brent 1987 order increas parallel scope per systol oper henc minim total number systol oper 3 instanc framework section discuss sever instanc algorithm 2 includ non block household tridiagon rutishaus algorithm mhl algorithm tridiagon symmetr band matric addit multistep framework allow new tridiagon method featur lower flop count andor better data local 31 onestep tridiagon full symmetr matric full symmetr matrix tridiagon bandrn 1g note 1 qr decomposit sym step algorithm 1 reduc determin appli suitabl household transform pre post step vanish thu arriv nonblock standard household tridiagon 32 twostep tridiagon full symmetr matric anoth way tridiagon full symmetr matrix twostep sequenc intermedi semibandwidth n 1 b first reduc band form tridiagon result band matrix contrast block household tridiagon dongarra et al 1989 one half approxim 43n 3 flop reduct confin matrixvector product almost oper reduct band form done within level 3 bla b n first reduct constitut vast major flop tridiagon band matrix requir roughli 6bn 2 flop done level 2 bla therefor twostep tridiagon may superior machin distinct memori hierarchi see tabl section 51 33 onestep tridiagon symmetr band matric full matric simplest way tridiagon matrix semibandwidth b onestep sequenc bandrn b fd 1g qr decomposit sym step reduc determin appli singl household transform pre post step vanish onestep sequenc equival mhlalgorithm 34 tridiagon peel singl diagon sequenc bandrn b fd tridiagon band matrix repeatedli peel singl diagon correspond rutishaus algorithm except rotat replac length2 household transform figur 3 nonzero structur matric w 35 optim tridiagon algorithm band matric follow deriv tridiagon algorithm minimum flop count given work semibandwidth minim number flop tridiagon n theta n band matrix semibandwidth b subject work semibandwidth 2 reduct band matric block transform alway significantli increas flop count figur 3 show nonzero pattern result aggreg n b lengthd1 household transform block household transform nonzero form parallelogram w upper trapezoid multipli w column theta take approxim n b 2d flop multipl cost anoth 2n b even multipl routin gemm abl take full advantag zero thu band context use wy represent increas overal flop count two way first w factor must gener second appli block household transform requir 4n b d1m oper would need n b singl lengthd transform w argument appli also compact wy represent schreiber van loan 1989 addit block techniqu requir one matrix multipl cost addit multipl neglig band case contrast reduct full matric averag length household vector significantli exce n b therefor prefer standard wy represent block household transform section focus minim flop count consid nonblock reduct algorithm ie n machin distinct memori hierarchi howev higher perform level 3 bla may compens overhead introduc block transforma tion thu flop count bla perform taken account order minim execut time machin clariti anali si omit result weight variou algorithm compon idea present easili extend gener analysi nonblock case arithmet cost algorithm 1 flop costn b 4d band differ sequenc fd g algorithm 2 therefor requir flop given limit use dynam program aho et al 1983 determin optim sequenc fd g cost function given 3 take storag requir account allow space tradeoff best use avail memori 351 storag constraint first consid problem 2 2b gamma 1 storag constraint sinc maximum work semibandwidth algorithm 2 2b gamma 1 howev optim sequenc fd g quit differ onestep sequenc mhlalgorithm exampl 50 000by50 000 symmetr matrix semibandwidth 300 optim sequenc reduct requir 348delta10 12 floatingpoint oper work semiband width 310 contrast mhlalgorithm requir work semibandwidth 599 also note constant sequenc requir flop work semibandwidth 316 anoth constant sequenc requir work semibandwidth 332 henc constant stride sequenc seem good choic optim one practic point view save dynam program overhead 352 minimum storag consid anoth extrem case constraint problem 1 space one subdiagon even small b mhlalgorithm among candid sinc work semibandwidth candid dsequenc case satisfi condit 1 1 sequenc satisfi condit instead suggest call doublingstrid sequenc sinc bandwidth reduct size doubl round exampl preced subsect rsalgorithm requir doublingstrid algorithm requir 390 flop row updat rank1 column updat symmetr rank2 updat x figur 4 data area visit mhlalgorithm 353 understand optim rutishaus algorithm peel subdiagon one one requir minimum storag optim among algorithm minimum storag hand although mhlalgorithm elimin subdiagon one step also optim b larg follow give intuit explan complex scheme superior approach first let us compar mhlalgorithm algorithm 2 sequenc fd b gamma 1g bulg chase follow reduct column 1 data area access mhlalgorithm rank1 row andor column updat symmetr rank2 updat shown figur 4 data area access algorithm 2 shown figur 5 compar differ bandreduct sequenc take rank1 updat basic unit comput examin total data area visit algorithm purpos rank1 updat sinc updat appli theta n matrix requir approxim 4mn flop area involv rank1 updat good measur complex symmetr rank2 updat triangular n theta n matrix expens rank1 updat full matrix size requir 4n 2 flop mhlalgorithm total area visit rank1 updat two success band reduct denot 1b obtain ratio amhl take minimum ae 1112 ffi therefor twostep reduct save 8 flop compar mhlalgorithm cours idea appli recurs tridiagon reduct matrix reduc semibandwidth b gamma bd bd figur 5 data area visit two step bandr1n b bandr1n algorithm 2 x x figur 6 data area visit rutishaus algorithm elimin bulg chase round three outmost element 91 81 71 first column light medium dark grey shade resp let us consid often row column repeatedli involv reduct chase step data area visit rutishaus algorithm annihil 3 element first column 3 round shown figur 6 see particular total area visit first b theta b block almost twice big one algorithm 1 result revisit first row column last visit area thu comparison rutishaus mhlalgorithm algorithm interpret balanc counteract goal decreas number time column revisit use household transform decreas area involv updat peel subdiagon sever chunk 36 bandwidth reduct context necessari fulli reduc band matrix tridiagon form exampl invari subspac decomposit approach isda eigensystem comput lederman et al 1991 spectrum matrix condens two narrow cluster repeatedli appli function f matrix f polynomi degre 3 applic f roughli tripl bandwidth therefor full moder number iter countermeasur taken prevent situat bandwidth period reduc reason valu applic f bandwidth reduct also done use algorithm 2 either one multipl reduct step 4 aggreg transform eigenvector matrix requir transform algorithm 1 must also appli anoth matrix say n theta n matrix u band matric updat u domin floatingpoint complex 2n 3 updat u versu 6bn 2 reduct therefor strive maxim use bla 3 kernel updat u decreas total time section discuss sever techniqu updat u block household transform method tailor case transform block 41 onthefli updat updat easili incorpor reduct insert line aggreg transform matrix u requir replac u qr pre step algorithm 1 transform appli u soon gener appli onthefli updat matrix reduc tridiagon form ie work u done block household transform thu enabl use level 3 bla 42 backward accumul tridiagon howev mean work done block fashion first glanc fact seem also preclud use level 3 bla updat u fortun howev obstacl circumv decoupl work u reduct let us first consid tridiagon full symmetr matrix lapack routin sytrd updat u delay reduct complet household transform aggreg block household transform arbitrari n u b appli u addit enabl use level 3 bla decoupl updat reduct allow reduc flop count revert order transform backward accumul complex reason backward accumul techniqu also use reduct full band form even onthefli updat also done block household transform 43 updat tridiagon band matric full matrix reduc either band tridiagon form household vector store conveni zeroedout portion addit vector tridiagon band matric strategi longer possibl elimin one lengthb gamma 1 column band requir nb length b household vector bulg chase therefor impract delay updat u complet tridiagon use anoth techniqu bischof et al 1994 case denot kth household transform gener jth sweep algorithm 1 h j 1 elimin first column remain band h j 3 gener bulg chase reduct transform sweep must determin appli canon order h j 3 h j depend data modifi post step h j transform known depend longer exist sinc transform one sweep involv disjoint set u column may appli u order see figur 7 howev entir free mix transform differ sweep must preced sinc affect column modifi two transform sweep sweep gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi sweep oe oe oe oe oe oe oe oe oe oe oe oe oe oe oe gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi gammapsi figur 7 interdepend household transform h j work left pictur u right pictur h h determin appli appli u h appli u make use addit freedom delay work u certain number n u b reduct sweep complet updat u done bottom appli transform order figur 8 column u affect transform h j first four reduct sweep exampl 6 transform hatch pattern aggreg block household transform h j 1 transform figur 7 would appli order h 1 6 5 h 1 1 order preserv intersweep depend mention addit n b transform h k index k aggreg block household transform figur 8 transform contribut block transform hatch ident similar techniqu also use exampl qr algorithm comput eigensystem symmetr tridiagon matrix lang 1995 allow updat eigenvector matrix matrixmatrix product instead singl rotat 5 experiment result numer experi perform singl node ibm sp parallel comput locat highperform comput research facil mathemat comput scienc divis argonn nation laboratori singl node intel paragon locat zentralinstitut fr angewandt math matik forschungszentrum julich gmbh time comput doubl precis matric random entri chosen 0 1 sinc none algorithm sensit actual matrix entri follow time consid repres five code use experi dsytrd lapack routin block tridiagon full symmetr matric dongarra et al 1989 tabl time second one node ibm sp onestep lapack routin dsytrd twostep reduct routin dsyrdb dsbrdt full symmetr matric order tridiagon form time includ updat u intermedi semibandwidth twostep reduct alway b onestep reduct twostep reduct total time full gamma band band gamma tridiagon dsbtrd lapack routin tridiagon band matric use kaufman modif schwarz algorithm schwarz 1968 kaufman 1984 call sk algorithm follow improv vector dsyrdb block reduct full symmetr matric band form algo rithm 1 dsbrdb block reduct band matric narrow band form algo rithm 1 dsbrdt tridiagon band matric mhlalgorithm techniqu section 43 updat u latter three code describ detail bischof et al 1996 program written fortran 77 ibm sp node purpos view 66 mhz ibm rs6000 workstat code compil xlf o3 qstrict link lessl vendorsuppli bla intel paragon node compil done if77 mvect o4 nx bla link lkmath data present section demonstr may advantag consid multistep reduct instead convent direct method particular machin memori hierarchi clear priori approach superior given problem 51 tridiagon full matric first compar onestep tridiagon routin dsytrd lapack twostep reduct routin dsyrdb dsbrdt section 32 tabl show larg matric twostep reduct make better use level 3 bla direct tridiagon onehalf oper confin matrixvector product reduct band form run mflop close peak perform ibm sp node note tridiagon band matrix block therefor block size n b affect reduct band form bad perform reduct due fact routin dsyrdb provid optim code nonblock case transform matrix u requir direct tridiagon alway superior significantli lower flop count matrix size sp1 updat matrix size sp1 updat matrix size paragon updat 200 400 600 800 1000 1200 matrix size paragon updat figur 9 speedup mhlalgorithm routin dsbrdt tridiagon band matric skalgorithm lapack routin dsbtrd without updat matrix u left right pictur resp updat n u transform aggreg block transform 52 onestep tridiagon band matric next compar skalgorithm lapack routin dsbtrd mhl algorithm dsbrdt onestep tridiagon algorithm band matri ce mhlalgorithm updat u done use block household transform default block size n u figur 9 show result variou matrix dimens semibandwidth machin lang 1993 alreadi note lapack implement optim except small semibandwidth reason bulk comput must done explicit fortran loop sinc appropri bla routin cover therefor routin run fortran speed wherea mhlalgorithm reli level 2 bla reduct level 3 bla updat u sp node mhlalgorithm run 45 mflop reduct 53 mflop updat dsbtrd reach 20 30 mflop respect addit skalgorithm requir 50 flop u updat situat may differ vector machin dsbtrd featur vector oper higher averag vector length albeit nonunit stride tabl ii time second one node ibm sp tridiagon band symmetr matric order 1200 intermedi semibandwidth twostep reduct onestep reduct dsbrdt 83 150 250 twostep reduct dsbrdb dsbrdt 113 136 229 53 twostep tridiagon band matric section 353 show peel diagon two equal chunk requir fewer flop direct tridiagon mhlalgorithm tabl ii show time twostep approach lower semiband width larg enough contrast theoret result howev intermedi semibandwidth b2 alway optim exampl took 2003 second first reduc semibandwidth tridiagon matrix explan case b work done bandwidth reduct reli block household transform wherea final tridiagon therefor higher perform level 3 bla compens slighli higher flop count compar b small semibandwidth b lower flop count twostep scheme outweigh lower overhead eg fewer call bla larger subma trice onestep reduct reduct full matric onestep tridiagon alway superior u requir 54 doublingstrid tridiagon band matric mhlalgorithm clearli superior machin bla perform significantli exce pure fortran code may applic storag tight therefor also compar two algorithm need one addit subdiagon work space skalgorithm routin dsbtrd lapack doublingstrid sequenc section 352 multipl call dsbrdb reduct updat u one call dsbrdt result given figur 10 show doublingsequ tridiagon well outperform skalgorithm machin 6 conclus introduc framework band reduct gener idea underli household tridiagon full matric rutishaus algorithm mhlalgorithm band matric peel subdiagon chunk arriv algorithm requir fewer floatingpoint oper less storag also provid intuit explan approach elimin subdiagon group lower comput complex matrix size sp1 updat matrix size sp1 updat 200 400 600 800 1000 1200 matrix size paragon updat 200 400 600 800 1000 1200 matrix size paragon updat figur 10 speedup doublingsequ tridiagon routin dsbrdb dsbrdt skalgorithm lapack routin dsbtrd without updat matrix u left right pictur resp previou algorithm band matric elimin subdiagon either one one success bandreduct sbr approach improv scope block oper particular updat transform matrix u alway done block household transform also present result show sbr approach provid better perform either use less memori achiev almost speed achiev higher perform experi suggest hard provid rule thumb select paramet optim bandreduct algorithm flop count minim use cost function 3 actual perform implement depend machinedepend issu floatingpoint versu memori access cost experi develop realist perform model advanc comput architectur difficult see exampl bischof lacrout 1990 even simpler problem anoth paper bischof et al 1996 describ implement issu publicdomain sbr toolbox enabl comput praction experi sbr approach problem interest r data structur algorithm parallel tridiagon twostep band reduct wy represent product household matric adapt block strategi matrix factor sbr toolbox softwar success band reduct framework band reduct tridiagonaliza tion symmetr matric tridiagon symmetr matrix squar array meshconnect processor block reduct matric condens form eigenvalu comput matrix eigensystem routin eispack guid extens matrix comput 2nd singular valu decomposit systol array band eigenvalu solver vector machin parallel algorithm reduc symmetr band matric tridiagon form use level 3 bla rotat base algorithm paralleliz eigensolv real diagonaliz matric real eigenvalu new method tridiagon symmetr band matrix jacobi rotat pattern bidiagon symmetr tridiagon systol array journal vlsi signal process storageeffici wy represent product household transform tridiagon symmetr band matrix matrix eigensystem routin eispack guid 2nd ed tr wy represent product household matric solut larg dens symmetr gener eigenvalu problem use secondari storag storageeffici wy represent product household transform adapt block strategi matrix factor parallel algorithm reduc symmetr band matric tridiagon form matrix comput 3rd ed use level 3 bla rotationbas algorithm band eigenvalu solver vector machin band reduct algorithm revisit algorithm 807 data structur algorithm automat tune linear algebra softwar ctr daniel kressner block algorithm reorder standard gener schur form acm transact mathemat softwar tom v32 n4 p521532 decemb 2006 christian h bischof bruno lang xiaobai sun algorithm 807 sbr toolboxsoftwar success band reduct acm transact mathemat softwar tom v26 n4 p602616 dec 2000