spreadsheet imag describ data visual system base spreadsheet cell spreadsheet contain graphic object imag volum movi cell may also contain widget button slider curv editor object display miniatur insid cell formula cell written generalpurpos program languag tcl augment oper array manipul imag process renderingcompar flow chart visual system spreadsheet express morescal easier program compar convent numer spreadsheet spreadsheet imag pose sever uniqu design problem larger formula longer comput time complic intercelldepend respons problem extend spreadsheet paradigm three way formula display result anywher spreadsheet cell select disabl multipl cell edit discuss extens implic also point unexpect use spreadsheet visual databas browser graphic user interfac builder smart clipboard desktop present tool b introduct major commerci avail imag process data visual system employ flow chart paradigm user select process modul menu wire togeth use mous although eleg principl flow chart limit express scalabl use program construct like procedur call variabl substitut conveni express system flow chart spend screen real estat oper interconnec tion becom uninterest flow chart address center integr system email levoycsstanfordedu stanford univers web httpwwwgraphicsstanfordedu stanford ca 943054070 specifi run screen space chart exce dozen oper flow chart also provid conveni mechan manag multipl dataset propos altern paradigm base spreadsheet broadli speak spreadsheet system specifi constraint among cell arrang grid cell may contain constant data valu formula evalu data valu formula may refer valu cell may alter valu cell formula typic written simpl interpret languag exampl spreadsheet system microsoft excel lotuss 123 borland quattro implement spreadsheet imag hen ceforth denot si extend notion data valu includ graphic object imag object display miniatur insid cell doubl click cell bring fullsiz object cell may also contain interact widget manipul widget modifi data associ cell formula cell refer modifi cell recomput well formula spreadsheet written tcl generalpurpos program languag provid variabl assign statement procedur full complement control structur formula cell rang onelin express entir program support edit mula si intim tie emac popular customiz text editor doubl click cell bring emac window devot cell compar flow chart system presenc embed formula languag make si express infinit grid spreadsheet togeth abil resiz cell give si better scalabl si also spend screen space operand rather oper usual interest user final spreadsheet twodimension provid natur mechan appli multipl oper multipl dataset compar convent numer spreadsheet si offer three import extens firstli formula si display result anywher spreadsheet allow user intermix function imper program style simplifi mani common task secondli si allow cell select disabl allow user work one part spreadsheet time use featur face long cell comput time thirdli si allow multipl cell edit fire group simplifi develop complic spreadsheet three extens complic depend analysi cell fire algorithm shall see remaind paper organ follow section present reason choos tcl formula languag describ tcl si fit togeth section 3 describ logic structur command set si remain section describ si implement experi si comparison system futur si load store display openwindow closewindow popwindow pushwindow regist manipul loadsheet storesheet winsiz titleheight viewpixel servic cellsiz viewcel cut copi past delet enabl disabl cell manipul regexist queryreg codereg codecel data structur queri figur 1 command si kernel star command also avail use point click interfac 2 tcl formula languag conceptu point view choic formula languag unimport envis si kit part languag replac modul prototyp sought languag power easi type interpret rather compil interact choic tcl toolkit command languag 3 tcl consist applicationindepend embedd command interpret set builtin command manipul variabl string list file set ccallabl interfac routin ad addit command exampl tcl code scatter throughout paper user point view tcl advantag easi type like unix shell command provid varieti control structur substitut mechan like unix shell better implementor point view tcl advantag small code size fast execut fast enough use mous event loop simpl interfac procedur call string argument tcl one advantag basi tk 4 x11 toolkit similar xt tk provid base set graphic textori widget mechan defin new widget simplifi interfac user applic x window system sgi user tk replac window manag event handl servic present gl miss opengl tcltk user commun expand expect see set 3d graphic imag process tcl appear two place si firstli languag formula written secondli si program provid tcl command prompt user may invok function si includ function normal driven mous enter command prompt capabl allow user record play back interact session custom si initi script perform mani use task 3 structur command si si consist kernel one standalon applic packag kernel manag memori display spreadsheet contain fire algorithm applic packag creat manipul data regist respons defin tkcompat widget display regist creat modular design reflect one ousterhout goal tcl system compos compact reusabl part scalar vector scanlin imag volum regist creation button slider label plot imageview cineview display widget copi extract insert promot slice delet regist manipul add subtract multipli divid mod makeramp ramp shift pixel oper rotat convolv scale displac makedisplac spatial oper readabeka deinterlac profil opinion occup 3d occup grid figur 2 command prototyp imag process packag includ command process 3d occup grid use gener figur 5 section take tour logic structur command set si kernel exampl includ command simpl imag process applic packag command set si kernel list figur 1 command set imag process packag list figur 2 31 regist basic unit storag si call regist regist name alloc memori regist may contain thing imag volum geometri etc si kernel control alloc dealloc regist kernel know noth content regist content interpret regist determin applic packag command know manipul command si gener consist command name follow option one argument argument list command includ name one regist exampl rotat bspline myreg 45 newreg rotat volum regist name myreg around yaxi 45 degre command use cubic bspline resampl filter place result regist name newreg minim number type coercion user must per command accept varieti regist type perform convers appli default ignor argument appropri one import default name output regist newreg omit si make name make form use command produc regist output return string result give name output regist regist produc command use input anoth command use tcl command substitut mechan rotat bspline load headmri 45 newreg formula load command execut first gener arbitrari name output regist eg reg123 rotat execut next argument reg123 45 newreg regist produc load command never seen user unimport delet automat si formula modifi cell delet 32 display widget content regist undisplay second build block si display widget view regist type regist may one widget know display other may none regist would need convert display type order view display widget associ regist use widget command exampl cineview rock load headmri load volum regist open window workstat screen contain instanc cine viewer widget widget contain imag subwindow interact control view slice volum flipbook anim rock option specifi anim altern direct rather circl last frame back first frame 33 cell third build block si cell addit usual appear display widget si know draw miniatur insid spreadsheet cell miniatur version widget may live mean respond mous event like fullsiz widget dead case doubl click miniatur version bring fullsiz widget display widget associ cell ad cell name argument widget command display miniatur version cine viewer widget cell a1 type cineview rock load headmri far assum formula enter si program prompt formula instead type emac window associ particular cell cell name argument may omit a1 cineview rock load headmri use notat a1 typeset time roman signifi formula follow typeset courier contain cell a1 a1 appear cell everi type regist default display widget volum cine viewer therefor formula cell a1 could simplifi read a1 load headmri execut formula would caus specifi file load volum regist miniatur version cine viewer display cell formula contain one command separ newlin regist return last command execut display cell common case user doesnt need think regist display widget write formula vast major formula look like last exampl key provid breviti flexibl formula languag lie liber use default 34 chain formula togeth cell name may use context regist name valid allow us refer data cell either regist name cell name simpl three cell spreadsheet a1 load alpsrgb b1 rotat c1 ramp b1 makeramp 0 255 255 0 first command load imag cell a1 miniatur version imag display cell second command rotat imag 45 degre display result cell b1 third command invert pixel valu rotat imag display result cell c1 makeramp command accept tcl list coordin pair return tcl list coordin piecewis linearli interpol specifi coordi nate exampl command would return tcl list 0 255 1 254 2 253 list becom input argument ramp command modifi imag cell b1 35 way refer cell numer spreadsheet refer cell rel absolut b1 rel refer formula contain refer move one row use cut past refer would chang b2 formula edit emac window time reloc si send updat text emac contrast notat b1 b1 b1 forc column row coordin absolut respect absolut refer modifi cell reloc si also support arithmet calcul cell refer exampl a123 refer cell two row three column right base address a1 formula contain refer move one row base address would chang a2 refer would stay correct note construct similar excel offseta123 somewhat easier type final tcl substitut mechan appli cell refer thu a1ij refer cell whose row column offset a1 given tcl variabl respect similarli a1foobar refer cell whose offset valu return tcl command foo bar final everi occupi cell spreadsheet associ tcl command return content regist display cell thu a1b1b2 refer cell whose offset valu contain cell b1 b2 36 activ widget addit live dead widget may passiv mean display underli regist activ mean display modifi underli regist exampl a1 load alpsrgb b1 slider b2 rotat command slider cell b1 widget command sinc invok without argument exampl compar cineview command exampl 1 default scalar integ regist creat slider display content regist operand b1 cell b2 invok command b1 return current valu slider cell b1 rotat command rotat imag cell a1 amount sinc formula cell b2 depend cell b1 move slider caus rotat recomput spreadsheet exampl shown figur 3 slider widget realli tk scale widget option visibl slider command figur option defin tk scale command addit tkdefin option activ widget accept nocontinu option specifi continu mean widget fire descend repeatedli fast possibl mous button releas slider previou exampl defin drag slider bar back forth would caus imag rotat back forth reduc comput delay cell b2 begin long sequenc oper activ widget also accept nofiredescend option specifi nofiredescend mean widget fire immedi children long mous button button releas widget descend fire 37 control structur si support control structur tcl includ foreach case particular interest loop command loop si take one three gener form singlecel loop easiest way code loop entir within one cell use tcl command a1 load alpsreg temp set 0 90 incr 30 rotat temp a1 formula step alpin pastur imag four rotat posit appear briefli cell a1 multicel forloop user alreadi built sequenc process step decid retrospect iter one paramet sequenc rang valu done without rework entir spreadsheet insert one addit cell begin loop trigger a2 set 0 90 incr 30 byte a2 fire b2 2 b1 load alpsreg b2 rotat b1 a2 b3 ramp b2 makeramp 0 0 255 100 origin spreadsheet consist cell b1 b3 cell a2 ad control loop byte command creat scalar byte regist display a2 use label widget fire command execut cell b2 subroutin cell b2 descend b3 exampl finish execut ing control return a2 increment loop multicel whileloop user wish predic loop termin valu comput loop bodi two cell requir control loop a1 load alpsreg 3 b2 convolv box c1 c1 c3 max gradient byte exampl byte command cell c1 initi loop command cell c3 evalu data object comput loop bodi condit modifi cell c1 loop bodi depend loop bodi therebi reexecut repeatedli condit becom fals figur 3 slider widget use control rotat cell b2 rotat imag cell a1 angl specifi slider cell b1 time slider move cell b2 descend recomput exampl cell a1 blur box filter increas width start 3x3 stop maximum gradient magnitud imag drop 50 4 select implement detail 41 user interfac si implement c c tcltk emac lisp depend unix x window system otherwis platform independ widget current depend gl nonport version silicon graphicss graphic librari shortli convert opengl platformindepend librari uniqu characterist si pose sever challeng user interfac design problem firstli cell larger numer spreadsheet fewer display make navig easier provid acceler scroll tool abil quickli chang size cell individu cell resiz would destroy regular spreadsheet grid secondli longer formula power languag semant lead complic intercel depend numer spreadsheet keep user get lost formula cell display insid cell long formula option decim fit see figur 5 6 although decim text legibl overal structur clearli visibl clarifi intercel depend depend graph display overlay see figur 4 5 thirdli cell take longer comput cell numer spreadsheet sever minut extrem case keep spreadsheet visual consist long computa tion cell depend modifi cell gray macintosh style indic date cell fire highlight provid feedback progress mous aliv cell comput use navig spreadsheet abort errant comput respons long cell comput time si allow cell select disabl allow user work one part spreadsheet time addit user select group cell edit simultan emac fire entir group singl keystrok featur describ cosmet last two profoundli affect fire algorithm discuss next section 42 manag depend depend relationship si repres direct acycl graph two type node formula object object consist cell name regist name tcl vari abl tcl procedur formula consum object eg specifi cell input invok tcl procedur etc repres graph direct edg object formula formula produc object eg specifi cell output defin tcl procedur etc repres direct edg formula object follow user modif one formula object depend graph travers describ appendix modifi formula descend recomput time requir perform depend analysi usual sever order magnitud smaller time requir execut formula decim imag display discuss si fire algorithm differ fire algorithm found convent spreadsheet two way firstli abil specifi object output formula forc us distinguish formula object depend graph give rise produc edg edg formula object surprisingli addit flexibl complic depend analysi substant way second differ aris abil select disabl reenabl cell edit sever formula convent spreadsheet allow either action result fire algorithm begin queue edit reenabl formula need execut complic matter tcl allow condit execut command substitut command operand see section 35 prevent us lexic scan formula advanc execut determin set object consum produc without inform imposs determin formula queue execut first standard problem oper system design standard solut solut use si describ appendix execut modifi formula arbitrari order requeu consum undefin invalid object depend relationship inde acycl algorithm guarante find valid fire order presenc cycl lead condit call livelock detect fire algorithm solut lead wast comput formula contain long comput follow refer invalid object requir formula requeu recomput scratch later case rare practic formula usual make consum refer earli time lost requeu neglig user see final fire order current investig solut includ block formula execut invalid object avail case cycl lead condit call lexic scan cell resolv mani refer possibl allow formula declar set object might consum produc execut 5 experi exampl experi si limit posit although imag process packag offer rudimentari function use sever research project see figur 5 also found unexpect use si summar research result colleagu give public present see figur 6 sometim use simpli smart clipboard store imag desktop like macintosh clipboard power plausibl applic si databas browser exposur sheet comput anim video postproduct planner abil specifi output formula make si differ convent spreadsheet worthwhil consid addit power might use consid spreadsheet shown figur 4 user exampl began build pipelin classifi 3d medic dataset puzzl classifi volum display cell d2 user ad follow diagnost code formula cell set mean set z 0 z d2 zlen incr z lappend mean mean slice d2 set order lorder mean set 0 5 incr slice d2 b40i lindex order code creat tcl list contain mean pixel intens d2 zlen slice classifi volum call lorder tcl proc defin elsewher formula gener second list contain slice number order decreas mean slice pixel intens display brightest 5 slice cell b4 f4 still puzzl user creat formula cell f5 g5 analyz one slice exampl abil display result anywher spreadsheet made easi insert visual equival printf statement exist formula without reorgan spreadsheet abil defin refer local variabl made easi write forloop need sort slice convent spreadsheet dont allow local variabl formula flexibl use imper program style assign statement cell d2 produc cell f4 function program style cell g5 consum cell f4 extend break spreadsheet paradigm contrari seem natur exampl would difficult write without flexibl 6 comparison discuss spreadsheet imag new idea piersol asp packag 6 spreadsheet program base smalltalk80 objectori program environ anticip mani featur si cell allow contain sort object includ imag spreadsheet formula written smalltalk gener purpos program languag keep convent spreadsheet paradigm formula cell asp permit alter valu cell palaniappan iiss environ 5 combin custom mathematicalik formula languag mark overmarss form ui toolkit khoro imag process librari iiss appear allow assign statement complet definit languag fire algorithm yet publish key featur si abil intermix function imper program see exampl section 5 figur 4 simpl classif pipelin 3d medic dataset slice chosen use slider cell b1 classifi accord transfer function select cell c1 unclassifi classifi slice display cell b2 c2 respect user press button cell d1 entir volum classifi display cell d2 addit brightest 5 slice display row 4 display classifi slice control formula cell d2 see section 5 emac editor window also visibl current edit content formula cell d2 interestingli convent numer spreadsheet also offer imper program usual form second hidden command languag flexibl cell formula languag write imper program use excel version 40 2 user creat auxiliari spreadsheet call macro sheet special properti formula macro sheet assign valu cell macro sheet use setvalu function notat permit main spreadsheet advantag twolanguag design present simpl program model novic comput user disadvantag jump complex spreadsheet program macro sheet program larg current domin paradigm visual imag data flow chart worthwhil compar si earliest system combin graphbas execut model visual program interfac paul haeberli conman 1 current popular flowchart visual packag includ av explor ape khoro ibm data explor pvwave wavefront data visual fieldview intellig light voxelview mani other sgi explor 7 perhap highli develop packag base comparison three major factor identifi express repeat modul explor approxim loop tcl explor contain modul howev evalu condit perform substitut unless user write custom modul scalabl micro form modul icon explor measur modul associ wire make crowd window modul may coalesc singl icon user must perform reduct cell si resiz 12 x 17 pixel simpli drag window frame allow 6000 cell display although cell unread size view make easi navig larg spreadsheet custom explor provid extens support write custom modul jump complex visual program modul program c fortran nontrivi si formula languag also custom languag transit novic user expert user therefor smooth facilit rapid modul prototyp explor also offer interpret languag call shape power greater tcl directli support array manipul interfac flow chart via encapsul latfunct modul somewhat cumbersom 7 statu futur work kernel si complet rel stabl effort focus build applic packag imag process packag use exampl need command richer librari widget plan soon add volum visual packag polygon mesh packag surfac fit packag critic issu futur si perform spreadsheet offer natur mechan present flow chart yet exploit si control comput expens imag need comput resolut commensur size cell display earli stage data explor miniatur imag suffic comput fast user stretch spreadsheet imag get bigger comput slow user doubl click cell cell recalcul full resolut mani imag process oper lend obviou way comput shed spatial warp subsam pled frequenc domain oper window polygon mesh retil use fewer polygon goal make optim transpar user anoth area futur develop formula languag tcl ideal solut mani respect offer one datatyp string numer datatyp arithmet express cumbersom write exampl paper demonstr tcl also support multidimension array manipul array henc imag si must done clanguag command final tcl speed compil languag like c often find prototyp comput tcl rewrit combin tcl c altern tcl includ lisp c c interpret sever exist new languag combin simplic tcl power array manipul languag like mathematica matlab summar si combin power data analysi languag interact flow chart visual extemporan qualiti spreadsheet power si seem use easili manag exampl one shown figur 4 si nevertheless gener program environ possibl creat confus program use particular flow control whileloop section 37 obviou gener presenc condit execut command substitut command operand mean refer pattern formula si dynam cycl appear disappear spreadsheet recomput abil si display depend graph detect cycl help foolproof continu refin design si search data analysi paradigm simpl enough keep novic troubl yet power enough satisfi need scientistprogramm 8 acknowledg discuss david heeger richard frank bob brown robert skinner use earli stage project wish particularli acknowledg mani fruit discuss philipp lacrout research support nsf contract ccr9157767 softwar publish 9 r conman visual program languag interact graphic microsoft corpor tcl embedd command languag x11 toolkit base tcl languag exploratori analysi satellit data use interact imag spreadsheet iiss environ object orient spreadsheet analyt spreadsheet packag silicon graphic inc tr objectori spreadsheet analyt spreadsheet packag ctr ed huaihsin chi john riedl phillip barri joseph konstan principl inform visual spreadsheet ieee comput graphic applic v18 n4 p3038 juli 1998 ed huaihsin chi joseph konstan phillip barri john riedl spreadsheet approach inform visual proceed 10th annual acm symposium user interfac softwar technolog p7980 octob 1417 1997 banff alberta canada varshney kaufman finess financi inform spreadsheet proceed 1996 ieee symposium inform visual infovi 96 p70 octob 2829 1996 kwanliu imag graphsa novel approach visual data explor proceed confer visual 99 celebr ten year p8188 octob 1999 san francisco california unit state glenn iwerk hanan samet internet spatial spreadsheet enabl remot visual dynam spatial data ongo queri result network proceed 11th acm intern symposium advanc geograph inform system p154160 novemb 0708 2003 new orlean louisiana usa hidekazu shiozawa kenichi okada yutaka matsushita 3d interact visual intercel depend spreadsheet proceed 1999 ieee symposium inform visual p79 octob 2429 1999 j jankunkelli kwanliu spreadsheet interfac visual explor proceed confer visual 00 p6976 octob 2000 salt lake citi utah unit state e h h chi p barri j riedl j konstan spreadsheet approach inform visual proceed 1997 ieee symposium inform visual infovi 97 p17 octob 1825 1997 j jankunkelli kwanliu visual explor encapsul via spreadsheetlik interfac ieee transact visual comput graphic v7 n3 p275287 juli 2001 eser kandogan eben haber rob barrett allen cypher paul maglio haixia zhao a1 endus program webbas system administr proceed 18th annual acm symposium user interfac softwar technolog octob 2326 2005 seattl wa usa ed huaihsin chi john riedl phillip barri joseph konstan principl inform visual spreadsheet ieee comput graphic applic v18 n4 p3038 juli 1998 ed huaihsin chi john riedl oper interact framework visual system proceed 1998 ieee symposium inform visual p6370 octob 1920 1998 north carolina margaret burnett john atwood rebecca walpol djang jame reichwein herkim gottfri sherri yang forms3 firstord visual languag explor boundari spreadsheet paradigm journal function program v11 n2 p155206 march 2001