hop integr comput network comput network said provid hop integr iff router p network receiv messag supposedli adjac router q p check inde sent q modifi sent replay old messag sent q p paper describ three protocol ad router comput network network provid hop integr thu overcom denialofservic attack three protocol secret exchang protocol weak integr protocol strong integr protocol three protocol stateless requir small overhead constrain network protocol router way b introduct comput network suffer follow secur problem typic network adversari access network insert new messag modifi current messag replay old messag network mani case insert modifi replay messag go undetect time caus sever damag network importantli physic locat network adversari insert new messag modifi current messag replay old messag may never determin two wellknown exampl attack network support internet protocol ip short transmiss control protocol tcp short follow work support part grant arp003658320 advanc research program texa higher educ coordin board smurf attack ip network comput send ping messag comput repli send back pong messag first comput requir internet control messag protocol icmp short 14 ultim destin pong messag origin sourc ping messag adversari util messag attack comput network follow first adversari insert network ping messag whose origin sourc comput whose ultim destin multicast address everi comput network second copi insert ping messag sent everi comput network third everi comput network repli ping messag send pong messag comput thu comput flood pong messag request ii syn attack establish tcp connect two comput c one two comput c send syn messag comput receiv syn messag reserv resourc expect connect send synack messag c c receiv synack messag repli send back ack messag receiv ack messag connect fulli establish two comput start exchang data messag establish connect hand receiv ack messag specifi time period second sent synack messag discard partial establish connect releas resourc reserv connect net effect scenario comput lost resourc second adversari take advantag scenario attack comput follow 1 18 first adversari insert network success wave syn messag whose origin sourc differ messag easili detect filter network whose ultim destin second receiv syn messag reserv resourc expect connect repli send synack messag wait correspond ack messag never arriv third net effect wave insert syn messag comput lose resourc second 7 type attack adversari insert network messag wrong origin sourc messag accept unsuspect router rout toward comput attack counter attack router p network rout receiv check origin sourc comput adjac p forward p adjac router q perform first check straightforward wherea perform second check requir special protocol adjac router paper present suit protocol provid hop integr adjac router whenev router p receiv messag adjac router q p detect whether inde sent q modifi replay adversari oper p q instruct compar hop integr secur rout 2 11 17 ingress filter 4 ipsec 8 secur rout exampl 2 11 17 rout updat messag router exchang authent authent ensur everi rout updat messag modifi replay detect discard contrast hop integr ensur messag whether data rout updat messag modifi replay detect discard use ingress filter 4 router network boundari check whether record sourc receiv messag consist router receiv messag messag sourc consist router forward messag usual otherwis router discard messag thu ingress filter detect messag whose record sourc modifi hide true sourc messag provid modif occur network boundari messag whose record sourc modifi adjac router middl network detect ingress filter detect discard hop integr hop integr protocol suit paper ipsec protocol suit present 8 9 10 12 13 intend provid secur ip layer nevertheless two protocol suit provid differ somewhat complementari servic one hand hop integr protocol execut router network provid minimum level secur commun adjac router network hand ipsec protocol execut select pair comput network provid sophist level secur commun select comput pair clearli one envis network hop integr protocol suit ipsec protocol suit support next describ concept hop integr detail 2 hop integr protocol network consist comput connect subnetwork exampl subnetwork local area network telephon line satellit link two comput network call adjac iff comput connect subnetwork two adjac comput network exchang messag common subnetwork connect comput network classifi host router simplic assum host network connect one subnetwork router connect two subnetwork messag transmit comput faraway comput network follow first messag transmit one hop comput router r1 adjac second messag transmit one hop router r1 router r2 adjac r1 final messag transmit one hop router rn adjac comput comput network said provid hop integr iff follow two condit hold everi pair adjac router p q network detect messag modif whenev router p receiv messag subnetwork connect router p q p determin correctli whether messag modifi adversari sent q receiv p ii detect messag replay whenev router p receiv messag subnetwork connect router p q determin messag modifi p determin correctli whether messag anoth copi messag receiv earlier p network provid hop integr two thin protocol layer need ad protocol stack router network discuss 3 16 protocol stack router host network consist four protocol layer bottom top subnetwork layer network layer transport layer applic layer two thin layer need ad protocol stack secret exchang layer integr check layer secret exchang layer ad network layer transport layer integr check layer place network layer subnetwork layer function secret exchang layer allow adjac router period gener exchang share new secret exchang secret made avail integr check layer use comput verifi integr check everi data messag transmit adjac router figur 1 show protocol stack two adjac router p q secret exchang layer consist two process pe qe router p q respect integr check layer two version weak strong weak version consist two process pw qw router p q respect version detect messag modif messag replay strong version integr check layer consist two process ps qs router p q respect version detect messag modif messag replay next explain hop integr along ingress filter use prevent smurf syn attack describ introduct recal smurf syn attack adversari insert network ping syn messag wrong origin sourc forg messag insert either boundari router two router middl network ingress filter usual instal boundari router 4 detect forg messag insert boundari router record sourc messag would inconsist host messag receiv howev ingress filter may fail detect forg messag messag insert two router middl network exampl adversari log host locat two router p q use host insert forg messag toward router p pretend messag sent router q real sourc messag determin router p router p decid whether messag sent router q host p q howev hop integr instal two router p q weak strong integr check layer router p conclud forg messag modifi sent router q although actual insert adversari sent router q discard smurf syn attack also launch replay old messag exampl adversari log host locat two router p q adversari spot pass legitim ping syn messag sent q p keep copi pass messag later time adversari replay copi messag launch smurf syn attack hop integr defeat attack follow hop integr instal two router p q strong integr check layer check layer exchang layer pe network pw ps applic transport subnetwork qe network qw qs applic transport subnetwork router p router q figur 1 protocol stack achiev hop integr router p detect replay messag discard next three section describ detail protocol secret exchang layer two version integr check layer first protocol process pe qe discuss section 3 second protocol process pw qw discuss section 4 third protocol process ps qs discuss section 5 three protocol describ use variat abstract protocol notat present 5 notat process protocol defin set input set variabl set action exampl protocol consist process px qx process px defin follow process px inp name input type input name input type input var name variabl type variabl name variabl type variabl begin comment ad anywher process definit comment place two bracket input process px read updat action process px thu valu input px either fix updat anoth process outsid protocol consist px qx variabl process px read updat action process px process px form action px either boolean express statement form rcv qx action px sequenc skip statement statement form variabl px statement form send qx statement form boolean express boolean express execut action consist execut statement action execut action differ process protocol proce accord follow three rule first action execut guard true second action protocol execut one time third action whose guard continu true eventu execut execut action process px caus messag sent process qx two channel two process one px qx qx px sent messag px qx remain channel px qx eventu receiv process qx lost messag resid simultan channel form sequenc m1 m2 mn accord order sent head messag sequenc m1 earliest sent tail messag sequenc mn latest sent messag receiv order sent assum adversari exist process px qx adversari perform follow three type action disrupt commun px qx first adversari perform messag loss action discard head messag one two channel px qx second adversari perform messag modif action arbitrarili modifi content head messag one two channel px qx third adversari perform messag replay action replac head messag one two channel messag sent previous simplic assum head messag one two channel px qx affect one adversari action 3 secret exchang protocol secret exchang protocol two process pe qe maintain two share secret sp sq secret sp use router p comput integr check data messag sent p router q also use router q verifi integr check data messag receiv q router p similarli secret sq use q comput integr check data messag sent p use p verifi integr check data messag receiv q part maintain two secret sp sq process pe qe need chang secret period say everi te hour chosen valu te process pe initi chang secret sq process qe initi chang secret sp process pe qe public key privat key use encrypt decrypt messag carri new secret pe qe public key known process layer wherea privat key known owner process public privat key process pe name b p r p respect similarli public privat key process qe name b q r q respect process pe chang secret sq follow four step need perform first pe gener new sq encrypt concaten old sq new sq use qe public key b q send result rqst messag qe second qe receiv rqst messag decrypt messag content use privat r q obtain old sq new sq qe check current sq equal old sq rqst messag instal new sq current sq send rpli messag contain encrypt new sq use pe public key b p third pe wait receiv rpli messag qe contain new sq encrypt use b p receiv rpli messag indic qe receiv rqst messag accept new sq fourth pe send rqst messag qe receiv rpli messag qe tr second indic either rqst messag rpli messag lost receiv pe resend rqst messag qe thu tr upper bound round trip time pe qe note old secret along new secret includ rqst messag new secret includ rpli messag ensur adversari modifi replay rqst rpli messag messag detect discard receiv process whether pe qe process pe two variabl sp sq declar follow array 0 1 integ similarli process qe integ variabl sq array variabl sp process pe variabl sp use store secret sp variabl sq0 use store old sq variabl sq1 use store new sq assert indic process pe gener sent new secret sq qe may receiv yet assert qe alreadi receiv accept new secret sq initi sq0 pe sq1 pe sq qe sp0 qe sp1 qe sp pe process pe defin follow process qe defin way except occurr r p pe replac occurr r q qe occurr b q pe replac occurr b p qe occurr sp pe replac occurr sq qe occurr sq0 sq1 pe replac occurr sp0 sp1 respect qe process pe privat key pe round trip time array 0 1 integ initi qe begin timeout te hour pass sinc rqst messag sent last send rqste qe rcv rqste qe e ncrb q sp send rplye qe skip rcv rplye qe detect adversari skip timeout tr second pass sinc rqst messag sent last send rqste qe four action process pe use three function newscr ncr dcr defin follow function newscr take argument invok return fresh secret differ secret return past function ncr encrypt function take two argument key data item return encrypt data item use key exampl execut statement caus concaten sq0 sq1 encrypt use public key b q result store variabl e function dcr decrypt function take two argument key encrypt data item return decrypt data item use key exampl execut statement caus encrypt data item e decrypt use privat key r p result store variabl anoth exampl consid statement statement indic valu e encrypt concaten two valu v use thu execut statement caus e decrypt use key r p result first valu v 0 store variabl result second valu v 1 store variabl e proof correct secret exchang protocol present full version paper 6 4 weak integr protocol main idea weak integr protocol simpl consid case datat messag messag text gener sourc src transmit sequenc adjac router r1 r2 rn destin dst datat reach first router r1 r1 comput digest messag follow mdt scr md messag digest function scr concaten messag text share secret scr r1 r2 provid secret exchang protocol r1 r1 add messag transmit result datat messag router r2 second router r2 receiv datat messag r2 comput messag digest use secret share r1 r2 provid secret exchang process r2 check whether result equal unequ r2 conclud receiv messag modifi discard report adversari equal r2 conclud receiv messag modifi proce prepar messag transmiss next router r3 prepar messag transmiss r3 consist comput use share secret r2 r3 store result field datat messag last router rn receiv datat messag comput messag digest use share secret rn1 rn check whether result equal unequ rn discard messag report adversari otherwis rn send datat messag destin dst note protocol detect discard everi modifi messag importantli also determin locat messag modif occur process pw weak integr protocol two input sp sq pw read never updat two input process pw also variabl process pe pe updat period discuss previou section process pw defin follow process qw defin way except occurr p q pw qw sp sq replac occurr q p qw pw sq sp respect process pw array 0 1 integ var integ begin rcv datat qw mdt defin later rtmsg report adversari skip p receiv datat router q check messag digest correct either p receiv datat adjac host p gener text next data messag first action process pw pw receiv datat messag qw sq0 sq1 pw determin beforehand whether qw comput use sq0 use sq1 case pw need comput two messag digest use sq0 sq1 respect compar two digest either digest equal pw accept messag otherwis pw discard messag report detect adversari three action process pw use two function name md nxt one statement name rtmsg function md take one argument name concaten text messag appropri secret comput digest argument function nxt take one argument name text messag assum includ messag header comput next router messag forward statement rtmsg defin follow send datat qw comput messag digest concaten secret send data nxtt forward datat router nxtt skip proof correct weak integr protocol present full version paper 6 5 strong integr protocol weak integr protocol previou section detect messag modif messag replay section discuss strengthen protocol make detect messag replay well present strong integr protocol two step first present protocol use soft sequenc number detect discard replay data messag second show combin protocol weak integr protocol previou section form strong integr protocol consid protocol consist two process u v process u continu send data messag process v assum adversari attempt disrupt commun u v insert ie replay old messag messag stream u v order overcom adversari process u attach integ sequenc number everi data messag sent process v keep track sequenc process u maintain variabl nxt store sequenc number next data messag sent u process v maintain variabl exp store sequenc number next data messag receiv v send next data messag process u assign current valu variabl nxt increment nxt one process v receiv data messag v compar variabl exp exp q accept receiv data messag assign exp valu discard data messag correct protocol base observ predic exp nxt hold reachabl state protocol howev due fault exampl accident reset valu variabl nxt valu exp becom much larger valu nxt data messag u send point wrongli discard v nxt becom equal exp next describ modifi protocol number data messag wrongli discard synchron u v lost due fault n chosen integ n much larger one modif consist ad process v two variabl c cmax whose valu rang 0n 1 process v receiv data messag v compar valu c cmax c cmax process v increment c one mod n proce name either accept data messag exp discard messag exp otherwis v accept messag assign c valu 0 assign cmax random integ rang 0n1 modif achiev two object first guarante process v never discard n data messag synchron u v lost due fault second ensur adversari predict instant process v will accept receiv data messag exploit predict send replay data messag instant formal process u v protocol defin follow process u sequenc number next sent messag begin true send datanxt v nxt nxt process v sequenc number receiv messag sequenc number next expect messag begin rcv data u reject messag report adversari accept messag exp c 0 process u v soft sequenc number protocol combin process pw weak integr protocol construct process ps strong integr protocol main differ process pw ps pw exchang messag form datat wherea ps exchang messag form data messag sequenc number comput accord soft sequenc number protocol messag text messag digest comput concaten scr share secret scr process ps strong integr protocol defin follow process qs defin way process ps array 0 1 integ var integ begin rcv data qs md reject messag report adversari accept messag exp c 0 report adversari skip p receiv data router q check encrypt correct sequenc number within rang either p receiv datat adjac host p gener text next data first second action process ps statement rtmsg defin follow send datanxt qs comput next soft sequenc number comput messag digest concaten snxt secret send data nxtt forward data router nxtt skip proof correct strong integr protocol present full version paper 6 6 implement consider section discuss sever issu concern implement hop integr protocol present last three section particular discuss accept valu input protocol four input secret exchang protocol section 3 r p b q te tr input r p privat key router p input b q public key router q longterm key remain fix long period time say one three month chang offlin system administr two router thu key consist rel larg number byte say 1024 byte special requir encrypt decrypt function use key secret exchang protocol input te time period two success secret exchang pe qe time period small adversari enough time deduc secret sp sq use comput integr check data messag also larg overhead result secret exchang reduc accept valu te around 4 hour input tr timeout period resend rqst messag last rqst messag correspond rpli messag lost valu tr upper bound roundtrip delay two adjac router two router connect high speed ethernet accept valu tr around 4 second next consid two input sp sq function md use integr protocol section 4 5 input sp sq shortliv secret updat everi 4 hour thu key consist rel small number byte say 8 byte function md use comput digest data messag function md comput two step follow first standard function md5 15 use comput 16 byte digest data messag second first 4 byte digest constitut comput messag digest discuss section 5 input n need much larger 1 exampl n chosen 200 case maximum number messag discard wrongli whenev synchron two adjac router lost 200 probabl adversari replay old messag detect percent messag overhead strong integr protocol 8 byte per data messag 4 byte store messag digest 4 byte store soft sequenc number messag 7 conclud remark paper introduc concept hop integr comput network network said provid hop integr iff whenev router p receiv messag supposedli adjac router q router p check whether receiv messag inde sent q modifi replay adversari oper p q also present three protocol use make comput network provid hop integr three protocol secret exchang protocol section 3 weak integr protocol section 4 strong integr protocol section 5 three protocol sever novel featur make correct effici first whenev secret exchang protocol attempt chang secret keep old secret new secret certain integr check futur messag comput use old secret second integr protocol comput digest everi router along messag rout locat occurr messag modif determin third strong integr protocol use soft sequenc number make protocol toler loss synchron three protocol stateless requir small overhead hop constrain network protocol way thu believ compat ip internet remain estim measur perform ip augment protocol r flood ip spoof attack effici messag authent scheme link state rout internetwork tcpip vol network ingress filter defeat denial servic attack employ ip sourc address spoof element network protocol design hop integr comput network simpl activ attack tcp secur architectur internet protocol ip authent header ip encapsul secur payload esp digit signatur protect ospf rout protocol internet secur associ key manag protocol isakmp oakley key determin protocol internet control messag protocol md5 messagedigest algorithm tcpip illustr secur distanc vector rout protocol internet secur attack basic level tr internetwork tcpip principl protocol architectur tcpip illustr vol 1 element network protocol design hashbas ip traceback network support ip traceback internet secur attack basic level digit signatur protect ospf rout protocol secur distancevector rout protocol hop integr comput network effici messag authent scheme link state rout ctr hain wang abhijit bose moham elgendi kang g shin ip easypass lightweight networkedg resourc access control ieeeacm transact network ton v13 n6 p12471260 decemb 2005 yingfei dong changho choi zhili zhang lip lightweight permit system packet sourc origin account comput network intern journal comput telecommun network v50 n18 p36223641 21 decemb 2006 chri karlof naveen sastri david wagner tinysec link layer secur architectur wireless sensor network proceed 2nd intern confer embed network sensor system novemb 0305 2004 baltimor md usa miao tabu mark scheme speedup ip traceback comput network intern journal comput telecommun network v50 n18 p35363549 21 decemb 2006