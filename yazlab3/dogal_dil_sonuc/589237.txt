bfg updat skip vari memori give condit limitedmemori quasinewton method exact line search termin n step minim ndimension quadrat function show although broyden famili method termin n step fullmemori version bfg limitedmemori addit show fullmemori broyden famili method exact line search termin n step p matrix updat skip introduc new limitedmemori bfg variant test nonquadrat minim problem b introduct quasinewton famili algorithm remain standard workhors minim mani method share properti finit termin strictli convex quadrat function linear superlinear rate converg gener convex function need store evalu second deriv matrix gener approxim second deriv matrix built accumul result earlier step descript mani quasinewton algorithm found book luenberg 16 denni schnabel 7 golub van loan 11 although infinit number quasinewton method one method surpass other popular bfg algorithm broyden fletcher goldfarb shanno see eg denni schnabel 7 method exhibit robust behavior rel mani attempt made explain robust complet understand yet obtain 23 one result work paper small step toward understand sinc investig question much inform drop bfg quasinewton method without destroy properti quadrat termin answer question context exact line search method find minim onedimension subspac everi iter practic inexact line search satisfi side condit propos wolf see x43 substitut exact line search focu modif wellknown quasinewton algorithm result limit memori either discard result earli step x2 skip updat second deriv approxim x3 give condit quasinewton method termin n step minim quadrat function n variabl although broyden famili method see x2 termin n step fullmemori version show bfg nstep termin limitedmemori also show method broyden famili termin n step even p updat skip termin lost skip updat limit memori appli mathemat program univers maryland colleg park md 20742 gibsonmathumdedu work support part nation physic scienc con sortium nation secur agenc univers maryland z depart comput scienc institut advanc comput studi univers maryland colleg park md 20742 olearycsumdedu work support nation scienc foundat grant nsf 9503126 x depart pure appli mathemat washington state univers pullman wa 99164 nazarethamathwashingtonedu gibson p oleari l nazareth x4 report result experi new limitedmemori bfg variant problem taken cute 3 test set show save time achiev notat matric vector denot boldfac uppercas lowercas letter respect scalar denot greek roman letter superscript denot transpos subscript denot iter number product alway taken left right notat spanfx 1 denot subspac span vector x whenev refer ndimension strictli convex quadrat function assum form posit definit n theta n matrix b nvector 2 limitedmemori variat quasinewton algorithm section character fullmemori limitedmemori method termin n iter ndimension strictli convex quadrat minim problem use exact line search fullmemori version method discuss known termin n iter limitedmemori bfg lbfg shown noced 22 termin n step precondit conjug gradient method cast limitedmemori quasinewton method also known termin n iter see eg luenberg 16 littl els known termin limitedmemori method let fx denot strictli convex quadrat function minim let gx denot gradient f defin kth iter let denot chang current iter denot chang gradient let x 0 start point let h 0 initi invers hessian approxim 1 comput 2 choos ff k 0 fx k 3 set 4 set x 5 comput 7 choos h k1 fig 21 gener quasinewton method present gener result character quasinewton method see figur 21 termin n iter restrict method updat form mk lbfg variat 3 1 h 0 n theta n symmetr posit definit matrix remain constant k fl k nonzero scalar thought iter rescal 2 p k n theta n matrix product project matric form n theta n matrix product project matric form u nvector 3 k nonneg integ w ik nvector z ik vector spanf g refer form gener form gener form fit mani known quasinewton method includ broyden famili limitedmemori bfg method assum quasinewton method satisfi secant condit h k1 posit definit symmetr symmetr posit definit updat desir sinc guarante quasinewton method produc descent direct note updat posit definit may produc k case choos ff k neg ff rather posit ff exampl method steepest descent 16 fit gener form 21 k defin note neither w z vector specifi sinc exampl 1st updat conjug gradient method precondition fit gener form 21 exampl lbfg updat see noced 22 limitedmemori constant written kgammam k1k lbfg fit gener form 21 iter k choos 4 gibson p oleari l nazareth observ p k q k z ik obey constraint impos construct bfg relat lbfg follow way use everi pair format updat ie unlimit memori would creat updat bfg practic howev one would never would take memori store bfg matrix exampl defin limitedmemori dfp ldfp definit consist definit limitedmemori bfg given noced 22 let 1 mg order defin ldfp updat need creat sequenc auxiliari matric u dfp h ss matrix k1 result appli dfp updat k time matrix h 0 k recent pair thu 1st ldfp matrix given simplifi descript note k1 rewritten kgammam ki kgammam ki kgammam ki kgammam ki kgammam ki kgammam kj kgammam kj kgammam kj kgammam kl kgammam kl thu h k1 written mk ik kgammam ki kgammam ki kgammam ki mk kgammam kj h j gamma1 kgammam kj h j gamma1 lbfg variat 5 equat 27 look much like gener form given 21 ldfp fit gener form follow choic kgammam ki kgammam ki z except choic p k trivial verifi choic satisfi gener form prove p k satisfi requir need show proposit 21 limitedmemori dfp follow two condit hold valu k proof prove via induct suppos recal spanf 0 g trivial equal spanfh 0 g 0 g furthermor conclud base case hold assum use induct show 210 1st case use induct assumpt induct k get 6 gibson p oleari l nazareth assum induct assumpt next valu map vector v use induct assumpt k get continu induct henc induct complet prove 210 k 1st case consid mk kgammam ki kgammam ki use structur v jk 210 see henc 211 also hold k 1st case exampl broyden class broyden famili class quasinewton method whose matric linear combin dfp bfg matric see eg luenberg 16 chap 9 paramet oe usual restrict valu guarante produc posit definit updat although recent work sr1 broyden class method khalfan byrd schnabel 14 may chang practic restrict oe necessari develop theori broyden class updat express variat 7 sketch explan fullmemori version fit gener form given 21 limitedmemori case similar rewrit broyden class updat follow henc hi left reader show h k k spanf thu broyden class updat fit form 21 21 termin limitedmemori method section show method fit gener form 21 produc conjug search direct orem 22 termin n iter corollari 23 p k map spanfi spanfi n furthermor condit p k satisfi k use format corollari 24 theorem 22 suppos appli quasinewton method figur 21 updat form 21 minim ndimension strictli convex quadrat function k termin ie g k1 6 0 proof assum 215 hold prove 212214 induct sinc line search exact g 1 orthogon 0 use fact p 0 8 gibson p oleari l nazareth 215 fact z i0 2 spanf 0 g impli g see 1 conjug 0 sinc z i0 w 0 lastli spanf 0 g base case establish assum claim 212214 hold also hold vector g k1 orthogon k sinc line search exact use induct hypothes g k orthogon fs conjug g see henc 212 hold prove 213 note suffici prove g use follow fact k1 sinc v project use form q k k1 orthogon span sinc z k spanf orthogon span iii sinc assum 215 hold true exist express p iv orthogon h 0 g k1 orthogon spanf 214 thu variat 9 0 thu 213 hold k lastli use ii map vector v spanfv construct exist henc show equal set show h 0 g k1 linearli independ g alreadi know basi fh 0 linearli independ sinc span space linearli independ set fs number element suppos h 0 g k1 linearli indepen dent exist oe k zero recal g k1 orthogon fs g induct assumpt impli g k1 also orthogon fh 0 g thu j 0 k posit definit g j nonzero conclud oe j must zero sinc true everi j zero k contradict thu set fh 0 linearli independ henc 214 hold k assum 212214 hold k g k1 6 0 215 hold ie exist j k g k1 6 0 j 0 k 2 gibson p oleari l nazareth lead contradict construct p k exist assumpt 216 k must nonzero 213 follow g use fact ii iv 214 217 get mk z ik w ik mk thu sinc neither fl k k zero must contradict sinc h 0 posit definit g k1 assum nonzero method produc conjug search direct say someth termin corollari 23 suppos method type describ theorem 22 satisfi 215 suppos h j scheme reproduc iter conjug gradient method precondition h 0 termin n iter proof let k nonzero h method type describ theorem 22 satisfi 215 condit 212 214 hold claim k 1st subspac search direct spanf equival 1st krylov subspac g 214 know spanf g show via induct spanfh 0 g base case trivial assum lbfg variat 11 214 induct hypothesi impli henc search direct span krylov subspac sinc search direct conjug 213 span krylov subspac iter produc conjug gradient precondition h 0 sinc produc iter conjug gradient method conjug gradient method wellknown termin within n iter conclud scheme termin n iter note requir h j g j nonzero whenev g j nonzero requir necessari sinc method produc posit definit updat possibl construct updat map g j zero happen would breakdown method next corollari defin role latest inform k k play format kth hupdat corollari 24 suppos method type describ theorem 22 satisfi 215 suppos kth iter p k compos p project form 22 least one project must singl project p 1 v must form proof consid case p 1 k1g assum scalar oe ae 215 exist 2 12 gibson p oleari l nazareth 213 set fs conjug thu linearli independ sinc work quadrat sinc symmetr posit definit set fy also linearli independ coeffici k lefthand side 218 must match righthand side thu henc k must make nontrivi contribut p k next show ae assum j 0 j j j j nonzero posit definit ae j nonzero coeffici u nonzero k must make nontrivi contribut p k j impli g contradict henc ae show ae k 6 0 consid p k k suppos ae k1 contradict p k k 2 spanfi must nonzero discuss p 1 case label ucompon p project scalar fl 1 fl p know lbfg variat 13 thu sinc u conclud least one u must nontrivi contribut k 22 exampl method reproduc cg iter specif exampl method fit gener form satisfi condit 215 theorem 22 thu termin n iter exampl conjug gradient method precondition h 0 see 24 satisfi condit 215 theorem 22 sinc exampl limitedmemori bfg see 26 satisfi condit 215 theorem 22 sinc ae 0 exampl dfp full memori see 28 satisfi condit 215 theorem 22 consid p k full memori case fullmemori dfp h 1 use fact one easili verifi p k therefor fullmemori dfp satisfi condit 215 theorem 22 reason appli limitedmemori case shall show x23 next corollari give idea method relat lbfg termin n iter strictli convex quadrat corollari 25 lbfg 25 method termin n iter ndimension strictli convex quadrat function even combin follow modif made updat 1 vari limitedmemori constant keep k 1 2 form project use v k recent along set pair fs 3 form project use v k recent along linear combin pair fs 0 4 iter rescal h 0 proof variant show method fit gener form 21 satisfi condit 215 theorem 22 henc termin corollari 23 1 let 0 valu may chang iter iter defin 14 gibson p oleari l nazareth choos choic fit gener form furthermor variat satisfi condit 215 theorem 22 2 special case next variant 3 iter k let k denot ith choic linear combin span set let choos choic satisfi gener form 21 furthermor ae k henc variat satisfi condit 215 theorem 22 4 let fl k 21 scale constant choos vector matric lbfg 26 combin variant left reader remark part 3 previou corollari show accumul step method gill murray 10 termin quadrat remark part 4 previou corollari show scale affect termin lbfg fact method fit gener form easi see scale affect termin quadrat 23 exampl method reproduc cg iter discuss sever method fit gener form given 21 satisfi condit theorem 22 lbfg variat 15 exampl steepest descent see 23 satisfi condit 215 theorem 22 thu produc conjug search direct fact well known see eg luenberg 16 exampl limitedmemori dfp see 28 satisfi condit p k 215 k method produc conjug direct exampl suppos convex quadrat use limitedmemori constant exact arithmet seen iter termin within first 20 iter limitedmemori dfp mapl notebook file use comput exampl avail world wide web 9 remark use exampl easili see limitedmemori broyden class method except limitedmemori bfg termin within first n iter 3 updateskip variat broyden class quasinewton algo rithm previou section discuss limitedmemori method behav like conjug gradient ndimension strictli convex quadrat function sec tion concern method skip updat order reduc memori demand establish condit finit termin preserv delay broyden class 31 termin updat skip shown powel 26 skip everi updat take direct predict step ie step length one broyden class method procedur termin 2n1 iter ndimension strictli convex quadrat function altern proof result given nazareth 21 prove relat result suppos exact line search use broyden class quasinewton method strictli convex quadrat function decid skip p updat h ie choos h occas algorithm termin n iter contrast powel result matter updat skip multipl updat skip row theorem 31 suppos broyden class method use exact line search appli ndimension strictli convex quadrat function p updat skip let updat iter j skippedg furthermor method termin n iter exact minim proof use induct k show 31 gibson p oleari l nazareth 32 follow easili sinc j 2 jk 0 least valu k jk nonempti ie jk 0 g g k01 orthogon k0 sinc line search exact h k01 sinc member broyden famili satisfi secant condit henc base case true assum 31 33 hold valu show also hold case suppos k 62 j k h k j j 2 j k j case ii suppos k 2 j k h k1 satisfi secant condit kg g k1 orthogon k sinc line search exact orthogon older j argument 34 secant condit guarante h k1 k j j either case induct result follow suppos skip p updat set jn cardin n without loss gener assum set fs g i2jngamma1p zero element 32 vector linearli independ 31 gnp must zero impli xnp exact minim f lbfg variat 17 32 loss termin updat skip limitedmemori unfortun updat use limitedmemori repeat updateskip produc n conjug search direct ndimension strictli convex qua dratic termin properti lost show simpl exampl limitedmemori skip everi updat note accord corollari 24 would still guarante termin use recent inform updat exampl suppos convex quadrat appli limitedmemori bfg limitedmemori constant skip everyoth updat h use exact arithmet mapl observ process termin even 100 iter 9 4 experiment result result x2 x3 lead number idea new method unconstrain optim section motiv de velop test idea describ collect test problem x42 test environ describ x43 section 441 outlin implement lbfg method base comparison xx442447 describ varia tion pseudocod lbfg variat given appendix b complet numer result mani graph numer result origin fortran code avail 9 41 motiv far given result convex quadrat func tion termin quadrat beauti theori necessarili yield insight method practic present new result relat converg algorithm gener function howev mani shown converg use converg analysi present x7 15 15 liu noced show limitedmemori bfg method implement line search satisfi strong wolf condit see x43 definit rlinearli converg convex function satisfi modest condit 42 test problem test problem use constrain unconstrain test environ cute bongartz conn gould toint packag document 3 obtain via world wide web 2 via ftp 1 packag contain larg collect test problem well interfac necessari use problem test problem store sif file chose collect 22 unconstrain problem problem rang size 10000 variabl took lbfg limitedmemori constant least 60 iter solv tabl 41 enumer problem give sif file name dimens n descript problem cute packag also provid start point 43 test environ use fortran77 code sgi indigo 2 run algorithm fortran bla routin netlib use compil default optim level figur 21 outlin gener quasinewton implement follow line search use routin cvsrch cstep written jorg j gibson p oleari l nazareth sif name n descript refer extend rosenbrock function nonsepar version 30 problem 10 problem 17 problem 20 3 tointgor 50 toint oper research problem 29 4 tointpsp 50 toint psp oper research problem 29 5 chnrosnb 50 chain rosenbrock function 29 6 errinro 50 nonlinear problem similar chnrosnb 28 7 fletchbv 100 fletcher boundari valu problem 8 problem 1 8 fletchcr 100 fletcher chain rosenbrock function 8 problem 2 9 penalty2 100 second penalti problem 17 problem 24 problem 5 11 bdqrtic 1000 quartic band hessian band diagon variant broyden tridiagon system band away diagon 29 first penalti problem 17 problem 23 14 power 1000 power problem oren 25 msqrtal 1024 dens matrix squar root problem noced liu case 0 seen nonlinear equat problem 4 problem 204 msqrtbl 1025 dens matrix squar root problem noced liu case 1 seen nonlinear equat problem 4 problem 201 17 cragglvi 5000 extend cragg levi problem 30 problem test problem 5 problem 57 19 powellsg 10000 extend powel singular function 17 problem 13 anoth function nontrivi group repetiti element 12 tridiagon matrix squar root problem 4 problem 151 22 tridia 10000 shanno tridia quadrat tridiagon problem 30 problem 8 tabl test problem collect problem chosen cute packag david thuent 1983 version minpack line search routin find ff meet strong wolf condit see eg noced 23 use 09 except first iter alway attempt step length 10 first use altern valu 10 satisfi wolf condit first iter initi tri step length equal kg remain line search paramet detail appendix gener matrix h k either limitedmemori updat one variat describ x44 store matrix implicitli order save memori comput time termin iter follow condit met iter lbfg variat 19 k 1 inequ satisfi 2 line search fail 3 number iter exce 3000 say iter converg first condit satisfi otherwis method fail 44 lbfg variat tri number variat standard lbfg algorithm lbfg variat describ subsect summar tabl 42 441 lbfg algorithm 0 limitedmemori bfg updat given 25 describ fulli byrd noced schnabel 22 implement follow descript come essenti 22 let h 0 symmetr posit definit assum k pair satisfi let posit integ assum h 0 iter rescal constant fl k commonli done practic matrix h k obtain k applic limitedmemori bfg updat express gammau u k k k theta k matric given ae describ comput k case k 0 let x k current iter let given matric vector 1 updat n theta kgamma1 matric kgamma1 kgamma1 get n theta k matric use kgamma1 2 comput k vector 3 comput k vector use fact alreadi know compon k g kgamma1 kgamma1 g kgamma1 likewis need comput subtract 20 gibson p oleari l nazareth refer brief descript x441 lbfg option allow vari iter base choic kgk allow decreas allow vari iter base choic kgk allow decreas allow vari iter base choic kgxk allow decreas allow vari iter base choic kgxk allow decreas 5 x443 dispos old inform step length greater one 6 x444 variat 1 backup current iter odd 7 x444 variat 2 backup current iter even 8 x444 variat 3 backup step length 10 use last iter 9 x444 variat 4 backup kg k k kg backup step length 10 use last iter backup last iter backup last iter neither two vector merg result merg 2nd 3rd recent step taken length 10 13 x445 variat 2 merg merg last iter least two old vector merg 14 x446 variat 1 skip updat odd iter updat even iter alg 5 alg 8 dispos old inform backup next iter step length greater one alg 13 alg 1 merg merg last iter least two old vector merg allow vari iter base choic kgk allow decreas 19 alg 13 alg 3 merg merg last iter least two old vector merg allow vari iter base choic kgxk allow decreas alg 13 alg 2 merg merg last iter least two old vector merg allow vari iter base choic kgk allow decreas alg 13 alg 2 merg merg last iter least two old vector merg allow vari iter base choic kgxk allow decreas tabl descript numer algorithm 4 comput k rather recomput u k updat matrix previou iter delet leftmost column topmost row append new column right new row bottom let ae 1s lower right submatrix u let upper lbfg variat 21 note alreadi comput 5 assembl alreadi comput compon 6 updat k use kgamma1 7 comput note 8 comput two intermedi valu 9 comput storag cost low order reconstruct h k need store diagon matrix mvector requir 2mn assum n much less storag n 2 storag requir typic implement bfg step oper count 9 tabl oper count comput h k g k step oper shown comput hg take omn oper assum n see tabl 43 much less 2 normal need comput hg whole matrix h store use lbfg basi comparison inform perform lbfg see liu noced 15 nash noced 19 442 vari iter algorithm 14 typic implement lbfg fix throughout iter updat accumul updat alway use consid possibl vari iter preserv finit termin convex quadrat use argument similar present 15 also prove algorithm linear rate converg convex function satisfi modest condit tri four differ variat theme base follow linear formula scale relat size kgk let k number iter save kth iter think maximum allow valu k let converg test given kg k kkx k k ffl formula k iter k ae log oe 22 gibson p oleari l nazareth alg tabl number failur algorithm 22 test problem algorithm said fail particular problem line search fail maximum allow number iter 3000 case exceed two choic ffi k choic whether allow k decreas well increas four variat 1 2 3 4 use four valu 51015 50 algorithm result summar tabl 44 48 extens result obtain 9 tabl 44 show algorithm roughli number failur lbfg tabl 45 compar algorithm lbfg term function evalu algorithm valu number time algorithm use fewer function evalu lbfg list rel total number admiss problem problem admiss least one two method solv observ three case algorithm use fewer function evalu lbfg half test problem tabl 46 compar algorithm lbfg term time entri similar tabl 45 observ algorithm 14 well term time well better lbfg nearli everi case problem algorithm comput ratio number function evalu algorithm number function evalu l bfg tabl 47 list mean ratio mean 10 impli algorithm better lbfg averag averag better algorithm 6 16 case first four algorithm observ howev mean close one lbfg variat 23 alg 5 5 1922 2022 2022 2122 7 822 1222 1022 1022 8 1222 1422 1222 1522 9 622 1322 1222 1622 13 322 422 422 422 14 221 222 222 221 19 222 322 422 422 tabl function evalu comparison first number entri number time algorithm well better normal lbfg term function evalu second number total number problem solv least one two method algorithm andor lbfg experi save term time first four algorithm algorithm tend save fewer vector lbfg sinc k typic less less work done comput h k g k algorithm tabl 48 give mean ratio time solv valu algorithm note ratio far one case variat particularli well problem 7 see 9 inform 443 dispos old inform algorithm 5 may decid store much old inform stop use exampl may choos throw away everyth except recent inform whenev take big step sinc old inform may relev new neighborhood use follow test last step length bigger 1 dispos old inform algorithm perform nearli lbfg substanti deviat one two problem valu seem evenli divid term better wors tabl 44 see algorithm success converg everi problem tabl 45 show almost alway well better lbfg term function evalu howev tabl 47 show differ minor term time observ algorithm gener faster lbfg tabl 46 consid mean ratio time tabl 48 differ minor method also particularli well problem 7 9 444 back updat h algorithm 611 discuss x22 alway use recent updat preserv quadrat termin regardless older valu use gibson p oleari l nazareth alg 5 1522 1322 1422 1522 7 1122 1122 1022 722 9 922 1022 722 822 13 522 1022 1322 1722 14 221 222 222 321 19 1122 1122 1722 1922 tabl time comparison first number entri number time algorithm well better normal lbfg term time second number total number problem solv least one two method algorithm andor lbfg use idea creat algorithm certain condit discard next recent valu h although still use recent vector vector save previou iter call back backup next recent valu algorithm use follow four test trigger back 1 current iter odd 2 current iter even 3 step length 10 use last iter 4 kg k k kg two addit algorithm vari situat 3 4 allow backup backup perform previou iter back strategi seem robust term failur 4 6 variat algorithm failur see tabl 44 inform interest observ back odd iter algorithm back even iter algorithm 7 caus differ result back odd iter seem almost effect number function evalu tabl 47 littl effect time tabl 48 howev back even iter caus much differ behavior lbfg wors lbfg problem better algorithm two variat idea back previou step length one wipe data previou iter use one updat show improv lbfg term function evalu fact two algorithm best function evalu ratio case tabl 47 unfortun algorithm compet lbfg term time tabl 48 littl differ lbfg variat 25 alg 5 6 1000 1000 1000 1000 9 1035 1371 1005 0947 14 7521 7917 8288 8502 19 1212 1959 1242 1387 tabl mean function evalu ratio algorithm compar lbfg problem either method fail use mean algorithm probabl rare mani step length one row algorithm 9 11 also two variat idea backup iter norm g k bigger norm g k1 larger differ result 9 11 8 10 term function evalu ratio tabl 47 algorithm 11 better indic may wise backup twice row poorli term time compar lbfg tabl 48 445 merg inform updat algorithm 12 13 yet anoth idea merg data take less storag comput time merg mean form linear combin variou vector vector would merg correspondingli corollari 25 show long recent use without merg old vector may replac linear combin old vector lbfg use idea follow way certain criteria met replac second third newest vector collect sum similarli vector use variou test determin would merg 1 neither two vector merg result merg second third recent step taken length 10 2 merg last iter least two old vector merg first variat algorithm 12 perform almost ident lbfg especi term time tabl 45 occasion wors term time tabl 46 observ also reflect result tabl 47 tabl 48 like vector merg second variat algorithm 13 make gain term time especi 26 gibson p oleari l nazareth alg 6 1007 0983 0977 0995 9 1032 1220 1043 1173 14 4585 3703 3228 2417 tabl mean time ratio algorithm compar lbfg problem either method fail use mean larger valu tabl 46 tabl 48 unfortun reflect save amount linear algebra requir number function evalu gener larger algorithm lbfg tabl 45 tabl 47 446 skip updat h algorithm 1416 everi updat h skip step length one alway chosen bfg termin 2n iter strictli convex quadrat function hold true exact line search see x3 unfortun neither properti hold limitedmemori case howev tri algorithm motiv idea idea everi often use current updat h instead use old h three variat theme 1 skip updat odd iter 2 skip updat even iter 3 skip updat kg k1k kg k k algorithm backup result skip odd even iter quit differ skip odd updat algorithm 14 extrem well everi valu two problem 1 12 otherwis badli skip even updat algorithm 15 perform somewhat better extrem well problem 7 problem 1 12 also better lbfg term time occas algorithm 14 tabl 46 neither well term function evalu mean ratio function evalu tabl 47 time tabl 48 usual far greater one skip updat norm g increas algorithm 16 well better term function evalu one problem valu tabl 45 rare better term time tabl 46 ratio bad function evalu tabl 47 time tabl 48 lbfg variat 27 447 combin method algorithm 1721 experiment combin method describ previou section algorithm 17 combin algorithm 5 8 dispos old inform backup next iter step length greater one essenti assum step region model quasinewton matrix take long step thu rid quasinewton matrix inform algorithm well term function evalu mean ratio less one three valu tabl 47 well term time algorithm 1921 combin merg vari algorithm well term time larger tabl 48 term function evalu tabl 47 5 conclus spectrum quasinewton method rang requir storag n theta n approxim hessian eg broyden fam ili requir storag vector eg conjug gradient limitedmemori quasinewton method fall extrem term perform storag method fall middl ground exampl conjug gradient method propos shanno 27 nazareth 20 truncatednewton method 24 6 partit quasinewton method 13 character limitedmemori quasinewton method fit gener form 21 properti produc conjug search direct convex quadrat shown limitedmemori bfg broyden famili member limitedmemori analog properti also consid updateskip someth may seem attract parallel environ show updat skip quadrat problem accept fullmemori broyden class member delay termin lose properti finit termin limit memori skip updat also introduc simpletoimpl modif standard limitedmemorybfg algorithm seem behav well practic problem appendix line search paramet tabl a1 give line search paramet use code note first iter initi steplength rather 10 variabl valu descript stp 10 step length tri first gamma4 valu 1 wolf condit gtol 09 valu 2 wolf condit rel width interv uncertainti maximum number function evalu tabl a1 line search paramet appendix b pseudocod b1 lbfg algorithm 0 pseudocod comput gammah k g k iter k lbfg given figur b2 updat h also handl implicitli comput 28 gibson p oleari l nazareth sze els need step 3 overwrit stg ytg fig b1 matlab pseudocod comput hg lbfg sze number vector avail updat iter oldsz number vector avail previou iter lbfg sze chosen minimum oldsz limitedmemori constant b2 vari iter algorithm 14 suppos k denot number pair use kth updat simpli chose sze minimum oldsz comput k b3 dispos old inform algorithm 5 dispos criterion met iter k set oldsz zero sze one comput k b4 back updat h algorithm 611 backup iter k set oldsz one less previou valu sze set sze minimum oldsz usual b5 merg inform updat algorithm 12 13 merg complic variat handl determin newest sze comput k execut pseudocod given figur b1 set oldsz one less previou valu sze set sze minimum oldsz usual assum iter k variat 29 newest valu yet ad execut choos new valu sze comput fig b2 matlab pseudocod merg variat fix valu compon use comput k b6 skip updat h algorithm 1416 skip updat iter k set sze oldsz comput stg ytg step 0 skip step 8 continu r ftpthale test function unconstrain minim perform multifront scheme partial separ optim numer method unconstrain optim nonlinear equat optim posit definit updat spars hessian matric httpwww matrix comput privat commun author partit variabl metric updat larg structur optim problem theoret experiment studi symmetr rank one updat limit memori bfg method larg scale optim linear nonlinear program numer studi limit memori bfg method truncatednewton method larg scale optim relationship bfg conjug gradient algorithm implic new algorithm updat quasinewton matric limit storag discret newton algorithm minim function mani variabl quadrat termin properti minim algorithm conjug gradient method inexact line search error specifi problem chnrosnb tr ctr sun linp updat selfscal symmetr rank one algorithm limit memori largescal unconstrain optim comput optim applic v27 n1 p2329 januari 2004 adi ditkowski gadi fibich nir gavish effici solut use a1 journal scientif comput v32 n1 p2944 juli 2007 albaali extraupd criterion limit memori bfg algorithm larg scale nonlinear optim journal complex v18 n2 p557572 june 2002