automat extract structur data busi report consider amount clean semistructur data intern avail compani form busi report howev busi report untap data mine data wareh queri relat form busi report regular structur reconstruct present algorithm automat infer regular structur underli busi report automat gener wrapper extract relat data b introduct consider amount clean semistructur data avail compani intern busi report creat period data process busi report provid data monitor account balanc inventori level transact statu current product statu etc although subject matter may dier wide mani busi report share similar structur busi employ stateoftheart techniqu captur report comput output laser disk cold 1 storag system access enterprisewid network cold system support queri base date titl freetext scan regularexpress match precomput index whose definit construct manual signific cost labor systemsadministrationmainten eort busi report integr part busi process error discov correct must made new version report must issu compar sourc inform busi report clean 2 clean data avail relat form could feed data warehous variou reason case import histor oper data avail cold system case even data avail legaci databas system fileprocess system varieti dierent data sourc middlewar access layer make dicult assembl integr inform organiza tion databas sinc organ busi report provid clean comprehens integr view underli data interest wrapper extract data could less expens sometim option give user finer granular access busi report allow precis queri busi report could automat decompos relat record would necessari compani mediat construct everi one data sourc automat decomposit would make possibl movement inform cold system relat databas data mine inform tool avail altern automat decomposit would support direct sql interfac cold system permit data mine queri directli cold archiv automat decomposit end user must develop ad hoc techniqu extract system may use storag technolog besid optic disk exampl tape raid use term cold denot kind report archiv system recent also term enterpris report breviti use cold use data wareh clean data free error redund suitabl store warehous inform busi report exampl may manual place data busi report spreadsheet receiv busi report electron may programmat transfer data databas applic access 1 use special tool awk 3 perl 25 cambio 8 infoxtract 6 15 monarch 19 diculti face ad hoc approach manual specif eort set process eort maintain process acquisit sucient program skill modifi process automat decomposit elimin reportdefinit specif inher manual programmat reportbas inform extract autom extract possibl narrow applic domain 12 13 14 howev techniqu narrow applic domain infeas larg report base ontolog would manual construct dierent busi report semiautomat techniqu wrapper also explor 2 5 11 16 22 techniqu take advantag special structur properti busi report project close relat nodos 2 attack gener problem extract structur kind semistructur document appli techniqu specif businessreport domain paper present system util lattic field descript automat identifi field fieldlevel descript system infer line type describ kind line found particular busi report infer factor page header footer yield linetyp sequenc whose regular structur infer use standard algorithm 17 18 system implement java store extract inform relat tabl accord line type linegroup structur remaind paper four section section 2 give highlevel system overview section 3 give detail descript key algorithm data structur section 4 give result report survey section 5 give conclus busi report field descript lattic extract field report structur definit report decomposit popul databas infer line type infer page header footer infer recurs group figur 1 busi report structur data extract process overview figur 1 outlin two phase busi report decomposit process 1 four step reportstructur infer 2 report decomposit input busi report r make five assumpt 1 r compos field aggreg line turn aggreg larger structur 2 r printabl ascii repres meaning humanread inform 3 3 r use ascii formfe charact ff page delimit ascii linefe charact lf line delimit 4 4 page number line r l width line w charact pad blank necessari 5 blank line blank field human readabl 3 use ascii ebcdic anoth charact set could use similar fashion case ebcdic easi translat ebcdic ascii format case nonenglish charact set nonu busi report dierent regular express would requir 4 diculti use crlf line delimit pc system 006 9994 10355 jason mason construct inc 10000000 06005 030799 ms ms total larg cd 160552979 figur 2 typic type report page figur 3 portion typic type ii report page observ two major categori busi report structur distinguish relationship line record structur kind busi report possibl page header possibl page footer report bodi consist repeat detail line type detail line column field belong distinct linetyp categori contain inform singl record contrast type ii detail line contain field pertain sever record type busi report contain type detail line type ii busi report contain type ii detail line may also contain type detail line figur 2 give exampl simpl type report 5 detail line figur 2 describ particular certif deposit figur 3 show portion type ii checkingaccount statement detail line figur 3 list two three clearedcheck item check number amount date clear correctli identifi basic line type exist within type report extract report structur contrast extract structur type ii report requir inform beyond line classif paper discuss type report type ii report subject separ paper process start type busi report r fielddescript lattic f 5 none data paper actual custom data pattern base actual busi report structur design us describ section 31 infer structur r store definit relat databas decompos r store decomposit databas content r queri paper focus four step reportstructur infer phase consist follow four step correspond algorithm 1 4 respect 1 line r decompos sequenc field 2 infer b set basic line type r line r assign basic line type b 3 infer page header footer r factor page structur rs line type descript 4 infer rs recurs line group system implement java 2 use oromatch 11 regularexpress librari 21 match extract substr line use mysql 20 databas manag system twz1jdbcformysql 23 jdbc interfac mysql sourc code avail web site 10 21 notat proceed introduc notat terminolog gener let r1 rr p 6 busi report r p page r l line ri denot ith page page sequenc line line sequenc w charact execut algorithm 1 also repres line sequenc field given line denot substr posit j k 1 tj k field f 4tupl j k substr f 6 alway denot order sequenc angl bracket also index 1base correspond j start posit f k end posit pattern index defin section 31 field line 1 2 respect say f 1 f 2 overlap q overlap overlap one five align valu share left right endpoint align agre field numer align decimalpoint posit lr agre align center agre align lr center align none appli field type f field f index least upper bound element fielddescript lattic f index 1 n f defin section 31 q 1 q n let q q pad j q j blank left blank right line type line 1 sequenc field type f j two properti 1 none field type may overlap 2 1 n order sequenc contain string correspond respect field line 1 two properti guarante reconstruct origin line line type group type r tripl b c either line type order sequenc group type b c respect minimum maximum number consecut occurr observ r 3 structur extract algorithm outlin section 2 four algorithm extract busi report structur section 31 34 describ algorithm 1 4 respect 31 field detect consid type report figur 2 first task decompos line field done appli algorithm 1 line r let f fielddescript lattic figur 4 indent figur 4 repres preced univers lower bound empti express shown explicitli element f class describ set ascii string typic found busi report julian class two immedi successor date number parenthes number figur 4 use section 321 ee sequenc regular express correspond field descript lattic figur 4 except univers upper bound univers lower bound ee last element sequenc e properti recogn sequenc contigu nonblank charact ee correspond class string case tabl 1 appendix show regular express e notic express ei e match string blank charact algorithm 1 extract field line accord e algorithm 1 extract field line input regularexpress sequenc e line output sequenc disjoint field compris rel e e ei match set j start first match let k largest k w ei recogn tj k record field 4tupl j k tj k replac charact tj k special nonascii symbol end sort field j begin field posit 1 string time 3 hour minut second 0 hour minut 0 date julian 0 day month year 0 month day year 0 year month day 0 month year 0 month day 0 day month 0 phone number 3 phone area code 0 phone without area code 0 id code 3 id begin letter 0 id end letter 0 id digit dash 0 number julian 0 percent 0 neg 0 gener number 0 fraction 0 currenc 0 currenc dollar sign 0 page number 0 field label 0 divid line 0 figur 4 fieldclassif lattic regularexpress match linear length text match accept exponenti space patholog case 4 inner loop run ow time sinc e express outer loop execut e time thu algorithm 1 execut oew time sinc ee last regular express alway recogn contigu nonblank charact algorithm 1 termin extract field step replac charact tj k special symbol forc field disjoint sinc tj k longer match express 32 basic linetyp infer algorithm 2 heart techniqu infer basic line type describ categori line busi report present algorithm defin three field linedist measur first introduc two dierent distanc field firstord distanc secondord distanc firstord distanc measur field distanc use characterlevel string comparison secondord distanc yield similar metric base field classif lattic tradit method character string similar edit distanc 24 describ cost transform one string comput edit distanc omn n length string compar simpl adequ firstord distanc comput omaxmn time measur field distanc use minimum first secondord distanc togeth align inform eg two field left justifi decimalalign base field distanc metric defin line distanc use algorithm 2 decid two line type belong cluster 321 field distanc let 1 2 nonempti ascii string without loss gener assum firstord distanc 1 2 string 1 k b kroneck delta function name 1 b 0 b field type recal 1 2 order sequenc string firstord field distanc f 1 f 2 string firstord distanc use trivial lattic charact ignor higherord structur associ field secondord distanc use regularexpress sequenc fielddescript lattic f describ section 31 e f three import properti 7 1 lattic pair element f uniqu least upper bound 2 cover everi ascii string member least one class f 3 consist let f f j class f let ei ej regular express e correspond f f j respect f preced f j languag recogn ei subset languag recogn ej defin function assign element f valu specif class lower valu gener class valu interv 0 1 shown parenthes figur 4 determin empir given properti defin secondord field distanc let f two field type class f correspond regular express ei 1 lub least upper bound f 1 f 2 without loss gener assum f secondord field distanc f 1 f 2 dierenc compon equat 3 return low valu field whose class rel close p term empir constant penal field whose least upper bound rel gener assign p valu 11 experi final ensur distanc stay interv 0 1 equat 3 use min1 express 7 properti requir care construct fielddescript lattic regularexpress se quenc formal prove hold purpos sucient simpli assum properti hold lattic f figur 4 class defin set ascii string consist properti guarante replac superior regular express disjunct regular express inferior given first secondord field distanc equat 1 3 defin field f 1 2 field distanc field type f sequenc field type line type 2 follow f 1 either overlap field type 2 overlap one field type 2 defin field f 1 2 1 oth erwis let f singl field type 2 overlap f 1 let equat 4 give definit field f 1 2 align valu overlap f 1 f 2 defin section 21 determin align valu empir choos 0 0 1 2 4 agre align lr center respect 322 line distanc number field type line type 1 let n 2 number field type line type 2 base field defin line 1 2 line distanc 1 2 n 1 n 2 0 valu line defin 0 either n 1 n 2 0 valu line defin 1 otherwis line defin accord equat 5 line 323 linetyp infer algorithm 2 infer b set basic line type report r input r algorithm 1 output b set basic line type r l map line r line type b make copi q r rij 1 creat new line type 1 rij duplic line type 2 q gener 2 cover 1 els add 1 q end reduc line type q b line type qi 1 q let smallest line qi qi line type b add qi b els gener cover qi end construct array l lij line type b cover line rij algorithm 2 termin og r p r l time g cost gener oper describ 3 threshold chosen empir line type 1 2 duplic associ fieldtyp sequenc ident field text ie number field type b correspond field type left right posit c correspond field type recogn regular express defin mean gener line type 2 cover line type 1 field type f number field type 1 overlap f 2 denot field type f three possibl noth f 2 2 least upper bound pad blank need 3 e pad string 2 blank need add 2 string 11 1m join filledpad blank need field type f 1 1 overlap field type 2 add f 1 2 modifi 2 field type 2 overlap combin describ step 3 33 page headerfoot infer type busi report may page header andor page footer page header report r sequenc line type appear begin page r linetyp sequenc 1 h page header r similarli page footer sequenc line type appear end page r assum page footer alway start oset top page distinguish report detail page header footer requir nonblank line type z follow properti page ri repeat ri two time immedi success appear twice singl page ri algorithm 3 infer page header footer line type input array l algorithm 2 output pagehead sequenc pagefoot sequenc z linetyp sequenc l z factor mark nonblank line type page headerfoot candid lij nonblank mark lij lij j k lj k l infer page header find largest h 0 h r l set first h line type page r1 may empti infer page footer find smallest f h f r l jlif f exist set z line type f r l page r1 otherwis let z empti sequenc set f r l 1 reduc l l remov page structur blank line l sequenc line type remov blank line type appear l note wherea l twodimension array l one dimens algorithm 3 termin l r p time 34 recurs group infer pagespecif structur busi report r factor focu infer structur rs detail section miclet techniqu 17 18 reason gener way infer regular structur set exampl string natur busi report simplifi assumpt allow possibl infer structur singl exampl algorithm 4 variant miclet techniqu use dierent decis heurist govern reduc recurs group restrict singl exampl string array l line type busi report creat reportwrit 8 built group form uv k w u possibl empti group header section v detail section repeat one time w possibl empti group footer section u v w section may compos uv k w structur make three assumpt uv k w structur linegroup type busi report r reduc algorithm 1 3 l 1 k 2 v appear consecut somewher l 2 group v appear k 2 time consecut l form v k compon uv k w structur predetermin upper bound k also uvw may appear l long uv k appear elsewher l 3 group u v w may appear individu outsid uv k w sequenc option line group real report structur uv k w u w alway appear togeth v k 9 give three exampl repres line type lowercas letter exampl 1 sequenc abccc line group group header empti group footer reason particular uv k w solut c busi report creat custom program also follow convent 9 assumpt hold type busi report leav report futur investig repeat line type exampl exampl 2 sequenc abccabcccc abcabc thu express describ structur report abc exampl 3 sequenc abccbccdabcd form repeat nest first creat inner group section c substitut sequenc aeeda let header detail section e k footer substitut sequenc ff group empti header footer detail section f k express describ report structur essenti algorithm 4 reduc regular express defin linetyp sequenc l compact regular express g describ recurs structur l algorithm 4 infer recurs linetyp group input basic linetyp sequenc b algorithm 2 linetyp sequenc l algorithm 3 output recurs linegroup structur let g set group type contain one entri line type b l g substitut line type correspond group type g g 1 chang true g find smallest j condit 1 2 3 hold condit 1 everi group type v uniqu condit 2 sequenc vv occur g condit 3 substitut new group type occurr g group type v still occur g exist creat new group type x whose definit sequenc v add x g substitut x g everywher v appear replac consecut occurr xx g singl x mark x minimum maximum consecutiveoccurr count end algorithm 4 leastfix point algorithm fix point upon converg regular express describ l g initi l loop execut l time sinc loop long chang made chang must alway reduc size g least 1 loop also execut l time verifi condit 1 2 3 substitut x v done time thu algorithm 4 execut ob practic algorithm 4 usual took one three pass converg run order magnitud faster worst case describ v k sequenc tend long five area use empir determin valu control busi report structur data extract process 1 regular express use recogn field 2 valu associ class fielddescript lattic f 3 valu align constant agre align lr center 4 threshold linetyp gener 5 penalti leastupperbound gener equat 3 use hundr report four dierent organ basi choic test process use 76 busi report separ organ use train phase 76 report 7 type addit 7 report short meaning ie compris singl page contain page header singl detail line 62 remain report process correctli extract structur data 40 report fail 22 22 failur point direct futur enhanc discuss four 1 e sequenc regular express match field sometim insuci give four exampl one case two field usual separ singl blank space number sign instead space one line caus two field recogn singl string turn caus creation extra line type interf recurs linetyp group infer algorithm 4 ii anoth case discov decimalalign numer field leftfil underscor furthermor underscor abut string field left eg one 552 two 93422 system recogn string portion togeth pad underscor singl field number second field overlap field system gener mani line type report iii anoth case discov currenc amount specifi 4 digit decim point rather common 2 digit due order express system broke field two caus mani line type gener iv final found string field two intern space eg xxxx xx string pattern expect one intern space caus field split extra line type gener problem correct tune e test set amount tune requir would small adjust e also requir nonu busi report 2 far common reason process fail problem option field line type field present line distanc formula toler option field howev often case line field also option field line mani field also often case sever field option option field may lead system gener mani line type tune threshold algorithm 2 particular report sometim fix problem gener solut 3 sever case gener two line type simplist structur algorithm 2 decid gener base threshold futur studi appli cluster techniqu recurs partit nearest neighbor 9 find better decis function control gener line type techniqu like gener across busi report dierent line type sensit order process line type 4 sometim uniform assumpt linetyp group hold algorithm 4 assum uv k w linetyp group u v k w alway appear togeth case line uv k w structur option case especi short line singl line type may reus two distinct uv k w structur algorithm 4 need revis accommod option line linetyp group conclus possibl automat extract structur data busi report process correctli extract structur data 40 62 type busi report test set seen initi number encourag much work remain done section 4 mention four area need improv 1 field recognit 2 detect option field 3 improv linetyp cluster techniqu 4 handl option line within linetyp group also plan studi structur data extract type ii report may possibl use segment techniqu like appli document imag optic charact recognit ocr algorithm eg 7 may also enabl accur extract field line may shed light improv techniqu type linetyp cluster current investig assum fixedwidth field pad blank need sinc report variablewidth field process need extend accommod report also assumpt field separ white space alway hold report design print form may line charact divid field futur work examin way determin field boundari absenc white space one weak approach number fix empir determin constant associ algorithm sure achiev better result use adapt techniqu dynam comput adjust constant whenev possibl fulli map structur data extract type ii report construct compress data structur contain full invert index inform busi report r togeth sucient inform reconstruct origin page r invert index often enough mere return data associ particular page regulatori constraint financi institut exampl may requir origin page return eg record may subject subpoena legal proceed case origin report page must print thu fulli invert data report must still abl retriev origin report page includ white space extens structur inform system gener constitut excel domainspecif model compress report businessreport structur data extract system implement java also implement graphic pattern editor tool assist creation debug regular express field extract tool avail web site patterneditor 10 10 gener applic regularexpress debug beyond current project r microsoft corpor access page awk program languag wrapper gener semistructur internet sourc mine mainfram report intellig data extract print stream background structur document imag data junction corpor home page iter cluster algorithm interpret imperfect line draw data extract group home page scalabl comparisonshop agent worldwid web conceptualmodel approach extract data web ia corpor home page wrapper induct inform ex traction regular infer tail cluster method structur method pattern recognit datawatch corpor home page url httpwww learn extract textbas inform worldwid web url httpwww string string correct problem program perl tr compil principl techniqu tool awk program languag program perl scalabl comparisonshop agent worldwid web wrapper gener semistructur internet sourc nodosemyampersandmdasha tool semiautomat extract structur semistructur data text document ontologybas extract structur inform datarich unstructur document stringtostr correct problem conceptualmodelbas data extract multiplerecord web page conceptualmodel approach extract data web