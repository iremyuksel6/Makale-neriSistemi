secur execut java applet use remot playground abstractmobil code present number threat machin execut introduc approach protect machin resourc hold mobil code describ system base approach protect host machin java 11 applet approach java applet download protect domain rerout dedic machin set machin playground execut prior execut applet transform use download user web browser graphic termin input output user illus applet run machin realiti howev mobil code run sanit environ playground user file mount limit network connect accept machin protect domain playground thu provid second level defens mobil code circumv languagebas defens paper present design implement playground java 11 applet discuss extens form mobil code includ java 12 b introduct advanc mobil code particularli java consider increas exposur network comput attack due push technolog often deliv code attack download execut program victim machin without victim knowledg consent attack code could conceiv delet modifi steal data victim machin otherwis abus resourc avail machin moreov mobil code sandbox intend constrain mobil code mani case proven unsatisfactori implement error enabl mobil code circumv sandbox secur mechan 1 9 one oldest idea secur comput oth erwis physic separ attack resourc valu paper present novel approach physic separ mobil code resourc basic idea execut mobil code somewher user machin resourc valu user avail abl forc mobil code interact user sanit environ cours could achiev run mobil code server serv therebi elimin mo biliti howev challeng achiev physic separ without elimin benefit deriv code mobil particular reduc load code server increas perform coloc code user order achiev protect organiz level propos design distinguish machin set machin playground mobil code serv protect domain execut mobil code push machin protect domain automat rerout execut domain play ground enabl user interact mobil code execut user comput act graphic termin mobil code display output receiv input ever point mobil code execut user machin provid valuabl resourc avail playground mobil code entir corrupt playground risk main resourc moreov playground place close network proxim machin domain serv perform degrad experienc user minim even mani playground serv domain balanc load among paper report design implement playground java 11 applet describ system rerout java applet retriev via web domain playground applet execut use user browser essenti io termin disallow playground mount protect file system open arbitrari network connect domain machinesin limit locat playground outsid main firewallth domain resourc protect even playground complet corrupt system larg transpar user applet develop configur requir chang web browser use today class applet amen execut present playground prototyp eg due perform requir code structur experi class small fraction java applet describ playground need trust system work secur inde trust code common configur system browser small graphic server java applet run browser graphic server implement interfac untrust applet run play ground call interact user graphic server simpli structur piec code thu amen analysi one configur system trust limit graphic server browser requir minor chang browser avail today constrain use today browser offtheshelf web proxi compon system describ section 3 must also trust rest paper structur follow section 2 relat work previou effort protect resourc hostil mobil code give overview system section 3 refin descript section 4 describ implement system detail secur system discuss section 5 limit discuss section 6 relat work three gener approach previous propos secur host mobil code first deploy larg scale java sandbox model model java applet execut restrict execut environ sandbox within user browser sandbox attempt prevent applet perform illeg action approach met mix success even small implement error enabl applet entir bypass secur restrict enforc sandbox 1 second gener approach execut mobil code trust base criteria ex ampl balfanz propos java filter allow user specifi server accept java applet see httpwwwcsprincetonedusip criterion applet trust server serv relat approach determin whether trust mobil code base author determin eg code digit sign author approach adopt secur microsoft activex content also support applet jdk 11 combin approach sandbox model implement jdk 12 3 4 netscap commun see 14 enforc access control applet base signatur possess properti third variat theme proofcarri code 11 mobil code accompani proof satisfi certain properti howev techniqu yet appli languag rich java java bytecod approach compat approach describ playground execut applet sandbox henc name playground could easili adapt execut trust applet base criteria approach provid orthogon defens hostil applet particular system hostil applet still physic separ valuabl resourc circumv defens third approach secur host mobil code simpli run mobil code coursegrain approach java simpli disabl java browser anoth approach filter applet firewal 10 see also 9 chapter 5 advantag allow applet serv behind firewal execut independ work system similar recent market digit inc californiabas compani descript system scientif liter atur infer sever differ system white paper 5 web site httpwwwdigitivitycom discuss compani repres first element digi tiviti systemnot protocol commun user browser analog playground java virtual machin jvm run playgroundar proprietari wherea system built use public widelyus protocol jvm may enabl digitiv iti easili tune system perform approach promot greater confid secur system expos maximum public scrutini understand second system requir trust certain element system accord 5 trust architectur discuss trust element architectur section 511 3 architectur core idea paper establish dedic machin set machin call playground mobil code transpar execut use user browser io termin section give overview playground support architectur implement java defer mani detail section 4 understand system work first necessari understand browser retriev load run java applet browser retriev web page written hypertext markup languag html take action base html tag page one tag applet tag might appear follow applet codehostileclass tag instruct browser retriev run applet name hostileclass server serv page browser applet return format call java bytecod suitabl run jvm bytecod subject bytecod verif process load browser jvm execut see eg 8 system browser request web page request sent proxi figur 1 step 1 proxi forward request end server step 2 receiv request page step 3 page receiv proxi pars identifi applet tag return page applet tag identifi proxi replac name applet name trust graphic server applet store local browser 1 proxi send modifi page back browser step 4 load graphic server applet upon receiv page applet tag proxi identifi proxi retriev name applet step 56 modifi bytecod use graphic server request browser input output proxi forward modifi applet playground step 7 execut use graphic server browser io termin step 8 summar three import compon architectur graphic server applet load user browser proxi playground none need execut machin inde benefit execut differ machin discuss section 5 graphic server playground implement java thu run java compliant environ proxi perl script proxi use multipl browser mul store local mean store directori name classpath environ variabl tipl playground case multipl playground proxi distribut load among playground improv perform follow subsect describ function compon detail secur issu discuss section 5 31 graphic server section give overview graphic server load user browser place applet provid web server graphic server java applet must introduc java terminolog describ java class collect data field function call method oper field object instanc class point time statei valu assign data fieldsthat manipul invok method object defin object class class arrang hierar chi subclass inherit field method superclass run java applet consist collect object whose method invok runtim system turn invok one anoth method inform java see eg 2 311 remot awt class abstract window toolkit awt standard api implement graphic user interfac gui java program awt contain class user input output devic includ button choic box text field imag varieti type window name virtual everi java applet interact user instanti awt class invok method object creat intuit goal graphic server provid version awt class whose instanc creat manipul playground exampl graphic server enabl program run playground creat dialog window user browser display user inform user click ok button parlanc distribut object technolog objecti one invok outsid virtual machin residesi call remot object class defin call remot class graphic server run user browser allow machin play ground creat use remot awt object user browser interact user accordingli graphic server implement collect remot class remot class one except describ section 312 remot version correspond awt class 7 modifi applet load graphic server chang 4 modifi page 1 request page 8 io chang io browser proxi 6 applet 3 page load applet web 5 request applet 2 request page playground figur 1 playground architectur modifi java applet run playground creat collect graphic object graphic server implement gui remot use stub interact see section 33 minim amount code graphic server remot class subclass correspond awt class enabl inherit mani method implement origin awt class method must overwritten exampl involv event monitor remot class method involv remot object event eg mous click remot button object must adapt pass back event stub resid playground jvm present implement remot class employ remot method invoc rmi commun playground rmi avail java 11 platform includ netscap commun internet explor 40 jdk 11 hotjava 10 312 remot applet class describ section 311 class compris graphic server remot version awt class main except remot version javaappletapplet applet class class java applet must subclass main purpos applet class provid standard interfac applet envi ronment thu remot version class serv provid interfac applet run playground environ must interact name user browser specif class implement two type method first provid remot interfac method applet class applet playground invok interact user environ second class defin new con structor method remot awt class see section 311 exampl constructbutton method construct remot button user browser constructor return refer newlycr button remot method button invok directli play ground similarli constructor method remot awt class initi start graphic server consist one object whose class remot applet class call browserserverclass applet playground invok method object object creat creat graphic user interfac desir user 32 proxi proxi serv browser playground interfac web retriev html page browser java bytecod playground transform format suitabl browser playground use retriev html page browser proxi pars return html identifi applet tag page replac refer remot applet class graphic server see section 312 thu browser receiv return html page load remot applet class store local instead applet origin referenc page retriev java bytecod file play ground proxi transform bytecod interact user browser machin run playground replac invoc awt method invoc correspond remot awt method browser precis invoc playgroundsid stub remot awt method turn call remot awt method involv pars incom bytecod make automat textual substitut chang name awt class name repres stub correspond remot awt class 33 playground playground machin load modifi applet proxi execut describ proxi modifi applet bytecod playgroundresid stub remot awt method call instead nonremot awt method modifi applet run playground skeleton gui contain stub correspond remot graphic object built playground stub contain code remot invok remot object method user browser handl event pass back browser exampl case dialog window ok button stub window button object instanti playground call method display window button pass remot object user browser button press event pass back method provid button stub handl event stub store local playground asid playground configur standard jvm playground central resourc care administ moreov invest playground eg upgrad hardwar perform enhanc monitor improv applet perform secur user protect main even multipl playground loadbalanc implement 41 exampl order understand compon describ section 3 work togeth section illustr execut simpl applet exampl describ applet automat transform interact browser remot graphic server playgroundsid stub interact applet execut section necessarili involv lowlevel detail casual reader skip ahead section 5 without much loss continu applet use illustr shown figur 2 simpl complet applet print word click wherev user click mous button purpos discuss implement two method care first init method invok regist ie applet object one receiv mous click event registr achiev via call addmouselisten method inherit applet superclass second method implement mouseclick method invok whenev mous click occur method call getgraph inherit applet obtain graphic object whose method call display graphic case method invok drawstr method graphic object draw string click mous click import javaapplet import javaawt import javaawtev public class click extend applet implement mouselisten public void init tell applet mouselisten object notifi mous event occur sinc implement mouselisten interfac method call method mouselisten interfac invok user click mous button public void mouseclickedmouseev e graphic gdrawstringclick egetx egeti unus method mouselisten interfac public void mousepressedmouseev e public void mousereleasedmouseev e public void mouseenteredmouseev e public void mouseexitedmouseev e figur 2 applet draw click wherev user click click applet standalon applet intend execut use remot graphic display input output thu proxi retriev bytecod applet applet must alter run playground one thing addmouselisten method invoc must somehow pass browser indic playground applet want receiv mous event mous click event must pass back playground mouseclick invok present implement pass inform achiev use java remot method invoc rmi associ remot class stub call execut call jvm stub invok exactli object invok marshal paramet pass across network remot object servic request stub describ interfac suffix xface exampl browserxfac interfac use call browserserv object graphic server rmi provid mechan invok method remot get click applet use rmi achiev exploit subclass inherit featur java interpos version method invok precis alter click applet subclass pgapplet rather standard applet class straightforward modif bytecod click applet chang click subclass way addmouselisten method call figur 2 one figur 3 pgapplet shown figur call necessari remot applet object graphic server describ section 312 addmouselisten method simpli add argument click applet array mous listen first regist regist mous listen graphic server registr graphic server handl addpgmouselisten remot method browserserv class remot applet object run browser see section 312 relev code browserserv shown figur 5 recal browserserv implement browserxfac interfac specifi remot method call playground addpgmouselisten method one remot method record fact playground applet want inform mous event regist object mous listen object mouseclick method invok mous click invoc pass mouseclick eventor precis refer browserev remot object hold refer actual mouseclick event object back pgmouseclick remot method pgapplet class pgmouseclick method invok mouseclick pgmouseev object 2 readabl figur 36 omit import statement error check except handl trycatch statement etc public class pgapplet extend applet implement pgappletxfac browserxfac bx mouselisten new mouselisten int add mouselisten first regist object graphic server mouselisten public synchron void addmouselistenermouselisten l mlindex 1 part pgappletxfac remot interfac invok browser graphic server mous click public void pgmouseclickedbrowsereventxfac e int pgmouseev new pgmouseevent return object encapsul remot graphic object browser applet public graphic getgraph return new pggraphicsbxgetbrowsergraph figur 3 part pgapplet class execut playground public class pggraphic extend graphic refer browsergraph remot object graphic server privat browsergraphicsxfac bg constructor object call superclass constructor save refer browsergraph remot object public pggraphicsbrowsergraphicsxfac b invok drawstr graphic server public void drawstringstr str int x int bgdrawstringstr x figur 4 part pggraphic class execut playground hold refer browserev object pgmouseev object translat invoc method eg getx geti figur invoc correspond browserev remot method turn translat invoc actual event object browser breviti browserev pgmouseev class shown call getgraph click also replac pgapplet version shown figur 3 getgraph method pgapplet retriev refer remot browsergraph ob ject via getbrowsergraph method figur 5 getgraph method pgapplet return browsergraph refer encapsul within pggraphic object call click invok drawstr argument pass browser execut figur 46 42 pass refer exampl previou section paramet need pass across network serializ object serial refer abil write complet state object output stream recreat object later time read serial state input stream 12 2 object serial central remot method invocationand thu commun graphic server playground stubsbecaus allow method paramet pass remot method return valu pass back exampl section 41 remot method invoc bgdrawstringstr x pggraphicsdrawstr method figur 4 caus difficulti str string x integ serializ howev class serializ exampl imag class repres display imag platformdepend way previou invoc bgdrawstringstr x suc ceed similar invoc bgdrawimageimg x fail img instanc imag serial sent graphic server even object could serial serial transmit larg complex object result substanti cost reason object pass paramet remot method graphic server gener construct graphic server origin correspond stub playground refer object browser pass graphic server routin place object way object refer ever pass network public class browserserv extend applet implement browserxfac mouselisten refer mouselisten object playground pgmouselistenerxfac ml part browserxfac remot interfac invok playground add remot mouselisten public void addpgmouselistenerpgmouselistenerxfac pml invok whenev mous click pass event mouselisten playground public void mouseclickedmouseev event mlpgmouseclickednew browsereventev return remot object encapsul graphic context applet public browsergraphicsxfac getbrowsergraph graphic return new browsergraphicsg figur 5 part browserserv class execut browser public class browsergraph extend graphic implement browsergraphicsxfac privat graphic constructor class call superclass constructor save pointer real graphic object pass export interfac callabl playground public browsergraphicsgraph gx part browsergraphicsxfac remot interfac invok playground draw string public void drawstringstr str int x int gdrawstringstr x figur part browsergraph class execut browser illustr manner pass object ref erenc continu exampl imag download applet call creation imag object eg via appletgetimag method interpos pgappletgetimag pass argument url string serializ remot imag creation method graphic server remot method construct imag place array object return array index occupi playground object pass index remot graphic server method place imag exampl browsergraph class graphic server implement version drawimag method accept imag indic display correspond imag convers circumst object need pass paramet remot method first creat browser due secur reasonseg object class userdefin class overwrit method awt classor class paramet object unknown eg known implement interfac circumst refer pass paramet place method invoc intend object pass back playground object process continu imag exampl callback occur download applet appli certain imag filter imag display one filter rgbimagefilt subclass rgbimagefilt defin perpixel transform appli imag overwrit filterrgb method avoid load untrust code browser filter must execut playground callback filterrgb method circumst need pass object refer consider hurt perform continu rgbimagefilt exampl filter imag may requir everi imag pixel pass browser playground transform filterrgb method pass back result consider delay render imag though experi delay reason imag whose pixel valu indic colormap array ie imag employ indexcolormodel 43 address previou section describ applet run playground coerc use user browser io termin io perform browser howev applet run playground graphic server run user browser must abl find commun complic fact html page contain number applet tag modifi proxi result multipl instanc graphic server run browser retain intend function page necessari correctli match applet run playground correspond instanc graphic server browser address scheme use requir proxi make addit chang html page contain applet refer prior forward browser specif page contain applet tag form applet codehostileclass proxi replac hostileclass browserserverclass describ section 3 also add paramet tag html page like applet codebrowserserverclass param namecontactaddress valueaddress paramet tag tag contain namevalu pair one assign address valu proxi gener uniqu valu contactaddress param tag appear applet tag termin applet shown use specifi paramet applet run case browserserverclass object ie remot applet object graphic server see section 312 look contactaddress field paramet obtain address assign proxi browserserv object initi prepar servic request playground bind remot refer address assign proxi bind store rmi name server 13 proxi rememb address assign applet tag provid address playground similar fashion proxi load applet playground send playground html page ident contactaddress param tag forward browser simplic step shown figur 3 jvm playground load referenc applet via proxi use correspond param tag provid look correspond graphic server rmi name server discuss previous secur goal system protect resourc protect domain hostil applet download user domain limit attent protect data user offer hostil applet protect data user offer hostil applet eg type applet interfac must achiev via protect concern though util playground avail abl 51 requir achiev strong protect domain privat resourc reli least follow two distinct requir 1 prevent jvm user browser load class network achiev untrust code never load browser unless browser machin local class file malici alter possibl consid later section describ disabl network class load mani class attack success mount jvm prevent system 2 prevent untrust applet run playground access valuabl resourc assum untrust applet might circumv languagebas protect playground requir met reli underli oper system protect play ground prefer isol playground valuabl user resourc describ altern meet requir playground system 511 prevent network class load prevent network class load browser achiev one two way system trust proxi one approach depend proxi rewrit incom applet tag html page point graphic server class store local browser intercept deni entri class file destin protect machin 10 rewrit applet tag ensur browser never direct incom page load anyth trust graphic server 3 playground pass unknown class 3 strictli true javascripten browser applet tag may dynam gener page graphic server eg paramet remot method call graphic server unabl load class class passag deni proxi approach work browser offtheshelf requir chang browser beyond specifi proxi browser http ssl proxi typic done use simpl prefer menu browser disadvantag howev proxi becom part trust comput base system reason proxi must written protect care refer approach trust proxi approach untrust proxi second approach prevent browser load class network directli disabl network class load browser main disadvantag approach requir either configur sourcecod chang browser protect domain particular popular browser today includ netscap commun internet explor 40 sourcecod chang seem requir achiev expect chang becom easier browser secur polici becom configur advantag approach exclud proxi trust comput base system henc call untrust proxi approach approach browser graphic server class trust comput base precis show approach prevent network class load browser describ caus class load network approach prevent 1 section 3 briefli describ process browser load applet specifi applet tag html page describ section 3 43 proxi modifi code attribut applet tag refer trust graphic server applet store local browser thu browser coerc alway load graphic server applet ap plet untrust proxi approach coercion serv mere function purposei run graphic server playground applet connectbut secur threaten proxi fail rewrit applet tag interpret browser possibl respons user action tag visibl proxi thu rewrit ten retriev applet must block proxi attempt trust proxi approach coercion central secur function 2 applet load start applet class loader browser load class referenc applet class core java librari store local applet class loader would normal retriev class network howev approach applet class loader need load local class graphic server applet refer local class 3 describ section 3 modifi applet playground invok remot method server present implement use rmi carri invoc rmi class loader load addit class pass paramet return valu rmi class loader first look local directori find class go network retriev possibl playground applet pass object whose class store local browser machin particularli playground corrupt trust proxi approach rmi class loader goe network via proxi retriev class class detect deni proxi untrust proxi ap proach rmi class loader return except immedi upon determin class avail local 512 isol untrust applet untrust applet divert play ground secur reli prevent applet access protect resourc first step playground jvm thu applet execut account differ actual user account permiss associ resourc eg user file avail playground achiev secur equival provid access control mechan playground oper system similarli jvm playground execut differ account reduc threat interjvm attack see section 53 complet compromis playground fear configur network may provid addit defens exampl network file server configur refus request playground machin request authenti cate af 6 even total corrupt playground immedi lead compromis user file similarli machin protect domain configur refus network connect playground except design port reserv browser graphic server listen compromis playground gain littl attack limit organ playground place outsid firewal therebi give applet greater access run server serv howev firewal disallow connect outsid firewal insid addit step may necessari commun proceed uninhibit graphic server browser applet playground particular rmi java 11 use proto open network connect browser playground direct ie browser playground vice versa one approach enabl connect across firewal multiplex singl connect graphic server playground ie insid outsid achiev graphic server playground applet interpos custom connect implement eg chang socketimplfactori technic reason appear possibl offth shelf browser eg appear work hotjava 10 netscap 30 anoth altern establish reserv port graphic server listen connect playground applet configur firewal admit connect playground port 52 rmi secur though requir discuss section 51 necessari secur system may suffici particular rmi rel new technolog could conceiv present new vulner abil first step toward secur rmi support authent encrypt transport network attack alter eavesdrop commun browser playground also achiev interpos encrypt object serial layer see 12 troubl threat possibl vulner object serial routin use marshal paramet return valu remot method invoc worst case corrupt playground could conceiv send stream byte unseri browser corrupt type system jvm browser decis gener pass primit data type eg integ string paramet remot method invoc see section 42 would seem fortu itou greatli limit number structur interest class attack dispos attempt attack howev possibl vulner yet rule sever research effort present examin rmi effort identifi correct problem process public scrutini one main advantag build system public wide use compon 53 resist known attack one way assess secur approach examin face known attack type section review sever class attack applet mount describ extent system defend access modifi protect resourc sever bug type safeti mechan java provid way applet bypass java sand box includ popular browser 1 9 penetr typic enabl applet perform oper oper system allow includ read write user file open network connect machin attack anticip forese futur type safeti error continu exist therefor must presum applet run playground may run unconstrain sandbox ever still confin playground oper system protect ultim attack resourc avail playground section 512 describ sever approach limit resourc avail applet play ground expect proper network oper system configur hostil applet effect isol protect resourc denial servic denial servic attack hostil applet might disabl significantli degrad access system resourc cpu disk network interact devic ladu 7 present sever applet eg consum cpu even user click away applet origin page monopol system lock pop window user screen endlessli use java playground applet effect protect domain affect playground machin howev applet pop window endlessli caus graphic server run user browser creat infinit stream window uncontrol may prevent access user termin altogeth requir user reboot machin otherwis shut browser one approach defend configur graphic server andor playground limit number rate window creation anoth type denial servic applet may deni servic applet within jvm eg kill other thread 7 although sandbox mechan browser intend separ applet differ web page one anoth sever way circumv separ shown 1 7 prevent system applet page run separ jvm playground separ user account henc unabl directli affect applet anoth page except attack playground violat privaci java secur polici browser gear toward maintain user privaci disallow load applet access local format case howev java applet reveal lot user whose browser execut exampl 7 ladu present applet use sendmail trick send mail user behalf sendmail daemon run applet server applet download onto unix host run standard ident servic mail identifi user ip address also user account name system applet run playground machin account user inform reveal limit avail playground 6 limit experi system transpar user applet howev class applet playground architectur transpar inde system may unabl execut certain applet particular remot interfac support graphic server support passag certain class paramet return valu remot method code run playground attempt pass object paramet whose class unknown subclass expect paramet class browser requir load subclass unseri paramet howev class load network prevent system see section 511 load complet except gener time write number applet support due limit seem signific inde yet encount applet problem second limit approach move applet away machin user browser execut applet io incur overhead commun network experi indic mani applet cost bare notic typic local area network link 10mbit ethernet howev applet whose output involv intens io oper eg lowlevel imag filter see section 42 overhead consider emerg function applet rais new challeng transpar execut playground exampl one envis text editor applet download network use compos document save disk applet inconsist sandbox polici implement netscap 3x internet explor 3x networkload applet allow write file howev may well possibl flexibl polici implement recent soontob releas version product eg 14 4 primari direct ongo work extend playground architectur support applet becom avail still offer protect data intend applet 7 conclus paper present novel approach protect host mobil code implement approach java applet idea behind approach execut mobil code sanit environ isol machin playground use user browser io termin gave detail account technolog allow transpar execut java applet separ graphic interfac user browser use system user enjoy applet download network expos isol environ playground machin untrust code although present playground approach technolog context java applet mobilecod platform may also util acknowledg grate drew dean ed felten li gong anonym refere help comment r java secur hotjava netscap beyond java nutshel java secur present near futur go beyond sandbox overview new secur architectur java tm develop kit 12 secur mobil code manag enabl java enterpris scale perform distribut file system push limit java secur java virtual machin specif java secur hostil ap plet block java applet firewal safe kernel extens without runtim check extens secur architectur java tr ctr f brazier b j overeind van steen n j e wijngaard agent factori gener migrat mobil agent heterogen environ proceed 2002 acm symposium appli comput march 1114 2002 madrid spain peng liu wanyu zang meng yu incentivebas model infer attack intent object strategi acm transact inform system secur tissec v8 n1 p78118 februari 2005 k g anagnostaki sidirogl p akritidi k xinidi e markato keromyti detect target attack use shadow honeypot proceed 14th confer usenix secur symposium p99 juli 31august 05 2005 baltimor md peng liu wanyu zang incentivebas model infer attack intent object strategi proceed 10th acm confer comput commun secur octob 2730 2003 washington dc usa alexand moshchuk tanya bragin damien devil steven gribbl henri levi spyproxi executionbas detect malici web content proceed 16th usenix secur symposium usenix secur symposium p116 august 0610 2007 boston pieter h hartel luc moreau formal safeti java java virtual machin java card acm comput survey csur v33 n4 p517558 decemb 2001