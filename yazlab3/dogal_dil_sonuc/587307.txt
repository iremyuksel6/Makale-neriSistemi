schur complement system mixedhybrid finit element approxim potenti fluid flow problem mixedhybrid finit element discret darci law continu equat describ potenti fluid flow problem porou media lead symmetr indefinit linear system pressur veloc vector compon method solut reduct three schur complement system base success block elimin consid first second schur complement matric form elimin veloc pressur variabl respect third schur complement matrix obtain elimin part lagrang multipli come hybrid mix method structur properti consecut schur complement matric term discret paramet studi detail base result comput complex direct solut method estim compar comput cost iter conjug gradient method appli schur complement system shown due special block structur spectral properti success schur complement matric deterior approach base block elimin subsequ iter solut well justifi theoret result illustr numer experi b introduct let bound domain r 3 lipschitz continu boundari potenti uid ow satur porou media describ veloc u use darci law continu equat incompress ow p piezometr potenti uid pressur symmetr uniformli posit denit second rank tensor hydraul resist medium repres densiti potenti sourc medium boundari condit given n outward normal vector dene almost everywher boundari assum domain polyhedron divid collect subdomain everi subdomain trilater prism vertic face gener nonparallel base see eg 11 14 15 denot discret domain e h assum uniform regular mesh discret paramet h denot also collect face element adjac work support grant agenc czech republ grant 20198p108 grant cr a2030706 revis version octob 1999 seminar appli mathemat swiss feder institut technolog eth zurich eth zentrum ch8092 zurich switzerland mirosammathethzch z institut comput scienc academi scienc czech republ pod vodarensk vez 2 182 07 pragu 8 czech republ maryskauivtcascz mirouivtcascz tumauivtcascz boundari introduc set interior face consid follow low order nite element approxim let space span linearli independ basi function v e dene element e 2 e h form orthonorm respect set function z 5 f e k denot kth face element e k3 outward normal vector respect face f e k veloc function u approxim vector function linear everi element e 2 e h raviart thoma space denot restrict function v h onto element e 2 e h denot space constant function element e 2 e h 0 e denot space constant function face f 2 h 0 f piezometr potenti p approxim space consist elementwis constant function h j e restrict function h onto element e lagrang multipli come hybrid method approxim space function constant everi face h h j f denot restrict function h onto face f 2 h analog introduc space 0 n space function constant everi face e2e h e h respect detail descript space use found 14 see also 11 15 raviartthoma approxim mixedhybrid formul problem 11 12 read follow see 4 find e 1 e p dh unh approxim function p un space function q approxim detail refer 14 11 denot number element number interior interel face number face prescrib neumann boundari condit discret j j let e number order set prismat element f k nnc order set nondirichlet face h everi element denot nif e number interior interel face nnc e number face neumann boundari condit impos element e let nitedimension space rt 0 span linearli independ basi function v na denit 16 let space 0 span ne linearli independ basi function nalli space 0 span nif linearli independ basi function k nnc raviartthoma approxim obtain system linear algebra equat formb c b unknown symmetr posit denit matrix block 2 r nana given term av outdiagon block b 2 r nane r block c 2 r nanifnnc n k outward normal vector respect face see 11 14 let us denot system matrix 112 symmetr matrix indenit due zero diagon block dimens nnc structur nonzero element matrix small model problem seen figur 1 partit submatrix c c 1 correspond interior interel face discret domain c 2 2 r nannc face condit incid matrix correspond element face neumann boundari condit note everi column c 1 contain two nonzero entri equal 1 singular valu c 1 equal 2 matrix block c 2 orthogon column moreov whole matrix block c also singular valu equal 2 1 matrix b special structur nonzero element correspond face element incid matrix valu equal 1 thu singular valu matrix equal 5 matrix b normal coecient orthogon easi see denit approxim space see 14 15 symmetr posit denit block 5 5 block diagon shown 15 fig 1 structur pattern matrix obtain mix hybrid nite element approxim model problem discuss section 5 spectrum matrix block satis posit constant independ discret paramet depend domain tensor also easi see system matrix 112 nonsingular block b c full column rank clearli condit hold boundari condit neumann condit matrix block b c singular due fact sum row element zero word function p uniqu constant function case assum follow analysi present 15 exist posit constant c 3 c 4 singular valu matrix block b c moreov eigenvalu whole symmetr indenit matrix follow asymptot posit constant independ system paramet paper solv symmetr indenit system 112 success reduct schur complement system propos consid three success schur complement system aris block elimin unknown correspond matrix block b c 2 respect word correspond elimin veloc variabl u pressur variabl p part lagrang multipli concept reduct rst second schur complement system well known static condens describ eg 4 section v 11 propos reduct third schur complement system seem new main contribut paper consist detail investig structur nonzero entri spectral properti schur complement trice enabl thorough complex analysi direct iter solut correspond schur complement system brief analysi structur rst schur complement matrix found 4 well straightforward observ princip lead block diagon extend analysi discuss mutual relat number nonzero entri rst schur complement matrix number nonzero system matrix 112 show llin occur process reduct second third schur complement system moreov prove number nonzero two schur complement alway less number nonzero 112 shown also spectral properti matric schur complement system deterior success elimin thu approach base block reduct subsequ iter solut well justi outlin paper follow section 2 examin structur pattern result schur complement matric give estim number nonzero element term discret paramet list section 3 devot solut whole indenit system 112 via three schur complement reduct subsequ direct solut use graph theoret result give asymptot bound comput complex choleski decomposit method appli third schur complement system section 4 concentr spectral properti schur complement system matric theoret converg rate iter conjug gradienttyp method term discret paramet estim asymptot bound comput work iter solut given section 5 contain numer experi illustr previous develop theoret result final give conclud remark mention open question futur work 2 structur properti schur complement matric section take closer look discret indenit system correspond schur complement extend brief analysi 4 sever possibl choic block order consecut elimin shall concentr block order seem natur ecient point view solv nal schur complement system direct solver conjug gradienttyp method order elimin rst two block use also 4 p 178181 11 note static condens way form success schur complement eg 17 case raviart thoma discret close relat nodal method studi reduct dierent second schur complement system discuss follow simpl result give number nonzero element triangular part matrix triangular part matrix mean upper lower strict triangl diagon deal structur nonzero element take account accident cancel possibl initi zero valu fig 2 structur pattern schur complement matrix aa figur 1 tensor hydraul permeabl structur matrix mean 0g lemma 21 number nonzero triangular part given proof triangular part 15ne nonzero block b contribut 5ne nonzero c 1 2nif nonzero c 2 contain nnc nonzero symmetr posit denit matrix block 112 blockdiagon 5 5 block correspond certain element discret domain therefor straightforward elimin veloc variabl u obtain rst schur complement system matrix aa b 11 12 13 structur matrix aa exampl problem shown figur 2 detail also refer 4 p 180181 11 number nonzero matrix aa show follow result lemma 22 number nonzero triangular part schur complement matrix aa equal proof clearli note llin 1 c 1 consider higher equal 10nif ja 13 number nonzero 23 equal final note observ direct graph matrix b c 1 set arc interior face ig undirect graph c adjac relat base connect interior face insid domain follow ef ef two element e h consid relat nif put partial sum togeth get desir result consid second schur complement matrix 22 23 structur aaa 11 exampl matrix shown figur 3 matrix block 11 rst schur complement matrix aa diagon 4 11 follow result show worth form schur complement matrix aaa 11 matrix aa sinc llin appear elimin block 11 correspond pressur variabl p reduc dimens system theorem 21 22 23 proof follow structur equival fig 3 structur pattern schur complement matrix aaa11 figur 1 previou theorem also easi see right lower block b 22 blockdiagon block vari size depend number face neumann condit element correspond certain element discret follow consid third schur complement matrix induc block b 22 matrix aaa 11 prove similar result one given theorem 21 therefor schur complement system matrix aaa 11 reduc schur complement matrix aaa 11 b 22 dimens equal nif without induc addit llin moreov done use incomplet factor procedur theorem 22 proof use theorem 21 get trivial singular case je h get desir result structb 11 follow simpl corollari give number nonzero element second third schur complement matric aaa 11 aaa 11 b 22 shall use result later corollari 21 number nonzero triangular part aaa 11 given number nonzero triangular part aaa 11 b 22 given apart explicit assembl schur complement matric use implicitli anoth possibl may consid keep schur complement factor form consid follow decomposit contrast previou case local number face correspond individu element play role case theorem 23 assum element within diagon block matrix nonzero llin face dirichlet boundari condit number rst local order nite element proof block structur consid individu nite element independ minimum valu nonzero count subsequ row correspond nite element 1p easili check minim case therefor assum within element rst number face correspond dirichlet boundari condit interior interel face nalli face neumann boundari condit matrix 219 written form clear advantag keep block 220 explicit form multipli factor directli typic exampl block b diagon matrix main question whether reduc system previou case time keep matrix block factor form unfortun one basic obstacl wherea abl emb structur structur 22 gener express factor form factor easili comput consid partial factor structur 220 sinc import comput point view use structur predict base factor exactli way obtain sparsiti structur explicit schur complement matric 22 ecient way implement use procedur similar one 16 get structur 3 direct solut schur complement system follow discuss direct solut schur complement system name concentr system matrix aaa 11 b 22 2 r nifnif follow theorem give bound asymptot work necessari solv linear system 112 domin decomposit matrix aaa 11 b 22 theorem 31 number arithmet oper solv symmetr ind nite system 112 directli via three consecut block elimin use choleski decomposit onif 2 proof give sketch proof work domin decomposit b 12 nonzero structur 22 uniform regular nite element mesh wellshap mesh suitabl sens see 19 proof lemma 22 statement theorem 21 22 impli graph g aaa 11 b 22 also graph wellshap mesh name boundeddegre subgraph overlap graph see 18 19 shown 25 upper bound secondsmallest eigenvalu laplacian matrix g fiedler valu order o1nif 23 use techniqu 25 obtain exist onif 23 size bisector g therefor g satis socal nif 23 separ theorem exist constant vertic g partit set ga gb vertex separ gc jga j jgb j nif jgc j nif 23 moreov subgraph g satis nif 23 separ theorem techniqu recurs partit g call gener nest dissect use reorder consid schur complement matrix provid elimin order onif 2 bound arithmet work choleski decomposit see theorem 6 12 note explicit comput matrix aaa 11 b 22 necessari framework direct method theorem 31 provid theoret result base spectral partit method reorder algorithm base separ obtain spectral partit techniqu appli recurs within nest dissect need necessarili best practic approach get reason matrix reorder nevertheless experiment result variou partit scheme show high qualiti reorder ecient comput way see 7 also reorder combin global procedur partit larg mesh local algorithm like mmd provid reason strategi nd llin minim permut 4 conjug gradient method appli schur complement sy tem section concentr iter solut schur complement system discuss section 3 consid conjug gradient method appli symmetr posit denit system matric aa aaa 11 22 well known converg rate conjug gradient method bound term condit number correspond schur complement matrix 9 6 26 show condit number matrix aa asymptot condit neg part spectrum whole indenit matrix moreov prove condit number matric grow like 1h 2 respect discret paramet h deterior success elimin base result estim number iter step necessari achiev prescrib toler error norm reduct show number iter step necessari reduc error norm factor grow asymptot like 1h three schur complement system therefor total number op iter algorithm signicantli reduc due decreas matrix order elimin first consid follow theorem theorem 41 let 1 eigenvalu posit denit block 2 r nana 1 singular valu matrix block b c 2 r nanbc eigenvalu schur complement moreov eigenvalu posit denit matrix block 22 23 22 23 condit number schur complement system matrix aa bound express 4 proof posit denit matrix 1 spectrum 0 1 1 1 1na rst inclus theorem follow follow two inequ 1 na b cx b cx similarli inequ 1 obtain second inclus third part proof complet analog second part corollari 41 exist posit constant c 9 c 10 spectrum schur complement matrix aa condit number matrix aa bound schur complement system posit denit matrix aa solv iter conjug gradient method 9 conjug residu method 6 well known conjug gradient method gener approxim solut minim energi norm error iter step 26 6 close relat conjug residu method dier denit innerproduct hand gener approxim solut minim residu norm everi iter 6 also well known fact exist socal peakplateau connect method 5 show signic dierenc converg rate method measur residu norm approxim solut paper use conjug gradient method togeth minim residu smooth procedur appli top get monoton residu norm 28 appli techniqu allow better monitor converg residu norm mathemat equival residu minim conjug residu method 6 comput cost techniqu minim cost two inner product one vector updat per iter framework iter method number oper matrixvector product usual import product perform repeatedli iter loop contribut substanti way nal ecienc iter solver solv system schur complement matrix aa number op per iter unprecondit method domin matrix vector multipl matrix aa number nonzero given lemma 22 moreov use estim 113 114 condit number schur complement matrix aa bound term 3 consequ number op conjug gradient necessari achiev reduct order assum overestim obtain asymptot estim order one 3 previou consider take account schur complement system matric aaa 11 aaa 11 b 22 converg rate iter conjug gradient method appli second third schur complement system depend analog condit number schur complement matric 9 6 26 analysi spectrum matrix aaa 11 given follow theorem theorem 42 let 1 eigenvalu posit denit block 2 r nana 1 singular valu matrix block b c 2 r nanbc spectrum schur complement matrix aaa 11 consequ condit number matrix aaa 11 bound follow proof denit schur complement matrix aaa 11 statement theorem 41 22 23 bound minim eigenvalu obtain consid follow result see 20 p201 11 12 13 interlac properti eigenvalu set symmetr matrix aa see eg 8 follow consid previou inequ get lower bound minim eigenvalu matrix aaa 11 complet proof shown condit number schur complement system matrix aaa 11 bound multipl condit number matrix aa therefor number iter step conjug gradient method necessari reduc error normor smooth residu norm factor asymptot complex matrixvector multipl lower accord corollari 21 order assum overestim nif obtain asymptot estim one total number op conjug gradient conjug residu method necessari achiev reduct factor order one 3 ne statement theorem 41 theorem 42 clear reduct schur complement system aect asymptot condit posit denit matric aa aaa 11 true spectral properti third schur complement system matrix aaa 11 b 22 sinc proof complet analog proof theorem 42 shall present follow statement cf 10 p 256 theorem 43 condit number aaa 11 b 22 bound condit number matrix aaa 11 follow present two addit result concern matrixvector multipl schur complement matric theorem 44 compar number nonzero schur complement matric aaa 11 aaa 11 b 22 number nonzero origin matrix theorem 44 number nonzero entri matrix aaa 11 matrix aaa 11 b 22 smaller number nonzero matrix proof use fact follow lemma 21 theorem 21 clearli number nonzero matrix aaa 11 b 22 even smaller note number nonzero origin matrix smaller larger correspond number nonzero matrix aa consid factor schur complement form 220 shown also clear winner number oatingpoint oper multipli dens vector number oper get product matrix aaa 11 b 22 dens vector appropri dimens respect result depend shape domain boundari condit never theless follow theorem 45 show form schur complement explicitli worth use factor form 219 reorder schur complement theorem 23 instead implicit form theorem 45 let v dens vector number oatingpoint oper comput smaller number oatingpoint oper computeb proof take account local order theorem 23 dierenc two quantiti bound 2nif nnc 0 5 numer experi follow present numer experi illustr result develop theoret part paper two model potenti ow problem 11 12 rectangular domain neumann condit prescrib bottom top domain consid dirichlet condit preserv nonsingular whole system matrix impos rest boundari choic boundari condit exampl motiv applic come model con aquif see 3 two imperm layer order verifi theoret result deriv previou section restrict attent rst simplest geometr shape cubic domain report result obtain uniformli regular mesh renement practic situat howev rel thin aquif possibl crack rock frequent model number neumann condit may repres big portion whole boundari second model exampl consid rectangular domain discret 6 layer model potenti uid ow problem cubic domain discret paramet matrix dimens h ne nif nnc aa aaa 11 aaa 11 b 22 15 250 525 100 2125 875 625 525 110 2000 4600 400 17000 7000 5000 4600 115 6750 15975 900 57375 23625 16875 15975 120 16000 38400 1600 136000 56000 40000 38400 130 54000 131400 3600 459000 189000 135000 131400 135 87750 209475 4900 728875 300125 214375 209475 140 128000 313600 6400 1088000 448000 320000 313600 tabl model potenti uid ow problem realist domain discret paramet matrix dimens 95x95x6 251560 36100 937460 395960 287660 251560 element mesh see later reduct third schur complement propos paper becom even signic cubic domain prismat discret domain ne element use 14 11 cubic domain discret paramet h ne nif nnc dimens n result indenit system matrix dimens correspond schur complement matric aa aaa 11 aaa 11 b 22 given tabl 1 cubic domain tabl 2 realist domain note dierenc dimens second third schur complement matrix signicantli larger case model thin layer aris regularli applic exampl cubic domain spectral properti matrix block b c well whole symmetr indenit matrix investig extrem posit neg eigenvalu matrix extrem singular valu block b c squar root extrem eigenvalu matrix approxim reduct symmetr tridiagon form matrix use 1500 step symmetr lanczo algorithm 8 subsequ spectral properti system matrix block problem cubic domain matrix block spectral properti eigenvalu matrix ne spectrum sing valu bjc neg part posit part 2000 033e2 02e1 0927e1 264 264 0898e1 0335e2 264 16000 066e2 04e1 0467e1 264 264 0413e1 0679e2 265 54000 099e2 06e1 0312e1 265 264 0241e1 0104e1 265 128000 013e1 08e1 0234e1 265 264 0152e1 0136e1 265 eigenvalu comput result tridiagon matrix use lapack doubl precis subroutin dsyev 1 extrem eigenvalu diagon matrix block comput directli lapack eigenvalu solver element element seen comput extrem eigenvalu block perfect agreement theori see tabl 3 similarli observ approxim linear decreas comput minim singular valu matrix block b c respect mesh discret paramet h comput extrem eigenvalu whole indenit system conclud even mesh size paramet h rather small give rise larg system dimens see tabl 1 outsid asymptot inclus set 115 inde exampl mesh size interv c 1 h c 4 c 2 h c 4 except use lemma 21 22 pp 34 see also 15 obtain inclus set form good agreement result tabl 3 use techniqu approxim extrem eigenvalu schur complement matric aa aaa 11 aaa 11 b 22 come problem cubic domain tabl 4 seen inclus set extrem eigenvalu rst schur complement matrix aa coincid bound given theorem 41 see extrem eigenvalu second schur complement matrix aaa 11 bound extrem eigenvalu matrix aa similarli extrem eigenvalu third schur complement matrix bound extrem eigenvalu matrix aaa 11 behaviour accord asymptot bound given theorem 42 theorem 43 smooth conjug gradient method appli result three schur complement system see also discuss previou section unprecondit also precondit version ic0 precondition 23 24 solut symmetr posit denit system use solut spectral properti schur complement matric problem cubic domain spectral properti schur complement matric 2000 0182e1 0173e4 0251e1 0596e3 0272e1 0596e3 54000 0693e1 0579e3 0966e1 0199e3 0992e1 0199e3 128000 0293e1 0434e3 0409e1 0149e3 0417e1 0149e3 whole indenit system minim residu method use precondit version posit denit blockdiagon precondit ilut020 decomposit block correspond constraint see eg 22 21 use choic ilut020 motiv eort obtain rather precis factor restrict memori requir close full decomposit block b c b c precondition found gener better denit blockdiagon precondit ilut020 decomposit indenit precondition discuss 13 21 initi approxim x 0 set zero rel residu norm krnk use stop criterion implement detail iter solver refer 6 experi perform sgi origin 200 processor r10000 tabl 5 tabl 6 consid iter count cpu time minim residu method unprecondi tionedprecondit appli whole system 112 conjug gradient method unpreconditionedprecondit appli schur complement system matric aa aaa 11 aaa 11 b 22 model problem cubic realist domain respect depend iter count present column tabl 5 correspond surprisingli well theoret order 3 ne converg behaviour smooth conjug gradient method appli third schur complement system matrix aaa 11 b 22 case present figur 4 result tabl 5 tabl 6 follow gain solut third schur complement system rather moder case cubic domain case realist domain becom signic 6 conclus success block schur complement reduct solut symmetr indenit system consid paper shown due particular structur matric aris mixedhybrid nite element discret potenti uid ow problem result schur complement matric remain spars moreov spectral properti deterior iter conjug gradient method success appli theoret bound number iter conjug gradient method problem cubic domain unpreconditionedprecondit cg appli matrix ne aa aaa 11 aaa 11 b 22 2000 60876 15435 8732 8032 643156 076025 030016 025014 48171191 386150 151092 130101 16000 1031138 28867 16463 15563 54000 1358188 41895 23493 22893 9269821878 104763692 39882404 37942313 128000 1637229 546122 303122 298122 tabl number iter conjug gradient method realist model exampl unpreconditionedprecondit cg appli matrix ne aa aaa 11 aaa 11 b 22 50700 2053336 810172 448166 421166 86700 2959403 1042222 578214 543214 132300 3420447 1272271 706262 663262 iter number rel residu norm unprecondit smooth conjug gradient method appli aaa 11 b 22 fig 4 converg smooth conjug gradient method appli third schur complement system converg rate method term discret paramet develop test model problem exampl numer experi indic given theoret bound eigenvalu set realist system matrix block also schur complement matric iter count conjug gradient method also good agreement theoret predict direct solut third schur complement system also possibl al tern nevertheless comparison iter solver outsid scope paper case structur grid geometr multigrid solver andor precondition solv nal schur complement system use name stencil rst schur complement express elementel connect domain see proof lemma 22 remain unchang subsequ two reduct appropri method could base anoth approach solut symmetr indenit system seem promis point 2 classic nullspac algorithm impl ment qr factor odiagon block b c consid solut indenit system transform solut block lower triangular sy tem subproblem correspond diagon block solv use factor iter conjug gradienttyp algorithm approach advantag perform matrixvector multipl q factor use elementari household transform although q factor may structur full elementari household vector may quit spars moreov roundo error analysi algorithm carri 7 acknowledg author would like thank michel benzi care read manuscript anonym refere mani use comment significantli improv present paper indebt jir muzak depart mathemat model diamo se straz pod ralskem provid us model numer exampl experiment part paper jorg liesen give us refer 20 work support grant agenc czech republ grant 20198p108 grant cr a2030706 r lapack user guid siam use qr factor spars quadrat program dynam fluid porou media mix hybrid finit element method relat galerkin normminim iter method solv linear system iter method larg geometr mesh partit implement exper iment matrix comput method conjug gradient solv linear system accuraci stabil numer algorithm gener nest dissect spars qr factor applic linear least squar problem approxim schur complement precondit lowestord nodal discret automat mesh partit geometr separ schur complement statist precondit iter method saddl point problem iter method spars linear system ilut dual threshold incomplet ilu factor spectral partit work planar graph parallel iter solut method linear system aris discret pde tr