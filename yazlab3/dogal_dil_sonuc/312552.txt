incomplet factor multigraph algorithm present new famili multigraph algorithm ilumg base upon incomplet spars matrix factor use particular order allow limit amount fillin much motiv multigraph come multigrid idea ilumg distinctli differ algebra multilevel method graph spars matrix recurs coarsen elimin vertic use graph model similar gaussian elimin incomplet factor obtain allow fillin gener vertex parent associ vertex multigraph numer compar algebra multigrid exampl aris discret partial differenti equat unstructur grid b introduct paper present new famili multigraph algo rithm ilumg base upon incomplet spars matrix factor use care design order allow limit amount fillin paper focu primarili system linear equat aris discret partial differenti equat method formal appli gener spars matri ce particular problem class problem seem like special method make use particular featur problem outperform multigraph algorithm howev goal ilumg algorithm provid gener robust iter solver mani differ system linear equat goal may yet achiev first version hope expect multigraph algorithm eventu provid reason good rate converg mani class problem requir minim input algebra approach multilevel method enjoy long histori begin algebra multigrid amg method brandt mccormick ruge 13 14 ruge stuben 26 black box multigrid method dendi 15 recent work found 1 3 4 12 20 19 17 well mani contribut 2 work grew grid coarsen scheme develop 10 11 correspond hierarch basi iter hbmg much motiv come multigrid idea ilumg fundament incomplet spars matrix factor multigraph method resembl approach classic spars gaussian elimi nation graph stiff matrix recurs coarsen first elimin node adjac edg ad partial set fillin edg correspond vertex parent node thu concept level import coars grid problem must solv exactli howev gener approach leav open possibl introduc level coars graph plan studi altern possibl way improv converg behavior basic method see 9 preliminari result direct size subsequ graph control monitor amount numer fillin produc sinc node elimin depart mathemat univers california san diego la jolla ca 92093 work author support nation scienc foundat contract dms9706090 bell laboratori lucent technolog murray hill nj 07974 base upon graph consider attempt made preserv integr grid inde inform even provid rest paper organ follow section 2 provid graph theoret interpret construct hierarch base relat spars incomplet factor connect multigrid multigraph describ term linear algebra section 3 section 4 implement method discuss detail particular order strategi incomplet factor procedur describ final section 5 compar multigraph amg exampl aris discret partial differenti equat unstructur grid 2 graph theoret aspect section discuss relat construct hierarch basi spars incomplet lu ilu factor within context graph theori first consid standard gaussian elimin classic ilu factor graph theoret point view develop graph elimin model hierarch basi method sequenc nest mesh model interpret special ilu decomposit gener case gener graph begin standard definit interest reader refer rose 25 georg liu 18 complet introduct correspond spars n theta n matrix symmetr sparsiti pattern ie ij 6 0 ji 6 0 let gv e graph consist set n order vertic set edg e edg connect vertic v j edg graph g correspond nonzero offdiagon entri stiff matrix space continu piecewis linear polynomi repres standard nodal basi graph g underli triangul domain minor modif due dirichlet boundari condit vertex v set adjac vertic adjv defin degre vertex degv size set adjv cliqu c v set vertic pairwis connect v proper order vertic cliqu correspond dens submatrix graph theoret term singl step gaussian elimin transform gv e new graph g 0 1 elimin vertex v incid edg g set g denot result set edg 2 creat set f fillin edg follow distinct pair v g add edg e jk f alreadi present e 1 set sinc valu matrix entri involv model take account occurr socal accident zero graph elimin process illustr figur 1 note set adjv g becom cliqu g 0 within framework classic ilu factor one fillin edg allow ie f j forc matrix 0 correspond new graph g 0 sparsiti structur correspond submatrix graph g 0 would correspond center pictur figur 1 concept vertex parent first introduc allow hbmg interpret gener ilu procedur begin case two nest mesh fine mesh uniform refin coars mesh gener pairwis phi phi phi phi phi phiomega omega omega omega omega omega omega omega phi phi phi fig 1 fine grid vertex v elimin classic gaussian elimin origin mesh shown left remov v incid edg middl add fillin edg right connect midpoint coars grid edg usual way 7 27 21 make direct sum decomposit c set coars grid vertic v f set fine grid vertic v c vertex uniqu pair vertex parent v c v midpoint edg connect v j v k v view hbmg ilu algorithm select fillin edg allow algorithm vertic set v f sequenti elimin follow 1 elimin vertex incid edg g set g denot result set edg 2 let v parent v creat set f fillin edg form e alreadi present e 1 set word classic hbmg algorithm add subset fillin edg gaussian elimin one vertic vertex parent even simpl possibl use one vertex parent elimin strategi although correspond classic case hbmg studi differ context partit scheme gener graph 23 24 elimin algorithm similar case two parent 1 elimin vertex incid edg g set g denot result set edg 2 let v j 2 adjv denot parent v creat set f fillin edg form e alreadi present e 1 set howev case gener fewer fillin edg ad initi graph g finit element triangul tetrahedr mesh three space dimens graph g 0 remain finit element triangul properti maintain step elimin process care select parent one two vertex parent elimin illustr figur 2 anoth straightforward extens allow possibl two vertex parent either fix variabl number limit case allow vertic adjv parent v result classic gaussian elimin extens interpret multigrid framework variou multipoint interpol scheme work consid one twovertex parent case let triangul f graph origin stiff matrix repres standard nodal basi either one two parent phiomega omega omega omega omega omega omega omega phi phi phi phi phi phiomega omega omega omega fig 2 fine grid vertex v elimin hbmg ilu elimin origin mesh shown left fillin pattern use two parent v 1 v 2 shown middl fillin pattern use singl parent v 1 shown right vertic v f elimin result graph coars grid triangul c howev numer valu matrix element gener differ two case special case sequenc uniformli refin mesh total number edg fill graph estim serv guid amount memori necessari store incomplet lu factor use typic spars matrix storag scheme eg 16 18 8 elimin process illustr case two parent figur 3 fig 3 hbmgilu classic case use two parent fine grid vertic elimin order v 1 v 2 v 3 total two fillin edg ad interior coars grid triangl elimin origin graph approxim 3n edg 2n triangl quartet four triangl gener two fillin edg part coars grid triangul thu total number edg coars grid approxim 4n repeat recurs coarser grid geometr sum 4n ae oe 16ni gener thu approxim 16n3 edg fill graph case classic hbmg method implement block iter fillin offdiagon block explicitli store number edg actual store spars data structur approxim shown 7 present studi consid point iter explicit storag edg elimin process case one parent shown figur 4 main differ case one parent one fillin edg associ quartet triangl fine grid thu total approxim edg coars grid expect approxim 7nae oe fig 4 hbmg ilu use one parent fine grid vertic elimin order v 1 v 3 eight gener scenario process result one fillin edg interior coars grid triangl total edg somewhat less case two parent also less bound 6n obtain gener match strategi twodimension triangul 23 fact match strategi appli gener graph produc fillin bound oje number edg origin graph know similar bound case two parent empir observ rapid growth fillin match strategi made littl effort control number fillin edg multigraph algorithm gener concept vertex parent arbitrari graph main problem determin reason vertex parent vertex elimin done eliminationunrefinementcoarsen perform graph exactli case nest mesh 3 multigraph algorithm salient featur multigraph algorithm connect hbmg illustr consid follow simpl exampl let n theta n spars matrix aris discret partial differenti equat assembl use standard nodal basi partit 1 6 0 diagon matrix element vertex v 1 r c vector order n gamma 1 theta n gamma 1 matrix hierarch basi multigrid method base chang basi nodal basi hierarch basi present context first step process involv form matrix 2 vector u spars nonzero determin vertex parent vertex classic hbmg v 1 vertex associ refin edg endpoint g case usual unit vector jth column ident matrix restrict interpol oper chosen geometr reflect fact one possibl gener choos vector u base incomplet factor matrix particular let v v j parent vertex v 1 scalar simpli multipli incomplet lu factoriza tion note equat well defin independ geometri mesh requir v 1 result refin edg e ij similar manner case one vertex parent sparsiti pattern vector c c sinc nonzero subset nonzero c 1 howev sparsiti pattern b gener matrix du typic creat fillin row column correspond vertex parent precis fillin edg illustr figur 2 also note ident see elimin step also view form rank one perturb exact schur complement standard formul next step hierarch decomposit transform form appli reduc matrix b cu l 1 au 1 actual chang hierarch basi defin implicitli recurs final hierarch base stiff matrix 0 far less spars gener better condit standard iter method effect appli linear system involv 0 case classic hbmg iter method standard block symmetr gaussseidel iter block defin term refin level mesh see 6 7 detail multigraph method ilumg replac gaussseidel iter incomplet factor particular set l unit lower triangular diagon u unit upper triangular e socal error matrix sparsiti pattern ldu defin term elimin algorithm describ section 2 precis sparsiti pattern recurs gener hierarch transform defin use standard ilu factor avoid recurs hbmg time hope allow addit fillin ilumg inherit desir properti hbmg precondition 1 speak gener term particular take account possibl occurr socal accident zero 4 implement multigraph algorithm divid four distinct phase analog classic spars gaussian elimin algorithm 1 order permut matrix p comput reorder matrix pap addit vertex parent elimin vertex defin determin fillin pattern second phase 2 symbol factor incomplet fillin comput use graph pap vertex parent output static data structur incomplet factor spars matrix 3 numer factor numer valu l u factor comput use milu factor 4 solut solut comput use conjug biconjug gradient algorithm precondit incomplet factor section divid two part first describ order strategi use comput p vertex parent vertex next milu factor discuss believ present algorithm two phase optim sens howev best one found far perform seem justifi work area 41 order case classic spars gaussian elimin order consist find permut matrix p reorder matrix pap desir properti term ensu factor normal permut matrix p construct base sole graph matrix eg minimum degre order 16 25 18 valu matrix element multigraph algorithm graph numer valu matrix use construct order vertex parent simplifi notat describ first vertex order parent select remain vertic order algorithm appli induct let fl given ae number fillin edg must ad v j 2 adjv chosen vertex parent v case one vertex parent qualiti function defin tent vertex parent vertex broken arbitrarili qualiti function q 1 v repres compromis choos parent v j strongli connect v possibl measur term size offdiagon matrix element choos v j caus littl fillin possibl term factor size paramet fl use indirectli control number fillin edg result order smaller valu fl result less fillin experiment determin good choic qualiti function q 2 v case two vertex parent develop similar fashion suppos v j qualiti ijk given ijk ae let g ijk denot number fillin edg requir fv chosen parent ijk set two parent algorithm actual offer possibl vertex zero one two parent choic parent base maxim function q 2 v singl parent case qualiti function q 2 v seek compromis choos strongli connect parent choos parent allow low fillin experiment determin two parent algorithm describ algorithm order vertic comput vertex par ent begin comput qualiti q p v vertex mesh use 5 case parent algorithm 7 case parent algorithm along qualiti function tent parent assign vertex case parent assign q p v vertic place heap vertex highest qualiti root vertex say v order first tent parent becom actual parent updat graph comput reduc matrix qualiti function heap posit vertic updat vertic set one potenti affect elimin v process continu induct vertic order usual case remain vertic q p v k case arbitrari order assign remain vertic summar algorithm 1 initi comput q p v tent parent vertic heap accord q p v 2 heap empti root vertex q p v order vertex v root heap updat heap tent parent v becom actual parent ii elimin v current graph add fillin edg requir updat partial factor matrix use milu decomposit iii updat posit v j heap note step ii essenti requir incomplet factor matrix occur concurr order sinc qualiti function q p updat base current state factor make order algorithm rather expens often expens even expens actual solut partli factor must use dynam data structur rather static spars matrix data structur employ els hand gener spars matrix calcul mani case order done use sever factor solut sever interest variat order algorithm merit discuss relat step iii provid mean partit matrix order formul block iter method first step iii artifici set q p v parent v forc v j vertic chosen actual parent resid near bottom heap heap contain vertic q remain vertic call coars graph vertic elimin fine graph vertic effect provid two level block fashion quit analog classic two level hbmg algorithm correctli reiniti q p v comput tent parent vertic remain heap restart elimin process led natur multilevel block could form basi block incomplet factor algorithm second step iii artifici set q p v fine graph elimin vertic form independ set diagon block origin factor matric correspond set vertic diagon reiniti restart elimin process would result multicolorlik order might interest applic vector parallel process either altern use enhanc qualiti function includ addit inform block strategi eg bia q p favor produc largest number vertic fine graph set within constraint seem appropri 42 numer factor implement milu factor defin follow let set actual comput incomplet factor matrix make priori shift one simpl way ensur exist stabil factor describ first step factor procedur let cd sparsiti pattern matrix gammacr gener coincid sparsiti pattern choos allow thu set gammacr requir sparsiti pattern e 1 error matrix first step induct continu factor b e cd u matrix gammacr decompos 1 e 1 procedur similar classic milu 22 suppos p q element c p r q allow fillin pattern consid matrix f pq zero except four element f pq set sum taken p q pair fall outsid allow fillin pat tern typic milu approach although averag diagon entri appear f pq nonsymmetr case bit unusu 5 numer result section present numer result first version multigraph algorithm compar one parent two parent version multigraph wellknown algebra multigrid code amg ruge stuben hempel suit six text problem construct use pltmg packag version 78 5 problem three nonuniform adapt grid gener test case spars matrix right hand side save file serv input iter solver 2 specif definit test problem describ problem superior problem simpl poisson equat homogen dirichlet boundari condit domain shape lake superior classic problem fairli complic domain solut shown figur 5 gener smooth boundari singular problem hole problem featur discontinu anisotrop coeffici domain consist three subregion inner region problem middl region equat outer region equat homogen dirichlet boundari condit impos inner hole bound ari homogen neumann condit outer boundari natur continu condit intern interfac solut shown figur 5 also rel smooth singular exist intern interfac file avail upon request problem texa indefinit helmholtz equat pose region shape like state texa homogen dirichlet boundari condit impos length scale domain roughli 16 theta 16 problem fairli indefinit illustr figur 6 problem ucsd simpl constant coeffici convectiondiffus equat gammar pose domain shape ucsd logo homogen dirichlet boundari condit impos seen figur 6 boundari layer form bottom region top obstacl problem jcn 0 jcn 180 next two problem solut current continu equat taken semiconductor devic model equat convectiondiffus equat form gammar domain seven subregion upper left larg lower region narrow curv band direct radial dirichlet boundari condit impos along bottom boundari along short segment upper left boundari respect homogen neumann boundari condit specifi elsewher solut see figur 7 vari exponenti across domain typic semiconductor problem first problem jcn 0 convect term chosen devic forward bias case sharp intern layer develop along top interfac boundari second problem jcn 180 sign convect term revers result two sharp intern layer along interfac boundari problem run sgi r10000 octan 256 mb memori compil fortran f77 64 option run consist two phase setup phase consist perform sever initi step multigraph al gorithm includ order symbol factor numer factor three step spars order far domin initi step amg consist determin multigrid level construct interpol oper well coars grid matric second phase problem solv rel accuraci residu 10 gamma6 start initi guess zero result comparison shown tabl 1 tabl 2 sinc littl variat time setup phase time second averag problem grid size tabl averag setup time vs problem size n amg one parent two parent fig 5 lake superior hole problem fig 6 indefinit boundari layer problem fig 7 semiconductor convectiondiffus problem tabl 2 present number amg cycl multigraph solv multigraph algorithm use precondition composit step conjug gradient cscg procedur symmetr problem composit step biconjug gradient csbcg procedur nonsymmetr problem count solv rather iter sinc composit step cost twice much singl step also solv nonsymmetr problem twice expens symmetr problem sinc must precondit digit column refer r k residu kth iter cycl compar method chosen cpu time measur second solv problem tabl perform comparison amg one parent two parent cycl digit time solv digit time solv digit time superior hole 26 63 729 texa ucsd jcn time one parent two parent version exhibit greater linear growth function problem size convent test problem uniform 5point grid observ log n depend significantli better ilu method contrast amg observ class problem howev problem consid studi algorithm competit amg acknowledg author wish thank steve mccormick help comment john ruge invalu assist run amg code r algebra multilevel iter method theori applic algebra multilevel precondit method class hybrid algebra multilevel precondit method pltmg softwar packag solv ellipt partial differenti equat hierarch basi multigrid method gener spars elimin requir perman integ storag hierarch basi multigrid method incomplet lu decomposi tion toward algebra multigrid ellipt problem second order black box multigrid algorithm data structur spars symmetr gaussian elimin algebra analysi hierarch basi precondition comput solut larg spars posit definit system interpol relat coarsen techniqu algebra multigrid method algebra hierarch basi precondition incomplet decomposit theori analysi multilevel graph partit graph theoret studi numer solut spars posit definit system multilevel split finit element space tr ctr p k jimack domain decomposit precondit parallel pde softwar engin comput technolog civilcomp press edinburgh uk 2002 michel benzi precondit techniqu larg linear system survey journal comput physic v182 n2 p418477 novemb 2002 randolph e bank compat coarsen multigraph algorithm advanc engin softwar v38 n5 p287294 may 2007