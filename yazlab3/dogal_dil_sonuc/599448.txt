perfect simul correl poisson random variabl condit posit paper present perfect simul method obtain perfect sampl collect correl poisson random variabl condit posit show use method produc perfect sampl boolean model condit cover set point ws kendal e thnne pattern recognit 329 15691586 1999 special case treat complic way method appli sever simpl exampl exact calcul made check correct program use khgr2test smallscal experi carri explor behaviour condit boolean model b introduct markov chain mont carlo mcmc provid opportun carri simulationbas statist infer allow one sampl approxim target distribut realis equilibrium markov chain approxim natur mcmc aris output subject initi bia recent work perfect simul 4 13 show favour circumst mcmc simul algorithm modifi replac approxim exact simul procedur particular coupl past cftp method due propp wilson 13 develop intens sinc discoveri 1994 exampl domin cftp variant cftp develop 8 permit perfect simul gener class point process see also 10 domin cftp import go beyond point process sinc allow applic cftp wide class nonuniformli ergod markov chain need monoton kendal thonn 11 use domin cftp carri perfect simul stochast ge ometri show get perfect sampl boolean model condit cover finit set point purpos paper explain get perfect sampl collect correl poisson random variabl condit posit briefli correl poisson random variabl aris sum basic set independ poisson random variabl follow kendal thonn 11 motiv applic obtain perfect sampl boolean model condit cover set point howev construct 11 involv condit boolean model view aris correl condit poisson random variabl lead simpler simul algorithm gener random variabl setup draw attent away geometri distract complex well interest stochast geomet wish investig condit boolean model result report add sequenc casestudi 6 7 8 11 10 aim develop cftp use challengeproblem stochast geometri particular challeng perfect simul condit boolean model result formul rather gener context cftp describ extend statespac cftp construct paper follow x2 introduc notion correl poisson random variabl describ mcmc method obtain approxim sampl condit correl poisson distribut specifi algorithm scheme obtain perfect sampl context extend statespac cftp common practic cftp algorithm base construct interleav sequenc upper lowersandwich process bound intermedi markov process actual requir equilibrium distri bution fundament properti cftp algorithm establish theorem 1 x3 name algorithm termin finit time output desir distribut x4 describ relationship condit boolean model collect correl poisson random variabl condit posit thu show use algorithm conduct cftp condit boolean model sever exampl describ x5 exampl deriv explicit condit distribut function correl poisson random variabl enabl us carri 2 test order check correct cftp algo rithm relationship intens germ process radiu typic grain number condit point coalesc time investig x6 final comment conclus present x7 correl poisson random variabl condit posit begin section introduc concept collect correl poisson random variabl describ mcmc method obtain approxim sampl collect individu random variabl condit posit final describ cftp modif allow us obtain perfect sampl desir distribut fix given index set assign rate nonempti subset consid collect independ poisson random variabl fya sg index subset ya mean defin collect correl poisson random variabl also defin set abbrevi describ x4 collect aris natur context boolean model stochast geometri index set replac finit set condit point yb count number grain cover exactli subset b condit point other x fx g count number grain cover condit point x context motiv problem oil industri lantuejoul 12 investig simul boolean model condit cover condit point question convert perfect simul discuss 11 lead directli question conduct perfect simul correl poisson random variabl condit posit 21 mcmc collect correl poisson random variabl condit posit carri mcmc fx replac random variabl immigr death process nonempti subset defin immigrationdeath process ya immigr rate unit death rate requir ya indepen dent detail balanc ya poisson equilibrium mean defin xa nonempti subset abbrevi equilibrium distribut fx collect correl poisson random variabl mcmc procedur straightforward simul ya process long time construct x use equat 1 cours use sledgehamm crack nut reason sampl directli ya equilibria howev mcmc approach easili modifi allow condit consid alon process xa immigrationdeath process immigr rate unit death rate moreov xa e xb mean immigr xa time immigr xb time death xb time death xa time possibl establish convers follow given collect immigrationdeath process fxa sg satisfi relat 2 coadapt sens ratecomput base condit common past independ immigrationdeath process ya immigr rate unit death rate construct equat 1 appli use mobiu formula 1 chapter 5 page 53 deduc aba consid modifi mcmc procedur produc correl poisson random variabl condit posit sinc underli markov chain revers done forbid transit lead one x becom zero way maintain coupl requir cftp method need prescrib replac death time potenti death time thu prevent becom actual accordingli introduc independ unitr poisson process za one nonempti subset defin immigrationdeath process e ya base immigr death structur ya forbid death would lead one target random variabl becom zero name death time ya death time ya accept e ya set e furthermor use next incid za new potenti death time e ya call perpetu e time interv perpetu interv perpetu time e ya summar e experi death exist e perpetu take place particular perpetu increas e ya 1 compar origin ya sinc use independ unit rate poisson process za provid perpetu time e ya inherit unit death rate ya subject censorship transit would lead x defin e aba e e detail balanc show equilibrium distribut e collect correl poisson random variabl condit posit pseudocod mcmcccp display tabl 1 give explicit descript deriv simul e x time interv b realiz time interv initi e repeat e ai2a e ya index next incid next incid immigr e next incid death e e els label next zaincid death incid return algorithm mcmcccp perform mcmc obtain approxim sampl condit correl poisson random variabl use uncondit immigrationdeath process fya g associ perpetu poisson process fza g tabl 1 mcmcccp algorithm 22 extend statespac cftp gener context domin cftp present 10 gener context paper requir modest extens extend statespac cftp describ gener context describ use get perfect sampl correl poisson random variabl condit posit aim obtain perfect sampl equilibrium distribut discret continu time markov chain take valu state space x difficulti markov chain r may uniformli ergod even relev partial order exist wish assum either monoton exist maxim minim element main idea overcom problem insert origin unord statespac x subset bigger order space e x upperlowersandwich process live e x eventu absorb x evolut stochast process e r chosen visit x follow stochast dynam r specif identifi sequenc major process e r ident distribut shift time live superset e x x satisfi follow condit 1 e x possess partial order relat 2 e x b b x base partial order space e 2 e r n eventu absorb subspac x fix u n 1 3 e r n evolv accord stochast dynam r hit x 4 n 0 e r e follow cftp result theorem 1 suppos markov chain r take valu state space x r n live partial order superset e x x satisfi condit 14 suppos rt converg weakli uniqu equilibrium distribut r n almost sure e equilibrium distribut proof follow equat 4 condit 2 1 almost sure equat 5 condit 4 n e r n 0 e consequ condit 1 e r n r 0 n accordingli e e r n 0 exist almost sure condit 3 fact e r n ident distribut time shift e r n 0 equilibrium distribut rn lim r n r start time 0 common hit distribut e r n x converg weakli therefor e r 0 distribut requir 2 follow subsect describ construct e r n order tripl process next section show condit 14 hold use e r n get perfect sampl desir distribut 23 cftp correl poisson random variabl condit posit need introduc notat order explain howw use extend statespac cftp produc perfect sampl correl poisson random variabl condit posit x follow ntupl nonneg integersg e ntupl nonneg integ v min v max ntupl length 2 k 1 index nonempti subset inequ v min v max interpret elementwis fact v v min v max contain entri 0 1 embed x e x given partial order e x given exactli interpret equal inequ elementwis order e correspond exactli inclus order order interv use setvalu cftp implicitli domin cftp earlier formul 6 7 8 appar partial order embed x e 1 preced theorem 1 describ use uncondit immigrationdeath process nonempti assum statist equilibrium perpetu incid process za nonempti construct realiz e r n time interv n 0 note use timerevers ya extend trajectori far back past may requir fix valu time 0 sampl uncondit poisson equilibrium process extens za even easier e r n ya uncondit immigrationdeath process assign subset v nmin v nmax process defin togeth recurs follow way initi time n set nonempti updat process occur death time correspond process perpetu time correspond z process conveni notat defin e e suppos ya experi death time respect may set equal 1 danger caus zero opposit process e respect e mindeath e ya death would zero upper process e set lower compon maxdeath e ya death would zero lower process e set upper compon hand suppos za experi perpetu incid time set v nmin respect v nmax equal 0 danger caus zero opposit process e respect e minperpetu e danger zero upper process e set lower compon maxperpetu need consid follow two case 1 case e set upper compon v nmax 1 case e 1 2 set upper compon v nmax remain establish condit 14 requir theorem 1 shall next section first give brief descript cftp algo rithm begin test whether e r n 0 lie x say whether 0 nonempti vector common valu x nmin return sampl correspond vector correl poisson random variabl condit posit exist v nmin 0 6 v nmax 0 must choos new start time n repeat simul replac n suggest 13 case sensibl choic doubl n note must insist extend backward way reus previou realiz note revers aris detail balanc technic assist proceed extend backward time minim maxim process coalesc return common valu coalesc process time 0 tabl 2 give pseudocod summar result algorithm cftpccp 3 properti cftp algorithm prove cftp algorithm cftpccp inde provid us perfect sampl desir distribut must establish sequenc lemma relat condit 14 extend z n 0 e r n e 0 return els cftpccp algorithm perform extend statespac cftp obtain exact sampl condit correl poisson random variabl tabl 2 cftpccp algorithm first must make sure condit 1 appli say process e r n genuin stay statespac e x defin v nmax 8 nonempti n 0 particular statespac e r n taken e x first note construct equat 8 must hold time n suppos equat 8 hold possibl includ time therefor e 2 suffic consid either ya experi death time za deliv perpetu incid case death relationship 9 crossov mindeath maxdeath assur us v nmin set 1 v nmax equat 8 must also hold time case perpetu incid entir similar perpetu happen upper lower process v nmax set 0 v nmin equat 8 must also hold time perpetu happen upper process alreadi v nmin hold matter valu result follow induct 2 set asid condit 2 moment turn condit 3 persist 0 time interv coupl process evolv copi e proof simpli matter observ v nmin v nmax coincid time e longer distinct min max condit mindeath maxdeath death min perpetu maxperpetu perpetu note case perpetu upper process happen birth decis alreadi ident consequ time onward death perpetu decis v nmin v nmax must continu coincid furthermor effect death perpetu decis v nmin v nmax agre prescript evolut e descript mcmcccp algorithm tabl 1 2 consid condit 4 follow establish follow fun nell result lemma 3 n 0 nonempti v nmin v nmax v mmax proof initi valu v mmin v mmax respect minim maxim funnel certainli hold time consid therefor incid time suppos funnel relationship hold time carri relationship e incid immigr v mmin v mmax v nmin v nmax affect relationship persist incid death examin mindeath show v mmin set 1 v nmin set 1 sinc e similar argument use maxdeath appli show v nmax set 1 v mmax set 1 incid perpetu upper lower process similar argument concern minperpetu maxperpetu show v nmin set 0 v mmin set 0 v mmax set 0 v nmax set 0 consid case incid perpetu upper process case follow lemma 1 v nmin v nmax need prove v mmax 2 e accord maxperpetu set 0 v mmax hold e set v mmax e 2 two case consid case sinc v mmin actual know e henc also e follow maxperpetu minperpetu condit case either v nmax e follow maxperpetu v nmax automat sinc perpetu time death time case 10 hold mean funnel relationship persist time maintain time result follow induct along sequenc incid final turn condit 2 consequ follow lemma lemma 4 suffici larg n process v nmin v nmax coalesc time interv n 0 proof lemma follow time upper process v nmax vanish construct follow coalesc occur time fix 0 0 experi immigr time interv increas event base independ event form ya immigr fkg inequ 5 theorem 24 appli consequ hand 0 p follow altern line reason construct estim base ya experienc immigr thu dispens fkg inequ suppos time event occur let famili subset ya experi least one immigr occur union must cover moreov clearli 2 k 1 member 2 k 1 perpetu valu among v max coalesc v min v max occur yield perpetu val ue poisson process za experi incid time interv t2 also ya hit zero time interv sinc v max zero simpl stochast comparison use strong markov properti represent immigrationdeath process term poisson input exponenti death time show happen condit probabl condi tion let c event occur togeth event whose probabl given equat 11 howev c actual independ event past time may therefor appli second borelcantelli lemma show almost sure infinit mani c 2r occur follow coalesc almost sure happenth follow result immedi consequ lemma theorem 1 exist uniqu limit equilibrium process e x x2 theorem 2 algorithm describ x2 almost sure termin finit time moreov output algorithm distribut correspond array correl poisson random variabl condit posit work show cftp algorithm inde produc perfect sampl correspond collect correl poisson random variabl condit posit 4 applic simul condit boolean model section show cftp algorithm use obtain perfect sampl condit boolean model 41 relationship condit boolean model correl poisson random variabl condit posit recal section 2 introduc distribut correl poisson random variabl show could obtain equilibrium distribut process x 1 ai2a ya independ immigrationdeath process ya consid boolean model equilibrium distribut spatial immigrationdeath process appropri assign condit point rate process xb interpret time evolv number germgrain pair whose grain cover condit point b process ya describ number germgrain pair whose grain cover condit point condit point exampl count number germgrain pair whose grain cover condit point x 1 divid process xb count number germgrain pair whose grain cover x 1 x 2 fx1 x2 g count number germ grain pair whose grain cover x 1 x 2 convert boolean model poisson process space mark use grain space germ lead grain cover x 1 divid two disjoint subregion fx1g count number germ fall one subregion fx1 x2 g count thu number germgrain pair subregion associ immigr death process ya independ immigrationdeath process condit appli mean forbid certain transit note process ya might zero immigr rate condit boolean model correspond set condit point simultan cover singl germgrain pair case grain disk constant radiu least two point separ distanc greater 2r r radiu typic grain seen use perfect sampl condit correl poisson random variabl produc perfect sampl condit boolean model 42 perfect simul condit boolean model sake simplic consid case disk constant radiu though method extend cover case typic grain random bound diamet perfect simul follow one establish simul sort incid time ya za essenc one simul stream candid incid time timevari intens incid time choos whether ztype type incid use appropri probabl timevari rate underli stream candid incid taken ya n total number process za 6 0 assign type made deliv correspond rate ztype incid one assign type indic variou za process incid belong uniformli random type death incid one assign type indic variou ya process incid belong randomli weight size correspond ya type birth inci dent one choos locat uniformli random bound window w assign incid ya locat fall region x g ga 12 g typic grain sinc correspond disk cover exactli condit point constitut index set birth incid discard locat fall region perfect simul conduct accord algorithm cftpccp given tabl 2 conclus algorithm perfectli sampl condit boolean model built use locat surviv birth incid supplement sampl uncondit boolean model region construct cover condit point done easili thin uncondit boolean model full region w follow consid plot condit boolean model obtain perfect simul method clearli given configur condit point radiu typic grain result affect valu intens give plot simul use vari pattern condit point random pattern obliqu lattic squar lattic medium high intens underli poisson germ process low intens less germ per unit area closelyspac condit point grain cover one condit point algorithm fail coalesc within memori constraint comput sun ultra 1 64 mbyte ram maximum minimum process take long time come agreement sinc initi perpetu maximum grain disappear minimum grain cover condit point rare event moreov perpetu minimum grain tend disappear quickli back zero sinc condit point typic cover sever perpetu maximum grain plot base intens germ per unit area gener featur display case mani extra grain induc requir cover condit point high intens result figur differ less uncondit case sinc much window cover anyway still excess grain cover condit point case comput number grain cover condit point excess number expect compar simul uncondit boolean model excess much larger case random pattern condit point reason sinc randomli scatter pattern affect much greater area window excess appear depend strongli underli germ intens come surpris excess gener algorithm mere sum perpetu grain notat section 2 sinc va 0 1 scope variat total excess limit note figur condit point mark 2020611418perfect sampl condit boolean model place randomli window w width unit intens underli germ process radiu typic grain simul yield grain 103 cover least one condit point uncondit model would yield poisson number grain mean number 120 would expect 4741 cover least one point excess number grain condit boolean model cover condit point 5559 figur 1 condit boolean model random pattern place randomli window w width unit intens underli germ process radiu typic grain simul yield grain 131 cover least one condit point uncondit model would yield poisson number grain mean number 180 would expect 7111 cover least one point excess number grain condit boolean model cover condit point 5989 figur 2 condit boolean model random pattern point place lattic base parallelogram horizont side length 219 height 219 angl 6343 window w width unit intens underli germ process radiu typic grain simul yield grain 71 cover least one condit point uncondit model would yield poisson number grain mean number 120 would expect 4741 cover least one point excess number grain condit boolean model cover condit point 2359 figur 3 condit boolean model parallelogram grid point place lattic base parallelogram horizont side length 219 height 219 angl 6343 window w width unit intens underli germ process radiu typic grain simul yield grain 97 cover least one condit point uncondit model would yield poisson number grain mean number 180 would expect 7111 cover least one point excess number grain condit boolean model cover condit point 2589 figur 4 condit boolean model parallelogram grid point place squar lattic side length 219 window w width unit intens underli germ process radiu typic grain simul yield grain 74 cover least one condit point uncondit model would yield poisson number grain mean number 120 would expect 4741 cover least one point excess number grain condit boolean model cover condit point 2659 figur 5 condit boolean model squar grid 2020611418perfect sampl condit boolean model point place squar lattic side length 219 window w width unit intens underli germ process radiu typic grain simul yield grain 98 cover least one condit point uncondit model would yield poisson number grain mean number 180 would expect 7111 cover least one point excess number grain condit boolean model cover condit point 2689 figur condit boolean model squar grid 5 check correct implement simul method alway check care protect mistak code well confirm theori section summar sever simpl exampl provid check correct method program implement c simul time interv initi 2 0 case though cours algorithm extend back time requir window w unit squar g set disk radiu r intens germ process check correct case collect 10000 sampl carri 2 test use appropri group follow report summar result full detail implement result deriv exact equilibrium distribut function exampl found associ research report 3 avail preprint 350 httpwwwwarwickacukstatsdeptstaffwskppthtml 1 singl condit point 5 result 2 5 valu 4804 2 two separ condit point 5 result 2 8 valu 9368 3 two close condit point 5 result 2 valu 12344 4 three close condit point 3fold symmetri g place three point configur 3fold symmetri 8 result 2 26 valu 19993 none 2 valu signific 6 investig algorithm perform section carri experi explor way runtim perfect simul algorithm depend variou paramet follow analysi section 42 uncondit process ya spatial immigrationdeath process constant immigr rate unit death rate ea ea given equat 12 recal k number condit point r radiu typic grain section investig depend c r k note throughout section use actual coalesc time c time produc doubl perform algorithm cftpccp experi 1 depend coalesc time grain radiu hold fix intens germ process number condit point investig relat coalesc time c radiu r typic grain place set condit point vertic squar sidelength 02 unitwidth window w obtain independ sampl size 200 99 equal space valu r rang 001 05 figur 7 plot logsampl mean coalesc time versu r dot line includ two theoret deriv asymptot curv solid line small ra diu horizont solid line larg radiu discontinu sampl curv signal effect possibl singl grain cover sever condit point theoret asymptot deriv follow first consid case grain small one grain cover one condit point r 01 relev ya k process fig singleton independ coalesc occur exactli fig experienc death time perpetu v max fig individu fig first event occur approxim first instanc poisson process rate r 2 independ thin delet probabl use approxim thin process also poisson process rate r 2 2 therefor altern extrem larg r r 01 condit point like cover one disk uncondit boolean model coverag probabl one condit point time zero coverag event posit correl accordingli coalesc time c approxim maximum first perpetu time n ya process depend grain radiu r deduc follow theoret asymptot mean coalesc time small r larg r radiu logmean coalesc time 226 figur 7 graph logsampl mean c versu grain radiu r fix condit point valu 20 reason big jump 01 follow 01 possibl one grain cover one condit point jump show cost pay consequ interact e process experi 2 depend coalesc time intens hold fix radiu typic grain number condit point investig relat coalesc time c intens germ process place set vertic squar sidelength 02 unitwidth window w obtain independ sampl size 200 75 equal space valu rang 2 150 figur 8 plot logsampl mean coalesc time versu dot line includ two theoret deriv asymptot solid line theoret asymptot deriv essenti experi 1 follow first consid case larg condit point like cover singl disk uncondit boolean model argument experi 1 coalesc time c also approxim maximum n first perpetu time ya process henc mean approxim asymptot 16 independ valu hand small valu coalesc time c depend valu r experi take r 008 follow argument experi 1 larg distribut c approxim given asymptot 13 henc approxim theoret mean given 15 view function intens logmean coalesc time figur 8 graph logsampl mean c versu intens fix condit point radiu grain experi 3 depend coalesc time number condit point hold fix intens germ process radiu r typic grain investig relat coalesc time c number condit point unitwidth window w k small like singl grain cover one condit point long r larg therefor small k distribut c also approxim equat 13 henc mean given asymptot 15 view function k hand k larg disk uncondit boolean model like cover least one condit point distribut c case approxim equat 14 n number ya process 6 0 henc mean given asymptot 16 view function k illustr relat c k r small experi design follow take condit point vertic rectangl unitwidth window w rectangular width 111 length 16 obtain independ sampl size 200 k set grain cover one condit point therefor case would expect sampl mean versu k agre approxim theoret mean curv given asymptot 15 confirm plot sampl mean dot line two asymptot theoret mean versu number condit point k figur 9 mean coalesc time figur 9 graph sampl mean c versu k fix valu grain experi 4 depend actual durat algorithm intens final investig relat actual durat wallclock time algorithm r k experi record 200 independ actual durat time collect one sampl valu r k plot averag durat time 95 confid limit mean versu r k respect follow figur first consid durat time experi 1 theoret argument suggest mean durat time convex function grain radiu r tend infin r 0 posit constant r 1 simul support conclus also show signific featur depend occur rel small rang r figur plot logsampl mean 200 realiz 95 confid limit mean rang r 2 001 05 see two peak correspond two valu 0145 correspond follow observ r increas possibl one grain cover 2 condit point r increas becom possibl one grain cover 4 condit point consid depend mean durat time intens experi 2 gain similar theoret pictur except larg intens mean durat time increas minimum sinc algorithm need time deal incid ya za process increas figur 11 plot logsampl mean 200 realiz 95 confid limit mean confirm argument theori sharp increas durat time intens reduc mirror ex radiu log actual duation second algorithm 22 figur 10 graph logmean actual durat second 95 confid limit 200 realiz algorithm versu r fix valu 4 two peak correspond two valu r one grain cover two four condit point respect perienc largerscal simul display figur 16 particularli failur algorithm produc coalesc low intens case thing much simpler case depend number condit point k experi 3 experi 3 fix 004 case e process independ therefor need h amount time coalesc condit point total amount time coalesc k condit point approxim kh figur 12 plot logsampl mean 200 realiz 95 confid limit mean figur show actual time increas number condit point increas agreement 7 conclus paper present perfect simul method correl poisson random variabl condit posit work gener context oppos geometr context 11 made algorithm simpler implement present moreov although method paper fall categori domin cftp defin kendal moller 10 nevertheless modest variat paper domin occur respect partial order defin state space lower upper sandwich process domin process extend state space form ya za give theoret bound rang paramet involv particular kind perfect simul may seen result section intens log actual duation second algorithm figur 11 graph logmean actual durat second 95 confid limit 200 realiz algorithm versu fix valu number k log actual duation second algorithm 22 figur 12 graph logmean actual durat second 95 confid limit 200 realiz algorithm versu k fix valu 42 6 lowintens condit boolean model present challeng particular perfect simul algorithm overcom cours contrast convent mcmc method perfect simul clearli indic fail give correct answer convent mcmc may fail without overt warn howev overst firstli price pay cftp 2 cftp method may fail judici chosen mcmc algorithm still give good answer secondli cftp exhibit bia user liabl termin run earli overcom fill reject method 4 gener point process context 14 though wilson point one us problem remain timevari due simul point process part point process algorithm despit caveat perfect simul remain attract member statistician toolbox algorithm deliv promis medium high intens condit boolean model develop particular problem perfect simul condit boolean model lead consider condit constraint base connect 12 perfect simul situat like prove difficult sinc condit appear involv arbitrarili larg number extra grain work perfect simul gibb point process 10 9 taken care test simul program care particular issu perfect simul implement inevit complic straightforward mcmc algorithm rais interest issu best test correct case concentr straightforward 2 test compat simpl theoret asymptot 9 give detail pseudolikelihood approach deal directli coupl random process lie heart sim ulat hope return issu later work ramif beyond perfect simul gener issu program complic simul acknowledg research support epsrc grant grl56831 eu tmr network erbfmrxct960095 comput statist method analysi spatial data r asymptot techniqu use statist effici markovian coupl exampl counterexampl perfect implement simul condit boolean model via correl poisson random variabl interrupt algorithm exact sampl via markov chain weight boolean model perfect simul spatial point process perfect simul areainteract point process perfect implement metropolishast simul markov point process perfect simul point process use metropolishast algorithm perfect simul stochast geometri exact sampl coupl markov chain applic statist mechan perfect simul point process impati user tr ctr jame brown gerard b heuvelink data uncertainti engin due softwar tool assess simul uncertain environment variabl comput geoscienc v33 n2 p172190 februari 2007