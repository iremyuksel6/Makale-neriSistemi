decis analysi augment probabl simul provid gener mont carlo method find altern maximum expect util decis analysi defin artifici distribut product space altern state show optim altern mode impli margin distribut altern draw sampl artifici distribut may use exploratori data analysi tool approxim identifi optim altern illustr method import type influenc diagram b introduct 11 decis analysi simul decis analysi provid framework solv decis make problem uncer tainti base find altern maximum expect util conceptu simpl actual solut maxim problem may extrem involv eg probabl model complex set altern continu sequenc decis includ therefor particular probabl model studi multivari gaussian shachter kenley 1989 inclus continu variabl simpl problem carri discret miller rice 1983 smith 1991 summari first moment deriv smith 1993 approxim mean gaussian mixtur poland 1994 complic problem may hope exact solut method may turn approxim method specif simul observ pearl 1988 p311 cooper 1989 principl simul method solv bayesian network bn may use solv decis problem repres influenc diagram id mean sequenti instanti decis node comput expect valu cooper note given instanti decis node comput expect valu valu node reformul comput posterior distribut artifici creat addit random node problem solv bn summar exampl shachter peot 1990 exact algorithm eg use cliqu join tree lauritzen spiegelhalt 1988 cutset condit pearl 1986 arc revers shachter 1986 1988 prove intract mani realworld network lead approxim infer algorithm base simul method includ short run algorithm logic sampl henrion 1988 likelihood weight shachter peot 1990 improv modif bound varianc aa algorithm pradhan dagum 1996 long run algorithm use markov chain mont carlo method like gibb sampl pearl 1987 hrycej 1990 york 1992 hybrid strategi brewer et al 1996 howev matzkevich abramson 1995 note coupl outlin simul method specif id jenzarli 1995 charn shenoy 1996 wherea first one combin stochast dynam program gibb sampl latter simul iid observ small set chanc variabl decis node instead use entir distribut becom intract continu decis space includ recent statist literatur problem ie find optim action decis problem consid muller parmigiani 1996 carlin kadan gelfand 1998 among other approach use mont carlo simul evalu expect util given instanti node 12 augment probabl simul paper propos scheme differ import way mention approach sinc use simul evalu expect util loss given instanti decis node accomod continu variabl especi decis variabl unless discret carri probabl distribut conjug framework contrast go step defin artifici distribut node includ decis node show simul artifici augment probabl model equival solv origin decis problem specif strength propos method gener algorithm principl accomod arbitrari probabl model util function long possibl pointwis evalu probabl densiti util function chosen valu involv node evalu probabl densiti constant factor suffic idea augment probabl model transform optim problem simul problem entir new exampl shachter peot 1992 propos similar approach involv augment probabl model includ decis node thu transform origin optim problem simul problem best knowledg approach describ first solv simul problem systemat exploit markov chain mont carlo simul method recent develop statist literatur method start consid artifici distribut space altern state distribut defin way margin space altern proport expect util altern consequ optim altern coincid mode margin propos simul base strategi follow step draw sampl artifici distribut ii marginalis space altern iii find mode sampl way approxim optim altern key issu sampl artifici distribut introduc markov chain mont carlo mcmc algorithm see exampl smith robert 1993 tierney 1994 tanner 1994 review mcmc method section 2 describ basic strategi simpl exampl section 3 technic natur provid gener method sampl approxim artifici distribut identifi mode sampl section 4 discuss applic exampl section 5 compar method altern scheme identifi situat call differ approach 2 basic approach outlin basic approach assum choos uncertainti altern set set state theta propos optim altern maximum expect util ud p ud util function model prefer consequ p probabl distribut model belief possibl influenc action problem structur complic say heavili asymmetr dens larg influenc diagram continu nongaussian random variabl non quadrat util function andor continu set altern decis node find exact solut might analyt comput intract might need approxim solut method shall provid approxim base simul assum p 0 pair ud posit integr defin artifici distribut product space athetatheta densiti h proport product util probabl specif hd ud delta p note artifici distribut h chosen margin altern hd henc optim altern coincid mode margin artifici distribut h space altern consequ solv expect util maxim problem approxim follow simul base draw random sampl distribut hd ii convert random sampl margin hd iii find mode sampl augment probabl model simul conceptu differ simul algorithm review earlier simul use pointwis evalu expect util decis altern instead simul gener artifici probabl model hdelta augment state vector key step iii ii sinc use simul gener hd get margin sampl hd simpli discard simul valu iii reli mainli tool exploratori data analysi describ section 33 shall introduc gener markov chain simul method underli idea simpl wish gener sampl distribut certain space directli suppos howev construct markov chain state space straightforward simul whose equilibrium distribut desir distribut simul suffici mani iter drop initi transient phase may use simul valu chain approxim sampl desir distribut shall provid sever algorithm construct chain desir equilibrium distribut case artifici distribut h section 32 rest section shall provid algorithm simpl exampl reader may grasp basic idea without enter technic detail reader familiar mcmc simul may skip directli section 3 strategi propos simpl may undertaken limit case suppos condit distribut hdj hjd avail effici random variat gener suggest follow scheme known gibb sampler statist literatur gelfand smith 1990 start arbitrari valu step ii iii converg judg consequ result tierney 1994 robert smith 1994 proposit 1 util function posit integr p 0 pair theta interv ir n scheme defin markov chain stationari distribut h imposs give gener applic result termin iter markov chain mont carlo simul well known difficult theoret problem see eg robert 1995 polson 1996 discuss approach find number iter ensur converg total variat norm within given distanc true stationari distribut howev practic converg may judg number criteria see eg cowl carlin 1996 brook robert 1999 method implement coda best et al 1995 use exampl practic converg judg say may record next n iter simul output use approxim sampl hd may tri assess mode illustr approach artifici exampl adapt shenoy 1994 exampl 1 physician determin polici treat patient suspect suffer diseas caus patholog state p turn caus symptom exhibit physician observ whether patient exhibit symptom base inform either treat patient p 0 physician util function depend p shown tabl 1 valu 0001 chang origin valu 0 adapt gener result proposit 1 probabl diseas 1 01 patient known suffer 80 suffer p 1 hand tabl 1 probabl model pd physician util function ut hd probabl use step ii iii markov chain mont carlo scheme describ text proport entri appropri column row respect h section right tabl patient known suffer 0 15 suffer p patient known suffer p patient known suffer assum probabilist independ given p implement propos algorithm need find condit distribut hjd hdj case decis taken symptom exhibit 0 exhibit mean treat treat patient let pd probabl given descript hd propos method goe follow start arbitrari decis 0 step ii iii converg judg converg judg record next n iter algorithm use approxim sampl margin artifici distribut leav valu record avoid serial correl sinc altern finit number need inspect histogram approxim mode simul sampl size 1000 find optim decis treat symptom present treat symptom absent note exampl propos augment probabl model simul differ simul method propos solut id use one simul joint space simul hdelta instead mani small simul evalu expect util possibl decis one time cours previou exampl extrem simpl abl sampl hdj hjd inspect histogram may approxim mode next section deal complex case 3 sampl artifici distribut shall provid gener method sampl artifici distribut hdelta typ ical distribut straightforward simul requir gener possibl high dimension model includ complex probabl util function continu decis chanc node possibl condit observ data mcmc simul scheme commonli use method known accomod gen henc choos given enorm interest id tool structur solv decis problem see eg matzkevich abramson 1995 concentr structur id direct graph represent decis problem probabl network addit node repres decis valu notat purpos shall partit set node five subset differenti three type chanc node decis node repres decis made ii chanc node includ random variabl x observ prior make decis ie data avail time decis make yet observ random variabl ie data observ make decis unobserv random variabl ie unknown paramet iii one valu node u repres util function ud x figur 1 provid simpl gener id scheme id solv determin decis maximum expect util x phi oe r deltaff figur 1 gener influenc diagram scheme requir margin chanc node condit x maxim see shachter 1986 complet descript algorithm solv id method propos applic id nonsequenti structur ie decis node must chanc node predecessor distribut depend turn decis node except technic condit requir 31 probabl model defin influenc diagram id defin condit distribut pxj p p yj joint distribut x via p x ppxjp yj given observ node x typic x independ given allow given factor p depend particular problem fit setup modif propos algorithm straightforward context probabl model solv id amount maxim expect util p yjx relev distribut comput expect summari solv id amount find z shall solv problem approxim simul augment probabl measur probabl model defin joint pdf mode impli margin distribut hd r correspond optim decis underli rational method simul markov chain defin h asymptot distribut big enough simul valu success state simul process provid approxim mont carlo sampl h note simul defin augment probabl model hd rather p possibl instanti action tradit method consid margin distribut mont carlo sampl infer optim decis use method discuss section 33 key issu definit markov chain desir limit distribut h capitalis recent work numer bayesian infer concern applic markov chain mont carlo method explor high dimension distribut allow analyt solut expect margin distribut etc 32 markov chain mont carlo simul shall provid gener algorithm valid id satisfi structur condit specifi minor technic condit discuss algorithm describ metropoli type tierney 1994 gener new candid state probe distribut move new state stay old one accord certain probabl transit three step requir abl evalu util function ud x probabl distribut p yj p pxj relev x typic possibl sinc definit id includ explicit specif distribut ie model like specifi wellknown distribut scheme requir specif probe distribut g 1 g 2 g 3 choic probe distribut g j j conceptu arbitrari constraint result markov chain irreduc aperiod shall argu whenev possibl assum symmetr probe distribut ie satisfi exampl gajb could multivari normal distribut nb sigma sigma detail choic probe distribut discuss appendix algorithm 1 1 start valu paramet outcom set 2 let u gener propos djd comput hd probabl 1 set otherwis keep 3 let u gener propos comput probabl 2 set 4 let u gener propos comput u3 probabl 3 set 5 1 repeat step 2 4 chain judg practic converg algorithm defin markov chain h stationari distribut gener algorithm come price name possibl slow converg depend applic long simul run might requir attain practic converg howev fulli gener algorithm rare requir mani problem allow simpler algorithm base use pjx p yj gener propos algorithm 2 given requir probe distribut g djd evalu util function algorithm gener pjx p yj simul p yj typic straightforward simul pjx gen eral distribut explicitli specifi id need comput repeat applic bay formula sever arc revers languag id howev note simul pjx amount solv statist infer problem gener posterior distribut given data x henc appeal version posterior simul scheme appropri varieti import infer problem recent discuss bayesian literatur see eg smith robert 1993 tanner 1994 tierney 1994 start algorithm describ gener suffici larg mont carlo sampl pjx whatev simul method appropri algorithm 2 1 start valu 2 evalu u 3 gener djd igamma1 p djd igamma1 p jxp yj 4 evalu x 5 comput hd 7 converg practic judg step 3 gener pjx done use simul mont carlo sampl gener algorithm 3 algorithm simplifi x miss id ie data given time decis associ algorithm 3 would state algorithm 2 propos distribut step 3 replac djdp yj sampl p feasibl gener sinc distribut defin explicitli id 33 find optim solut mcmc simul provid us approxim simul sampl fd deduc approxim sampl margin hd mode hd approxim optim altern case discret altern problem simpl sinc count number time element appear choos one highest frequenc may worthwhil retain one sever frequent decis studi detail way conduct sensit analysi case continu altern first approach may use graphic exploratori data analysi tool especi low dimension decis vector decis vector one two dimension may produc histogram smooth version inspect identifi mode higher dimension decis vector propos consid problem one cluster analysi mode hd correspond ds higher densiti suggest look region higher concentr sampl ds lead us comput hierarch cluster tree simul point sinc assum h densiti respect lebesgu measur ir n interest identifi region optim altern might lie suggest use complet linkag euclidean distanc classif tree cut certain height obtain correspond cluster locat largest cluster indic area best decis may use keep sever larger cluster explor correspond region result cours would depend cut height explor sever height may abl identifi sever decis interest illustr approach section 42 41 exampl 2 medic decis make problem illustr algorithm case studi concern determin optim apher si design cancer patient undergo chemotherapi palmer muller 1998 describ clinic background solv problem larg scale mont carlo integr pretreat start chemotherapi stem cell cd34 collect allow later reconstitut white blood cell compon depend pretreat first stem cell collect process apheresi schedul fifth seventh day pretreat decis made day pretreat treatment schedul stem cell collect collect target number cell ii minim number apheres data 22 past patient first day new patient denot observ cd34 count patient day ij also shall design ith patient data combin data vector palmer muller 1998 specifi follow probabl model process likelihood base observ typic profil stem cell count day show first rise pretreat reach maximum slowli declin back toward base level shown figur 2 model shape use nonlinear regress model let gt gamma probabl densiti function paramet chosen impli mean varianc match e 2 rescal use gdelta e parametr nonlinear regress profil time prior model patient specif paramet hierarch patient undergo one two possibl pretreat x 2 f1 2g serv covari specifi first level prior nj x hyperprior second level common case 2 model complet prior v oe figur show observ count ij fit profil typic patient new patient 1 denot unknown stem cell count day first day 0 alreadi count h0 use notat introduc begin section 3 observ figur 2 three typic patient dash line connect data point solid curv plot fit profil use describ probabl model data vector futur data vector unobserv paramet model given typic profil optim decis schedul apheres day initi day 0 final day 1 ie decis paramet let event fail collect target number stem cell g l h volum blood process stem cell collect new pa tient let n number schedul stem cell collect util function ud x c sampl cost p penalti underachiev target need maxim expect util r note probabl model ppx yj depend decis node data x influenc belief model sinc pjx may actual sampl markov chain mont carlo method describ palmer muller 1998 use algorithm 2 solv problem ensur posit util function add constant offset udelta found optim design futur patient belief prefer model 100 patient undergo treatment x first observ 5 optim apheresi schedul remain six day found given decis space two dimension simpl inspect histogram figur 3 plot estim distribut figur 3 grey shade show histogram simul medic problem inspect hd reveal optim decis 42 exampl 3 water reservoir manag problem rio insua et al 1997 describ complex multiperiod decis analysi problem concern manag two reservoir lake kariba k cahora bassa c solv simplifi version use propos mcmc approach simul augment probabl model want find given month optim valu announc releas k c turbin spillgat k respect actual amount water releas depend water avail uncertain sinc uncertainti inflow k c reservoir forecast model k c latter depend water releas k increment inflow inc turn depend paramet fi prefer model combin util k c k depend energi deficit def final storag sto k amount water spill spi c depend energi produc ene final storag sto c initi storag k c influenc well actual releas figur 4 show influenc diagram repres problem node doubl border either known valu determinist function predecessor requir comput valu node u show probabl model term rel sto k c ene sto c gammapsi deltaff phi phi phi phi phi phi phi phi au deltaff j bbbbbbbn gammapsi theta theta theta theta theta theta theta j omega omega omega omega omega omega omega oe phi phi phi phi z z z z z ae ae ae ae ae r au b ae figur 4 influenc diagram reservoir problem notat problem includ four decis node node k fi figur 5 show profil histogram simul hd gener algorithm 3 decis paramet four dimension henc use four dimension cell record four dimension histogram simul state simpl inspect empir distribut allow read optim releas 200g solut base 100000 simul valu markov chain mont carlo scheme figur 5 illustr also anoth featur method simpl sensit analysi procedur extra cost dark figur 5b suggest expect util rather flat releas turbin fix optim valu henc suggest insensit respect chang spill hand figur 5a one dark area estim optimum suggest expect util fairli peak releas turbin henc sensit chang energi releas altern discuss section 33 consid hierarch cluster tree simul output dot figur 5 show solut base cut hierarch cluster tree 1000 simul valu hd height 2000 find cluster member optimum found 476g come reason close optimum estim earlier 51 comparison altern scheme scheme describ algorithm 1 2 3 transform origin expect util maxim problem 1 simul problem scheme gener sens accomod arbitrari probabl model discret continu util fd k figur 5 expect util function releas energi k spill fix optim level b function spill k releas turbin fix optima diamond indic optim decis dot indic simul largest cluster hierarch cluster tree cut height 2000 function long probabl densiti probabl mass function util function pointwis evalu main differ simul scheme earlier consid literatur instead use simul evalu expect util loss possibl instanti decis use simul artifici auxiliari model augment origin probabl model includ artifici distribut decis node whether one approach effici depend specif consid decis problem gener comparison possibl even specif exampl perform depend heavili arbitrari choic like amount discret necessari mani method run length involv mont carlo simul chosen mcmc scheme etc howev gener observ rel effici method possibl problem altern analyt solut use method like arc revers shachter 1986 simul method use simul pointwis evalu expect util like likelihood weight shachter peot 1990 typic effici simul auxiliari probabl model bielza shenoy 1998 discuss decis problem reactor problem 6 possibl action chanc node less 10 possibl joint outcom exact solut use shachter 1986 algorithm requir one arc revers largest state space use solut phase contain 4 variabl comparison implement exampl use augment probabl simul follow algorithm 3 use 100000 iter mcmc simul comput effort one iter approxim compar one arc revers thu exact solut clearli far effici term comput time altern consid simul comput expect util six possibl action use exampl likelihood weight consid involv numer standard error mont carlo simul size around 1000 simul altern decis would adequ thu also likelihood weight domin simul augment probabl model problem optim decis comput condit alreadi avail data x comparison chang especi posterior distribut unknown paramet significantli differ initi prior distribut ie low prior probabl evid x consid exampl applic report section 41 amen exact method use mont carlo simul comput expect util altern decis longer gener independ sampl follow jenzarli 1995 propos could use gibb sampl comput expect util iti depend specif choic implement mcmc scheme termin criteria one would typic use order 10000 iter palmer muller 1998 discret sampl space one could principl also use logic sampl henrion 1988 howev logic sampl would advis problem sinc fraction simul experi gener variabl correspond actual observ would close zero ie px notat shachter peot 1990 similar reason likelihood weight shachter peot 1990 would fail sinc leaf node observ sampl score would proport likelihood function ie scheme would amount import sampl use prior probabl model import sampl function howev address use bound varianc type algorithm discuss exampl pradhan dagum 1996 final mani decis problem involv continu decis variabl like exampl consid section 42 continu decis paramet creat problem simul augment probabl model would allow straightforward applic scheme base evalu expect util one decis time even discret use say grid result number altern action render scheme difficult use 52 conclus complex decis problem may render imposs applic exact method obtain optim decis consequ look approxim method includ simul propos simul base strategi approxim optim decis decis analysi experi exampl suggest approach may power implement algorithm fairli straightforward base scheme provid specif case may requir simpl modif one suggest section 32 explor sampl search mode may done standard statist softwar mention discuss exampl 3 one featur method provis simpl sensit analysi featur extra cost number challeng problem remain particularli perhap extens scheme sequenti decis straightforward approach expand model nonsequenti normal form may appli number decis node small anoth challeng problem would develop comput environ base approach would also interest develop method look mode multivari set similar idea may pursu solv tradit statist optim design problem formal point view optim design problem describ stochast optim problem 1 explor clyde muller parmigiani 1995 special case algorithm 3 continu sampl space nonsequenti setup appendix implement choic probe distribut g j j algorithm 1 conceptu arbitrari constraint result markov chain irreduc aperiod statement proof propos algorithm assum g symmetr argument ie continu paramet propos use normal kernel g appropri chosen covari matrix sigma exampl diagon matrix diagon entri correspond reason step size decis paramet good valu step size found trial error valu particular setup gelman robert gilk 1996 show optim choic step size result averag accept probabl around 25 similarli paramet discret simpl choic g djd could gener 05 cours mani problem specif choic possibl exampl 2 eg defin choos probabl 16 one six possibl move increas 0 1 1 day ii decreas 0 1 1 iii increas 0 1 iv decreas 0 etc symmetri g violat addit factor gdj djd would ad express accept probabl would correspond metropolishast step rather metropoli step converg proof propos scheme simpl base result tierney 1994 robert smith 1994 acknowledg research suport grant nation scienc foundat cam cicyt iberdrola foundat part took place peter muller visit upm david rio insua visit cnriami grate discuss mike wiper r comparison graphic techniqu asymmetr decis problem comparison hybrid strategi gibb sampl mix graphic model asses converg markov chain mont carlo algo rithm approach optim sequenti decis analysi clinic trial forward mont carlo method solv influenc diagram use local comput explor expect util surfac markov chang method use belief network influenc diagram markov chain mont carlo converg diagnost compar review effici metropoli jump rule bayesian statist 5 sampl base approach calcul margin densiti propag uncertainti bayesian network probabilist logic sampl gibb sampl bayesian network solv influenc diagram use gibb sampl local comput probabl graphic structur applic expert system decis analyt network artifici intellig discret approxim probabl distribut optim design via curv fit mont carlo experi ment bayesian optim design popul model hematolog data fusion propag structur belief network probabilist reason intellig system decis analysi continu discret variabl mixtur distribut approach converg markov chain mont carlo algorithm optim mont carlo estim belief network infer bayesian method reservoir opera tion zambezi river case converg control method markov chain mont carlo algorithm simpl condit converg gibb sampler metropolishast algorithm probabilist infer influenc diagram gaussian influenc diagram simul approach gener probabilist infer belief net work decis make use probabilist infer method comparison graphic techniqu decis analysi bayesian comput method moment method decis analysi bayesian comput via gibb sampler relat markov chain mont carlo method tool statist infer markov chain explor posterior distribut discuss use gibb sampler expert system tr