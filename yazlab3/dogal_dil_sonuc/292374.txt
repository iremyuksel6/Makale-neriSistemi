spars approxim invers precondition nonsymmetr linear system paper concern new approach precondit larg spars linear system procedur comput incomplet factor invers nonsymmetr matrix develop result factor spars approxim invers use explicit precondition conjug gradienttyp method theoret properti precondition discuss numer experi test matric harwellbo collect tim daviss collect present result indic new precondition cheaper construct approxim invers precondition furthermor new techniqu insur converg rate precondit iter compar obtain standard implicit precondition b introduct paper consid solut nonsingular linear system form 1 coeffici matrix 2 ir nthetan larg spars particular concern develop precondition conjug gradienttyp method wellknown rate converg method solv 1 strongli influenc spectral properti therefor natur tri transform origin system one solut favor spectral properti precondition matrix use accomplish transform g nonsingular dipartimento di matematica universita di bologna itali cerfac 42 ave g corioli 31057 toulous cedex franc benzicerfacsfr work support part grant scientif cooper agreement cnr czech academi scienc institut comput scienc academi scienc czech republ pod vodarensk vezi 2 tumauivtcascz work author support part grant ga cr 201930067 ga cr 230401 nsf grant number int9218024 michel benzi miroslav tuma matrix approxim linear system 2 solut system 1 converg rate iter method appli 2 may much higher problem 2 precondit left right precondit also possibl precondit right lead transform linear system solut 3 obtain solut 1 given choic left right precondit often dictat choic iter method also possibl use form precondit split precondit see 3 detail note practic requir comput matrix product ga ag explicitli conjug gradienttyp method necessit coeffici matrix form matrixvector multipli therefor appli precondition within step gradienttyp method reduc comput action g vector loos speak closer g exact invers higher rate converg iter method choos yield converg one step cours construct precondition equival solv origin problem practic precondition g easili comput appli total time precondit iter less time unprecondit one typic cost appli precondition iter conjug gradienttyp method order cost matrixvector multipli involv spars impli precondition also spars densiti nonzero roughli order clearli effect precondit strategi strongli problem architectur depend instanc precondition expens comput may becom viabl reus mani time sinc case initi cost form precondition amort sever linear system situat occur stanc deal timedepend nonlinear problem whose numer solut give rise long sequenc linear system coeffici matrix slowli vari one differ righthand side furthermor precondition effici scalar comput environ may show poor perform vector parallel machin convers approxim invers precondit 3 number precondit techniqu propos literatur see eg 23 refer therein gener agre construct effici generalpurpos precondition possibl still consider interest develop method perform well wide rang problem wellsuit stateoftheart comput architectur introduc new algebra precondition base incomplet triangular factor gamma1 paper natur continu 8 focu restrict symmetr posit definit system precondit conjug gradient method see also 57 paper organ follow x2 give quick overview implicit explicit precondit techniqu consid rel advantag well limit two approach x3 summar recent work popular approach approxim invers precondit base frobeniu norm minim x4 introduc new incomplet invers triangular decomposit techniqu describ theoret properti graphtheoret character fillin invers triangular factor present x5 x6 consid use precondit matric reduc block triangular form implement detail result numer experi discuss xx7 8 conclud remark indic futur work given x9 experi suggest new precondition cheaper construct precondition base optim approach moreov good rate converg achiev precondition compar insur standard ilutyp techniqu 2 explicit vs implicit precondit exist precondition broadli classifi either implicit explicit kind precondition implicit applic within step chosen iter method requir solut linear system nonsingular matrix implicitli defin approxim appli g requir solv linear system coeffici matrix cours chosen solv system matrix easier solv origin problem 1 perhap import exampl provid precondition base incomplet lu ilu decomposit u l u spars triangular matric approxim exact l u factor appli precondition requir solut two spars triangular system forward backward solv notabl exampl implicit precondition includ ilq ssor adi precondition see 3 4 michel benzi miroslav tuma contrast explicit precondit matrix g gamma1 known possibl product spars matric precondit oper reduc form one matrixvector product instanc mani polynomi precondition belong class 37 explicit precondition describ subsequ section implicit precondition intens studi success employ number applic spite last year increas amount attent devot altern form precondit especi explicit kind far two main reason recent trend first place shortli usag modern highperform architectur becam widespread realiz straightforward implement implicit precondit conjug gradientlik method could lead sever degrad perform new machin particular spars triangular solv involv ilutyp precondit found serial bottleneck due recurs natur comput thu limit effect approach vector parallel comput mention consider effort devot overcom difficulti result architectur type problem possibl introduc nontrivi parallel achiev reason good perform triangular solv mean suitabl reorder strategi see eg 13854 howev triangular solv remain problemat aspect comput share memori 33 distribut memori 10 comput mani problem effici applic implicit precondition parallel environ still repres seriou challeng anoth drawback implicit precondition ilutyp possibl breakdown incomplet factor process due occurr zero exceedingli small pivot situat typic aris deal matric strongli unsymmetr andor indefinit even pivot appli see 1149 gener may even occur definit problem unless exhibit degre diagon domin cours alway possibl safeguard incomplet factor process alway run complet produc nonsingular precondition also guarante result precondition accept qualiti fur thermor shown 23 problem standard ilu techniqu produc unstabl incomplet factor result useless precondition explicit precondit techniqu base directli approxim gamma1 develop attempt avoid mitig difficulti appli explicit precondition requir spars matrixvector product easier parallel approxim invers precondit 5 spars triangular solv case construct precondition wellsuit parallel implement addit construct approxim invers sometim possibl even matrix stabl incomplet lu decomposit moreov mention spars incomplet invers often use construct approxim schur complement pivot block use incomplet block factor twolevel precondition see 231215 cours explicit precondition far complet troublefre even spars approxim invers g comput care must exercis ensur g nonsingular nonsymmetr problem matrix g could good approxim invers use left precondit poor one use right precondit see 36 p 9645 p 6648 furthermor explicit precondition sometim effect implicit one reduc number iter sens problem requir higher number nonzero order achiev rate converg insur implicit precondition one reason limit explicit precondition attempt approxim gamma1 usual dens spars matrix thu explicit precondition like work well gamma1 contain mani entri small magnitud favor situat exhibit form diagon domin problem implicit precondit also like effect henc problem type explicit precondition competit implicit one explicit fulli exploit final explicit precondition usual expens comput implicit one although differ may becom neglig common situat sever linear system coeffici matrix differ righthand side solv case time comput precondition often fraction time requir overal comput also worth repeat construct certain spars approxim invers done least principl highli parallel manner wherea scope parallel construct ilutyp precondition limit 3 method base frobeniu norm minim good deal work devot explicit precondit base follow approach spars approxim invers comput matrix g minim ki gamma gak ki gamma agk right precondit subject sparsiti constraint see 4 ch 8 21643 4432311130 matrix norm usual frobeniu norm weight variant comput reason choic constrain minim problem decoupl n independ linear least squar problem one row 6 michel benzi miroslav tuma column g number unknown problem equal number nonzero allow row column g immedi follow ident ith unit vector g ith column g clearli consider scope parallel approach result spars least squar problem solv principl independ either direct method 44 3130 iter 1142 earli paper eg 43243 sparsiti constraint impos priori minim found rel class matric predetermin sparsiti pattern instanc band matrix good degre diagon domin band approxim gamma1 justifi see 18 howev gener spars matric difficult guess good sparsiti pattern approxim invers sever recent paper address problem adapt defin nonzero pattern g order captur larg entri invers 3130 inde monitor size residu possibl decid whether new entri g retain discard dynam fashion moreov inform residu util deriv rigor bound cluster singular valu precondit matrix therefor estim condit number 31 also possibl formul condit norm residu insur approxim invers nonsingular unfortun condit appear dubiou practic valu tri fulfil could lead dens approxim invers 1611 disadvantag approach symmetri coeffici matrix exploit symmetr posit definit spd spars approxim invers symmetr gener even preset symmetr sparsiti pattern enforc guarante approxim invers posit definit could lead breakdown conjug gradient acceler reason kolotilina yeremin 4344 propos comput explicit precondition form lower triangular precondit matrix glag spd conjug gradient method appli matrix gl solut constrain minim problem frobeniu norm gamma lgl l choleski factor 43 shown problem solv without explicit knowledg entri l use entri coeffici matrix techniqu also use comput factor approxim invers nonsymmetr matrix approxim invers precondit 7 separ approxim invers l u factor stand howev techniqu requir sparsiti pattern approxim invers triangular factor specifi advanc therefor suitabl matric gener sparsiti pattern addit reason consid factor approxim invers clearli approxim invers g express product two triangular factor trivial insur g nonsingular anoth argument favor approach given 11 observ factor form gener spars matric contain inform storag singl product store serial cost construct type precondition usual high although theoret parallel complex quit moder 4430 result numer experi report 44 demonstr factor spars approxim invers precondition insur rapid converg precondit conjug gradient iter appli certain finit element discret 3d pde problem aris elast theori howev experi precondit strategi appli coeffici matrix directli rather reduc system schur compl ment better condit consider less spars origin problem approxim invers precondition appli directli origin stiff matrix rate converg pcg iter rather disappoint comparison frobeniu normbas spars approxim invers precondition ilu0 precondition number gener spars matric made 30 report result show explicit precondition insur rate converg compar achiev implicit ilutyp approach observ construct approxim invers often costli amen parallel factor spars approxim invers also consid author instanc kaporin 394041 whose approach also base minim certain matrix function close relat kolotilina yeremin next section present altern approach factor spars approxim invers precondit ground optim base instead direct method matrix invers shall see serial cost form spars approxim invers techniqu usual much less optim approach converg rate still compar averag obtain ilutyp precondit 8 michel benzi miroslav tuma 4 method base invers triangular factor optim approach construct approxim invers possibl one section consid altern procedur base direct method matrix invers perform incomplet order preserv sparsiti result factor spars g gamma1 incomplet matrix factor method procedur resembl classic ilu type implicit techniqu inde draw experi accumul year use ilutyp precondit implement stage deriv theoret properti precondition g paper continu work 8 symmetr posit definit case studi see also 57 construct precondition base algorithm comput two set vector fz g n abiconjug ie w 6 j given nonsingular matrix 2 ir nthetan close relationship problem invert comput two set abiconjug vector fz g n fw g n matrix whose ith column z matrix whose ith column w follow w z necessarili nonsingular henc invers known two complet set abiconjug vector known note infinit mani set matric w z whose column biconjug explicitli comput mean biconjug process appli column two nonsingular matric w 0 z 0 2 ir nthetan comput conveni choic let w biconjug process appli unit basi vector order describ procedur let c denot ith row approxim invers precondit 9 respect ie c ith column basic abiconjug procedur written follow biconjug algorithm z z igamma1 return algorithm essenti due l fox see ch 6 25 close relat method also consid hesten stiefel 35 pp 42642734 stewart 52 gener treatment given recent paper 14 geometr procedur regard gener gramschmidt orthogon obliqu project nonstandard inner product see 614 sever observ regard algorithm order first place note formul contain redund sinc exact arithmet therefor step comput dot product q igamma1 may replac assign q igamma1 anoth observ fact procedur stand vulner breakdown divis zero occur whenev michel benzi miroslav tuma quantiti p igamma1 happen zero shown exact arithmet biconjug algorithm break lead princip minor nonzero see nonsingular matrix exist permut matrix q procedur appli pa aq break lu decomposit pivot permut matric repres row column interchang perform need cours comput biconjug process carri complet without interchang result z w matric upper triangular 1 diagon entri equal one satisfi ident recogn 5 familiar ldu decomposit ldu l unit lower triangular u unit upper triangular diagon matrix pivot main diagon factor uniqu biconjug algorithm explicitli comput matrix exactli 5 ldu henc process produc invers triangular decomposit equival triangular decomposit udl type gamma1 p return algorithm pivot ldu factor denot delta ith lead princip minor 1 n let ident 5 impli show biconjug algorithm perform without breakdown lead princip minor nonvanish finit precis arithmet pivot may requir promot numer stabil z w avail solut linear system form 1 comput 4 1 note necessarili true matrix ident use outset ie approxim invers precondit 11 practic direct method solv linear system use account cost dens n theta n matrix biconjug process requir twice work lu factor notic cost solv phase use 6 forward backward solv l u factor symmetr number oper biconjug algorithm halv observ w must equal z henc process carri use row zvector p igamma1 column result z form set conjug direct spd breakdown occur exact arithmet pivot requir algorithm comput l dl factor gamma1 method first describ 26 geometr amount gramschmidt orthogon inner product hx yi x ay appli unit vector e sometim refer conjug gramschmidt process method still impract direct solver requir twice work choleski dens matric howev explain 5 6 algorithm also appli nonsymmetr system result implicit ldu factor comput inde possibl comput solut 1 righthand side use z part entri method arithmet complex gaussian elimin appli dens problem combin suitabl sparsitypreserv strategi method use spars direct solver least type problem see 56 spars symmetr posit definit z matrix produc algorithm tend dens see next section observ experiment often entri z small magnitud fillin z matrix reduc remov suitabl small entri comput zvector algorithm comput spars matrix z diagon matrix ie factor spars approxim invers henc g use explicit precondition conjug gradient method detail studi precondit strategi spd problem found 8 proven incomplet invers factor exist hmatrix analog ilutyp factor numer experi 8 show approach insur fast converg pcg iter almost good implicit precondit incomplet choleski type construct precondition somewhat expens comput incomplet choleski factor still quit cheap contrast michel benzi miroslav tuma least squar approach describ previou section construct approxim invers usual time consum least sequenti environ remaind paper consid explicit precondit strategi base biconjug process describ sparsiti z w factor gamma1 preserv remov small fill z wvector possibl would drop newli ad fillin element outsid preset sparsiti pattern main diagon z w howev gener spars matric difficult guess reason sparsiti pattern drop toler use instead trivial extens result 8 show incomplet biconjug process incomplet invers factor break exact arithmet hmatrix gener matric necessari safeguard comput order avoid breakdown requir pivot modif perhap form pivot postpon detail x7 incomplet biconjug algorithm comput spars unit upper triangular matric w w nonsingular diagon matrix factor spars approxim invers use explicit precondition conjug gradienttyp method solut 1 conclud section remark properti approxim invers precondition g describ hmatrix alreadi mention construct precondition could break due occurr zero extrem small pivot howev follow 46 note alway exist ff 0 ffi diagon domin henc hmatrix therefor incomplet bicon jugat algorithm break one could tri select ff 0 reattempt process shift matrix larg enough insur exist incomplet invers factor also small enough 0 close approach sever drawback illcondit matric qualiti result precondition typic poor furthermor breakdown prompt shift may occur near end biconjug process precondition may recomput sever time satisfactori valu ff found better strategi perform diagon modif need aris shift pivot away zero magnitud less specifi threshold see x7 detail mmatrix follow result 8 g nonneg matrix approxim invers precondit 13 moreov easi see componentwis follow inequ hold da diagon part furthermor g 1 g 2 two approxim invers mmatrix produc incomplet biconjug process drop toler use g 1 greater equal drop toler use g 2 true sparsiti pattern use determin nonzero structur z w pattern g 2 includ pattern g 1 monoton properti share spars approxim invers see exampl ch 8 2 note properti 7 import approxim invers use within incomplet block factor mmatrix insur intermedi matric produc cours incomplet factor preserv mmatrix properti see 2 pp 263264 final discuss similar point differ incomplet invers factor ilutyp factor matrix incomplet factor mmatrix induc split regular split therefor converg aei gamma denot spectral radiu 4755 true gener incomplet factor one consid induc split split need converg exampl given symmetr mmatrix b matrix incomplet invers factor drop toler intermedi fillin drop smaller absolut valu produc approxim invers g aei gamma ga 1215 1 show approxim decomposit obtain gener incomplet factor sens incomplet invers factor algebra equival incomplet ldu factor perform 14 michel benzi miroslav tuma 5 fillin biconjug algorithm section give character fillin occur factor invers obtain biconjug algorithm result may serv guidelin predict structur factor approxim invers impact certain aspect implement wellknown structur nonzero invers matrix gamma1 character path graph origin matrix see 2429 follow lemma state necessari suffici condit new entri fillin ad one zvector ith step biconjug algorithm similar result hold wvector make use standard nocancel assumpt lemma 51 let 1 z igamma1 l z igamma1 li time least one two follow condit hold proof suppos z igamma1 0 directli updat formula zvector see z igamma1 li 6 0 l sinc z igamma1 lj becom nonzero ith step clearli p igamma1 j must nonzero z igamma1 kj ik get result opposit implic trivial 2 figur 51 56 provid illustr previou lemma figur 51 show nonzero structur matrix fs760 1 order 760 harwellbo collect 21 figur 526 show structur factor z differ stage biconjug algorithm pictur show initi step entri z still zero nonzero z induc nonzero correspond posit similar situat occur cours process comput w figur 57 show entri z larger absolut figur 58 show incomplet factor z obtain drop toler seen well incomplet process abl captur larg entri complet factor z figur gener use routin plot spars matrix pattern sparskit 50 approxim invers precondit 15 figur 512 structur matrix fs760 1 left factor z right 20 step biconjug process figur 534 structur z 70 step left 200 step right biconjug process michel benzi miroslav tuma figur 556 structur z 400 step left 760 step right biconjug process figur 578 structur entri z larger 10 gamma10 left structur incomplet factor z drop toler approxim invers precondit 17 suffici condit fillin matrix z step biconju gation algorithm given follow lemma lemma 52 let e bipartit graph indic l path b z p proof use induct p let 0 cours z 1 gamma1 lemma 51 get z 1 suppos lemma 52 true l p z use nocancel assumpt also z p follow theorem give necessari suffici condit nonzero entri appear posit l j l j invers triangular factor theorem 53 let 1 p 1 proof first show state condit suffici lemma 51 nonzero impli z 1 l 1 j also nonzero done otherwis z 2 gamma1 0 take account z l 2 get z 2 nonzero repeat argument induct final get z p l consequ z assum z lj 6 0 lemma 51 impli least one follow two condit hold either exist li 0 6 0 exist indic 00 k 6 0 z 00 gamma1 li 00 6 0 former case necessari condit latter case appli lemma 51 induct z 00 gamma1 j induct step obtain condit 2 clearli character fillin invers triangular factor less transpar necessari suffici condit character nonzero non factor invers michel benzi miroslav tuma 6 precondit block triangular matric mani spars matric aris realworld applic may reduc block triangular form see ch 6 20 section discuss applic precondit techniqu linear system block lower triangular coeffici matrix close follow 30 reduct block triangular form usual obtain twostep procedur outlin 20 first step row permut bring nonzero entri main diagon produc matrix pa second step symmetr permut use find block triangular form 53 result matrix repres k1 k2 delta delta delta kkc c c c diagon block ii assum irreduc nonsingular diagon block ii must also nonsingular suppos comput approxim invers diagon block incomplet biconjug algorithm gamma1 z ii ii ii invers approxim follow cf 30 22 k1 k2 delta delta qp precondit step conjug gradienttyp method requir evalu action g vector ie comput z gd given vector step precondit iter method done backsubstitut z b z b approxim invers precondit 19 partit z induc block structur qpaq comput requir certain precondit iter method accomplish similar way approach fillin confin approxim invers diagon block often result spars precondition notic also approxim invers g ii comput parallel price pay loss part explicit approxim invers precondition appli note 30 comparison purpos appli scheme ilu precondit specif ical approxim 21 k1 k2 diagon block ii approxim ilu decomposit u ii appli precondition requir solut linear system step precondit iter done backsubstitut partit z use transpos ilu precondit similar type ilu block precondit introduc explicit applic precondition note ilu factor diagon block perform parallel see section numer experi reduct block triangular form influenc behavior precondit iter differ way depend whether approxim invers techniqu ilutyp precondit use michel benzi miroslav tuma 7 implement aspect possibl implement incomplet invers factor algorithm x4 least two distinct way first implement similar spirit classic submatrix formul spars gaussian elimin repres instanc 1957 approach reli spars incomplet rankon updat matric z appli form outer vector product updat timeconsum part comput cours updat new fillin element whose magnitud less prescrib drop toler drop approach dynam data structur use z matric note step incomplet invers factor ith row ith column c requir matrix store static data structur row column cours singl array need numer valu entri implement effici addit elbow room necessari instanc comput incomplet z factor elbow room twice space anticip store nonzero factor look precondition number nonzero origin matrix estim number nonzero z half number nonzero origin matrix column z give initi predict fillin base result x5 thu initi structur z given structur upper triangular part cours w handl similarli space initi alloc given column enough situat solv way standard work dynam data structur look block free space end activ part dynam data structur larg enough contain current column garbag collect see 57 fillin z w appear late step biconjug process abl keep amount dynam data structur manipul rel low level follow implement refer dd implement despit effort minim amount symbol manipul dd im plement disadvantag nonloc charact comput high proport nonfloatingpoint oper still remain import drawback submatrix rightlook undelay algorithm use dynam data structur use structur predict known effici block strategi use even oper perform incor work row column list step outer cycl rather irregular therefor larger problem oper still scatter around memori outofcach consequ difficult achiev high effici code attempt parallel approxim invers precondit 21 comput precondition form face seriou problem see 57 discuss difficulti parallel spars rankon updat reason consid altern implement hereaft refer sd make use static data structur base leftlook delay updat version biconjug algorithm amount rearrang comput shown simplic consid z factor assum breakdown occur 1 let z 0 e 1 z 0 j gamma1 z j gamma1 z j z j gamma1 j gamma1 j gamma1 z j gamma1 z igamma1 procedur implement static data structur cost increas number floatingpoint oper inde implement found necessari recomput dot product p j gamma1 z j gamma1 use updat subsequ column increas arithmet complex less pronounc depend problem densiti precondition hand formul greatli decreas amount irregular data structur manipul also appear better suit parallel implement dot product vector updat innermost loop done parallel notic sd longer true singl row column use step outer loop worth mention numer dd sd implement incomplet biconjug process complet equival sd implement straightforward suppos first step complet order determin column alreadi determin part z play 22 michel benzi miroslav tuma role rankon updat use form jth column z need link list scan structur column link list code similarli mechan determin structur jth row choleski factor l numer factor sparspak see 2713 addit approxim invers precondition also code standard row implement classic ilu0 precondition see eg 50 chose nofil implicit precondition mostli interest compar precondition nonzero densiti close origin matrix input code comput precondition check whether coeffici matrix zerofre diagon row reorder matrix use permut nonzero diagon ilu0 approxim invers factor introduc simpl pivot modif avoid breakdown whenev diagon element algorithm comput precondition found small case less absolut valu ieee machin precis ffl 22 increas 10 gamma3 special reason choic work well practic mention numer experi safeguard measur requir often ilu0 approxim invers factor experi matric nontrivi reduc block triangular form use routin mc13d ma28 19 get block triangular form 8 numer experi section present result numer experi rang problem harwellbo collect 21 tim davi collect 17 matric use rescal divid element absolut valu largest nonzero entri scale use righthand side linear system comput solut vector x one choic use eg 57 experi sever iter solver conjug gradient type present result three select method found suffici repres van der vorst bicgstab method denot bst tabl qmr method freund nachtig saad schultz gmre restart everi 20 step denot g20 tabl household orthogon 56 see 3 descript method report 9 experi solver approxim invers precondit 23 matric use experi come reservoir simul or pores2 saylr sherman chemic kinet fs5414 network flow hor131 circuit simul jpwh991 memplu add petroleum engin watt matric incompress flow comput raefski swang1 order n number nnz nonzero test problem given tabl 1 togeth number iter comput time unprecondit iter method mean converg attain 1000 iter bicgstab qmr 500 iter gmres20 time tabl 1 test problem n order matrix nnz nonzero matrix converg result iter method without precondit michel benzi miroslav tuma test perform sgi crimson workstat risc processor r4000 use doubl precis arithmet code written standard fortran 77 compil optim option o4 cpu time given second measur use standard function dtime initi guess iter solver alway x stop criterion use jjr k jj unprecondit updat residu note r 1 jjr 0 jj 1 nzr nzr denot maximum number nonzero row follow tabl present result experi ilu0 precondition approxim invers precondition base biconjug process refer aibc observ number nonzero ilu0 precondition equal number nnz nonzero origin matrix wherea aibc precondition fillin given total number nonzero factor w tabl number nonzero aibc denot f ill right precondit use experi comparison implicit explicit precondition base amount fill rate converg measur number iter two paramet realist describ scalar behavior precondit iter method cours import advantag invers precondition explicit captur descript accuraci aibc precondition control valu drop toler smaller drop toler result dens precondition often alway higher converg rate precondit iter experi consid rel spars precondition case abl adjust valu obtain invers precondition nonzero densiti close henc ilu0 precondition due scale matrix entri choic often right one also give result approxim invers obtain somewhat smaller valu drop toler order show number iter reduc allow fillin precondition problem could find valu number nonzero aibc close nnz case approxim invers precondition tend either dens spars approxim invers precondit 25 tabl 2 give time precondition comput iter count time three iter solver precondit ilu0 inform given tabl 3 approxim invers precondition aibc aibc give two time construct precondition first dd implement use dynam data structur second sd implement use static data structur ilu ilu time matrix ptime bst qmr g20 bst qmr g20 raefsky1 2457 tabl 2 time form ilu0 precondition ptime number iter time bicgstab qmr gmres20 ilu0 precondit 26 michel benzi miroslav tuma ptime aibc aibc time matrix fill dd sd bst qmr g20 bst qmr g20 5204 jpwh991 7063 031 026 15 27 28 024 067 078 48362 068 263 33 43 64 261 539 863 26654 089 245 tabl 3 time form aibc precondition ptime use dd sd implemen tation number iter time bicgstab qmr gmres20 aibc approxim invers precondit 27 appear result ilu0 aibc precondition roughli equival point view rate converg ilu0 slight edg mani problem two precondition give similar result case like pores2 ilu0 much better aibc other like memplu situat revers problem necessari allow rel high fill approxim invers precondition order converg rate compar insur ilu0 cf saylr4 case spars aibc give excel result see add raefski matric follow time iter part solut process pretti close averag two precondition also notic use dens approxim invers precondition obtain smaller valu nearli alway reduc number iter although necessarili mean reduc comput time sinc take longer comput precondition cost iter increas concern matrix pores2 method give poor result observ fillin w factor high tri use differ drop toler two factor one larger one use z help observ 31 find spars right approxim invers pores2 hard left approxim invers approxim instead unfortun method produc exactli approxim invers transposit therefor abl cope problem effect experienc similar difficulti w factor matrix sherman2 hand sherman3 face problem report 30 converg aibc precondition smooth time requir comput precondition obviou ilu0 comput quickli hand comput aibc precondition prohibit problem comput aibc two three time expens comput ilu0 import experi aibc show overal solut time almost alway domin iter part unless converg extrem rapid case iter part take slightli less time comput precondition observ suggest approxim invers precondition much cheaper construct sequenti environ approxim invers precondition base 28 michel benzi miroslav tuma frobeniu norm approach describ x3 inde look result present 30 see sequenti time requir construct precondition account huge portion often excess 90 overal comput time worth emphas approach base frobeniu norm minim one propos seem produc precondition similar qualiti sens compar ilu0 point view fillin rate converg least averag differ implement aibc see result tabl 3 larger problem effect addit floatingpoint oper sd implement dd implement actual faster nevertheless alreadi observ implement use static data structur may better suit parallel architec ture paper consid scalar implement remain experi limit time dd implement aibc experi exclud one perform measur time present tabl monitor also true residu jjb gamma ax k jj 2 gener found discrep norm updat residu small howev found illcondit matric harwellbo collect includ tabl differ may larg instanc ln west matric found jjr k jj final valu r k happen ilu0 approxim invers precondition regard failur precondit iter method present tabl 4 5 result experi matric reduc block lower triangular form compar number iter precondit iter method time block approxim invers precondition block ilu0 precondition describ x6 sinc matric trivial block lower triangular form one block two block one block dimens one matric exclud experi tabl 4 give matrix number nbl block result experi ilu0 tabl 5 give analog result aibc precondition amount fillin denot f ill aibc comput fillin approxim invers diagon block plu number nonzero entri offdiagon block approxim invers precondit 29 block ilu block ilu time tabl 4 time comput block ilu precondition ptime number iter time bicgstab qmr gmres20 block ilu0 precondit block aibc block aibc time matrix fill ptime bst qmr g20 bst qmr g20 tabl 5 time comput block aibc precondition ptime number iter time second bicgstab qmr gmres20 block aibc precondit clear gener reduct block triangular form lead notic improv time least sequenti implement observ block form use result ilu0 sometim wors michel benzi miroslav tuma probabl attribut permut known caus case degrad rate converg precondit iter method 22 notabl except matrix watt2 number iter greatli reduc hand result block approxim invers precondition mostli unchang somewhat better matrix watt2 repres except problem greatli benefit reduct block triangular form case permut advers affect rate converg precondit iter method fact suggest perhap approxim invers precondition robust ilu0 respect reorder gain insight permut origin matrix influenc qualiti type precondition experi matrix permut use minimum degre algorithm structur see 28 appli result permut symmetr get pap order preserv nonzero diagon tabl 6 7 present result test matric trivial block triangular form correspond precondition denot ilu0md aibcmd respect ilumd ilumd time matrix ptime bst qmr g20 bst qmr g20 26 43 47 218 457 645 tabl time comput ilu0 precondition ptime permut accord minimum degre algorithm number iter time bicgstab qmr gmres20 ilu0md precondit approxim invers precondit 31 aibcmd aibcmd time matrix fill ptime bst qmr g20 bst qmr g20 7152 031 43 48 038 123 138 19409 058 104 95 291 414 tabl 7 time comput aibc precondition ptime permut minimum degre algorithm number iter time bicgstab qmr gmres20 aibcmd precondit result tabl 6 show problem especi come pde minimum degre reorder detriment effect converg iter solver precondit ilu0 case see dramat increas number iter analog observ fact see eg 22 minimum degre order use nofil incomplet choleski decomposit spd michel benzi miroslav tuma matrix poor approxim coeffici matrix least problem aris discret 2d pde converg conjug gradient method precondition iccg0 much slower natur order unknown use observ similar phenomenon nonsymmetr linear system note rather strike behavior matrix add20 benefit greatli minimum degre reorder matrix aris circuit model discret pde also observ 22 neg impact minimum degre rate converg pcg disappear incomplet choleski factor comput mean drop toler rather posit natur ask whether hold true approxim invers precondition aibc comput use drop toler result tabl 7 show inde case test problem number iter nearli unaffect better addit note minimum degre order help preserv sparsiti incomplet invers factor usual enough decreas comput time fact possibl reduc storag demand approxim invers precondition without neg affect converg rate might becom import larg problem conclud section observ concern choic drop toler experi use fix valu throughout incomplet biconjug process howev rel drop toler whose valu adapt step step could also consid see 57 thorough discuss issu relat choic drop toler context ilu observ amount fillin distribut rather unevenli cours approxim invers factor larg proport nonzero usual concentr last sever column z w problem larg fill may prefer switch larger drop toler column incomplet factor start fillingin strongli convers suppos comput approxim invers precondition certain valu find precondit iter converg slowli provid enough storag avail one could tri recomput least column z use smaller valu unfortun gener spars matric guarante result precondition improv qualiti inde allow nonzero precondition alway result reduc number iter approxim invers precondit 33 final worthwhil observ dual threshold variant incomplet invers factor could adopt see 51 approach drop toler appli maximum number nonzero per column specifi enforc comput precondition way possibl control maximum storag need precondition import autom implement approach tri yet hope near futur 9 conclus futur work paper develop spars approxim invers precondit techniqu nonsymmetr linear system approach base procedur comput two set biconjug vector perform incomplet preserv sparsiti algorithm produc approxim triangular factor gamma1 guarante exist hmatrix similar ilu factor factor spars approxim invers use explicit precondition conjug gradienttyp method appli precondition requir spars matrixvector product consider interest use parallel comput new precondition use enhanc converg differ iter solver base extens numer experi found precondition insur converg rate compar averag standard precondition approxim invers factor timeconsum comput ilu0 cost prohibit typic domin time requir iter part contrast approxim invers precondition base frobeniu norm minim produc similar converg rate expens comput possibl parallel environ situat revers sinc precondition construct frobeniu norm approach inher parallel ever scope parallel also invers factor method base instanc approxim invers factor z w comput larg independ clearli point requir research conclus drawn parallel version approxim invers precondition implement test result point fact qualiti approxim invers precondition greatli affect reorder coeffici matrix import practic suggest may use permut increas potenti parallel reduc amount fill precondition without spoil rate converg 34 michel benzi miroslav tuma theoret result fillin x5 provid guidelin use pivot strategi enhanc sparsiti approxim invers factor topic deserv research base result experi conclud techniqu introduc paper potenti becom use tool solut larg spars nonsymmetr linear system modern highperform architectur work parallel implement new precondition current way futur work also includ dual threshold implement precondition comput acknowledg would like thank one refere help comment suggest professor miroslav fiedler provid refer 24 first author grate acknowledg hospit excel research environ provid institut comput scienc czech academi scienc r parallel implement precondit conjug gradient method solv spars system linear equat iter solut method templat solut linear system parallel algorithm solut certain larg spars linear system direct rowproject method spars linear system direct project method spars linear system explicit precondition conjug gradient method spars approxim invers precondition conjug gradient method spars approxim invers precondition nonsymmetr linear system krylov method precondit incomplet factor matric cm2 approxim invers precondition gener spars matric approxim invers techniqu blockpartit matric user guid sparspaka waterloo spars linear equat packag block precondit conjug gradient method approxim invers precondit spars linear system spars matrix collect decay rate invers band matric direct method spars matric user guid harwellbo spars matrix collect effect order precondit conjug gradient stabil analysi incomplet lu factor invers bigraph connect gauss elimin introduct numer linear algebra note solut algebra linear simultan equat comput solut larg spars posit definit system evolut minimum degre algorithm predict structur spars matrix comput approximateinvers precondition parallel precondit spars approxim invers parallel precondit approxim invers connect machin parallel precondit conjug gradient packag solv spars linear system cray ymp invers matric biorthogon relat result method conjug gradient solv linear system theori matric numer analysi polynomi precondit conjug gradient calcul effici parallel iter solut larg spars linear sy tem explicitli precondit conjug gradient method solut unsymmetr linear system new converg result precondit strategi conjug gradient method factor spars approxim invers fsai precondit solv 3d fe system massiv parallel comput ii iter construct fsai precondition factor spars approxim invers precondit theori factor spars approxim invers precondit ii solut 3d fe system massiv parallel comput krylov method numer solut initialvalu problem differentialalgebra equat incomplet factor techniqu posit definit linear system iter solut method linear system coeffici matrix symmetr mmatrix properti approxim invers matric precondit techniqu nonsymmetr indefinit linear system sparskit basic tool kit spars matrix comput ilut dual threshold incomplet lu factor conjug direct method solv system linear equat high perform precondit matrix iter analysi implement gmre method use household transform comput method gener spars matric tr ctr kai wang jun zhang multigrid treatment robust enhanc factor spars approxim invers precondit appli numer mathemat v43 n4 p483500 decemb 2002 clau koschinski new method adapt approxim invers precondition appli numer mathemat v41 n1 p179218 april 2002 stephen barnard lui bernardo horst simon mpi implement spai precondition t3e intern journal high perform comput applic v13 n2 p107123 may 1999 n guessou souhar multilevel block ilu precondition spars nonsymmetr mmatric journal comput appli mathemat v162 n1 p231246 1 januari 2004 matthia bollhfer volker mehrmann converg estim algebra multilevel precondition contemporari mathemat theori applic american mathemat societi boston 2001 michel benzi miroslav tma parallel solver largescal markov chain appli numer mathemat v41 n1 p135153 april 2002 mansoor rezghi mohammad hosseini ilu precondition nonsymmetr posit definit matric use conjug gramschmidt process journal comput appli mathemat v188 n1 p150164 1 april 2006 h koulaei f toutounian comput block ilu precondition block tridiagon system journal comput appli mathemat v202 n2 p248257 may 2007 michel benzi precondit techniqu larg linear system survey journal comput physic v182 n2 p418477 novemb 2002