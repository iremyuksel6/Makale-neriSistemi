stabl local comput condit gaussian distribut articl describ propag scheme bayesian network condit gaussian distribut numer weak scheme deriv lauritzen journal american statist associ 87 10981108 1992the propag architectur lauritzen spiegelhalt journal royal statist societi seri b 50 157 224 1988in addit mean varianc provid previou algorithm new propag scheme yield full local margin distribut new scheme also handl linear determinist relationship continu variabl network specificationth comput involv new propag scheme simpler previou scheme method implement recent version hugin softwar b introduct bayesian network develop import tool build system decis support environ character uncertainti pearl 1988 jensen 1996 cowel et al 1999 exact comput algorithm develop concern network involv discret variabl research report r992014 depart mathemat scienc aalborg univers lauritzen 1992 develop comput scheme exact local comput mean varianc network condit gaussian di tribut unfortun scheme turn fatal numer difficulti basic due comput unstabl transform two differ represent distribut motiv present work remedi numer insta biliti fundament idea behind develop time keep interest quantiti repres unit direct mean probabl mean regress coeffici varianc must necessarili reason order magnitud comput scheme develop rather remot comput architectur use deal discret variabl hugin softwar similar scheme repres exampl abstract form shenoy shafer 1990 lauritzen jensen 1997 differ partli relat fundament oper combin margin partial defin also handl evid quit differ scheme closest origin scheme develop lauritzen spiegelhalt 1988 abstract consider shafer 1991 seem necessari emb scheme unifi framework addit benefit present scheme includ determinist linear relationship continu variabl repres without difficulti show calcul full local margin continu variabl without much comput effort repres major improv origin scheme lauritzen 1992 distribut regress bayesian network consid distribut condit gaussian famili distribut introduc lauritzen wermuth 1984 1989 shall briefli review standard notat otherwis refer reader lauritzen 1996 detail set variabl v partit variabl discret delta continu gamma type joint distribut continu variabl given discret assum multivari gaussian ie denot continu variabl discret jgammaj denot cardin gamma sigmai posit semidefinit say follow cg distribut symbol n jgammaj sigma denot multivari gaussian distribut mean covari matrix sigma case sigma posit definit distribut densiti 2 jgammaj det sigma exp sigma singular multivari gaussian distribut densiti implicitli determin properti vector v linear combin v univari gaussian distribut interpret distribut degener see exampl rao 1973 chapter 8 descript gaussian distribut level gener note slight differ terminolog use lauritzen 1996 allow pi equal 0 entri also avoid use socal canon characterist cg distribut numer instabl scheme lauritzen 1992 associ switch moment characterist addit benefit allow singular covari matric sigma occasion interest describ cg distribut depend addit variabl depend set discret variabl j vector continu variabl z determin refer depend simpl cg regress note neither covari matrix discret part depend continu variabl z condit expect continu variabl depend linearli continu variabl fix valu discret variabl j gener cg regress p also permit depend z specif way lauritzen 1996 relev 3 mix bayesian network consid probabilist network direct acycl graph dag known bayesian network pearl 1986 mix bayesian network condit gaussian distribut specifi set node variabl discret continu variabl dag associ network must satisfi restrict discret node continu parent condit distribut discret variabl given discret parent variabl specifi usual wherea condit distribut continu variabl given cg regress note onedimension fli nonneg real number distribut specifi linear determinist depend z assumpt impli joint distribut variabl bayesian network cg distribut comput task address comput joint distribut interest subset variabl particular singl variabl possibl given specif evid ie given known valu arbitrari subset variabl network distribut gener mixtur condit gaussian distribut propag scheme describ involv usual step construct junction tree strong root initi junction tree incorpor evid local comput margin cliqu 4 potenti oper 41 cg potenti basic comput object cg potenti cg potenti repres partit continu variabl domain oe head tail h denot variabl head tail z assum r sdimension arbitrari configur discret variabl domain denot thu everi potenti domain discret node head node tail node could absent express tabl nonneg number ie usual potenti discret case tabl r theta 1 vector fbig tabl r theta matric tabl r theta r posit semidefinit symmetr matric potenti repres p b ch specifi cg regress abstract notion potenti head tail due shafer 1991 mani way would natur also partit discret variabl head tail variabl reflect potenti alway repres condit distribut head variabl given tail partit discret variabl exploit propag scheme chosen propag scheme type madsen jensen 1998 could exploit partit initi condit distribut continu variabl v parent node pav mix bayesian network correspond cg potenti domain equal pav delta similarli specif condit distribut discret variabl given parent correspond cg potenti p gamma gamma gammagamma j gamma p determin condit probabl tabl discret part domain equal famili hyphen indic correspond part potenti void 42 extens reduct cg potenti extend ad discret variabl domain continu variabl tail ad discret variabl domain part oe extend p ad continu variabl tail b matric extend ad zero column new tail variabl similarli b column ident zero valu correspond variabl remov tail potenti say tail reduc column b ident zero tail potenti said minim 43 margin propag scheme lauritzen 1992 margin cg potenti defin certain condit margin group discret continu variabl calcul margin continu variabl calcul first margin continu variabl calcul head variabl p b ch correspond partit head variabl margin oe say margin strong correspond calcul ordinari margin relev condit gaussian distribut head variabl remov margin tail reduc becom empti discret potenti emerg lead indirectli margin tail variabl margin discret variabl defin tail potenti empti ie continu condit variabl therefor b matrix margin cg potenti gamma discret domain partit u w w ae oe margin said weak correspond calcul full margin distribut gener full margin distribut discret mixtur cg distribut distribut repres weakli margin potenti cg distribut closest kullbackleibl distanc true margin see lauritzen 1996 lemma 64 44 direct combin combin oper cg potenti defin arbitrari pair potenti scheme quit differ propag scheme direct combin two cg potenti defin head disjoint domain oe ie satisfi alway assum potenti first reduc tail minim 1 fulfil reduc potenti subsequ extend extens done extend next let correspond h defin direct combin appar noncommut product combin oper correspond ordinari composit condit distribut note oe omega omega oe exist equal direct combin also satisfi omega omega omega sens combin one side well defin side result potenti shafer 1991 call type algebra structur partial commut semigroup notat reflect oper direct combin sens similar form disjoint union set unfortun direct combin cg potenti suffici propag scheme work arbitrari mix bayesian network defin gener combin need introduc notion complement 45 complement head cg potenti partit p strong margin oe defin complement oe jh1t cg potenti q e f gh denot arbitrari gener invers matrix penros 1955 ie arbitrari matrix gamma satisfi see also rao 1973 pp 2427 rao mitra 1971 easili check use formula combin togeth 2 fact gener invers 11 c 11 also hold see eg rao 1973 formula 8a212 note express either p decomposit potenti strong margin complement correspond exactli decomposit probabl distribut margin condit 46 recurs combin next defin gener combin cg potenti requir initi process describ section consid two potenti minim tail h combin remain undefin head potenti disjoint let omega omega oe least one righthandsid express defin oe omega oe defin ambigu definit neither direct combin defin must let empti combin defin els decompos one factor say oe assum 12 6 omega oe 00 attempt combin oe equat understood recurs sens procedur describ repeat product oe 0omega wherea direct combin express well defin construct recurs termin unsuccess two potenti minim tail satisfi 3 also combin oe remain undefin initi set comput structur involv sever step form strong junction tree strong root assign potenti cliqu transform potenti specif form send messag first toward root away root junction tree strong root construct usual way see exampl cowel et al 1999 chapter 7 thu assum begin comput scheme point specifi mix bayesian network associ junction tree cliqu c root neighbour cliqu c c closer root ie residu n c contain discret variabl separ consist discret variabl also hold variabl v fav contain cliqu junction tree 51 assign potenti cliqu everi cg potenti correspond specif condit distribut node given parent assign arbitrari cliqu junction tree contain famili potenti assign given cliqu subsequ combin order alway done use direct combin dag acycl continu node head exactli one potenti 52 collect messag root next step initi process involv send messag leav junction tree toward root way similar process known collectevid standard hugin architectur jensen et al 1990 although messag sent slightli differ thu cliqu allow send messag leaf junction tree receiv messag neighbour away root process stop root receiv messag neighbour use term collect oper collectmessag sent cliqu c neighbour toward root separ potenti oe c c oe modifi becom oe c oe oe domega oe ie oe c complement oe c margin separ oe obtain combin origin potenti margin oe c remain argu combin 6 inde well defin see first realiz head two potenti combin must necessarili disjoint variabl occur head potenti involv 6 hold tail variabl parent dag induc condit specif combin possibl margin form potenti thu potenti reduc minim tail must direct path everi variabl present tail potenti variabl head potenti hold tail variabl u condit independ head given remain tail variabl thu must trail dconnect u variabl head tail variabl parent trail must initi direct away u leav tail immedi tail variabl condit set headtohead node activ trail must form direct path u head assum 4 satisfi h 1 h 2 nonempti impli deduc must direct path everi variabl u impli v must direct path variabl w thu everi u direct path nonempti finit would contradict acycl dag illustr recurs combin necessari initi process consid two simpl exampl exampl 1 consid dag figur 1 potenti assign cliqu node c e must assign fb c eg remain node fa b c dg combin potenti two cliqu lead potenti head tail fc eg j fbg fb c eg fb dg j fcg fa b c dg first margin separ fb cg result head tail fcg j fbg directli combin potenti root cliqu fa b c dg e figur 1 mix bayesian network associ junction tree variabl discret variabl strong root fa b c dg root cliqu potenti decompos potenti head tail fdg j fb cg fbg j fcg latter reduc fbg j gamma depend c spuriou potenti combin directli 2 exampl potenti receiv cliqu decompos combin potenti receiv cliqu combin incom messag combin could perform directli next exampl illustr may incom messag need decompos way avoid comput decomposit exampl 2 consid dag figur 2 potenti assign cliqu node e f must assign fc e fg c fa c eg b fa b dg two choic node choos assign cliqu fa b dg also chosen root collect toward root first messag fc eg margin potenti fc e fg must calcul combin assign potenti one head tail fd e fg j fcg margin fd eg j fcg directli combin potenti neighbour cliqu head tail fcg j feg incom potenti decompos potenti head tail fdg j fc eg feg j fcg latter reduc feg j gamma depend c spuriou potenti combin directli 2 root receiv messag neighbour root potenti contain correct root margin tail empti evid incorpor normal discret part root potenti may necessari see section 7 e f figur 2 mix bayesian network associ junction tree variabl discret variabl strong root could chosen either fa b dg fa c eg also potenti oe repres joint distribut variabl equal combin cliqu potenti oe c fact margin comput collect phase strong hold subset c 0 c contain root r form connect subtre junction tree complement store cliqu collect separ play specif role process comput similar process form set chain lauritzen spiegelhalt 1988 thu inward comput type call lauritzenspiegelhalt architectur shafer 1996 see also lauritzen jensen 1997 53 distribut messag root first step calcul margin involv send messag away root similar distributeevid standard hugin architectur root begin send messag neighbour cliqu allow send messag soon receiv one neighbour closer root use term distribut process slightli differ messag standard hugin architectur distributemessag sent cliqu c neighbour away root separ c receiv messag neighbour toward root make induct assumpt separ 0 toward root contain weak cliqu margin joint potenti send messag new potenti oe creat follow first weak cliqu margin c calcul formula correct seen exactli lauritzen 1992 next potenti margin separ combin well defin collect oper complement store cliqu head oe c disjoint 0 weak margin well defin tail oe c contain head oe 0 impli combin 9 empti tail distribut separ contain weak margin separ node note chosen store weak cliqu margin calcul distribut prefer keep origin complement potenti minor variat lauritzenspiegelhalt architectur initi process complet cliqu junction tree contain complement potenti separ contain weak margin joint potenti joint potenti recov 7 6 comput margin junction tree initi describ previou section variou type margin easili calcul 61 margin variabl singl cliqu store separ weak cliqu margin alway recalcul 9 need margin subset cliqu particular singl node circumst weak margin happen strong give correct full margin distribut variabl involv clearli true desir margin involv discret variabl case interest true alreadi mention root cliqu contain correct full margin distribut variabl thu exampl true margin set continu variabl root cliqu easili calcul gaussian discret mixtur weight pi ie root potenti p gamma margin easili perform hold cliqu c satisfi slightli less restrict condit tail potenti empti exampl case separ cliqu c toward root contain discret variabl see argu follow 8 true margin union cliqu path root c given combin relev potenti cliqu path c continu variabl c condit independ remain discret variabl path given separ variabl tail potenti c assum empti also hold given discret separ variabl proposit 63 lauritzen 1996 yield weak margin c also equal full margin proceed root cliqu 62 rearrang junction tree obtain margin set variabl subset cliqu junction tree obtain strong margin group variabl singl variabl cliqu potenti empti tail junction tree must rearrang fortun simpl oper use achiev necessari rearrang denot push act group variabl contain cliqu w neighbour u toward root correspond separ oper push apppli variabl 1 potenti oe w decompos omega 2 cliqu u extend u 3 potenti chang omega omega push oper variabl come closer strong root extend junction tree still repres joint potenti initi price paid cliqu u increas u exampl 3 illustr push oper use mix bayesian network figur 2 assum chosen fa b dg root initi cliqu fa c eg contain potenti repres condit distribut variabl fc eg given fa dg head tail fc eg j fdg use push fcg potenti decompos margin head tail fcg j fdg complement head tail feg j fc dg root cliqu extend variabl c margin combin root potenti wherea complement kept cliqu fa c eg 2 63 margin variabl differ cliqu weak margin desir set variabl subset cliqu origin junction tree first form smallest connect subtre origin junction tree contain variabl let c cliqu subtre closest strong root origin junction tree repeat use push oper eventu achiev variabl question becom member c desir weak margin comput directli use 9 64 strong margin strong margin group variabl desir push oper yield appropri rearrang junction tree comput weak margin first form smallest connect subtre origin junction tree contain variabl let c cliqu subtre closest strong root r origin junction tree use push oper make variabl question becom member c c perform push oper potenti empti tail comput desir strong margin potenti c 10 otherwis need push variabl question closer r eventu variabl contain cliqu potenti empti tail potenti cliqu comput desir potenti 10 necessari may need push variabl way r calcul strong margin singl continu variabl import special case discuss follow margin calcul limit addit effort sinc potenti junction tree extend singl continu variabl part calcul 7 incorpor evid point assum initi process complet cliqu junction tree contain complement separ contain weak margin discret evid incorpor usual matter necessari insert discret evid one cliqu describ incorpor continu evid first realiz everi continu node necessarili appear head exactli one cliqu cliqu appear closest strong root cliqu potenti appear must tail node also u w neighbour cliqu u closest root continu variabl separ constitut superset tail potenti complement store w conveni incorpor evid continu node singl node time evid must enter cliqu appear assum cliqu 2 appear head potenti empti tail case use push oper describ subsect 62 achiev proceed follow 1 cliqu 2 tail node tail cliqu potenti decreas 2 p c unchang b chang remov column b 2 correspond 2 modifi becom 2 cliqu 2 head node partit head node margin potenti insert evid denot oe obtain h remov 2 tail thu b empti distinguish two case j c 22 j let ae p 0 let b els let 2c22 p 0 let intuit oper reflect determinist explan evid c 22 infinit like nondeterminist one avail calcul case 2a simpli base upon fact wherea standard densiti calcul appropri case 2b correct oper formal prove small calcul elementari probabl simplic give argument case 1 void let qi j denot kernel obtain normal p let depend explicit ie need show interv real line q satisfi relat z margin distribut ie j denot normal distribut nfaj cjg degener aj c 22 z ae thu get z ae p ae c 22 0 similarli get z z z piec continu evid insert represent still complement represent insert next f figur 3 bayesian network strong junction tree wast inciner exampl variabl w type wast f filter state b burn ing regimen metal wast e filter effici c co 2 emiss emiss dust emiss metal l light penetr variabl w f b discret piec evid take place evid insert collect toward root initi collect involv proper comput discret part potenti normal root cliqu equal joint densiti evid exampl 4 final exampl wast exampl describ lauritzen 1992 cowel et al 1999 section 77 refer either detail numer specif exampl concern control emiss heavi metal wast inciner emiss wast inciner differ composit differ incom wast anoth import factor wast burn regimen monitor measur concentr co 2 emiss filter effici depend technic state electrofilt amount composit wast emiss heavi metal depend concentr metal incom wast emiss dust particul gener emiss dust monitor measur penetr light essenc descript repres bayesian network figur 3 also show junction tree strong root chosen either fb cg fb f weg one way assign potenti correspond continu variabl cliqu junction tree c assign fb cg fb wedg e fb f weg l g exactli one potenti involv continu variabl assign cliqu continu compon potenti becom correspond continu compon cliqu potenti initi strong junction tree collect oper particular junction tree chang continu compon cliqu potenti initi process incorpor evid c e done without invok push oper sinc variabl appear either head root cliqu discret separ toward root incorpor evid requir push fb f weg unless evid e alreadi incorpor similarli incorpor evid l requir push l fb f weg unless separ along path fl dg fb f weg made empti fulli discret incorpor evid andor e incorpor evid cliqu fw dm g potenti head fm g empti tail incorpor evid point therefor done without invok push oper hand evid incorpor potenti cliqu fw dm g head tail fm g j fdg incorpor evid point requir push closer fb f weg incorpor evid push fw dm g unless evid incorpor similar consider appli find full mixtur distribut individu continu variabl figur 4 5 display full mixtur distribut continu variabl incorpor inform wast industri type l measur 11 c gamma09 2 figur 4 screendump hugin softwar display full margin continu variabl wast inciner exampl evid incorpor figur 5 screendump hugin softwar display full margin remain continu variabl wast inciner exampl insert evid wast industri type l measur 11 c gamma09 acknowledg first author benefit convers glenn shafer concern develop abstract theori local comput research partli support danish research council pift programm ander l madsen provid help comment draft version paper lar nielsen prepar hugin screendump shown figur 4 5 r probabilist network expert system introduct bayesian network bayesian updat causal probabilist network local comput propag probabl graphic model local comput valuat commut semigroup local comput probabl graphic structur applic expert system discuss mix interact model graphic model associ variabl annal statist lazi propag junction tree probabilist reason intellig system gener invers matric linear statist infer applic john wiley son axiomat studi comput hypertre probabilist expert system axiom probabl belief function propag netherland tr ctr ander l madsen empir evalu possibl variat lazi propag proceed 20th confer uncertainti artifici intellig p366373 juli 0711 2004 banff canada thiesson david maxwel chicker david heckerman christoph meek arma timeseri model graphic model proceed 20th confer uncertainti artifici intellig p552560 juli 0711 2004 banff canada robert g cowel local propag condit gaussian bayesian network journal machin learn research 6 p15171550 1212005 david barber expect correct smooth infer switch linear dynam system journal machin learn research 7 p25152540 1212006 martin neil manesh tailor david marquez infer hybrid bayesian network use dynam discret statist comput v17 n3 p219233 septemb 2007